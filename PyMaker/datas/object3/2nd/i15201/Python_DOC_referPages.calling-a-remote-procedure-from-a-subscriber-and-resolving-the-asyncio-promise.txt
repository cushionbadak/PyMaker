Natural Text
I'm having problems getting asyncio based autobahn RPCs to work in an event handler:Reading the documentation, I'm under the impression that this should work. However, if I'm using  inside  none of its code is being executed at all. I've tried decorating with  in various patterns, but can't get it to run at all.The only way I've found to make it work is by resolving the returned future "manually":I'm sure I'm just not understanding asyncio programming correctly yet, so what do I have to do to be able to write  and get the result immediately (meaning without additional explicitly stated callbacks)?
The presence of the  keyword in the body of a  statement makes the defined function into a generator function.When you call a generator function (as  would), the body of the function is not executed. Instead, a generator object is created. When you call  on the generator, control advances to the next  statement. Generators have been discussed extensively in other Stack Overflow posts, as well as in the docs and elsewhere on the web.The API of  makes extensive use of coroutines and . (For most purposes, you can consider 'coroutine' and 'generator' to be synonymous.) The event loop tracks a collection of generators and calls ,  and  on them as appropriate.*It looks like  expects a regular callback function, not a coroutine, and that's why your code is not getting executed. One way to work around this is to write a callback function that schedules your coroutine, using .In the absence of a function in  to do this, you can write your own reusable decorator to subscribe coroutines to WAMP topics.Now your class will look like this:* This is a simplification. The event loop in fact tracks s, not coroutines. The algorithm to call the appropriate methods on a generator is implemented by , which wraps a coroutine up into a .


Answer URL
https://docs.python.org/3/reference/expressions.html#yield-expressions
https://docs.python.org/3/glossary.html#term-generator
https://docs.python.org/3/library/asyncio-task.html#coroutines
https://docs.python.org/3/library/asyncio-eventloop.html
https://docs.python.org/3/library/asyncio-task.html#asyncio.async
https://docs.python.org/3/library/asyncio-task.html#future
https://docs.python.org/3/library/asyncio-task.html#task
https://docs.python.org/3/glossary.html#term-generator
