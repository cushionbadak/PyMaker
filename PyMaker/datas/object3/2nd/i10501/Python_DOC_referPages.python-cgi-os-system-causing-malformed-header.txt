Natural Text
I am running Apache/2.4.10 (Raspbian) and I am using python for CGI.But when I try to use os.system in simple code I get this malformed header error:Here is the code from play.cgi:The strange thing is that if I remove the os.system line it mysteriously starts working again. I have tried using popen instead, same problem. I have tried to obscure it in some code,change file name, different encodings and even time.sleep, none of those worked.The strangest thing is that it works perfectly fine in a more complicated code.
To see why the problem happened, try launching your scriptAnd than open  with some text editor. You will notice that your  ended up being in the bottom of the file, which, of course, is wrong.That happens because incorporating outout of your  in output of Python code screws thing up (because think about it: your  is accumulated and flushed in blocks when appropriate, while  abruptively prints data and because it is  transacton, flushes only its result (which is also why you do not see the problem if outout is to console)). The solution is to flush output after printing headers. You should change your code toAlthough that is a fix, you know you are doing something terribly wrong if you need to incorporate output of your console command to the content of the web page and use  for that. There are several things you should consider doing. These solutions are sorted by how recommended they are (from crappy to good):-Use redirection of input/output. Save output of  to file and read it in your Python code:-Use subprocess. It allows you to capture output of console program and use it in your python code (example from python getoutput() equivalent in subprocess)-Do not call external programs at all, this is a bad thing to do. If you need a list of files, use Python functions instead


Answer URL
https://docs.python.org/3/library/subprocess.html
