Natural Text
I have an excel sheet with dates, time, and temp that look like this:using python, I want to extract this info into python arrays.The array would get the date in position 0, and then store the temps in the following positions and look like this:here is my attempt, but it sucks:i used xlrd, but I am open to using anything. Thank you for your help.
From what I understand of your question, the problem is that you want the output to be a list of lists, and you're not getting such a thing.And that's because there's nothing in your code that even tries to get such a thing. For each row, you build a list, print out the first value of that list, print out the second value of that list, and then forget the list.To append each of those row lists to a big list of lists, all you have to do is exactly the same thing you're doing to append each column value to the row lists:From your comment, it looks like what you actually want is not only this, but also grouping the temperatures together by day, and also only adding the second column, rather than all of the values, for each day. Which is not at all what you described in the question. In that case, you shouldn't be looping over the columns at all. What you want is something like this:This code assumes that the dates are always in sorted order, as they are in your input screenshot.I would probably structure this differently, building a row iterator to pass to , but I wanted to keep this as novice-friendly, and as close to your original code, as possible.Also, I suspect you really don't want this:â€¦ but rather something like this:But without knowing what you're intending to do with this info, I can't tell you how best to store it.
If you are looking to keep all the data for the same dates, I might suggest using a dictionary to get a list of the temps for particular dates. Then once you get the dict initialized with your data, you can rearrange how you like. Try something like this after :If you print tmpDict, you should get an output like:Dictionary keys are kept in an arbitrary order (it has to do with the hash value of the key) but you can construct a list of lists based on the content of the dict like so:Then, you'll get a list of lists ordered by date with the vals, as you were originally working. However, you can always get to the values in the dictionary by using the keys. I typically find it easier to work with the data afterwards but you can change it to any form you need.


Answer URL
