Natural Text
I have a list of lists that need to be merged based on strings in the list to fit a structure. In this case, it would be 'date' and 'id' trying to fit the 'fields' structure. Fields: Before:After:
In the case that impressions and clicks are not in a consistent order
 can work well here, particularly if the real data matches the sample data (already sorted so date/id pairs are all adjacent):If the data isn't already sorted by  and , you'd need to sort the  first, . That could be expensive if the  is huge, in which case you might consider using a  instead:
Another way:If you can assume that  and  are already in order, you can eliminate  and  and replace that line with:


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.groupby
https://docs.python.org/3/library/collections.html#collections.defaultdict
