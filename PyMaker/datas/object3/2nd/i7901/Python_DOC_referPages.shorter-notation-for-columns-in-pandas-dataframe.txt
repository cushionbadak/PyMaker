Natural Text
Take a random DataFrame:Pandas allows defining new columns in two ways:As the DataFrame name gets longer, this notation becomes less readable.And then there's the  function:It returns the slices of the  that match the condition. Is there a way to run something like  but for operations on the frame?
Function  does exactly this:And warning-free assignment:More generally, :The following arithmetic operations are supported: +, -, *, /, **, %,  // (python engine only) along with the following boolean operations: |  (or), & (and), and ~ (not). Additionally, the 'pandas' parser allows  the use of and, or, and not with the same semantics as the  corresponding bitwise operators.Pandas docs say that  supports only Python expression statements (e.g., ), but pandas silently supports  and maybe other statements. The rest throw an error. For example:returns .
Here's a way using  and :Note: The assign creates a copy of your dataframe, therefore you aren't distorting the original data. You'll need to reassign to a different variable or back to df.
Consider the dataframe named If you want cleaner code, create a temp variable name that's smaller


Answer URL
https://docs.python.org/3/reference/simple_stmts.html#expression-statements
