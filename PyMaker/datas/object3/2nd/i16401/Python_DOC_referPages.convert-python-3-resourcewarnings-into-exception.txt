Natural Text
Is there a way to force a Python 3 unittest to fail, rather than simply print a warning to stderr, if it causes any ResourceWarning?I've tried the following:Which results in this output from unittest:Note the "Exception ignored" message. I'd rather the test failed, instead of requiring me to read its output looking for ResourceWarnings.
Here's a unit test that fails if  is generated by the code in  statement:
Unfortunately, it doesn't appear to be possible.  That "Exception ignored in:" message is produced by the CPython function  in .  The comment before that function states:The  is indeed being generated during garbage collection, and Python prints a message because it doesn't have a way to raise an exception at that point.  This has to do with the core CPython implementation and there is nothing that unittest can do to override it.Update: while the above is a correct technical analysis, there is another approach that will actually solve the OP's problem.  See the answer by J.F. Sebastian for more details.


Answer URL
https://docs.python.org/3/library/warnings.html#testing-warnings
