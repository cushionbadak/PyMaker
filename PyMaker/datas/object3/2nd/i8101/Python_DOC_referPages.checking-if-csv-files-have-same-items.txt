Natural Text
I got two .csv files. One that has info1 and one that has info2. Files look like thisFile1:File2:I want to combine these two lines (marked as "<-") and make a combined line like this:I know that I could do script similar to this:Is there any other way to find out which rows have the same items in the beginning or is this the only way? This is pretty slow way to find out the similarities and it takes several minutes to run on 100 000 row files.
Your implementation is , comparing all lines in one file with all lines in another. Even worse if you re-read the second file for each line in the first file.You could significantly speed this up by building an index from the content of the first file. The index could be as simple as a dictionary, with the first column of the file as key, and the line as value.You can build that index in one pass on the first file.And then make one pass on the second file,checking for each line if the id is in the index.If yes, then print the merged line.Special thanks to @martineau for the dict comprehension version of building the index.If there can be multiple items with the same id in the first file,then the index could point to a list of those rows:This could be simplified a bit using :


Answer URL
https://docs.python.org/3/library/collections.html#collections.defaultdict
