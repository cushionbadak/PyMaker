Natural Text
I am trying to make an API call from within my service and I am running into event loop issues.  Can someone help me understand what I am doing wrong?Basically I want to make a service that does some calculations based on data pulled from a different service.I can call this code below from a cli, but not when I start up a web app (i.e.) hitting http://127.0.0.1:8080/addSample code:Exception:Error handling requestTraceback (most recent call last):  File ".../aiohttp/web_protocol.py", line 417, in start    resp = yield from self._request_handler(request)File ".../aiohttp/web.py", line 289, in _handle    resp = yield from handler(request)File ".../sample.py", line 11, in add data = loop.run_until_complete(run_fetch(loop, 'http://google.com'))File ".../python3.6/asyncio/base_events.py", line 454, in run_until_complete    self.run_forever()File ".../python3.6/asyncio/base_events.py", line 408, in run_forever    raise RuntimeError('This event loop is already running')RuntimeError: This event loop is already running
The  is the way to run some async code from the sync context. Under the hood it adds provided future to the given ioloop and calls  then returns result or throws exception (resolved future).Actually you need to , since the caller function is asynchronous.


Answer URL
https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.AbstractEventLoop.run_until_complete
