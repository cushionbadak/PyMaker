Natural Text
Say I have a Python class as follows: The  method will automatically be called any time I try to use an instance of  as a string, like in . Is there any equivalent for treating it as a number? For example, inwhere some hypothetical  function would be automatically called to interpret the object as a number. How could this be easily done?Ideally I'd like to avoid overloading every normal mathematical operator.
You can provide , , and/or  methods to convert objects to numbers. There is also a  method you can provide for custom rounding. Documentation here. The  method technically fits here too, since Booleans are a subclass of integers in Python.While Python does implicitly convert objects to strings for e.g. , it never converts objects to numbers without you saying to. Thus,  isn't valid just because  has an  method. You have to explicitly use  or  or  on them. At least that way, you know what you're getting just by reading the code.To get classes to actually behave like numbers, you have to implement all the special methods for the operations that numbers participate in, including arithmetic and comparisons. As you note, this gets annoying. You can, however, write a mixin class so that at least you only have to write it once. Such as:This class expects two special methods on the class it's mixed in with. - converts  to a number. Usually this will be an alias for the conversion method for the most precise type supported by the object. For example, your class might have  and  methods, but  will truncate the number, so you assign  in your class definition. On the other hand, if your class has a natural integral value, you might want to provide  so it can also be converted to a float, but you'd use  since it should behave like an integer. - a static method that obtains the numeric value from another object. This is useful when you want to be able to support operations with objects other than numeric types. For example, when comparing, you might want to be able to compare to objects of your own type, as well as to traditional numeric types. You can write  to fish out the right attribute or call the right method of those other objects. Of course with your own instances you can just rely on  to do the right thing, but  lets you be as flexible as you like in what you accept.A simple example class using this mixin:For extra credit, you could register your class so it'll be seen as a subclass of an appropriate abstract base class:For extra extra credit, you might also create a global  function that calls  on objects that have it, otherwise falling back to the older methods.
In case of numbers it a bit more complicated. But its possible! You have to override your class operators to fit your needs.Python Operators
Looks like you need  method.If you just wanna cast object to int - you should define  method (or ).


Answer URL
https://docs.python.org/3/reference/datamodel.html#object.__complex__
https://docs.python.org/3/library/operator.html
https://docs.python.org/3/reference/datamodel.html#object.__complex__
