Natural Text
Python 3.6This program:launches ffmpeg as a subprocess  waits for a socket connectionreceives PNG images on the socketsends the PNG images to ffmpegstdinThe problem is step 4.  I can't work out how to send the received PNG image from the coroutine to the stdin of the ffmpeg subprocess. Can anyone please point me in the right direction to send the PNG image to the stdin of the ffmpeg subprocess?EDIT: to clarify - there's nothing wrong with this code, it receives the PNGs fine over the socket.  I just don't have any idea how to send the PNGs on into the stdin of ffmpeg.  I've done quite alot of Python but asyncio is new to me and how things tie together is a mystery.thanks!Here are the changes suggested by @user4815162342
There are several issues with the code: should be  because the argument to  is the maximum number of bytes to read, and it can return fewer. should be changed to . The call to  is incorrect here because you want to continue talking to the program, while  waits for all the streams to close.The instance of process returned by  must be made available to , e.g. by making the  variable global using . (It would be better to use a class and assign to , but that is beyond the scope of this answer.)Some potential issues:There is no need to decode  from bytes to string,  can accept bytes just fine. doesn't appear to use its  parameter.


Answer URL
https://docs.python.org/3/library/asyncio-stream.html#asyncio.StreamReader.read
https://docs.python.org/3/library/asyncio-stream.html#asyncio.StreamReader.read
