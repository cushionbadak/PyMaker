Natural Text
I have a csv file with  couple of thousand rows and 4-64 coumns( I have about 50 CSV files and the number of columns may vary from file to file but each file has fixed number of columns).e.gSo, I need to first sum each row then add the two consecutive rows using some maths equation. What is the best pythonic way to do it? I can write the new value in a new file. So, the new file will have less number of rows than original file since it is merging value of two rows.e.g CSV1after summing across different column the value in row 1 is 0 and row 2 is 0. So, new file row 1 will be 0+0 = 0and third row in original file = 28 and row 4 =1So, row 2 in new file = 28+1 = 29
Load the data first:Now you need to process the rows in pairs, so a normal  loop iterating over the list won't help too much.(This assumes an even number of rows. The calculation of  will fail at the end if the row count is odd.)After that  loop executes, your  should be the output you need, and you just need to write it to a file.
If I understand your problem, what you want to do is pretty easy with some help from the stdlib.First, open the file:Then attach a , which turns it from an iterable of lines to an iterable of row lists:Each of these rows is a list of columns as strings. You obviously need to convert them to  or  or something else to do math on them:Now you need to convert that into an iterable of adjacent pairs of rows. If you look at the Recipes in the  docs, there's a  function that does this for any iterable. But it's simple enough to just do manually:Now,  is an iterable of pairs of rows. So we can loop over it:I'm not sure what you wanted to do with these pairs of rows. Maybe you wanted, I don't know, the square root of the squares of the differences of the columns? Whatever you want should be pretty easy:This will print out:â€¦ which I'm sure isn't what you want, because you wanted to do some different math than the math I picked out of thin air, but hopefully it's obviously why this is the result, and how to use the same structure for your actual problem.


Answer URL
https://docs.python.org/3/library/itertools.html#itertools-recipes
