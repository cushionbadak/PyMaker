Natural Text
I'm trying to decode some email text with Python 3's , where  is sourced from the  field of an email header.Problem: some emails list 'cp-850' as their charset while  accepts 'cp850'.If I simply get rid of the hyphen, then another codeset like iso-8859-6 becomes iso88596, which is an unrecognized encoding.How do I sanitize the arg  without creating more unknown encodings?[Edit] Follow up question: How do I get obtain the charset from an  object in a format (alias) that is accepted by ?[Edit] Clarified the question. Previously used an incorrect term 'content encoding' when I meant the charset.
You can remove the hyphen and check if there is a codec that supports the resultant encoding:
The  module contains a mapping from IANA character-set labels to the aliases used internally by Python; but chances are you won't need to do this yourself at all.Here is an adaptation of the example from the  module's Examples page in the Python documentationThis will get you the IANA character set label for the part's character set; but (by the default ) the text payload will have been decoded into Unicode for you, so you should not need to convert it yourself at all.The  library was officially overhauled in Python 3.5 (the overhaul was unofficially introduced  already in Python 3.3) with a policy-based system which allows you to take over some parts of message parsing if you really need to; but for well-formed standards-conformant messages (and some common mutations seen in the wild), you can just sit back and let the Python standard library do the work for you.However, as you note, the code actually fails to work with  body parts, precisely for the reasons you state.  You would expect this to work, but it doesn't:Instead, you have to hack Python's  module to support this alias:Notice also how, bewilderingly, the alias has an underscore which then gets mapped to a dash in some internal black voodoo magic.


Answer URL
https://docs.python.org/3/library/email.charset.html
https://docs.python.org/3/library/email.examples.html
