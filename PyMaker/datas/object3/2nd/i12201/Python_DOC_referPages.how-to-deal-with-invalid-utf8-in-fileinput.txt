Natural Text
I have basically the following code:The script takes a newline-separated list of file names as its input. However, some of the file names contain invalid utf8, which causes  to implode. I've read about the  error handler, which I think is what I want, but I don't know how to set the error handler for fileinput.In short: how do I get  to deal with invalid Unicode?
filenames on POSIX may be arbitrary sequences of bytes (except  and ) i.e., no character encoding can decode them in the general case (that is why  exists that uses  error handler).You could use a binary mode to read the filenames then either skip undecodable filenames if the input shouldn't contain them or pass them as is (or ) to functions that expect filenames:Beware, there were several known Python bugs related to using a binary mode and  e.g.:fileinput should use stdin.buffer for "rb" modefileinput.FileInput.readline() always returns str object at the end even if in 'rb' mode
Following documentation please use opening hook:


Answer URL
https://docs.python.org/3/library/os.html#os.fsdecode
https://docs.python.org/3/library/os.html#os.fsdecode
