Natural Text
I have implemented a simple HTTP server and a client. The latter issues a PUT request using the requests library, sending some arbitrary JSON and then exits.When I start the server, and then run the client, both the server and the client block. The server however appears to not have gone through the entire handler function yet.This is what I get on server side:That is, after printing the request line, the content JSON string is not printed. At this point both client and server block for some reason.Interestingly, when I trigger a  to the client, the server proceeds:My questions:Why is it necessary to kill the client to let the server proceed?Am I using any of these components the wrong way?How can I make client and server to operate (nearly) instantaneously?This is the code of the HTTP server. It only handles PUT requests. It prints the request line and the content data and responds using the success code to the client:This is the HTTP client. It is intended to connect to the server, write the request and return as soon as possible (but it doesn't):This is how I run it after the server has started (no output observable):
The server blocks both itself and the client on this line:That happens because you didn't specify the amount of data to be read so the server reads the input stream until it is closed. And in your case the input stream is closed once you kill the client.Remember that the server doesn't know a priori when the streaming of data ends because you may want to send data chunk by chunk (for example when you send big files).The size of request should be passed in  header so this is what you should do:That's assuming that the length is small enough to fit in your memory (and in your case it is).


Answer URL
https://docs.python.org/3/library/http.server.html
