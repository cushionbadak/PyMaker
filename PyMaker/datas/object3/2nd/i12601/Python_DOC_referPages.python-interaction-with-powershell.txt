Natural Text
I am a sysadmin and have been trying to get more in to coding. I really like using python so far and have been able to do a few cool things. However, one thing I am struggling with is the ability to essentially call a powershell script and read the output (ideally without putting it to a file).Here are two use cases:1) This drops me in a remote powershell session where I can do something like get-host and it will output the hostname of the remote computer.The main question I have is lets say I was able to run that command as part of the file I created (so it is outputting the response to 'get-host'). How can I bring that back to python? The way things work now is that I am brought in to a powershell session (actually a nested powershell session as it is a powershell session calling a shell on another machine). So yeah, is it possible to have the output of those commands make their way back in to python (maybe I wanted to set that response as a variable?)The second issue is something like this:In this case I'm never explicitly in a powershell session (from the user/UI perspective) but lets say there was an error or output from that command and I wanted to capture it, is it possible to do that?I'll gladly provide any additional information but I am essentially looking for a way to eventually run things like the Exchange Management Console from a python application which will let me do things like "press (1) to list the top 25 mailboxes by size" Or, eventually, "press (1) to generate a full environment report" which runs a number of powershell commands to get domain/ad/exchange information, as well as parses recent backup files, etc, in order to report on everything from system accessibility, latency, uptime, backup failures, eventlog stuff, recent changes, and output it all as one report.Thanks!
Use the  module instead of  (code shamelessly stolen from here):
You should look into Fabric(http://www.fabfile.org/).It is meant for exactly these kind of tasks.Hope that helps.


Answer URL
https://docs.python.org/3/library/subprocess.html
