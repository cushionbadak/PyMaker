Natural Text
I'm trying to create a list of available ports in Python. I am following this tutorial, but instead of printing the open ports, I'm adding them to a list.Initially, I had something like the following:This clearly works fine, but it is well known that comprehensions are faster than loops, so I now have:I assumed the sockets wouldn't be closed, but I tested it with the following:and indeed the open ports were printed.Why are the sockets closed in the comprehension but not the for loop? Can I rely on this behavior or is this a red herring?
There are no references left to your opened sockets, which means they are garbage collected. Sockets are closed as soon as they are garbage collected.Exactly when the sockets from your list comprehension are garbage collected differs between Python implementations. CPython uses reference counting and therefore closes the sockets as soon as the last reference is dropped. Other implementations might defer the closing to the next GC cycle.


Answer URL
https://docs.python.org/3/library/socket.html#socket.socket.close
