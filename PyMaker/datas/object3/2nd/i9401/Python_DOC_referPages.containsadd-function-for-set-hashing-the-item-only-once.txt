Natural Text
This question already has an answer here:Python: how to check if an item was added to a set, without 2x (hash, lookup)                    1 answer                I'm looking for a way to add a  to a  but I also need to know if the value was in the  before I added it. With the additional restriction that the  of the value is only calculated once (if it wasn't contained before I added it).It would be quite easy without the restriction:But unfortunatly the  method of the value is quite expensive and I can't (easily) change that class.
One way would be to create a temporary  containing the  and then using  and  - both don't require to recalculate the :To verify that this only calculates the  once:However this approach is definetly slower than the function presented in the question if the  function isn't expensive!Another way (not really recommended because it uses private functions) is to use the Python-C-API (3.5+) of  (if one assumes that a  would be an acceptable alternative to a ). Here simulated with Cython:On the plus side  is really fast (faster than the function presented in the question) but as it (mis-)uses private functions only avaiable for python 3.5 and later it may not be a good alternative.


Answer URL
https://docs.python.org/3/library/stdtypes.html#set.isdisjoint
https://docs.python.org/3/library/stdtypes.html#set.update
