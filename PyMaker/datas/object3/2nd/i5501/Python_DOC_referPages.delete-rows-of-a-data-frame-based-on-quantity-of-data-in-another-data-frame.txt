Natural Text
I have two pandas data frames  and .  is a subset of A.I want to delete all numbers from A if it's in B. But, if a number occurs two times in A and 1 time in B then it will only delete 1 occurrence of the number from A.Here is my sample data sets:After the operation I want new data frame c asCan you please suggest how to do that?The suggested duplicate removes all occurrences from  if present in , not just the first N occurrences.
I might do something (stealing SR's setup):which gives meThis works by using groupby to get the number of times a given value in A has been seen before:and using  to get the limits which we then reindex to match the counts:
If you create some intermediate values which contain the occurrence number for each value, then you can use  to create a logical index of which rows of the dataframe to exclude like:Code:Test Code:Results:
In this problem, you can make use of  and . For drop, you will need to know the indexes of rows that you want to discard. generates those indexes that fits the value  in the counter with  and has a  to limit the size of indexes we take from. Then, we merge these  with . Finally drop rows with these indexes.Thanks for Stephan Ranch to point out the order problem.


Answer URL
https://docs.python.org/3/library/collections.html#counter-objects
