Natural Text
Suppose I have two dataframes  and What is an easy and generalized way to interweave two dataframes' columns.  We can assume that the number of columns in  is always one less than the number of columns in .  And, the indices are the same.I want this:
Using  to combine the DataFrames, and  reorder the columns:The resulting output is as expected:
Here's one NumPy approach -Sample run -
Interweave the columns:Now, do a join and re-order with boolean indexing:You may prefer  when dealing with multiple dataframes.
we can use itertools.zip_longest:
write a function to abstract away the generic merge-reorder
My solution was to use  making sure to insert from the back first
The  itertools recipe has an interleaving characteristic.  This option offers the choice between directly implementing the recipe from the Python docs, or importing a third-party package such as  that implements the recipe for you:Inspired by @root's answer, the column indices are interleaved and used to slice a concatenated DataFrame.


Answer URL
https://docs.python.org/3/library/itertools.html#itertools-recipes
