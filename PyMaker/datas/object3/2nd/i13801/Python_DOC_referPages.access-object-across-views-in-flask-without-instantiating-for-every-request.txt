Natural Text
I'm writing a small Flask application and am having it connect to Rserve using pyRserve. I want every session to initiate and then maintain its own Rserve connection. Something like this:doesn't work because the connection object is not JSON serializable. On the other hand, something like this:doesn't work because it does not persist between requests. To add to the difficulty, it doesn't seem as though pyRserve provides any identifier for a connection, so I can't store a connection ID in the session and use that to retrieve the right connection before each request.Is there a way to accomplish having a unique connection per session?
The following applies to any global Python data that you don't want to recreate for each request, not just rserve, and not just data that is unique to each user.We need some common location to create an rserve connection for each user.  The simplest way to do this is to run a  as a separate process.Run it before starting your application, so that the manager will be available:We can access this manager from the app during requests using a simple function.  This assumes you've got a value for "user_id" in the session (which is what Flask-Login would do, for example).  This ends up making the rserve connection unique per user, not per session.Access it inside a view:This should get you started, although there's plenty that can be improved, such as not hard-coding the address and password, and not throwing away the connections to the manager.  This was written with Python 3, but should work with Python 2.


Answer URL
https://docs.python.org/3/library/multiprocessing.html#managers
