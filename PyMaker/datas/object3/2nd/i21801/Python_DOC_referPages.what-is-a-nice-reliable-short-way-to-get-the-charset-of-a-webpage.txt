Natural Text
I'm a bit surprised that it's so complicated to get a charset of a webpage with Python. Am I missing a way? The HTTPMessage has loads of functions, but not this.So you have to get the header, and split it. Twice.That's a surprising amount of steps for such a basic function. Am I missing something?
Have you checked this?How to download any(!) webpage with correct charset in python?
I did some research and came up with this solution:This is how I would do it in Python 3. I haven't tested it in Python 2 but I am guessing that you would have to use  instead of .Here is how it works, since the official Python documentation doesn't explain it very well: the result of  is an  object. The  property of this object is an  object, which, according to the documentation, "is implemented using the  class", which has a method called , which tries to determine and return the character set of the response.By default, this method returns  if it is unable to determine the character set, but you can override this behavior instead by passing a  parameter:
You're not missing anything. It's doing the right thing - encoding of a HTTP response is a subpart of Content-Type.Note also that some pages might send only  and then set the encoding via  - that's an ugly hack though (on the part of the page author) and is not too common.
I would go with chardet Universal Encoding Detector.You are doing right but your approach would fail for pages where charset is declared on  tag or is not declared at all.If you look closer at Chardet sources, it has a  modules that deals with this problem nicely.


Answer URL
https://docs.python.org/3/library/urllib.request.html#urllib.request.urlopen
https://docs.python.org/3/library/http.client.html#httpresponse-objects
https://docs.python.org/3/library/http.client.html#httpmessage-objects
https://docs.python.org/3/library/email.message.html#email.message.Message
https://docs.python.org/3/library/email.message.html#email.message.Message.get_content_charset
