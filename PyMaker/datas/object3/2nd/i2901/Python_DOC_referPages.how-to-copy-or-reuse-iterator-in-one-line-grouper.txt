Natural Text
I'm trying to do grouping in python in a one line expression. I want to build a  of groups and number of items in the group:But  is an iterator and it does not work in second use with . How can I do counting and reusing  in one line expression?
You can't call  on an iterator more than once, no. You have to store the result first.Your options are, in order of feasibility:To not use a one-liner. Use a regular  loop and assign the  result to a separate variable first.Wrap the  iterator in a generator expression that applies  to the group object.Add a second loop over with a single element tuple, the  call, so you can use the loop target as a variable for both keys in the dictionary you are building.Wait until Python 3.8 which adds PEP 572 assignment expressions and assign the  call result to a name to re-use for The first should be the preferred option. Readability counts!Using a generator expression is perhaps the next best option:The generator expression loop is executed in parallel as  iterates.The second-loop option looks like this:Because this trick is surprising and hard to read, I strongly recommend against using it.In Python 3.8, with PEP 572 implemented, you can use:Iterators can be 'doubled' by using the  object, but that has to then cache the whole list in memory separately, doubling the memory cost and the code would become no more readable (as you'd have to use a similar trick then to store the  call iterators in variables too!).


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.tee
