Natural Text
If I create a Python dataclass containing a Numpy ndarray, I can no longer use the automatically generated  anymore.ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()This is because  sometimes returns a  of truth values, by comparing  to , and so on and so forth to the longer of the 2. This is quite complex and unintuitive, and in fact only raises an error when the arrays are different shapes, or have different values or something.How do I safely compare es holding Numpy arrays?'s implementation of  is generated using . Its source is missing from the stacktrace and cannot be viewed using , but it's actually using a tuple comparison, which calls bool(foo).excerpt:
The solution is to put in your own  method and set  so the dataclass doesn't generate its own (although checking the docs that last step isn't necessary but I think it's nice to be explicit anyway).


Answer URL
https://docs.python.org/3/library/dataclasses.html#dataclasses.dataclass
