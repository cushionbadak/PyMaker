Natural Text
How would I go and create a queue to run tasks in the background in Python?I have tried via asyncio.Queue() but whenever I use Queue.put(task) it immediately starts the task.It is for an application which receives an unknown amount of entries (filenames) from a database on a specified time interval. What I wish to accomplish with this backgroundqueue would be that the python application keeps running and keeps returning new filenames. Everytime the application finds new filenames it should handle them by creating a task, which would contain (method(variables)). These tasks should all be thrown into an ever expanding queue which runs the tasks on its own. Here's the code.As I said, this will instantly run the task.  is a pretty time consuming method in a static class.
There are two problems with this expression:First, it is actually calling the  method and is enqueueing its result. This is not specific to , it is how function calls work in Python (and most mainstream languages). The above is equivalent to:The second problem is that  operations like  and  are coroutines, so you must await them.If you want to enqueue a callable, you can use a :But since the consumer of the queue is under your control, you can simply enqueue the file names, as suggested by @dirn:The consumer of the queue would use  to read the file names and call  on each.If you plan to use asyncio, consider reading a tutorial that covers the basics, and switching to an asyncio compliant database connector, so that the database queries play along with the asyncio event loop.
For people who see this in the future. The answer I marked as accepted is the explanation of how to solve the problem. I'll write down some code which I used to create what I wanted. That is, tasks that should run in the background. Here you go.The queue created is not a queue for tasks, but for the variables you want to handle.Then for the , which consumes the items in the queue when there are items:It seems the  waits for new entries, even when there are none. The -simplified- code above works for me, I hope it will also work for others.


Answer URL
https://docs.python.org/3/library/asyncio-queue.html#asyncio.Queue.put
