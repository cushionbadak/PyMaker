Natural Text
While experimenting with patching a context manager at runtime, I noticed that the following code does not behave as I expected:Executed, this prints:While the first part of , with the explicit calls to , behaves as expected (the method is correctly modified), the -statement seems to ignore this.After some search, I found that the according PEP 343 shows an example translation, which explains the behaviour; namely, the translation of the  internally uses something likeinstead of a direct method call, like I was doing above.And I was wondering why that is done. Is it just to prevent people like me from messing around, or is there a deeper reason?
There is something called special method lookup defined in the language description. Basically, this kind of lookup (using ) happens for all "magic methods"; two reasons are given:Performance optimizations are possibleThere are cases with only work correctly with this variant, namely when special lookup defers to the type (like,  being not the same thing as , which we usually really want)


Answer URL
https://docs.python.org/3/reference/datamodel.html#special-method-lookup
