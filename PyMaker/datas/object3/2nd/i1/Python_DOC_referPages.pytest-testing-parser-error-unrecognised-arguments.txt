Natural Text
I'm trying to test a very simple function (as a result of multiple failed attempts at testing a more complicated function which uses the argument parser as a parameter).# from ./runfile.py# from ./tests/test_args.pyWhen I run the script  all works as expected, however when I call  I get the unrecognised arguments error message below.I've tried setting up a  file and using addoption but I just seem to be encountering more errors far beyond my experience to fix. Can anyone point me in the right direction of how to run the test using the default arguments from the core script but not have  being called as an argument for the actual test itself?
The problem comes from the  call which accepts an optional  argument. If this argument is not provided, args are taken from .When you execute ,  contains . The first element of the list is the called program and the second is the first argument.Thus,  called without its  argument considers tests/test_args.py as the value for the first declared argument of the parser. Fortunately, it is unable to parse it and an error occurs with the explicit message unrecognized arguments: tests/test_args.py.To check it, you can add a breakpoint in your test before calling  and inspect Invoking  without specifying the file to run (just ) should pass with no problem.Anyway, your test should pass whatever the manner it is ran. All you have to do for this is specifying explicit  for your  call in your test.For example, passing an empty list will work:But you will probably want to test it with values for the  option:


Answer URL
https://docs.python.org/3/library/argparse.html#the-parse-args-method
https://docs.python.org/3/library/sys.html#sys.argv
