Natural Text
I'm trying to patch dependencies with my errbot tests. The problem I'm having is how errbot imports modules. It is not static and breaks my patch decorators as I add tests or they test in a different order.I have plugin called EDB (edb.py). Inside of edb.py I import pyedb with . This is located in my .I have my test file test_edb.py and I try to patch my test methods like thisErrbot adds this  path for module import but the xx depends on the order the test is run. This doesn't work, I need some static import path .I'm hoping there is a different way to approach this. Maybe I can change the how I import the module so it's not dependent on errbot imports? Here is a link to Errbot testing for reference.
My solution feels a bit hacky but it works. If anyone has a more elegant solution please share. I'll accept my own answer after awhile if there are no additional responses.So I've come across this before but I guess I still wasn't familiar enough with how patching works in Python with knowing where to patch. After reading the "Where to patch" documentation ( again :) ) I have a work-around given the dynamic imports with errbot.An errbot project folder will look somethingI noticed that when errbot runs both the project directory  and all the plugin directories (e.g. ) are added to .So I added a package to my project directory and I import that in my plugins. I then can patch my dependencies reliably from that package. Again read the Where to Patch documentation for full explanation why. It looks something like this.Where my  looks likeAnd then in my plugin I useAnd finally my test code looks like


Answer URL
https://docs.python.org/3/library/unittest.mock.html#where-to-patch
https://docs.python.org/3/library/unittest.mock.html#where-to-patch
