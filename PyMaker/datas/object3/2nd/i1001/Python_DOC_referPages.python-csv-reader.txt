Natural Text
I have a CSV from a system that has a load of rubbish at the top of the file, so the header row is about row 5 or could even be 14 depending on the gibberish the report puts out. I used to use: to go through the rows that had less than 2 columns, then when it hit the col headers, of which there are 12, it would stop, and then I could use idx with skiprows when reading the CSV file.The system has had an update and someone thought it would be good to have the CSV file valid by adding in 11 blank commas after their gibberish to align the header count.so now I have a CSV like:etc.. I tried: but I think that's a Pandas thing and it just fails. Any ideas on how i can get to my header row?CODE: 
Since your  is now a valid file and you just want to filter out the header rows without a certain amount of columns, you can just do that in  directly.If your  data have a lot of empty values as well that gets caught in this threshold, then just slightly modify your code:I'm not sure in what case a  would return, so the  should do.  If your headers for whatever are duplicates as well, do this:
And how about erasing the starting lines, doing some logic, like checking many ',' exist's or some word. Something like:after that, read normaly the file.


Answer URL
https://docs.python.org/3/reference/expressions.html#comparisons
