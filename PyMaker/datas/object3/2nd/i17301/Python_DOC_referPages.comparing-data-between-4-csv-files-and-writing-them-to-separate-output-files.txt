Natural Text
Could someone please advice me on how I could improve my code? I have 4 big csv files. The first is a reference file to which 3 other files (file1, file2 and file3) are compared to. In the files, there are three columns. Each row is a unit (e.g. ABC, DEF, GHI are 3 separate units).I would like to compare file1, file2 and file3 to the reference file. If unit for each row in the reference file is present in all 3 files, I would like to write them into file A. If unit for each row is present in at least 1 of the 3 files, they should be written to file B. If unit for each each row is not present in any of the 3 files, I would like to write them in file C. My current strategy is to append the files as 4 separate lists and to compare them. I realize that this approach is memory intensive. In addition, my script has been running for a long time without final output. As such I was wondering if there is a more efficient approach to this problem?Below is my code:
Assuming the order of the rows is not important and that there aren't duplicate rows in the reference file, here is an option using .The idea is:Create sets containing each line of a file.Make a set () that contains every line in every file (except the reference file).Make a set () that contains only the lines that are in every file, including the reference file.Make a set () that contains the lines in the reference file that also appear in at least one but not all of the other files.Make a set () that contains the lines only present in the reference file.Write , , and  to files.


Answer URL
