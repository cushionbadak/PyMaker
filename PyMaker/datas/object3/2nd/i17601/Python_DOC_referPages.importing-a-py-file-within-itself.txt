Natural Text
This is test.py:The above python code when ran on system generates the following output:What I am confused why is not there an infinite loop of "Here 1 \n Here 3" outputs. How can the print a, b outputs can be justified?
When you run the file as a script, it is not considered to be the  module. It is considered to be the  module.When execution hits , a second execution of the file starts, where the module is considered to be .When execution hits  again, Python recognizes that it's already importing  and does not reexecute the module. Instead, it merely loads the half-initialized  module object into the current namespace and continues on. Python's optimistic assumption is that you've written the code so that the contents of  won't be needed until the import finishes.When execution hits the assignments to  and , that affects the  module, but not , despite the fact that they came from the same file. Thus, the  from the imported module reflects the new values, while the  from  reflects the initial values.
A file can only be imported once. The 'import test' line succeeds the first time it is encountered. When it is encountered a second time, the interpreter will check that it has already been loaded. When a program is initially run, it does not count as being 'imported'.
The general flow of this script is as follows:Main is run, so it prints 'Here 3'change is called, so it prints 'Here 1'When importing test, python runs the main function of testWhen calling change the second time, python is smart enough to know that test is already imported, so it effectively skips that line.The imported main finishes runningThe original script finishes running.
While user2367112's excellent answer explains why this happens, none of the answers here offer a workaround.There are two easy ways to achieve the desired behavior.Rather than importing , use  instead. If you assign an alias with , you won't even have to change any other code.You can set  to tell python "Hey, this module already exists". After this,  will not re-import the module, thus making your code work as expected. The relevant docs on  can be found here.


Answer URL
https://docs.python.org/3/library/sys.html#sys.modules
