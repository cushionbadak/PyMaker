Natural Text
The documentation for the  module makes the following assertion:NoteUsing access() to check if a user is authorized to e.g. open a file before actually doing so using open() creates a security hole, because the user might exploit the short time interval between checking and opening the file to manipulate it. Itâ€™s preferable to use EAFP techniques. For example:is better written as:I don't understand how a user "might exploit" the interval.  If  was going to raise an exception, I'm not sure how  would prevent that exception from being raised.  Likewise, if the user manipulate the file somehow, why not perform the file manipulation prior to the EAFP version's  command?I do understand that the second version may be more robust, since  may fail to correctly recognize a condition that could raise a , but I don't see how the LBYL version is less secure.  Can someone explain this?
While the -using code is unsafe, the second code snippet doesn't solve the security issues. These docs should be changed.The purpose of  is to test whether the real user id has permission to access a file when the real and effective user ids are different. The danger with the  snippet is that the user could place a file  returns  for in the location being tested, then swap it out for a file  would have returned  for, bypassing the check. Since  uses the effective user id, the  call can still work, bypassing the  check.The second snippet doesn't solve this problem. Now the user doesn't even need to go through the switcheroo. No part of the second snippet checks the real user id.


Answer URL
https://docs.python.org/3/library/os.html#os.access
https://docs.python.org/3/glossary.html#term-eafp
https://docs.python.org/3/glossary.html#term-lbyl
https://docs.python.org/3/library/os.html#os.seteuid
