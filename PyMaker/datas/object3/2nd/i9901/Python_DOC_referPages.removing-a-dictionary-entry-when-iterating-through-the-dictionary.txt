Natural Text
So I have a function setup to where it will run an SSH client to remote into a device, or attempt to do so. If it fails, it will try a secondary connection, remote in to activate the in-band IP, and then rerun the initial function in a recursive loop.The problem I am having is after the connection to the secondary connection is successful and in-band IP is activated, the ssh connection attempt starts over. Unfortunately, the for loop goes to the beginning of the dictionary again, going through connections already previously connected to. I am trying to removing the dictionary entries after the connection is successful, but I can't do because the entry is currently being used. I get a runtime error.
You could store your entries in a separate list and remove them afterwardsPseudocode:
Use popFor example d.pop('a',0)Where a is the key which you want to delete and the key value pair will be removed feom the dictionary
Use popitem with a while-loop:
Here is what I did:I was having an issue with pop and del raising errors, so I created a separate SSH function that used the current device IP in the loop. This way, I wasn't iterating through the loop multiple times. Here is the separate function:rootpass is for the SCP server, device_ip is the switch/router IP, device is a parameter required for netmiko (SSH client I'm using), DeviceName is the current hash value in the dictionary.Successful connections had to be declared from the bigger function with:Same with unsuccessful connections. This would allow me to determine devices that couldn't connect afterward.


Answer URL
