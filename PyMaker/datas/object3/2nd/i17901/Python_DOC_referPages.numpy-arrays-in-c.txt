Natural Text
I've only just started C and am trying to make a backend for my python. At the moment I have a cumbersome system of writing huge input files (at least 10^6 floats) from the python then initialising the C (which has to load in lots of other data as well) running the C until termination, receiving its output only to have to reinitialize it again with a new input array.I'm not sure if it is conceptually possible from looking around but I was hoping to just be able to direct the C to a memory address for a numpy array and use it as though it is an array made by the C. The aim is for the python to initialise the C, build its first array, run the C code until it is ready for the next array which will then be generated by python.This is some dummy code that I wrote to try and get C to read numpy arrays. At the moment the C just has a segmentation fault and I'm not sure if its because I'm bad at C, it doesn't like reading the numpy arrays or a bit of both.Front.pyarray_interface was from here.Back.cIs it possible to have C read numpy arrays like this or is this approach fundamentally flawed? Is there a better way of doing it? if this does work, is it possible to use a Ctype bool, that both processes know the address of, to coordinate which process is working and which is waiting?  e.g. python sets the value to 1 as it initialises the numpy array -the C is waiting stuck in a while(sp_bool==1) loop. Then when python is finished it changes the value to 0 and the C executes, finally changing the value back to 1 when it finishes.
It sounds like your best option might be to call C code from python. Not only is that very much possible, it's actually how numpy is written. Numpy is mostly written in C so when you do  python passes  and  to numpy's C code, the C code makes an output array for the results, adds the elements of the input arrays putting the result in the output array, and returns the output array.I think the easiest way for you to make your C code available in python is to wrap it using cython. Here are two tutorials that hopefully will get you moving in the right direction. How to call existing C code from cython and how to use numpy arrays in cython.Also I should mention that you can access numpy arrays from C code using the numpy c api, this probably will be harder for you than using cython because you're new to C, but it's another way to go if you chose that route.


Answer URL
