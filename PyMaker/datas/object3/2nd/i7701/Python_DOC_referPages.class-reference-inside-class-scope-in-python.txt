Natural Text
Some ContextI have the following django/python snippet:I am using Django with the  library installed. One of the interesting features I am using is  (ModelSerializers Documentation), which save quite a lot of code repetition. I want  variable to be populated on runtime (when all the serializer classes are declared). The whole point of this is that I will not have to update my views whens a new type of model is included. For example, I would print the json representation of my model instances like this:The ProblemThe major problem is in the last line of each  class.I've tried putting the name of the class,  for example, to no avail. I've tried doing the same outside of the  class, such as:also not successful. Not sure what else to do, which is why I'm hoping the community can help me on this one.
This is actually a case for defining a metaclass.I've never actually found a source of information which gives a complete, clear and satisfactory explanation as to what metaclasses are or how they work. I will try to enhance this answer with such information if required but for the time being I am going to stick to a solution for your present problem. I am assuming python 3.Define an additional class, thus:Then use this as the metaclass of your Serializers, e.g.Better yet, create some superclass for all your model serializers, assign the metaclass there, make all of your serializers inherit from that superclass which will then use the metaclass throughout.
Metaclasses are definitely the right answer unless your code can require python >= 3.6.  Starting with 3.6 there is a new feature called the  hook.So you can do something likeWhenever a child of  is defined, the  method on  will be called, passing in the child class reference as .


Answer URL
https://docs.python.org/3/whatsnew/3.6.html
