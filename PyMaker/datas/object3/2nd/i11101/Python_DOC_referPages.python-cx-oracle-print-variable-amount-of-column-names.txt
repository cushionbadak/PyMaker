Natural Text
Based on a given SQL-Statement, I extract from a database to CSV with thefollowing function:How can I write in the beginning of the file the column names for a variable amount of columns, so that I don't have to hardcode it? Also the hardcoded concatenation is pretty ugly.
You could use the descriptionfunction.  It returns a sequence of 7 item sequences and you can get the column names fromI would also recommend using pandas to do your writing to csv.
Ebrahim Jackoet has already mentioned that you can use cursor.description to get the column names from your query. If you don't have a very large number of rows to process, though, the csv module is built in and makes writing rows simple. It also handles all of the necessary quotingAn example follows:


Answer URL
https://docs.python.org/3/library/csv.html%20csv
