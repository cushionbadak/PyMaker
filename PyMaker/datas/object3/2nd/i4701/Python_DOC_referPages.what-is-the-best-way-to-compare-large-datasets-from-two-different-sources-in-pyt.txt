Natural Text
I have large datasets from 2 sources, one is a huge csv file and the other coming from a database query. I am writing a validation script to compare the data from both sources and log/print the differences. One thing I think is worth mentioning is that the data from the two sources is not in the exact same format or the order. For example:Source 1 (CSV files):Source 2 (Database):The output of the script I want is something like:The output format could be a little different to show more differences, more clearly (from thousands/millions of records).I started writing the script to save the data from both sources into two dictionaries, and loop through the dictionaries or create sets from the dictionaries, but it seems like a very inefficient process. I considered using pandas, but pandas doesn't seem to have a way to do this type of comparison of dataframes.Please tell me if theres a better/more efficient way. Thanks in advance!
You were in the right path. What do you want is to quickly match the 2 tables. Pandas is probably overkill. You probably want to iterate through you first table and create a dictionary. What you don't want to do, is interact the two lists for each elements. Even little lists will demand a large searches.The ReadCsv module is a good one to read your data from disk. For each row, you will put it in a dictionary where the key is the email and the value is the complete row. In a common desktop computer you can iterate 10 millions rows in a second. Now you will iterate throw the second row and for each row you'll use the email to get the data from the dictionary. See that this way, since the dict is a data structure that you can get the key value in O(1), you'll interact through N + M rows. In a couple of seconds you should be able to compare both tables. It is really simple. Here is a sample code:If you don't have enough RAM memory to fit all the keys of the first dictionary in memory, you can use the Shelve module for the firstTable variable. That'll create a index in disk with very quick access. Since one of your tables is already in a database, maybe what I'd do first is to use your database to load the data in disk to a temporary table. Create an index, and make a inner join on the tables (or outer join if need to know which rows don't have data in the other table). Databases are optimized for this kind of operation. You can then make a select from python to get the joined rows and use python for your complex comparison logic. 
You can using  convert the df , the using  after Notice , here I am using the  to convert to numeric for your df2


Answer URL
https://docs.python.org/3/library/shelve.html
