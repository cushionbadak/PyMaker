Natural Text
My very simple example project contains:My  is just:My  is just:My  contains:I would expect that running  would do nothing, since no unit tests are written. However, running it in a clean virtualenv (Python 3.6.6 on Ubuntu 18.04.1) gives me:Note the  which means it's invoking the console script it generates from my  (or maybe just calling ).Why is  calling the console script when I want it to run tests? Further inspection of the script's execution shows that  is  - why?
The test scanner in setuptools will look for tests in any  file found in your sub-directories, except for . Yes, this includes , it will call  on it, causing its main suite to be executed.If you want to be able to run  and have that run your  code, you may want to add the standard 'run only if this is really main' protection:(then, if you do  the code will run, but it won't run if the file is loaded by )
The setuptools docs explains how setuptools scans for unit tests by default.Since, as you say, no unit tests are written or specified,  can be using default behavior.A couple references from the setuptools docs that elaborates on this as well as specifies how to set up test suites are below: If you would like to use a  different way of finding tests to run than what setuptools normally  uses, you can specify a module name and class name in this argument.  ...  The module name and class name must be separated by a :. The default value of this argument is . If you want to use the default unittest behavior, you can specify  as your  argument instead. This will prevent automatic scanning of submodules and subpackages....  A string naming a  subclass (or a package  or module containing one or more of them, or a method of such a  subclass), or naming a function that can be called with no arguments  and returns a . If the named suite is a module, and  the module has an  function, it is called and the  results are added to the tests to be run. If the named suite is a  package, any submodules and subpackages are recursively added to the  overall test suite.Specifying this argument enables use of the  command to run the  specified test suite, e.g. via . See the section on the   command below for more details.  ...This, in conjunction with another answer on this thread leaves you with at least a couple of options to ensure that  doesn't run the console script:Configure how  looks for test suites.Add  around Yet another option may be given by the unit testing library you're using. For example, Pytest has an integration guide for  that replaces the  command with its own.Regarding the sysargs is  because you invoked  with the args 
I think you have to specify the entry point for test in your setup.py. Otherwise it passes it to the main.py.


Answer URL
https://docs.python.org/3/library/sys.html#sys.argv
