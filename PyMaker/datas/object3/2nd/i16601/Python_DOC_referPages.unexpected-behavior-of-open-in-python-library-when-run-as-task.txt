Natural Text
I have custom python library installed on my NAS which has this code:This code is invoked by app.py which saves returned text to file.When app.py is run from SSH, it saves the content of session.txt as intended.But when app.py is run as task (run.sh), it saves exception "'ascii' codec can't decode byte 0xc3 in position 12: ordinal not in range(128)". Yeah, the file contains "รก" in position 12, so I add encoding="utf-8" to open() function. And this fails (does not save anything, so I don't even know if and what error it threw.)QUESTIONAny ideas how to safely open and read text file by python library (when by regular script, runs correctly even if it is run as task)?FILES involvedlibrary:app.py:run.sh:session.txt and logs folder is located in the same directory as app.pyOUTCOMESRun from SSH python3 /volume1/web/python/app.py -> saves content of session.txt to log fileRun from SSH /volume1/web/python/run.sh -> does the same as 1.Run run.sh file as task (something like cron job) -> does not create log fileWhen I remove encoding='utf-8' statement from open function, in SSH run correctly, in task throws an exception ('ascii' codec can't decode byte 0xc3 in position 12: ordinal not in range(128))
I'm a little puzzled, but here's my guess:  defaults to the shell's preferred encoding, and your NAS's locale is somehow set differently than your local shell's. I think that  is the fix for your current issue.Now, you say that doesn't work either. I'm not sure what you mean by "does not save anything" -- my guess here is that your script needs to save its output to a file, and the NAS daemon doesn't have permissions to write to that file. You don't say what the call responsible for the saving to disk actually looks like, but I believe that's a separate issue from the problem with your encoding. 


Answer URL
https://docs.python.org/3/library/functions.html#open
