Natural Text
I want to mock all test methods of a .My first try to use  did not work, since  finishes before the test methods gets executed.I can't mock the real test method with this inside :I guess I am missing something.How to use  for all methods of a test case?
 is a context manager, the patch is unapplied when the context ends, and the context ends at the end of the block of code.That means that the patches are unapplied again when  ends.Your options are to either use  as a class decorator or to use the  and  methods on the patchers.Using  as a class decorator has the same effect as applying it as a decorator to each and every test method:Here both  and  are passed in a mock object because the  class decorator has found all test methods and decorated them.Using the start and stop methods lets you apply and unapply patches in the  and  methods:Here  is started on set-up, and stopped again when the test is torn down. This acts just like the context manager, but instead hooks into the test boundaries.Instead of using a , you can also register the  as a cleanup function with :
You can use , . (See patch methods: start and stop).For example:
The most general solution, which works for all context managers is:


Answer URL
https://docs.python.org/3/library/unittest.mock.html#patch-methods-start-and-stop
https://docs.python.org/3/library/unittest.html#unittest.TestCase.addCleanup
https://docs.python.org/3/library/unittest.mock.html#patch-methods-start-and-stop
