Natural Text
I'm trying to visit a website every X seconds with parallel and separate sessions, then analyse what is in the response to see if each session should continue or not. However, once the code reaches the second loop it fails.This code returns the following error:13:56:58.604 Task exception was never retrieved  future: Task finished coro= initialise() done, defined at  C:/Users/x/PycharmProjects/tests/src/aiohttp_main.py:49  exception=RuntimeError('Session is closed',)  RuntimeError: Session is closedI just can't work out how to make the sessions stay alive until I .close() them...
I just can't work out how to make the sessions stay alive until I .close() them...The  is a request to close the session. Which means that after you write:...you can no longer use  once the body of  is done executing. This is not specific to aiohttp, it's how  works in Python. For example, when working with files,  is a request to close the file:The fix is simple enough, just move the  outside the  loop. For example:On an unrelated note, you probably want to replace  with a global counter of your own. Using  in this way can start producing incorrect results if you later incorporate other unrelated tasks into the event loop (or a third-party library does that for you).


Answer URL
https://docs.python.org/3/library/asyncio-task.html#asyncio.Task.cancel
