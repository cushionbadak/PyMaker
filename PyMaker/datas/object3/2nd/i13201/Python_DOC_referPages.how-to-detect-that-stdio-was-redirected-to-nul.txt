Natural Text
I'm developing a package to fix several issues with Unicode in Python run in standard Windows console environment: https://github.com/Drekin/win-unicode-console. The key operation is to replace the standard stream objects when needed. For this I need to detect whether the standard streams were redirected or not. Python method  works OK with one exception: If a stream was redirected to , then  returns .My question is how to detect whether a Windows handle leads to a console or to ? Is there a WinAPI function for that?
The C runtime's  function returns true for files that access character devices, i.e. files for which  returns . To detect a console handle in particular you can call . This call fails for a non-console handle. To get the underlying Windows handle to pass to this function, call . For example:


Answer URL
https://docs.python.org/3/library/msvcrt.html#msvcrt.get_osfhandle
