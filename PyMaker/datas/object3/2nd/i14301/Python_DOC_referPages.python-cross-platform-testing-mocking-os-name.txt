Natural Text
what is the correct way to mock ?I am trying to unittest some cross-platform code that uses  to build platform-appropriate strings. I am running on a Windows machine but want to test code that can run on either posix or windows.I've tried:production_code.pytest_code.pythis fails because  is not in the global scope for the . If 'os' is ed in  then we will always get .I've also tried:in the test, but this seems not to work because  is an attribute not a method with a return value.EDIT:clarifications in response to commentsThe mock docs (1st paragraph) make it seem like directly monkey patching  could get messy if e.g. an assertion gets raisedWe really are only changing a path based on . Whilst tests will be run on windows and posix machines I wanted something that gave full coverage without needing to resource a machine every time a small edit is made.
According to Where to patch you should patch  in . By you are creating a 's reference in  module called : after that (loaded at import time) change  have no effect  reference. 


Answer URL
https://docs.python.org/3/library/unittest.mock.html#where-to-patch
