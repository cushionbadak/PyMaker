Natural Text
After loading a DataFrame with Panda (from a csv) with this structure:I am thinking how to efficiently use the first 3 & last 3 columns to generate 2 datetime columns, say 'startdate' and 'enddate.' Since there are missing values that need to be dealt with, the parse_dates & date_parser arguments in read_csv seem a bit unwieldy, so I wrote the function below.First, I fill the NaN value so as to cast month and date from float to integer, and then string them together for parsing.The resulted error message is a bit confusing, as the string format should be exactly the same with what strptime expect.I also tried another parsing package that turns most of the datetime string in English language into datetime variable without issue:And it also results in error (ValueError: Unknown string format)...Any thoughts on how to improve the function are much appreciated. It is also a bit strange for me that most package functions only converts string to datetime, and one needs to make integers/floats into string even if it shouldn't be that hard to directly convert numerical data into datetime formats... did I miss some obvious solutions?
Although not absolutely sure, the issue seems to be that I am trying to feed the parser a pandas Series while they expect only to take string.In this cae, Panda's own to_datetime function can do the work.


Answer URL
https://docs.python.org/3/tutorial/errors.html#handling-exceptions
