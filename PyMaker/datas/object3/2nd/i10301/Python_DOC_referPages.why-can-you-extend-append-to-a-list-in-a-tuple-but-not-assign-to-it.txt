Natural Text
This question already has an answer here:Append to a list defined in a tuple - is it a bug? [duplicate]                    4 answers                Inspired by reading footnote 4 of this article.Consider the following scenario:Tuples are immutable. So, as expected, trying to add to the list inside the tuple raises an error.However if we inspect our tuple, the list has been added to!! (I can imagine this leading to very hard to track down bugs)Also, both extendingand appendingwork without raising an error.So, my questions are:If tuples are immutable, why is it possible to change a list within a tuple?Why does the first example raise an error and the other two not?In the first example, why is the list inside the tuple changed even though an error is raised?
If tuples are immutable, why is it possible to change a list within a tuple?Because "tuples are immutable" only means you cannot modify the tuple. The list that's referred to from the tuple is not part of the tuple, it doesn't "know" that it is in a tuple, and it has no means to resist being modified.Why does the first example raise an error and the other two not?Because of how  works. It calls  on the list and then (because  is not required to return the original object) attempts to assign the resulting modified object back to the tuple. The first thing succeeds, the second thing fails.That is, for this case where  has an  function,  is equivalent to:In the first example, why is the list inside the tuple changed even though an error is raised?Because this Python operation doesn't offer what in C++ we'd call a "strong exception guarantee". The first part of the operation has already been performed, and cannot be (or at any rate is not) reversed when the second part fails. For the official version see Why does a_tuple[i] += [‘item’] raise an exception when the addition works?


Answer URL
https://docs.python.org/3/faq/programming.html#faq-augmented-assignment-tuple-error
