Natural Text
I'm using this python code to extract email addresses from a given file (source_file.txt) and to write those email addresses in a separate file. (I'm using python 3.3)The problem is that when I run this the file gets created, but nothing gets written in the file. Not even the text 'testing'. File is created but it is blank.I have used the print statements to check whether other parts of the code is working correctly.According to the python doc the syntax is correct.Can any of you point out any mistakes I have made in this code?
When you call  on a file, the data doesn't actually get written to disk immediately, it gets stored in a buffer. Every so often, the buffer is flushed. You can explicitly call  if you want to control it, but it's usually better not to—when you  the file, it automatically flushes.But you have to  the file for this to work. When a file object gets deleted, it closes itself, but you can't rely on the file object getting deleted at any particular time, or even ever. (You can learn the details of how it works in CPython 2.7, CPython 3.3, IronPython, etc., and how CPython 3.3 handles exit differently on Unix vs. Windows, and so on, but you still wouldn't want to rely on those details.)So, if you add an explicit  at the end of your code, that almost solves the problem… but not completely. What if some other line raises an exception? Then it will never get to the  call.You can solve this with /, but there's a better way, the  statement:This guarantees that as soon as you get to the end of the indented  block—even if that happens because of an exception, or quitting the program (or ing from the function, if you're in a function, or ing from the loop, if you're in a loop, etc.),  will be closed.This is all explained in Methods of File Object in the official tutorial, but looking over how it's explained, I can imagine a lot of new programmers wouldn't get any of that out of what's written. And the  documentation only really makes sense if you already understand what it does, and likewise for the explanations about file objects being buffered… PEP 343, which introduced the  statement is a little better, but it spends as much time talking about what's wrong with the two previous related PEPs as about why the feature is useful. So, I guess it's understandable that many developers don't know any of this.


Answer URL
