Natural Text
Preface: Extremely new at Python, but thankful for the SO help!Below is a code snippet where I'm trying to execute a SQL query against a MSSQL server table, and post it back to Google Sheets. I am able to retrieve data and headers, and I think I almost have it figured out. However, I'm having some trouble with the datetime format that some of the columns have. The error I'm receiving is:Code SnippetWithin , normal strings appear like this:datettime entries appear like this:My understanding is that the JSON doesn't have a native way to handle this data type, and it has to be handled as an exception. Is there a way to serialize all Timestamp parts of the dataset without having to specify which columns are datetime?Any help/advice you all could provide would be greatly appreciated.Thanks!Final Solution Update - Credit: @chrisheinzeAdding the following dataframe modeling for datettime headers worked perfectly.Hope it helps someone else!
The Sheets API doesn't know what to do with a Python datetime/timestamp. You'll need to convert it - most likely to a str.For converting a pandas Series use If it's just for a single value that needs to be converted then use datetime's Edit to answer your question in the comments:To give a bit more info,  means "string format datetime". This allows you to format your datetime/timestamp value into a str. The  is what you want the output the be. In my example, the results would be "20180309152303" for your date. Another example would be  which would give you "03/09/2018 15:23:03". So replace 'date_column' in my example with the name of your date column and it'll be converted to a str that's compatible with the API as well as understood format-wise in Google Sheets. 


Answer URL
https://docs.python.org/3/library/time.html#time.strftime
