Natural Text
I have a series of .csv files with some data, and I want a Python script to open them all, do some preprocessing, and upload the processed data to my postgres database.I have it mostly complete, but my upload step isn't working. I'm sure it's something simple that I'm missing, but I just can't find it. I'd appreciate any help you can provide.Here's the code:This runs without error, but a select query in psql still shows no records in the table. What am I missing?Edit: I ended up giving up and writing it to a temporary file, and then uploading the file. This worked without any trouble...I'd obviously rather not have the temporary file though, so I'm happy to have suggestions if someone sees the problem.
When you write to an  (or any other file) object, the file pointer remains at the position of the last character written. So, when you do the file pointer stays at the end of the file and  contains an empty string.To read (not ) the contents, you must reposition the file pointer to the beginning, e.g. use This allows  to read from the beginning and import all the lines in your .Don't forget, that you read and keep all the files in your memory, which might work for a single small import, but may become a problem when doing large imports or multiple imports in parallel.


Answer URL
https://docs.python.org/3/library/io.html#io.IOBase.seek
