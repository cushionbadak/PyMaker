Natural Text
My app logs unhandled exceptions.  These tests pass OK:But I couldn't get a test of unhandled exceptions logging working:What's wrong here?  How can we actually trigger the  from within a test?
Python won't call  until an exception actually propagates all the way through the whole stack and no more code has an opportunity to catch it. It's one of the very last things that happen before Python shuts down in response to the exception.As long as your test code is still on the stack,  won't fire. What little code actually can run after  probably isn't going to play well with your testing framework. For example,  handlers can still run, but the test is over by then. Also, your test framework is probably going to catch the exception itself if you don't, so  won't fire anyway.If you don't want to call  yourself, your best bet may be to launch an entire subprocess with your  installed and verify the subprocess's behavior.
 can check the exception message. You can do something like this:You can actually test the whole thing in one test. No need for multiple test functions.


Answer URL
https://docs.python.org/3/library/atexit.html
