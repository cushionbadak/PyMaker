Natural Text
From Learning Python:The basic format of the with statement looks like this, with an  optional part in square brackets here:The  here is assumed to return an object that supports the  context management protocol (more on this protocol in a moment).  This object may also return a value that will be assigned to the name  if the optional as clause is present.Note that the  is not necessarily assigned the result of  the ; the result of the  is the object that  supports the context protocol, and the  may be assigned  something else intended to be used inside the statement. is evaluated to a context manager object.What is assigned to ? The quote only says that it is not a context manager object.Does the assignment to  call  some method of a context manager class to produce the actual value assigned to ?Thanks.
Whatever is returned from . From the documentation on the  method of context managers:Enter the runtime context and return either this object or another object related to the runtime context. The value returned by this method is bound to the identifier in the  clause of  statements using this context manager.(Emphasis mine)The result of calling  could very well be a context manager, nothing in the specification forbids this. It could of course be another object related to the runtime context, as the docs state.Objects that return themselves from  can be used again and again as context managers.  objects, for example:Not that the previous made much sense but just to make the point clear.
Your object can function as a context manager if it provides both  and . The object returned by  is bound to the object you specify in the  part of the  statement:


Answer URL
https://docs.python.org/3/library/stdtypes.html#context-manager-types
https://docs.python.org/3/glossary.html#term-file-object
https://docs.python.org/3/reference/datamodel.html#with-statement-context-managers
