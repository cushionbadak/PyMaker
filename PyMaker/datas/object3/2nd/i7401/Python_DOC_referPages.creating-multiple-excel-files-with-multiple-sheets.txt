Natural Text
I have a master csv file in the formand I want to read this file in. Create a new Excel file with all values where col1==a  and another file with all values where col1==b. So OutputFilea will look like:and OutputFileb will look likeMy question is, should I use csv.reader() line by line and use conditionals to determine which file should be appended or should I append a string with the rows and then write each file at the end. Or is there a module which optimizes a process like this?
Since you are going to be working with large data sets, it is probably best not to hold too much in memory at the same time. You can maintain a dictionary of open files keyed by the line prefix, and make sure that the files are closed properly using an . Doing this will allow you to open new files lazily as you process the input spreadsheet:Given that you want to copy the lines as-is into the output files, I have chosen not to use the  module. If you want to apply more complex processing, you should probably consider adding it in of course.
I would suggest to try pandas for this kind of stuff. There is a special function to write to excel. In this case imagine I read your .csv file into a pandas dataframe :Then I can select only the values I want to filter and save to excel:The same happens with the second filter:Hope that helps.


Answer URL
https://docs.python.org/3/library/contextlib.html#contextlib.ExitStack
https://docs.python.org/3/library/csv.html
