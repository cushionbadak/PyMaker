Natural Text
I am working with a file from the protein data bank which looks something like this.First I needed to extract only the fourth column of the rows labeled ATOM, which is the amino acid sequence that specific atom is a part of. I have done that here.Which produces an output of this But what I need now, is to output only the first ASP and the first MET and etc and concatenate them so it'll look like this. I was thinking maybe I'll try to iterate ahead one line and compare it until it is different from the first output, but I am unsure of how I would do this, if you have any other ideas or any improvements to my code please do feel free to submit your suggestions, thanks.I also need to mention that there can in fact be two identical amino acids in one file so the output could be "ASP MET ASP"
Firstly, you don't need to cherry pick characters from a line string. You can use  to get a list of strings for each line.What you could do is maintain a list and set of sequences. The set is for efficient lookup, and the list stores symbols in order. Outside the loop, you may just join the list items like this:I've retained the sequences inside a list so you have fine grained access/control for each sequence, if you want to do more than just printing them out.
Instead of printing them, make a list, soBecomesJust don't forget to initialize the list before the loop with Now that you have all those values, you can loop through them and make a string out of the unique values. If the order doesn't matter to you than you can use  like this:But if the order is important, you have to loop through that list:You could do it without the  list, but that would be riskyAnyway, all that means you are looping twice on the same data, which is not needed. Instead of all of this, you could initialize  and  before your main loop, and do what I did inside your loop instead of ... That would look like this:
I added a bit of code to your existing code:Here we define an empty list, called AAs to hold your amino acids.Next, I generalized your code a bit to split the line into fields so that we can extract various fields, as needed.He we check to see if the amino acid is already in the list of amino acids... If not, then we add the amino acid to the list... This has the effect of deduplicating the amino acids.Lastly, we concatenate all the values into a single value using the empty string  and the  method.
Just wondering did you consider using this BioPandas?https://rasbt.github.io/biopandas/tutorials/Working_with_PDB_Structures_in_DataFrames/It should be easier to do what you want to do using pandas.You just need to use:and then concantenate the string in the list using https://docs.python.org/3/library/stdtypes.html#str.join


Answer URL
https://docs.python.org/3/library/stdtypes.html#str.join
