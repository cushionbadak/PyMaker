Natural Text
I have a large 3d numpy array that I'd like to preserve. My first approach is simply to use pickle, but this seems to lead to a poorly explained error. So the two questions I have are as follows:What is actually going on in this error?How should I go about saving the array to disk? I am using Python 2.7.8 and NumPy 1.9.0. 
With regard to #1, it's a bug… and an old one at that. There's an enlightening, albeit surprisingly old, discussion about this here: http://python.6.x6.nabble.com/test-gzip-test-tarfile-failure-om-AMD64-td1830323.htmlThe reasons for the error are here: http://www.littleredbat.net/mk/files/grimoire.html#contents_item_2.1The simplest and most basic type are integers, which are represented  as a C long. Their size is therefore dependent on the platform you're  using; on a 32-bit machine, they can range from -2147483647 to  2147483647. Python programs can determine the highest possible value for an integer by looking at sys.maxint; the lowest possible value  will usually be -sys.maxint - 1.This error is not a common one, as most people when faced with a very large  array, will use  or  to take advantage of the reduced pickle format for  arrays (see the  method for a  array, which is what  calls under the covers).To show that it's just about the array being too large for …however, this works for the full array...And if you'd like to burn out your fan, . What you'll also notice is the function in  gets saved along with the data.  It's a self-contained function that can produce a numpy array from the pickled data.
As an alternative to , especially for very large datasets, you may wish to consider a Python interface to a binary data format such as HDF5 (e.g., h5py).  For a discussion of its pros and cons, see this question and the first answer.
To answer the first question, "What is actually going on in this error?", here is my guess.Pickle is trying to save your NumPy array as packed binary data. It's saving each integer as a four-byte signed integer (the  code). However,  creates floats (which should be eight-byte s rather than four-byte s). I have no idea why pickle would do it this way. It's also entirely possible that the  actually is for saving some other piece of information than one of the values of your array. I'm just guessing that the error arises because a value of your array does not fit in four bytes.What versions of Python and NumPy are you using?


Answer URL
https://docs.python.org/3/library/struct.html#format-characters
