Natural Text
I have refered to the following webpage :https://serverfault.com/questions/153983/sockets-found-by-lsof-but-not-by-netstatUsing Python, I have encountered the same problem on SSL sockets:    When I use , the socket stays in CLOSE_WAIT state for an indefinite time    when I use , lsof says "can't identify protocol"The solution was to unwrap the SSL layer before closing:This closes the sockets properly in my app.I like to ask what  does in python and how to do it in c ?!
 does a proper SSL shutdown. Such shutdown is similar to the FIN handshake at the end of the TCP connection, only at the SSL/TLS layer. How this shutdown is done in  C depends on the specific SSL/TLS stack you are using. But for OpenSSL the function you need to use is SSL_shutdown.


Answer URL
https://docs.python.org/3/library/ssl.html#ssl.SSLSocket.unwrap
