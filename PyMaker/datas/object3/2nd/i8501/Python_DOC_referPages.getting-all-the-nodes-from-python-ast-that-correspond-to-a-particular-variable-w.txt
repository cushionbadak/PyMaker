Natural Text
Consider the code below:The value of  after execution of the code above is . Now, how can I get all the nodes with class  whose s are  and refer to the  that's being used in lines 1, 10, 12 and 13?In other words, the  inside of  is different from the rest of the s. Is it possible to get their AST nodes, having only the script and script's AST while not executing it?
When walking the AST tree, track the context; start with a global context, then as you encounter  or  or  nodes, record that context as a stack (pop the stack again when exiting the relevant node).You can then simply only look at  nodes in the global context. You can track  identifiers too (I'd use a set per stack level).Using a  subclass:Demo (given the AST tree for your sample code in ):And using  in a function:


Answer URL
https://docs.python.org/3/library/ast.html#ast.NodeVisitor
