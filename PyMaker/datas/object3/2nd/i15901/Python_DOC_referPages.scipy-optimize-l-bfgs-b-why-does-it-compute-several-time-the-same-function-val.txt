Natural Text
I'm currently trying to use scipy.optimize to find the parameters of a simulation which tries to fit some data. A created a function that gives the chi-square of my model over the data so that scipy.optimize will have to minimize that function.One of the major issue I have the simulation, and thus the called function is very time consuming and I see that the method L-BFGS_B (or just BFGS for that matter) computes several times the value of the function at the exact same point!!! I don't understand why it would do that and it's killing me.An example with a very simple function :will return :As you can see in the list of prints from the function calls,  call f3 several time at the same x.This is frustrating because I feel like it is loosing a lot of time here.If someone can enlighten me here, I'b so glad. Thanks.
It would do that because its not being as careful as you would like it to be.  This deficiency has been added to the scipy bug tracker here.  As I posted over there, you can work around this by caching the previous value yourself.  Alternatively, you can use  in your  call and write your function to return both the value at the point and the gradient. An example of the first approach is: Which gives:
It's evaluating a finite-differences approximation of the gradient.


Answer URL
https://docs.python.org/3/library/functools.html#functools.lru_cache
