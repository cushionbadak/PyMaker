Natural Text
I am trying to write a Python script to sniff network traffic using Tshark and save to a .pcap and .csv file.I have been manually running which captures packets and outputs fields No., Time, Source, Destination, Protocol, Length, Info into a .csv file. The -C tells tcpdump to save maximum of 5 files overwriting the oldest with new ones, and -W stipulates maximum file soze to be 500mb.I would prefer to use a Python script and Tshark to output the same fields to a csv file, which would run every 5 minutes and save a new file everytime. The 5 iteration limit and 500mb size is no longer needed.To iterate the script every 5 minutes I guess I could write a linux cron job, but how could I change the below to output to a new file eachtime (perhaps using a date stamp as the name). The end result I would like is to run the Python script every 5 minutes, and save all .pcap and .csv files in a folder.Any help would be greatly appreciated !@Barmar do you mean like this ?@mikael-rousson would it look like this 
One option is to use  from the  module in Python. It can run an action after n seconds: .https://docs.python.org/3/library/threading.htmlFor your task, you could use a recursive call like this (beware max recursion limit python):


Answer URL
https://docs.python.org/3/library/threading.html
