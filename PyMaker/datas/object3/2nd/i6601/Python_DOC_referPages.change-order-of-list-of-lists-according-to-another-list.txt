Natural Text
I have a bunch of CSV-files where first line is the column name, and now I want to change the order according to another list.Example:The above order differs slightly between the files, but the same column-names are always available.So the I want the columns to be re-arranged as:I can solve it by comparing the first row, making an index for each column, then re-map each row into a new list of lists using a for-loop.And while it works, it feels so ugly even my blind old aunt would yell at me if she saw it. Someone on IRC told me to look at on  and  but I'm just not experienced enough to puzzle those together. :/Thanks.
Plain PythonYou could use  to transpose your data:It becomes much easier to modify the columns order now.To calculate the needed permutation, you can use:You can apply the permutation to the columns:and transpose them back:With PandasFor this kind of tasks, you should use pandas.It can parse CSVs, reorder columns, sort them and keep an index.If you have already imported , you could use these methods to import the columns, use the first row as header and set  column as index. then becomes:You can avoid those steps by importing the CSV correctly with . You'd need  to get the correct order directly.
Simple and stupid:
To rearrange your data, you can use a dictionary:


Answer URL
https://docs.python.org/3/library/functions.html#zip
