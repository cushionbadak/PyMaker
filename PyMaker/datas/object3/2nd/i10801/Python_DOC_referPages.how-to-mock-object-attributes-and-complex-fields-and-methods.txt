Natural Text
I have a following function which needs to be unit tested.Now, my all_fields_sheet is a sheet returned by xlrd module(Used to read Excel file).So, basically I need to mock for following attributesnrowscellHow should I go abput it?
Just mock the calls and attributes directly on a mock object; adjust to cover your test needs:By assigning a list to  you can control, in order, what calls to  return.Afterwards, you can test if the right calls have been made with the various assertion methods. You could use the  object to give precise expectations:I used  here to match an exact number of calls, directly to  alone.Demo, assuming that your  function is already defined:Alternatively, you could create a function for the  attribute, to return values from a 'sheet' you set up up front:When  is a function, it is called whenever  is called, with the same arguments.


Answer URL
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.side_effect
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.call
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.call_args_list
