Natural Text
Rookie here.  I have a simple python code that's supposed to subscribe to a topic and publish JSON payload to the same topic using MQTT protocol. But for some reason, I am unable to load the payload as JSON!What am I doing wrong here?
There are a couple of problems here.1. Exception handlingYou're not handling exceptions (and Paho effectively ignores them within handlers, to keep the client alive I guess). This means when the exception is thrown in , you're never seeing this but the function is exited as there is no local  block.Improved versionHang on, what exception?Running this improved version we can now see:Hmmm, what's that  doing there?...2. The encoding problemEssentially your problem comes down to one line By calling  on the  of that , which is a  object in Python 3, you'll get the stringified version of those bytes, e.g. .This , of course, makes it invalid JSON now, hence ...Fixed versionDon't call ! Json.loads can handle  too. So:Or, assuming utf-8 encoding, we can do this more explicitly (I prefer working in strings):Hope that helps!


Answer URL
https://docs.python.org/3/library/json.html#json.loads
