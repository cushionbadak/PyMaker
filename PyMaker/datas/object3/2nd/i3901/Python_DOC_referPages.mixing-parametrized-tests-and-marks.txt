Natural Text
Ok, I'm struggling with something that is literally blowing my mind. Although my actual code is different, this basically nails down the issue. Assume this sample code:And the following is the output of running that test. What is going on here? Why when I use  it uses  and when I use  it uses  ?
Looks like there are two issues with the code sample that you provided.First, you shouldn't mark both individual parametrized tests and the test function. As soon as the  option you provided matches the mark decorator on the function, the test will be selected.Here's a minimal comparison. With both the marks on the function and individual parametrized tests:You will have two tests collected and selected:But if only the parametrized tests are marked:You will get two tests collected, but only one selected, as you expect:Second, there seems to be a puzzling bug (or undocumented "feature") in pytest.param, where using the exact name of the mark as the parameter value makes the test not selected.From your (slightly modified) code:If I try to run the  tests only, it won't select any:But simply modifying the value (in this case I only made it uppercase) makes everything work as expected:And now I can select the tests properly:I suspect that's related to the string value being used as the ID of the test, but would suggest opening a GitHub issue if that's something you don't want to work around.Also, totally unrelated, but it's better not to define the argument as , because you are shadowing the builtin function . PEP-8 suggests using a trailing underscore to prevent a name clash.


Answer URL
https://docs.python.org/3/library/functions.html#type
