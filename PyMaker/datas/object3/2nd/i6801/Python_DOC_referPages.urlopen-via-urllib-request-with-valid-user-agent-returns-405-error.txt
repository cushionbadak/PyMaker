Natural Text
My question is about the urllib module in python 3. The following piece of codeworks as I expect and writes the content of the google search 'stackoverflow' in a file. We need to set a valid User-Agent, otherwise google does not allow the request and returns a 405 Invalid Method error.I think the following piece of codeshould produce the same output as the first one, as it is the same google search with the same User-Agent. However, this piece of code throws an exception with message: 'HTTP Error 405: Method Not Allowed'. My question is: what is wrong with the second piece of code? Why does it not produce the same output as the first one?
You get the 405 response because you are sending a POST request instead of a GET request. Method not allowed should not have anything to do with your user-agent header. It's about sending a http request with a incorrect method (get, post, put, head, options, patch, delete).Urllib sends a POST because you include the  argument in the Request constructor as is documented here:https://docs.python.org/3/library/urllib.request.html#urllib.request.Requestmethod should be a string that indicates the HTTP request method that will be used (e.g. 'HEAD'). If provided, its value is stored in the method attribute and is used by get_method(). The default is 'GET' if data is None or 'POST' otherwise.It's highly recommended to use the requests library instead of urllib, because it has a much more sensible api. https://github.com/requests/requests
https://docs.python.org/3.4/howto/urllib2.html#dataIf you do not pass the data argument, urllib uses a GET request. One  way in which GET and POST requests differ is that POST requests often  have “side-effects”: they change the state of the system in some way  (for example by placing an order with the website for a hundredweight  of tinned spam to be delivered to your door).


Answer URL
https://docs.python.org/3/library/urllib.request.html#urllib.request.Request
