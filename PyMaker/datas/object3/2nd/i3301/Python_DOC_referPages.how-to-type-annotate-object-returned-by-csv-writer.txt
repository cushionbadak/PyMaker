Natural Text
I want to apply type annotation to the returned object of  in order to comply with a larger codebase. Unfortunately I can not figure out the fitting return type.If I try to use this classname:I get the following mypy error:Does someone know which type to use in this case. Of course I could use  but this nullify the sense of a type annotation.
Often when things are acting weird it's a sign typeshed doesn't exactly map to runtime. If you look at _csv in typeshed you will see the type is named . It also is re-exported in csv. So you should change the annotation to .
Short answer is there is no way to directly access the type. Reading the C source of the _csv module will show that the types of  and  are not exposed. Even in Pypy where the _csv module is implemented in Python, doesn't expose the types.Therefore, if you need to use it, you will need to use a work-around, by instantiating a temporary instance of the writer and getting it's type.If you want keep this logic separate, I would suggest creating the types in a separate moduleThe other solution (which also involves writing your own module of types), is to follow the example of the  module in it's definition of types for  and .
One solution is to write an abstract class that represents the type. This is also how it is done for some classes in the typing module. For the  function that is the following:Now this class can be used in the type-annotation for the  object. As the typename of the returned object is still  you will still get a type error. To avoid that you need to cast it to a  object.That solution is a bit verbose but it does the job.


Answer URL
https://docs.python.org/3/library/csv.html#writer-objects
