Natural Text
I am trying to export a user list from a Jaspersoft server into a CSV format as we do not currently have access to the DB or any Administration panel and we would have to raise a support ticket and wait for 2 days each time we would like a list. I figured I will try my luck using REST API and python and with the help of requests module I managed to export the XML that holds this information. The format of the extracted XML is this. Sample XML:My code until now:As you can tell - I am not a programmer or even close enough to that, so apologies should your eyes bleed - started learning python 3 weeks ago. My code is not working for several reasons:Each user can have from 1 to X amount of Roles so all the examples I managed to find have a standard amount of children.Some user attributes might be missing so I get an error when not found.Some attributes are repeating themselves e.g. ExternallyDefined in both user and role!My loops export each letter to a separate cell but that is something I believe I can solve.My end goal would be something like this:Any help/direction how I will tackle any of these issues will be greatly appreciated as I am completely lost at this point. Have a great weekend! 
try something like this:
The general approach is simple. Iterate all users, extract the values of a fixed set of XPath expressions per user, write those values to a CSV file...which we can generalize as:Iterate all results of an initial XPath expression, extract the values of a fixed set of XPath expressions per result, return those as a nested list (i.e. "rows of columns")For this we basically need One function, let's call it , that takes an XML node, runs XPath against it, and return the first found value.This is necessary since lxml's  method can return both simple values (strings, booleans, floats) and lists of nodes or values.A function, let's say , that can take an XML document, iterate over objects and apply our  to each of them, returning a list of valuesA list of XPaths we want to extract - this will correspond to our CSV columns laterFinally  to write them out all at once.In code:This approach is flexible enough to extract tables of values from any XML, you might want to turn it into a module, for reuse.


Answer URL
https://docs.python.org/3/tutorial/modules.html
