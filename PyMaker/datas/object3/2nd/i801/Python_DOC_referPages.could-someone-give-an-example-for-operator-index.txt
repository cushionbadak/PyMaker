Natural Text
I understand the operation as converting sth., which is not an integer, to integer. do I understand it correctly?my attempt to implement the function "operator.index ()":I have expected:actual output:
The  can only be used to losslessly interpret an object as an integer index value. From the documentation for the hook:Called to implement , and whenever Python needs to losslessly convert the numeric object to an integer object (such as in slicing, or in the built-in ,  and  functions). Presence of this method indicates that the numeric object is an integer type. Must return an integer.A  is not an integer type, even if a subset of float values are whole numbers.In the standard library, only the  and  types currently implement that hook. The hook exists for custom classes in your own code or defined in 3rd-party libraries to be useable when indexing sequences.It is distinct from  because that hook does allow for lossy conversion;  gives you , but you would not expect  to work (what should that return, the element at index  or ?). You can't use  to coerce floats into integers when indexing, or only accept whole floats (that'd be inconsistent and confusing).You'd only use  if you need to support arbitrary int-like types in your own Python code:The  special method was added to Python with PEP 357, so you can use the  project integers (which are a different type) in slicing and indexing, so this works:and  to allow your class to be used in indexing:


Answer URL
https://docs.python.org/3/reference/datamodel.html#object.__index__
