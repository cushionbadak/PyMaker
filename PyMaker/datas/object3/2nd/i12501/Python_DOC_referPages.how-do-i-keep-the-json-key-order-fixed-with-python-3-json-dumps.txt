Natural Text
I've noticed some strange behavior on Python 3's implementation of , namely the key order changes every time I dump the same object from execution to execution. Googling wasn't working since I don't care about sorting the keys, I just want them to remain the same! Here is an example script:When I run this script I get different outputs every time, for example:But then I run it again and I get:I understand that dictionaries are unordered collections and that the order is based on a hash function; however in Python 2 - the order (whatever it is) is fixed and doesn't change on a per-execution basis. The difficulty here is that it's making my tests difficult to run because I need to compare the JSON output of two different modules! Any idea what is going on? How to fix it? Note that I would like to avoid using an OrderedDict or performing any sorting and what matters is that the string representation remains the same between executions. Also this is for testing purposes only and doesn't have any effect on the implementation of my module. 
Python dictionaries and JSON objects are unordered. You can ask  to sort the keys in the output; this is meant to ease testing. Use the  parameter to :See Why is the order in Python dictionaries and sets arbitrary? as to why you see a different order each time.You can set the  environment variable to an integer value to 'lock' the dictionary order; use this only to run tests and not in production, as the whole point of hash randomisation is to prevent an attacker from trivially DOS-ing your program.
The story behind this behavior is this vulnerability. To prevent it, same hash codes on one PC should be different on another one. Python 2 has probably disabled this behavior (hash randomizing) by default because of compatibility, as this would for example break doctests. Python 3 probably (an assumption) has not needed the compability.


Answer URL
https://docs.python.org/3/using/cmdline.html#envvar-PYTHONHASHSEED
https://docs.python.org/3/using/cmdline.html#envvar-PYTHONHASHSEED
