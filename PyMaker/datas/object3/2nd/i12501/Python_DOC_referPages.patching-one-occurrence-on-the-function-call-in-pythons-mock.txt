Natural Text
Suppose I patch and mock certain function foo() which implements reading multiple files. So we have multiple  calls:If I do , the first occurrence of  will be patched, the one reading file named "stuff.txt".What if I need to patch second(any other)  calls in  to mock return_value from reading, say ?
Because you don't like the best answer (the Daniel's one) I can tell how you can do it by :Or betterI wrote a comment that I think is important in this answer context: this is a wrong way to do these kind of tests. In this test you are writing wires that tangle tests and production code.If you cannot refactor your code to write it in a more modular and testable way you should use this test to check the behavior and immediately after use it to refactor your code without change the behavior. Last step will be rewrite your test by use refactored code and then remove old test.
It is possible to do this via the  parameter to Mock, but I wouldn't advise it. Instead, refactor your code so that each of those open calls happens in a separate function, which you can individually patch.


Answer URL
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.side_effect
