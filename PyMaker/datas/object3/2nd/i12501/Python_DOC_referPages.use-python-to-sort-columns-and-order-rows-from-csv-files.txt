Natural Text
I am currently on Python 3.4.1, but I don't have access to any modules like Pandas or Numpy on my work pc.I originally wrote a VBA program in excel where the original data is on Sheet1, the new data in on Sheet2, and the difference between the two sheets is on Sheet3. My program did the following three things:Sort the data based upon the values in the first column (they can be integers or alphanumeric).Sequentially order the horizontal rows so the items in the first columns match each other; if they don't match then an extra blank row is added so the rows align with each other.Create a new result tab and compare the rows. If anything is different between them then it copies over the entire row information from the original CSV file.Since it was excruciatingly slow, I decided to try and learn Python. In Python I'm able to compare the data but am now wanting to be able to sort the columns and order the rows.For example:Original CSV #1Column1,Column2,Column3,Column4,Column51,b1,c11111,d1,e12,b2,c2,d2,e25,b5,c5,d5,e5,25,b25,c25,d2555,e257,b7,c7,d7,e7Original CSV #2Column1,Column2,Column3,Column4,Column52,b2,c2,d2,e21,b1,c1,d1,e13,b3,c3,d3,e37,b7,c7,d7,e77725,b25,c25,d25,e25Since the values in Row 2 are the same in both files, that data is not copied into the results for either file.Results CSV #1Column1,Column2,Column3,Column4,Column51,b1,c11111,d1,e15,b5,c5,d5,e57,b7,c7,d7,e725,b25,c25,d2555,e25Results CSV #2Column1,Column2,Column3,Column4,Column51, b1,c1,d1,e13,b3,c3,d3,e37,b7,c7,d7,e77725,b25,c25,d25,e25With the code below, I can accomplish step #3.
This is an excellent exercise to introduce you to programming in Python.There are many string functions that will make many data processing tasks much simpler.You can check the docs for more string functions https://docs.python.org/3/library/string.html.Firstly, I suggest using os.path.join() to create path strings.Second, I recommend using the builtin method sorted() to sort the lines of the file. Note that you must be careful when you sort because sorting strings is not the same as sorting integers.Step 1 uses the builtin sorted function to sort every line by column 1.This is accomplished by passing a lambda function as the key parameter.Since Python uses zero based indexing, the reference x[0] uses the first column.So this particular lambda function simply returns the first column of each row.Step 2 goes through all the rows of each file. If they both match, then they both get paired together.Otherwise, a row is matched to a blank row.
I'd suggest either looking at namedtuple: https://docs.python.org/3/library/collections.html#collections.namedtupleor sqlite:https://docs.python.org/3/library/sqlite3.html#module-sqlite3Both are available in 3.4.1.If these aren't suitable (i.e. they are relatively small model point files), you could use the built in set object to compare the two sets of data, and use set operations to filter:Once you've finalised the set, you can convert it to a list, sort it, and write out.


Answer URL
https://docs.python.org/3/library/string.html
https://docs.python.org/3/library/collections.html#collections.namedtuple
https://docs.python.org/3/library/sqlite3.html#module-sqlite3
