Natural Text
I am trying to read a password protected word document on Python using zipfile.The following code works with a non-password protected document, but gives an error when used with a password protected file.When running get_docx_text() with a password protected file, I received the following error:Traceback (most recent call last):Does anyone have any advice to get this code to work?Thank you for sharing your knowledge and expertise.
I don't think this is an encryption problem, for two reasons:Decryption is not attempted when the  object is created.  Methods like , , and , and  take an optional  parameter containing the password, but the object constructor / initializer does not.Your stack trace indicates that the  is being raised when you create the  object, before you call :I'd look carefully for other differences between the two files you're testing:  ownership, permissions, security context (if you have that on your OS), ... even filename differences can cause a framework to "not see" the file you're working on.Also --- the obvious one --- try opening the encrypted zip file with your zip-compatible command of choice.  See if it really is a zip file.I tested this by opening an encrypted zip file in Python 3.1, while "forgetting" to provide a password.  I could create the  object (the variable  below) without any error, but got a  --- not a  exception --- when I tried to read a file without providing a password:I was also able to raise a  exception, once by trying to open an empty file and once by trying to open some random logfile text that I'd renamed to a ".zip" extension.  The two test files produced identical stack traces, down to the line numbers.While this stack trace isn't exactly the same as yours --- mine has a call to , and the pre-3.2 "small f" spelling of  --- but they're close enough that I think this is the kind of problem you're dealing with.


Answer URL
https://docs.python.org/3/library/zipfile.html#zipfile.ZipFile.extractall
