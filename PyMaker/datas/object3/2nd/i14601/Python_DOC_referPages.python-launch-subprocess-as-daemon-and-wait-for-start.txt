Natural Text
I have some python code that relies on an external server to be running. On launch, the server outputs a string to STDOUT indicating that it is ready to receive requests. What I am hoping to do is, from my python code, launch the server, wait for the output string, run the rest of my python code, then shut down the server. So far however, all I have been able to figure out how to do is either a) launch the server and continue immediately (creating a race condition that typically fails), or b) launch the server and wait for it to complete (which never happens since it is a server)Is there any way to launch the process, and then block until output is received (but not until the process finishes, as communicate does)? I can, of course, simply put in a time delay, but this is obviously kludgy at best.
There is nothing complicated here. To "launch the process, and then block until output is received", you just do those two things. The problem seems to be that you're looking for a wrapper function (ala  or the  method) that does it all in one go; there isn't one, but what you want is trivial.You presumably already know how to launch the process if you know about :And to block until output is received:And that's it.Later, to shut down the server, if you want to hard-kill it:If your server shuts down gracefully when its pipes are closed, you may want to look at this example from the  docs:Or if it expects a specific signal to ask it to shutdown gracefully, you may want to try a similar kill, timeout-wait, hard-kill, wait.


Answer URL
https://docs.python.org/3/library/subprocess.html#subprocess.Popen.communicate
