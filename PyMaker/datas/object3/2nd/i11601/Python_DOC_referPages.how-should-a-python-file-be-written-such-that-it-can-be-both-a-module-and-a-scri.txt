Natural Text
I'm considering how a Python file could be made to be an importable module as well as a script that is capable of accepting command line options and arguments as well as pipe data. How should this be done?My attempt seems to work, but I want to know if my approach is how such a thing should be done (if such a thing should be done). Could there be complexities (such as when importing it) that I have not considered?
That's it, you're good.Nothing matters except the , as noted elsewhereFrom the docs (emphasis mine):A module’s  is set equal to  when read from standard input, a script, or from an interactive prompt. A module can discover whether or not it is running in the main scope by checking its own , which allows a common idiom for conditionally executing code in a module when it is run as a script or with python -m but not when it is importedI also like how python 2's docs poetically phrase itIt is this environment in which the idiomatic “conditional script” stanza causes a script to run:That guard guarantees that the code underneath it will only be accepted if it is the main function being called; put all your argument-grabbing code there. If there is no other top-level code except class/function declarations, it will be safe to import.Other complications? Yes: Multiprocessing (a new interpreter is started and things are re-imported).  covers thatIf you're used to C coding, you might be thinking you can protect your imports with 's and the like. There's some analogous hacks in python, but it's not what you're looking for.I like having a  method like C and Java - when's that coming out? Never.But I'm paranoid! What if someone changes my main function. Stop being friends with that person. As long as you're the user, I assume this isn't an issue.I mentioned the  flag. That sounds great, what's that?! Here and here, but don't worry about it.Footnotes: Well, the fact that you put your main code in a function is nice. Means things will run slightly faster


Answer URL
https://docs.python.org/3/library/__main__.html
