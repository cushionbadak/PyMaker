Natural Text
How can I create a word (.docx) document if not found using python and write in it?I certainly cannot do either of the following:or, to create or append if found: Also I cannot find any related info in python-docx documentation at:https://python-docx.readthedocs.io/en/latest/NOTE:I need to create an automated report via python with text and pie charts, graphs etc.
Probably the safest way to open (and truncate) a new file for writing is using  mode.  will raise a  if the file is already there.  is necessary because a word document is fundamentally a binary file: it's a zip archive with XML and other files inside it. You can't compress and decompress a zip file if you convert bytes through character encoding. accepts streams, so you can pass in a file object opened like that to save your document.Your work-flow could be something like this:It's a good idea to use  blocks instead of raw  to ensure the file gets closed properly even in case of an error.In the same way that you can't simply write to a Word file directly, you can't append to it either. The way to "append" is to open the file, load the  object, and then write it back, overwriting the original content. Since the word file is a zip archive, it's very likely that appended text won't even be at the end of the XML file it's in, much less the whole docx file:Keep in mind that the python-docx library may not support loading some elements, which may end up being permanently discarded when you save the file this way.
Looks like I found an answer:The important point here was to create a new file, if not found, or  otherwise edit the already present file.Further edits/suggestions are welcome.


Answer URL
https://docs.python.org/3/library/functions.html#open
https://docs.python.org/3/library/exceptions.html#FileExistsError
