Natural Text
I have a pandas dataframe df where one column is 'keywords' and another column is 'possible keywords', so that the first two rows look as follows:Let's assume that every element in the df['possible keywords'] series contains the same list, with the same elements(['traveling', 'fishing','cooking']).I want is to generate a third column where I include the 'possible keywords' that are not in the 'keyword' column, so that the corresponding rows look like this:I was able to do so with the following piece of code:However, I had to include the value in column 'possible keywords' as 'my_list' in the establish function.How can I do the same passing the value in 'possible keywords' as an argument to the establish function?Here is the problem with what I have tried so far:New version of establish function:If I instead try:Here is the problem:Help is much appreciated!
The  method expects as argument a function or other callable, which is exactly what you are passing in your first example when you pass . Internally, pandas calls the function you pass with each entry of your specified column in turn as argument.  Calling  will straight up not work because your function now takes 2 arguments.Calling  is a "valid" function call, but will return  and takes the wrong type of argument for its second parameter besides, because  expects a single entry and not a column.  Once it returns , that is what is actually passed to the  function, which is obviously not callable, and so pandas throws up.One solution is to create a helper function that "pre-bakes" your first argument and takes the second argument as its only argument and then calls the  function with it, and that way you can pass that second function to the  method.  One handy way to do this is using :


Answer URL
https://docs.python.org/3/library/functools.html#functools.partial
