Natural Text
this time I tried to use Python's xlsxwriter module to write data from a .srt into an excel. The subtitle file looks like this in sublime text:but I want to write the data into an excel, so it looks like this:It's my first time to code python for this, so I'm still in the stage of trial and error...I tried to write some code like belowbut I don't think it makes sense...I'll continue trying out, but if you know how to do it, please let me know. I'll read your code and try to understand them! Thank you! :)
The following breaks the problem into a few pieces:Parsing the input file.  is a generator that takes a source of lines and yields up a sequence of records in the form . The approach I took was to track which of three distinct states we're in: for when we're looking for the next index number, which should match the regular expression  (nothing but a bunch of numbers) when an index is found and we expect a timestamp to come in the next line, which should match the regular expression  (HH:MM:SS,mmm -> HH:MM:SS,mmm) and  while consuming actual subtitle text, with blank lines and EOF interpreted as subtitle termination points.Writing the above records to a row in a worksheet.  accepts a row and worksheet, plus a record and a dictionary defining the Excel 0-indexed column numbers for each of the record's keys, and then it writes the data appropriately.Organizaing the overall conversion  accepts an input filename (e.g.  that'll be opened and passed to the  function, and an output filename (e.g.  that will be created using . It then writes a header and, for each record parsed from the input file, writes that record to the XLSX file.Logging statements left in for self-commenting purposes, and because when reproducing your input file I fat-fingered a  to a  in a timestamp, making it unrecognized, and having the error pop up was handy for debugging!I've put a text version of your source file, along with the below code, in this GistEdit: Updated to split multiline subtitles across multiple rows in output


Answer URL
https://docs.python.org/3/howto/logging.html
