Natural Text
I get a weird error while trying to push file to remote ftp server using FTP over SSL/TLS. I found no trace of solution online :/ Please help.Here's my code:And here's the output of the script:As connection to remote FTP server is fine then I suppose it is not a firewall issue.Note:Remote FTP server is a Synology NAS, with up to date OS.EDIT_0:Another try with passive mode gave that result:I also tried extended passive mode now but it didn't help too:EDIT_1:So the script works partially, it's able to open connection, starts transfer of the file. File get's created on the remote server but it doesn't contain the same data as source file. Destination file ends up wih 1KB size and just some random chars (file is ANSII encoded, while source file is UTF8.In the meanwhile I am able to upload a file succesfully using WinSCP.
You use FTP active mode:And from your comments, it does not look like you have a good reason to do so.FTP active mode usually does not work, as it requires the client to be able to accept incoming connections. That's typically not possible without opening a local (both Windows and local network) firewall and/or configuring NAT. Do not even try to use the active mode, unless you have a very specific reason to do so. Use the passive mode. Simply remove the  call. The passive mode is the default mode in ftplib.See my article on FTP connection modes for details.
It is likely to be a firewall problem. FTP is rather special because it uses a different connection per transfer. The connection that currently works according to your trace is the command connection which is established by the client and targeted to the server FTP port (normally 21).The data connection is an independant connection. In active mode, it is established by the server, originating from the FTP-DATA port (20) and targetting the port sent by the client in its  command. In passive mode, the server sends the port where it will listen for the data connection in its response to the PASV command, and the client try to open a new connection to that (almost random) port.That means that unless large address ranges are allowed by the firewall, or the firewall software implements special processing to dynamically allow the addresses passed in FTP commands, a firewall can allow the command connection, and then block any data connection.Refs: File Transfer Protocol on WikipediaRFC 959 - File Transfer Protocol


Answer URL
https://docs.python.org/3/library/ftplib.html#ftplib.FTP.set_pasv
