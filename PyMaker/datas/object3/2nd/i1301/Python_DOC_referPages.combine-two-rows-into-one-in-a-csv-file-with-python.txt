Natural Text
I am trying to combine multiple rows in a csv file together. I could easily do it in Excel but I want to do this for hundreds of files so I need it to be as a code. I have tried to store rows in arrays but it doesn't seem to work. I am using Python to do it.So lets say I have a csv file;All I want to do is to have a csv file as this;The code I have tried is this;Could you please help?
You should be using the  module for this as splitting CSV manually on commas is very error-prone (single columns can contain strings with commas, but you would incorrectly end up splitting this into multiple columns). The CSV module uses lists of values to represent single rows.That code gives you the basis of the approach but it would be ugly to extend this for hundreds of files. Instead, you probably want  to pull all the files in a single directory, one by one, and add them to your output. This is the reason that I packed the reading code into the  function; we can repeat the same process millions of times on different files with only one set of code to do the actual reading. Something like this:
If you are specially dealing with csv file format. I recommend you to use csv package for the file operations. If you also use ... statement, you don't need to worry about closing the file etc. You just need to define the  then program will iterate all  filesHere is what you can do:
Store your data in pandas dfStore the modified dataframe into new oneWrite the df to new csv
You could do it also like this:I've you want now to run it on multiple file you can run it as script with arguments:So now expect you use some Linux System and the script is called  you could call it with:With windows you could do it in a way like this:
You need to replace the newline characters when looping through the fileif I would use your code then like this


Answer URL
https://docs.python.org/3/library/csv.html
https://docs.python.org/3/library/os.html#os.listdir
