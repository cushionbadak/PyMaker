Natural Text
I am working with winsock2 socket in ctypes, I can do  just fine, but calling CloseHandle, always result in . How should I close it properly ? Currently my app always crash after 64 times of socket() calls.
HANDLEs and SOCKETs are different types of objects, so they are incompatible (applies to their Python wrappers as well).Here's what [MS.Docs]: CloseHandle function states:Do not use the CloseHandle function to close a socket. Instead, use the closesocket function, which releases all resources associated with the socket including the handle to the socket object. For more information, see Socket Closure.@EDIT0:The above applies to "normal" Win. [MS.Docs]: CloseHandle (Windows CE 5.0) doesn't specify that paragraph, and also mentions that it can be used on Sockets.[MS.Docs]: socket (Windows Sockets) (Windows CE 5.0) states:When a session has been completed, a closesocket call must be performed.[MS.Docs]: Creating a Connection to a Remote Device Using Winsock (Windows CE 5.0) does indeed specify to call CloseHandle but only in step #5 for client socket (neither in step #4, nor for server socket), which makes me think that it's an error (WinCE pages are full of errors - at least typos)As a side question: why are you using ctypes instead of [Python 3]: socket - Low-level networking interface which is a wrapper over WinSock? It's like shooting yourself in the foot. If the BT sockets work identically like others (e.g. network), the only thing you have to do is define some constants (e.g. BTHPROTO_RFCOMM).


Answer URL
https://docs.python.org/3/library/socket.html
