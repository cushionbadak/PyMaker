Natural Text
I'm using Pythonnet to embed a Python script launcher into a C# WPF application. I can pass variable to python scripts using Scope and i get the result on a console using MVVM pattern.Now I want to allow the user to stop a script execution at anytime. I couldn't find how to make that work in order to close the Thread properly.Besides my question, I was wondering what is the purpose of wrapping code in . Because with or whithout it my script runs the same way.Pythonnet : 2.4.0 Python : 2.7.2 32bitNetFramework : 4.7.1
OK, I'm just beginning work on embedding CPython and may know only a little more than you.  What that caveat...  First, you need to get your script to terminate.  When it does the call to .Exec() will return, and the thread will exit.  If your script runs for a finite amount of time then you just wait for it.  Otherwise, you must arrange some signal that it should exit.Second, mainline will wait for thread to complete using one of several .NET patterns described at:  How to wait for thread to finish with .NET? is shorthand for  and   It creates an  object that acquires the lock and then releases it on .  So, in your sample, it is redundant.I'm unsure effects of your call to .  Documentation says that it releases the lock to allow other threads.  When you call it you don't have the GIL.  Next line acquires the GIL.  Therefore, it appears to have no function to me. See https://docs.python.org/3/c-api/init.html for details on threading.  This seems more related to python threading and saving thread state so that other non-python things can be done.  This is python 3.  Python 2 did not seem to support the equivalent.


Answer URL
https://docs.python.org/3/c-api/init.html
