Natural Text
I have a pandas dataframe looks like as below:I want it to transform into I am new to Python and after some research I have written following code, but seems to unable to extract country and city:I appreciate your response.
Starting with this: Try this: Borrowing idea from @MaxU
Another solution with , which works nice if country has no  (contains only one word):
Consider splitting the column's string value using 
Try this:If you want it back in the original df:
Something like this worksYou could use regex in the replace for a more complicated pattern but if it's just the word after the last  I find it easier to just reverse the str twice as a hack rather than fiddling around with regular expressions
I would use .str.extract() method:PS please be aware that it's not possible to parse properly (to distinguish) between rows containing two-words country + one-word city and rows containing one-word country + two-words city (unless you have a full list of countries so you check it against this list)...


Answer URL
https://docs.python.org/3/library/stdtypes.html#str.rfind
