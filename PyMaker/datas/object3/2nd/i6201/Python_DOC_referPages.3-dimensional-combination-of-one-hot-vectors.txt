Natural Text
I need to create a 3-dimensional list of all pairs of 3x1 one-hot vectors in python, but I'm having trouble generating the array.  I'm trying to do it using , but I haven't quite been able to get that working.  For example, my one-hot vectors are: .  The output I need is the three dimensional array  That is, a 9x2x3 array consisting of all combinations of pairs of one-hot vectors.
Approach #1Here's a NumPy way with mesh creation of those pairwise combinations of indices -Sample input, output -Approach #2 (for performance)We can use the fact that the inputs are one-hot vectors to gain performance, specially for large number of vectors with greater lengths by initializing the output array and assigning ones into it. The trick to using the one-hotness is getting those one-value unique indices per vectors with . We will use these indices to assign into output at only those specific places. The implementation would be -Runtime testOther approaches for  -Function to setup input list of one-hot vectors -Timings -
You can do this with :
You can do it with itertools  :or directly in numpy :
As I am unfamiliar with numpy here is a one/two liner solution.To make it easy we will take ,  and Given all your 'hot vector' (not sure what they are but anyway) are stored in one vector:Note the newlines in the print result are to make it fit in the screen 


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.product
