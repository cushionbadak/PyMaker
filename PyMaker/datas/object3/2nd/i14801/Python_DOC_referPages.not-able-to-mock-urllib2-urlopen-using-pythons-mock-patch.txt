Natural Text
Below is a code snippet of my api.py moduleI am trying to mock  in  of above module. I have written After I run the unittest, I get an exceptionWhat am I missing? Please help me out.
You are patching the wrong things: take a look to Where to patch.In  byyou create a local reference to  and  in your file. By  you are patching the original reference and leave the 's one untouched.So, replace your patches byshould fix your issue.... but is not enough.In your test case  are not used but  create a  by use the patched version: that is why  is a .For a complete fix you should change your test at all. First the code:Now the clarification... In your test you don't call  because you pass just the first parameter, so I've removed useless patch. Moreover you are patching  function and not  object, that means the  method you want mocked is a method of the object return by  call.Finally I add a check on  call and  that is always a good practice.


Answer URL
https://docs.python.org/3/library/unittest.mock.html#where-to-patch
https://docs.python.org/3/library/unittest.mock.html#autospeccing
