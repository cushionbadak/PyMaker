Natural Text
I have a script running where the main thread takes input from stdin and then passes it to a child thread using a queue. In the child thread I'm using asyncio coroutines to spin up a listener on a socket and wait for connections. Once a connection is made I can now send data through the listener from the main thread. It all seems to work well enough, but since asyncio.BaseEventLoop is not thread safe am I going to run into problems? This is my attempt to solve the problem of using a blocking library like python's cmd module with asyncio.My code is below.
This isn't going to work quite right, because the call to  is going to block your event loop. This means that if your server has multiple clients, all of them will be completely blocked by whichever one happens to get to  first, until you send data into the queue. The simplest way to get around this is  use  to run the  in a background , which allows you to wait for it without blocking the event loop:Edit (1/27/16):There is a library called , which provides an asyncio-friendly, thread-safe queue implementation.Using that library, your code would look like this (I left out unchanged parts):


Answer URL
https://docs.python.org/3/library/asyncio-eventloop.html#asyncio.BaseEventLoop.run_in_executor
