Natural Text
I  have  a   csv file  which has the   first  row  as  column names.I am  trying to  generate  a  new   csv file   from the  old one   .The   new   csv file  is obtained by  filtering the   original  csv  file  by    the   second column whose  value  is   HRHere  is the  codeI am getting the  error:Sample from the   csv file, the  shifts  B,WO etc  corresponds to  datesThe file  was   created using the  code
I cannot see why you are using a DictReader. You are trying to access the second column so would have needed to use something like , i.e. you would access it using the header name rather than its position. Using a standard CSV reader, you can just use the position.I would recommend you make use of Python's  statement for accessing files which ensures the file is automatically closed afterwards (no need for a  statement). You could also use  to append your path components together as follows:This will result in a CSV output file containing only rows with  in the second column. If you also need the header, just uncomment the line.By working a row at time, it will work with any file size by avoiding loading the whole file into memory at once.
Uness you have a strong reason not to, just use pandas:If  is delimited by spaces instead of tabs, pass  instead of  to .
About the :Essentially, the exception occurred because Python thinks you are trying to access the column nammed "1" in the last line:This happens because you are using  and by your CSV snippet, the allowed columns are the ones that appear in the first row of your CSV file.If possible, I highly recommend you to use ";" or "," as your column delimiter to make things easier


Answer URL
https://docs.python.org/3/library/os.path.html?highlight=os.path.join#os.path.join
