Natural Text
I have hundreds of box can be accessed only with different gateway, like below shows:All job need done in one minute, so I use multiprocess below command , errors below.Code:EDITED:     I have used fab -H -g solved the issue,thanks all
If you want to set env variables dynamically like you are, you should use .  That way the d task takes on the  values that you set at runtime.  But unfortunately, because  is not fully thread-safe, you can only kick off tasks like this in parallel in your situation once per gateway because  is a global singleton.A simple but integral aspect of Fabric is what is known as the  “environment”: a Python dictionary subclass, which is used as a  combination settings registry and shared inter-task data namespace.The environment dict is currently implemented as a global singleton,  fabric.state.env, and is included in fabric.api for convenience. Keys  in env are sometimes referred to as “env variables”.
I think you can just supply  to the  function as a parameter, like so:There's a few quirks to using the multiprocessing library. This info might be especially relevant to you scenario:Global variablesBear in mind that if code run in a child process tries to access a global variable, then the value it sees (if any) may not be the same as the value in the parent process at the time that Process.start was called.However, global variables which are just module level constants cause no problems.


Answer URL
https://docs.python.org/3/library/multiprocessing.html#multiprocessing-programming
