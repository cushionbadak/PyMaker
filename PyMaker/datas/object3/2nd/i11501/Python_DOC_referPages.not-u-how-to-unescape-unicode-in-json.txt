Natural Text
I'm trying to scrape from a non-English website using Scrapy. The scraped results as JSON look something like this:This is the code I'm using:How would I output unescaped Unicode characters onto the JSON?
Edit (2016-10-19):With Scrapy 1.2+, you can use the  set to the character encoding you need for the output JSON file, e.g  (the default value being , which means  escaping)Note: I'm adapting what I wrote on GitHub for a similar issue I linked to in the question's comments.Note that there's an open issue on Scrapy to make the output encoding a parameter: https://github.com/scrapy/scrapy/issues/1965Scrapy's default JSON exporter uses (the default)  argument, so it outputs Unicode characters as  sequences before writing to file. (This is what is used when doing )Setting  in the exporter will output Unicode strings, which will end up as UTF-8 encoded on file. See custom exporter code at the bottom here.To illustrate, let's read your input JSON string back into some data to work on:The input with  sequences is valid JSON for Python (as it should), and  produces a valid Python .Now let's serialize to JSON again:And now with Let's print to see the difference:If you want to write JSON items as UTF-8, you can do it like this:1.. define a custom item exporter, e.g. in an  file in your project2.. replace the default JSON item exporter in your 
Use the  module for text -> text decoding (In Python 2 it's not strictly necessary, but in Python 3  doesn't have a  method, because the methods are for  ->  and back, not  -> ). Using the  codec for decoding will get you the correct data back:So to fix the names you're getting, you'd do:If the problem is in JSON you're producing, you'd want to just make sure the  module isn't forcing strings to be ASCII with character encodings; it does so by default because not all JSON parsers can handle true Unicode characters (they often assume data is sent as ASCII bytes with escapes). So wherever you call / (or create a ), make sure to explicitly pass .


Answer URL
https://docs.python.org/3/library/codecs.html#text-encodings
https://docs.python.org/3/library/codecs.html#text-encodings
