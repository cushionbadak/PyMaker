Natural Text
I have written a python script to batch process video files, and I have created a CLI binding for it. You can find the repository here.As part of the script (since video processing is computationally intensive) I am using Python's subprocess module to achieve some parallelization.I am calling my script from the command line as:and it works fine. However, after it is executed, it breaks my terminal. I can no longer see what I am typing, but it still gets sent to the terminal. This is an example of me killing the current line a few times, and then typing  and hitting enter:As you can see, the  is not printed, but its output is, though starting inline with the prompt...I am wondering:What's going on here?How can I fix my terminal once this happens?How can I prevent my script from breaking the terminal?
Some process may have turned  off.  This can be checked using the  command.  Typically this is what happens:If it gets turned off:Then hit enter 4 times, type :To turn it back on, simply call .
Capture the keyboard interrupt and handle it cleanly.https://docs.python.org/3/library/exceptions.html#KeyboardInterruptNote, in a multiprocessed environment, you need to consider that the interrupt could occur anywhere (in the workers or parent thread) and you should kill all your workers before exiting the parent.
I have not figured out what the issue was exactly (and am happy to accept an edit adding that info to this answer), but it seems I needed to kill the process for the script to return the user to a clean prompt. I did this by appending the following to my function:


Answer URL
https://docs.python.org/3/library/exceptions.html#KeyboardInterrupt
