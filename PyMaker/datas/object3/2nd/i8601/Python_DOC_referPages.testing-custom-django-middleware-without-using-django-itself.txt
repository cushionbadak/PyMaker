Natural Text
I have coded my custom Django middleware in the 1.10 style, similar to this:Note, that this middleware is being threaten as a separate Python module, not belonging to any particular application in my project, but living outside and being installed like any other package, via pip. It does not work itself, but only if installed in Django app.  It works fine, however, I would like to test it. What I've made so far is something like this in :I don't know how to call middleware on  variable to modify it. I think it would be much easier if I used function-like middleware style, but what if I'm stuck with what I have and I am supposed ony to write tests, without modifying middleware?
The problem is that you are not calling neither the constructor of  neither invoking the  magic method by invoking the instance of a  object.There are many ways to test the behaviour that you described, I can think of this one:First, I slightly modified your example to be self contained:Next, I created the tests by actually creating the Middleware object and invoking the newly created object as it was a function (so  is run)Here there are some useful links: Difference between __call__ and __init__ in another SO question: __init__ or __call__?Where to patch from the python docs: https://docs.python.org/3/library/unittest.mock.html#where-to-patchpytest docs: http://docs.pytest.org/en/latest/contents.htmlipdb intro, useful for debugging: https://www.safaribooksonline.com/blog/2014/11/18/intro-python-debugger/


Answer URL
https://docs.python.org/3/library/unittest.mock.html#where-to-patch
