Natural Text
I am able to bind and query Active Directory via python-ldap without any issues except when it comes to adding or modifying attributes on AD. I can add the attribute but the encoding seems to be way off as all the text is garbled.I've tried encoding my string with utf8 and a few others with no luck.I've also tried binding with a Domain Admin account along with binding with the user account to which I will be changing an attribute, same result regardless.Here is the method I use to update an attribute:class LdapHelpers:Doing a ldapsearch via terminal this is what the attribute looks like:This is what 'Hello World' looks like when I set mobile to it:I've checked MSDN and it says that ldap attribute is just a Unicode string.System: Ubuntu 15.10 64bitPython: 2.7.10python-ldap==2.4.21As a side note I can search AD without any issues and parse/display returned user attributes, the issue only seems to be with creating or modifying attributes that this encoding issue comes in to play.
The '=' at the end is often an indicator that it is Base64 encoding. Python has a standard library for encoding/decoding base64 (The link is for Python 3, but Python 2 also has the library). LDAP does indeed use Base64 for something. See The LDAP Data Interchange Format (LDIF).
Take a look at the code from pyad to clarify what to do: https://pypi.python.org/pypi/pyadIt's Python-based.Another example at already answered question: Use Python script to manage remote LDAP server
Ok I found out what was going on, I was using PyPy 4.0.1 as the interpreter and for some reason this was either causing issues with the python-ldap library and/or encoding for strings. I switched back to Python 2.7.10 for the interpreter and now the very same modify commands up above work as expected using the python-ldap library. So definitely a word of caution if using PyPy and this particular library....


Answer URL
https://docs.python.org/3/library/base64.html
