Natural Text
Pandas has a great feature, where you can write your dataframe to a table in SQL.  Is there a way to make a temporary table this way?There is nothing in the documentation as far as I can tell.
The  uses the built into pandas  package, which itself relies on the SQLAlchemy as a database abstraction layer. In order to create a "temporary" table in SQLAlchemy ORM, you need to supply a prefix:From what I see,  does not allow you to specify the  or easily change the way tables are created.One way to approach this problem would be to create the temporary table beforehand and use  with  (all using the same database connection).Here is also what I've tried to do: override the 's  method and pass the  to the  constructor. For some reason, the table was still created non-temporary. Not sure if it would help, but here is the code I was using: gist. This is kind of hacky, but I hope it would at least serve as an example code to get you started on this approach.
This may be a bit hacky and it doesn't technically create a temporary table, it just acts like one, but you could create use the  decorator from  to create the table upon opening the context and drop it upon close. Could look something like:I tested it using Teradata and it works fine. I don't have a MySQL laying around that I can test it out on, but as long as  statements work in MySQL, it should work as intended.


Answer URL
https://docs.python.org/3/library/contextlib.html#contextlib.contextmanager
