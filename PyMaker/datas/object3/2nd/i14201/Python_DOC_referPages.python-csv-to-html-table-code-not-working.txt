Natural Text
My code currently looks like this. The conversion of xls to csv part works but not the writing to HTML.The output is just a blank page as the program can't find the
You have two or three problems here.  I'll go through them one by one, but first I want to say that I would perform this task using the Pandas library.  It does far, far more than this kind of task, but if you did install it, all you would have to do to get the data into table format is:You now have a string () of the entire data in html  format that you can write directly into your html file.  No intermediate csv stage or anything.  The documentation is available for  and Problems with existing solution1. String comparisonYou are looking for the comment line to replace with your html - you are using  to compare two strings. Unless you're absolutely sure that the strings will be exactly the same - no extra whitespace, no end of lines, no extra punctuation etc - then this is often error prone.You could  the line to get rid of whitespace and then use  as others have suggested.  Personally I'd be tempted to be more permissive and use the  keyword something like:Then it doesn't matter about whether the latter  is in the string, or whitespace before or after the text etc.  You might be even more permissive and use a regular expression such that you can have any whitespace between the comment marker and the text. You will probably know how precise the string will be in the  file that you're working with.2. Reading and writing the  file concurrentlyYou're trying to insert text in the middle of a file.  There's a Q&A covering methods how to that.  In brief, in your case (relatively small data i.e. one  file) I would read all the lines into a list and then insert the table HTMLat the point you want e.g.Note I'm assuming you've got  using the Pandas method at the start.  If you don't want to do that for some reason and still want to get the content via , you can always build up  by creating an empty string and then adding on all the HTML elements in a similar way to how your loop does it now.  3. Writing the htmlOthers have noted that you could use the append mode of file opening, rather than the write mode.  This is fine, but if you use the method above to read all the content into a list and insert within the list, you can then simply do:
Like Delimitry said, your read mode is not right:w+ : Opens a file for both writing and reading. Overwrites the  existing file if the file exists. If the file does not exist, creates  a new file for reading and writing.So the first thing it does is truncate (empty) the entire file. 
Try to change read mode from "w+" to "a+":When you open the file  with  mode it is truncated, and then when you reading lines  you will not find  HTML comment.Also add  to read your line without newline at the end of the string:I would recommend you to separate HTML file  and . For example you could change your code as:
The lines you read from  include a trailing newline. You must  it before comparing:Hint:HTML comments only have a  at the beginning, not at the end. It is not forbidden to writeBut the second  is very uncommon.


Answer URL
https://docs.python.org/3/library/stdtypes.html#str.strip
