Natural Text
I am trying to extract the top level URLs and ignore the paths. I am using the code below:This script has been running for the past hour. When I ran it, it gave the following warning:I would appreciate it if anyone could advise on a quicker way, perhaps pointers on the method the 'warning' suggests
Calling a Python function once for each row of a Series can be very slow if the Series is very long. The key to speeding this up is replacing the multiple function calls with (ideally) one vectorized function call. When using Pandas, that means rewriting the Python function (e.g. ) in terms of vectorized string functions.Since  is a fairly complicated function, rewriting  would be pretty hard. However, in your case we have the advantage of knowing that all the urls that we care about begin with  or . So we don't need  in its full-blow generality. We can perhaps make do with a much simpler rule: The netloc is whatever characters follow  or  until the end of the string or the next , whichever comes first.If that is true, then can extract all the netlocs from the entire Series  without looping and without multiple  function calls. This will be much faster when  is big.For example,yields


Answer URL
https://docs.python.org/3/library/re.html
