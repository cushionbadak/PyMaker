Natural Text
My script connects to a MySQL database using sqlalchemyThen reads in txt files using pandas read_csv function and the dataframe is used to create a new table in the database using:Script works perfectly fine, except randomly it seems to get stuck on the previous statement i.e. writing to the database. By random I mean that this is not file specific and so for example does not simply take longer to upload larger files. If I restart it, the file on which it was previously 'frozen' is uploaded instantly, but then it freezes again say 12 files afterwards or 1 file afterwards (very random). The table it 'freezes' on is actually fully uploaded (when I check the database, its all there) so it seems to freeze from going to the next statement. (No errors are thrown; script seems to be running normally except nothing happens). Any help is appreciated.EDIT:After enabling debugging, when freezing it seems to do all the tasks (hence why the table shows up even in the database) i.e.it simply does not continue to go on to the next command which is next iteration (again this is not always the case; seems to stop after about 1-3 tables now)
It could be Python garbage collection. Check in your system activity monitor. GC should show up as the Python process using lots of CPU.The gc library can help you troubleshooting and tuning the garbage collector.


Answer URL
https://docs.python.org/3/library/gc.html
