Natural Text
suppose I have a CSV file similar to this one, only much bigger:I want to sort of mimic Excel pivot table functionality and group the data by cost center, months and sum of both amounts, so the output would look like this:So far I have tried iterating through each row and creating list for the data I am interested in by I don't know where to go from there:I know with Pandas there is the option of 'group by' and 'agg', but this is an exercise for list and dictionaries (however I am open to different approaches) for me and I would prefer to stay within the native Python library.
This could be done using Python's built in  to help with creating a dictionary entry for each  and :Which would give you an  file containing:            By using a  it makes it easier to add entries without having to first test if one already exists.
Use  and aggregate  and then if need sum all columns add  with :Detail:If want one liner answer first , then  by columns and last aggregate :
This is one way.(1) Create an 'Amount Total' column.(2) Group by 'Cost center number' and 'month', summing 'Amount Total'.  For a one-line (but less explicit) answer, see @jezrael's solution.


Answer URL
https://docs.python.org/3/library/collections.html?highlight=defaultdict#defaultdict-objects
