Natural Text
I have a piece of code where I have a processing thread and a monitor thread. In the processing thread, I have a call to collections.deque.popleft function. I wanted to know if this function releases GIL because I want run my monitor thread even when the processing function is blocked on the popleft function
Instead of answering this specific question I'll answer a different question:What is the Global Interpreter Lock (GIL), and when will it block my program?In short, the GIL protects the interpreter's state from becoming corrupted by concurrent threads.  For a sense of what it is for, Consider the low level implementation of , which somewhere has an array of keys, organized for quick lookup.  When you write some code like:the python interpreter needs to adjust its collection of keys.  That might involve things like making more room for the additional key as well as adding the particular key to that array.  If multiple, concurrent threads are modifying that dict, then one thread might reallocate the array while another is in the middle of modifying it, which could cause some unpredictable, probably bad behavior (anything from corrupted data, segfault or heartbleed like memory content leak of sensitive data or arbitrary code execution)Since that's not the sort of state you can reasonably describe or prevent at the level of your python application, the run-time goes to great lengths to prevent those sorts of problems from occuring.  The way it does it is that certain parts of the interpreter, such as the modification of a dict, is surrounded by a / pair, so that critical operations always reach a consistent state.Note however that the scope of this lock is very narrow; it doesn't attempt to protect from general data races, it won't protect you from writing a program with multiple threads overwriting each other's work in a common container (say, a ), only that even if you do write such a program, it wont' cause the interpreter to crash, you'll always have a valid, working .  You can add additional application locks, as in  to give good concurrent semantics to your application.Since every operation that the GIL protects is a change in the interpreter state, it never blocks on external events; since those events won't cause the interpreter state to be changed, a signaling condition variable cannot corrupt memory.The only time you might have a problem is when you have several unblocked threads, since they are potentially all executing code in the low level interpreter, they'll compete for the GIL, and only one thread can hold it, blocking other threads that also want to do some computation.  Unless you are writing C extensions, you probably don't need to worry about it, and unless you have multiple, compute bound threads, in python, you won't be affected by it, either.
Yes --  is thread-safe (thanks @hemanths) http://docs.python.org/2/library/collections.html#collections.dequeNo, because  is not thread-safe.  Use a Queue, or make your own  subclass.


Answer URL
https://docs.python.org/3/c-api/init.html?highlight=global%20interpreter%20lock#thread-state-and-the-global-interpreter-lock
