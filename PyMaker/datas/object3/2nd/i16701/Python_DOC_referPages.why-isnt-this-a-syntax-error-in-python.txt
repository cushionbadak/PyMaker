Natural Text
Noticed a line in our codebase today which I thought surely would have failed the build with syntax error, but tests were passing so apparently it was actually valid python (in both 2.x and 3).  Whitespace is sometimes not required in the conditional expression:It doesn't work if the LHS is a variable:But it does seem to still work with other types of literals:What's going on here, is it intentionally part of the grammar for some reason?  Is this odd quirk a known/documented behaviour?
Whitespace between tokensExcept at the beginning of a logical line or in string literals, the whitespace characters space, tab and formfeed can be used interchangeably to separate tokens. Whitespace is needed between two tokens only if their concatenation could otherwise be interpreted as a different token (e.g., ab is one token, but a b is two tokens).So in this case,  is not a valid token, so the whitespace is optional. The  is interpreted as an integer literal of which the  is not a part. So  is interpreted separately and recognized as a keyword.In  however, an identifier is recognized, so Python is not able to see that you wanted to do  there.
The Python lexer generates two tokens for the input : the integer  and the keyword , since no token that begins with a digit can contain the string . , on the other hand, is recognized as a valid identifier; there is no reason to believe that it is an identifier followed by a keyword, and so is passed to the parser as a single token.
With my limited knowledge of lexical processing and tokenizing I'd say what you're seeing is that any piece that can be lexical parsed as "different" (i.e. numbers/dictionaries, etc...) from the  are being done so. Most languages ignore spaces and I imagine that Python does the same (excluding, of course indentation levels). Once tokens are generated the grammar itself doesn't care, it most likely looks for an  grouping, which, again with your examples, would work fine.


Answer URL
https://docs.python.org/3/reference/lexical_analysis.html#whitespace-between-tokens
