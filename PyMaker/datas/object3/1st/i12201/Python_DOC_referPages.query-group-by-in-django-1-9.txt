Natural Text
I am moving code from Django 1.6 to 1.9.In 1.6 I had this codemodels.pyviews.pyThe query would return one object for each 'group_id'; due to the way I use it, any table row with the group_id would do as a representative.With 1.9 this code is broken. The query after the second line above is:Basically it lists all the table fields in the group by clause, making the query return the whole table.Ever though in the debugger I seeIt doesn't look like query.group_by is a method in 1.9 nor does the change-logs of 1.7-1.9 suggest that something changed.Is there a better way - not depending on internal Django stuff - I can use for my query?Any way to fix my current query?
You can use order_by() to get the results ordered, in that same query you can order by a second criteria. If your want to get the groups you will need to iterate over the collection to retrieve those values.If you consume all of the results returned by the query, you can consider:a) itertools.groupby which makes an in-memory group by instead, but you should not use it for large data sets.b) Another option is to use Manager.raw() but you will need to write SQL inside Django, like this:This will work for large data sets, but you could lose compatibility with some database engines.Bonus: I recommend you to understand what exactly the old code did before doing a rewrite.


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.groupby
