Natural Text
Reading how super() works, I came across this recipe on how to create an Ordered Counter:For example:Is someone able to explain how this magically works?This also appears in the Python documentation.
OrderedCounter is given as an example in the OrderedDict documentation, and works without needing to override any methods: When a class method is called, Python has to find the correct method to execute. There is a defined order in which it searches the class hierarchy called the "method resolution order" or mro.  The mro is stored in the attribute __mro__:When an instance of an OrderedDict is calling __setitem__(), it searches the classes in order: OrderedCounter, Counter, OrderedDict (where it is found).  So an statement like oc['a'] = 0 ends up calling  OrderedDict.__setitem__().In contrast, __getitem__ is not overridden by any of the subclasses in the mro, so count = oc['a'] is handled by dict.__getitem__().A more interesting call sequence occurs for a statement like oc.update('foobar'). First, Counter.update() gets called.  The code for Counter.update() uses self[elem], which gets turned into a call to OrderedDict.__setitem__().  And the code for that calls dict.__setitem__().If the base classes are reversed, it no longer works.  Because the mro is different and the wrong methods get called.More info on mro can be found in the Python 2.3 documentation.


Answer URL
https://docs.python.org/3/library/collections.html#ordereddict-examples-and-recipes
