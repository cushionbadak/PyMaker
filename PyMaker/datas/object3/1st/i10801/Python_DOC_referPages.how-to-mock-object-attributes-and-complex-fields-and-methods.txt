Natural Text
I have a following function which needs to be unit tested.Now, my all_fields_sheet is a sheet returned by xlrd module(Used to read Excel file).So, basically I need to mock for following attributesnrowscellHow should I go abput it?
Just mock the calls and attributes directly on a mock object; adjust to cover your test needs:By assigning a list to Mock.side_effect you can control, in order, what calls to .cell() return.Afterwards, you can test if the right calls have been made with the various assertion methods. You could use the mock.call() object to give precise expectations:I used Mock.call_args_list here to match an exact number of calls, directly to mock_sheet.cell alone.Demo, assuming that your read_all_fields() function is already defined:Alternatively, you could create a function for the mock_sheet.cell.side_effect attribute, to return values from a 'sheet' you set up up front:When side_effect is a function, it is called whenever mock_sheet.cell() is called, with the same arguments.


Answer URL
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.side_effect
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.call
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.call_args_list
