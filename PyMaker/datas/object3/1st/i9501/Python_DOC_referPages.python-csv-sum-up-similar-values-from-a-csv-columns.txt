Natural Text
INPUT file:Expected output:I generated above output using Excel's Pivot Table.MyCode:Error:My Idea was to get the CSV values accumulated into a dictionary and later print it. However, I get above error when I try to add the values. This seems like achievable with built-in csv module. I thought this was an easier one :( Any pointers would be of great help.
There are two problems. The nested dictionaries don't initially have any keys set so d[row[OS]]['A'] results to error. The other issue is that you need to convert column values to int before adding them.You could use Counter as values in defaultdict since there missing keys default to 0:Output:
Something like this? You can write the dataframe to csv file to get the desired format.Output:file01
You got that exception because for the first time, row['OS'] does not exist in d, so 'A' does not exist in d[row['OS']]. Try the following to fix that:Output:
This does not answer your question exactly, as it is indeed possible to solve the problem using csv, but it is worth mentioning that pandas is perfect for this sort of thing:
d is a dictionary, so d[row['OS']] is a valid expression, but d[row['OS']]['A'] expects that dictionary item to be some kind of collection.  Since you didn't provide a default value, it will instead be None, which is not.
I assume your input file is called input_file.csv.You can also process your data and have your desired output using groupby from itertools module and two dicts like the example below:Output:
This extends niemmi's solution to format the output to be the same as the OP's example:OutputUpdate: Fixed the output.


Answer URL
https://docs.python.org/3/library/collections.html#collections.Counter
