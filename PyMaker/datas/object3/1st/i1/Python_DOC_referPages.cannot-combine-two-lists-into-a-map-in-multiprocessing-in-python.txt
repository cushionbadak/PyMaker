Natural Text
I have one csv with SKUs and URLs I break them in two lists withThen I multiprocess my urls but I want to join the correspondin SKUCan I put    records = p.map(parse, skus, web_links)because is not workingMy desirable output formatwould be how can I achieve this?
minor refactorI recommend naming your pair of functions def get_skus() and def get_urls(), to match your problem definition.data structureHaving a pair of lists, skus and urls, does not seem like a good fit for your high level problem.Keep them together, as a list of (sku, url) tuples, or as a sku_to_url dict.That is, delete one of your two functions, so you're reading the CSV once, and keeping the related details together.Then your parse() routine would have more information available to it.The list of tuples boils down to Monty's starmap() suggestion.writing resultsYou're using this:Firstly, testing for at least one record is probably superfluous, it's not the end of the world to open for append and then write zero records.If you care about the timestamp on the file then perhaps it's a useful optimization.More importantly, the write() seems Bad.One day an unfortunate character may creep into one of your records.Much better to feed your structured records to a csv.writer, to ensure appropriate quoting.


Answer URL
https://docs.python.org/3/library/csv.html#csv.writer
