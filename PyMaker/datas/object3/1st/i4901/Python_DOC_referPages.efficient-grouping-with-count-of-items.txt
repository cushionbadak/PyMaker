Natural Text
Here is how my dataset looks like:I am trying to get something like this out, essentially grouping and counting:Works, but slow on LARGE datasetsHere is my code that does work on smaller dfs, but takes forever on bigger dfs (mine is around 14 million rows). I also use the multiprocessing module to speed up, but it doesn't help much:Is there anything that can speed up the internal logic (except for running with multiprocessing)? 
This is essentially a cross tabulation.  You said "something like this" which implies that you aren't quite sure what the output should be.Option 1Group by and value_counts To get your specified output:Option 2However, I'd prefer these representations.  Which we can see a number of ways to do this in the answer to question # 9 in this answer
Are you looking for this?Returns:
For an O(n) complexity solution, use collections.Counter.Dictionary resultYou can then get a Name -> Country dictionary mapping via collections.defaultdict. I would not put dictionaries in a pandas dataframe, it's not designed for this purpose.Dataframe resultFor display purposes, you can build a dataframe directly from the defaultdict:


Answer URL
https://docs.python.org/3/library/collections.html#collections.Counter
https://docs.python.org/3/library/collections.html#collections.defaultdict
