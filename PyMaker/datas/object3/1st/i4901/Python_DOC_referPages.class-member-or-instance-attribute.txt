Natural Text
I've been using Structure in ctypes recently, but i got a strange question.This is my Python3 code:The question is: Is test a class member of AcknowledgeHeader or an instance attribute of ack_header?I tried to find the answer.If test is an instance attribute of ack_header, then why does ack_header.__dict__ print a empty dict?If test is a class member of AcknowledgeHeader, then why is type(ack_header.test) not equal to type(AcknowledgeHeader.test)?
test is a data descriptor object on the AcknowledgeHeader class. Accessing it on the ack_header instance causes code to run that translates between C conventions and Python types.Because it is a data descriptor, all interaction with the attribute is captured, including deletion and assignment. If you were to set a 'test' key in the ack_header.__dict__ attribute dictionary it'd simply be ignored.Instead, ack_header.test will always invoke AcknowledgeHeader.test.__get__(ack_header, AcknowledgeHeader), while assignment to ack_header.test will trigger AcknowledgeHeader.test.__set__(ack_header, <new value>).In this case, only getting and setting is implemented, there is no _ctypes.CField.__delete__() method, only __get__ and __set__, so del ack_header.test will throw an exception.See the descriptor HOWTO for more details on how descriptors work.


Answer URL
https://docs.python.org/3/reference/datamodel.html#object.__delete__
https://docs.python.org/3/howto/descriptor.html
