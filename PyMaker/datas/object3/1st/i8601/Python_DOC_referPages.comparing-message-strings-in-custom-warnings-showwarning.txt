Natural Text
I am attempting to perform a custom action when I see a very specific warning. The warning is a UserWarning with the message 'Skipping SYSTEM_VARIABLE record'. I want all other warnings, including all other UserWarnings with different messages, to be propagated and printed to stderr as usual.The only way I could find to do this is to replace warnings.showwarning with a custom implementation, as in the following test script:This script prints out the following output:I find this output surprising because the first line indicates that the message is in fact 'Skipping SYSTEM_VARIABLE record', so the second line should read True, and the if rather than the else should be executed. However, it seems that the two strings are not identical for some reason.Why is this happening? Why is the "custom action" print('Doing a thing here') not being triggered? I have tried replacing all three occurrences of 'Skipping SYSTEM_VARIABLE record' with just 'a' in the script to eliminate the possibility of a typo. The exact same result happens.I am using Python 3.5.2 on Anaconda 2.4.0 on a CentOS 7 server, so str vs. unicode should not be a problem.
Figured out the answer on a hunch a couple of minutes after posting:The reason that the comparison fails is that message is not a string, but the actual warning object, whose string representation (via str) happens to just be the warning message.An additional printout, print(type(message)) demonstrates this fact:The correct comparison is str(message) == 'Skipping SYSTEM_VARIABLE record'.The only reason that I am keeping this question and answer around is that there does not appear to be anything in the documentation of warnings.showwarning to explicitly describe this behavior.


Answer URL
https://docs.python.org/3/library/warnings.html#warnings.showwarning
https://docs.python.org/3/library/warnings.html#warnings.showwarning
