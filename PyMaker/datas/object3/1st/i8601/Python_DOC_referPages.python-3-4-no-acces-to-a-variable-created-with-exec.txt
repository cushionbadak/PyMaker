Natural Text
With Python 3.4 and in a function, this piece of code appears:This is the output:As expected we observe the creation of the keys2 variable in the local scope, and this variable contains well the expected values (['General informations', 'Experiments parameters', 'Calculated parameters']) as seems to indicate the dictionary returned by locals(). But it is not possible to access  this keys2 variable (name 'keys2' is not defined !!!!). Why ?EDIT 1: We seen that Keys2 is in the local scope because in the code of the above question:andreturn:BUT !!! why if I change the above code with:The keys2 variable is not created, as we can see with again the NameError exception raised:EDIT 2: By continuing to play with exec() and locals() ... Considers the follow piece of code:The output is:With this result I understand that the dictionary (namespace) passed as argument with exec() is used to find the variables in the scope of the function exec(), but also this dictionary (namespace) contains all the variables created after the execution of exec(). This is understood, but I do not yet undersatnd why in the EDIT 1, keys2 = locals()['keys2'] is not working  while  keys2 = namespace['keys2'] is working in this EDIT 2 ?EDIT 3: By continuing to play with exec() and locals() ... Considers the follow piece of code:The output is:So ... even if we define keys2 as a global variable in the exec() function, it is not in the global scope as returns the globals() after the exec() function ... I confess that some things miss me ...
As documented in the exec documentation for Python 3:Note: The default locals act as described for function locals() below: modifications to the default locals dictionary should not be attempted. Pass an explicit locals dictionary if you need to see effects of the code on locals after function exec() returns.You can't create new local variables with exec on Python 3. Local variable lookup completely ignores the attempt.


Answer URL
https://docs.python.org/3/library/functions.html#exec
https://docs.python.org/3/library/functions.html#locals
