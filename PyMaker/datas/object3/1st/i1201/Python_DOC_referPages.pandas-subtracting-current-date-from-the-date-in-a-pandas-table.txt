Natural Text
I am attempting to calculate the difference in days between todays and a pandas data consisting of historical data. Below is the intended code:However, it produces the following error:TypeError: unsupported operand type(s) for -: 'DatetimeIndex' and  'datetime.date'The date column in the pandas table looks like this:How do I fix this error. Thanks in advance.
You have to subtract same types - datetimes with datetime (with zero times) or dates with date.Use Timestamp.now with Timestamp.normalize or Timestamp.floor for remove times:You can also use replace:Or convert Datetimes to dates for subtract same types:Sample:
There is a subtle but important distinction. Pandas supports datetime.datetime objects but does not support datetime.date objects:Note pd.Timestamp.date returns a datetime.date object. The docs do specify this: Return date object with same year, month and day. That date object is not supported natively by Pandas in the same way datetime objects are supported.But replacing time values is cumbersome. You will likely prefer using in-built Pandas methods for your calculations. These are all equivalent:


Answer URL
https://docs.python.org/3/library/datetime.html#datetime.datetime
https://docs.python.org/3/library/datetime.html#datetime.date
