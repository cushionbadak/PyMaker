Natural Text
The API for Python's wsgiref module precludes hop-by-hop headers (as defined in RFC 2616). I'm unclear on how to get the server to terminate a connection after a response (since there doesn't seem to be a way to add Connection: close).This problem comes up in testing small WSGI apps and Bottle micro-services.  Calls from curl get blocked by open connections from a browser.  I have to click a browser refresh to terminate the connection so that the pending curl request can be answers.   Obviously, this should be a server side decision (terminate connection after a response) rather than client-side.  I'm unclear how to implement this.
This is really predicated on your WSGI server you are hosting your framework via.  The best solution with bottle is to run it through gevent.  You can purge the whitenoise and bottle configs if they aren't necessary, I kept them there as an example, and a suggestion that you use them if this is outward facing.  This is purely asynchronous on every connection.  


Answer URL
https://docs.python.org/3/library/wsgiref.html#module-wsgiref
https://docs.python.org/3/library/wsgiref.html#wsgiref.util.is_hop_by_hop
