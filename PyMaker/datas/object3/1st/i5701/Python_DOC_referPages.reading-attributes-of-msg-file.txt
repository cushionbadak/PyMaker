Natural Text
I am trying to read a .msg file to get the sender, recipients, and title.I'm making this script for my workplace where I'm only allowed to install default python libraries so I want to use the email module to do this.On the python website I found some examples of using the email module. https://docs.python.org/3/library/email.examples.htmlNear the end of the page it talks about getting the sender, subject and recipient. I've tried using this code like this:This results in an output:I checked the file test_email.msg, it is a valid email. When I add a line of codeI get an output of a garbled email the same as if I opened the .msg file in notepad.Can anybody suggest why the email module isn't finding the sender/recipient/subject correctly?
You are apparently attempting to read some sort of proprietary binary format. The Python email library does not support this; it only handles traditional (basically text) RFC822 / RFC5322 format.To read Microsoft's OLE formats, you will need a third-party module, and some patience, voodoo, and luck.Also, for the record, there is no unambigious definition of .msg.  Outlook uses this file extension for its files, but it is used on other files in other formats as well, including also traditional RFC822 files.(The second link attempts to link to the MS-OXMSG spec on MSDN; but Microsoft have in the past regarded URLs as some sort of depletable resource which runs out when you use it, so the link will probably stop working if enough people click on it.)


Answer URL
https://docs.python.org/3/library/email.examples.html
