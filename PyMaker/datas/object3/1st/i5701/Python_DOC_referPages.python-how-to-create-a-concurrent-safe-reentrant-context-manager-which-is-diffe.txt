Natural Text
I want to have an object conManager that is a reentrant context manager instance such that whenever I enter and exit its context it will print a number, but the number must be one higher than the number of the previus context (starting at 0). Example:Output expected:The only solution I have so far is a class with a stack in it, but that's not concurrent-safe. Are there any concurrent-safe solutions?EDIT: as Sraw pointed out, I said thread safe when I meant concurrent-safe, changed the question accordingly.
The only solution I can think of is overriding conManager's __call__ so that it returns a context manager, but I'd rather have a cleaner, no-call usage. 


Answer URL
https://docs.python.org/3/library/contextlib.html#reentrant-context-managers
