Natural Text
I have a file that has 27 fields and is fixed-width.  I would like to be able to run a script on it, that would go through and add a comma or something at the field end spots so that I can then easily import it into Excel without having to manually set the lengths each time.I am able to read the file into Python, but am not sure how I would add the commas. Field info:Start Position: 1, 21, 41, 61, 81, 86, 89, 95, 99, 103, 183, 193, 243, 293, 343, 393, 423, 425, 435, 436, 437, 438, 440, 442, 445, 447, 450Length: 20, 20, 20, 20, 5, 3, 6, 4, 4, 80, 10, 50, 50, 50, 50, 30, 2, 10, 1, 1, 1, 2, 2, 3, 2, 3, 1
You could do as follows,
Use struct to read in the fixed-format file and csv to generate the CSV file.
Alternatively you could use the pandas library for this.You'll need to use either the colspec or widths keyword arguments in pd.read_fwf to specify how the column widths are laid out. More on that can be found here.


Answer URL
https://docs.python.org/3/library/struct.html
https://docs.python.org/3/library/csv.html
