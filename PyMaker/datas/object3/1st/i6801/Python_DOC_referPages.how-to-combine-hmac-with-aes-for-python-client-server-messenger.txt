Natural Text
So I am trying to write a small encrypted command line IM messenger which accepts two keys as args. I am not sure how the two keys are meant to work together or which is for what. I am trying to use HMAC and AES together but am unsure of how. Please note this is for educational purposes only, I do not intend to try to use this anywhere else. I am having a hard time understanding and any advice or explanations would be so greatly appreciated. I have a working IM messenger already up and running, I need only to figure out the HMAC/AES/keys.Thank you all,       ~Maddie
What you should be doing is using the Encrypt-Then-MAC paradigm. That means, you are first using the first key to encrypt the message with AES.Afterwards, you use the second key as an authentication key for the HMAC-SHA256 function to authenticate the ciphertext (the output of the encryption function). Then you concatenate the ciphertext and the HMAC output (called a tag) and transmit it over the wire.Upon receiving such a message you recalulate the tag from the ciphertext and compare it to the one tranferred. If it is valid, you may decrypt the ciphertext.Final note: You do not really need to use to seperate keys as an input parameter. If would be fine to just supply one master key and than use that to derive to seperate encryption- and authenctication-keys using a key derivation function like HKDF.


Answer URL
https://docs.python.org/3/library/hmac.html
