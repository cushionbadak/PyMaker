Natural Text
I am checking the types of user input like so:However, In the exception message, I would like to include the bad type the user has submitted, to make debugging for him easier.Is there a simple or otherwise idiomatic way to achieve this?The only way I can think of is the following:Which I suppose I could wrap in a macro:And used like such:
You could slightly misuse the PyArg_ParseTuple mechanism. The slight bit of non-neatness is that it outputs into a const char*, so you have to get the item from the tuple too.This generates something like TypeError: must be str, not intNote: This is fine for Python 2 since "s" matches both str or unicode object (i.e. effectively basestring). For Python 3 it will only accept str (not bytes) so you might have to follow the documented advice and "to use the O& format with PyUnicode_FSConverter() as converter." This gives an error ofTypeError: Can't convert 'int' object to str implicitlyAdditionally, it's a bit nicer because the out is a PyBytesObject that you can use directly instead of having to do PyTuple_GetItem


Answer URL
https://docs.python.org/3/c-api/arg.html#strings-and-buffers
