Natural Text
Using the ast and astor libraries, I've written a simple script that traverses an AST using ast.NodeTransformer and replaces all empty lists with None:This works correctly, and outputs:However, I'm unsure of the line that I've used to pull out of the function if the list is empty:If I replace this with return, making the script return None if the condition is not met, the node is destroyed rather than being left unchanged, making the first test case print a blank string because the ast.List node has been destroyed.I don't want this to happen, but I also think that using ast.copy_location(node, node) seems wrong. Is there a dedicated function to leave the node unchanged and exit the function, or a way to configure ast.NodeTransformer so that, if a visit function returns None, the node remains unchanged?
From the documentation:The return value may be the original node in which case no replacement takes place.So instead of:just:


Answer URL
https://docs.python.org/3/library/ast.html#ast.NodeTransformer
