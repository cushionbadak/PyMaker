Natural Text
I have my script that exits through the except KeyboardInterrupt when CTLC+C is pressed as follows:However, when the script is running as systemd and I call systemctl stop myscript.service, the 'exiting' message is not logged to the syslogger, so I know that the except is not executed. The SystemExit and Exception do not seem to be issued on service stop. What is issued by the systemctl so I could catch it in the try - except portion of my script?Also, do I need to care for proper threads exit when calling systemctl stop, or it will handle my script nicely?
You can specify the KILL_MODE option in the systemd config file that specifies what signal is sent to the process to exit it. Then you can modify the python script to capture the specified signal using the signal module and perform your exit code accordingly.As for the other threads, it depends on how critical they are and how they are instantiated. If they are instantiated as daemonic and there is no consequence to them simply terminating at any given time, you can just let them die. Otherwise you should explicitly code the logic to shut them down properly when the signal is received.


Answer URL
https://docs.python.org/3/library/signal.html
