Natural Text
When I call GetProcAddress() by win32api, I get the handle successfully but ctypes didn't.The codes are:And the outputs:  SYSTEM INFO:windows7 64, python 3.43
You need to use a char string rather than the default Unicode string provided by python 3.x, as hinted by the GetProcAddress documentation (the 2nd parameter is a LPCSTR, not LPCTSTR or LPCWSTR):h_loadlib2 = KERNEL32.GetProcAddress(h_kernel32,'LoadLibraryW'.encode(encoding='ascii'))Alternatively, you can pass a byte:h_loadlib2 = KERNEL32.GetProcAddress(h_kernel32, b'LoadLibraryW')Note: The above code won't work on a python 64-bit interpreter (the most significant 32-bit of the 64-bit module handle are zeroed). In this case you'll need to use argtypes and restype as explained in the tutorial (for example by defining a 64-bit HMODULE type).


Answer URL
https://docs.python.org/3/library/ctypes.html
