Natural Text
I need to create a call graph of python function and then modify bytecode of some functions.I started to play with disassembly and found that function is make by MAKE_FUNCTION opcode and the code object somehow passed to itOkay, I found roots of the callgraph in this file, but what to do next? How do I actually get this code object?
The function type is what you want. You can get it from the types module (where it is types.FunctionType) or just type(lambda:0). Do a help() on the type to see the arguments required to create a function object.The primary thing you need to construct the function is the code object. You can get that from an existing function f using f.func_code. If you are modifying the bytecode you will need to create a new code object to contain it. Its type can be obtained using type() as with the function and doing a help() on the type will tell you what you need to pass in.If you are basing the new function on an existing one, then you can dig most of what you need out of the existing function. See this table in the inspect module documentation to see what attributes of functions and code objects contain things of interest to you.


Answer URL
https://docs.python.org/3/library/inspect.html#types-and-members
