Natural Text
I have a class for making an anonymous class:It works great for setting properties dynamically, however I cannot set instance methods this way because they don't have access to self.  e.g. Anonyclass(foo = lambda x: x**2).foo(5) == 25, but I can't seem to shove a self in there...Anybody know how to make this happen?
This is not creating new "classes" just instances of Anonyclass. Just as you can set instance attributes, you can set callable attributes that know to which instance they are bound.So, assuming any callable passed as an argument will take self as the first argument, you can change your code to:This is needed because a callable being set in the instance bypass the mechanism Python uses to bind a method to an instance auto-adding the "self" argument to all calls. So we use functools.partial to do the same. (It could be done with lambdas, but we'd need two levels of lambda's so that the "attr" variable would keep itself bound to the correct method, and not point to the last element assigned in the for loop)Also, if you want to actually create classes  and not instances with attributes bound, you could just make a call to type, passing the same arguments you get as kwargs on your code:This will make any function passed in kwargs behave as a "real" method.
You could do it like the following. You may have to modify the for kwarg, value in kwargs.items(): loop to check what kind of value is being assigned and handle data- and/or property-types of attributes differently. I didn't try it with anything else since there weren't any example in your question.


Answer URL
https://docs.python.org/3/reference/datamodel.html#implementing-descriptors
