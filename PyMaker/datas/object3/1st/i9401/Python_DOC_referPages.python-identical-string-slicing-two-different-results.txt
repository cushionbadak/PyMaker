Natural Text
Somewhere I'm being an idiot, but I can't find where.I'm running a Python script using a PostgreSQL database through ODBC.  I am trying to extract the meaningful piece from a database exception message.  Here is the raw message, with line breaks added for readability:Note that there are two sets of parentheses in this string.  First, I find the locations of the outer ones and slice them off.  This gives the expected result:Then, using as far as I can tell identical code, I strip off the other set of parentheses and everything outside them.  This gives this result:The open parenthesis is still here, even though I am using the result of the find() method the same way, adding one to the open parenthesis location as the start of the slice, both times.Here is the code:And here is the raw output, with no added line breaks:Test code using a much smaller string works as expected:Thank you very much.
It looks like this line:dbErrorString = errorString[openParenLocation + 1:closeParenLocation]should instead be:dbErrorString = strippedString[openParenLocation + 1:closeParenLocation]
Given that your string looks like Python syntax, have you considered using the standard ast library module to do all this work for you?An even simpler way would be to use ast.literal_eval to turn the string directly into the Python object that it describes. It's like the builtin eval, but safe from the security perspective because it will not evaluate anything that isn't a literal (so, any malicious errorString content will not be executed).etc.


Answer URL
https://docs.python.org/3/library/ast.html#ast.literal_eval
