Natural Text
I'm writing a new PyQt app. I'm trying to do everything related to the program and ui using as much of the PyQt APIs as possible as a means to improve my knowledge of PyQt and Qt in general.The question I have is, is there an API within PyQt/Qt to handle command line argument parsing elegantly?My research so far has turned up:an example of how to make it play nice with python's opt_parser module, except it doesn't handle QApplication's built in arg parsing.PyKDE's KCmdLineArgs (which introduces an unwanted KDE dependency)it looks like KCmdLineArgs is being ported upstream for Qt5.1 as QCommandLineParser, which is cool, but I'd like to be able to use it now, not 18 months from now.So how do PyQt applications normally handle this? or is opt_parser/argparse the way to go? This is far from a nice solution...
Use argparse if you're using Python 2.7 (optparse if < 2.7), the package doesn't have to be specific to PyQt for you to handle commandline options.
The best solution here is using the argparse module's parse_known_args() method (docs) to process the non-Qt command line options first. It's no more work in configuring the ArgumentParserâ€”it just changes which method you call, and gives you a tuple instead of a single object in the return. That gives you the best of both worlds. A simplified example that catches only a couple of the Qt 4.8 arguments and a few others, but gives the general idea.Assume you were to run this like so:Then parsed_args would have the usual Namespace with holy_hand_grenade set to 3 and --swallow set to 'unladen', while unparsed_args would have a simple list: ['-dograb', '-style,' 'cde']. This in turn can be passed normally to the QApplication with the inclusion of the program name from sys.argv[0] (thanks to marcin for pointing this out). We use sys.argv[:1] to get an array for concatenation with unparsed_args; you could just as well do [sys.argv[0]]Among other things, this lets you set up your application to specify whether to launch the Qt UI, to run as a command line, to run unit tests, and so forth instead if you so desired. Handling the non-Qt (or anything else) arguments first is better because it does not leave argparse dependent on the setup you're using, but the other way around.
You should really try docopt. It doesn't need any argument definitions. You have "Usage: " string and unparsed arguments as input, pass them into docopt() function, and you have parsed arguments as output.


Answer URL
