Natural Text
Using Python to append CSV file, I get data every other row.How do I fix?C:\test.csv when opened looks like this:
Appending is irrelevant to the problem; notice that the first two rows (those from the original file) are also double-spaced.The real problem is that you have opened your file in text mode.CSV is a binary format, believe it or not. The csv module is writing the misleadingly-named "lineterminator (should be "rowseparator") as \r\n as expected but then the Windows C runtime kicks in and replaces the \n with \r\n so that you have \r\r\n between rows. When you "open" the csv file with Excel it becomes confusedAlways open your CSV files in binary mode ('rb', 'wb', 'ab'), whether you are operating on Windows or not. That way, you will get the expected rowseparator (CR LF) even on *x boxes, your code will be portable, and any linefeeds embedded in your data won't be changed into something else (on writing) or cause dramas (on input, provided of course they're quoted properly).Other problems:(1) Don't put your data in your root directory (C:\). Windows inherited a hierarchical file system from MS-DOS in the 1980s. Use it.(2) If you must embed hard-wired filenames in your code, use raw strings r"c:\test.csv" ... if you had "c:\test.csv" the '\t' would be interpreted as a TAB character; similar problems with \r and \n(3) The examples in the Python manual are aligned more towards brevity than robust code.Don't do this:Do this:Then when you are finished, you have f available so that you can do f.close() to ensure that your file contents are flushed to disk. Even better: read up on the new with statement.
I have encountered a similar problem with appending an already created csv file, while running on windows. As in this case writing and appending in "binary" mode avoids adding extra line to each rows written or appended by using the python script. Therefore;      


Answer URL
https://docs.python.org/3/library/csv.html
