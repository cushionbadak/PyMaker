Natural Text
How to get last 'n' groups after df.groupby() and combine them as a dataframe. After doing grouped.ngroups i am getting total number of groups 277. I want to combine last 12 groups and generate a dataframe.
Pandas GroupBy objects are iterables. To extract the last n elements of an iterable, there's generally no need to create a list from the iterable and slice the last n elements. This will be memory-expensive.Instead, you can use either itertools.islice (as suggested by @mtraceur) or collections.deque. Both work in O(n) time.itertools.isliceUnlike a generator, a Pandas GroupBy object is an iterable which can be reused. Therefore, you can calculate the number of groups via len(g) for a GroupBy object g and then slice g via islice. Or, perhaps  more idiomatic, you can use GroupBy.ngroups. Then use pd.concat to concatenate an iterable of dataframes:collections.dequeAlternatively, you can use collections.deque and specify maxlen, then concatenate as before.As described in the collections docs:Once a bounded length deque is full, when new items are added, a  corresponding number of items are discarded from the opposite end....  They are also useful for tracking transactions and other pools of data  where only the most recent activity is of interest.
Assuming you know the order of grouped
use pd.concat on lists comprehension and groupby.get_group
You could pass a list comprehension to pd.concat():Yields:


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.islice
https://docs.python.org/3/library/collections.html#collections.deque
