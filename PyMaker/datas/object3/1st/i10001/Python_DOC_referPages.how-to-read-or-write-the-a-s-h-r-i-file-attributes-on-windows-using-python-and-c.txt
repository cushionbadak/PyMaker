Natural Text
For the records:a means 'archivable's means 'system'h means 'hidden'r means 'readonly'i means 'indexable'My current solution to read/write these attributes from Python scripts is to call attrib using the subprocess module.Python code:Output:But this performs slow when the directory contains many entries (one subprocess call per entry).I dont want to use the win32api module because i dont want third party module dependencies. Also im curious how to do it with ctypes.I have stumbled over Hide Folders/ File with Python [closed], Set "hide" attribute on folders in windows OS? and Python: Windows System File, but this is not clear to me. Especially i dont understand what these 0x4 es 0x02 es are. Can you explain this? Can you give a concrete code example?
With the help of eriksuns comments to my question i solved it. Here is the code from my question but now using ctypes, stat and os.scandir. It requires Python 3.5+. Writes are ~50 times faster and reads are ~900 times faster.Python code:Output:


Answer URL
https://docs.python.org/3/library/subprocess.html#module-subprocess
https://docs.python.org/3/library/ctypes.html#module-ctypes
https://docs.python.org/3/library/ctypes.html#module-ctypes
https://docs.python.org/3/library/stat.html
https://docs.python.org/3/library/os.html#os.scandir
https://docs.python.org/3/library/os.html#os.stat_result.st_file_attributes
https://docs.python.org/3/library/stat.html#stat.FILE_ATTRIBUTE_ARCHIVE
https://docs.python.org/3/library/os.html#os.scandir
