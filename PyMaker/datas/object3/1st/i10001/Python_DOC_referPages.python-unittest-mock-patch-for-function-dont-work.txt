Natural Text
I'm trying to test my python application use unittests with mock.patch but it don't work as well.My code:test_file.pyThe post request call the decorator that check "user auth" use get_authenticated_user function. But in decorator I got function instead mock-object.decorators.pyWhy in decorators.py I got a function instead the mock-object?Python version is 3.4.0
You appear to be patching the wrong location. In decorators.py you are using a global name get_authenticated_user(), but you are patching a name in api.accounts.helpers instead.You probably imported get_authenticated_user with:which means that patching the original location won't change the reference in decorators.Patch the global in decorators:Also see the Where to patch section of the mock documentation:patch() works by (temporarily) changing the object that a name points to with another one. There can be many names pointing to any individual object, so for patching to work you must ensure that you patch the name used by the system under test.The basic principle is that you patch where an object is looked up, which is not necessarily the same place as where it is defined. 


Answer URL
https://docs.python.org/3/library/unittest.mock.html#where-to-patch
