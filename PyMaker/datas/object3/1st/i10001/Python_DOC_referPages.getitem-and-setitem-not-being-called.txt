Natural Text
I have the following class definition:The get and set methods don't seem to be being called. I'm initialising with:If I try to then execute print(a[1,1]), I get the error:If I try to execute a[49,49] = 1, I get:Why are my custom methods not being called, and how do I fix it?
You are misunderstanding what __new__ does or accidentally used it where you should have used __init__. You are returning the Codes object itself by returning self:__new__ is called as a static method on the class and is expected to produce a new instance in the method.Because you returned the type object (the class), __getitem__ and __setitem__ are looked up on type (the default metaclass) (see Special method lookup), which fails.You probably wanted to use __init__ there instead; __init__ is called on an already-created instance:__init__ doesn't need to return anything (and what it returns is ignored anyway), so you can drop the return self line altogether.If you feel you must use __new__ (perhaps because you are subclassing an immutable type), then at the very least create an instance with super().__new__():but using __init__ instead is just simpler.
AddRename toand remove line


Answer URL
https://docs.python.org/3/reference/datamodel.html#special-method-lookup
