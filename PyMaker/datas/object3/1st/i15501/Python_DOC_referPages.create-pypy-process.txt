Natural Text
I would like to create a process which runs PyPy. I tried the following and it works:However, when I remove the chdir as:I get:Please, does anyone know how to spawn a PyPy process without changing the working directory?
This may not be correct (in which case I'll delete it), but I'm pretty sure that all you need to do is:In other words, pass the full path for arg0 as well as path.Why? Well, when PyPy starts up, it's got to be using (the RPython/compiled-to-C equivalent of) sys.argv[0] to find the path to a custom stdlib. What else could it use? Which is of course just copied from the char *argv[] argument passed to the interpreter's main function. When you let the OS launch a program for you, it will put the full path in there. But when you explicitly set it with execl, it will just copy whatever you gave it.It's actually a bit more complicated than this—it does a readlink (to allow symlinks) and an abspath (to allow itself to be run by relative path—as in your first example). But the basic idea is the same.As a side note, you might want to consider using a fully-installed PyPy instead of a run-out-of-build-tree PyPy, in which case its sys.prefix will be set up properly so it won't need this.


Answer URL
https://docs.python.org/3/library/os.html#os.execl
https://docs.python.org/3/library/sys.html#sys.argv
