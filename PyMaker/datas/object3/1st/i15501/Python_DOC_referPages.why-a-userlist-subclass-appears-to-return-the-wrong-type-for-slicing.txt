Natural Text
Let me start by saying I get why subclassing list doesn't work as you might expect (because list is a primitive built-in type and there are issues of performance, etc.). AFAIK collections.UserList is supposed to avoid all these problems and make subclassing UserList work completely as you might expect. For example,returns <class 'list'>, butreturns <class '__main__.DumbList'> as expected. However, slicing appears to return the wrong type, even when using UserList instead of list:returns <class 'list'>, not <class '__main__.DumbList'> as expected.Two questions:Why is this?What should I do to make slicing return the correct type? The simplest thing I can think of is something like:Â ...but it seems like this kind of boiler-plate code should be unnecessary.
In Python 2, plain slicing (without a stride) would be handled by the __getslice__ method. The UserList implementation predates the addition of extended slices (with stride) to the language and never added support for them, see issue 491398.The Python 3 implementation simply took the Python 2 version, moved into collections and removed __getslice__ and __setslice__ as those are no longer supported in Python 3.As such, the __getitem__ implementation is still simply:assuming that slicing would be handled elsewhere.In Python 3, all slicing is handled by passing in the slice() built-in type to __getitem__; simply test for that type and wrap the result in a type(self) call:


Answer URL
https://docs.python.org/3/library/functions.html#slice
