Natural Text
I'm almost there with using some Python code to pull down stock data strings passed to it from SAS to build a text file to read back into SAS, but the final output text file remains at 0 bytes, despite the code running without error and the print statements I have put in the log seeming to display valid output. Here is the code:The various print statement shows the source text file contents being picked up correctly and passed through to the code ok. The line print("future result =", future.result()) shows the following result:This looks like the correct values to me, but just needing cleaning up. The destination text file resolves correctly and the all OK statement below the error handling returns the byte length of the URL submission correctly. The text file though remains empty.Can anyone spot an obvious mistake I have made?Thanks
The codegives the resultWhich is a variable description. In order to close the file you need to specifyIf the various values all apply to the same piece of data, then you would probably be better off building a csv file with the field headers in row 1 showing the header strings that you want then get the data and use a translation dictionary.Output the csv file using csv.DictWriter() with the field headers that you choose using the appropriate parameters such as restval='' and extrasaction='ignore'Now you can process the csv file and perform your analysis on all the data using only one input file rather than a separate input file for each piece of data.Note: if you somehow open the same file twice, open it with 'ab' in order not to wipe out the previous data. It is a better idea to always open with 'ab' instead of 'wb' unless you specifically want to wipe out any previous data.
Move d = open(filepath,"wb") and d.close() outside of the for loop.Every iteration of the loop deletes and overwrites the file.http://docs.python.org/3/tutorial/inputoutput.html#reading-and-writing-filesEDIT:I didn't see that the filepath is calculated in the forloop. I'd do what @sabbahillel pointed out, and open the file with "ab" mode to ensure it's not overwritten.


Answer URL
