Natural Text
So, let's say I want to write my own class, rewriting __getattribute__ function. Every time, when someone calls attribute, which was not defined, I want it to generate a random int.Obviously, I can't write something like this, as it would cause a recursion.    How, without using __dict__, can I get an information about defined attributes?
I strongly urge you to reconsider overriding __getattribute__ and use the object.__getattr__() hook instead. That method is called automatically for any missing attribute, and won't interfere with dir() or __dict__ introspection:Your own implementation is flawed because you failed to check the class for your attribute. __dict__ is a descriptor on the class, and trying to access self.__dict__ is handled by object.__getattribute__ too, triggering your infinite recursion. You can avoid the issue entirely by using  object.__getattribute__ first. You could just catch the AttributeError exception this could throw:The more painful path would be to re-implement the descriptor protocol to retrieve your __dict__ attribute before testing:or you could access self.__dict__ via object.__getattribute__(self, '__dict__'). You do have to test the class MRO too, because those provide attributes for your instances too; you wouldn't want X.__class__ to return a random integer rather than GetAttribute itself.However, this use-case is already covered by implementing __getattr__ instead, a much cleaner and simpler option.Last but not least, instead of using object.__getattribute__(self, ...), you should use super().__getattribute__(...) to ensure you are not skipping any other __getattribute__ hooks in your class hierarchy.
If you need to bypass your own __getattribute__, for example to get at the "real" self.__dict__, you can explicitly call the superclass __getattribute__:However, for your case, it'd probably be easier to just implement __getattr__ instead of __getattribute__. __getattr__ is only called for attribute lookups that __getattribute__ raises an AttributeError on:


Answer URL
https://docs.python.org/3/reference/datamodel.html#object.__getattr__
https://docs.python.org/3/howto/descriptor.html
