Natural Text
I am new to pandas. I have written a function which I want to apply to all entries in a pandas DataFrame "Monthly_mean_consump" for which a sample of data is provided below. I have written a function whose input is the individual element in dataframe "Monthly_mean_consump" and wherever this value is larger than 0.45, the function finds corresponding cost from another DataFrame "df_loss_peak" (a sample is provided below) and returns corresponding cost.The function which I have written is following:I have used two nested for loops (code is below) to apply this function to each elements of the dataframe "Monthly_mean_consump" and I am getting the desired output. However, I am aware that this is quite time consuming and pandas provides an efficient fuction "applymap()" which is much suited for this job. I have used the applymap() function in various other taks. But when I write the following code in order to use applymap() here, I get keyindex error -1:Any help would be appreciated? Also am I right in thinking that applymap() function would be much efficient than the loop which I have implemented?Thanks
I think you can use cut with stack for Series from DataFrame:If need filter data add dropna + rename_axis + reset_index:If need replace values use unstack + combine_first:
You can use bisect library.if you want the cost of value less than 0.45 to have a different value, you may want to add a first line at zero on your df_loss_peak dataframe.outputIf you don't want them you can add:output:


Answer URL
https://docs.python.org/3/library/bisect.html
