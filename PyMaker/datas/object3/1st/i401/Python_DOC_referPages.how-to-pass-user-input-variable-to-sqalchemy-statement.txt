Natural Text
I am fairly new to the world of programming. I'm using Python, Pandas and SQLlite; and recently I've started to build Postgresql databases.  I am trying to query a postgres database and create a Pandas dataframe with the results.  I've found that the following works:The works perfectly but my problem is how to pass user input to the sql query.  Specifically, I want to do the following:However, this returns an error message:ProgrammingError: (psycopg2.ProgrammingError) column "province_selected" does not existLINE 1: SELECT * FROM my_table Where province =province_selec...Can anyone provide guidance on this matter?  In addition, can anyone advise me as to how to handle field names in a postgres database that have characters such as '/'.  My database has a field (column header) called CD/CSD and when I try to run a query on that field (similar to code above) I just get error messages.  Any help would be greatly appreciated.
You should use the functionality provided by the DBAPI module that SQLAlchemy uses to send parameters to the query. Using psycopg2 that could look like this:This is safer than using Python's string formatting to insert the parameter into the query.Passing parameters using psycopg2pandas.read_sql documentation
there are many ways to do that, the simplest is:But this has security problems if you are not careful to validate that the data does not have some kind of SQL injection.
For the first part of your question you can use string formating. The way you specified the query will fail because it will search for a column named "province_name" which does not exist. There are various approaches to format strings, I will suggest one that works in Python 3.5+. Please also check f strings for Python 3.6+.Code could look like this:If you do print(query) you will realize that is exactly the same thing as the one had success with.
Regarding the first question, at the moment you are passing the following string to your sql engine:'SELECT * FROM my_table Where province=province_name'In order to replace 'province_name' with the variable province_name from the python code you could use the format method:The format method will replace the {} with the contents of the variable province_name.There are many ways to use the format method which are explained well in this guideedit: Note that as others have stated this has security concerns since you are using raw user input, so other methods are more suitable for this instance.


Answer URL
https://docs.python.org/3/whatsnew/3.6.html#pep-498-formatted-string-literals
https://docs.python.org/3/whatsnew/3.0.html#builtins
