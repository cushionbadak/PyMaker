Natural Text
I am working with Python's re.sub function. It's throwing a TypeError: "expected string or buffer." After debugging and adding plenty of assert statements to check that I am passing strings to re.sub, I am still unsure about why I am getting the exception. Below, please see: my code, the error stack, and other related questions I have perused.--------------------------------------------------------------------------- TypeError                                 Traceback (most recent call  last)  in ()  ----> 1 trainingData = readFile("train-v1.1.json")        2 from sys import getsizeof        3 print("Finished loading training data.")        4 print("Size of training data:",getsizeof(trainingData)) in readFile(filename)       51                     question = str(qas_pair["question"].encode('ascii','replace'))       52                     # Replace numeric characters with English words.  ---> 53                     question = convertNumbersToWords(question)       54                     answer_text = convertNumbersToWords(answer_text)       55                     article_title = convertNumbersToWords(article_title) in convertNumbersToWords(_string)       16         #Error: expected string?       17         assert isinstance(_string,str)  ---> 18         _string_copy = p.sub(_string,n2w)       19         return _string_copy       20     questions = []TypeError: expected string or bufferOther questionsTypeError: expected string or bufferTypeError: expected string or buffer while using regular expression in pythonpython re.search error TypeError: expected string or bufferThese questions specifically address a situation where a regex function is receiving strings; since I have done the legwork to ensure this is true, I feel these questions are irrelevant.
For starters, you may want to change _string_copy = p.sub(_string,n2w) to _string_copy = p.sub(n2w,_string). In addition, it would help if you can also provide a sample of your JSON file. Then, though not sure what you want, you might consider changing extractedData = np.array(questions,articleTitles,articleTexts,answers) to extractedData = np.array([questions,articleTitles,articleTexts,answers])
Your code contains instruction: _string_copy = p.sub(_string,n2w) and the otheranswer suggests to change it to _string_copy = p.sub(n2w, _string).I agree with that (the first parameter should be the replacement expression),but I spotted another detail raising my doubts, concerning n2w function.Look e.g. at https://docs.python.org/3.7/library/re.html - a documentationof re module and find fragment If repl is a function.The next sentence states: The function takes a single match object argument,but in your code n2w function has a _string as a parameter.Unfortunately, I'm unable to reproduce the error, since I have noinput file, so I limit my post to just making you aware of the abovediscrepancy.Maybe you should change the parameter to match (match object) and reworkthe content accordingly? The string just matched you can obtain with_string = match.group().I spotted also such a weird detail in p = re.compile('[1-9]*[1-9]'):Look at the regex. It contains:[1-9]* - a sequence of digits (1 to 9), possibly empty,[1-9] - another (single) digit.Why didn't you write just [1-9]+? It means just the same (a non-emptysequence of digits), but is shorter and less complicated.


Answer URL
https://docs.python.org/3/library/re.html#re.Pattern.sub
