Natural Text
I'm working on a school project and I don't have a lot of time to finish it. I'm unable to find the solution. I read tons of references, but I'm not a developer.Half of the code below is not from me, which explains why I can't find a solution.My problem: I have to collect rejects from Iptables in bash (with the log) and make a very simple real-time graph of that in Python.I've already done that: In bashAnd in Python: I don't get how i can put my bash variable in the PullData instead in that .txt file.I get my variable like that: If anyone can help me, I will be so pleased.Excuse my English; I'm French.
Your bash script must export the variables to get them into the main environment space.  From there, your Python's os.environ call will be able to find the value.  In your last code portion, please try to print x22 to check that it works.
Looking at what you are trying to achieve, i.e a dynamically updated graph, I suggest that you can't do it with environment variables. You can set and export them from the parent shell, however, the environments of parent and child are independent so any change made in the parent is not visible in the child.You could implement the bash script functionality in Python, but I assume that you must use a bash script. One way to do it would be to have the bash script write to the "pull data" file, which the Python script then reads and graphs, as it currently does. There will be problems with this method because it's possible for the Python script to read the file while it's being updated and therefore receive incomplete or mixed values. There are ways that you can synchronise access, however, it's messy.A better way would be to call the bash script from within Python. The bash script would write the data to it's standard out, which Python can read and make the graph without worrying about the bash script overwriting it mid-processing. You can use subprocess.check_ouput() (or subprocess.run() if using Python >= 3.5) for this:bash scriptAnd then in the Python script call the script (assume it's named count_rejects,sh) by changing the first few lines of animate() like this:There are some other improvements that could be made to the Python code, e.g. the graph data should be sorted before plotting, but this should be enough to get you going.And you might want to use a bar chart rather than a graph.


Answer URL
https://docs.python.org/3/library/subprocess.html#subprocess.check_output
https://docs.python.org/3/library/subprocess.html#subprocess.run
