Natural Text
I'm having trouble using a Dict and list comprehension as a case statement. I only want the first match - but I'm getting all matches. The dict is rather long, but it looks lie this:The function is simple:What I'm getting is "3rd Party SoftwareVMWareMicrosoftVMWare".  Clearly the "and len(vuln_cat)==0" is not evaluating in the loop as I expected, resulting in every category match concatenating the dict value.Yes, I can (and have) code it as nested loops as an easy fix, but I'd like to know the right way to fix this.   Python version is 3.4. I'm trying to keep this simple as it is an fugly script.
vuln_cat is only set after the list comprehension completes, you can't access the list being built from inside the comprehension.Use a generator expression inside the next() function instead, this'll only pick the first matching result:The second argument to the next() function is a default, used if the generator expression did not yield any results.Demo:


Answer URL
https://docs.python.org/3/tutorial/classes.html#generator-expressions
https://docs.python.org/3/library/functions.html#next
