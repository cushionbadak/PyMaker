Natural Text
I have a numpy array like,How do I filter out the prime numbers from this array in a pythonic manner?I know to do a simple filtering like,Is there a way to pass a lambda function for filtering?Expected output: array([17, 19, 23])
The way that I would do it is with gmpy or a 3rd party library who has developed a good primality test algorithm. The Miller-Rabin primality test is generally a very safe (and fast!) bet. If you just want the slow way, you can do:If you want to filter OUT the primes, just call np.invert on the pbools variables. The same would go for any predicate. You can also pass a lambda into vectorize. For example, say we wanted only prime numbers that are also 1 away from being divisible by 5 (for whatever reason).
If you care of speed and efficiency I would recommend you to use one of the fastest prime sieves and numpy.intersect1d() function:
Having a setup like this:So now we create an array that contains all possible integer candidates:Now apply the modulo operation on the array but with a different dimension so we check each number with each divisor:Now how do we get the primes ... we check if there is no result in the line that is zero:and then create a mask to index them:So all you need in the end is:all the other stuff is just for illustrating what each step is doing.This is not trivial since it uses broadcasting of 1D arrays into a 2D array but the method should be clear. Let me know if you have any questions.If you want to optimize this, there is another possibility: The divisors are currently every number between 2 and the sqrt(max(array)) but you don't need to test for all these numbers. If you had a function that returned all primes in that range that would be enough. For example using primesfrom2to of @MaxU's answer a faster possibility is:but it uses the same mechanism as before but is a bit faster. :-)
It appears that you question is not about primes at all, but about how to apply a function to numpy array. I used simple is_odd example. Maybe np.vectorize is what you are looking for:If I recall correctly np.vectorize is used primarily for convenience, and does not have great performance.
If you really want to use a Filter, you can use this:What does this do?We search all indexes with prime number by usingThis basically goes through every value and checks if it is not divisible by any value smaller than itself (ignoring 1)


Answer URL
https://docs.python.org/3/reference/expressions.html#binary-arithmetic-operations
