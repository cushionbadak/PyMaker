Natural Text
I'm using a sqlite3 table to store python dicts (utf8 content) and serialization is done with JSON. It works fine in python2.7 but fails in 3.3.Schema:When inserting values, the dict is serialized with json.dumps(d).The faulty part is retrieving the previously saved values.The above script works fine when executed with python2.7. However, using 3.3 a TypeError occures:I can't spot an essential difference between the 2.7 and 3.3 JSON modules (especially regarding json.loads) and I'm running out of ideas. 
According to Python 3 json module documentation:The json module always produces str objects, not bytes objects. ...According to Python 3 sqlite3.register_converter documentation:Registers a callable to convert a bytestring from the database into a custom Python type. ...If you try to load bytesstring json, you get TypeError:You should convert bytes to str before call json.loads using bytes.decode.


Answer URL
