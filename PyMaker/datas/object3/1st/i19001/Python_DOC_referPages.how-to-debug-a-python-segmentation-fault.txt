Natural Text
How can I debug a Python segmentation fault?We are trying to run our python code on SuSE 12.3. We get reproducible segmentation faults. The python code has been working on other platforms without segmentation faults, for years.We only code Python, no C extension ....What is the best way to debug this? I know a bit ansi c, but that was ten years ago ....Python 2.7.5UpdateThe segmentation fault happens on interpreter shutdown.I can run the script several times:But the segmentation faults happen, if I leave the pdb with ctrl-d.Update 2I now try to debug it with gdb:Update 3I installed gdbinit from http://hg.python.org/cpython/file/default/Misc/gdbinitand the debugging symbols from http://download.opensuse.org/debug/distribution/12.3/repo/oss/suse/x86_64/What now?Update 4We installed the a new RPM (python-2.7.5-3.1.x86_64). We get less segfaults, but they still happen.Here is the link to repository:http://download.opensuse.org/repositories/devel:/languages:/python:/Factory/openSUSE_12.3/x86_64/ Update 5Solved my initial problem:It was http://bugs.python.org/issue1856 (shutdown (exit) can hang or segfault with daemon threads running)Related: Detect Interpreter shut down in daemon thread
I got to this question because of the Segmentation fault, but not on exit, just in general, and I found that nothing else helped as effectively as faulthandler. It's part of Python 3.3, and you can install in 2.7 using pip.
Maybe there is a daemon thread running? There is a reproduceable bug, which was fixed only for 3.x, but not for 2.x: http://bugs.python.org/issue1856:This is the answer to my own question. It took some time to find the root of the problem.Here is the next question: How to code around this bug: Detect Interpreter shut down in daemon thread
If you're executing nothing but Python code (even through your imported third party modules), than a segfault probably means there's a bug in the interpreter or one of its builtin C modules.You can either build CPython and try to debug it yourself, or try to produce the smallest script which reproduces the crash and file an issue.


Answer URL
https://docs.python.org/3/library/faulthandler.html
