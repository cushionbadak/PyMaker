Natural Text
I'm using a Python library that does something to an objectand changes it. While doing so, it prints some statistics to stdout, and I'd like to get a grip on this information. The proper solution would be to change do_something() to return the relevant information,but it will be a while before the devs of do_something() get to this issue. As a workaround, I thought about parsing whatever do_something() writes to stdout.How can I capture stdout output between two points in the code, e.g.,?
Try this context manager:Usage:output is now a list containing the lines printed by the function call.Advanced usage:What may not be obvious is that this can be done more than once and the results concatenated:Output:Update: They added redirect_stdout() to contextlib in Python 3.4 (along with redirect_stderr()). So you could use io.StringIO with that to achieve a similar result (though Capturing being a list as well as a context manager is arguably more convenient).
In python >= 3.4, contextlib contains a redirect_stdout decorator. It can be used to answer your question like so:From the docs:Context manager for temporarily redirecting sys.stdout to another file  or file-like object.This tool adds flexibility to existing functions or classes whose  output is hardwired to stdout.For example, the output of help() normally is sent to sys.stdout. You  can capture that output in a string by redirecting the output to an  io.StringIO object:To send the output of help() to a file on disk, redirect the output to  a regular file:To send the output of help() to sys.stderr:Note that the global side effect on sys.stdout means that this context  manager is not suitable for use in library code and most threaded  applications. It also has no effect on the output of subprocesses.  However, it is still a useful approach for many utility scripts.This context manager is reentrant.


Answer URL
https://docs.python.org/3/library/contextlib.html#contextlib.redirect_stdout
https://docs.python.org/3/library/contextlib.html#contextlib.redirect_stdout
https://docs.python.org/3/library/contextlib.html#contextlib.redirect_stdout
