Natural Text
Can I change default open() (io.open() in 2.7) text encoding in a cross-platform way?So that I didn't need to specify each time open(...,encoding='utf-8').In text mode, if encoding is not specified the encoding used is platform dependent: locale.getpreferredencoding(False) is called to get the current locale encoding.Though documentation doesn't specify how to set preferred encoding. The function is in locale module, so I need to change locale? Is there any reliable cross-platform way to set UTF-8 locale? Will it affect anything else other than the default text file encoding?Or locale changes are dangerous (can break something), and I should stick to custom wrapper such as:
Don't change the locale or preferred encoding because; it may affect other parts of your code (or the libraries you're using); andit wont be clear that your code depends on open using a specific encoding.Instead, use a simple wrapper:This has two other advantages:You can specify defaults for all keyword arguments (should you need to).You can override the defaults when calling the function.
you can set the encoding ... but its really hackyI would instead domain_script.pythen anywhere you call open it will use the utf8 encoding ... however it may give you errors if you explicitly add an encodingor just explicitly pass the encoding any time you open a file , or use your wrapper ...pythons general philosophy is explicit is better than implicit, which implies the "right" solution is to explicitly declare your encoding when opening a file ...
I would not change anything in locale, as it could have a lot of side effects in other parts of your system. open is a system level function call, so its settings can have effects outside of that, or at a minimum other Python programs that use the same Python installation. Your wrapper looks appropriate, is very clean and portable, and looks to be the correct solution.
If you really need to change the default encoding, you can replace the built-in open function.I wrote and tested this snipped after I found this mails about replacing print on a mailing list.


Answer URL
https://docs.python.org/3/library/functions.html#open
