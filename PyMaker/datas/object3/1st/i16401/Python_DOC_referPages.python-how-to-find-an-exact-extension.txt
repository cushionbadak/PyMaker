Natural Text
I'm trying to loop through a folder with several files, to find a file with the extension .doc. Yes I used the .endswith('.doc') function, but in my case, it's also parsing through .docx files. Is there a regular expression or some sort to use?EDIT: Alright, my problem is, I'm looping through to find ".doc" files, and if there is one, I will do an extraction of text into a variable and then print it using win32com functions. When I put the program through a folder that contains both ".doc" and ".docx" files, I have an error that says:From my experience and knowledge with COM functions, it's parsing through ".docx" files too, that's why there's no "Word.Application.Documents" for .docx files. Hence explaining that error. So when I isolated the ".doc" file into another folder (i.e. with no .docx file present), the loop and program is perfectly fine. It prints the content of the file and ends there.Excerpt of my code:
(Edited. See below for original answer.)The real problem here appears to be something to do with the algorithm and/or something else on the system (per comments about restarting changing things), since str.endswith() and Path.suffix should give the same results here. Previous (not the real problem)The simplest and most robust solution is using the pathlib module. If you're on Python 3.4 or newer, it comes installed; otherwise use pip or easy_install to install it. Then you can deal with your path like this:The suffix attribute is simple to use and reliable, and will get you what you want. For more details, see the 3.4 docs on the pathlib module here.
I don't know the structure of an os.walk() object, but, supposing you have a string array with the filenames, you can use this regular expression to filter them:result:


Answer URL
https://docs.python.org/3/library/pathlib.html
