Natural Text
Here I have a function that populations an info dictionary and inserts the values into a table in a database. DML is a helper method from another function that has been there for a while now and makes the call to the oracle database, with most of the database info already hardcoded in that function. How can I unittest this function? I can't mock a database because the helper function is hardcoded to access our production db.
The help function DML is not part of the unit you are testing; mock it. The only thing you need to test in insert_env, apparently, is that DML is called with the appropriate arguments, and that the logger is used if DML raises an exception.The fact that info, a local variable in insert_env, is never used again after DML is called suggests that this is not the full function. There may be more to test, but it is impossible to say with the information given.
First make your sql string a global constant preferably in a second file. Then mock the db calls.


Answer URL
https://docs.python.org/3/library/unittest.mock.html
