Natural Text
I've only programmed in Python for the past 8 months, so please excuse my probably noob approach to python.My problem is the following, which i hope someone could help me solve.I have lots of data in a file, for instance something like this (just a snip):I want to run through all the data in the file and check if a serial number occurs more than once. If it does i want to remove the duplicate found. The reason why the result might contain the same switch or router multiple times is that it might have several layer 3 interfaces, where it can be managed. So in the above example. After i've run through the data it should remove the line:Since the second line in the file already contains the same switch and serial number. I've spend several days trying to figure out, how to achieve this and it is starting to give me a headache.My base code looks like this:Is there a more pythonic way to do this? I am pretty sure with all the talented people here, that someone can give me clues on how to make this happen. Thank you very much in advance. 
My suggestion:You'll end up with ok containing only rows with uniq srn, and print the removed rowsHopefully it might help
You're making it way more complicated than it has to be, and not memory-friendly (you dont have to load the whole file in memory to filter duplicates).The simple way is to read your file line by line, and for each line check if the serial number has already been seen. If yes, skip the line, else store the serial number and write the line to your output file:NB : I assume you want to write back the deduplicated lines to a file. If you want to keep them in memory the algorithm is mostly the same, just append your deduplicated lines to a list instead - but beware of memory usage if you have huge files.
I will walk you through the changes I would make.The first thing I would do would be to use the csv module to parse the input. Since you can iterate over the DictReader, I also opt for that for brevity. The list data will contain the final (cleaned) results.The format of the data will have changed by my approach, from a list of lists to a list of dicts, but if you want to save the cleaned data into a new csv file, the DictWriter class should be an easy way to do that.


Answer URL
https://docs.python.org/3/library/csv.html
https://docs.python.org/3/library/csv.html
