Natural Text
Running mkpasswd -m sha-512 -S salt1234 password results in the following:I have this snippet of Python code that I thought would output the same, but isn't:It instead results in:Not sure what I am doing wrong.Another question I have is, how do I tell sha512 function to do custom rounds. It seems to take only 1 argument. 
mkpasswd is a front-end to the crypt() function. I don't think it is a straight-forward SHA512 hash here.A little research points to the specification for SHA256-crypt and SHA512-crypt, which shows the hash is applied a default 5000 times. You can specify a different number of rounds using the -R switch to mkpasswd; -R 5000 indeed gives you the same output:The minimum number of rounds offered by the command-line tool is 1000:The algorithm is a bit more involved, requiring you to create several digests. You could instead access the C crypt() function through the crypt.crypt() function, and drive it the same way the mkpasswd commandline does.It depends on your platform if the SHA512-crypt method is available; the Python 3 version of the crypt module offers a crypt.methods list that tells you what methods your platform supports. Since this use the exact same library mkpasswd uses, your OS obviously does support SHA512-crypt and Python will have access too.You need to prefix the salt with '$6$ to specify the different method. You can specify the number of rounds by adding a 'rounds=<N>$' string between the '$6$' string and your salt:This then produces the same output as the mkpasswd command line:
You need to use crypt.crypt:
Here is a pure python3 implementation of the sha512_crypt function based on the specification. This is for illustration only, always use crypt.crypt instead!


Answer URL
https://docs.python.org/3/library/crypt.html#crypt.crypt
https://docs.python.org/3/library/crypt.html#crypt.methods
