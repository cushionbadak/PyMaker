Natural Text
I am using python/pysam to do analyze sequencing data. In its tutorial (pysam - An interface for reading and writing SAM files) for the command mate it says:'This method is too slow for high-throughput processing. If a read needs to be processed with its mate, work from a read name sorted file or, better, cache reads.'How would you 'cache reads'?
Caching is a typical approach to speed up long running operations. It sacrifices memory for the sake of computational speed.Let's suppose you have a function which given a set of parameters always returns the same result. Unfortunately this function is very slow and you need to call it a considerable amount of times slowing down your program.What you could do, is storing a limited amount of {parameters: result} combinations and skip its logic any time the function is called with the same parameters.It's a dirty trick but quite effective especially if the parameters combination is low compared to the function speed.In Python 3 there's a decorator for this purpose.In Python 2 a library can help but you need a bit more work.
AlignmentFile takes as the first argument:filepath_or_objectSo instead of supplying a filename, you can supply an object that supports a file-like interface, i.e. the methods seek, read, tell.When implementing a class for this, you can also implement caching on the reads, which of course have to depend on current cursor position.If filesize is small enough so that it fits into memory, you can read the complete file and operate on an io.BytesIO object, no need to make your own class:I am not sure that this will speed things up much, because i assume that modern operating systems (i know linux will do that) do cache file access. So maybe it is enough to rely on that.


Answer URL
https://docs.python.org/3/library/functools.html#functools.lru_cache
