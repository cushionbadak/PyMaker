Natural Text
In Python 2.7 running on WindowsÂ XP pro:It generates a file, test.csv, with an extra \r at each row, like so:test.csvinstead of the expected:Why is this happening, or is this actually the desired behavior?
On Windows, always open your files in binary mode ("rb" or "wb") before passing them to csv.reader or csv.writer.Although the file is a text file, CSV is regarded a binary format by the libraries involved, with "\r\n" separating records. If that separator is written in text mode, the Python runtime replaces the "\n" with "\r\n" hence the "\r\r\n" that you observed in your file.See this previous answer.This answer was posted in 2010 and does not address the problem in Python3.One of the possible fixes in Python3, as described in @YiboYang's answer, is opening the file with the newline parameter set to be an empty string:
While @john-machin gives a good answer, it's not always the best approach. For example, it doesn't work on Python 3 unless you encode all of your inputs to the CSV writer. Also, it doesn't address the issue if the script wants to use sys.stdout as the stream.I suggest instead setting the 'lineterminator' attribute when creating the writer:That example will work on Python 2 and Python 3 and won't produce the unwanted newline characters. Note, however, that it may produce undesirable newlines (omitting the LF character on Unix operating systems).In most cases, however, I believe that behavior is preferable and more natural than treating all CSV as a binary format. I provide this answer as an alternative for your consideration.
In Python 3 (I haven't tried this in Python 2), you can also simply doas per documentation.More on this in the doc's footnote:If newline='' is not specified, newlines embedded inside quoted fields  will not be interpreted correctly, and on platforms that use \r\n  linendings on write an extra \r will be added. It should always be  safe to specify newline='', since the csv module does its own  (universal) newline handling.
I'm not sure exactly why it is happening, but changing your file mode from "w" to "wb" fixes it.  See my answer to "how to remove ^M" for more details.
You have to add attribute newline="\n" to open function like this:
You can introduce the  lineterminator='\n' parameter in the csv writer command.
Note that if you use DictWriter, you will have a new line from the open function and a new line from the writerow function.You can use newline='' within the open function to remove the extra newline.


Answer URL
https://docs.python.org/3/library/csv.html#csv.writer
https://docs.python.org/3/library/csv.html#id3
