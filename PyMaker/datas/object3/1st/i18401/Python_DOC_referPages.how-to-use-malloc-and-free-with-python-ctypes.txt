Natural Text
I have a function in my C library, say runsim() which takes pointer to struct repdata as one of the arguments, where struct repdata is given byWhen using C exclusively, I initialize a variable of type struct repdata calling the function,and then fill this struct as simulation proceeds. After I have written the data to a file, I free the memory using the standardI want to call the runsim() function from Python using Python Ctypes. For this I need to pass a pointer to a variable (that is equivalent to the type of struct repdata) as one of the runsim() arguments. Suppose that in Python I have defined an equivalent of struct repdata in the following manner.What is the equivalent of create_data_container function shown above on the Python side? I want to initialize an instance of Repdata which can be passed to C code and has sufficient memory for storing the replication data. And, once simulation is completed, how do I free the memory from Python?I am using Ubuntu Linux 12.04.Thanks in advance for your help.
You can allocate buffers using ctypes and assign them to the pointers.  Once the Python ctypes objects have no references they will be freed automatically.  Here's a simple example (with a Windows DLL...don't have a Linux machine handy, but the idea is the same) and a Python wrapper.create_string_buffer allocates a writable buffer that can be passed from Python to C that ctypes will marshal as a char*.You can also create writable arrays of ctypes types with the syntax:x.hx.cx.pyOutput


Answer URL
