Natural Text
I have the following simple code causing an error regarding caching: The function parseTrip() gets a list of strings and creates and returns a class Trip:I get the error right after the action count(). However, if I remove the cache() at the end of second line everything work fine. According to the error the problem is that the class Trip can not be pickled:So how can I make it picklable (if it is an actual word)? Note that I am using a Databricks notebook so I can not make a separate .py for class definition to make it picklable. 
Environment does not affect the answer - if you want to use custom classes it has to be importable on every node in the cluster. For a single module you can easily use SparkContext.addPyFile with URL to a GitHub Gist (or another supported format: "file in HDFS (or other Hadoop-supported filesystems), or anHTTP, HTTPS or FTP URI")Create a gist.Click on Raw link and copy URL.In your notebook call:For complex dependencies you distribute egg files.Create Python package using setuptools.Directory structure:Example setup file:Create egg file:This will create dist directory with trip-0.0.1-pyX.Y.egg fileGo to Databricks dashboard -> New -> Libary and upload egg file from dist directory:Attach library to the cluster you want to use.Finally if all you want is a record type you can use namedtuple without any additional steps:


Answer URL
https://docs.python.org/3/distutils/setupscript.html
