Natural Text
I have 2 big text files like the following small examples. There are two files (major and minor). In both major and minor files there are 4 columns. In the major file the difference between 2nd and 3rd columns is 10000 and the difference between 2nd and 3rd columns is 32 or 31 or a number close to 31 but not so high.small example of major file:small example of minor file:I want to make a new text file in which there would be 4 columns. Like the expected output:The first 4 columns are from the minor file and the last 3 columns are from the major file.The number in the 2nd and 3rd columns (from minor file) are in the range of the same row but columns 6 and 7 (from major file) and 1st column is equal to the 5th column (in fact the 1st columns of both major and minor files).I want to look for the rows in minor file in which the first column is equal to the 1st column of major file, also 2nd and 3rd columns of the same row (in minor file) must be in a range of 2nd and the 3rd columns in the major file.So in fact there are 3 conditions for every row in the minor file to be eligible to be included in the output file.The last 3 columns are from the major file which fit the rows from minor file.I am trying to do that in Python and have made the following code, but it does not return what I expected:
These are .bed files and what you’re trying to do is called an intersection.If you're on a linux or mac, or if you have access to one, you could install bedtools, which is worth it because you can do all of this in one line of code:In fact, interval intersections is exactly why bedtools was developed.There is a python distribution of bedtools called 'pybedtools', but it's also only available for mac and linux, so I don’t think there’s much advantage to doing this in Python.You could of course do everything in Python, but if you’re going to be doing any amount of bioinformatics, bedtools and GATK (genome analysis tool kit, from the Broad Institute, command-line interface only) are good reasons to do some things in shell. Also, you’ll need to sort your intervals at some point, so downstream manipulations work and don’t take forever. For that, it’s just all too quick to use the shell command ‘sort’ (sort -k1,1V -k2,2n -k3,3n [your_file] > [new_sorted_file]).But GATK and the genome-specific tools (those requiring an indexed genome sequence file) in bedtools are the big reasons to do some things in shell. Similar to the bedtools intersect command, implementing that functionality in Python would require writing and debugging many lines of code, and the code would run a lot slower than just calling the appropriate command in bedtools and GATK.
I am not sure I completely got what you were aiming for with the code, so I might have changed a few things you will have to change back, but this should help - the following piece of code outputs the desired output.You were iterating on the lines and comparing lines to each other- The split() function break the string of the line where there are white spaces, and returns the result in a list of strings. Check out the documentation for str.split, I think that would help quit a bit.
Hi elly From what I understand of your logic I think the code below should get you off to on the right direction hope this helps.


Answer URL
https://docs.python.org/3/library/stdtypes.html
