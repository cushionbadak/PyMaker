Natural Text
I am working in $AIRFLOW_HOME/dags. I have created the following files:In common.py:In foo_v1.py:When testing the script with python, it looks OK:I then launch the webserver and the scheduler locally. My problem is that I don't see any DAG with id foo_v1. There is no pyc file being created. What is being done wrong? Why isn't the code in foo_v1.py being executed?
To be found by Airflow, the DAG object returned by create_dag() must be in the global namespace of the foo_v1.py module. One way to place a DAG in the global namespace is simply to assign it to a module level variable:Another way is to update the global namespace using globals():The later may look like an overkill, but it is useful for creating multiple DAGs dynamically. For example, in a for-loop:Side Note: Any *.py file placed in $AIRFLOW_HOME/dags (even in sub-directories, such as common in your case) will be parsed by Airflow. If you do not want this you can use packaged DAGs.
You need to assign the dag to an exported variable in the module. If the dag isn't in the module __dict__ airflow's DagBag processor won't pick it up.Check out the source here: https://github.com/apache/incubator-airflow/blob/master/airflow/models.py#L428


Answer URL
https://docs.python.org/3/library/functions.html#globals
