Natural Text
I have a string that looks something like this:"(case when Campaign='Back to School' and VariableName='Total_FB_Spend' then VariableValue else 0 end) AS Back to School_Total_FB_Spend,(case when Campaign='Back to School' and VariableName='Total_FB_Imp' then VariableValue else 0 end) AS Back to School_Total_FB_Imp"I would like to use Python regex to remove spaces in the column names after 'end) AS ' character. The result should become something like this"(case when Campaign='Back to School' and VariableName='Total_FB_Spend' then VariableValue else 0 end) AS Back_to_School_Total_FB_Spend,(case when Campaign='Back to School' and VariableName='Total_FB_Imp' then VariableValue else 0 end) AS Back_to_School_Total_FB_Imp"I am able to match those parts that I am interested using regex in Python [example here] But I would like to know how to elegantly (e.g., one liner or in a Pythonic way) substitute space characters in groups that matches.
You need a re.sub with a lambda expression as the replacement argument:See the Python demoNote that I replaced your (.*?(,|$)) with a more efficient ([^,]*), any zero or more chars other than ,. Now, the whole regex matches:(end\) as ) - Group 1: end) as ([^,]*) - Group 2: any zero or more chars other than ,Then, with lambda m: "{}{}".format(m.group(1), m.group(2).replace(" ", "_")), the contents of the first  capturing group is copied back to the result unchanged, and the second group contents are modified with .replace(" ", "_"). Certainly, you may run another regex on it if there may be any whitespace, re.sub(r'\s+', '_', m.group(2)).
Another solution inspired by @Wiktor.Here we use the lookahead and lookbehind feature of regex to only match the substring we want to alter. The regex will match any sequence of word characters [a-zA-Z0-9_] and spaces preceded by end ) as, and followed by ,. The main difference is that the match will only contain a single group. 
Use the bytes.replace() function.


Answer URL
https://docs.python.org/3/library/stdtypes.html?highlight=replace#bytes.replace
