Natural Text
Reading the definition of the bin() function in Python, the officicial documentation (3.4) says, that the binary string returned by bin() is a valid Python expression.This has made me wonder: can a function return an invalid Python expression ? And what exactly is the definition of an valid/invalid Python expression ?
Functions do not return expressions. They return values. What the documentation says is that the value returned by bin is a string that represents a valid python expression. In fact the returned value represents a binary literal.You can check whether a string is a valid expression by evaluating it using eval:Warning: never call eval on contents that you don't control (e.g. user provided strings) and avoid using it in general. It's a security hazard.Note:  There's also a ast.literal_eval that is safer (i.e. when executed it will not anything bad so you can use it on user-provded text etc.) but only works for literal expressions (i.e. expressions without variables/method or function calls. Only literals and operators)A better way to check it is by parsing it using the ast.parse function:The mode='eval' specifies to parse the content as an expression.This is better because it avoids to execute the expression. If the function raises an exception is because the syntax isn't valid. If it succeeds then the text represents a valid python expression:So you could use something like the following:as in:Formally a valid expression is defined by the python grammar (see the expr non terminal). The ast.parse function uses that grammar to parse its input.Note: using ast.parse you can check whether a string is valid python statement or generic code. Just use mode='single' for a single statement and mode='exec' for generic code.
A "valid expression" is a string that can be eval()'d -- or ast.literal_eval() (for literals).0b10100 is a valid literal:OTOH, b10100 isn't:
It means the result can be evaluated either through eval or if entered directly. For example:In general a valid expression in programming languages is something that returns a result, without having syntax errors. In python eval accepts a string containing a expression according to the definition:eval(expression[, globals[, locals]])If the expression is invalid, a SyntaxError is thrown:We have to pay attention, that some expressions may have illegal values but are still considered valid, like 1 / 0:
here you see in this example:The binary is prefixed with 0b that represent a valid python Expression for Binary Number in python
For more info on what an expression is see What is an expression in Python? but it just mean's its a valid string representation of a binary number in python.


Answer URL
https://docs.python.org/3/library/functions.html#eval
https://docs.python.org/3/library/ast.html#ast.literal_eval
https://docs.python.org/3/library/ast.html#ast.parse
https://docs.python.org/3/library/ast.html#abstract-grammar
