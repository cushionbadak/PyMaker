Natural Text
Pretty basic question and concept that I don't know the answer to. I am playing with Clamd 1.0.2 and in the example it shows the following when using the CLI:I want to be able to take the object cd.scan('/tmp/EICAR') creates and use it in a conditional. Something like: if FOUND then send email to administrator and notify the user. I'm just not understanding how to access the object that is created. How do you access it? Using Python 3.6.5.
cd.scan('/tmp/EICAR') returns a dictionary. You can access values in dictionaries by their keys. In this case, the key is /tmp/EICAR. The value for that key is a tuple. To access a member of a tuple, you can do so just like you would with an array - tuplename[index].Similarly, the value 'Eicar-Test-Signature' in this case can be accessed via result['tmp/EICAR'][0]. I don't know what the side effects of the cd.scan function are, but you could bypass the variable result entirely and just use cd.scan('/tmp/EICAR')['/tmp/EICAR'][1] to access 'Eicar-Test-Signature'.Keep in mind if the cd.scan function fails or returns something other than what you expect, the key /tmp/EICAR may not be in the dictionary (I don't how the clamd library works or what it does). In that case, you can check whether a key exists in a dictionary like this:


Answer URL
https://docs.python.org/3/tutorial/datastructures.html#dictionaries
https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences
