Natural Text
I have made two functions doing the same thing but differently. I want to compare the time each function takes to run so I have added a decorator @calcul_time. The script does work but i get the following error message:I don't understand why I have this NoneType error message. If I comment my decorator, I don't have any errors. Hereunder my script. Does anyone know why I get this 'NoneType' error?
You haven't really built a decorator. A decorator has to return a the original function or a suitable replacement.Your decorator returns nothing:A decorator typically returns a wrapper function. You created the wrapper function, but not the decorator that returns it.This would be a proper decorator:I renamed your calcul_time wrapper to wrapper, removed the fonction argument (that would be passed to the decorator, you can rely on it as a closure), and returned the wrapper. Now the decorator returns a replacement.You probably want to make it a little more generic, and pass through arbitrary arguments with *args and **kwargs, and handle both the return value (pass it through to the caller of wrapper()) and exceptions correctly.You also want to use the @functools.wraps() decorator to copy things like the name and attributes from the wrapped function to the wrapper:The try..finally ensures that print() is executed regardless of what happens in fonction.


Answer URL
https://docs.python.org/3/library/functools.html#functools.wraps
