Natural Text
I am trying to perform some replacements in a file:This question recommends the following procedure:I am not allowed to comment there, but when I run this piece of code I get an error saying:This kind of error I have remedied previously by adding encoding='utf-8'.The problem is that fileinput.FileInput() does not allow for an encoding argument.Question: How to get rid of this error?The above solution, if it would work and provided that the speed is comparable to the following method, would please me most. It seems to be doing inplace replacements as it should be done.I have tried also:which is relatively fast, but very greedy when it comes to memory.For UNIX users, I need something which does the following thing:This turns out to be rather slow.
Generally, with FileInput you can specify the encoding that you want passing a fileinput.hook_encoded as openhook parameter:However, that does not work with inplace=True. In this case, you can treat the file as a binary and decode/encode the strings by yourself. For reading, this can be done just specifying mode='rb', which will give you bytes instead of str lines. For writing it's a bit more complicated, because print always uses str, or converts the given input to str, so passing bytes will not work as expected. You can, however, write binary data to sys.stdout directly, and this will work:


Answer URL
https://docs.python.org/3/library/fileinput.html#fileinput.hook_encoded
