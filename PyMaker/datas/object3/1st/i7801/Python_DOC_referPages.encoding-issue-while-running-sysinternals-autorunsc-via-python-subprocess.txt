Natural Text
I have a Python 3.6.0 script where I run autorunsc v13.71 (https://technet.microsoft.com/en-us/sysinternals/bb963902.aspx) on the system (x86 or x86_64 version, according to the system bitness using platform.machine()). If I run autorunsc directly from the terminal (CMD or Powershell) I get the output as expected, no issues (snip from the output):But, if I try to run it using my code I get this messy output:I'm using Window's default Notepad to open the output text file. People should be able to read it using Notepad, they won't be able to download a code reader like Notepad++, ST3, etc.My code (removed some parts to keep it short and direct):File structure:folder\app.py (the code shown here)tools\AMD64\autorunsc.exex86\autorunsc.exeI believe it's something to do with the output of autorunsc, I read somewhere it returns the output encoded as UTF-16. The thing is that I run many other Sysinternals EXEs and append the output to the same file (using my run_command function), and all of them work flawlessly, but this one. How can I get this right?
To open your file in Microsoft Notepad, you must use Microsoft new lines: \r\n (CR LF). The open function in Python 3 has a newline parameter for that. You can fix your code like this:
I found the solution. Indeed, the issue was the encoding for the autorunsc tool output. It's in UTF16 while the rest is UTF8, this is what I did:With this code I can have all the outputs inside my single UTF-8 file.txt.


Answer URL
https://docs.python.org/3/library/functions.html#open
