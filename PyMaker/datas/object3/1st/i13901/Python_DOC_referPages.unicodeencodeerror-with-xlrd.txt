Natural Text
I'm trying to read a .xlsx with xlrd. I have everything set up and working. It works for data with normal English letters as well as numbers. However when it gets to Swedish letters (ÄÖÅ) it gives me this error:My code:I've even tried:as well as:Edit: I'm running Python 2.7 on a Windows 7 64-bit computer.
'ascii' codec can't encodeThe problem here isn't the decode when reading the file, it is the encode necessary to print.  Your environment is using ASCII for sys.stdout, and so when you try to print any Unicode characters that can't be encoded in ASCII you'll receive that error.  Documentation reference:The character encoding is platform-dependent. Under Windows, if the stream is interactive (that is, if its isatty() method returns True), the console codepage is used, otherwise the ANSI code page. Under other platforms, the locale encoding is used (see locale.getpreferredencoding()).Under all platforms though, you can override this value by setting the PYTHONIOENCODING environment variable before starting Python.
Try to use utf-8 as @Anand S Kumar suggested and decode strings before printing.
xlrd by default uses Unicode encoding. If xlrd is not able to recognize the encoding then it will consider that the encoding used in the excel file is ASCII, character encoding. Finally if the encoding is not ASCII or if python is not able to convert the data to Unicode then it will raise a UnicodeDecodeError.Don't worry we have a solution for this kind of problems. It seems that you are using cp1252. So while you will be opening the file using open_workbook(), you can call it as follows:When you will use the above function xlrd will decode the respective encoding and you will be good to go.Source(s):Standard Encodings.xlrd default encoding.Over riding default open_workbook encoding.xlrd official documentationUnicodeDecodeErrorHope this will help you get rid of the UnicodeDecodeError.


Answer URL
https://docs.python.org/3/library/sys.html?highlight=pythonioencoding#sys.stdout
