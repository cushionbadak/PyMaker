Natural Text
Hi I have just started experimenting with python and tornado along with mongodb(I am a newbie). I have written a simple get function to get all the values from my mongodb and return it in JSON format. The problem is when I try to write the output as a JSON string I get a trailing comma(,) after the last record from the collection.And my output is likeCan anyone tell me how can I get rid of that trailing comma(,) after my last record, because of that comma I am getting an error malformed JSON stringI have tried using json dumpsgot the output as {"Reg": "11ts", "_id": {"$oid": "55a5e988545779f35d3ecdf4"}, "Name": "Alex"}{"Reg": "12ts", "_id": {"$oid": "55a5eac6545779f35d3ecdf5"}, "Name": "asdf"}When using dumps[{ "data": document }]I am getting the output asbut I want the output like thisIf I am doing something wrong please tell me I dont know how to do it.
There is no reason you should be building up JSON documents via text concatenation.Python has a perfectly good json module in the standard library which you should be using. Build up your document as a Python list of dicts, then use json.dumps() to convert the whole thing to valid JSON.
So your problem is with MongoDB ObjectId? Then maybe you should have been using bson.json_util. It's probably already installed as part of your MongoDB driver dependecies ( which all use pymongo ), but if not then install it.Or:And it works just like "dumps" except all the BSON type handling is built it.Again, no need to re-invent the wheel here and "roll your own", because people already use this.
Your implementation of the JSONEncoder works well. Just use it the way it was intended to be used:The encoder will take care of serializing dicts, objects, lists, tuples, strings (including unicode), ints, longs, floats, booleans and None. Your implementation makes it aware of ObjectIds as well. Perfect!Just lose the string concatenation and use encode.


Answer URL
https://docs.python.org/3/library/json.html
