Natural Text
I have a decorator which simply caches return values (called @cached in my example) and I wish to use it in conjunction with @property. This works just fine normally. The problem I am facing occurs when I try and use an expire attribute added by @cached.How am I able to get access to the expire function? added to the function after its replaced by @property. I understand why this doesn't work I am interested in a way of working around that problem.Some restrictions:I cannot change the @cached decorator its in a library I don't controlI would really rather not remove @property because I want to expire in my unit tests and they make my code much nicer to use.One solution that I think is rather bad is (because In reality I have a lot of properties that I want to do this for):
You can access it using the class dictionary:In general e.something_expensive is equivalent to:For more details read up: Descriptor HowTo GuideNote that inside the expiry function you're not setting cache from the outer function cached function as None, you're simply creating a new local variable. You may want to do something like this:In Python 3 it's even easier to update cache using the nonlocal keyword.


Answer URL
https://docs.python.org/3/reference/simple_stmts.html#grammar-token-nonlocal_stmt
