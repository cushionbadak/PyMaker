Natural Text
I have a package with three files:__init__.py contains:logging.py contains:util.py contains:The AssertionError is raised when importing testimport:Why on earth is that happening?Test repo is here. Travis builds are here.Update, when stepping through this with pdb, it appears that the offending instruction is from .logging import SILENT in util.py, but I have no idea why. This is an abbreviated session from the repo version:
After some more research, I understand the above to be the correct behavior. I am embarrassed to say that I did not see this before. It makes total sense once one understands what's happening. From the docs:SubmodulesWhen a submodule is loaded using any mechanism (e.g. importlib APIs, the import or import-from statements, or built-in __import__()) a binding is placed in the parent module’s namespace to the submodule object....Given Python’s familiar name binding rules this might seem surprising, but it’s actually a fundamental feature of the import system.This explanation seems to have been absent before Python 3.4, but affects all versions of Python. See Python issue #24029.In the example above, testimport.logging necessarily refers to the local module. Importing it (from anywhere) installs it in testimport (as should be expected). It should come as no surprise that this necessarily replaces any existing logging member of testimport.


Answer URL
https://docs.python.org/3/reference/import.html#submodules
