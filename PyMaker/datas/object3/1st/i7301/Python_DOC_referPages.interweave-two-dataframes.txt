Natural Text
Suppose I have two dataframes d1 and d2What is an easy and generalized way to interweave two dataframes' columns.  We can assume that the number of columns in d2 is always one less than the number of columns in d1.  And, the indices are the same.I want this:
Using pd.concat to combine the DataFrames, and toolz.interleave reorder the columns:The resulting output is as expected:
Here's one NumPy approach -Sample run -
Interweave the columns:Now, do a join and re-order with boolean indexing:You may prefer pd.concat when dealing with multiple dataframes.
we can use itertools.zip_longest:
write a function to abstract away the generic merge-reorder
My solution was to use pd.DataFrame.insert making sure to insert from the back first
The roundrobin itertools recipe has an interleaving characteristic.  This option offers the choice between directly implementing the recipe from the Python docs, or importing a third-party package such as more_itertools that implements the recipe for you:Inspired by @root's answer, the column indices are interleaved and used to slice a concatenated DataFrame.


Answer URL
https://docs.python.org/3/library/itertools.html#itertools-recipes
