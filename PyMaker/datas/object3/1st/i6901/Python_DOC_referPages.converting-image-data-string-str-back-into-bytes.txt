Natural Text
inputFile gets the image data from a image file input <input type="file"> and converts the data into a string (str) to be used in sessions. createView converts the image data string back into image data (bytes) so it can be saved.However when trying to convert the image data string back into image data bytes:It changes the original image data, img_data = request.FILES.get('image').read() witch raises an error when trying to save the image to a ImageField:so my question is how do i convert the image data string session_data = request.session.get('img_data') back into the original image data (bytes) without altering the data.And i know i could have saved the image using one view that would make it a lot simpler, but createView needs to use this image data in multiple places / forms. i tried doing it this way but i could only use the image data in one form.Image data before encode / decode:image data after converting to base64
The problem is that calling str on a bytes instance, which you do when you write to the session, doesn't result in a string that can be converted back to the original bytes1, it produces string version of the bytes instance's repr:To convert the image data to a json-serializable string, base64-encode img_data to get a bytestring of ascii characters then decode the bytestring to str and write that to the session; decode from base64 to get the original bytes. 1In fact the conversion can be reversed by calling eval on the string, but this is a security risk and should never be done.  Using ast.literal_eval would be safe, but decoding from base64 is much faster.


Answer URL
https://docs.python.org/3/library/functions.html#eval
https://docs.python.org/3/library/ast.html#ast.literal_eval
