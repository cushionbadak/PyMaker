Natural Text
I want to create a set of namedtuple in python, with the ability to add elements dynamically using the union operation.The following code snippet creates a set of namedtuple, which is behaving nicely.which prints Now if I create another namedtuple and add it to my set with the union operations it is not behaving as expected.The code snippet prints the following output.The expected output should be:Am I mis-understanding the API?Both python2 and 3 are showing the same behaviour.  
union expects a set (or a list or another iterable), but you pass a named tuple, which is an iterable by itself, but it provides values, so you merge the set with the values. Try this:
A namedtuple instance is an iterable of items. set.union simply merges the current set with the items in the namedtuple. However, what you want is put the namedtuple in another container/iterable, so the merge is done with the item (the namedtuple) contained in the new parent iterable:It becomes more obvious if you actually think of the operator equivalent:As compared to what we actually want:The union is performed with the outer iterable.
Since b3 is iterable, union works on its elements rather than on the tuple itself. Replace that with:
The documentation on set.union actually explains this:union(*others)Return a new set with elements from the set and all others.So it will create a new set including all elements from the others:In your case (because you assign it back to s) you can simply add the item thus avoiding creating a new set entirely:


Answer URL
https://docs.python.org/3/library/stdtypes.html#frozenset.union
