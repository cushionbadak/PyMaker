Natural Text
I am trying to implement a timeout exception handler if a function call is taking too long.EDIT: In fact, I am writing a Python script using subprocess, which calls an old C++ program with arguments. I know that the program hangs from time to time, not returning anything. That's why I am trying to put a time limit and to move on to next call with different argument and etc.I've been searching and trying to implement it, but it doesn't quite work, so I wish to get some help. What I have so far is:EDIT: The Error message I receive currently is "TypeError: init() takes exactly 3 arguments (2 given)Also, I would like ask a basic question regarding the except block. what's the role difference between the code right below "except TimeOutException" and the code in the "Exception handler"? It seems both can do the same thing?Any help would be appreciated.
if a function call is taking too longI realize that this might not be obvious for inexperienced developers, but the methods applicable for approaching this problem entirely depend on what you are doing in this "busy function", such as:Is this a heavy computation? If yes, which Python interpreter are you using? CPython or PyPy? If CPython: does this computation only use Python bytecode or does it involve function calls outsourced to compiled machine code (which may hold Python's Global Interpreter Lock for quite an uncontrollable amount of time)?Is this a lot of I/O work? If yes, can you abort this I/O work in an arbitrary state? Or do you need to properly clean up? Are you using a certain framework such as gevent or Twisted?Edit:So, it looks you are just spawning a subprocess and wait for it to terminate. Great, that is actually one of the most simple problems to implement a timeout control for. Python (3) ships a corresponding feature! :-) Have a look at https://docs.python.org/3/library/subprocess.html#subprocess.callThe timeout argument is passed to Popen.wait(). If the timeout  expires, the child process will be killed and then waited for again.  The TimeoutExpired exception will be re-raised after the child process  has terminated.Edit2:Example code for you, save this to a file and execute it with Python 3.3, at least:In the first case, the subprocess immediately returns. No timeout exception will be raised. In the second case, the timeout expires, and your controlling process (the process running above's script) will attempt to terminate the subprocess. This succeeds. After that, the subprocess.TimeoutExpired is raised and the exception handler deals with it. For me the output of the script above is ['python'] was terminated as of timeout. Its output was:None:


Answer URL
https://docs.python.org/3/library/subprocess.html#subprocess.call
