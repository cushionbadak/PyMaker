Natural Text
I'm writing a unit test for a function that will confirm that a function called within it is called with the correct arguments. The problem is that one of the arguments is a generator.Is there a way to compare the contents of the generator that fn is called with using assert_has_calls? An example of the behavior that I'm looking for is exhibited in 'AssertSequenceEqual.' As it is, test_use_fn fails because the generator objects that it is comparing are different.
You can use call_args_list https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.call_args_listI assume that you would check if every items of the generators are the same. I write a assertEqualGenerators() method of the test case class that do the work (if the arguments are not generators use standard assertEqual()). The module file name is mock_generators.py and you must use mock_generators.fn to patch fn. The last trick is the call object arguments: take a look to https://docs.python.org/3/library/unittest.mock.html#unittest.mock.call.call_list for the dettails of how fetch the data (in your case the first element is what you need).


Answer URL
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.call_args_list
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.call.call_list
