Natural Text
I want to read two non-consecutive lines once in a very big file in python, that is, the expected result is the following(the number is the line number):1      6 (the first time reads the 1st and 6th line)2      7 (the second time reads the 2nd and 7th line)3      8 (the third time reads the 3rd and 8th line)4      95     106      117      128      139      1410      15.......... (the last time reads the 6th from the last line and the last line)The line number can be gotten by using the method enumerate(file object). I am a beginner for python, and just know how to read two consecutive lines once. Could you please share with me how to get the above expected result? Thanks for your time!
If you want single iteration over the file (read the file once), then you could write a variation on the itertools pairwise recipe, advancing the second iterator by 5 instead of 1 (using consume). This is essentially the same as @Blender's answer that uses a deque, but a functional way about tackling the problem that may be easier to reason about (and prove that the implementation is correct without edge cases).From python3 itertools recipe book:Example solution:Both the collections.deque solution and this pairwise solution require storing n+1 items in memory at a time, plus the overhead for the containers. Opening the file twice with two file pointers reduces the memory to just 2 items, but may be significantly slower due to twice the number of disk I/O accesses (assuming the OS doesn't cache reads from the file). Reading from the file twice is a little riskier because the file could be modified while reading, producing inconsistent data. To be fair, modifying a file while iterating over it once or twice will produce questionable results.It goes without saying that if you're (still) using Python 2.7, replace zip with itertools.izip, unless you want to store the entire file contents in RAM and potentially crash your program or system for large input files.
You can open the file multiple times. Just skip the first couple of lines in the second file handle and use zip to read them both at the same time:You'll have to from itertools import izip as zip in Python 2 to get zip to not read the whole file twice into memory.An alternative solution would be to use a double-ended queue and keep 5 + 1 lines in memory while reading from the file:This reads the file only once, but if your file is really long and your two lines are separated by more than 5, you'll have to keep that many strings in memory.


Answer URL
https://docs.python.org/3/library/itertools.html#itertools-recipes
