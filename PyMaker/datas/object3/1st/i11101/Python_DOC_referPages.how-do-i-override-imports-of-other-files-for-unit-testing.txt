Natural Text
I am currently attempting to write unit tests for my Main.py's main() functionHere is a simplified version of my Main.py:In my Unit Tests\MainUnitTests.py I want to import ..\Main.py and fake the Configuration class in such a way that I can hit Test path1 and Test path2I found that i can assert sys.exit() with the following:but I am having trouble overriding the from Configuration import ConfigurationThoughts?So far I have tried the following within Unit Tests\MainUnitTests.py:Another example for demonstration:foo.py:bar.py:
when you use the importit import the name directly into the module, so monkeypatching bar won't help, you need to override a directly in the main file:Do know that unittest has helper functions for this in the mock subpackage, I believe you could do something like:This would work in your first example with configuration since the class that needs to be patched is not used in the global scope although foo uses bar.a as soon as it is loaded so you would need to patch it before even loading foo:However in this case foo.a would not be reverted at the end of the with block because it can't be caught by unittest... I really hope your actual use case doesn't use the stuff to be patched at module level.


Answer URL
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.patch
