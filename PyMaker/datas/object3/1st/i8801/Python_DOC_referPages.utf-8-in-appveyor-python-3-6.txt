Natural Text
1. SummaryI don't find, how I can use non-ascii symbols for AppVeyor builds.2. SettingsMy simple SashaAppVeyorEncoding.py file:My simple appveyor.yml file:Both files I save in UTF-8 encoding.3. Expected behaviorIf I run SashaAppVeyorEncoding.py file in my terminal or interpreter SublimeREPL, I get:If my SashaAppVeyorEncoding.py file is not contain Cyrillic symbols:AppVeyor build successful passed:4. Actual behaviorMy AppVeyor build failed:5. Not helpedI add # -*- coding: utf-8 -*- in top of SashaAppVeyorEncoding.py file,I add chcp 65001 command to appveyor.yml file,I install win-unicode-console to appveyor.yml file,My updated SashaAppVeyorEncoding.py file:My updated appveyor.yml file:My updated AppVeyor build:6. Local environmentOperating system and version:Windows 10 Enterprise LTSB 64-bit ENPython:3.6.3chcp:Active code page: 65001
It looks like python doesn't print to the console on AppVeyor -- the output is redirected. Therefore locale.getpreferredencoding() is used to encode Unicode text to bytes while printing to stdout. cp1252 supports only a few from a million of Unicode characters. To change sys.stdout.encoding here, you could set PYTHONIOENCODING=utf-8 envvar -- utf-8 character encoding supports all Unicode characters.


Answer URL
https://docs.python.org/3/library/locale.html#locale.getpreferredencoding
https://docs.python.org/3/using/cmdline.html#envvar-PYTHONIOENCODING
