Natural Text
If I've got a Python Decimal, how can I reliably get the precise decimal string (ie, not scientific notation) representation of the number without trailing zeros?For example, if I have:I would like:However:The Decimal class doesn't have any to_decimal_string method, or even any to_radix_string(radix) (cf: https://docs.python.org/3/library/decimal.html#decimal.Context.to_eng_string)The %f formatter either defaults to rounding to 6 decimal places - '%f' %(d, ) ==> '0.000000' - or requires a precise number of decimal places.The {:f}.format(...) formatter appears to work - '{:f}'.format(d)==> '0.00000000000001' - however I'm reluctant to trust that, as this actually runs counter to the documentation, which says "'f' â€¦ Displays the number as a fixed-point number. The default precision is 6"Decimal.__repr__ and Decimal.__str__ sometimes return scientific notation: repr(d) ==> "Decimal('1E-14')"So, is there any way to get a decimal string from a Python Decimal? Or do I need to roll my own using Decimal.as_tuple()?
Short answer:Long answer:As @BrandonRhodes pointed out PEP 3101 (which is the string format PEP) states:The syntax for format specifiers is open-ended, since a class can  override the standard format specifiers. In such cases, the  str.format() method merely passes all of the characters between the  first colon and the matching brace to the relevant underlying  formatting method.And thus, the Decimal.__format__ method is what python's string format will utilize to generate the str representation of the Decimal value.  Basically Decimal overrides the formatting to be "smart" but will default to whatever values the format string sets (ie {:.4f} will truncate the decimal to 4 places).Here's why you can trust it (snippet from decimal.py:Decimal.__format__):Long story short, the Decimal.__format__ method will calculate the necessary padding to represent the number before and after the decimal based upon exponentiation provided from Decimal._exp (in your example, 14 significant digits).


Answer URL
https://docs.python.org/3/library/decimal.html#decimal.Context.to_eng_string
https://docs.python.org/3/library/string.html#index-9
