Natural Text
I have the header name of a column from a series of massive csv files with 50+ fields. Across the files, the index of the column I need is not always the same. I have written code that finds the index number of the column in each file. Now I'd like to add only this column as the key in a dictionary where the value counts the number of unique strings in this column.Because these csv files are massive and I'm trying to use best-practices for efficient data engineering, I'm looking for a solution that uses minimal memory. Every solution I find for writing a csv to a dictionary involves writing all of the data in the csv to the dictionary and I don't think this is necessary. It seems that the best solution involves only reading in the data from this one column and adding this column to the dictionary key.So, let's take this as sample data:The result I want:Now let's say that I want the data from only the FOODS column and in this case, I have set the index value as the variable food_index.Here's what I have tried, the problem being that the columns are not always in the same index location across the different files, so this solution won't work:This solution works for only this sample -- but only if I know the location of the columns ahead of time -- and again, a reminder that I have upwards of 50 columns and the index position of the column I need is different across files.Is it possible to do this? Again, built-ins only -- no Pandas or Numpy or other such packages.
The important part here is that you do not skip the header line!  You need to split that line and find the indices of the columns you need!  Since you know the column headers for the information you need, put those into a reference list:You now have the data in the same order as your existing headers; you can match it up or rearrange as needed.Does that solve your blocking point?  I've left plenty of implementation for you ...
Use Counter and csv:


Answer URL
https://docs.python.org/3/library/collections.html#collections.Counter
https://docs.python.org/3/library/csv.html
