Natural Text
Having a large DataFrame as follows:The user_mentions columns is a list of userids that have been mentioned by each user. For example, the first line means:user 1 has mentioned users 2, 3, and 4.I need to create a mention network among the users in the userid column. That is, I want the number of times each user in the userid column has been mentioned by other users in the userid column. So basically, first I need something like this:But this doesn't work on a column of lists.If I resolve the above issue, then I can groupby['userid','user_mentions'].EDIT The final output should be:
This isn't a task well suited to Pandas / NumPy. So I suggest you use collections.defaultdict to create a dictionary of counts, then construct a dataframe from the dictionary:Of course, you shouldn't put lists in Pandas series in the first place. It's a nested layer of pointers, which should be avoided if at all possible.
Following your edit, I would have to agree with @jpp.To your (unedited) original question, in terms of gathering the number of mentions of each user, you can do:Yields:
Here's one way.


Answer URL
https://docs.python.org/3/library/collections.html#collections.defaultdict
