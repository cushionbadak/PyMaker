Natural Text
I am trying to concatenate the hidden units. For example, I have 3 units, h1,h2,h3 then I want the new layer to have [h1;h1],[h1;h2],[h1;h3],[h2;h1]....So, I have tried:I am not sure what should I return for the second argument of my output shape.
You could implement the concatenation operation that you described by leveraging itertools.product in order to compute the cartesian product of the temporal dimension's indices. The call method could be coded as follows:In the example that you provided, nb_timesteps would be 3. Note also that the shape of the weights should be (2*input_shape[-1], input_shape[-1]) for the dot product to be valid. Disclaimer: I am not sure what you want to achieve.


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.product
