Natural Text
I'm running the same code; the following works in Windows, but will run correctly on Ubuntu (16.04).I've tried to reinstalled all modules (including the same version of Python and websocket between both Windows and Ubuntu), the print of this code is correct on the Windows system:But when it run in Ubuntu, while it does print, it misses some print statements:When I debug the code in Ubuntu, I found that the main thread stops in the self.ws.run_forever() call and never jumps to the on_open function. Then it breaks out.
You are using two different versions of the library, with the version on Windows being older than version 0.53. As of version 0.53, the websocket project differentiates callback behaviour between bound methods and regular functions.You are passing in bound methods (self.on_open and self.on_ws_message), at which point the ws argument is not passed in. Those methods are apparently expected to have access to the websocket already via their instance, probably because the expected use-case is to create a subclass from the socket class.This is unfortunately not documented by the project, and the change appears to have been causing problems for more people.So for version 0.53 and newer, drop the ws argument from your callbacks:And you can discover issues like these by enabling logging; the websocket module logs exceptions it encounters in callbacks to the logger.getLogger('websocket') logger. A quick way to see these issues is to enable tracing:which adds a logging handler just to that logging object, turns on logging.DEBUG level reporting for that object and in addition enables full socket data echoing.Or you can configure logging to output messages in general with the logging.basicConfig() function:which lets you see logging.ERROR level messages and up.With using the latter option, the uncorrected version of the code prints out:You can verify the version of websocket-client you have installed by printing websocket.__version__:


Answer URL
https://docs.python.org/3/library/logging.html#logging.basicConfig
