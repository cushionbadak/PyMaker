Natural Text
Python version: 3.7OS: Server 2008 r2 - functioning as AD serverI am running a python script to do a dsquery lookup via cmd using the following code:Then to get my results I run:orI've tried both. Generally speaking this works beautifully and I have no issue. I usually get a result looking likeBut in the few cases in my network where users have unusual characters in their name like é or ë, I'm running into errors. Assuming the name Joé SoapWhen decoding with UTF-8 I getAnd with ISO-8859-1 I getFinally if I run the cmd command directly I get the correct response:What am I missing here? is there a particular encoding I should use other than the two mentioned above, (I've tried out several others without success) or am I missing something in the process here?
this is more of a workaround i think but why not use Popen instead of run?it's a little more long winded but in the end it may be easier to use
Thanks to the comments by @lit and @vencaslac I've figured out the answer:CP437 is the encoding used by cmd and when applied to my script it successfully returns the é or whichever


Answer URL
