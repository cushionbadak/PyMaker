Natural Text
I have the following project structure:Inside messaging.py module there's a function send_schedule with the following lines:I'm trying to patch the models.Talk.query.all() call. Inside messaging_test.py there's the following test:When I run the test with python3 -m pytest tests/messenger/messaging_test.py command, ValueError outputs an empty list, which signifies that the call wasn't patched. Can you suggest a fix to that?What did I do to solve the issue:Read "Where to patch" paragraph of documentation. This led me to suspicion that pytest runs my tests in a weird way.Tried to use pytest-mock but failed to figure out how to use it with unittest.TestCase.
Okay, I clearly have done a bad research on this. There was no problem with pytest module. In order to fix the issue, I needed to patch app.models.Talk, not the strange app.models.Talk.query.all. After I patched the class, I simply added the properties I needed:


Answer URL
https://docs.python.org/3/library/unittest.mock.html#where-to-patch
