Natural Text
I have following code in Pyhton:I was using Vim to edit the code and using Vim to open "myFile.csv";It can success display unicode text from terminal;but not able to display unicode text from Excel, nor from browser;My platform is osxI don't know if is my configuration problem or actually I code it wrong way, if you any idea, please advise. Deeply appreciate!change open to codecs.open.Thanks for point out f.close(), deleted.
It seems you're trying to open the file in text mode (because you specify an encoding), but then you try to write binary data (because you encode the text before writing it to the file). You need to either open the file as binary and write encoded text, or open it as text and write text.Furthermore, your attempt to open it as text isn't even working because  you're passing utf-8 as the buffering parameter instead of the encoding parameter. See the open() documentation`.But even if you did all that correctly, this still wouldn't really help you with an Excel file, because those have a complicated binary structure. I recommend you use something like the xlrd to read xls files and Xlswriter to write them.Here is a simple example that should work for .csv:or alternatively
codecs.open opens a wrapped reader/writer which will do encoding/decoding for you. So you do not need to encode your string for writing. You need to pass the 'ignore' parameter in your open call.Note that you do not need to call close as you use a with statement.Original answer, scratch that:Third parameter of open is buffering requiring an integer.You should write pass the encoding like this:Note that you open the file in text mode. No need to encode the string for writing.Also your file mode 'w+' is a bit odd. I'm not sure, but I think it will truncate your file. If you want to append to the file you should use 'a' as mode.
Excel (at least on Windows) likes a Unicode BOM at the start of a .csv file even with UTF-8.  There is a codec for that, utf-8-sig.Also, Python 3's normal open is all that is required and no need for f.close() in a with:


Answer URL
https://docs.python.org/3/library/functions.html#open
https://docs.python.org/3/library/csv.html#module-csv
https://docs.python.org/3/library/codecs.html#codecs.open
