Natural Text
I don't know why I'm just not getting this, but I want to use mock in Python to test that my functions are calling functions in ftplib.FTP correctly. I've simplified everything down and still am not wrapping my head around how it works. Here is a simple example:When I run this, I get:I know it must be using the mock object since that is a fake server name, and when run without patching, it throws a "socket.gaierror" exception.How do I get the actual object the fuction is running? The long term goal is not having the "download_file" function in the same file, but calling it from a separate module file.
When you do patch(ftplib.FTP) you are patching FTP constructor. dowload_file() use it to build ftp object so your ftp object on which you call login() and cmd() will be mock_ftp.return_value instead of mock_ftp.Your test code should be follow:I added all checks and autospec=True just because is a good practice 
I suggest using pytest and pytest-mock. 


Answer URL
https://docs.python.org/3/library/unittest.mock.html#autospeccing
