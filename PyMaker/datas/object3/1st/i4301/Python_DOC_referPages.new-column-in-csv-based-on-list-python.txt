Natural Text
I have a csv file (VV_AL_3T3_P3.csv) and each of the rows of each csv file correspond to tiff images of plankton. It looks like this:The images were located all together in a folder and then classified by shape in folders. The name of the tiff images is formed by the Image_file + Particle ID; for example for the first row: VV_AL_3T3_P3_R3_000001_1.tiffNow, I want to add a new column called 'Class' into the csv file that I already have (VV_AL_3T3_P3.csv) with the name of the folder where each .tiff file is located (the class) using python; like this:So far, I have a list with the names of the folders where every tiff file is located. This is the list that will be the new column. However, how can I do to fit every folder with its row? In other words, matching the 'Class' with 'Particle ID' and 'Image file'.For now:I have seen a similar case here: Create new column in dataframe with match values from other dataframebut I don't really know how to use the 'map.set_index' and also, he has two data frames whereas I just have one.
For the first part of your question, use os.path.splitIf your path was... /home/usuario/Desktop/Classification/Fraction_9to20um/Classes/testwould return test.then in your for loop, append that to each rowref: https://docs.python.org/3/library/os.path.html
You can use os.path.split(path) to break a path into two parts: the beginning and the last piece, whether it's a file or a directory. For example: If you have the full filepath and want the last directory name, run this command twice:
It sounds like my_files is a list of (paths+tiff_file_name). What you want is the last segment of the parent directory's absolute path, it seems.So, /some/path/to/directory/classA/instance.tiff would be given to classA.There are two approaches, with two slightly different interpretations1) The second last part of the path is the class.rows = [file.split(os.path.sep)[-2] for file in my_files]2) The containing directory of the file, relative to the Classes directory, is the class.rows = [  os.path.relpath(    os.path.dirname(file),     '/home/usuario/Desktop/Classification/Fraction_9to20um/Classes/'  )  for file in my_files]EDIT (for clarification/sample): In order to write out classes with their files,It's not clear from your question if you want your output_path to be class.csv or VV_AL_3T3_P3.csv, but hopefully you see that it's easily interchangeable.Note that the above pattern tends to be easy enough to implement/debug if there is a one-to-one correspondence between inputs and outputs (input -> simple transform -> output). But once you begin aggregating data (say, the average number of files per class), you might want to begin exploring a data manipulation library like pandas.


Answer URL
https://docs.python.org/3/library/os.path.html
https://docs.python.org/3/library/os.path.html#os.path.split
