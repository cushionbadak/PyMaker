Natural Text
I have multiple data frames that I saved in a concatenated list like below. Each df represents a matrix.How do I sum all these dfs (matrices) into one df (matrix)? I found a discussion here, but it only answers how to add two data frames, by using code like below.Should I use the code above in a loop, or is there a more concise way?I tried to do print(my_df.sum()) but got a very confusing result (it's suddenly turned into a one row instead of two-dimensional matrix).Thank you.
One method is to use sum with a list of arrays. The output here will be an array rather than a dataframe.This assumes you need to replace np.nan with 0:Alternatively, you can use numpy directly in a couple of different ways:numpy.nansum assumes np.nan equals zero for summing purposes.
I believe need functools.reduce if each DataFrame in list have same index and columns values:
I believe the idiomatic solution to this is to preserve the information about different DataFrames with the help of the keys parameter and then use sum on the innermost level:which yieldswith jezrael's sample DataFrames.


Answer URL
https://docs.python.org/3/library/functools.html#functools.reduce
