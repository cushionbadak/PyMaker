Natural Text
I packed a struct using this lineAnd now im using a checksum calculation function which unpacks the packet in a way that the 16 bits of where the checksum should be (packet_checksum) is removed. But i don't know how it does that, and what does the sum function actually do? add up the different elements?:the code works well i'm just wondering how it works.
You seem to be trying to create an ICMP packet and to then calculate the checksum for it. For this you should carry out your initial pack with 0 for the checksum rather than trying to remove it. You could then extract each WORD as follows:This assumes your packet is an even number of bytes, so if the length is odd, you could possibly temporarily append an extra 0 for the calculation.Note, the ICMP checksum is not a simple case of adding these together, it requires a one-compliment sum. See the following answer for further information.


Answer URL
https://docs.python.org/3/library/struct.html?module-struct#struct.unpack
https://docs.python.org/3/library/functions.html?sum#sum
