Natural Text
I have a DataFrame with a number of columns, and a Series. Both have the same DateTimeIndex.DataFrame:Series:If I attempt to subtract the series from the dataframe, I get the following result:I also get the following warning:I know that I can achieve element-wise subtraction using DataFrame.subWhat I don't know, however, is:What operation is performed using Dataframe.__sub__?Additionally, it seems very counter-intuitive to me that subtracting a Series from a DataFrame with matching Index types / contents, doesn't do an element-wise subtraction. What is the rationale behind not doing this?
Reading the docs you so nicely linked to we find this:axis : {0, 1, ‘index’, ‘columns’}For Series input, axis to match Series index onAnd the default value is 'columns'. This gives us a hint of what happens when you do a substraction, i.e.:orNone of which will work as you want. Now let us look back on the yellow box. The other alternative is 'index' and we would match the index (which sounds exactly like what you expect), i.e.:or Why? This is a design question. The designers might aswell have set 'index' as default but for reasons unknown (and probably because it is more frequently used and that the underlying package behind pandas, numpy, does operation that way) they chose columns. The numpy behaviour is easily tested by doing this: df.values - s.values which indeed operates on columns where as you are interested in rows (index).Short why: numpy works like this.The most elegant solution for this is to use .sub() and specifying axis='index'. (or 0, but index might be more readable in this case)


Answer URL
https://docs.python.org/3/library/traceback.html
