Natural Text
Why does the content of mock.mock_calls differ depending on whether I run in shell or in a program? The assertion of mock.mock_calls == expected fails in a program but passes in the shell.The code is based on the documentation for tracking multiple calls. (26.5.1.5. Tracking all Calls)So far that is all exactly as expected. But look at what happens to mock.mock_calls in a program: It records additional calls to the __str__ method of every method called. mock.method_calls is unaffected.Output:I am running Python 3.4 on a Windows 7 computer.
This is because you are printing the method calls. It causes the __str__() magic method to be called:Eliminate the print() call and you'll see the desired behavior:FYI, example from the console:Or, alternatively, use a normal Mock class:


Answer URL
https://docs.python.org/3/library/unittest.mock-examples.html#tracking-all-calls
https://docs.python.org/3/library/unittest.mock.html#the-mock-class
