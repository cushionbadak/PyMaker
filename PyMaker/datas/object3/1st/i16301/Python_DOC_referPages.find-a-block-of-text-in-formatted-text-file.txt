Natural Text
I often parse formatted text files using Python (for biology research, but I'll try and ask my question in a way you won't need biology background.)  I deal with a type of file -called a pdb file- that contains 3D structure of a protein in a formatted text. This is an example:ATOM marks beginning of a line that contains atomic coordinates. TER marks end of coordinates. I want to take the whole block of text that contains atomic coordinates so I use:But it matches nothing. There must be a way of taking a whole block of text by using regex. I also don't understand why this regex pattern doesn't work. Help is appreciated.
This should match (but I haven't actually tested it):If you read the documentation on DOTALL, you will understand why it wasn't working.A still better way of writing the above iswhere it is required that ATOM and TER come after newlines, and where raw string notation is being used, which is customary for regular expressions (though it won't make any difference in this case).You could also avoid regular expressions altogether:(This will actually not include the TER in the result, which may be better).
You need (?s) modifier:This will match everything - newline included - with .*.Note that if you only need anything in between (ATOM inclusive, TER exclusive), just change to a positive lookahead for TER:
This should do it.
I wouldn't use a regex, instead itertool's dropwhile and takewhile which is more efficient than loading the entire file into memory to perform a regex operation. (eg, we just ignore the start of the file until ATOM, then we don't need to read from the file further after encountering TER).So this ignores lines while they don't start with ATOM, then keeps taking lines from that point while they still start with ATOM. You could change that condition to be lambda L: not L.startswith('TER') if you want.Instead of printing, you could use:to get one large text block.
How about a non-regular-expression alternative. It can be achieved with a relatively simple loop, and a little bit of state. Example:


Answer URL
https://docs.python.org/3/library/re.html#re.S
https://docs.python.org/3/library/re.html#raw-string-notation
