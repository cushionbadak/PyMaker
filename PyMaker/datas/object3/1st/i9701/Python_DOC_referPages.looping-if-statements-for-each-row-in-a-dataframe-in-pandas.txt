Natural Text
Hi I am new to using pandas coming from a SAS background and I am trying to segment a continuous variable into bands using the following code. I am expecting the code to check if the value of df['BILL_AMT1'] is within the current loops boundings and set a df['bill_class'] accordingly.I get the following error:I think that the if condition is evaluating correctly but the error is due to assigning a new column a value of the for loops counter. Can anyone explain what is going wrong or suggest an alternative.
To avoid the ValueError, changetoThe chained comparison (lower_bound <= df['BILL_AMT1'] < upper_bound) is equivalent to The and operator causes the two boolean Series (lower_bound <= df['BILL_AMT1']),  (df['BILL_AMT1'] < upper_bound) to be evaluated in a boolean context -- i.e. reduced to a single boolean value. Pandas refuses to reduce Series to a single boolean value.Instead, to return a boolean Series, use the & operator instead of and:and then to assign values to the bill_class column where mask is True, use df.loc:To bin the data in df['BILL_AMT1'], you could remove the Python for-loop entirely, and as DSM suggests, use pd.cut:
IIUC, this should be the fix to your code:howeverI'd do this


Answer URL
https://docs.python.org/3/reference/expressions.html#comparisons
