Natural Text
This question already has an answer here:Python rounding error with float numbers [duplicate]                    2 answers                Python math is wrong [duplicate]                    2 answers                I have try this simple math operation in pythonThe third one should return 8 but it is return 7?!UPDATEi have try it in PHP, ruby and JAVA and i have got the same results.Update 2i don't know why the question get many votes down !!
The languages you cite use either IEEE-754 64-bit binary floating-point or use the floating-point of the underlying hardware, which is likely IEEE-754 binary floating-point.In IEEE-754 64-bit binary floating-point, the nearest representable value to 8.2 is 8.199999999999999289457264239899814128875732421875, and the nearest representable value to .2 is 0.200000000000000011102230246251565404236316680908203125.So, when you write 8.2 - 0.2, what actually happens is that 0.200000000000000011102230246251565404236316680908203125 is subtracted from 8.199999999999999289457264239899814128875732421875. The result is a value slightly under 8, and the floor of a value slightly under 8 is 7.The lesson here is that floating-point arithmetic is generally approximate, so you must be careful when evaluating functions with discontinuities (like floor) or steep slopes. You must either design your code to accept results that may cross the discontinuities or you must design your calculations to avoid errors that cross the discontinuities.
Your first two examples are to be expected:8.2 - 0.21 is 7.99. Floor of 7.99 is 7, and that's what is returned. Remember that floor(x) is the greatest integer less than or equal to x. 8 is greater than 7.99, so it can't possibly be returned. 7, on the other hand, meets this requirement.8.21 - 0.2 is 8.01. Floor of 8.01 is 8 -- no magic here.Now this is more interesting. It has to do with the fact that 8.2 and 0.2 cannot be exactly represented with floats, so the result of the computation is perhaps not what you might have thought:Again, floor() is working as documented.You can see this for yourself using decimal:Relevant: What Every Computer Scientist Should Know About Floating-Point Arithmetic
Why should it be 8? Floor functions return the nearest integer rounded down, so those two examples are correct.8.2 - 0.21 = 7.99, which rounded down is 7.8.21 - 0.2 = 8.01, which rounded down is 8.
Due to floating point inaccuracies


Answer URL
