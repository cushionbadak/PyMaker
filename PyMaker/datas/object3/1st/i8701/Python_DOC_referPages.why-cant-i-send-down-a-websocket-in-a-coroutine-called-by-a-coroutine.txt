Natural Text
Why does:send a message down the websocket and:doesn't?I've cut down the code from my code to simplify it - can post the original if necessary. The second version seems to hang at the await ws.send('test') part from turning on logging, debugging etc.I wondered if it was an issue with passing the websocket connection as an argument. If you log what is passed and what is received there, they both return <websockets.client.WebSocketClientProtocol object at 0x04B51A90> with the same address both times.What I ultimately want to do, and suggestions for how to do this are welcome even if the question can't be answered is:Have two coroutines running, pretty much forever that:* take messages from a queue put there by regular functions from the tkinter GUI and send them down the websocket* take messages from the websocket and alter things in the GUII thought the websockets library as asyncio would be the way to do this, but am open to any suggestions.EDIT: forgot to add the error message!
It is fine to pass the websocket as an argument. The problem here is that the websocket connection is already closed when the send coroutine is awaited (as explained in your error message). That happens because the connection context finishes before the send_messages task can send the message. Instead, consider this working example:


Answer URL
https://docs.python.org/3/library/asyncio-task.html#asyncio.wait
