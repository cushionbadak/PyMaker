Natural Text
How can I merge the following two arrays, by looking up a value from array A in array B?Array A: and Array B:The goal here is to create Array C, by looking up the IPv4Address from Array B in Array A and comparing them, and getting the corresponding array's second value and storing it:Array C: The ip addresses are of this type: https://docs.python.org/3/library/ipaddress.html#ipaddress.ip_networkHow can I achieve this?edit:Please note that the merging is conditioned on the IPs matching, so the resulting array C will have the same number of arrays as the Array B, but it will have one more value. The suggested duplicate links are not answering the same question.
This should do what you asked for (at least the output is exactly what you wanted), I made some minor assumptions to deal with your #dummydata, but that should not matter too much.Code:Output:Note:This solution has O(m * n) complexity, which isn't necessary, there are many out-of-the box (Pandas) and custom (e.g. using dict) ways to merge with lower complexity.
There appears no reason you can't use Pandas. If your IP addresses align perfectly, you can merge and then use pd.DataFrame.values to return a NumPy array:If you wish to ignore the network component and include only the network_address when merging, i.e. use '1.2.3.5' instead of '1.2.3.5/24', then you can create helper series before merging:
There are issues with your data and complications that prevent you from using join_by or rec_join as the question you linked suggested.The main issue with your data, as pointed out by others, is that networks like IPv4Network('1.2.3.4/24') are not valid networks, since they have host bits set that are masked out by the /24. The /24 means that the final 32 - 24 = 8 bits are your hosts bits and the constructor for IPv4Network requires that these are set to 0, for example IPv4Network('1.2.3.0/24') is valid.The main complication is that you have networks in one array, but addresses in the other. Methods like rec_join and join_by use comparison (i.e. ==) to decide what records go together. Some of the other proposed answers 'solve' this by replacing your networks with addresses, but that doesn't appear to be your problem.Also, note that a single network address may fall into multiple different networks. For example, IPv4Address('1.2.3.129') falls within both IPv4Network('1.2.3.0/24') and IPv4Network('1.2.3.128/25'). So, I assume you'd expect both matches to show up in your results.To join addresses from one array to networks that the address actually falls within, you'll have to iterate over the array yourself and construct a new one. The type of comparison that works is IPv4Address('1.2.3.129') in IPv4Network('1.2.3.0/24') (this is True).A working code example bringing this together:


Answer URL
https://docs.python.org/3/library/ipaddress.html#ipaddress.ip_network
https://docs.python.org/3/library/ipaddress.html#ipaddress.IPv4Network.network_address
