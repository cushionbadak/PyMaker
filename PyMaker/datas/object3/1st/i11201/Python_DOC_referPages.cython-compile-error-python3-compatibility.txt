Natural Text
I am running Python 3.4.4 :: Anaconda 4.0.0 (x86_64) on OS X Yosemite. My Cython's version is 0.23.4. I'm trying to embed some very trivial Cython code test.pyx into C code testcc.c. The problem is, if I use python2.7-config then everything works well (Python 2.7 is the built-in version on OS X). However if I use python3.4-config the following errors raised:I have to use Python3 since all my other codes are written in it. Please help me solve this problem. The following are my source files:test.pyx:testcc.c:And Compiling those two files using following setup.py:The following is the command I compile those c files:Update:I changed the inittest() to PyInit_test() as Jim suggested. The code compiles successfully. However when I run ./cysvm.out the following errors occured:UpdateI solved this by adding the following line before Py_Initialize(); in my c code:
This is probably due to the fact that in Python 3.x initialization of modules is not performed by calling init<module_name> but rather with PyInit_<module_name> (See PEP 3121). So, if you are linking with Python 3.x and executing via 3.x you need to change the initialization call. In short, changing the call that initializes the module from:To:and recompiling, should do the trick. As for your second problem, an alternate solution other than using Py_SetPythonHome is setting PYTHONHOME to the output of python3.4-config --exec-prefix (or sys.exec_prefix) prior to compilation.


Answer URL
https://docs.python.org/3/using/cmdline.html#envvar-PYTHONHOME
https://docs.python.org/3/library/sys.html#sys.exec_prefix
