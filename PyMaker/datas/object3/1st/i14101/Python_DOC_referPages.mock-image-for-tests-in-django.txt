Natural Text
I want to use mock-image for creating an object in Django.tests.py:But I have an error:I use spec-argument, how it described in documentation.Why it does not work and how to fix that?Thanks!UPDATEIf I use this in setUp():And then run test, nothing happens:So, no errors and no running tests. UPDATE 1:In setUP():And it generates new error:Traceback:UPDATE 2:models.py:
Have you tried using MagicMock? I doubt it will help, though. The problem is, that MyModel.objects.create requires your mock object returns useful values when it invokes methods like .read() on your file_mock instance. However, mocks only return mocks in the first place and you'd have to configure the mock's return values and attributes so that MyModel.objects.create can work with it.Depending on what you do with the image file in the database, I would assume a simple StringIO instance with arbitrary data might be good enough for providing a stub for an image file.UpdateYour MyModel.objects.create(img=file, name='123',) requires a django.core.files.ImageFile instance. So you need to pass the BytesIO buffer to ImageFile and you probably have to save the image into the buffer, I'm not sure if the Image.tostring would work:


Answer URL
https://docs.python.org/3/library/unittest.mock.html#the-mock-class
