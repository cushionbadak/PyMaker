Natural Text
SummaryI need to detect indentation level of the first line in multiline string passed to a script. Store it. Remove this indent from other lines. Pass the multiline string with removed indent level to another program (that I've figured how to do) add back indent to all lines in multiline string and print it to stdout (that I also know how to do).To be specific I have a problem with vim and Python formatter YAPF.The way yapf works is that if python file is incorrect formatting would result in error.So imagine thisIf I would select this imagined lines in vim and then press gq (I've set formatprg=yapf) vim would substitute this lines with a traceback of yapf which is no good of course. But If I would select the whole function it would do the job perfectly.You can test this withThis would result in IndentationErrorWhile echo 'fooo = 1' | yapf would workSo what I think is a very nice workaround is to remove indentation store the indent level of the first line, pass string without indentation to yapf somehow and then add indent to the result. The problem with this is I'd like this to be a one liner or close to that so that it could be stored directly in my vimrc. So python isn't a good match for that because I would need at least to import re package etc.So I thought about perl.The only problem is that I don't know perl much.So for now my experiment looks like thisI will be glad for any help. Maybe there is more easy way to do this, I don't know.
Since you seem to be familiar with Python already I would recommend using its textwrap module, which contains dedent and (in version 3.3 and later) indent functions that can do most of the job for you:


Answer URL
https://docs.python.org/3/library/textwrap.html#module-textwrap
https://docs.python.org/3/library/textwrap.html#textwrap.indent
