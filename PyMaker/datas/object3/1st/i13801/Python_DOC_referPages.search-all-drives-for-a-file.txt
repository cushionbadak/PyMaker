Natural Text
I have the name of a file and I want to find it on whatever Drive it is. I can use a recursive search, but I need a root directory to start with. For most computers, the root is "C:\". But there are some that have changed the letter, or some that have more than one (eg. C,D...).So, I need to find a way to know all the Drives in a computer, so I can search through each one. I need to find the letters programmatically without user input.I know I can use "diskpart", but it requires an administrator access, something my code will not have. There is also "wmic", but I don't know if the computer has the right folder in the PATH.So, the question is how can I do a recursive search in a computer which I don't know the letters of the drives or how many are there? Or is there another way to find the path of a file in a computer?
I have a solution that requires you run as an administrator, but does not require you install any other tools. I then have an alternative, messy solution that you can run even without any of these privileges. I'll start with the cleaner one.This script will find you the drives:Basically, fsutil fsinfo drives is a commandline command that will return the letters of existing drives on your computer. So you can get that result with check_output and then strip away the unnecessary characters, because it will return a string like '\r\nDrives: C:\\ D:\\ \r\n'. Then you can split the list and you'll have a list of drives like this:You can then loop over those drives to recursively search for a file.This function will basically loop over every file in the folder it's provided, it first checks if the file is a folder with isdir, and runs recursively on any folders it finds. If it's not a folder, it will check for the file named target and return its path when found. You can combine these two parts pretty simply:However, if you're unable to run as administrator, there is another way that's not as nice. Basically you could just loop over all the possible drive names and check if they exist, like this:This will check if each drive exists as a directory and search each one that does. Note this will include networked paths and I believe USBs/external hard drives, while the alternative method does not.
If I'm understanding correctly you know the name of the file.Using os.path.abspath('myfile.txt') should return the full path.Afterwards you can use the os.path.dirname to get only the directory.According to documentation os.path should be cross-platform: https://docs.python.org/3/library/os.path.html#module-os.path but I haven't tried it on Windows.


Answer URL
https://docs.python.org/3/library/os.path.html#module-os.path
