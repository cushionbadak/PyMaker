Natural Text
I have following simple Python 3.4 script:When I call from android:Android:I see Toast "Can not send" and on logcat console I have following information:Python:What is wrong with Python script?
What is wrong with python script ?it would somehow work with python3.0-3.2 but won't work with python3.3+from send_response documentationChanged in version 3.3: Headers are stored to an internal buffer and end_headers() needs to be called explicitly.in the current setup the header part of http answer is simply not sent.so the right way to do it in python3.3+ is but there is several thing which could be improved in your scriptuse http.server.BaseHTTPRequestHandler instead of http.server.SimpleHTTPRequestHandler because SimpleHTTPRequestHandler add some magic to BaseHTTPRequestHandler to process GET and HEAD request. as you override do_GET, you replace the behavior of SimpleHTTPRequestHandler but as you don't do it for do_HEAD, your server would answer to HEAD requests as it would be SimpleHTTPRequestHandler which is not a good ideahttpd.server_close() instead httpd.socket.close() even if that don't change thing too much as it is basically a noop in the current pythonadding an import at top of the script and voil√† a full working script
It seems like the response may be incomplete due to EOF Exception.Try to change your do_GET to the following:
It is not related to Android (hint: you may check your server from simple web browser).According to protocol specification HTTP server must start its response with lineThen server sends other headers, blank line and optional binary body (in some cases).It turns out that status message behaves like a header although it is not explicitly exposed in documentation. Since that you have to call end_headers() after send_response().Just add it to your code.If you add the body you may enter in browser http://localhost:7000 and see hello message. After that re-check server from your Andriod application.Also change http.server.SimpleHTTPRequestHandler to http.server.BaseHTTPRequestHandler, latter is enough in your case.


Answer URL
https://docs.python.org/3/library/http.server.html#http.server.BaseHTTPRequestHandler.send_response
