Natural Text
I am writing a python command line client program to interface with an api. The user uses the client program to run following command and the client program makes following example calls to apipython run.py --car --> calls method get_all(vehicle_type) which requests-->  /car/all    --< which returns list of all carspython run.py --van -->  /van/all    --> which returns list of all vans/car/id/123  --> --> calls method get_by_id(vehicle_type, id) which requests --> returns list of car with id 123And similar for all others. /car/color/red return list of car with color red/car/model_no/31x  return car with model_no 31x/van/id/312  returns list of van with id 321I am using arg parse for this purpose and having trouble properly putting this. Right now, I am doing. when I run this code for command.  python run.py --car --id  123I get{'car' : 'car' , 'id' : '123'}I am looping through this dict and using getattr to call function by the key name 'get_by_{name}'.format(name = key).However, my code doesn't looks nice as I have to check if the length is 1 then call get all function and check for vehicle type. Is there a better way to properly use argparse to make code more compact.
I find when using mutually_exclusive_groups I frequently make use of the dest option so you have one variable with a dynamic value:Then for the second group you can use type to apply a change when the option is specified, so that it saves a reference to the option text specified:Then the request can be retrieved like:Then you are guaranteed to just have to deal with the vehicle and request options:    
A relatively straight forward way of doing what you want (I think) is:You could use default=argparse.SUPPRESS to keep id out of args (like what you do with arg_dict = {k:v for k, v in vars(args).items() if v}.  But it easier to testthanorIf you really wanted to generate the function name from args values you could do a dictionary lookup (locals() or a custom dictionary).  Internally argparse uses a registries dictionary via parser.register.The argparse docs shows how parser.set_defaults can be used to define an args attribute as a function.  But that particular use only applies to subparsers.You could use const to set an function, egThenwould run get_by_id function.< removed a version that uses this store_const.  It had problems accepting a value; set edit history for details >===================Here's a custom action approach to defining a fn attribute and a valueBUT - notice that the class definition requires more lines of code than the if-else tree.  And took me longer to write.


Answer URL
https://docs.python.org/3/library/argparse.html#dest
