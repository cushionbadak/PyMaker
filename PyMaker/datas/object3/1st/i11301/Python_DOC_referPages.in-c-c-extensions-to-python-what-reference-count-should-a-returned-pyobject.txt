Natural Text
Lets say you wrote a C++ (or C) extension to python, called module. It returns an array of arrays. What should  the returned array, and its arrays, have as reference counts?The python code would be something likeI would expect g(x) to be 2, not 3. (after adding one for g to reference x)In my C++ extension, I have made sure that the array and all its sub-collections and their elements have reference counts of 1 before being returned to python, so I'm not sure how it shot up to 3 so quickly? Perhaps returned PyObject*'s should have 0 as its reference count?Edit: sorry, I'm an idiot. I was making another reference without knowing it.
If no other references to the returned object exist, the refcount should be 1. If the refcount were 0, the object would get deallocated.


Answer URL
https://docs.python.org/3/c-api/intro.html#reference-count-details
