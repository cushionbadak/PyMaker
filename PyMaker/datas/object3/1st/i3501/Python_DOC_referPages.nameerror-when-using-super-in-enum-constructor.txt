Natural Text
I am using Python 2.7.10 with the enum34 library. I am trying to do the following:When this code is run, I receive the error NameError: global name 'Bar' is not defined. Could someone help explain why I receive this error and if it's possible to call the parent constructor of an enum subclass? Thank you in advance!Edit: Traceback (with path names redacted) for Olivier Melan√ßon:
The problem is that Bar.VALUE.__init__ is being called before Bar exists.You can see where this happens in EnumMeta.__new__, but even without looking at the code, it pretty much has to work this way: the whole point of an Enum class is that its enumeration members are constant values that act as attributes of the class while also being instances of it.In that, this code will produce the exact same error in 3.4+ with the stdlib enum module, and similar errors with multiple third-party enum replacements.In general, if you have Enum hierarchies at all, you're expected to put values only in the "leaf" classes and behavior only in the non-leaf classes. However, the only restriction that's actually explicitly documented in Restricted subclassing of enumerations is no values in non-leaf classes, so technically what you're trying to do should be legal, even if it's unusual and was never explicitly intended to work.If you were using Python 3, there's a pretty easy workaround: just using super() instead of super(Bar, self), and it doesn't matter than Bar doesn't exist yet.In Python 2, since that isn't doable, you need to manually simulate super. For full generality, that means writing the code to walk the mro and so on, but since multiple inheritance including two or more Enum classes isn't going to work anyway, you'll be fine just hardcoding it statically:Alternatively, if you change your design to put all the behavior in non-leaf classes, that will also work:Most likely, whatever you're actually trying to accomplish could be done in a better way without requiring either of these changes. But since your toy example doesn't accomplishes anything, there's nothing more to show.


Answer URL
https://docs.python.org/3/library/enum.html#restricted-subclassing-of-enumerations
https://docs.python.org/3/reference/datamodel.html#creating-the-class-object
