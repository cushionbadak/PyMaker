Natural Text
I am trying to walk through the subdirectories of a parent directory looking for the .xlsx file with the newest date in the file name in each subdirectory.  The naming convention for my files will be such that they will start with the date and then filename.ex. 20180621 file name.xlsxThis way I can find the newest file from each subdirectory and run my script on them.I have the following code which only works if I have a .xlsx in every directory, including the parent directory.  If I do not have a .xlsx in any of the directories, the code returns ValueError: max() arg is an empty sequence and then it exits without continuing the search.example 1:  If parent directory does not contain a .xlsx file, even though the subdirectories do, the code exits with max() empty sequence.  example 2:  If there is a folder anywhere in the tree without a .xlsx file, the code exits with max() empty sequence.  If subdirectory1.1 doesn't have a .xlsx file it will exit the code and not check subdirectory2 or subdirectory3.How can I get os.walk to continue searching through all the subdirectories even after it finds one that does not contain the .xlsx file that I am looking for (including if the parent directory doesn't have a .xlsx file).
It doesn't stop, max throws an error. You can handle this in a couple of ways:or
os.walk() can't continue because an exception was raised. Either don't call max() with an empty list, catch the exception, or tell max() to return a default value if the list is empty.You can trivially skip testing for the largest if there are no excel files; if list_of_files: will be false if the list is empty:If you are using Python 3.4 or newer, you can also tell the max() function to return a default value if your input list is empty:Last but not least, you can use try...except ValueError: to handle the exception thrown:You can simplify your code by using the fnmatch.filter() function to filter out matching files:


Answer URL
https://docs.python.org/3/library/functions.html#max
https://docs.python.org/3/library/fnmatch.html#fnmatch.filter
