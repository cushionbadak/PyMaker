Natural Text
I'm surprised by the output from Python's logging module. I wrote up the Python.org's How-To for Logging. When I run the sample code, there is a lot of (confusing) duplication. The StreamHandler duplicates the log messages, one for each time I reload the file in iPython with the magic %runI added a FileHandler:This also duplicates:I also followed the suggestions from other posts, and added these lines just before the message calls:The results are the same.Setting up to post, I see a similar question:What could cause the logging module to log a record multiple times?But all this debugging is for the OP's original custom code. My issue is with the sample code, which I expect should warn or explain better what's happening. The docs say,Note. If you attach a handler to a logger and one or more of its ancestors,  it may emit the same record multiple times. In general, you should not  need to attach a handler to more than one logger - if you just attach  it to the appropriate logger which is highest in the logger hierarchy,  then it will see all events logged by all descendant loggers, provided  that their propagate setting is left set to True. A common scenario is  to attach handlers only to the root logger, and to let propagation  take care of the rest.You can see the full test file main.py here to see if I have 'more than one logger'.
The logger returned by logging.getLogger(__name__) is the same logger each time %run main.py is executed. But instantiates a new StreamHandler each time, which is then added to the logger:Thus, on subsequent runs of %run main.py, the logger has multiple handlersattached to it and a record gets emitted by each handler.The first time %run main.py is run, two handlers are attached to logger:The second time, there are now four handlers:To prevent duplication, you could call logger.removeHandler between %run calls:or, modify main.py so that new handlers are not attached each time %run is called.For example, you could setup logger using logging.config.dictConfig:Using this code, %run main.py emits the same output each time.


Answer URL
https://docs.python.org/3/howto/logging.html#configuring-logging
