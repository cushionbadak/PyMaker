Natural Text
Should I use atomic counter with Locking or can I use this? 
No, your code is not threadsafe, because using an += augmented assignment on a dictionary value takes 3 opcodes to execute:The opcode at position 9, BINARY_SUBSCR retrieves the current value from the dictionary. Anywhere between opcodes 9 and 15 (where STORE_SUBSCR puts the value back in), a thread-switch could take place and a different thread could have updated the dictionary.
Python's built-in structures are thread safe for single operations. The GIL (global interpreter lock) takes care of that. But it is mostly difficult to see where a statement becomes more operations.Adding a lock will give you peace of mind:


Answer URL
https://docs.python.org/3/c-api/init.html#thread-state-and-the-global-interpreter-lock
