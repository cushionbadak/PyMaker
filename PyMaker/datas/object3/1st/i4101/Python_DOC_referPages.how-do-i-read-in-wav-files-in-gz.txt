Natural Text
I am learning machine learning and data analysis on wav files.I know if I have wav files directly I can do something like this to read in the dataNow I'm given a gz-file "music_feature_extraction_test.tar.gz"I'm not sure what to do now. I tried:but it gives me:TypeError: lstat() argument 1 must be encoded string without null bytes, not strCan anyone help me out?
There are several things going on:The file you are given is a gzipped-compressed tarball. Take a look at the tarfile module, it can read gzip-compressed files directly. You'll get an iterator over it's members, each of which is an individual file.AFAIKS librosa can't read from an in-memory buffer so you have to unpack the tar-members to temporary files. The tempfile-module is your friend here, a NamedTemporaryFile will provide you with a self-deleting file that you can uncompress to and provide to librosa.You probably want to implement this as a simple generator function that takes the tarfile-name as it's input, iterates over it's members and yields what librosa.load() provides you. That way everything gets cleaned up automatically.The basic loop would therefore beOpen the tarball using the tarfile-module. For each memberGet a new temporary file using NamedTemporaryFile. Copy the content of the tarball-member to that file. You may want to use shutil.copyfileobj to avoid reading the entire wav-file into memory before writing it to disk.The NamedTemporaryFile has a filename-attribute. Pass that to librosa.open.yield the return value of librosa.open to the caller.
You can use PySoundFile to read from the compressed file.https://pysoundfile.readthedocs.io/en/0.9.0/#virtual-ioMaybe you should also check if you need to resample the data before processing it with librosa:https://librosa.github.io/librosa/ioformats.html#read-specific-formats


Answer URL
https://docs.python.org/3/library/tarfile.html
https://docs.python.org/3/library/tempfile.html
