Natural Text
Background: I am hosting a flask server alongside a discord clientThe flask server just needs to pass on messages from the client to discord and from messages from discord to the client.I am getting the error when I call loop.run_until_complete(sendMsg(request))I have tried wait_for in sendMsg and wait_for loop.run_until_complete()I have looked everywhere and haven't found anything so any help would be appreciated.Code:Traceback:
The problem looks like it could be caused by the following:That creates a new event loop and runs sendMsg(request) in the new loop. However, sendMsg calls a method on the client object running in its own event loop. sendMsg should be submitted to the existing event loop that runs the client in the other thread. To accomplish that, you need to:expose the loop created in startClient, e.g. to a client_loop global variable;replace loop = asyncio.new_event_loop(); loop.run_until_complete(sendMsg(request)) with a call to asyncio.run_coroutine_threadsafe to submit the coroutine to an event loop already running in a different thread.The submit code would look like this:


Answer URL
https://docs.python.org/3/library/asyncio-task.html#asyncio.run_coroutine_threadsafe
