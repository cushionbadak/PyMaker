Natural Text
Why doesn't this work when running as Administrator?When I run it from powershell or cmd, it works.When I use Popen and communicate() I get the error:
The errors in question, comments tend to point to the fact that there's a big chance that the code posted here is not the one that you run (maybe it's out of date?).Anyways, running your exact code (saved in a file called code.py) yields:Not too much useful info. But check_output is just a convenience wrapper, which in the current case works against us. For more details, check [Python 3]: subprocess - Subprocess management. So, I modified your code.code.py:This time, the output is:Now, it's visible that the PS (powershell) command run attempt was successfully run, but the command itself, failed. So, everything is good on subprocess (and Python) side (fact that wasn't quite clear when using check_output), and the problem is on PS side.In my case, I have no backups, so it's expected to fail. But anyway, from here it seems more like a sysadmin task.
Use the full path in your command. For example:


Answer URL
https://docs.python.org/3/library/subprocess.html#module-subprocess
