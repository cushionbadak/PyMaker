Natural Text
I have a list of ~1000 unique itemsand a pandas df.column of ~12 mil lines with just integers from this list.What I need to do is create a new column with always the previous element in the list of uniques than the one in my original column.I have tried doing it with apply but the efficiency is laughable, and with a common loop which is kind of ok (~2 mins on my system), but I am wondering if I could get there more efficiently (smaller numbers used for illustration purposes):
The problem here is that you're using list.index, which does a linear search through all of the unique values.If you can afford the space to build a dict, you can turn this into a constant-time lookup:If you can't (in which case you should be keeping the values in an array or Slice rather than a list in the first placeâ€¦), as long as you keep them sorted, you can at least search in logarithmic rather than linear time using bisect or np.searchsorted:(This will be faster if unique2 is an array rather than a list, but only by a constant factor; it's still logarithmic time with a list.)


Answer URL
https://docs.python.org/3/library/stdtypes.html#common-sequence-operations
https://docs.python.org/3/library/bisect.html
