Natural Text
I have this YAML file :when I apply my flattendict Python function, I get thisI search the syntax of my YAML file as below, to get the same result (I want factoring my YAML node data)Have you an idea?Here my python flattendict function
In YAML you can have a complex flow node, even in a simple key (i.e. without ?, markup). This is so in both YAML 1.2 and YAML 1.1. That means that this:is correct YAML. The problem is that a mapping normally loads as a Python dict and a sequence as a Python list, both of which are mutable, cannot be hashed, and are not allowed as keys for a Python dict (try executing python -c "{{'a': 1}: 2}").PyYAML (which supports YAML 1.1) errors out on both of those lines. Since Python has an immutable list in the form of tuple, I decided to implement loading of sequence keys in Python by constructing them as tuples in ruamel.yaml (which supports YAML 1.2 and YAML 1.1). So the following works:printing:If you try to load the above YAML in PyYAML it throws an exception:Notes:If you don't want to round-trip, use typ="safe", it uses the faster C-loader, that also handles keys-that-are-sequences, but it doesn't as smartly dump those back, resulting in ? marked explicit keys.A proposal for a frozendict for Python, did not get accepted, so there is no equivalent, not even in the standard library for a dict what tuple is for a list, and ruamel.yaml doesn't support mappings as keys out of the box. You can of course add this to ruamel.yaml's Constructor if you have such a frozendict.Although there is a frozenset in Python, and a set in YAML, ruamel.yaml does not currently accept the following as input:Probably needless to say: you cannot change the elements of such a key programmatically without deleting and re-adding the key-value pair.


Answer URL
https://docs.python.org/3/library/stdtypes.html#frozenset
