Natural Text
I have a pandas dataframe like where the first four columns form a multiindex:I'd like to iterate over the index values to get the grouped total count for each unique index values like so:I'm able to generate each group easily using query and groupby, but ideally I'd like to be able to iterate over any number of index columns to get the sum of the cnt column.
Similar to previous answers, here's a slightly more streamlined approach using itertools and groupby:Output:The powerset computation is taken directly from the itertools docs.
I mainly used combinations and product from itertools.combinations is for all combinations of values within each column.product is for all combinations of values across all column.  Result:



Answer URL
https://docs.python.org/3/library/itertools.html#itertools-recipes
