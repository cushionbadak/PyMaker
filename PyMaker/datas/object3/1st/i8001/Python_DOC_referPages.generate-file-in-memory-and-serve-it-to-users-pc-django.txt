Natural Text
Hi I have a quick question. I didn't find answer in internet maybe someone of you can help me.So i want to save workbook as attachment but I don't know how lets see an example :Then I tried :It's returning xlsx file indeed but in file there is only object adres not the content of file:Can someone help ?
Give it a try:save_virtual_workbook was specially designed for your use case. Here's a docstring:"""Return an in-memory workbook, suitable for a Django response."""
I usually useinstead ofMoreover, you can try to do: (see documentation)and then use stream in HttpResponse.
On at least some versions of django/python/openpyxl, the given solution does not work. See https://bitbucket.org/openpyxl/openpyxl/issues/657/save_virtual_workbook-generates-junk-dataSimple working solution:What's happening here is that Django's HttpResponse is a file-like object. Workbook.save() can take a file-like object. (Internally, it uses zipfile, which takes either a filename or a file-like object.)If you're manipulating the file in memory, this is the simplest and probably most efficient solution. A streaming response doesn't really make sense since the data is not being created with a generator. Even if save_virtual_workbook works, the data it writes is generated as a block before it's readable.The other option would be to create a NamedTemporaryFile (from tempfile or Django's wrapper), pass that into Workbook.save(), then use FileResponse to stream that from the filesystem instead of from memory.


Answer URL
https://docs.python.org/3/library/zipfile.html
https://docs.python.org/3/library/tempfile.html
