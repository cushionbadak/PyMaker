Natural Text
When reading a python-based software, I feel confused about a line of python code: path = sys.modules[self.__class__.__module__].__file__. I can guess it was trying to return the file name in class file, but I'm not very clear about the exact usage of this.  I saved the related code segment into a file named test.py and I'm trying to test it by python test.py, but it does not print anything. How can I test this kind of file?
Classes in python have a __module__ attribute which contains the name of the module in which the class was defined. Additionally, each module contains a __file__ attribute which has the full path to the .py file. He is trying to get the file path for the file in which the class was defined but he's not going the best way with doing it, ideally you could just index sys.modules by using __name__:instead of going through the class (i.e self.__class__.__module__ == __name__). Do note here that if __name__ == "__main__" this will fail because the __main__ module does not have a __file__ attribute defined. You'll need to safeguard against it:where if __name__ == "__main__" then __file__ will contain the path of the file being executed. Next, add the usual clause in your script in order for it to initialize the object if the script is running as __main__:Now, if you call it as the __main__ script with:or if you import it, it will pickup the __file__ attribute, print it and then print the file name.P.s: Fix the indentation in your final print.


Answer URL
https://docs.python.org/3/library/sys.html#sys.modules
