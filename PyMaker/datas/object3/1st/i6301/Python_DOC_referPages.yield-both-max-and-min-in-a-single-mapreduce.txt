Natural Text
I am a beginner just getting started with writing MapReduce programs in Python using MRJob library. One of the example worked out in the video tutorial is to find a max temperature by location_id. Following on from that writing another program to find the min temperature by location_id is straightforward too.I am wondering, is there a way to yield both max and min temperature by location_id in a single mapreduce program?. Below is my go at it:I get the following error:Is this possible?Thank you for your assistance.Shiv
You have two problems in reducer:If you check type of the temperature argument, you will see that it's a generator. A generator can be traversed only once so you cannot pass the same generator to both 'min' and 'max' functions. The right solution is to manually traverse it. A wrong solution - converting it to a list - may cause out of memory error on big enough input because a list holds all its elements in memory and a generator does not.Result of reducer must be a two-elements tuple. So you need to combine your min and max temperature in another tuple.Complete working solution:
The problem is that temperatures in your reducer method is a generator.For better understanding let's create a simple generator and look on its behavior: Ðžne of the features of such an object is that once exhausted, you can't reuse it:Therefore sequential execution of max() and min() leads to an error:So, you can't use the same generator with both max() and min() built-in functions because in the second use the generator will be exhausted.Instead you can:   1) convert the generator to a list and work with it:2) or extract min and max values of the generator within 1 for-loop:So, the following edit of reducer:should fix the error.


Answer URL
https://docs.python.org/3/glossary.html#term-generator
