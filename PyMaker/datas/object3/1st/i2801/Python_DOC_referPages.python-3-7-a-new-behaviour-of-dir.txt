Natural Text
I've just installed Python 3.7 and faced an error with dir() in inspect module. Please consider this minimum example.1) Create a module testdir that has one line:2) in python:results in this error in Python 3.7and runs normally in Python 3.6:I understand that dir() expects __dir__ to be a function but in the docs this is not a must but rather a condition and the docs provide no difference in respect to 3.x vs 3.7. Why the behaviour is different? Is it a bug or a feature?Thanks!
The relevant PEP (PEP 562) actually contains the specification:The __dir__ function should accept no arguments, and return a list of strings that represents the names accessible on module:If present, this function overrides the standard dir() search on a module.The difference is that __dir__ in a module was simply ignored until Python 3.7. Given that double underscore names must be used according to Pythons specification it's not necessary to include a deprecation (for the changed behavior) there because __dir__ as string was simply not according to the specification.
Python 3.7 now also allows __dir__ to be defined on modules. Previously it was simply ignored. The conditional part is that if __dir__ is defined, it must be a callable, but it is not required to be defined.


Answer URL
https://docs.python.org/3/library/functions.html#dir
https://docs.python.org/3/whatsnew/3.7.html#pep-562-customization-of-access-to-module-attributes
https://docs.python.org/3/whatsnew/3.7.html#pep-562-customization-of-access-to-module-attributes
