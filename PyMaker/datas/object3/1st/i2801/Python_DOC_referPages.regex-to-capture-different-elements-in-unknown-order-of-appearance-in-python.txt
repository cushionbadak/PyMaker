Natural Text
I am building a regex to extract the header values from a forwarded email in Python. I am only interested in the first appearance of these kinds of headers in an email and I only want to capture the text parts appearing after the colons.   The following regex works fine using re.search for most variations of the above format:but sometimes, the different header parts are ordered differently and have missing elements, such as below:I thought I could use a positive lookahead to match the header format in any order but I could not get this to work. Does anyone have any idea how this can be done efficiently? Any help is greatly appreciated.
One possibility would be to never consume any characters, and use lookahead to capture everything you need in optional groups:https://regex101.com/r/pOThDP/2Spaced out, that's just 4 repititions of a similar pattern that looks like:Also, you might consider named capture groups, for clarity:https://regex101.com/r/pOThDP/3Edit: Example in python code:Output is:
Try this pattern: \G(From:|Subject:|Sent:|To:)(.+)\nRequirement, that it should capture only first block, is fulfilled by \G anchor, which makes sure next match (Sent/To/From/Subject) is met right after the previous one, so header of another mail isn't matched, because it will be separated by content of an e-mail.Alternation makes sure, that it will match the header independently of the order of Sent/To/From/Subject.Demo


Answer URL
https://docs.python.org/3/library/email.parser.html
