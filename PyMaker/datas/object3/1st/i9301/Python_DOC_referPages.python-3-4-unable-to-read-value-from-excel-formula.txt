Natural Text
I try with Python 3.4 to get the value of cell C1 of an Excel file.cell C1 is a formula:  =A1+B1.Note: A1 and B1 value are changing, thus the return value in C1 has to change automatically accordingly.In Python 3.4, I use following codes:======When running the python program, I obtain:C1: =A1+B1What I want to obtain is:A1=1, B1=2 then C1: 3      (instead of C1: =A1+B1)andA1=10, B1=20 then automaticallyC1: 30     (instead of C1: =A1+B1)Any help, idea would be greatly appreciated. Thanks.
A very quick look on the openpyxl docs and you might find this page saying openpyxl never evaluates formulaBefore going any further, it should be noted that the possible duplicate links have answers pertaining to other modules, and these are usually the accepted answers. With those modules you don't have to implement your own parsing. Which can be anywhere from challenging to near impossible for more complex systems. If you're doing pretty simple stuff, it's not terribly difficult with the Tokenizer class. Usage:Pay special attention, everything is a string, so evaluating formulas is best done with eval()So if you edited your code a bit (new/changed lines marked with #),Where handle_token() is up to you for how complicated you wanted it. A couple simple and perhaps hack-y examples for C1: =A1 + B1 and other binary operators: (these don't work for ^ as python uses that for bitwise XOR)Or if you prefer (this can be converted to a one-liner, not recommended) using a generator:


Answer URL
https://docs.python.org/3/library/functions.html#eval
