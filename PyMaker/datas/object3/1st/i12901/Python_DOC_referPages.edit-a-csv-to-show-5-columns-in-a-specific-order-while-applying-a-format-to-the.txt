Natural Text
I have a 130 excel files all called cplt.csv each stored under two subfolders under the folder BM. i.e. BM/1/1/cplt.csv BM/2/2/cplt.csv and so onI need to read each of these csv files and change it from 7 columns to 5 columns. The order in which I need the columns are 7th, 3rd, 2nd, 1st and 6th.The 1st column is the datetime field which currently looks like 8/22/2015 1:19:01 AMI need it to look like this -> 22-Aug-2015 01.19.01 or follow the ISO format ("yyyy-MM-dd'T'HH:mm:ssZ").I've got two problems the way I see it, 1) I am currently unable to access all the cplt.csv files under my BM folder. 2) I am not sure how to change the date time to the ISO format I need it to be and to output it back to the same csv file.The code I've currently got is as follows:
Iterate over each directory and run this function on each file, datetime.strptime will parse your dates and convert to isoformat, itemgetter pulls whatever columns you want to keep, we write to a tempfile using a NamedTemporaryFile and after after we have written the new content we replace the original file with shutil.move:Now to find the csv files nested in the subdirectories we can use pathlib:   using the same structure and a couple of test files:


Answer URL
https://docs.python.org/3/library/pathlib.html
