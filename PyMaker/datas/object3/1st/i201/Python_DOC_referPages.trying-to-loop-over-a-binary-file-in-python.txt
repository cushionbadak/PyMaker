Natural Text
I'm trying to use Python to loop over a long binary file filled with 8-byte records.Each record has the format [ uint16 | uint16 | uint32 ](which is "HHI" in struct-formatting)Apparently each 8-byte block is getting treated as an int, instead of an array of 8-bytes, then causing the struct.unpack call to failHow can I read my file as a series of structures, and print them each out?
f.read(len) only returns a byte string. Then raw will be a single byte.The correct way of looping is:
The iter builtin, if passed a callable and a sentinel value will call the callable repeatedly until the sentinel value is returned.So you can create a partial function with functools.partial (or use a lambda) and pass it to iter, like this:
I've never used this before, but it looks like an initialization issue:You may want to look at iter_unpack() for optimization if you have adequate ram.Note that in 3.7, the default value changes from bytes to string. see near end of page https://docs.python.org/3/library/struct.html#struct.pack


Answer URL
https://docs.python.org/3/library/functions.html#iter
https://docs.python.org/3/library/functools.html#functools.partial
https://docs.python.org/3/library/struct.html#struct.pack
