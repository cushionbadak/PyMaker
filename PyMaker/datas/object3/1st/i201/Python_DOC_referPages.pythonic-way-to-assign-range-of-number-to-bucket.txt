Natural Text
I'm developing an ABtest framework using django. I want to assign variant number based on bucket_id from cookies' request.bucket_id is set by the front end with a range integer from 0-99.So far, I have created the function name get_bucket_name:Data input for get_bucket_range is a comma delineated string which means we have 3 variants where each variant has its own weight e.g.  data = "25,25,50" with first variant's weight being 25 etc.I then created a function to assign the variant named, This function should have 2 parameters, range_bucket -> from get_bucket_range function, and num -> bucket_id from cookies.With this function I can return which bucket_id belongs to the variant id.For example, we have 25 as bucket_id, with data = "25,25,50". This means our bucket_id should belong to variant id 1. Or in the case that we have 25 as bucket_id,  with data = "10,10,10,70". This should mean that our bucket_id will belong to variant id 2.However, it feels like neither of my functions are pythonic or optimised. Does anyone here have any suggestions as to how I could improve my code?
Your functions could look like this for example:
You can greatly reduce the lengths of your functions with the itertools.accumulate and bisect.bisect functions. The first function accumulates all the weights into sums (10,10,10,70 becomes 10,20,30,100), and the second function gives you the index of where that element would belong, which in your case is equivalent to the index of the group it belongs to.


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.accumulate
https://docs.python.org/3/library/bisect.html#bisect.bisect
