Natural Text
I am used to using SQL to solve hierarchical joins but I'm wondering if it can be done in Python, maybe using Pandas. And which one is more efficient to go for?CSV Data:emp_id,fn,ln,mgr_id1,Matthew,Reichek,NULL2,John,Cottone,33,Chris,Winter,14,Sergey,Bobkov,25,Andrey,Botelli,26,Karen,Goetz,77,Tri,Pham,38,Drew,Thompson,79,BD,Alabi,710,Sreedhar,Kavali,7I want to find the Level of each employee (Boss is Level 1 and so on):My Recursive Code in SQL would be:
You could make a dict mapping emp_id to mgr_id and then make a recursive function liketo compute the depth given an id. To make it more efficient (by not repeating calculations for the same id),you could use memoization (handled by the @functools.lru_cache decorator below):yields


Answer URL
https://docs.python.org/3/library/functools.html#functools.lru_cache
