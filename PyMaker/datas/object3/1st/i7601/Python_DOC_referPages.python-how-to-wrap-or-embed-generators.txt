Natural Text
I'm trying to provide a unified interface for retrieving all files from a single directory or a list of directories. Questions:error says 'file' is still a generator regardless of the input being a single dir or a list of it. Why is it still a generator? is it possible to wrap or embed generators in functions? If so, how to make this work? Thanks!
You are yielding helper() each time:but helper() itself is a generator.In Python 3.3 and newer, use yield from instead:This delegates control to another generator. From the Yield expressions documentation:When yield from <expr> is used, it treats the supplied expression as a subiterator. All values produced by that subiterator are passed directly to the caller of the current generatorâ€™s methods.In older Python versions, including Python 2.x, use another loop:For more information on what yield from does, see PEP 380 -- Syntax for Delegating to a Subgenerator.Not that you really need the helper function, it does little more than just loop over the glob.glob() results, you can do that directly. You also need to correct your function to actually use indir; currently you are ignoring that argument, so you only get text files from the current working directory.Next, you want to use glob.iglob() instead of glob.glob() to get the lazy evaluation over os.scandir() rather than load all results into memory at once. I'd just turn a non-list dir_or_dirs value into a list, then just use one loop:Now, instead of a single argument that is either a string or a list, I'd use a variable number of arguments instead, with the *args parameter syntax:This can be called with 0 or more directories:


Answer URL
https://docs.python.org/3/reference/expressions.html#yield-expressions
https://docs.python.org/3/library/glob.html#glob.iglob
