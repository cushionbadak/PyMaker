Natural Text
I'm creating a bunch of components in my project, each of them will be running in different threads.They will communicate through queue.Queue. I would like to define all the different queues, which is classes that extends queue.Queue. Each of them will be singleton object, so the different components can just import that class, and get the instance.    I put everything in one file:In the constructor of the two components (AudioInput and Interpretor) I print the object, to make sure they are the same.AudioInput put a string in the queue, and Interpretor reads it. However, the queue in Interpretor is always empty, making the program hangs forever.Here's the output of the program:  
I solve my problem by using another method to define my class as a singleton : 
What's happening here is that after your __new__ function returns the queue object, python implicitly calls __init__ on it. This resets the queue and any items you've previously added are removed.From the docs on __new__:If __new__() returns an instance of cls, then the new instanceâ€™s  __init__() method will be invoked [...]Step by step, this is what happens:This is a common problem when implementing singletons with __new__. You can work around this by using a metaclass, or by using a different function to get the queue singleton:


Answer URL
https://docs.python.org/3/reference/datamodel.html#object.__new__
