Natural Text
I have a file on my computer that I'm trying to serve up as JSON from a django view.What I get back is the path to the file when navigating to the URLWhat am I doing wrong here?
os.path.join returns a string, it's why you get a path in the content of the response. You need to read the file at that path first.For a static fileIf the file is static and on disk, you could just return it using the webserver and avoid using python and django at all. If the file needs authenticating to be downloaded, you could still handle that with django, and return a X-Sendfile header (this is dependant on the webserver).Serving static files is a job for a webserver, Nginx and Apache are really good at this, while Python and Django are tools to handle application logic.Simplest way to read a fileThis is inspired by How do I read a text file into a string variable in PythonFor a more advanced solutionSee dhke's answer on StreamingHttpResponse.Additional informationReading and writing filesManaging files with Django
If you feed HttpResponse a string a content you tell it to serve that string as HTTP body:content should be an iterator or a string. If itâ€™s an iterator, it should return strings, and those strings will be joined together to form the content of the response. If it is not an iterator or a string, it will be converted to a string when accessed.Since you seem to be using your static storage directory, you might as well use staticfiles to handle content:As noted in @Emile Bergeron's answer, for static files, this should already be overkill, since those are supposed to be accessible from outside, anyway. So a simple redirect to static(file_path) should do the trick, too (given your webserver is correctly configured).To serve an arbitrary file:Note that from Django 1.10 and on, the file handle will be closed automatically.Also, if the file is accessible from your webserver, consider using django-sendfile, so that the file's contents don't need to pass through Django at all.


Answer URL
https://docs.python.org/3/tutorial/inputoutput.html#reading-and-writing-files
