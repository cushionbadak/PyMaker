Natural Text
I am a fan of Python 3's foregrounding of unicode issues. However in one place I'm not sure what it is doing.As I understand it, the argv and the environment variables are transmitted from the OS to the python executable as bytes. Python chooses an encoding, and the data is exposed to the user program as unicode strings in sys.argv and os.environ.I can't figure out how python chooses this encoding. I thought it was with LC variables but that doesn't seem to work.I expected the second one to give 0xc2 0xa2 and 0xc2 0xa3, but it seems LC_ALL made no difference.Is there any way to bypass the encoding and just see the binary data provided to the executable?Optionally, how does Python choose an encoding and where does it expose it? I thought it was exposed in sys.getfilesystemencoding() but that has very sparse docs which do not clarify anything. Pointers to official documentation would be greatly appreciated.
Per the linked answers and the documentation they reference, here is a short answer:For os.environ, see os.environb, which is available on non-windows systems and provides direct access to the underlying bytes.sys.argv is automatically decoded to a Unicode object using a specialized variety of the system-determined encoding (taken from I think LANG), and the original bytes are not directly exposed. To access them, more or less reliably I think, you can use os.fsencode.I have a feeling this can be gamed but I will follow up on that later.


Answer URL
https://docs.python.org/3/library/os.html#os.environb
https://docs.python.org/3/library/os.html#os.fsencode
