Natural Text
I struggle to implement the moving average formula in my function.Took me quite a while to get where the code is right now. Is there a library I could probably take?Input:Expected Output:My Output:I am running into the problem that the middle parts of my result is right but the rest is a mystery.Why does it return None for the last three values in the list?def ma(prices, n):ma = []sums = []s = 0ave = 0(Sorry for all those print function calls, but I really wanted to get to the source of the issue).
There were several other logical errors in your code. I tried to correct it to make it work as you want. Following is only the modified version of the for loop. Rest stays the same. The added/modified lines are highlighted by a comment The problem was that you were using the wrong variable as the index:One major problem was that you were usingYou should use:Moreover, I added an if statement to take care of the average of the first three elements. Now gives the following output (you can round off later):
If you are ok using the standard library, this might help. What you really need is a sliding window over your iterator. You can use this function for that (this was based on grouper from itertools recipes):For the average you can use statistics.mean. The paddig part can be simply achieved by adding the average list with [None] * (n - 1):Sample usage:
The reason why your program returned that 9-9 / 3 = 0 is negative indexing. When idx is 2, sums[idx-n] is saying sums[-1], which points at the last item of the list, 9. Understanding Python's slice notation could help explain that.
You could also solve this using list slicing to partition your input list smartly and calculate the avg over the list-partitions:Output (parts included as comment):


Answer URL
https://docs.python.org/3/library/itertools.html#itertools-recipes
https://docs.python.org/3/library/itertools.html
