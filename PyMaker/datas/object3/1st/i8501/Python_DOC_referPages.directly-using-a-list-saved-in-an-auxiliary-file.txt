Natural Text
Is there a way to save a list in an auxiliary file and then manipulate it directly, without having to download it, manipulate it, and then rewriting the file?Namely, I would like to be able to do e.g. something like this:What is the correct way to do it? Is there a specific class for it?I solved the problem using shelve (a pickle-based library) as follows:
If you put data in a file and you want to make modifications, any operation that changes the length of the data requires you to read and write back out the remainder of the file. (You can modify parts of the file in place if the length remains exactly the same, and you can append at the end or truncate from the end.) So if you're looking for a way to keep your dataset in a file instead of loading it into memory, a plain file is not going to cut it. Neither is a pickled list, since it would have to be read in and written back out in its entirety. If that is your goal, I recommend using a database such as sqlite3, which does exactly what you want: It stores your data in a file, and takes care of the modifications for you.Check out the sqlite documentation for the details on how to use it.If your data doesn't have much structure, you may prefer dbm, which is a "key store" database for managing key-value pairs:
depending in what you are doing, you can save each element in your list in a line of your file, thus making easy to append new stuff to the file, for examplelets said this is yours original fileand this is the new stuff you want to add, then you only need to open the file in append mode ("a")now the file have both data, which you can recover at any time, like this for example
This may be tremendously insecure, but it works:Usage:Open behaves like an ordinary list and can save itself to a file and construct itself using one.This will execute the contents of the file as if it was Python code, so if any malicious code is read, it'll do its thing, be aware of this. Anyway, reading data from untrusted sources is always dangerous.


Answer URL
https://docs.python.org/3/library/sqlite3.html
https://docs.python.org/3/library/dbm.html
