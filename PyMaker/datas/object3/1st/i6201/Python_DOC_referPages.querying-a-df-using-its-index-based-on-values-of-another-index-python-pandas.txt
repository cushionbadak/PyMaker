Natural Text
I have two dataframes, and I want to create a filtered df_1 based on the timestamp index of df_2, shown below. For each index value of df_2, I want to take all the rows of df_1 that is within timedelta of 1 day of df_2 index value. Example: for df_2 index value 10/15/2017, I want to include in the new df_outcome, all the rows of df_1 that are between 10/14/2017 to 10/16/2017, which returns 10/14/2017  f and 10/15/2017  g. Any duplicates from the query are removed.Any help is appreciated, thanks.EDIT:I edited to change the index to timestamps, to reflect the actual problem. I'm so sorry for any confusion I did not anticipate it would be a problem. The timestamps are uneven.
The following indexer should do the trick on datetimes:Note: It doesn't scale well. It starts to take seconds if len(df1) * len(df2) ~ 106
Answer to updated questionThe new answer is based on the orignal one while using sets to identify valid indices:Answer to original questionYou can use pandas Index's set operations for this purpose. First, create a set of allowed indices using list and set comprehensions. Second, get the intersection of allowed and present indices. Last, use the valid indices to reindex your target dataframe.:


Answer URL
https://docs.python.org/3/tutorial/datastructures.html#sets
