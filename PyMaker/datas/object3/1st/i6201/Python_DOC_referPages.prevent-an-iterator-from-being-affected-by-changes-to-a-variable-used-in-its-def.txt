Natural Text
This question already has an answer here:Local variables in nested functions                    3 answers                Edit/solutionHere's an example that more closely mimics my real problem, and a solution implementing the comment by jonrsharpe. Thanks!Original questionHow can I make the Python code below produce [(1, 0), (1, 1)] instead of [(2, 0), (2, 1)]? That is, I wish the result wasn't affected by changes to const made after the definition of the iterator it.My real-world problem is to heapq.merge multiple files without keeping all their contents in memory. I'd like to programmatically generate iterators that report the file name together with each line of each file, e.g. ("file2.txt", "this is line 1"). Currently, all my iterators end up reporting the same filename.
You can move the generator expression from the module scope into a function, so the const value is read from the function scope and further changes to const do not influence the evaluation of the generator expression:


Answer URL
https://docs.python.org/3/library/heapq.html#heapq.merge
