Natural Text
Trying to learn to type hint in Python. Given these two functions:First one is ok to mypy, but it complains about the second one with an errorAm I using type hinting incorrenctly in this case?(Using python3.7 with mypy 0.610, also tested with py3.6)
Your signaturesays that file parameter can be str or TextIO, after that in function body you are trying to access .read attribute of file object, but in case of file being str there is no such attribute hence the error.You have at least 3 possibilities here:do not support case with file being of type str and replace Union[str, TextIO] with TextIOadd explicit type checking using isinstance built-in in function body likethis may become difficult to maintain in the long termwrite 2 different functions for given task: one for str parameter and one for TextIO parameter likethis may cause a lot of naming problems (but it depends on the use-case)The last approach can be improved using functools.singledispatch decorator: in short this will allow us to define a generic function & use a name myfunc_error with overloads called based on the type of first positional argument (file in our case):Note: we can use any name we want instead of _ except myfunc_error, for the latter mypy will raise a name conflict error.


Answer URL
https://docs.python.org/3/library/functions.html#isinstance
https://docs.python.org/3/library/functools.html#functools.singledispatch
https://docs.python.org/3/glossary.html#term-generic-function
