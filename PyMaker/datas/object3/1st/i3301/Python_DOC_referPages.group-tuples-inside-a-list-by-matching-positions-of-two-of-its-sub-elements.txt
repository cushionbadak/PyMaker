Natural Text
I have a list of tuples as below. The tuple in itself is a nested tuple with 3 sub-elements (tuples) inside it.I want to group these tuples by matching the positions of two of its elements viz. apple and mango (which is fixed and known beforehand) inside the tuples!Desired output:I tried using Counter and also checked some other examples but couldn't succeed in coming close the desired output. As such, any help or pointers would be really appreciated.
My go-to solution for grouping tasks like this is collections.defaultdict. I've written a lengthy answer about grouping things, which you can read here. Picking out the relevant snippets from that answer gives us this piece of code:Where all that's left is to find a way to uniquely represent each group with a hashable value (that is, we need to fill in the group = ??? line).The easiest solution is probably to extract the apple and mango values from the nested tuples and replace all other values with None:Add that in and we're done:
Another approach is to make a dictionary using the positions for each pair of sub-items as keys.GivenCodeFirst, we build a list of indices to locate occurrences of whitelisted sub-items in iterables. Finally, map_reduce is one way to make a defaultdict with custom keys and values.OutputDetailsFor each tuple in iterables, locate is used to yield the indices for items belonging to the set of whitelisted items.  These results are sufficient for grouping items together.  However, it is easier to see the actual items returned, so next we build a dictionary with map_reduce.We iterate a zip of (indices, iterables) pairs. keyfunc transforms the indices as keys.  Likewise, valuefunc transforms iterables as values.  The result is a defaultdict with values grouped by sub-positions of whitelisted items apple and mango.


Answer URL
https://docs.python.org/3/library/collections.html#collections.Counter
https://docs.python.org/3/library/collections.html#collections.defaultdict
