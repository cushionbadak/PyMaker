Natural Text
Is it possible to encrypt a message with a private key in python using pycryptodome or any other library? I know that you are not supposed to encrypt with the private key and decrypt with the public key, but my purpose is to encrypt with the private one so the receiver could be sure that the message was send by the real author. More than secure encryption I'm looking for some kind of obfuscation. I want to do an app where the message is public but it can only be seen if you have the public key.I've tried to do this:But it raises the next error: TypeError: This is not a private key.
Short answerthe code that you are using doesn't allow you to do that for security reasonsalternative code belowLong answer I was curious about your problem and then I started to try to codeAfter a while I realized that if you run this snippet you will see that it correctly works:but if you now change two of the final lines [i.e. the role of the keys] into:and rerun the program you will get the TypeError: No private keyLet me quote from this great answer: "As it turns out, PyCrypto is only trying to prevent you from mistaking one for the other here, OpenSSL or Ruby OpenSSL allow you for example to do both: public_encrypt/public_decrypt and private_encrypt/private_decrypt[...]Additional things need to be taken care of to make the result usable in practice. And that's why there is a dedicated signature package in PyCrypto - this effectively does what you described, but also additionally takes care of the things I mentioned"Adapting this link I came to the following code that should solve your question:Final notes: the last prints have ascii because as stated here "In case of base64 however, all characters are valid ASCII characters"in this case we are using the same key - the private one - both for encrypting and decrypting, so yes: we would end up to be symmetric but...but - as stated here - "The public key is PUBLIC - it's something you would readily share and thus would be easily disseminated. There's no added value in that case compared to using a symmetric cipher and a shared key" plus "Conceptually, "encrypting" with the private key is more useful for signing a message whereas the "decryption" using the public key is used for verifying the message"the same identical last principle is expressed in this answer - "Typically [...] we say sign with the private key and verify with the public key"


Answer URL
