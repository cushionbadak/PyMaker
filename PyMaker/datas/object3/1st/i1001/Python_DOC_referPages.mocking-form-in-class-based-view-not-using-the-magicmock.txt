Natural Text
I've been fighting with mocking a form class to replace an instance of it in a class-based view. But it looks like that because the form is in a class attribute, it happens before I replace the form class with my mock. Case in point:app/views.pyapp/tests/test_views.pyAs you can see in the inserted comments in app/views.py, I forcefully reloaded self.form and redefined the variable form using pdb, which made my test pass.It seems that for some reason, the SomeViewClass is [registered,instanciated,...] before I start patching SomeForm. Any ideas on that?
The problem is that the view is already loaded by Django and the form field is already defined and pointing to the SomeForm production class.As @DanielRoseman and @foxyblue pointed out in their comments, it is possible to patch directly a field in a class. And actually there was already an answer for that on SO. As pointed out, it is possible to use patch.object to patch a member of a class (which is, IMO, the best solution, as it's more explicit, and less prone to typos)Test corrected:With patchWith patch.object


Answer URL
https://docs.python.org/3/library/unittest.mock.html#patch-object
