Natural Text
I have a word docx file that I would like to print the words that are in Bold looking through the document in xml format it seems the words I'm looking to print have the following attribute.Specifically the w:rsidRPr="00510F21" attribute which specifies that the text is bold.  Below is more of the XML document give a better idea of the structure.After doing some research and trying to do this with the Python-docx library I've decided to try using lxml.  I was getting an error about the namespace and tried to add that namespace but it's returning an empty set.  Below is some of the namespace stuff from the document.Below is the code I'm using.  Again I'd like to print if the attribute is w:rsidRPr="00510F21".
If you want to find all the bold text you can use findall() with an xpath expression:Instead of looking for w:r nodes with w:rsidRPr="00510F21" as an attribute (which I am not convinced denotes bolded text), look for run nodes (w:r) with w:b in the run properties tag (w:rPr), and then access the text tag (w:t) within. The w:b tag is the bold property as documented here.The xpath expression can be simplified to './/w:b/../../w:t' although this is less rigorous and might result in false matches.
Consider lxml's xpath() method. Recall .get() retrieves attributes and .find() retrieves nodes. And because the XML has namespaces in attributes, you will need to prefix the URI in the .get() call. Finally, use the .nsmap object to retrieve all namespaces at the root of the document.


Answer URL
https://docs.python.org/3/library/xml.etree.elementtree.html#xpath-support
