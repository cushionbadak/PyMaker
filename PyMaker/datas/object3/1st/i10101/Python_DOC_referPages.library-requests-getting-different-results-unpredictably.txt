Natural Text
Why does this code:produces different results in Python 2 (2.7.12) and Python 3 (3.5.2)? I'm using requests==2.11.1. Since the requests library supports both Python versions with the same API, I guess the result should be the same.The expected result is the one obtained from running the code with Python 2. It works every single time. When ran with Python 3, the server sometimes returns an error, and sometimes it works. (This is the intriguing part.)Since it works with Python 2, I figure the error must happen in the client side. Is there any caveat to how Python 3 handles encoding, or sending the data through the socket, that I should be aware of?EDIT: In the comments below, a person was able to reproduce this and confirms this issue exists.
It does seem to come down to different between dicts in python2 vs python3  in relation to Hash randomization is enabled by default since python3.3 and the server needing at least the cgi field to come first, the following can reproduce:Running the code above using python2:And python3:Passing your dict as posted in python2:And the same dict in python3:And running ~$ export PYTHONHASHSEED=1234 before starting another ipython2 shell:You can run the code numerous times to the same end but definitely  ('cgi', '$ozetweb') coming first is essential for the code to work, it happened to work using python3 intermittently as the order of the keys sometimes put cgi first. There is a bit more on the hashing topic


Answer URL
https://docs.python.org/3/whatsnew/3.3.html#porting-python-code
