Natural Text
I am trying to open an excel file from the web and extract one of the columns.  However, when I try to open the file with xlrd I get an error.  The code I am trying is:however, I am getting a type error:If I download the file manually and open it like:no problems, I would just rather skip the manual step.  Is there an encoding setting or something I am missing?
xlrd.open_workbook() can only open excel files. However, the xlfile object created by xlfile = urlopen(DJIA_URL).read() is not an excel file, so xlbook = xlrd.open_workbook(xlfile) won't open.xlfile created by the above way was an object of class "bytes". The fact can be seen by the commandprint(type(xlfile))and that should give<class 'bytes'>Therefore, you must retrieve the file by(1) adding import urllib.request(2) saving the excel file byurllib.request.urlretrieve(DJIA_URL, r'path\to\file\xxx.xls')(3) finally open it withxlrd.open_workbook(r'path\to\file\xxx.xls')(Tested on python 3.4 eclipse PyDev win7 x64.)


Answer URL
https://docs.python.org/3/library/urllib.request.html?highlight=urlretrieve#legacy-interface
