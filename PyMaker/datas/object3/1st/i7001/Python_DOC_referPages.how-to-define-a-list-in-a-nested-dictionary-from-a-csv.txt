Natural Text
I have a csv that is formated this way, notice there are multiple records at the same time and within that timeframe there are multiple records with the same data4 value:I'm trying to write a function to read this csv into a nested dictionary that uses the Time column and the data4 column to as nested keys.  What I have so far is this:Which returns:It's almost doing what I need but it overwrites the previous row data with Time and data4 are the same.  I'm thinking I need to store data1, data2 and data3 in a list but not sure how to do it.This is what I would like my dictionary to look like so that per time period I can group data by data4 values:
Well, it is classic use case: groupingSo, the more simple is to use itertools.groupby to group your dict by "Time".You get:You can also use a comprehension dictionary:If you need to group with "time" and "data4", you need to change the grouping key:The result is:If you need 2 levels of grouping: first "Time", then "data4", you need 2 loops:The result:
I suggest using the Pandas library since it provides nice ways to read and group CSV files via the Pandas Dataframe.This returns a GroupBy object whereas the key is a tuple of the timestamp and date4 and the value for each group is a new Dataframe containing the matches/values. Now you got three options:Which gives you:You can also use a dictionary that produces a comparable result:Or you iterate over the groups and do whatever you want to do with the rows of each groupWhich gives you the following. You can play around with dropping some of the columns like the index, the timestamp and date4. Hope you got the idea.


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.groupby
