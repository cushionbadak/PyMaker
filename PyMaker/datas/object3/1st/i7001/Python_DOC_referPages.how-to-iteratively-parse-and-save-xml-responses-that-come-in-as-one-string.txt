Natural Text
I am making API calls, that is retrieving IDs, each call represents 10000 IDs and I can only retrieve 10000 at a time. My goal is to save each XML call into a list to count how many people are in the platform automatically. The problem I running into is two fold. Each call comes as response object, the response object when I append to a list appends as a single string, so I can not count total number of IDsTo get the next 10000 list of IDs I have to use another API call to get information about each ID, and retrieve a piece of information called website ID and use that to call the next 10000 from the API in #1I also want to prevent any duplicate IDs in the list but I feel like this is the easiest task. Here is my code:1Call profile IDs (each call brings back 10000)Append response object 'r' into list 'lst'import requests    import xml.etree.ElementTree as et    import pandas as pd    from lxml import etree    import timeAPI Call result2I take the last ID  from API call in #1 and manually input the valueinto the API call below in the 'ID' tags.API call result:I take the website ID and rerun this in API Call from #1 (example) with website ID tag filled, get the next 10000 until no more results come back:Hope my question makes sense, and thank you in advance. 
I once started building something to crawl over an API which sounds similar to what you are aiming to achieve. One difference in my case though was the response came as json instead of xml but shouldn't be a big deal.Can't see in your question evidence that you are really using the power of the xml parser. Have a look at the docs. For example you can easily get the id number out of those items you are appending to the list like this:Experiment, apply it in a loop to each element in the list or maybe you will be lucky and the whole response object will parse without needing to look through things. You should now be able to programmatically instead of manually enter that number in the next bit of code. Your XML for the next section for the website ID seems to have an invalid line in it <Sa.People.Profile.Get> Once I take it out it can be parsed:So not sure if there is always an invalid line there or if you forgot to paste something, maybe remove that line with regex or something before applying xtree. Would recommend you try sqlite to help you with the interactions between 1 and 2. I think it's good up to half a million rows otherwise you would need to hook to a proper database. It saves a file in your directory and has a bit less setup time and fuss as with a proper database. Perhaps, test the concept with sqlite and if necessary migrate to postgresql.You can store whichever useful elements from this parsed xml you like user ID, website ID into a table and pull it out again to use in a different section. Is also not hard to go back and forth from sqlite to pandas dataframes if you need it with pandas.read_sql and pandas.DataFrame.to_sql Hope this helps.. 


Answer URL
https://docs.python.org/3/library/xml.etree.elementtree.html
https://docs.python.org/3/library/xml.etree.elementtree.html#parsing-xml
