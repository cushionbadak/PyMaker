Natural Text
Say I have a class to create Redshift object dependencies.  I want to create a single connection, and then re-use it for many different transactions.  Should I create it in the __init__ function, and then set the self.conn.close() in the __del__ statement to mimic the with or try/finally model?EDIT:Here is what I came up with:
I would recommend avoiding del as a destructor since it's calling pattern is nondeterministic and it is not guaranteed to be called at all.If you want to get a with resource as bounded var behaviour, you can do that by using the contextlib module. this example come from the python docs at: https://docs.python.org/3/library/contextlib.htmlThe disadvantage of this method is that the context of your resource needs to be coded. An alternative is to write a real destructor that will be called when the connections reference counter hits 0. This is pretty similar to your original idea of using __del__ but to avoid the many of the issues with using __del__ directly, use weakref.finalize.


Answer URL
https://docs.python.org/3/library/contextlib.html
https://docs.python.org/3/library/weakref.html#
