Natural Text
I have a numpy array of dimension (i, j) in which I would like to add up the first dimension to receive a array of shape (j,). Normally, I'd use NumPy's own sumbut in my case it doesn't cut it: Some of the sums are very ill-conditioned, so the computed results only have a few correct digits.math.fsum is fantastic at keeping the errors at bay, but it only applies to iterables of one dimension. numpy.vectorize doesn't do the job either.How to efficiently apply math.fsum to an array of multiply dimensions?
This one works fast enough for me.Hopefully it's the axis you are looking for (returns 77 sums).
Check out the signature keyword to vectorize. Unfortunately, it's slower than the for solution:Code to reproduce the plot:


Answer URL
https://docs.python.org/3/library/math.html#math.fsum
