Natural Text
OK, I'm stuck on something seemingly simple. I am trying to convert a number to base 26 (ie. 3 = C, 27 = AA, ect.). I am guessing my problem has to do with not having a 0 in the model? Not sure. But if you run the code, you will see that numbers 52, 104 and especially numbers around 676 are really weird. Can anyone give me a hint as to what I am not seeing? I will appreciate it. (just in case to avoid wasting your time, @ is ascii char 64, A is ascii char 65)So, I found a temporary workaround by making a couple of changes to my function (the 2 if statements in the while loop). My columns are limited to 500 anyways, and the following change to the function seems to do the trick up to x = 676, so I am satisfied. However if any of you find a general solution for any x (may be my code may help), would be pretty cool!
The problematic when converting to Excel’s “base 26” is for Excel, a number AA is actually 26 * 26**1 + 26 * 26**0 while normal base 26 number systems would make a 1 * 26**2 + 1 * 26**1 + 0 * 26**0 out of that. So we cannot use the normal ways here to convert these numbers.Instead, we have to roll our own divmod_excel function:With that, we can create a to_excel function:For the other direction, this is a bit simplerThis set of functions does the right thing:And we can actually confirm that they work correctly opposite of each other by simply checking whether we can chain them to reproduce the original number:


Answer URL
https://docs.python.org/3/library/functions.html#divmod
