Natural Text
I'm experimenting with NaN values and it turns out that sorting tuples containing NaN doesn't work very well.This kinda makes sense, considering that all comparison operations between NaN and NaN should return False, as explained in this question.However, when I change my example slightly, it is suddenly possible to sort the list of tuples.What's going on here? Why is it possible to sort the list in the second example, but not the first one?
Tuple comparison assumes that the </==/> operations on their elements are a valid weak ordering, and it compares elements with PyObject_RichCompareBool, which assumes that x is y implies x == y. When you use the same NaN object for all tuples, PyObject_RichCompareBool thinks the NaNs are equal.


Answer URL
https://docs.python.org/3/c-api/object.html#c.PyObject_RichCompareBool
