Natural Text
I am following this tutorials here where the CopyFile function calling the windows API just dosen't work for me. This is the code I am using (just changed the username)I tried changing the parameters, file path, I tried same file to the same directory changing False to True so that I may get an error or prompt that the file already exists. It just dosen't work. If you haven't worked with Ctypes (like me) and don't know the answer, please try and try this snippet on your machine. 
The 1st thing that I see, is that some backslashes in the paths are not escaped. It won't be a problem in this particular case, but it's better to always escape them.I modified your code a bit (code0.py):Output:Notes:According to [MS.Docs]: CopyFile function:If the function succeeds, the return value is nonzero.I've added CopyFileW in the mixAccording to output, CopyFileA fails with Python 3 (I've figured out that this is your scenario), and CopyFileW fails with Python 2. That happens because in Python 2, strings are 8bit (char * based), while in Python 3 they are Unicode (16bit (wchar_t * based) on Win)Since the ANSI (A) version of a function has some limitations compared to its Wide (W) version, it's recommended to use the latter oneWe have a cause for the failure, but we're not quite there yet. Here's a more elaborate example (code1.py):Notes:Added some string encodingSet the argtypes and restype ([Python 3]: Specifying the required argument types (function prototypes)) for the 2 functions, so that values are properly converted (otherwise they point to 32bit int - which can get messy on 64bit)Output:


Answer URL
https://docs.python.org/3/library/ctypes.html#specifying-the-required-argument-types-function-prototypes
