Natural Text
I have Azure Blobs that need to download and upload(not shown). I do not want to wait for them to complete their process as I have other things that should be done. At some point though, I will need to confirm if they have successfully downloaded or uploaded.With my current code, I have used the threading library. If an error happens in the upload or download process, the thread handling the transaction will exit with an error. I have no way to inform the main thread of completion and the status of the completion. What do I need to do to be able to get the status of get_blob? Is there a another library that has a less dangerous way of handling this situation? I have referenced the following threads but cannot figure out how to combine their different approaches.Catch a thread's exception in the caller thread in Pythonpython multiprocessing pool retriesHow to call a async function contained in a classbackground function in Python
What do I need to do to be able to get the status of get_blob?You can wrap get_blob in a function that will store information about whether it succeeded, and store the return value if any. Instead of target=self.blob_service.get_blob_to_path, you can write target=self._get_blob_background. The new _get_blob_background method can call self.result = self.blob_service.get_blob_to_path and use try and except Exception as e to catch all exceptions and, in case of exception, execute self.result_exception = e, so that the main thread can distinguish the result from the exception.Even better, you can use the concurrent.futures library to do all that for you:Now get_blob() will run in the background, like in your code, but here it will return a Future object that you can query to find out whether the job completed, and how it completed.


Answer URL
https://docs.python.org/3/library/concurrent.futures.html#concurrent.futures.Future
