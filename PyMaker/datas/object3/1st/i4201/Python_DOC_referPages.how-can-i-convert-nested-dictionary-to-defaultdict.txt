Natural Text
How can I convert nested dictionary to nested defaultdict?
You need to either loop or recurse over the nested dictionary, through all of its levels.Unless it's potentially ridiculously deep (as in hundreds of levels), or so wide that small performance factors make a difference, recursion is probably simplest here:Or if you want it to work with all mappings, not just dicts, you could use collections.abc.Mapping instead of dict in your isinstance check.Of course this is assuming you have a pure nested dict. If you've got, say, something you parsed from a typical JSON response, where there might be dicts with list values with dict elements, you have to handle the other possibilities too:But if this actually is coming from JSON, it's probably better to just use your defaultdict as an object_pairs_hook while the JSON is being parsed, rather than parsing it to a dict and then converting it to a defaultdict later.There's an example in the docs of using an OrderedDict in place of dict, but that won't quite work for usâ€”unlike OrderedDict and dict, defaultdict can't just take an iterable of pairs as its only argument; it needs the default value factory first. So we can bind that in, using functools.partial:And so on.


Answer URL
https://docs.python.org/3/library/json.html#json.load
https://docs.python.org/3/library/functools.html#functools.partial
https://docs.python.org/3/library/json.html#encoders-and-decoders
