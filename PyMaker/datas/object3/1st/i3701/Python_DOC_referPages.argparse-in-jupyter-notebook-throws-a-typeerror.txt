Natural Text
Using argparse in a Jupyter Notebook throws a TypeError. The same code works fine if I execute the same code as a script. MWE:Result:
Ipython is running some command-line arguments in the background. This interfers with argparse and optparse.See this bug for Spyder (Ipython IDE), where -f was being added as a command option and crashing as there was no handler for -f.You could try checking the arguments currently in play (as they did for the Spyder bug) and putting a dummy handler in place.Run inside Ipython and see what it outputs.On my system, it gives ['/usr/lib/python3.6/site-packages/ipykernel_launcher.py', '-f', '/run/user/1000/jupyter/kernel-7537e4dd-b5e2-407c-9d4c-7023575cfc7c.json']Argparse assumes the first entry is the program name (sys.argv[0]). In order to fix this, I had to call... and now argparse works in my notebook.
One solution is to parse an empty list of arguments:Another is to use parse_known_args:
When I run your code in a Notebook, I get an argparse usage error message:With a print(sys.argv) I getsys.argv, which parser parses, contains the values used to launch the Notebook server, which this particular parser is not setup to handle.  parser.parse_known_args() displays:That extra stuff that your parser can't handle is put in the extras list.Run with a custom argv list works:It's a good idea to put argparse code (at least the parse_args line) in a __main__ block, so it is not run when the script is imported. It will still run when the script is run as a script.This script also works when using %run stack50763033.py.  You can even give it arguments as you would with a script:I have no idea what code is producing the level keyword error.  You'll have to give us the traceback if you want help with that.


Answer URL
https://docs.python.org/3/library/argparse.html#prog
