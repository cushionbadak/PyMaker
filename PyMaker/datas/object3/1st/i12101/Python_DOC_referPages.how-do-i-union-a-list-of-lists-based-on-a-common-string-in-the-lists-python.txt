Natural Text
I have a list of lists that need to be merged based on strings in the list to fit a structure. In this case, it would be 'date' and 'id' trying to fit the 'fields' structure. Fields: ['date', 'id', 'impressions', 'clicks']Before:After:
In the case that impressions and clicks are not in a consistent order
itertools.groupby can work well here, particularly if the real data matches the sample data (already sorted so date/id pairs are all adjacent):If the data isn't already sorted by date and ID, you'd need to sort the inlist first, inlist.sort(key=itemgetter(0, 1)). That could be expensive if the list is huge, in which case you might consider using a collections.defaultdict instead:
Another way:If you can assume that impressions and clicks are already in order, you can eliminate max and min and replace that line with:


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.groupby
https://docs.python.org/3/library/collections.html#collections.defaultdict
