Natural Text
I have an empty array.I want to assign a value like this: array[key][subkey] = 'value'This produces a KeyError as array[key] does not exist yet.What do I do? I tried the following...TypeError: 'NoneType' object does not support item assignmentI tried:TypeError: list indices must be integers, not strI tried:TypeError: list indices must be integers, not strSo what do I do?
You could use collections.defaultdict, passing the default factory as dict:To apply further levels of nesting, you can create a defaultdict that returns defaultdicts to a n-th depth of nesting, using a function, preferably anonymous, to return the nested default dict(s):Example shows nesting up to depth n=1
You are using a [] list literal not a {} dict literal:But this isn't very useful in a loop.In a loop you could test if 'key' is not in array - which is a cheap operation (O(1) lookup):But you can use setdefault() to do the same thing and give key a default value if it doesn't already have a value, e.g.:And if this looks ugly, then you can always use collection.defaultdict.
I have used this alternative way before (edit: although I preferred Moses Koledoye answer):
You could use a nested defaultdict like this, goes arbitrarily deep automatically:(I indented the output for readability.)Originally saw that from severb.
Can the below codes be used as a different method?


Answer URL
https://docs.python.org/3/library/collections.html#collections.defaultdict
