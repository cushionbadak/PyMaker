Natural Text
I want to use the Python 3 module urllib to access an Elasticsearch database at localhost:9200. My script gets a valid request (generated by Kibana) piped to STDIN in JSON format.Here is what I did:(I understand that my repsonse.read() doesn't make much sense by itself but I just wanted to keep it simple.)When I execute the script, I get anI am very sure that the JSON data I'm piping to the script is correct, since I had it printed and fed it via curl to Elasticsearch, and got back the documents I expected to get back.Any ideas where I went wrong? Am I using urllib correctly? Do I maybe mess up the JSON data in the urlencode line? Am I querying Elasticsearch correctly?Thanks for your help.
With requests you can do one of two things1) Either you create the string representation of the json object yourself and send it off like so:2) Or you have requests do it for you like so:So depending on what actually comes out of the sys.stdin call (probably - as Kibana would be sending that if the target was ElasticSearch - a string representation of a json object == equivalent of doing json.dumps on a dictionary), but you might have to adjust a bit depending on the output of sys.stdin.My guess is that your code could work by just doing so:And if you then want to do some work with it in Python, requests has a built in support for this too. You just call this:Hope this helps you on the right track. For further reading om json.dumps/loads - this answer has some good stuff on it.
For anyone who doesn't want to use requests (for example if you're using IronPython where its not supported):Where 'url' can be something like this (example below is search in index):


Answer URL
https://docs.python.org/3/library/urllib.html
https://docs.python.org/3/library/urllib.request.html#urllib.request.Request
