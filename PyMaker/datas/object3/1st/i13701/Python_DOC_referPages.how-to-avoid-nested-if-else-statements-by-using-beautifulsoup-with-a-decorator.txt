Natural Text
Problem descriptionBecause of the fact that BeautifulSoup is returning a soup object or None, there have to be as much if else statements in a function as subsequent searches via .find or .find_all will occur.QuestionHow can one avoid this by using a decorator (or a similar approach)?ExampleLets say there are two different html sites (with these example snippets):If you doing the search below on snippets everything is ok for the first html snippet, but for the second you will get this:There are two obvious ways to handle this AttributeError:What about a third solution by using a decorator function for that? How can this be done?
Thanks to the comments (nearly a discussion) made by @jonrsharpe and the answer by @Logan I would stick to the decorator idea, but with getting information where the search will return None.Here is my decorator as one possible solution.now I can use
Instead of a decorator and manually checking for None via if/then, you might consider using your own function instead of .find and .find_all. Also, there are 2 issues with returning plain-old None.You have no idea where the error is propagating from, so debugging would be hard.After returning None, you might end up doing something like soup.find_all("a") or link["href"] on what is, in actuality, None. This wouldn't help you at all.So you might try something like this:This 'None' shouldn't have those issues. Also, each instance is created with some identifier of what caused the None. All 'children None' caused by PseudoNone.__call__ or __getitem__ are really just the same object in memory, and thus have the same initial cause of failure in PseudoNone.debug[obj]. Good for debugging!...Omg, this is a PseudoNone! That's not what I wanted. Where did I go wrong!!?Notes:Use isinstance(qux, PseudoNone), not ==None. (We can't subclassNoneType)If PseudoNone.debug gets too large for memory, consider hashing the *args and **kwargs in the values of PseudoNone.debug (and/or making use of @functools.lru_cache in python3)This might be a hack.


Answer URL
https://docs.python.org/3/library/contextlib.html#contextlib.suppress
https://docs.python.org/3/library/contextlib.html#contextlib.suppress
