Natural Text
I have an app written in Electron/Typescript and I need to validate that a user input is a valid Python expression.For example: cos(PARAMPOLY.engineeringValue1) + cos(PARAMPOLY.engineeringValue2)x + y + zI have no way of producing the correct type and value of the operands for these expressions. I need something which parses the expression and tells me if there is an expression error.The Python eval() function parses and evaluates the expression. I need only a parsing.Is there something for that need?
You may want full compilation into a full Python code object, or you can just parse into an abstract syntax tree. You can use the compile() function to achieve either, or just use ast.parse() to produce the tree.Parsing into an AST tokenizes the input and outputs a tree of syntax objects that you can then further analyse or transform. Compiling into bytecode goes one step further, using that AST to create a Python code object that you can optionally execute with either eval() or the exec() function; note that the latter always returns None and is probably not the best choice to evaluate an expression code object.eval(string) uses eval(compile(string, "<stdin>", "eval")) to compile a string argument to a code object, then execute it, so compile(string, "<stdin>", "eval") would give you the same result without execution.Use "eval" as the mode if only an expression is valid, or "exec" if full Python statements are to be accepted. compile() (and ast.parse()) raises a  SyntaxError exception if the input is not a valid Python expression ("eval") or not valid statements ("exec").Demo:Parsing to an AST would let you discover what names the code expects to be able to access; you can collect names by looking for Name nodes:Note that the above ignored context, so the PARAMPONLY attribute name is listed too. Write a ast.NodeVisitor subclass if you need to process a syntax tree with more context.


Answer URL
https://docs.python.org/3/library/functions.html#compile
https://docs.python.org/3/library/ast.html#ast.parse
https://docs.python.org/3/library/functions.html#exec
https://docs.python.org/3/library/ast.html#ast.NodeVisitor
https://docs.python.org/3/library/inspect.html#inspect.signature
