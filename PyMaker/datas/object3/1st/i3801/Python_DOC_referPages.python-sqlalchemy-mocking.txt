Natural Text
this is a method that I made chained DB query calls.I should mock DBSession().query(SomeClass).all(). I tried some but nothing worked. Here are my trials.In this attempt if I try to print DBSession() I get a MagicMock object which seems fine. But when I run pytest I got following error.Seems like I did something wrong while mocking. What is my mistake? I checked the documentation.
You're simply mocking the wrong thing, and asserting that the chain of calls should return an actual list with given items, not a magic mock object. Instead of execute, which would simply mock access to the attribute of the same name, you should be using the return_value, as you've done in the final step. Given the chainyou should be mockingOn the other hand in test_asd() in the assertion you're doingso


Answer URL
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.return_value
