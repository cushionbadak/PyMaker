Natural Text
How do I modify this code to use the url list from the csv, go to those pages, and then execute the last section of the code to retrieve the correct data?I've got the feeling the code section that goes to the csv-stored links and retrieves data from them is way off, but I've got a csv with the urls I'm targeting listed one per row, and the last section of this code that targets the contact details etc is working correctly as well.Snippet of gymsfinal.csv:Changed to writer.writerow([row]) in order to have csv data saved without commas between each letter.
There are a couple of issues here. First of all, you never close your first file object, which is a big no-no. You should be using the with syntax that you use towards the bottom of your code snippet for the reading of the csv as well. You're getting the error requests.exceptions.MissingSchema: Invalid URL 'h': No schema supplied. Perhaps you meant http://h? because when you read the csv in, you're just reading it in as one big string, complete with newlines. So when you iterate over it with for page_data in csvfilelist:, it's iterating through each character in the string (strings are iterable in Python). Obviously that isn't a valid url, so requests throws an exception. When you read your file in, it should look something like thisYou should also change how you return your url(s) from get_page_data(). Currently, you're only going to return the first soup. In order to make it return a generator of all the soups, all you need to do is change that return into a yield. Good resource on yield and generators.You're also going to have a problem with your print statments. they should either go inside a for loop that looks like for soup in pages: or they should go inside get_page_data(). There is no variable soup defined in the context of those prints.


Answer URL
https://docs.python.org/3/library/csv.html
