Natural Text
I have created a document using docx and tried to send as an email attachment without saving the document on the server. Below is my code:I am getting the following error:TypeError: expected bytes-like object, not BytesIOon the line email.send()I tried converting BytesIO to StringIO as mentioned hereand then I get the error:TypeError: expected bytes-like object, not StringIOI looked at the solution from this, but didn't understand how the document is sent as an attachment.Any help or pointers is appreciated.Thanks!
The answer was in the error message.Instead of I didBecause in my code f is a BytesIO object and f.getValue() returns the contents of the object as bytes. Documentation: https://docs.python.org/3/library/io.html#io.BytesIO.getvalue


Answer URL
https://docs.python.org/3/library/io.html#io.BytesIO.getvalue
