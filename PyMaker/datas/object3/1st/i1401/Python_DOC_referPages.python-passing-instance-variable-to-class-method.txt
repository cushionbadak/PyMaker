Natural Text
I am using xlsxwriter and I have created a class where I have created a workbook. Then I have added 2 worksheets to it.Now I have written a method that's writing data to one of the worksheets, but now I would like to use it on both worksheets. This is a simple example to explain the situation:Now I'd like to use the write_data method for both worksheets, so I thought I'd pass the worksheet as a parameter, but unfortunately it's not that simple, as I cannot pass the instance variable self.ws1 or self.ws2.So the question is: how can I do that? I came up with a very nasty solution, like this:but honestly I don't like it. Is there a proper way to do it, or is it like a completely unreasonable thing?
Instead of the if block, better use workbook.get_worksheet_by_name() methodEDIT: or you can use getattr() function, e.g.
I'd do something like this:By using defaultdict, you don't need to explicitly keep a line count variable for each worksheet. The write_data function accepts a new parameter ws so that you can set the worksheet that should be written to. Writing a row can be factored into a separate method to reduce code duplication.Does this answer your question?Edit:a default value cannot access self, but you can work around this quite easily:
Maybe you should consider to have an extra class ExcelWorksheet, in order to put all logic related to them inside:This way, you can refactor your code to this:
With vars(self), you can access any element of the object as a dictionnary.Then vars(self)["ws1"] is like self.ws1 and vars(self)["ws2"] is like self.ws2Then you just have to pass a key argument "ws1" or "ws2" in write_data.


Answer URL
https://docs.python.org/3/library/functions.html#getattr
