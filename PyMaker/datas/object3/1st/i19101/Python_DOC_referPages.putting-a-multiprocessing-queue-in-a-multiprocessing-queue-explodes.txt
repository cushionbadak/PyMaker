Natural Text
The following code throws an exception AND prints 123 in both python 2.7 and 3.3.It's actually some sort of race condition as can be seen here:The full error is RuntimeError: Queue objects should only be shared between processes through inheritance and the traceback doesn't at all explain how/where it happens. The source of the problem is that an object in a Queue can't reference a Queue. My real use case is actually a worker object and a pool object, where a worker reports it finished working to the Pool's Queue. So I wanted the worker to send itself back to the worker Queue.The reason I'm not using Queue.Queue,although multithreading would work well for my case, is because in Python 2.7 there's a bug which makes queue.get() ignore Ctrl-C which is just annoying.Is there a way to do this pattern cleanly?The real problem code is on codepad
I guess there are a couple of ways to do this, but without knowing exactly what it is you wan't to do it's hard to recommend one. I guess the easiest one would be using 2 different queues for this purpose. One for the incoming workers and one fore the finished workers. 
The reason that the traceback isn't showing the problem in your code is that the multiprocessing.Queue class starts a background thread, and the exception is being generated in that thread. I get the following traceback......which I suspect is being initiated by the line......in which you seem to be putting a Pool object containing a Queue object into a Queue, which is not allowed, hence the error.It would help to clarify exactly what you're trying to achieve if you want a useful solution.
What the error is complainig about is this:Here you're trying to put an object which references a Queue into a queue. Queues are used to communicate between processes, and the way this works is by pickling whatever you try to put into it, and unpickling it in the other process - but pickling a Queue is not possible, and doesn't even make sense.That's why when you try to pickle a Queue you get the error you mentioned:If you want to use a Queue to share data between processes, a way is doing it like this:For more examples you should check the docs


Answer URL
