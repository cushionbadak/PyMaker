Natural Text
When I run into unicode printing problems, I want to know what I should check.  In my particular case, I'm using an installed module that is printing unicode encoded characters using the wrong codec.There are several disparate places that affect python encoding and decoding under a variety of circumstances.  And specifically how python handles printable data in different circumstances.Some things off the top of mind:general environment variables LC_ALL, LANGPython sys module setting sys.getdefaultencoding()What else am I forgetting?I'm only interested in python 3.
things to checkHere is what I found, in order of how I recommend checking them:environment variables LC_ALL, LANG, LC_CTYPE, LANGUAGEPython-specific environment  variables PYTHONIOENCODING, PYTHONCOERCECLOCALE(the affect of which may be affected by program argument -E; can check sys.flags.ignore_environment)Windows-specific console encoding PYTHONLEGACYWINDOWSSTDIOPython sys modulefunction sys.getdefaultencoding() (the corollary function sys.setdefaultencoding was removed from Python 3)sys.stdin.encodingsys.stdout.encodingsys.stderr.encodingfile system encoding setting sys.getfilesystemencoding()Python file header -*- coding: utf-8 -*-locale modulefunction call locale.nl_langinfo(locale.CODESET) (does not appear to work on Windows Python 3.7, worked on Debian Python 3.5)function locale.getdefaultlocalefunction locale.getpreferredencoding (works differently on some systems)gettext module and it's various facilities (I won't list them all)contents of the directories passed to some functions like gettext.install(application, directory) or gettext.bindtextdomain(domain, directory)print the valuesHere is quick script to list the values of most of these:printed values on three systemsWindows 10 with 3.7Debian 9 with 3.5Ubuntu 14 with 3.4On Windows 10 using Python 3.7, this printsOn Debian 9 using Python 3.5, this printsOn Ubuntu 14.04 using Python 3.4, this printsUnfortunately, when I run into unicode print problems with installed modules, it is not immediately obvious which setting is affecting that module. Doubly so, understanding how these different possible parameters and settings interact is all the more confounding. There are many combinations of settings to test.But this little bit might help someone get started.Also see helpful answers at SO Question How to set sys.stdout encoding in Python 3?.Related PEPs to reviewPEP 540 -- Add a new UTF-8 Mode (python -X UTF8 ...)PEP 529 -- Change Windows filesystem encoding to UTF-8 (environment variable PYTHONLEGACYWINDOWSFSENCODING)Some help from this pymotw article, python how-to unicode, python sys module, python locale module.


Answer URL
https://docs.python.org/3/howto/unicode.html
https://docs.python.org/3/library/sys.html
https://docs.python.org/3/library/locale.html
