Natural Text
I'm working on a Reddit bot to learn TDD in python. I have a module with a class that is something like this:In my test suite I have a setup method like this:..and  a test like this:It seems like my patch is only partially working. It doesn't actually call the Reddit API which is good. The assertion is always false however. Ideally I could just mock the entire Reddit class and assert the methods are called with expected arguments later. How can I accomplish this? 
You are asking two different things:Why my assert doesn't workHow can I mock entire RedditFor 1 @wim answer is correct and tell to you exactly how to fix it: replace your test line by:assert_* mock's call already raise exceptions when assert fail.To take care of 2 you should patch 'bot.bot.Reddit' instead and take in account that your object will be the return_value of your mock. In this case I strongly recommend to use autospec=True to preserve Reddit complete signature, take a look to Autospeccing to more details.In this case your test become:In this case you should take care of use self.mocked_reddit to check object method and self.mocked_reddit_class to check both static and class methods. Follow a simple example:
assert_called_with is the assertion.  As long as that isn't firing, i.e. raising an AssertionError exception, then you're OK.  You needn't check its return value, which will always be None.


Answer URL
https://docs.python.org/3/library/unittest.mock.html#autospeccing
