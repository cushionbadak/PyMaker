Natural Text
How do I read everything there is from the stdin buffer in python without blocking? None of the stack overflow solutions I found work as my stdin is non-interactive.I tried:tcflushtcflush(sys.stdin, TCIOFLUSH) which does not work on non-interactive stdin.selectandWhich do not work because the condition in the while head is always False.Any other ideas?EditTo be more precise:My code shoulddo nothing if the input buffer is emptyempty the buffer if there is something in itSo it should never block.
You are using a zero seconds timeout in your select() call, which effectively makes select into a one-shot poll operation that does not wait until data is available.Try instead:
Thanks for your suggestions so far. Apparently this was, after all, one of those strange concurrency problems.When I set a timeout in the select call, it works. So it seems that the buffer really has not been filled at the moment I call the select.Does not work (same as in the question):Does work:As the things I want to read are line-based, I can read a whole line at a time with input instead of reading single characters with read though, and then the slowdown of the timeout in the while loop will not be noticeable. (There will be max. 5-10 lines in the buffer).I am not totally satisfied with this solution as it involves waiting for an arbitrary amount of time (will 0.01 always be enough?). But on the other hand I can't think of a better solution right now as I can't influence the code writing to "my stdin".


Answer URL
https://docs.python.org/3/library/select.html
