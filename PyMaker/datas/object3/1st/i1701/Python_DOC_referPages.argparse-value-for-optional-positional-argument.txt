Natural Text
I am trying to create an argparse optional argument that may -OR- may not have an associated input value. I want the following behavior: 1. argument not specified, value=None 2. argument specified with a value, value=user_input 3. argument specified without a value, value=derived from a positional valueThe first 2 are easy. It's the third one I can't figure out. I found 2 posts that do something similar:python argparse optional positional argument with detectable switchThis one sets the default value to a constant for an optional argument without a value.Argparse optional positional arguments?This topic is close, but not quite what I need either (he derives the default value from a system call):I want mine to be a determined from an positional value.Simple example code I created:When I set the input and print:  I get:  If I modify my input to: The resulting output is:  When Value = None, I can't tell if the optional argument was not defined, or was defined but without a value. In the second case, I want to derive the CSV File name from the positional argument (in this example the derived name would be my.csv). I want to do the same when --pnf is defined (where default PNF would be my.pnf for above). Is there a way to do this?
I can't tell if the optional argument was not defined, or was defined but without a valueIf you create your parser like this:Now it is  possible to distinguish between the three cases.  If -c val was passed, it will be present in args with value "val". If -c was passed without value, it will be present in args with value None. If -c was omitted entirely, it won't be present in args.The same goes for -p.
Making use of the const parameter:Your two sample inputs:
For completeness (and future reference), I am posting the modified code required to get arguments when using argument_default=argparse.SUPPRESS. See below:Results in this output:For the second set of inputsOutput looks like this:
This shows the logic I implemented using default=False, const=True, based on earlier comments from @hpaulj.Resulting output looks like this:Modified 'parse_args()' and resulting output:Gives:If I had a lot of variables to check, I would move the if/elif/else logic to a def that returns the desired value.


Answer URL
https://docs.python.org/3/library/argparse.html#argument-default
