Natural Text
NameError: name 'exc' is not definedThis used to work in Python2. Why was it changed this way? If I could at least re-assign to exc, similar to class-level attributesbut this does not make it work either:Any good hints to achieve the same? I'd prefer not to write something like this:
The try statement explictily limits the scope of the bound exception, to prevent circular references causing it to leak. See the try statement documentation:When an exception has been assigned using as target, it is cleared at the end of the except clause.[...]This means the exception must be assigned to a different name to be able to refer to it after the except clause. Exceptions are cleared because with the traceback attached to them, they form a reference cycle with the stack frame, keeping all locals in that frame alive until the next garbage collection occurs.Emphasis mine; note that your only option is to bind the exception to a new name.In Python 2, exceptions did not have a reference to the traceback, which is why this was changed.However, even in Python 2, you are explicitly warned about cleaning up tracebacks, see sys.exc_info():Warning: Assigning the traceback return value to a local variable in a function that is handling an exception will cause a circular reference. This will prevent anything referenced by a local variable in the same function or by the traceback from being garbage collected. Since most functions donâ€™t need access to the traceback, the best solution is to use something like exctype, value = sys.exc_info()[:2] to extract only the exception type and value. If you do need the traceback, make sure to delete it after use (best done with a try ... finally statement) or to call exc_info() in a function that does not itself handle an exception.If you do re-bind the exception, you may want to clear the traceback explicitly:


Answer URL
https://docs.python.org/3/reference/compound_stmts.html#the-try-statement
