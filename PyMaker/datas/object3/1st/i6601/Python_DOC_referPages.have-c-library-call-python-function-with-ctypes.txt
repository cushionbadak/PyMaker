Natural Text
I have a DLL in c and meant for windows platforms which has a structure similar to the following:C StructureI've defined a python ctypes structure to mimic this with the followingPython StructureThe point of this structure in the C code is to register a callback function that gets executed upon certain triggers in its own thread. What I want to be able to do, if possible, is set that callback to be a Python function such that when the function in the C structure gets called from the C code, it is the python function that gets executed.What I've got in python to try and accomplish this (which doesn't work) is the following:The specific error I get (that may not be my only issue) is that it complains that struct.function was expecting a LP_CFunctionType instance but got a CArgObject instance. How can I do what I'm trying to do?
Here's a working example and test DLL source.  Oddly, I couldn't get it to work when the callback was the only member of the struct (crash).  It seemed like a bug, because a callback without a struct wrapper or adding a second member to the struct made it work.Things to note:Use WINFUNCTYPE with __stdcall.  CFUNCTYPE is for __cdecl.You don't need POINTER or byref to make it work.The @CALLBACK decorator is equivalent to func = CALLBACK(func).test.ctest.pyOutput


Answer URL
https://docs.python.org/3/library/ctypes.html#callback-functions
