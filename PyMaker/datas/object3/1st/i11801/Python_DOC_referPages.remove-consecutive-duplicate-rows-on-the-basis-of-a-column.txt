Natural Text
I am struggling with a problem which is explained below. I am sharing incomplete python script also which does not work for this problem. I would be grateful if get support or instruction for my script.my tab delimited file look like this:I my trying to remove the whole rows on the basis of first column (which is + and -) if it duplicates consecutively except the first match. The output should look like:Script:I am unable to compare first column entry with consecutive same column entry.The file is very large so one liner is not working.
if this is not a programming exercise and you just want to clean the data, switch to awk.  It's not even a one-liner.
If I understand correctly, you're basically grouping by clusters of the first symbol (+ or -), and you want to keep only the first.  This is a good use case for itertools.groupby:groupby accepts an iterable (here the input file fp_in) and a key function, which I'm passing as lambda x: x.split("\t")[0], meaning "take the line, split it by tabs, and give me the first element".It yields pairs containing a key (which here will be + or -) and an iterator over all the elements of the group -- in this case, the contiguous groups of lines starting with the same sign.  We select the first with next(group) and write it out. 
This should do the trick:


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.groupby
