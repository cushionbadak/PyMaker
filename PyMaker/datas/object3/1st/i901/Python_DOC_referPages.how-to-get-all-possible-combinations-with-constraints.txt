Natural Text
I need to get all possible 5 combinations from a list with the following constraints:Combinations must include repetitions.The sum of all numbers is equal to 1.Here is my code so far:It seems I am not getting all possible combinations. For instance, the first line of output would be but does not include any of the followingand so on. I also tried different approaches with 
The itertools.product function does output what you want, the problem is in checking the equality of floating numbers, for that you can use math.isclose:
This looks like an interesting case of floating point arithmetic errors resulting in the sum being incorrect. More information can be found in the python documentation.Here's an example of what's going on:A solution would be to check if the sum is within some margin of error of 1:Alternatively, you can round the sum and compare to fix the issue as well, like so:
As the other answers correctly point out, the issue is with floating point comparisons. Tenths don't have finite binary representations unless there are five of them.Since you are interested in a very particular set of numbers, you could map them to integers instead of using round, isclose or abs comparison. That way you could make the comparison exact, then map the results back to the numbers you want.In this case, you can multiply everything by 10 to get integers. For more complicated cases, you might need other factors, entirely different transformation function, or even possibly a lookup table.Couple of other minor improvements:Use sum to add up the elements together instead of writing it out manually. It will make it much easier to add more elements to the sum.Keep comb as a generator instead of turning it into a memory-hogging list unless you need to access it multiple times.


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.product
https://docs.python.org/3/library/math.html#math.isclose
https://docs.python.org/3/tutorial/floatingpoint.html
