Natural Text
I have been working on an issue that requires a Python script to run via the PowerShell command line. The script should pass the command to the command line and save the output. However, I'm running into an issue where some command line arguments are not recognized. If I use the current command with the check_output command, I get an error stating that:If  I just use the "dir" line, the script runs just fine. I'm at odds here as to why this would be happening. This is not the exact script that I'm running, but it produces the same problem on my machine. If I just type the problem command into the command line, it would output "Hello world" onto the new line just as expected. Any insight as to why this would be happening would be greatly appreciated. If it's of relevance, I would like to not use any sort of admin privilege workaround. 
I believe this is because in Windows your default Shell is not PowerShell, you could Execute a Powershell command, calling the executable by executing Powershell with the arguments you need. For Exampleif powershell is not in path you could use the full path for the executableor if it's in path you could use just POWERSHELL_COMMAND = "powershell" as command, becareful, with the backslashed windows paths, to avoid errors you could use raw strings.To verify that you have powershell in path, you could go to the configurations and check, or you could just open a cmd and type powershell and if It works, then you could assume that powershell is in path. From the docs:On Windows with shell=True, the COMSPEC environment variable specifies the default shell.So set COMSPEC=powershell allows to make shell=True use powershell as default instead of cmd


Answer URL
https://docs.python.org/3/library/subprocess.html#converting-argument-sequence
