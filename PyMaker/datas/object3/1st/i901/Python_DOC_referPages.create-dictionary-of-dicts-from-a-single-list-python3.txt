Natural Text
Python 3.6.5/3.7.1 on LinuxStruggling to create a dictionary with dictionaries as values.I want to create a dictionary from a list date & time data (ultimately to create charts with bokeh).This must have been asked before, but I can't find a set of search terms that returns a result that clarifies matters for me.nb I'm essentially a hobby coder, & I don't easily think algorithmically like a real programmer. The data is in a list (max 3200 items):Each item is a record of the occurrence of an event on a date in a clock period of one hour.Thus; ['03/01/19 09:00', '03/01/19 09:00', '03/01/19 09:00',] indicates 3 events between 0900-1000 on 03/01/2019.Only clock periods with events are recorded, so if no event, no timestamp.nb date format is ddmmyyExample data:The desired dictionary would look like this:Clearly I can initialise a dictionary with at least the keys:But then I can't get my head round what I need to do to update the subdicts with the counts, & so can't see a way to get from the original list to the desired dictionary. I'm going round in circles!
I'd suggest the use of collections.defaultdict since some of your counts can be 0.Here's an option:Output (using pprint):If you really want to show the 0 for printing then I don't really see a way around keeping an array of times as I've done here and initializing your dict that way. Output below:
You could combine a Counter with a defaultdict to do this pretty effectively once you have split into a dictionary by date. So first split by date:Now you can easily count the existing items, and use them to initialize a defaultdict that will return zeros for the missing times:The result is:Since the objects here are defaultdicts, you will be able to query dates and times that were not in the original dataset. You can avoid this by converting the result to a regular dict containing only the keys you want after you finish:
One quick and dirty way is this:


Answer URL
https://docs.python.org/3/library/collections.html#collections.Counter
https://docs.python.org/3/library/collections.html#collections.defaultdict
