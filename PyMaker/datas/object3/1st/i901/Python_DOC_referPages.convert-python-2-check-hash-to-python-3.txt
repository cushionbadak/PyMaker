Natural Text
I need to transfer users and their passwords from a python 2 system to a python 3 system.The PW hash looks like this:In the python 2 system I used these functions to check hashes:and this:What have I done so far:Right after copying the code into my python 3 scripts I had to change some variables:izip -> zipI kept unicode: from past.builtins import unicodeI kept xrange: from past.builtins import xrangeNow I had no script errors, but after executing the script I got an error here (in the pbkdf2_bin function):So I fixed it by converting bytes to str:Now the next error appears (in the pbkdf2_bin function):I also fixed this with the proper encoding:Next error:There was an issue with the return value of _pseudorandom (in the pbkdf2_bin function). It had to be converted, so I fixed it:Maybe the issue is hereThe last error is at the end of the check_hash function:char_a is an integer and chat_b is not. I was able to fix this by converting char_a to the real char:Finally I had no errors, but it tells me the entered password is wrong,so somewhere is an error, because I know that the password is correct and it works on the python 2 app.EDITSomeone mentioned the 2to3 library, so I tried it. All in all it has done the same things, which I have done already and the problem is the same.EDIT for bountyTo sum it up. The 2 functions which I posted above come from python 2 and work in python 2. This hash:is this password: Xs12'io!12I can correctly login with this password on my python 2 app.Now I want to use the same two functions in python 3, but eventhough I worked through all errors, it tells me the password is wrong.The imports:These imports are used in the python 2 script.
I think I got it working. I found the original code on github which helped me create a test case. After looking at the issues I followed the solution you came up with and I decoded the bytes to iso-8859-1 instead of utf-8 and it worked.Instead of continuing to finegale this script and maintain it, I'd suggest looking at python3 implementations of this same function. Referenceshttps://wiki.python.org/moin/Python3UnicodeDecodeErrorhttps://github.com/sfstpala/python3-pbkdf2https://www.dlitz.net/software/python-pbkdf2/


Answer URL
https://docs.python.org/3/library/hashlib.html#key-derivation
