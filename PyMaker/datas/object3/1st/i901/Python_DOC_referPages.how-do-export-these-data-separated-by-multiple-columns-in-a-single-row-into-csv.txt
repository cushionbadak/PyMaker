Natural Text
I currently have this data stored as the result variable.I want to export this data into a table either in .csv or .xls format like this:... etc means the remaining data from the above result variable. I didn't write it out here to avoid clutter.So, which modules should I use and how to do it? Please note that, I'm a total Python newbie. I only know some PHP stuff but honestly I'm starting to love py.
The first issue is that you need to know where the split is between the prizes. Without seeing the Special Prize text, this would be difficult. An alternative approach would be to use find_all() to spot just td and th elements. The list comprehension additionally only adds non-empty cells. This will result in a single list containing all the data you need. cols contains a list of the required columns. This is filled manually for the 1st, 2nd and 3rd prizes as these entries should be fixed. A loop is then used to add the corresponding letters and prizes to the last four columns.The Python groupby() function can be used to group lists into sub groups delimited by the elements found in split_on.This would result in a CSV file having the following type of format when loaded into a spreadsheet package:There are quite a lot of Python techniques used here which will take a while to understand. grouper for example is one of the itertools recipes. islice() is a way of iterating over an object without needing to start at the first position.The final output to a CSV file is done using Python's CSV library. This converts lists of rows into correctly formatted output rows. As the data is in column format, a trick is needed to transpose the list into a list of rows, this is done using zip_longest().It would probably help if you add print statements to the code to see what the data looks like.Note, to save the data directly to Excel format (.xlsx) you would need to install another library, for example you could use openpyxl or xlwt.


Answer URL
https://docs.python.org/3/library/itertools.html?highlight=islice#itertools-recipes
