Natural Text
Recently, when creating a loop with a very short wait at the end, I ran into an unexpected behaviour of time.sleep() when used in quick succession.I used this piece of code to look further into my problemThis function usually returns something around 0.0013 which is many many times less accurate than just calling time.sleep() once, upon further inspection of this problem by looking at the waits list, I found that the amount of time time.sleep() was actually sleeping for was either almost exactly the right amount of time or almost exactly double the amount of time. Here is a sample from waits: [0.0010008811950683594, 0.0020041465759277344, 0.0009999275207519531, 0.0019621849060058594, 0.0010418891906738281]Is there any reason for this behaviour and anything that can be done to avoid it?
From the time.time() documentation:Note that even though the time is always returned as a floating point number, not all systems provide time with a better precision than 1 second.The precision is platform dependent. Moreover, it produces wall-clock time, and your process is never the only thing running on a modern OS, other processes also are given time to process and you'll see variation in timings in your own process because of that.The module offers different clocks, with more precision and some are per-process. See the time.get_clock_info() function to see what precision they offer. Note time.process_time() offers per-process time but excludes sleep time.Next, time.sleep() is also not going to sleep in exact time spans; again from the relevant documentation:[T]he suspension time may be longer than requested by an arbitrary amount because of the scheduling of other activity in the system.It too is subject to OS scheduling.Together, these effects can easily add up to the millisecond variation in timings you see in your experiments. So this is not a doubling of time slept; even if you used different values for time.sleep() you'd still see a similar deviation from the requested time.


Answer URL
https://docs.python.org/3/library/time.html#time.time
https://docs.python.org/3/library/time.html#time.get_clock_info
https://docs.python.org/3/library/time.html#time.process_time
https://docs.python.org/3/library/time.html#time.sleep
https://docs.python.org/3/library/time.html#time.sleep
