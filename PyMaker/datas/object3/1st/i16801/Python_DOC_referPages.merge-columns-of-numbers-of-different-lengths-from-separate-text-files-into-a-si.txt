Natural Text
Hi I am fairly new to Python programming and cannot seem to overcome this issue.I have a directory with 100 subfolders with a single text file in each (with no file extension) all named exactly the same. Each file contains a single column of numbers of different lengths.I want to merge all the numbers of each file into a single csv file with the numbers from each file in separate columns.So I should end up with a matrix of 100 columns of differing lengths of numbers where each column corresponds to a single file.Example of files:file1file 2I have this script:However I am getting this error:Does anyone have any idea what is wrong with my code? And can you see any other errors?Thanks!
csv.writerow expects a sequence as an argument. itertools.izip_longest is returning an iterator.  Hence the error message.You should be able to fix the problem with:
Here's a solution that I wrote up before I realized you were using Python 2.7. This will only work as written in Python 3.3+, as it uses the very nifty contextlib.ExitStack context manager, which was only added in that version (I also use Python 3's map):Here's my attempt to port this back to Python 2. I've not tested this version. I use a try/finally pair to handle the closing of the files (and imap to handle the stripping without reading all of each file into memory up front):


Answer URL
https://docs.python.org/3/library/contextlib.html#contextlib.ExitStack
