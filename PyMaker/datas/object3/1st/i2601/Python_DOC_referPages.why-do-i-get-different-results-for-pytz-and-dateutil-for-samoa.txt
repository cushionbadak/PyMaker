Natural Text
I was expecting that the following two would give the same result, but they didn't. Why is that the case?Versions:Example 1: pytzprints 2011-12-29T23:59:00-10:00 (which is correct)Example 2: dateutilprints 2011-12-29T23:59:00+14:00 (which is wrong)
You have discovered a bug in dateutil, which I have now reported and fixed. The bug was caused by an issue with how the "wall time" of transitions were calculated in dateutil, which was making some assumptions that do not hold when a time zone's base offset changes during DST. Expanding your example a bit:You can see that dateutil always calculates the date and time correctly, but when isoformat calls utcoffset, the offset change happens 1 hour early. This is because astimezone calls tzinfo.fromutc under the hood, while isoformat calls utcoffset. dateutil stores the transition times in both UTC and local time, the  UTC times are used in fromutc and the local times are used in utcoffset, dst and tzname. This bug involved over-compensating for DST when calculating the "wall time" of the transition during DST->DST transitions (which are exceedingly rare), which is why it didn't affect astimezone.Bottom line - you are using both pytz and dateutil correctly, and this error will be fixed in the next release.Note: This answer was edited after I found the cause of and fix for the bug.


Answer URL
https://docs.python.org/3/library/datetime.html#datetime.tzinfo.fromutc
https://docs.python.org/3/library/datetime.html#datetime.tzinfo.utcoffset
