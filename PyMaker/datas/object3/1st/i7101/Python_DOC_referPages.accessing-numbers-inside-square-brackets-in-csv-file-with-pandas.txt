Natural Text
Let's say I have this kind of file.How do I access the numbers in the 'helpful' column? I need the numbers separately. Preferably if I can actually store them in helpful_1 and helpful_2 columns. I can do something like this.But to be honest I don't really like this way. I don't think it's the best practice either. It's a pretty large file, by the way (~2GB), so this may not be the best way to do it. Maybe there's better way to access this as dataframe? Any ideas?Also I wonder what square brackets in CSV are considered as. Are they some kind of lists? Or it doesn't mean anything?Thanks.UPDATE: I have answered my question below. But I am still open for some new suggestion as I am not exactly sure of my own solution. If there is a more elegant and efficient solution, I'd really like to know. Also, thanks for everyone who has commented/answered, every help is much appreciated.
EDIT To handle strings:You could do soemthing like this:Output:
I think your solution is really nice, maybe a bit improve is possible - add parameter expand=True to str.split for output as DataFrame, cast to int both columns together:
After some reading, I finally did the following.Basically, I stripped down the square brackets first, and then I split it by a comma, then they are stored into two separate columns.And then because I need them as int not as string, I converted them this way.But I am not exactly satisfied, maybe there are better solutions, but this is all that works for now. I do think that maybe my code still has room for some improvement. If you can think of a more elegant and efficient way, please do tell me. I'm open for all new suggestions.


Answer URL
https://docs.python.org/3/library/csv.html#module-csv
