Natural Text
Hi i new in stackoverflow also on python... I want to make a keyboardbutton(replykeyboardmarkup) that read data from the database and every button on every row of the keyboard to show .   i want to create custom keyboard in telegram.bot For example: We have array of string that get from database..  how we can push data from array to InlineKeyboardMarkup?dynamic, responsive button.  What i can do? thankss
In the Telegram Bot API they didn't mention about how to deal with dynamic InlineKeyboardButton. But there is a way to do this kind of things using CallbackQuery. In the following example assume stringList variable will be hold the database query results, to do this I am using stringList as a Pyton Dictionary with Python 3.7 and pyTelegramBotAPI which is implement for the Telegram Bot API.Let's create buttons according to stringList by importing types from telebot. In here callback_data fulfill with a List which helps us to pass the data from button to query handlers. There is a limitation, if your callback_data is more than 64 bytes Telegram Bot API will generate BUTTON_DATA_INVALID respond. Please refer more about Markup Errors to avoid those kind of exceptions.Below image is the result of above code.I am using this cross icon to show you how to delete dynamic button and how to edit the InlineKeyboardButton with removing that dynamic button. As you can see (above code) there are two CallbackQuery which handle the first button and the cross button.You can capture first button's callback_data in following code lines.There are two print statements to see exactly which type of data that we are going to handle. First print statement shows us the string type List when we click the first button of John.We are almost closer to the solution, but with the string type List. I found a solution to convert string type List into the normal List by referring answers of this question. Python ast(Abstract Syntax Trees) is the module which representation of the abstract syntactic structure of source code. Using ast.literal_eval() we can get the following output from the second print statement.Meantime display this alert as well becasue of answerCallbackQuery which we are using in the above code.We can get output like this because we fill the button with List of values. Likewise you can pass the List inside callback_data and handle that List in callback_query_handler. Let's take a look at what will happens when click the cross icon.It will go to answerCallbackQuery which start with " '[key' " and delete the Pyton Dictionary by using the given key (del stringList[keyFromCallBack]). Let's click first cross icon see what will happen.First button will be disappeared because editMessageText regenerate with available Dictionary details. Instead of deleting Pyton Dictionary you can call some database query.Here is the full code of the above examples.To test this code type /test command in your bot window.
If you are using python-telegram-bot as library you can take a look at the his documentation here Also if you are not using that library, you could adapt that function on your code
If you are using python-telegram-bot, according to this snippets,it should be something like thisNote that I did not check the code. Let me Know if is what you want.


Answer URL
https://docs.python.org/3/tutorial/datastructures.html#dictionaries
https://docs.python.org/3/whatsnew/3.7.html
https://docs.python.org/3/library/ast.html#module-ast
https://docs.python.org/3/tutorial/datastructures.html#dictionaries
https://docs.python.org/3/tutorial/datastructures.html#dictionaries
