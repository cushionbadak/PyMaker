Natural Text
Following Jean's answer to my question on: Python converting strings in a list to numbers , I get a StopIteration exception when running the below minimal code.primes and z2 are empty.From googling I think I may need a while loop around the line in traceback but I'm not sure how to remedy?Traceback:Sample data in CSV file:Minimal Code:
A list comprehension is not a generator or iterator itself. It will not stop when the expression side raises a StopIteration exception. The iterable that for ... in <iterable> loops over can use StopIteration to communicate to the for loop that iteration is done, but that doesn't extend to the rest of the construct.If you need to get at most b number of elements from an iterator, use itertools.islice():It'll take up to b elements when iterated over, or less if there are not enough elements in z2.An earlier revision of the post you linked to tried to pad out the result with 0 values in case there were fewer than b elements by giving next() a default value. I'd have used itertools.repeat() and itertools.chain() to achieve this:The chain(z2, repeat(0)) part will endlessly add 0 values after z2 is exhausted. islice() takes b elements from that sequence.Demo:Note that you can't read from a CSV file twice in a row, not without rewinding the file object first. Your code is using csv.reader(csvfile) in two locations, but the csvfile file object does not go back to the start. Add csvfile.seek(0) before trying to read from it again.


Answer URL
https://docs.python.org/3/library/itertools.html#itertools.islice
https://docs.python.org/3/library/itertools.html#itertools.repeat
https://docs.python.org/3/library/itertools.html#itertools.chain
