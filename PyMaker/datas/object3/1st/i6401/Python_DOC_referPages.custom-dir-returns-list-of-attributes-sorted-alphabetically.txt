Natural Text
I have a custom __dir__ implementation in my base class which is supposed to return a list of all user-defined __slots__ attributes. This is working, in general, but it appears to be doing a sort on the result before it returns, even though I did not program to do that (I need the attributes in order the exact same order they're assigned).An example:The output for slots() and __dir__() should be, imo, identical.but instead, this happens:I can kind of understand that it sorts the output alphabetically, when using dir() - this is documented in the docs. However, it looks like a bug - or at least unexpected behaviour to me- that it sorts the output even though I have defined a custom __dir__ method.The second output simply throws me off my game completely. It suggests that dir also uses some sort of filter, perhaps a set to avoid duplicate outputs, since the code is identical but calling slots() returns duplicate values.I neither A) understand why it does that in the first place, nor B) what on earth dir is doing afterall. Any pointers here?edit:The second case is solved- __mro__ contains the caller's class, as well as all classes it inherits from - therefore that class is included twice. i.e.:edit 2:The plot thickens. The issue referenced in the comments shed a tiny bit more light on the source of this behaviour:This appears to be something originating from the C source code, from before __dir__ was implemented. edit 3:I have opened an issue on python's bug tracker. Let's see what the consensus is. However, I expect this will be put on the backburner (if at all), since dir() is, afaik, primarily designed for inspection in IDLE and such.
As per the issue opened on the Python bug tracker:


Answer URL
https://docs.python.org/3/library/functions.html#dir
