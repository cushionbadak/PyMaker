Natural Text
Suppose a following situation:where all c1, c2, c3 and child_task are operators and have task_id equal to id1, id2, id3 and child_id respectively.Task child_task is also a PythonOperator with provide_context=True and python_callable=dummy_funcIs it possible to retrieve all parents' ids inside the dummy_func(perhaps by browsing the dag somehow using the context)?Expected result in this case would be a list ['id1', 'id2', 'id3'].
The upstream_task_ids and downstream_task_ids properties of BaseOperator are meant just for this purpose.Do note however that with this property, you only get immediate (upstream / downstream) neighbour(s) of a task. In order to get all ancestor or descendent tasks, you can quickly cook-up the good old graph theory approach such as this BFS-like implementationAbove snippet is NOT tested, but I'm sure you can take inspiration from itReferencesGet all Airflow Leaf Nodes/TasksPython QueuePython 3 type-annotations


Answer URL
https://docs.python.org/3/library/queue.html
https://docs.python.org/3/library/typing.html
