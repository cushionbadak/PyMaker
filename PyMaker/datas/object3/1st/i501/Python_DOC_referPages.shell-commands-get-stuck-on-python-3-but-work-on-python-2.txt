Natural Text
The following is my reverse_shell python codeI'm using netcat as a listener.The problem is when I run the above code using python 3.4 shell commands get stuck and I didn't get output but If I use python 2 it works fine.
The default argument for bufsize to Popen changed between Python 2 and Python 3. In Python 2 it is 0 meaning unbuffered. In Python 3 it is -1 which means use a buffer of size io.DEFAULT_BUFFER_SIZE. In Python 3 the program seizes up because the program has written the data to p.stdin, but has not yet flushed it -- as the buffer has not filled up. On Windows, io.DEFAULT_BUFFER_SIZE is 8,192 and so you would need to write 8kB of data to the socket (from netcat) before you would see any output.You can switch back to an unbuffered stream or you can manually flush the data after each write. Or you can set the universal_newlines argument and use line buffering (bufsize=1).


Answer URL
https://docs.python.org/3/library/subprocess.html#popen-constructor
