Natural Text
I want to write a function that is checking if 2 values are satisfied, then perform finding the highest value for the third parameter. For example:myFunction(condition1, condition2, parameter)My data is in a dictionary (can put it Data Frame, don't know what is the best approach. Guess it is dictionary of dictionaries right now). condition1 and condition2 has more than 1 values, e.g., condition1 looks like: {0: ['pizza', 'pasta', 'salad'], 1: ['kebab', 'pasta', 'stew'],...}condition2 looks like: {0: ['italian'], 1: ['american','mexican', 'italian'],...}parameter (rating) looks like: {0:67, 1:56, 2:32,...}, andname looks like: {0:'macys',1:'maze',2:'mcdonalds'...}Basically, I want to find the best restaurant who serves 'pizza' and it is 'italian', and has the highest 'rating' (return the name of the restaurant). Only thing I can get is to show me all the keys that containâ€‹ 'pizza' with this code:but when adding and for the second condition:I get some weird results. Also, I tried with this and it's getting results but based for only one condition: Output:But with: I get: NameError: name 'j' is not definedhow to properly check for other condition and return name instead of the key?
You need to invert your data sets. You have ids pointing to attributes, but are searching for attributes to point you to ids.Build sets from your conditions, so you can intersect these:So now you have dictionaries that have keys like 'pizza' point to a set of ids ({0, 2, ...}). You want to do this once, after initially loading this data, there is no need to repeatedly build these sets.If you were building the condition1 and condition2 dictionaries from another dataset of restaurants, just build the above name-to-set-of-ids mappings instead. The condition* dictionaries are not all that useful for anything else. Picking out matching restaurants is then a set operation, & gives us an intersection for restaurants that match both conditions:then find the restaurant id from the matched ids with the highest rating, and map that one id to a name:This, incidentally, is the kinds of operations that relational databases are absolutely great at. You want to put this information into a SQL database; Python includes the embedded sqlite3 database library, no need to set up a separate server here.You could then run queries likeThat may look a little daunting, but it'll be really really fast and efficient.
You could find keys of food1 and food2 that match your conditions using list comprehension and then return name of restaurant that has highest value in rating.


Answer URL
https://docs.python.org/3/library/stdtypes.html#set
https://docs.python.org/3/library/sqlite3.html
