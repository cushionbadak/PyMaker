Natural Text
I'm trying to convert PHP snippet into Python3 code but outputs of print and echo are different.You can see it in the step 1. Do you know where is the problem? I'm attaching input arrays too but I think they are equal.EDITWhen I switch raw from TRUE to FALSE, outputs of 1st step are the same. $d = strrev(hash("crc32b", $d, FALSE)) . $dBut the problem is that I have to convert PHP to Python, not the opposite because, then I'm usit in the step 2 which I need to have equal output.PHP OUTPUT (CMD)PYTHON OUTPUTPHPPYTHON
Didn't work with PHP. According to [Python 3]: zlib.crc32(data[, value]) (emphasis is mine):Computes a CRC (Cyclic Redundancy Check) checksum of data. The result is an unsigned 32-bit integer.You are making a confusion between:Its value - which can also be seen as an ASCII string of length 4The textual representation of its value (in base 16) - which is a string of length 8Notes:One way to do it is converting each of the number's 4 bytes into a charTo get a byte from the uint32 value, the uint32 must be shifted to the right ([Python.Wiki]: BitwiseOperators) by the order of that byte in the value ([3, 2, 1, 0]) multiplied by 8 (number of bits in a byte)Also, to get rid of the unwanted bytes (any of them except the right-most one), the resulting value is also anded with 0xFF (255)Due to little endianness, the bytes are converted to chars in reversed order (from right to left)The 1st char ('Ã®') looks different, but it's just a matter of representation (in my console vs yours)Integrating it into your code, you need to modify your crc32b function (and also remove any further processing on hashD) to:For more details on this general topic, check [SO]: Python struct.pack() behavior (@CristiFati's answer).@EDIT0:Adding the version that starts from the hex representation:From my PoV, this is uglier, also it's inefficient (many back and forth conversions), but posting anyway as some folks have trouble working on bit operationsThe key point is to handle 2 hex chars at a time, and only reverse after conversion
you just have to remove the 3rd argument of the function hash()if you set this argument to true, hash will return raw binary data and php is trying to parse it as a text string whereas you are expecting a hexadecimal result


Answer URL
https://docs.python.org/3/library/zlib.html#zlib.crc32
