Natural Text
I promise I searched and read several pages of google before I came to make this post. Due diligence has been done I swear.I am trying to open a CSV file in python, read the file, make changes to it, and then write out a new file.I got this far:But I'm struggling to get any further. I want to remove certain columns, but I cannot comprehend how python will know the difference between a row and a column. For example, the columns are Area, Area ID, Year, Value, etc. I only want Area, Year, Value. I tried but I kept getting the following error: IndexError: list index out of range[I would also like to replace blank cells with a *, but the column thing is the priority]Note that I cannot use PandasIf possible I would really appreciate if someone could not just tell me the code but explain it to me so I can figure it out further myself.TLDR: How can I remove empty rows from the CVS file and write only certain columns into the new file? INPUT:
I have tried to provide you an answer as close as possible than what you have done so far.  Prototype:explanations:Before the line csv_writer.writerow(row) where you output the row in the output csv file. I have added the line row = [row[0], row[4], row[5]] where I overwrite the content of the array row by an array containing only 3 cells, those cells are respectively taken from the Area, Year, Value columnsOn top of this, I have added a the if condition if len(row) >= 6: to check that you have at least enough elements in your row to extract the columns until Value.input:output:
This line will not IndexError and will write the line ignoring non existing values:final_file.writerow((row[i] for i in (0,2,5) if i<len(row)))This line will not IndexError and will write the line replacing empty values with a star:final_file.writerow((row[i] if i<len(row) else "*" for i in (0,2,5)))This line will not IndexError either but won't write the line:if len(row)>5: final_file.writerow((row[i] for i in (0,2,5)))This line will not IndexError either but won't write any line at all:pass
You can use a DictReader and DictWriter to selectively modify and write specific columns using their header/column names.I'll use io.StringIO to simulate the filesNote that the DictWriter extrasaction parameter needs to be set to 'ignore' because there are extra keys/fields in the original.If the csv file does not have a header row, you have to specify the field names for the DictWriter.


Answer URL
https://docs.python.org/3/library/csv.html#csv.DictReader
https://docs.python.org/3/library/io.html#io.StringIO
