Natural Text
I have a df in pandasI want to iterate over rows in df. For each row i want rows value and next rows valueSomething like(it does not work):As a result I want At this point i have mess way to solve thisIs there more efficient way to solve this issue? 
Firstly, your "messy way" is ok, there's nothing wrong with using indices into the dataframe, and this will not be too slow. iterrows() itself isn't terribly fast.A version of your first idea that would work would be:The second method could do something similar, to save one index into the dataframe:When speed is critical you can always try both and time the code.
There is a pairwise() function example in the itertools document:Here is the output:But, I think iter rows in a DataFrame is slow, if you can explain what's the problem you want to solve, maybe I can suggest some better method.
This can be solved also by izipping the dataframe (iterator) with an offset version of itself. Of course the indexing error cannot be reproduced this way.Check this outwhich gives
I would use shift() function as follows: which producesThis is how the code above works:Step 1) Use shift function producesstep 2) Transpose:produces: Step 3) Unstack:produces:Step 4) Drop NaN valuesproduces:Step 5) Return a Numpy representation of the DataFrame, and print value by value:produces: 


Answer URL
https://docs.python.org/3/library/itertools.html#itertools-recipes
