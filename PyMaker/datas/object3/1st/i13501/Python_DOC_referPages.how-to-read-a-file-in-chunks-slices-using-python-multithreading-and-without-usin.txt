Natural Text
I am trying to read a file using multiple threads. I want to divide the file into chunks so that each thread could act separately on each chunk which eliminates the need of a lock as the data is not being shared among different threads. How could I possible do this slicing in memory using python ? To explain it further - I would need to read the file beforehand to count the number of lines in the file so that I can decide the chunk size (say chunk size = total number of lines/no of threads). In this case, as soon as the main process reads the first chunk, I would want the threads to start processing those lines in the chunk simultaneously.Could someone provide a sample example? 
There is no way to count the lines in a file without reading it (you could mmap it to allow the virtual memory subsystem to page out data under memory pressure, but you still have to read the whole file in to find the newlines). If chunks are defined as lines, you're stuck; the file must be read in one way or another to do it.If chunks can be fixed size blocks of bytes (which may begin and end in the middle of a line), it's easier, but you need to clarify.Alternatively, if neighboring lines aren't important to one another, instead of chunking, round robin or use a producer/consumer approach (where threads pull new data as it becomes available, rather than distributing by fiat), so the work is naturally distributed evenly.multiprocessing.Pool (or multiprocessing.dummy.Pool if you must use threads instead of processes) makes this easy. For example:will create a pool of worker processes matching the number of cores you have available, and have the main process feed queues that each worker pull lines from for processing, returning the results in a list for the main process to use. If you want to process the results from the workers as they become available (instead of waiting for all results to appear in a list like Pool.map does), you can use Pool.imap or Pool.imap_unordered (depending on whether the results of processing each line should be handled in the same order the lines appear) like so:


Answer URL
https://docs.python.org/3/library/multiprocessing.html#using-a-pool-of-workers
