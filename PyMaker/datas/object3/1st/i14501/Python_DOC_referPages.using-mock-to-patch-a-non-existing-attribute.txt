Natural Text
I'm trying to test a context manager that makes use of a class that uses some __getattr__ magic to resolve several attributes which don't actually exist on the class.  I'm running into a problem where mock is raising an AttributeError when trying to patch the class.Simplified example of objects I want to patch.Test codeHere is the error I get:I'm able to do this and run the test, but it doesn't restore the attribute (or simply remove the mock attribute in this case) automatically:I'm open to using another library besides mock to achieve this.  I'm also using pytest.
To use patch in these kind of tests you should use create parameter that will force to create the attribute if not exist.So your test should do something like this:


Answer URL
https://docs.python.org/3/library/unittest.mock.html#patch
