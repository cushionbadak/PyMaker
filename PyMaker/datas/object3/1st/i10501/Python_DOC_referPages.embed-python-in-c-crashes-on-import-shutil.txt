Natural Text
I have a complete example on embedding python in c++ below.  I compile/link it on Linux against Python 2.7.It takes one parameter (a filename) which is then loaded and executed.All this basically works but if in the code there is:import shutilsThen executing the code fails with a bus error.It seems this is related to the underlying "import collections".The code that I load runs normally when I just execute it as a python script.Has anybody got a hint why the code crashes?  The code is made up from several examples and should just normally work.Here is the C++ code:A Python script that fails is:So when compiling the code and then calling it with a parameter (file containing the python code) it results in a bus error.Compiling the code above as C or C++ gives the same result.  I'm interested in getting it to work with C++.Can anybody at least reproduce the problem?
May be it is related to GIL problem, try this: https://docs.python.org/3/c-api/init.html#non-python-created-threads
I found 2 errors in my code above, one is that app_methods has no end entry that tells python where to stop interpreting the list.The other one is that it is really necessary to call PyType_Ready(&AppType).  I used the code above before and back then (I think with Python 2.6) using PyType_Ready() was creating a bus error.It is also important to use pythonx.y-config --cflags / --ldflags when compiling the code.


Answer URL
https://docs.python.org/3/c-api/init.html#non-python-created-threads
