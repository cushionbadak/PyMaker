Natural Text
Under Powershell v5, Windows 8.1, Python 3. Why these fails and how to fix?prints:
You are piping data into Python; at that point Python's stdin is no longer attached to a TTY (your console) and won't guess at what the encoding might be. Instead, the default system locale is used; on your system that's cp1251 (the Windows Latin-1-based codepage).Set the PYTHONIOENCODING environment variable to override:PYTHONIOENCODING  If this is set before running the interpreter, it overrides the encoding used for stdin/stdout/stderr, in the syntax encodingname:errorhandler. Both the encodingname and the :errorhandler parts are optional and have the same meaning as in str.encode().PowerShell doesn't appear to support per-command-line environment variables the way UNIX shells do; the easiest is to just set the variable first:or evenas the Windows UTF-8 codepage is apparently not quite UTF-8 really, depending on the Windows version and on wether or not pipe redirection is used.
Why not embed CPython in powershell?! CPython is so easy to embed, and powershell is very good REPL to play with .NET and COM objects. Here is a simple introduction to using pythonnet from PowerShell. Note how encoding is automatically propagated from powershell to python. [EDIT]Here is snek package that was released by one of powershell developers for embedding Python in powershell:https://github.com/adamdriscoll/snek


Answer URL
https://docs.python.org/3/using/cmdline.html#envvar-PYTHONIOENCODING
