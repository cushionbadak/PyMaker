Natural Text
It appears that Mock.call_count does not work correctly with threads. For instance:This code produced the following output:Is there a way I can use call_count (or similar) within a multithreaded portion of code? I'd like to avoid having to rewrite MagicMock myself...
I finally made it work by using a counter linked to the side effect method and a lock.Consequently, I'm counting the number of calls of f instead of mock, but the result behaves as expected.


Answer URL
https://docs.python.org/3/library/unittest.mock.html#unittest.mock.Mock.call_count
