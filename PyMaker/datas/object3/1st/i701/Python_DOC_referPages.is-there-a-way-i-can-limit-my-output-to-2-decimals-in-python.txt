Natural Text
I want a to be rounded to 13.95.The round function does not work the way I expected.
You are running into the old problem with floating point numbers that all numbers cannot be represented. The command line is just showing you the full floating point form from memory.In floating point your rounded version is the same number. Since computers are binary, they store floating point numbers as an integer and then divide it by a power of two so 13.95 will be represented in a similar fashion to 125650429603636838/(2**53).Double precision numbers have 53 bits (16 digits) of precision and regular floats have 24 bits (8 digits) of precision. The floating point in Python uses double precision to store the values.For example,If you are after only two decimal places as in currency then you have a couple of better choices: 1) Use integers and store values in cents, not dollars and then divide by 100 to convert to dollars. 2) Or use a fixed point number like decimal.
There are new format specifications, String Format Specification Mini-Language:You can do the same as:Note that the above returns a string. In order to get as float, simply wrap with float(...):Note that wrapping with float() doesn't change anything:
The built-in round() works just fine in Python 2.7 or later.Example:Check out the documentation.
I feel that the simplest approach is to use the format() function.For example:This produces a float number as a string rounded to two decimal points.
Most numbers cannot be exactly represented in floats. If you want to round the number because that's what your mathematical formula or algorithm requires, then you want to use round. If you just want to restrict the display to a certain precision, then don't even use round and just format it as that string. (If you want to display it with some alternate rounding method, and there are tons, then you need to mix the two approaches.)And lastly, though perhaps most importantly, if you want exact math then you don't want floats at all. The usual example is dealing with money and to store 'cents' as an integer.
Useinstead ofBecause the latter may lead to output errors when trying to output multiple variables (see comments).
Try the code below:
With Python < 3 (e.g. 2.6 or 2.7), there are two ways to do so.But note that for Python versions above 3 (e.g. 3.2 or 3.3), option two is preferred.For more information on option two, I suggest this link on string formatting from the Python documentation.And for more information on option one, this link will suffice and has information on the various flags.Reference: Convert floating point number to a certain precision, and then copy to string
You can modify the output format:
TLDR ;)The rounding problem of input / output has been solved definitively by Python 2.7.0 and 3.1.A correctly rounded number can be reversibly converted back and forth:str -> float() -> repr() -> float() ... or Decimal -> float -> str -> DecimalA Decimal type is not necessary for storage anymore.(Naturally, it can be necessary to round a result of addition or subtraction of rounded numbers to eliminate the accumulated last bit errors. An explicit Decimal arithmetic can be still handy, but a conversion to string by str() (that is with rounding to 12 valid digits) is good enough usually if no extreme accuracy or no extreme number of successive arithmetic operations is required.)Infinite test:DocumentationSee the Release notes Python 2.7 - Other Language Changes the fourth paragraph:Conversions between floating-point numbers and strings are now correctly rounded on most platforms. These conversions occur in many different places: str() on floats and complex numbers; the float and complex constructors; numeric formatting; serializing and de-serializing floats and complex numbers using the marshal, pickle and json modules; parsing of float and imaginary literals in Python code; and Decimal-to-float conversion.Related to this, the repr() of a floating-point number x now returns a result based on the shortest decimal string that’s guaranteed to round back to x under correct rounding (with round-half-to-even rounding mode). Previously it gave a string based on rounding x to 17 decimal digits.The related issueMore information: The formatting of float before Python 2.7 was similar to the current numpy.float64. Both types use the same 64 bit IEEE 754 double precision with 52 bit mantissa. A big difference is that np.float64.__repr__ is formatted frequently with an excessive decimal number so that no bit can be lost, but no valid IEEE 754 number exists between 13.949999999999999 and 13.950000000000001. The result is not nice and the conversion repr(float(number_as_string)) is not reversible with numpy. On the other hand: float.__repr__ is formatted so that every digit is important; the sequence is without gaps and the conversion is reversible. Simply: If you perhaps have a numpy.float64 number, convert it to normal float in order to be formatted for humans, not for numeric processors, otherwise nothing more is necessary with Python 2.7+.
In Python 2.7:
The Python tutorial has an appendix called Floating Point Arithmetic: Issues and Limitations. Read it. It explains what is happening and why Python is doing its best. It has even an example that matches yours. Let me quote a bit:you may be tempted to use the round()  function to chop it back to the single  digit you expect. But that makes no  difference:The problem is that the binary  floating-point value stored for “0.1”  was already the best possible binary  approximation to 1/10, so trying to  round it again can’t make it better:  it was already as good as it gets.Another consequence is that since 0.1  is not exactly 1/10, summing ten  values of 0.1 may not yield exactly  1.0, either:One alternative and solution to your problems would be using the decimal module.
Nobody here seems to have mentioned it yet, so let me give an example in Python 3.6's f-string/template-string format, which I think is beautifully neat:It works well with longer examples too, with operators and not needing parens:
It's doing exactly what you told it to do and is working correctly. Read more about floating point confusion and maybe try decimal objects instead.
As @Matt pointed out, Python 3.6 provides f-strings, and they can also use nested parameters:which will display result: 2.35
You can use format operator for rounding the value up to 2 decimal places in python:
For fixing the floating point in type-dynamic languages such as Python and JavaScript, I use this techniqueYou can also use Decimal as following:
14.535562514.54
Results:
To round a number to a resolution, the best way is the following one, which can work with any resolution (0.01 for two decimals or even other steps):
It's simple like 1,2,3:use decimal module for fast correctly-rounded decimal floating point arithmetic:d=Decimal(10000000.0000009)to achieve rounding:will results with Decimal('10000000.00')make above DRY:ORupvote this answer :)PS: critique of others: formatting is not rounding.
The method I use is that of string slicing. It's relatively quick and simple.First, convert the float to a string, the choose the length you would like it to be.In the single line above, we've converted the value to a string, then kept the string only to its first four digits or characters (inclusive).Hope that helps!


Answer URL
https://docs.python.org/3/library/functions.html#round
https://docs.python.org/3/whatsnew/3.6.html#pep-498-formatted-string-literals
https://docs.python.org/3/library/decimal.html
