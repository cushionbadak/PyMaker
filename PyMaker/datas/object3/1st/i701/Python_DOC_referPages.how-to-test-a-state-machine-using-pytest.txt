Natural Text
I am new to testing, and I need to find a way to test a state machine I wrote, similar to this https://code.activestate.com/recipes/577308-simple-state-machine-implementation/ using pytest.The code takes a time series dictionary as input {timestamp: value}, then produces a new dictionary {timestamp: string}.Here is an example of one of the functions that decide the state change:As far as I can tell, the code is working fine, however I don't know how to actually test it properly. I haven't created any classes, the rest of the code is just downloading the input file and then uploading the result to a server.Thanks in advance!
Using global variables isn't good for testing. But, of course, you could always use mock and mock everything in the file. But it's an indicator that something not right with your code.The problem of your function having too many side effects. It's always hard to test functions which not encapsulate data inside and change everything outside of their context.I don't know the context of your app, but try to encapsulate global elements into a class. And try to follow TDD methodology. Start to write tests first defining interfaces. 


Answer URL
https://docs.python.org/3/library/unittest.mock.html
