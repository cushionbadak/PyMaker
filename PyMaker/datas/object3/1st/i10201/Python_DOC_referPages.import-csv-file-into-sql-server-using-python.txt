Natural Text
I am having trouble uploading a CSV file into a table in MS SQL Server, The CSV file has 25 columns and the header has the same name as table in SQL which also has 25 columns. When I run the script it throws an error What is the best way to import this data into MS SQL? Both the CSV and SQL table have the exact same column names. Here is the code:This is what the first rows of the CSV file looks like
You are using csv.reader incorrectly. The first argument to .reader is not the path to the CSV file, it is[an] object which supports the iterator protocol and returns a string each time its __next__() method is called â€” file objects and list objects are both suitable.Hence, according to the example in the documentation, you should be doing something like this:
Try d6tstack which has fast pandas to SQL functionality because it uses native DB import commands. It works for Postgres and MYSQL, MS SQL is experimental. Comment or raise an issue if it doesn't work.It is also useful for importing multiple CSV with data schema changes and/or preprocess with pandas before writing to db, see further down in examples notebook
Check the data types on the table, and the sizes of each field as well.  If it is varchar(10) and your data is 20 characters long, it will throw an error.Also, Consider building the query dynamically to ensure the number of placeholders matches your table and CSV file format. Then it's just a matter of ensuring your table and CSV file are correct, instead of checking that you typed enough ? placeholders in your code.The following example assumesIf column names are not included in the file:Basically, though, your code looks fine.  Here is a generic sample.


Answer URL
https://docs.python.org/3/library/csv.html
