Natural Text
I got this error but I don't what causes it. My python code ran in pyspark. The stacktrace is long and i just show some of them. All the stacktrace doesn't show my code in it so I don't know where to look for. What is possible the cause for this error? Thanks,
The specific exception is caused by trying to store a unicode value in a date datatype that is part of a struct. The conversion of the Python type to Spark internal representation expected to be able to call date.toordinal() method.Presumably you have a dataframe schema somewhere that consists of a struct type with a date field, and something tried to stuff a string into that.You can trace this based on the traceback you do have. The Apache Spark source code is hosted on GitHub, and your traceback points to the pyspark/sql/types.py file. The lines point to the StructField.toInternal() method, which delegates to the self.dataType.toInternal() method:which in your traceback ends up at the DateType.toInternal() method:So we know this is about a date field in a struct. The DateType.fromInternal() shows you what Python type is produced in the opposite direction:It is safe to assume that toInternal() expects the same type when converting in the other direction.


Answer URL
https://docs.python.org/3/library/datetime.html#datetime.date.toordinal
