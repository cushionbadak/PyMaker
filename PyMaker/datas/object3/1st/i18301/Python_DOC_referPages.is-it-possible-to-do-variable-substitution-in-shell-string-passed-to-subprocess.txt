Natural Text
Let's say I have this:How can I substitute grepstring to mystring in the subprocess.Popen call ?
The right thing to do here, if possible, is to not do variable substitution. And, in fact, to not use the shell in the first place. What you really want is to pass grep an argument; the only reason you need to do that through variable substitution is that you're not running grep, you're running a shell and trying to figure out how to get it to run grep for you the way you want.If you just want to do the equivalent of a shell ${grepstring}, you do that with Python's string-processing commandsâ€”ideally str.format, as Martijn Pieters suggests. But that this won't work if, say, grepstring has a space in it. Or special shell characters. Or, worse, it will work, but not the way you want it to (e.g., if grepstring is $(rm -rf /).You can try to write code to sanitize, and then properly quote, all of your strings, but it's a fool's errand. The simple solution is to just not use the shell for anything but the simplest cases (like a literal shell pipeline string). The subprocess docs have a whole section on replacing older functions and shell functions, which includes Replacing shell pipeline.So:Now, you've got a p that acts the same as in your original example, except that grepstring is just a normal argument to Popen, not a string that you have to quote and sanitize and cram into a shell string.If you're doing a lot of this, you can wrap this up pretty easily, or use any of the 69105 libraries on PyPI that do that for you (ranging anywhere from libraries that keep it simple to those that use clever tricks to make your Python pipelines look like bash).
Use string interpolation, like str.format():But do heed the warnings on the subprocess documentation about executing untrusted commands in your shell.


Answer URL
