Natural Text
I have the following string:spf=pass (sender IP is 198.71.245.6) smtp.mailfrom=bounces.em.godaddy.com; domainname.com.au; dkim=pass (signature was verified) header.d=godaddy.com;domainname.com.au; dmarc=pass action=none header.from=godaddy.com;With the following code:    The SPF always matches but the DKIM doesn't:print(dkim) = NoneAccording to the regex testers online it should: https://regex101.com/r/ZkVg74/1 any ideas why it's not i also tried these:dkim = re.match(r"dkim=(\w+)", auth_results)dkim = re.match(r"^.*dkim=(\w+)", auth_results, re.MULTILINE)
. does not match a newline character by default. Since the dkim in your test string is on the second line and your regex pattern tries to match any non-newline character from the beginning of the string with ^.*, it would not find dkim on the second line. You should either use the re.DOTALL flag to allow . to match a newline character:or remove the unnecessary match from the beginning of the string altogether:
First, re.match works from the beginning. so your r"dkim=(\w+)" trial doesn't work.Second, the . symbol matches characters except the new line character. If you want it to, you should explictly force it using re.S or re.DOTALL flag.Also, you can use [\s\S] or [\w\W] to match any characters.Try this:re.match(r"^[\s\S]*dkim=(\w+)", auth_results).group(1)or this:re.match(r"^.*dkim=(\w+)", auth_results, re.DOTALL).group(1)


Answer URL
https://docs.python.org/3/library/re.html#re.Pattern.match
https://docs.python.org/3/library/re.html#re.DOTALL
