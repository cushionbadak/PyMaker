Natural Text
This is an example from the O'Reilly Cookbook (truncated dataset)the output file has a \n at the end of each line, and apparently one more at the end.  When I bring it into Excel, I get blank lines between each row.   The same if I open it with Notepad++.But, if I more if from a command line, the \n don't show up.I saw another Q&A about a \n at the end of a file - but this one is about a \n at the end of each line.   (And I don't see why more doesn't give the \n.)I plan to bring the file into OpenOffice Calc.
This problem occurs only with Python on Windows.In Python v3, you need to add newline='' in the open call per:Python 3.3 CSV.Writer writes extra blank rowsOn Python v2, you need to open the file as binary with "b" in your open() call before passing to csvChanging the line to:will fix the problemMore info about the issue here:CSV in Python adding an extra carriage return
I came across this issue on windows for Python 3. I tried changing newline parameter while opening file and it worked properly with newline=''. Add newline='' to open() method as follows:It will work as charm.Hope it helps.
It's an extra carriage return, and this is a Windows-specific issue not related to Python 2/3 differences. If you open up your file in Notepad++ and enable Show all characters, you'll see the following:This is because Python on Windows is translating your line ending from '\n' to '\r\n', while the writerows() function is already adding '\r\n' to the end of every line. What's happening:csv.writerows() writes the appropriate row of data, and then ends the line with '\r\n'Python's internal handling (because you're on Windows) sees the end of line '\n' and thinks it needs to change that to '\r\n'. So you get the '\r\r\n'.The reason you don't see printing to the console have issues is because it's not detecting the extra '\r' as a new line, where as Excel and Notepad++ are.For Python 3, you should be using the newline='' option as documented here: https://docs.python.org/3/library/csv.html.csv.writer(csvfile, dialect='excel', **fmtparams)Return a writer object responsible for converting the userâ€™s data into delimited strings on the given file-like object. csvfile can be any object with a write() method. If csvfile is a file object, it should be opened with newline='' [1]. 


Answer URL
https://docs.python.org/3/library/functions.html#open
https://docs.python.org/3/library/csv.html
