Natural Text
as I run my client, my server collapse,it says:server:client:what should I do?
The following line in your server blocks until your client connects:After your client connects, your server does this:Then your server does this:That ain't ever going to work. what should I do?Delete this line:Your code has several other problems:1) You have no idea how much of the data that send() will actually send:socket.send(bytes[, flags])  ...  Applications are responsible for checking that all data has been sent;  if only some of the data was transmitted, the application needs to  attempt delivery of the remaining data.  https://docs.python.org/3/library/socket.html#socket.socket.sendIn other words, send() won't necessarily be able to send your entire message in one shot--hence the reason send() returns the number of bytes actually sent.  You can use sendall() to ameliorate that problem.2) However, with both send() and sendall() you have no idea whether your data was sent in 10 chunks, 5 chunks, or all in 1 chunk, so you have to use a loop in order to recv() the entire message:When the other side closes the socket, recv() will return a blank string.3) Now the big one: Your server has to use recv() in a loop to ensure that it reads the entire message from the client:But how is the read loop going to know when it has read all the data?  Note that as written, the loop terminates when the other side closes the socket causing the recv() to return a blank string, which terminates the while loop.  But, in your case the client doesn't close the socket after its send(), so the server's recv() will never return a blank string, and the while loop will continue trying to recv()--yet the client will have finished sending the message and will be waiting for a response.  Deadlock.


Answer URL
https://docs.python.org/3/library/socket.html#socket.socket.send
