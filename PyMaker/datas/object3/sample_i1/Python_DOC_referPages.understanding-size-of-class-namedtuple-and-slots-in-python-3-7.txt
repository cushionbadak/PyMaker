Natural Text
After watching Nina Zahkarenko's Python Memory Management talk at Pycon2016 (link), it seemed like the dunder method __slots__ was a tool to reduce object size and speed up attribute lookup.My expectation was that a normal class would be the largest, while a __slots__/namedtuple approach would save space. However, a quick experiment proved me wrong:Terminal Output:What is going on here? From the docs on Python's Data Model it appears that descriptors are used for __slots__ which would add function overhead to classes implementing it. However, why are the results so heavily skewed towards a normal class?Channeling my inner Raymond H.: there has to be a harder way!
The function sys.getsizeof() is probably not doing what you think it does; it does not work for complex objects, like custom classes.Look at this answer for a method to calculate the memory size of objects; maybe it helps you.I copied the code from that answer in here, but the full explanation is in the answer I linked.
"Channeling my inner Raymond H," +1So the thing about slots is, you have to read about slots.The other thing is, they do affect class size:Cool. Now let's say we add a field to the Rectangle class:So you can "count" the resources "your using" (in the form of instance variables) and the slots rectangle would be 112 and the non-slots rectangle would be 112 as well...However, we know this to not be the case as we would expect the regular rectangle to be at least 352 because we added a dict to it.Slots prevent you from being able to do this and thus provide a way of constraining resource usage.Check out this answer here, it seems like it might work fairly well for you use case. Running it on the slots rectangle and regular rectangle yields 152 and 352 respectively.Also, if you're really into trying to optimize your code and minimize resource use come on over to the rust/c/c++ side of the house. 


Answer URL
https://docs.python.org/3/reference/datamodel.html#special-method-names
https://docs.python.org/3/reference/datamodel.html#slots
