<div class="post-text" itemprop="text">
<p>I am trying to write a set of data to csv file. The file have headers and the header name auto increments against the number of values in output of a that field. For example if I have a Additional Skills column, and there are 17 skills so the header will be like </p>
<pre><code>Additional Skills 1 + Endorsements .... Additional Skills 17 + Endorsements
</code></pre>
<p>Now, when I am writing the data against the field, I am able to write it properly if there are exactly 17 fields. But if there is another set of data, which has let's say 10 fields, it does write in 10 fields, now Considering that there are other columns after the "Additional Skills + Endorsements" for example "School" column, instead of writing "school" data in 'school' column the data gets written in "Additional Skills 11 + Endorsements"</p>
<p>My Code for Adding column field is as follows:</p>
<pre><code>profile_eksills_len = 0
for profile in link_data:
    new_profile_eksills = len(profile["skillsExtended"])
    if new_profile_eksills &gt; profile_eksills_len:
        profile_eksills_len = new_profile_eksills

for i in range(profile_eksills_len):
    profile_header.append("Additional Skills {} + Endorsements".format(i+1))
</code></pre>
<p>Code for writing the CSV file is as follows:</p>
<pre><code>with open("data.csv", "w") as output:
    writer = csv.writer(output, dialect='excel', delimiter='\t', )
    writer.writerow(profile_header)
    # get   job title
    for profile in link_data:
        exp_data = [profile['name'], profile['info'], profile['currentJob'] ]
        for exp in profile["exp"]:
            if exp['jobDesc']:
                exp_data.append(exp['title'] + ":" + exp['comp'] + ":" + exp['jobDesc'])
            else:
                exp_data.append(exp['title'] + ":" + exp['comp'])
        for exp in profile["extras"]:
            exp_data.append(exp['extras'])
        for edu in profile['edu']:
            exp_data.append(edu['school'])
        for skills in profile["skills"]:
            exp_data.append(skills['sets'] + ":" + skills['endorsementCounts'])
        for skill in profile["skillsExtended"]:
            exp_data.append(skill['extsets'] + ":" + skill['endorsedCount'])

        print(exp_data)
        # write data column wise.... 


        writer.writerow(exp_data)   
</code></pre>
<p>I would like to know if there is a way to achieve this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Assuming that you know all your headers in advance, the best approach would be to collect your row data in dictionaries and use <a href="https://docs.python.org/3/library/csv.html#csv.DictWriter" rel="nofollow noreferrer">csv.DictWriter</a> to write to the file.</p>
<p><code>DictWriter</code> will handle missing fields automatically.  By default it will populate them with an empty string, but you can provide an alternative value via DictReader's <em>restval</em> parameter.</p>
<p>The outline code would look like this:</p>
<pre><code>fieldnames = ['heading1', 'heading2', ...]
with open("data.csv", "w") as output:
    writer = csv.DictWriter(output, fieldnames, dialect='excel', delimiter='\t', )
    writer.writeheader()
    # get   job title
    for profile in link_data:
        # Build a dictionary of the fieldnames and values for the row.
        row_data = {'heading1': 'foo', 'heading2': 'bar',...}
        writer.writerow(row_data)  
</code></pre>
</div>
<span class="comment-copy">Thanks @snakecharmerb I have used a different approach, what I did, is i compared the length of header and length of data ... then for difference value, I have appended the value with a "None". would like to know if that's the right approach?</span>
<span class="comment-copy">@himanshupatel sure, that works too.  I'd use <code>DictWriter</code> for this because I don't want to depend on the order of the columns, and don't want to clutter the code with bookkeeping to work out how much each row needs to be padded.  These are important considerations for production quality code, but for a one-off script your approach is ok.</span>
