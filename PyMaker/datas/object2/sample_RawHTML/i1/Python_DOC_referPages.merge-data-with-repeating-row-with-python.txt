<div class="post-text" itemprop="text">
<p>I have found the issue when I try to transform SAS code to python. Supposed I have 2 dataframes, which can be seen below:</p>
<pre><code>df = pd.DataFrame({"monthkey": [1, 2, 3, 4, 5]})
df2 = pd.DataFrame({"name": ['foo','foo','bar']})
</code></pre>
<p>I want the table look like:</p>
<pre><code>monthkey name
1        foo 
2        foo 
3        foo  
4        foo  
5        foo  
1        bar  
2        bar  
3        bar  
4        bar  
5        bar  
</code></pre>
<p>I wrote SAS code below for the reference but how can I use python to create result?</p>
<pre><code>proc sql;
create table want as select a.*,b.*from
df as a left join df2 as b on a.monthkey;
quit;
</code></pre>
<p>Any suggestion on this? Thank you.</p>
</div>
<div class="post-text" itemprop="text">
<p>You also try using <code>from_product</code> in pd.MultiIndex:</p>
<pre><code>pd.DataFrame(index = pd.MultiIndex.from_product([df2['name'].drop_duplicates(),df['monthkey']])).reset_index()
</code></pre>
<p>Output:</p>
<pre><code>  level_0  level_1
0     foo        1
1     foo        2
2     foo        3
3     foo        4
4     foo        5
5     bar        1
6     bar        2
7     bar        3
8     bar        4
9     bar        5
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can try the below</p>
<pre><code>df.assign(foo=1).merge(df2.drop_duplicates().assign(foo=1) ).drop('foo', 1)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>df = pd.DataFrame({'monthkey': (list(range(1, 6)) * 2),
                   'name': ['foo' for i in range(1, 6)] + 
                           ['bar' for i in range(6, 11)]})
</code></pre>
<p>Using ranges to build one DataFrame made it more straight-forward. <a href="https://docs.python.org/3/tutorial/datastructures.html#sets" rel="nofollow noreferrer">Python datastructure documentation</a> contains information regarding this method.</p>
<p>output:</p>
<pre><code>monthkey name
       1  foo
       2  foo
       3  foo
       4  foo
       5  foo
       1  bar
       2  bar
       3  bar
       4  bar
       5  bar
</code></pre>
</div>
<span class="comment-copy">there has to be a monthkey column in df2 i guess..right ?</span>
<span class="comment-copy">@iamklaus no, it doesn't</span>
<span class="comment-copy">Thanks for sharing</span>
<span class="comment-copy">This is work! thanks</span>
<span class="comment-copy">I built separated table and come from other step. In my example, just for illustrative but thank you so much for another solution.</span>
<span class="comment-copy">@SasiwutChaiyadecha you are very welcome!</span>
