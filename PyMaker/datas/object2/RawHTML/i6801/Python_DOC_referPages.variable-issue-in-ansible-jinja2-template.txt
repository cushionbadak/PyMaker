<div class="post-text" itemprop="text">
<p>I am facing issue in creating JSON file (in JINJA2) by using variables in ansible.</p>
<p>Variables</p>
<pre><code>1:    
    abc:
        add1: "1614"
        add2: "1615"
        add3: "1616"
2:    
    deb:
        add5: "1617"
        add6: "1618"
        add7: "1619"
</code></pre>
<p>In JINJA2 Template, I am defining value like</p>
<p><code>value: {{1 | 2}}</code></p>
<p>then formatting is not coming correctly. It should come as </p>
<pre><code>{
  "abc": {
    "add1": "1614",
    "add2": "1615",
    "add3": "1616"
  },
  "deb": {
    "add5": "1617",
    "add6": "1618",
    "add7": "1619"
  }
}
</code></pre>
<p>Any suggestion for JINJA2 declaration?</p>
</div>
<div class="post-text" itemprop="text">
<p>In Jinja2, the bar character ("<code>|</code>") is <a href="http://jinja.pocoo.org/docs/2.9/templates/#other-operators" rel="nofollow noreferrer">used to apply a filter</a>, so in this case, it is trying to apply the filter <code>2</code>, to <code>1</code>, which obviously doesn't make sense!</p>
<p>In this case, I would recommend using Jinja2's <a href="http://jinja.pocoo.org/docs/2.9/templates/#tojson" rel="nofollow noreferrer">builtin tojson filter</a>, which will turn a python object into it's closest JSON equivalent. This is present if you are using a version of Jinja2 greater than 2.9.</p>
<p>Ideally I would pre-process the data so that <code>1</code> and <code>2</code> are in the same dictionary, so you could simply write:</p>
<pre><code>{{ combined | tojson }}
</code></pre>
<p>If this is not an option, you could try the slightly more ugly looking:</p>
<pre><code>{{ dict(1, **2) | tojson }}
</code></pre>
<p>This uses pythons <a href="https://docs.python.org/3/library/stdtypes.html#dict" rel="nofollow noreferrer">dict constructor</a> to merge the two dictionaries.    </p>
<p>EDIT: If you want to pretty-print your json, call the <code>tojson</code> filter with how much of an indent you want, eg. to get 2 space indents use:</p>
<pre><code>{{ data | tojson(2) }}
</code></pre>
</div>
<span class="comment-copy">Thanks for all information. This is working fine.</span>
<span class="comment-copy">Great! If you're happy with this answer please mark it as correct so that other people can find it too. Thanks!</span>
