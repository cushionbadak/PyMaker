<div class="post-text" itemprop="text">
<p>I am trying to create a directory in the home path and re-check if the directory exists in the home path before re-creating using os.path.exists(), but its not working as expected.</p>
<pre><code>if os.access("./", os.W_OK) is not True:
    print("Folder not writable")
    dir_name_tmp = subprocess.Popen('pwd', stdout=subprocess.PIPE, shell=True)
    dir_name_tmp = dir_name_tmp.stdout.read()
    dir_name = dir_name_tmp.split('/')[-1]
    dir_name = dir_name.rstrip()

    os.system('ls ~/')
    print "%s"%dir_name

    if not os.path.exists("~/%s"%(dir_name)):
        print "Going to create a new folder %s in home path\n"%(dir_name)
        os.system('mkdir ~/%s'%(dir_name))
    else:
        print "Folder %s Already Exists\n"%(dir_name)
        os.system('rm -rf ~/%s &amp; mkdir ~/%s'%(dir_name, dir_name))
else :
    print("Folder writable")
</code></pre>
<p>Output for the first time:</p>
<pre><code>Folder not writable
Desktop  Downloads  Perforce  bkp  doc  project
hello.list
Going to create a new folder hello.list in home path
</code></pre>
<p>Output for the 2nd time:</p>
<pre><code>Folder not writable
Desktop  Downloads  Perforce  bkp  doc  hello.list  project
hello.list
Going to create a new folder hello.list in home path

mkdir: cannot create directory `/home/desperado/hello.list': File exists
</code></pre>
<p>Its not going into the else loop though the directory is existing. Am I missing something ? Share in you inputs !</p>
<p>Updated Working Code With Suggestions Provided: Using $HOME directory and os.path.expandusr</p>
<pre><code>if os.access("./", os.W_OK) is not True:
    log.debug("Folder Is Not writable")
    dir_name_tmp = subprocess.Popen('pwd', stdout=subprocess.PIPE, shell=True)
    dir_name_tmp = dir_name_tmp.stdout.read()
    dir_name = dir_name_tmp.split('/')[-1]
    dir_name = dir_name.rstrip()

    log.debug("dir_name is %s"%dir_name)

    dir_name_path = (os.path.expanduser('~/%s'%(dir_name))).rstrip()
    log.debug("dir_name_path is %s"%(dir_name_path))

    # if not os.path.exists('~/%s'%(dir_name)):
    if not os.path.exists('%s'%(dir_name_path)):
        log.debug("Going to create a new folder %s in home path\n"%(dir_name))
        os.system('mkdir $HOME/%s'%(dir_name))
    else:
        log.debug("Folder %s Already Exists\n"%(dir_name))
        os.system('rm -rf %s'%(dir_name_path))
        os.system('mkdir $HOME/%s'%(dir_name))
else :
    log.debug("Folder Is Writable")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The tilde symbol <code>~</code> representing the home directory is a shell convention. It is expanded by the shell in <code>os.system</code>, but it is understood literally in Python.</p>
<p>So you create <code>&lt;HOME&gt;/&lt;DIR&gt;</code>, but test for <code>~/&lt;DIR&gt;</code>.</p>
</div>
<div class="post-text" itemprop="text">
<p>As mentioned by <a href="https://stackoverflow.com/users/5378816/vpfb">VPfB</a>, the tilde symbol is understood literally by Python. To fix this, you need to get your actual home directory.</p>
<p>Now, on different platforms, there are different paths for the home directory.</p>
<p>To get the home directory, <a href="https://docs.python.org/3/library/os.path.html#os.path.expanduser" rel="nofollow noreferrer"><code>os.path.expanduser</code></a> will be useful.</p>
<pre><code>&gt;&gt;&gt; import os
&gt;&gt;&gt; os.path.expanduser("~")
'/Users/ashish'
</code></pre>
</div>
<span class="comment-copy">Don't use <code>x is not True</code> for comparisons. Just use <code>not x</code>.</span>
<span class="comment-copy">You are just passing the <code>dir_name</code> and not the absolute path while checking in <code>os.path.exists()</code>. hence it is returning <code>False</code>. Try passing absolute path of directory while calling <code>os.path.exists()</code>, it should work.</span>
<span class="comment-copy">@KarlKnechtel: Sorry I am not getting it. The issue is in the 2nd if condition i.e. if not os.path.exists("~/%s"%(dir_name)):. I am using if not case only.</span>
<span class="comment-copy">@Tanu: I am indeed passing the absolute path. If you see I am using ~/%s i.e. ~/(Directory Name). I am looking for directory name in the home path, but still it says the directory is not there.</span>
<span class="comment-copy">Python does not expand <code>~</code> automatically. Use <code>os.path.expanduser()</code>.</span>
