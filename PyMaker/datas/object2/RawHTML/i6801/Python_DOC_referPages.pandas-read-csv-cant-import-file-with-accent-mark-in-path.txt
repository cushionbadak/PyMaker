<div class="post-text" itemprop="text">
<p>I am developing an application with Python and a QT GUI.
I need to import a file to a <code>DataFrame</code>. 
I use a <code>QFileDialog.getOpenFileName</code> to get the path and filename to open it with <code>pandas.read_csv</code> method.
Everything works well until I get a path with special characters like "ó". The <code>pandas.read_csv</code> doesn't work and crash the app.</p>
<p>I try to reproduce the error in console and have the following results:</p>
<pre><code>In[2]: import pandas as pd
Backend Qt5Agg is interactive backend. Turning interactive mode on.

In[3]: path1 = 'F:/Software_Proyects/Python/Proyectos/test_read_csv/FlowData.txt'
In[4]: df1 = pd.read_csv(path1, delim_whitespace=True, dtype=object)

In[5]: path2 = 'F:/Software_Proyects/Python/Proyectos/test_read_csv_with_ó/FlowData.txt'
In[6]: df2 = pd.read_csv(path2, delim_whitespace=True, dtype=object)
Traceback (most recent call last):
  File "C:\Program Files (x86)\Anaconda3\lib\site-packages\IPython\core\interactiveshell.py", line 2881, in run_code
    exec(code_obj, self.user_global_ns, self.user_ns)
  File "&lt;ipython-input-6-feba8e024d43&gt;", line 1, in &lt;module&gt;
    df2 = pd.read_csv(path2, delim_whitespace=True, dtype=object)
  File "C:\Program Files (x86)\Anaconda3\lib\site-packages\pandas\io\parsers.py", line 646, in parser_f
    return _read(filepath_or_buffer, kwds)
  File "C:\Program Files (x86)\Anaconda3\lib\site-packages\pandas\io\parsers.py", line 389, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "C:\Program Files (x86)\Anaconda3\lib\site-packages\pandas\io\parsers.py", line 730, in __init__
    self._make_engine(self.engine)
  File "C:\Program Files (x86)\Anaconda3\lib\site-packages\pandas\io\parsers.py", line 923, in _make_engine
    self._engine = CParserWrapper(self.f, **self.options)
  File "C:\Program Files (x86)\Anaconda3\lib\site-packages\pandas\io\parsers.py", line 1390, in __init__
    self._reader = _parser.TextReader(src, **kwds)
  File "pandas\parser.pyx", line 373, in pandas.parser.TextReader.__cinit__ (pandas\parser.c:4184)
  File "pandas\parser.pyx", line 669, in pandas.parser.TextReader._setup_parser_source (pandas\parser.c:8471)
OSError: Initializing from file failed
</code></pre>
<p>the output of <code>show_versions()</code> is:</p>
<pre><code>In[7]: pd.show_versions()

INSTALLED VERSIONS
------------------
commit: None
python: 3.6.0.final.0
python-bits: 32
OS: Windows
OS-release: 10
machine: AMD64
processor: Intel64 Family 6 Model 78 Stepping 3, GenuineIntel
byteorder: little
LC_ALL: None
LANG: None
LOCALE: None.None

pandas: 0.19.2
nose: 1.3.7
pip: 9.0.1
setuptools: 27.2.0
Cython: 0.25.2
numpy: 1.11.3
scipy: 0.18.1
statsmodels: 0.6.1
xarray: None
IPython: 5.1.0
sphinx: 1.5.1
patsy: 0.4.1
dateutil: 2.6.0
pytz: 2016.10
blosc: None
bottleneck: 1.2.0
tables: 3.2.2
numexpr: 2.6.1
matplotlib: 2.0.0
openpyxl: 2.4.1
xlrd: 1.0.0
xlwt: 1.2.0
xlsxwriter: 0.9.6
lxml: 3.7.2
bs4: 4.5.3
html5lib: None
httplib2: None
apiclient: None
sqlalchemy: 1.1.5
pymysql: None
psycopg2: None
jinja2: 2.9.4
boto: 2.45.0
pandas_datareader: None
</code></pre>
<p>As I read in this post <a href="https://stackoverflow.com/questions/24043900/encoding-with-pandas-read-csv-when-file-name-has-accents">Encoding with pandas.read_csv when file name has accents</a> the problem was fixed in pandas 0.14.0. </p>
<p>Any recommendation to solve this problem?</p>
</div>
<div class="post-text" itemprop="text">
<p>Looking in deep, this behavior comes in a combination of Python 3.6 and pandas.read_csv only in Windows systems. </p>
<p>Python 3.6 change Windows filesystem encoding from "mbcs" to "UTF-8". See <a href="https://docs.python.org/3/whatsnew/3.6.html#pep-529-change-windows-filesystem-encoding-to-utf-8" rel="nofollow noreferrer">Python PEP 529</a>. Use <code>sys.getfilesystemencoding()</code> to get the current file system encoding</p>
<p>I get some solutions around this:</p>
<p>1.- Use this code to change all the app to works with the prior Python &lt;= 3.5 encoding ("mbcs")</p>
<pre><code>import sys
sys._enablelegacywindowsfsencoding()
</code></pre>
<p>2.- Pass a file pointer to the pandas.read_csv</p>
<pre><code>with open(path2, 'r') as fp:
    df2 = pd.read_csv(fp, delim_whitespace=True, dtype=object)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>you can try those lines of code in your notebook/ipython  before reading with utf-8 encoding :</p>
<pre><code>import sys
reload(sys)
sys.setdefaultencoding('utf-8')
</code></pre>
<p>and then when reading your file use those line as suggest in the comment </p>
<pre><code>pd.read_csv(path1, delim_whitespace=True, dtype=object,encoding='utf-8')
</code></pre>
</div>
<span class="comment-copy">Try maybe <code>pd.read_csv(path1, delim_whitespace=True, dtype=object,encoding='utf-8')</code> or some other from this list: <a href="https://docs.python.org/3/library/codecs.html#standard-encodings" rel="nofollow noreferrer">docs.python.org/3/library/codecs.html#standard-encodings</a></span>
<span class="comment-copy">you might want to check <a href="https://github.com/pandas-dev/pandas/issues/15086" rel="nofollow noreferrer">this issue</a></span>
<span class="comment-copy">@Protostome, thanks for your response, I tried it but it don't work. I think because the encoding option of read_csv is for file content and not for the path to the file. The file is imported without problem, the problem comes when the path of the file has special characters</span>
<span class="comment-copy">Thanks @MaxU. Your comment point me in the direction to find a solution I will post below.</span>
<span class="comment-copy">Hello @Espoir. I tried this commands but it doesn't work, looking why I found this commands is for Python 2.   In Python 3 the default encoding is 'utf-8' and the setdefaultencoding() method was deleted from sys module.  To use reload(sys) on Python &gt;= 3.4 I follow this example:<a href="https://stackoverflow.com/questions/961162/reloading-module-giving-nameerror-name-reload-is-not-defined" title="reloading module giving nameerror name reload is not defined">stackoverflow.com/questions/961162/…</a></span>
