<div class="post-text" itemprop="text">
<p>So I am trying to write a small encrypted command line IM messenger which accepts two keys as args. I am not sure how the two keys are meant to work together or which is for what. I am trying to use HMAC and AES together but am unsure of how. 
Please note this is for educational purposes only, I do not intend to try to use this anywhere else. I am having a hard time understanding and any advice or explanations would be so greatly appreciated. I have a working IM messenger already up and running, I need only to figure out the HMAC/AES/keys.</p>
<p>Thank you all,
       ~Maddie</p>
</div>
<div class="post-text" itemprop="text">
<p>What you should be doing is using the <em>Encrypt-Then-MAC</em> paradigm. </p>
<p>That means, you are first using the first key to encrypt the message with AES.
Afterwards, you use the second key as an authentication key for the HMAC-SHA256 function to authenticate the <em>ciphertext</em> (the output of the encryption function). Then you concatenate the ciphertext and the HMAC output (called a <em>tag</em>) and transmit it over the wire.</p>
<p>Upon receiving such a message you recalulate the tag from the ciphertext and compare it to the one tranferred. If it is valid, you may decrypt the ciphertext.</p>
<p>Final note: You do not really need to use to seperate keys as an input parameter. If would be fine to just supply one master key and than use that to derive to seperate encryption- and authenctication-keys using a <em>key derivation function</em> like HKDF.</p>
</div>
<span class="comment-copy">There's decent documentation for the <a href="https://docs.python.org/3/library/hmac.html" rel="nofollow noreferrer"><code>hmac</code></a> module. What library are you using for your AES?</span>
<span class="comment-copy">Pycrypto, also yes I have looked at the documentation for hmac its just super (no pun intended) cryptic to me. I'm new at encryption.</span>
