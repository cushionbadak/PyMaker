<div class="post-text" itemprop="text">
<p>How i can get fat32 attributes (like archived, hidden...) in linux without spawning a new process with fatattr utility call ? May be there is python binding for it or for linux/fs functions (fat_ioctl_get_attributes, <a href="http://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/fs/fat/file.c" rel="nofollow">http://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/fs/fat/file.c</a>). Or maybe it can be done with python-xattr ?</p>
</div>
<div class="post-text" itemprop="text">
<p>As you can see in the function name, the kernel function <code>fat_ioctl_get_attributes</code> is called from userspace via an <a href="http://en.wikipedia.org/wiki/Ioctl" rel="nofollow">ioctl</a>, and I'm not aware of any other binding. Therefore, you can simply read the attributes by calling <a href="http://docs.python.org/3/library/fcntl.html#fcntl.ioctl" rel="nofollow"><code>ioctl</code></a> yourself, like this:</p>
<pre><code>import array
import fcntl
import os

FAT_IOCTL_GET_ATTRIBUTES = 0x80047210
FATATTR_BITS = 'rhsvda67'

def get_fat_attrs(fn):
    fd = os.open(fn, os.O_RDONLY)
    try:
        buf = array.array('L', [0])
        try:
            fcntl.ioctl(fd, FAT_IOCTL_GET_ATTRIBUTES, buf, True)
        except IOError as ioe:
            if ioe.errno == 25: # Not a FAT volume
                return None
            else:
                raise

        return buf[0]
    finally:
        os.close(fd)

if __name__ == '__main__':
    import sys
    for fn in sys.argv[1:]:
        attrv = get_fat_attrs(fn)
        if attrv is None:
            print(fn + ': Not on a FAT volume')
            continue
        s = ''.join((fb if (1 &lt;&lt; idx) &amp; attrv else ' ')
                    for idx,fb in enumerate(FATATTR_BITS))
        print(fn + ': ' + s)
</code></pre>
</div>
<span class="comment-copy">Why <code>import sys</code> after you know its the main?</span>
<span class="comment-copy">@Serdalis Because in the next line, this demo program iterates over all <a href="http://docs.python.org/3/library/sys.html#sys.argv" rel="nofollow noreferrer">command-line arguments</a> of the program, and <code>sys</code> isn't needed if this demo program is used as a library.</span>
<span class="comment-copy">I was thinking about this solution, but how did you get function address (FAT_IOCTL_GET_ATTRIBUTES = 0x80047210)? On my distr i got error "Function not implemented".</span>
<span class="comment-copy">@user2260486 That's a strange error, since ioctl numbers are part of the kernel interface and therefore should not change. What output do you get for <code>strace -e ioctl -e raw=ioctl fatattr /</code> after installing strace and fatattr?</span>
<span class="comment-copy"><code>$ uname --a</code> <code>Linux deb7 3.2.0-4-amd64 #1 SMP Debian 3.2.35-2 x86_64 GNU/Linux</code> <code>$ strace -e ioctl -e raw=ioctl fatattr /</code> <code>ioctl(0x3, 0x80047210, 0x7fff9d8d1edc)  = -1 (errno 25)</code> <code>/: Inappropriate ioctl for device</code></span>
