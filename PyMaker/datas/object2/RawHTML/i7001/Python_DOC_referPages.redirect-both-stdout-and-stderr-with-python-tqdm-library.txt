<div class="post-text" itemprop="text">
<p>I'm using tqdm in Python to display console progress bars. </p>
<p>I have a function from another library that occasionally writes to both stdout and stderr inside the tqdm loop. I cannot hack the source code of that function.</p>
<p>While <a href="https://github.com/tqdm/tqdm#redirecting-writing" rel="nofollow noreferrer">this doc</a> shows how to redirect sys.stdout, it doesn't easily generalize to stderr because I can pass only one of stdout or stderr to the <code>file=</code> parameter in tqdm's <code>__init__</code>. Please refer to <a href="https://stackoverflow.com/questions/36986929/redirect-print-command-in-python-script-through-tqdm-write">this question</a> and its <a href="https://stackoverflow.com/a/37243211/3453033">accepted answer</a> for the minimal code that illustrates the problem.</p>
<p>How do I redirect <strong><em>both</em></strong> stdout and stderr together?</p>
</div>
<div class="post-text" itemprop="text">
<p>Python provides some helpers for you in the standard libraries, look in <a href="https://docs.python.org/3/library/contextlib.html" rel="nofollow noreferrer"><code>contextlib</code></a>:</p>
<pre><code>&gt;&gt;&gt; import io, sys
&gt;&gt;&gt; from contextlib import redirect_stdout, redirect_stderr
&gt;&gt;&gt; from tqdm import tqdm
&gt;&gt;&gt; def foo():
...     print('spam to stdout')
...     print('spam to stderr', file=sys.stderr)
...     
&gt;&gt;&gt; out = io.StringIO()
&gt;&gt;&gt; err = io.StringIO()
&gt;&gt;&gt; with redirect_stdout(out), redirect_stderr(err):
...     for x in tqdm(range(3), file=sys.__stdout__):
...         print(x)  # more spam
...         foo()
...         
100%|██████████| 3/3 [00:00&lt;00:00, 29330.80it/s]
&gt;&gt;&gt; out.getvalue()
'0\nspam to stdout\n1\nspam to stdout\n2\nspam to stdout\n'
&gt;&gt;&gt; err.getvalue()
'spam to stderr\nspam to stderr\nspam to stderr\n'
</code></pre>
</div>
<span class="comment-copy">Thanks for your answer, but it doesn't work this easily at all. If you look at the example links I posted, you'll see that tqdm interacts with sys.stdout/stderr in a very sophisticated way.</span>
<span class="comment-copy">In that case, could you please produce an <a href="https://stackoverflow.com/help/mcve">MCVE</a>.</span>
<span class="comment-copy">The MCVE is in <a href="https://stackoverflow.com/questions/36986929/redirect-print-command-in-python-script-through-tqdm-write">this question</a> I linked. It also contains a solution on how to redirect stdout, which works well in my experiment. All I want is to redirect both out and err with that code.</span>
<span class="comment-copy">The answer you linked just looks like a bad way of doing what I've shown above, except for stdout only.  The contextlib redirects works for me, capturing everything from <code>tqdm</code> correctly.  If it doesn't work for you, please describe how (i.e., you still need an MCVE).</span>
<span class="comment-copy">No, as I said, it's not a simple redirection. You can't just save stdout/stderr at the beginning and restore them at the end. Tqdm is doing a lot under the hood. The answer I linked is also in the <a href="https://github.com/tqdm/tqdm#redirecting-writing" rel="nofollow noreferrer">official tqdm doc</a>. Your solution captures everything in strings, which is not what a progress bar is meant to be.</span>
