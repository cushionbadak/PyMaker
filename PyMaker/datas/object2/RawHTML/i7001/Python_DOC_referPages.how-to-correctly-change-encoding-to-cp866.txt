<div class="post-text" itemprop="text">
<p>I'm trying to print UTF-8 and cp866 process output.</p>
<p>My code:  </p>
<pre><code>if "sendcmd " in message.text:
    command = message.text.replace("sendcmd ", "")
    process = os.popen(command)
    answer = process.read()
    #print(answer.decode('utf-8').encode('cp866'))
    by = bytes(answer, 'utf-8')
    print(type(by))
    print(repr(by))
    process.close()
</code></pre>
<p>after this I get that:</p>
<pre><code>&lt;class 'bytes'&gt;
b'b\'\\xe2\\x80\\x9c\\xd0\\xb1\\xd0\\x87\\xd2\\x90\\xd0\\xb5: \\xd0\\x8b\\xd0\\xb2\\xd0\\x87\\xd0\\xb0\\xc2\\xa0\\xd1\\x9e\\xc2\\xab\\xd2\\x90\\xc2\\xad \\xd0\\xb1\\xd0\\x81\\xd0\\x88\\xc2\\xad\\xc2\\xa0\\xc2\\xab \\xc2\\xa7\\xc2\\xa0\\xd1\\x9e\\xd2\\x90\\xd0\\xb0\\xd0\\xb8\\xd2\\x90\\xc2\\xad\\xd0\\x81\\xd0\\xbf \\xd0\\x87\\xd0\\xb0\\xc2\\xae\\xd0\\xb6\\xd2\\x90\\xd0\\xb1\\xd0\\xb1\\xd0\\xb3 "whatever.exe" \\xd0\\xb1 \\xd0\\x81\\xc2\\xa4\\xd2\\x90\\xc2\\xad\\xd0\\xb2\\xd0\\x81\\xd0\\xb4\\xd0\\x81\\xd0\\x84\\xc2\\xa0\\xd0\\xb2\\xc2\\xae\\xd0\\xb0\\xc2\\xae\\xc2\\xac 3720.\\n\'
</code></pre>
<p>I understand that I need to change encoding to cp866, but I don't understand how to implement it =(</p>
<p>Update: And this code didn't help:</p>
<pre><code>uni = type(by), repr(by)
print(uni.encode('ascii', 'ignore'))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><code>os.popen</code> 's <code>read</code> method returns <code>str</code>, the the output from the process is automatically decoded. <code>subprocess.Popen</code> is similar to <code>os.popen</code> and can be customized ; it returns raw <code>bytes</code> instead of <code>str</code> text: </p>
<pre><code>from subprocess import Popen, PIPE

if "sendcmd " in message.text:
    ...
    process = Popen(command, stdout=PIPE)
    answer = process.communicate()[0]          # (stdout, stderr)
    print(answer.decode('cp866'))
</code></pre>
<p>Internally, <code>os.popen</code> uses the <code>subprocess</code> module, you might need to slightly change the <code>command</code> argument. Check <code>Popen</code> 's <a href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen" rel="nofollow noreferrer">documentation</a>. </p>
</div>
<span class="comment-copy">wjandrea, thank you!</span>
<span class="comment-copy">Thank you, for your fast and correct answer!</span>
<span class="comment-copy">@InsendioFX You welcome :)</span>
