<div class="post-text" itemprop="text">
<p>There is a command in DBM module to delete the value stored at a key.</p>
<pre><code>del d[key]      # delete data stored at key (raises KeyError   # if no such key)
</code></pre>
<p>But I cannot even iterate with this command, because the Runtime error occurs.(RuntimeError: dictionary changed size during iteration.)</p>
<pre><code>import dbm
db=dbm.open("file.db","c")
for key in db:
    del db[key]
print(len(db))
db.close()
</code></pre>
<p>Is there an efficient way to empty DMB file at once?
I am using Python 3.3</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>for key in list(db):
    del db[key]
</code></pre>
<p>should work.</p>
<p><strong>EDIT:</strong> If the goal is just to empty the database completely, you can also close the database and re-open it with <code>dbm.open('filename', 'n')</code>.  The <code>'n'</code> flag means "Always create a new, empty database, open for reading and writing"; it seems to override any previously-existing file.</p>
</div>
<span class="comment-copy">Thank you it works! Are there any solutions without iteration? Deleting files with OS.REMOVE is also an option, but DMB created 2 files. Aren't there a smart way like a DBM.CLEAR() or something?</span>
<span class="comment-copy">Edited my answer.</span>
<span class="comment-copy">I have tried it with "n" flag, but it does not override the file.      &gt;&gt;&gt; db=dbm.open("db","c")         &gt;&gt;&gt; db["line"]=("somedata")        &gt;&gt;&gt; db.close()         &gt;&gt;&gt; db=dbm.open("db","n")       &gt;&gt;&gt; data=db["line"]        &gt;&gt;&gt; print(data)          b'somedata'       &gt;&gt;&gt; db.close()</span>
<span class="comment-copy">Strange, it does for me (Python 2.7.3 on 32-bit Linux).</span>
<span class="comment-copy">Ah, found it.  It's really buried in the docs :-(  On Windows, it will use this: <a href="http://docs.python.org/3/library/dbm.html#module-dbm.dumb" rel="nofollow noreferrer">docs.python.org/3/library/dbm.html#module-dbm.dumb</a> which documents its flag as ignored.  I'd still file a bug report if I were you, saying that either the docs at <a href="http://docs.python.org/3/library/dbm.html#dbm.open" rel="nofollow noreferrer">docs.python.org/3/library/dbm.html#dbm.open</a> should include a warning, or dumbdbm should be fixed.</span>
