<div class="post-text" itemprop="text">
<p>I want to run a python script, which expects cl arguments, before the actual build, so I added the following piece in .gitlab-ci.yml:</p>
<pre><code>.deploy_template: &amp;template_name
  variables:
  - arg1: "https://some/url/"
  - arg2: "https://another/url/"
  - arg3: "https://one/more/url/"
  script:
  - python3 some/script/file.py $arg1 $arg2 $arg3
</code></pre>
<p>but I am getting the following error:</p>
<pre><code>usage: file.py [-h] arg1 arg2 arg3

file.py: error: the following arguments are required: arg1 arg2 arg3
</code></pre>
<p>If the arguments are just strings (i.e. not variables), then it works fine, but it does not read the variables <code>$arg1</code> etc.</p>
<p>In the gitlab docs it is mentioned, that I can use the bash syntax to supply variables, so <code>$arg1</code> must the correct reference.</p>
<p>I use <a href="https://docs.python.org/3/library/argparse.html" rel="nofollow noreferrer">argparse</a> in the script to get the cl arguments.</p>
<p>What is the correct way to call the variables in gitlab-ci.yml as the python script arguments?</p>
</div>
<div class="post-text" itemprop="text">
<p>Your <em>variables</em> is a list, but it requires a dictionary. Just remove the <code>-</code> from it.</p>
<pre><code>.deploy_template: &amp;template_name
  variables:
    arg1: "https://some/url/"
    arg2: "https://another/url/"
    arg3: "https://one/more/url/"
  script:
  - python3 some/script/file.py $arg1 $arg2 $arg3
</code></pre>
<p><a href="http://docs.ansible.com/ansible/latest/YAMLSyntax.html" rel="nofollow noreferrer">More about yaml syntax</a></p>
</div>
