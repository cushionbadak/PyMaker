<div class="post-text" itemprop="text">
<p>I have captured some packages with wireshark and i want to resend them with my own software, written in python. I am using socket programming but I'm new to python so maybe this is a stupid question.</p>
<p>My software is doing its 3-way handshake as it should, and sends a packet with my information. But the thing is, it is not the right information it sends. </p>
<p>This is what I do:</p>
<pre><code>MESSAGE = 0x13EC
s.send(MESSAGE)
</code></pre>
<p>I want the packet to contain the hex value 13EC, but it is sending it as a string right now, like "0x13EC". If I put it like this...</p>
<pre><code>MESSAGE = '13EC'
</code></pre>
<p>...it's  just sending zeros. </p>
<p>Can somebody please tell me what I am doing wrong?</p>
<p>Thanks in advance,</p>
<p>Bartel</p>
<p>BTW, I am using python 3.6.2.</p>
</div>
<div class="post-text" itemprop="text">
<p>When writing <code>MESSAGE = 0x13EC</code> you're essentially creating a integer with the value of 5100. But the socket can't send integers (to my knowledge).</p>
<p>Instead what you want to do is send byte data in the shape of <code>\x13</code> and <code>\xEC</code>.<br/>
To do this, you can simply do:</p>
<pre><code>MESSAGE = b'\x13\xEC'
s.send(MESSAGE)
</code></pre>
<p>And that should do it.<br/>
Or you can use <a href="https://docs.python.org/3/library/struct.html" rel="nofollow noreferrer">struct</a> to pack the data.</p>
<pre><code>from struct import pack
VALUE = 0x13EC # 5100
MESSAGE = pack('H', VALUE) # 5100 -&gt; b'\x13\xEC'
s.send(MESSAGE) # b'\x13\xEC'
</code></pre>
</div>
<span class="comment-copy">thanks a lot, did the job for at least a big part! But I have just one orther problem now, if I put a lot of data in it, the bits are shifted or in any other way different than expected. Is there a limit on how much data you can put in it?</span>
<span class="comment-copy">@gamma_spec by <code>it</code> you mean <code>pack()</code>? If so, yes you need to combine multiple <code>pack('H', 5100) + pack('Q', 5)</code> for instance.</span>
