<div class="post-text" itemprop="text">
<p>I have a text file I am reading in from, and I create two variables called <code>ppm</code> and <code>peakAvg</code>. <code>peakAvg</code> is a variable that I want to reuse, it is defined in a loop. This is my code: </p>
<pre><code>df2 = pd.read_table(expAtoms,delimiter = " ", header = None)
df2.rename(columns={0:"atom",1:"value"}, inplace=True)
df2.groupby('atom').value.mean()

for atom in df2.atom.unique():
    ppm = df2.where(df2.atom==atom).value.dropna()
    peakAvg = ppm.mean()
    getQMulti(ppm,peakAvg,errorLim)
</code></pre>
<p>The way I get peakAvg is by reading in from a text file, grabbing certain values (which is what <code>ppm</code> is). From those values, I group them by name (which is what <code>atom</code> is). However, <code>peakAvg</code> is generated by taking all the ppm values (which are numbers) and taking their average by their group (<code>atom</code>)</p>
<p>The variable <code>peakAvg</code> looks like this (i.e.: if i printed the values of <code>peakAvg</code> it would look like this):  (This is just a snippet but the last number is the actual last number in the list)</p>
<pre><code>5.14823 
7.70533666667
5.69855333333
7.5981
5.79998333333
8.09575666667
7.4699025
7.60002
</code></pre>
<p>In the loop above, I call my function <code>getQMulti</code>
I want to use my variable, <code>peakAvg</code>, for another function I created called <code>getQPred</code>. This is what my second loop (where I call <code>getQPred</code>) looks like: </p>
<pre><code>for atom2 in df3.atom2.unique():
    ppm2=df3.where(df3.atom2==atom2).value2.dropna()
    getQPred(ppm2,peakAvg)
</code></pre>
<p>Now if I print out what <code>peakAvg</code> is, I just get a list of one number (this is just a snippet but the whole list is just this number):</p>
<pre><code>7.60002
7.60002
7.60002
7.60002
7.60002
7.60002
7.60002
7.60002
</code></pre>
<p>How can I get my <code>peakAvg</code> variable to be what it was before (i.e.: the first list of numbers I had) because now when I call my function <code>getQPred</code> I get inaccurate results. </p>
<p>Edit: These are the functions I am using:</p>
<pre><code>SQRT2 = math.sqrt(2.0)
ERRMUL=2.0

errorLim = 0.3
sigma = 0.5

def getQ(x):
    q = np.log(1.0-erf(np.absolute(x)/SQRT2))
    return q
def getQMulti(ppm,peakAvg,errorLim):
    x=(ppm-peakAvg)/errorLim
    q= getQ(x)
    x0 = 2.0
    q0 = getQ(x0)
    QMulti = 1.0+(q/np.absolute(q0))   
    return QMulti
def getQPred(ppm,peakAvg):
    x = (ppm-peakAvg)/sigma
    q = getQ(x)
    x0 = 1.5
    q0 = getQ(x0)
    QPred = 1.0+(q/np.absolute(q0))
    return QPred
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>In your code, <code>peakAvg</code> <em>isn't</em> a list, it's a single value that gets changed each time through the loop. </p>
<p>The way to do this is something like the following:</p>
<pre><code>peakAvg_list = []
for something in whatever:
    do_something_with_ppm
    peakAvg = ppm.mean()
    peakAvg_list.append(peakAvg)
    do_something_with_peakAvg 
</code></pre>
<p>That is, first initialise <code>peakAvg_List</code> to an empty list, and then, each time through the list, <code>append</code> the new value of <code>peakAvg</code> to the list. This way, <code>peakAvg_list</code> contains the whole list of things that you want, which you can <code>return</code> if you want.</p>
<p>If you want do something further with the list, you can do another loop:</p>
<pre><code>for peakAvg in peakAvg_List:
    x = (ppm - peakAvg)/sigma
    ### do something with x
</code></pre>
<p>But you need to figure out what the ultimate output/goal of this code should be. Do you want a list of all the <code>QPred</code> quantities that you are calculating? Or do you somehow need to collect them into a single number? The answers here depend on what you're actually trying to do, which is separate from the Python syntax...</p>
<p>Also, given that you are interested in doing the same operation on all the elements of various lists, you should learn about <a href="http://www.numpy.org" rel="nofollow noreferrer">numpy</a>. (More generally, you probably need to learn about lists and looping in Python, which are pretty basic concepts, so you might want to start with something like the official <a href="https://docs.python.org/3/tutorial/" rel="nofollow noreferrer">Python tutorial</a>.</p>
</div>
<span class="comment-copy">Post the functions getQMulti and getQPred. One of thems seems change the peakAvg value.</span>
<span class="comment-copy">what is the relationship between the first loop and second loop? The second loop only have the last value of peakAvg, since your fist loop overwrite peakAvg  every time.</span>
<span class="comment-copy">There shouldn't be any relationship between them, I just posted both my functions (but they require a third function called <code>getQ(x)</code>, I posted that as well</span>
<span class="comment-copy">You say there shouldn't be any relationship between your loops, but then you want to use one value in the other, so which is it? How are you suppose to know <b>which value</b> from the first loop you use in the second loop?</span>
<span class="comment-copy">Oh, well I first call my <code>getQMulti</code> function, so I want the same list of values I get for <code>peakAvg</code> when I call <code>getQMulti</code> and I want to use them again for when I call my second function <code>getQPred</code></span>
<span class="comment-copy">Thank you! So I created and initialized peakAvg_list and now I have a list for all the <code>peakAvg</code> i have. but in my function for <code>getQPred</code> I have <code>x = (ppm-peakAvg)/sigma</code>. How can I run through each value of <code>peakAvg</code> that is in my list?</span>
