<div class="post-text" itemprop="text">
<p>I am stuck on my current project as i am getting an "not a valid choice" error message in chained dropdown scenario.  I have 2 dropdown fields region and area, but get error message ONLY on the field.  regardless if fields were selected or with default options.  Thanks in advance</p>
<p>I have defined the class as such:</p>
<pre><code>class RegistrationDDForm(FlaskForm):
    region = SelectField(u'Region', choices=(), coerce=int)
    area = SelectField(u'Area', choices=(),coerce=int)
    submit = SubmitField('Sign Up')
</code></pre>
<p>my route and function is defined below:</p>
<pre><code>@users.route("/finish_registration", methods=['GET', 'POST'])
def finish_registration():
    cur = mysql.connection.cursor()
    result1 = cur.execute("select * from region")
    results = cur.fetchall()

    form = RegistrationDDForm(request.form)
    form.region.choices = [('0', 'Select Region')] + 
        [(x['region_id'], x['region']) for x in results]

    if form.validate_on_submit():
        # Eventually add data to database table
        pass

    return render_template('finish_registration.html', title='Register', form=form)

@users.route("/finish_registration/&lt;int:region_id&gt;/", methods=["GET"])
def get_request(region_id):

    cur = mysql.connection.cursor()
    results = cur.execute("select * from area where region_id=%s", region_id])
    results = cur.fetchall()

    data = [('0', 'Select Area')] + 
        [(x['area_id'], x['area']) for x in results
        if x['region_id'] == region_id]

    response = make_response(json.dumps(data))
    response.content_type = 'application/json'
    return response
</code></pre>
<p>My javascript function:</p>
<pre><code>$(function() {
  // disable refresh button
  $("#refresh-btn").prop("disabled", true)
  $("#area_select").show();

  $("#region_select").change(function() {
    var region_id = $("#region_select").val();
    var get_request = $.ajax({
      type: 'GET',
      url: '/finish_registration/' + region_id + '/',
    });

    get_request.done(function(data){
      var option_list = data;
      $("#area_select").empty();
      for (var i = 0; i &lt; option_list.length; i++) {
        $("#area_select").append(
          $("&lt;option&gt;&lt;/option&gt;").attr("value", option_list[i][0]).text(option_list[i][1]));
      }
    });
  });
</code></pre>
<p>partial snippet from my html page:</p>
<pre><code>&lt;form method="POST" action=""&gt;
    {{ form.csrf_token }}
    &lt;fieldset class="form-group"&gt;
      &lt;div class="form-group"&gt;
        {{ form.region.label(class="form-control-label") }}
        {{ form.region(id="region_select", class="form-control form-control-sm") }}
      &lt;/div&gt;
      &lt;div class="form-group"&gt;
        {{ form.area.label(class="form-control-label") }}
        {{ form.area(id="area_select", class="form-control form-control-sm") }}
      &lt;/div&gt;
    &lt;/fieldset&gt;
    &lt;div class="form-group"&gt;
      {{ form.submit(class="btn btn-outline-info btn-sm btn-block") }}
    &lt;/div&gt;
  &lt;/form&gt;
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You must also fill in the form.area.choices before validation. Or else there is no valid choice for area ... and so you've got an error message if your form provide one.</p>
<pre><code>@users.route("/finish_registration", methods=['GET', 'POST'])
def finish_registration():
    cur = mysql.connection.cursor()
    result1 = cur.execute("select * from region")
    results = cur.fetchall()

    form = RegistrationDDForm(request.form)
    form.region.choices = [('0', 'Select Region')] + 
        [(x['region_id'], x['region']) for x in results]

    if request.method == 'POST':
        cur = mysql.connection.cursor()
        results = cur.execute("select * from area where region_id=%s", request.form.region_id)
        results = cur.fetchall()

        # Add choices to area to allow validation
        form.area.choices = [(x['area_id'], x['area']) for x in results]

        if form.validate():
            # Eventually add data to database table
            pass

    return render_template('finish_registration.html', title='Register', form=form)
</code></pre>
</div>
<span class="comment-copy">I think you are missing something in the sentence "but get error message ONLY on the field". Do you mean the area field ? If so, you must fill in the form.area.choices also before validating anything.</span>
