<div class="post-text" itemprop="text">
<p>I am trying to perform a curl request in python. My code is the following:</p>
<pre><code>url = 'http://xx.xxx.xx.xxx:xxxx/api/common/learningSessions/588752bef1d4654173a43015'          
payload = json.loads(open("request.json"))         
headers = {'X-User-Path': '....', 'X-User-Token': '...')
r = requests.get(url, data=json.dumps(payload), headers=headers)
</code></pre>
<p>Howver I am receiving in the second line the following error:</p>
<blockquote>
<p>TypeError: expected string or buffer (payload = json.loads(open("request.json")))</p>
</blockquote>
<p>Any idea what this error is about?</p>
</div>
<div class="post-text" itemprop="text">
<p>You are opening file <code>open("request.json")</code> this will return <code>&lt;open file 'request.json', mode 'r' at 0x108526810&gt;</code>.</p>
<p><code>json.loads</code> need string.</p>
<p>you can try </p>
<pre><code>url = 'http://xx.xxx.xx.xxx:xxxx/api/common/learningSessions/588752bef1d4654173a43015'          
payload = json.loads(open("request.json").read())         
headers = {'X-User-Path': '....', 'X-User-Token': '...')
r = requests.post(url, data=json.dumps(payload), headers=headers)
</code></pre>
<p><code>file.read</code> will return file content instead of file object.</p>
<p>If you dont want to use <code>read</code> you can directly use <code>json.load</code> instead of <code>json.loads</code></p>
<p>This is what I tried</p>
<pre><code>echo '{}' &gt; /tmp/test.json
cat /tmp/test.json
{}
</code></pre>
<p>Try to read same file.</p>
<pre><code>Python 2.7.10 (default, Jul 30 2016, 19:40:32)
[GCC 4.2.1 Compatible Apple LLVM 8.0.0 (clang-800.0.34)] on darwin
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import json
&gt;&gt;&gt; payload = json.loads(open("/tmp/test.json").read())
&gt;&gt;&gt; print payload
{}
</code></pre>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p>expected string or buffer</p>
</blockquote>
<p>open() returns a file. </p>
<p>And there's a difference between <code>json.load()</code> and <code>json.loads()</code> (the second accepts a string, not a file) </p>
<p>Besides, I don't think the <code>json.dumps()</code> is necessary </p>
</div>
<div class="post-text" itemprop="text">
<p>You are using <a href="https://docs.python.org/3/library/json.html#json.loads" rel="nofollow noreferrer"><code>json.loads()</code></a> but attempting to load a file. You need to use <a href="https://docs.python.org/3/library/json.html#json.load" rel="nofollow noreferrer"><code>json.load()</code></a> instead.</p>
<pre><code>payload = json.load(open("request.json"))
</code></pre>
</div>
<span class="comment-copy">But my json is validated.</span>
<span class="comment-copy">Then I am receiving in the same line: ValueError: No JSON object could be decoded, in the same line.</span>
<span class="comment-copy">@christosh can you give your file <code>content</code> ? because I tried with sample <code>json</code> and its working fine</span>
<span class="comment-copy">When trying payload = json.loads(open("request.json").read()) I got the same error.</span>
<span class="comment-copy">create one <code>test.json</code> file and add content as <code>{}</code>, then this code will work. If you can give your file content, we can help better.</span>
<span class="comment-copy">My json contains just {}. Actually I want to perform get not post.</span>
<span class="comment-copy">Then I am receiving in the same line: ValueError: No JSON object could be decoded</span>
<span class="comment-copy">@christosh then your <code>json</code> file is not valid <code>json format</code>, please check its format in some validator</span>
<span class="comment-copy">My json contains just {}. Actually I want to perform get not post.</span>
