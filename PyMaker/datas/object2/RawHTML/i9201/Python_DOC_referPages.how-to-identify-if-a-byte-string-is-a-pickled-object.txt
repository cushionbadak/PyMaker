<div class="post-text" itemprop="text">
<p>How to identify if a byte string object is a pickled object.</p>
<p>For example, in the below dictionary, how can I identify that <code>b</code> is a pickled object and that the other objects are not?</p>
<pre><code>example = {'a':1, 'b':b'\x80\x03K\x02.', 'c':b'3'}
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Although there are ways to tell whether it is <em>likely</em> that a stream is a pickle stream (for instance the first byte is always <code>\x80</code>, followed by the protocol number, here <code>\x03</code>, the last byte is also always a <code>b'.'</code>), in general it is hard to know that for sure (it could be coincidence that the first byte is <code>\x80</code> in a random string). So you better simply try to unpickle it and see if that works out:</p>
<pre><code>import pickle

def is_pickle_stream(stream):
    try:
        pickle.loads(stream)
        return True
    except UnpicklingError:
        return False
</code></pre>
<p>The above method will return <code>True</code> if the stream is a pickle stream, <code>False</code> if it is not, and throw an exception if <code>loads</code> throws an exception (out of memory, etc.).</p>
</div>
<span class="comment-copy">You could try to unpickle it, and if it fails see it as unpickled data. Pickle has a header, but it could be coincidence that the binary string has the same header.</span>
<span class="comment-copy"><a href="https://docs.python.org/3/glossary.html#term-eafp" rel="nofollow noreferrer"><i>"It's easier to ask for forgiveness than permission."</i></a></span>
