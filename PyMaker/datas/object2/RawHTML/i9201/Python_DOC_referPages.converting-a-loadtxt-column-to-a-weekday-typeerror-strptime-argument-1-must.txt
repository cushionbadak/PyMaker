<div class="post-text" itemprop="text">
<p>I'm trying to load data from a CSV file, and convert one column with a date, to a week number. I am getting below mentioned <code>TypeError</code>:</p>
<pre><code>import numpy as np

from datetime import datetime

def datestr2num(s):
    return datetime.strptime(s, "%d-%m-%Y").date().weekday()

dates, close = np.loadtxt(
    'data.csv', delimiter=',', usecols=(1,6), 
    converters={1: datestr2num}, unpack=True)

print("Dates =", dates)
</code></pre>
<p>Error:</p>
<pre><code>TypeError: strptime() argument 1 must be str, not bytes
</code></pre>
<p>I tried to execute this program on Python 3.5.2 -Anaconda custom (64-bit)</p>
</div>
<div class="post-text" itemprop="text">
<p>Converters are given the raw <code>bytes</code> value read from the file; you need to decode these to a string first if you want to parse them as a datetime value. ASCII should suffice as your input is simply a series of digits and dashes to form a date:</p>
<pre><code>def datestr2num(s):
    s = s.decode('ascii')
    return datetime.strptime(s, "%d-%m-%Y").weekday()
</code></pre>
<p>Note: I removed the <code>.date()</code> call; the <code>datetime</code> object supports the <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime.weekday" rel="nofollow noreferrer"><code>datetime.weekday()</code> method</a> directly.</p>
</div>
<span class="comment-copy"><code>loadtxt</code> does not return a tuple? <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html" rel="nofollow noreferrer">docs.scipy.org/doc/numpy/reference/generated/numpy.loadtxt.html</a></span>
<span class="comment-copy">Shouldn't a <code>csv</code> file be in plain text?</span>
<span class="comment-copy">Thank you sir.....understood the problem</span>
<span class="comment-copy">@ppasler: <code>numpy.loadtxt()</code> doesn't decode bytes when using converters.</span>
<span class="comment-copy">@Niko: Glad to have been of help! Feel free to <a href="http://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work">accept my answer</a> if you feel it was useful to you. :-)</span>
