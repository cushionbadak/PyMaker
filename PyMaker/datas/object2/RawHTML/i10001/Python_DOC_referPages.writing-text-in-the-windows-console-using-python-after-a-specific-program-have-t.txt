<div class="post-text" itemprop="text">
<p>I have a software - <code>FUNCOR2.exe</code> - for calculating the autocorrelation function given a data file, i.e. <code>test.txt</code>.</p>
<p>First, I execute <code>FUNCOR2.exe</code> from Windows command line and then the program takes control and asks me for the input data file.</p>
<p>I want to automate this in Python, so I can use working:</p>
<pre><code>os.system("FUNCOR2")
</code></pre>
<p>But then I am not able to type INTO the program the input file name.</p>
<p>So far I've tried:</p>
<pre><code>PressKey(0x54) # T
PressKey(0x45) # E
PressKey(0x53) # S
PressKey(0x54) # T
PressKey(110) # .
PressKey(0x54) # T
PressKey(0x58) # X
PressKey(0x54) # T
</code></pre>
<p>which I took from <a href="https://stackoverflow.com/questions/13564851/generate-keyboard-events">Generate keyboard events</a>, but it does not work, and also:</p>
<pre><code>win32api.keybd_event(0x54, 0) 
win32api.keybd_event(0x45, 0)
win32api.keybd_event(0x53, 0)
win32api.keybd_event(0x54, 0)
win32api.keybd_event(110, 0)
win32api.keybd_event(0x54, 0)
win32api.keybd_event(0x58, 0)
win32api.keybd_event(0x54, 0)
</code></pre>
<p>it does not work either.</p>
<p>This program does not accept arguments, so I cannot use:</p>
<pre><code>FUNCOR2.exe test.txt
</code></pre>
<p>I've found something similar in here: <a href="https://stackoverflow.com/questions/23407685/writing-in-the-cmd-after-executing-an-app-exe-from-java">Writing in the cmd after executing an app.exe from java</a>, but not at all.</p>
<p>Any ideas?</p>
</div>
<div class="post-text" itemprop="text">
<p>The only thing that I've found (other than your question) which refers to <code>FUNCOR2</code> is the paper "<a href="http://hera.ugr.es/doi/15001180.pdf" rel="nofollow noreferrer">A library of computer programs for assisting teaching and research in cyclostratigraphic analysis</a>" . Since this is from the Journal "Computers and Geosciences" and since you are in the GIS field, I assume that this is correct.</p>
<p>There are a couple of possibilities (beyond sending keystrokes, which is dicey at best):</p>
<p>1) The paper clearly gives the formula being used (and a quick glance at the actual Fortran code <a href="https://www.iamg.org/index.php/publisher/articleview/frmArticleID/113" rel="nofollow noreferrer">downloadable from the Journal's website</a> confirms that nothing else is done) suggests that this is easily implemented in Python, either straight-Python or using <a href="http://pandas.pydata.org/" rel="nofollow noreferrer">pandas</a> (which has functions for computing autocorrelations).</p>
<p>2) Modify the Fortran source and recompile with an open source Fortran compiler (I'm not a Fortran expert, but this seems to be Fortran 77). Towards the beginning of the code you see:</p>
<pre><code>READ (5,100,ERR=1) CFIL1
OPEN (1,FILE=CFIL1)
</code></pre>
<p>The first line is how the code gets the file name from the user. Replace that line by a line which reads a command line argument and voila -- you have a version of <code>FUNCOR2</code> which gets its input file from the command line, hence easily invoked from Python. It should be easy enough to find examples for getting a file name from a command line argument in Fortran. My guess is just 1 or 2 lines of code replacing that line would be enough. I am not interested enough to try, and doubt that it is worthwhile. This is because another line in the source is:</p>
<pre><code>DIMENSION X(1024),V(1024),COR(200),NPA(200)
</code></pre>
<p>Oddly enough, the program would fail if your file has more than 1024 observations. Maybe something like that made sense in the late 90s when the paper was written, but there is almost certainly equivalent pandas code which will be able to handle millions of observations. Sometimes old code should be allowed to die.</p>
</div>
<span class="comment-copy">Is it really an MS-DOS program, or Windows command-line program? MS-DOS does not support multitasking and you cannot do anything while another process is running. In the latter case, you can use Pythonâ€™s <a href="https://docs.python.org/3/library/subprocess.html" rel="nofollow noreferrer"><code>subprocess</code></a>.</span>
<span class="comment-copy">I believe 99% it is an MS-DOS program, that cannot be launched from elsewhere but from the console. I just need a method for emulating the keyboard.</span>
<span class="comment-copy">If this is a program which performs standard statistical computations (and autocorrelation is pretty standard), its functionality is probably contained somewhere in padas/scipy/numpy. It might be a better use of time to figure out how to do it directly from Python data analysis libraries.</span>
<span class="comment-copy">A VBScript program <i>can</i> accept command line arguments. If you really want to go this route, it might be easier to write a VBScript program which does what you are trying to do (using <code>SendKeys</code>) and then call it from Python. You'll encounter many of the same issues, but using a language which is closer to Windows. At the very least, you'll find more resources about running MS-DOS programs with <code>SendKeys</code> then you will find about using Python.</span>
<span class="comment-copy">MS-DOS programs are console applications, but not all console applications are MD-DOS programs! Consider to read this article: <a href="https://scalibq.wordpress.com/2012/05/23/the-windows-command-prompt-is-not-a-dos-prompt/" rel="nofollow noreferrer">The Windows command prompt is <i>NOT</i> a DOS prompt!</a></span>
