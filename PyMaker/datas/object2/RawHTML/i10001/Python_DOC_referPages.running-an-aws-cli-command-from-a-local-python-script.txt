<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/32942207/python-subprocess-calledprocesserror-command-returned-non-zero-exit-s">Python 'subprocess' CalledProcessError: Command '[â€¦]' returned non-zero exit status 1 [duplicate]</a>
<span class="question-originals-answer-count">
                    2 answers
                </span>
</li>
</ul>
</div>
<p>I'm trying to run this aws s3 ls command:</p>
<pre><code>aws s3 ls s3://path/to/my/bucket/12434 --recursive --human-readable --summarize
</code></pre>
<p>with this python:</p>
<pre><code>command = 'aws s3 ls s3://path/to/my/bucket/12434 --recursive --human-readable --summarize'
s3_folder_data  = subprocess.check_output(command, stderr=subprocess.STDOUT, shell=True)
print s3_folder_data
</code></pre>
<p>But it's failing with this error:</p>
<pre><code>subprocess.CalledProcessError: Command 'aws s3 ls s3://path/to/my/bucket/12434 --recursive --human-readable --summarize' returned non-zero exit status 1
</code></pre>
<p>The command itself works when I run it. The python script is being called by the same user on the same machine. What gives?</p>
</div>
<div class="post-text" itemprop="text">
<p>As suggested by others, use <a href="http://boto3.readthedocs.io/en/latest/reference/services/s3.html" rel="nofollow">Boto3 S3</a> library to get what you want. But if you insist on <code>subprocess</code>, try:</p>
<pre><code>subprocess.check_output(['aws', 's3', 'ls', 's3://path/to/my/bucket/12434', '--recursive', '--human-readable', '--summarize'])
</code></pre>
<p>or</p>
<pre><code>subprocess.call(['aws', 's3', 'ls', 's3://path/to/my/bucket/12434', '--recursive', '--human-readable', '--summarize'])
</code></pre>
<p>and build on it.</p>
</div>
<div class="post-text" itemprop="text">
<p>New in Python 3.5, you can also use <a href="https://docs.python.org/3/library/subprocess.html#subprocess.run" rel="nofollow"><code>subprocess.run()</code></a>.</p>
<pre><code>subprocess.run(['aws', 's3', 'ls', 's3://path/to/my/bucket/12434', '--recursive', '--human-readable', '--summarize'])
</code></pre>
</div>
<span class="comment-copy">there is a python api for aws called boto2, use it instead</span>
<span class="comment-copy">here is the link for s3 -  <a href="http://boto.cloudhackers.com/en/latest/ref/s3.html" rel="nofollow noreferrer">boto.cloudhackers.com/en/latest/ref/s3.html</a></span>
<span class="comment-copy">Thanks, I'm aware. But this was supposed to be a quick and dirty script. I don't want to go through the trouble of configuring boto if I can just use the CLI.</span>
<span class="comment-copy">there is no trouble, that's the thing, it's pretty simple to use, btw check out the other question i linked</span>
<span class="comment-copy">are you kidding me? get_bucket() and list it</span>
