<div class="post-text" itemprop="text">
<p>I have a list of key/value pairs </p>
<p>I'd like to count unique values in pairs </p>
<p>example of list </p>
<pre><code>[(12, 0), (10, 1), (11, 777), (11, 0) ,(10, 1)]
</code></pre>
<p>result something like :</p>
<pre><code>[(12, 0, 1), (10, 1 , 2), (11, 777, 1), (11, 0, 1)]
</code></pre>
<p>I tried map operations , but didn't succeed
Thanks !  </p>
</div>
<div class="post-text" itemprop="text">
<p>Using <a href="https://docs.python.org/2/library/collections.html#collections.Counter" rel="nofollow"><code>collections.Counter</code></a>:</p>
<pre><code>&gt;&gt;&gt; from collections import Counter
&gt;&gt;&gt;
&gt;&gt;&gt; lst = [(12, 0), (10, 1), (11, 777), (11, 0) ,(10, 1)]
&gt;&gt;&gt; [key + (cnt,) for key, cnt in Counter(lst).items()]
[(11, 0, 1), (11, 777, 1), (10, 1, 2), (12, 0, 1)]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Using <code>collections.Counter</code>:</p>
<pre><code>&gt;&gt;&gt; from collections import Counter
&gt;&gt;&gt; a =[(12, 0), (10, 1), (11, 777), (11, 0) ,(10, 1)] 

&gt;&gt;&gt; [(*i,j) for (i,j) in Counter(a).items()]
# [(11, 0, 1), (11, 777, 1), (10, 1, 2), (12, 0, 1)]

&gt;&gt;&gt; [i for i in Counter(a).items()]
# [((11, 0), 1), ((11, 777), 1), ((10, 1), 2), ((12, 0), 1)]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Would something like this work for you?</p>
<pre><code>your_list = [(12, 0), (10, 1), (11, 777), (11, 0) ,(10, 1)]
result = [(a,b,your_list.count((a,b))) for (a,b) in your_list]
# [(12, 0, 1), (10, 1, 2), (11, 777, 1), (11, 0, 1), (10, 1, 2)]
</code></pre>
<p>If you want each entry to appear only once you could do</p>
<pre><code>set(result)
# set([(12, 0, 1), (11, 0, 1), (11, 777, 1), (10, 1, 2)])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can also do it with built-in <code>map</code> method, this way:</p>
<pre><code>&gt;&gt;&gt; l = [(12, 0), (10, 1), (11, 777), (11, 0) ,(10, 1)]
&gt;&gt;&gt; result = []
&gt;&gt;&gt; map(lambda s: result.append((s[0],s[1],l.count(s))), set(l)) 
[None, None, None, None]
&gt;&gt;&gt; result
[(11, 0, 1), (11, 777, 1), (10, 1, 2), (12, 0, 1)]
</code></pre>
</div>
<span class="comment-copy">What are the pairs? When is a value unique?</span>
<span class="comment-copy">You could use dict with pairs in first list as keys.</span>
<span class="comment-copy">I'd like construct a method</span>
<span class="comment-copy">Thanks ! I'm trying to construct a function :       from collections import Counter def count_list([lst]):         [key + (cnt,) for key, cnt in Counter(lst).items()]</span>
<span class="comment-copy">I'm new to python , I'd like construct a method ..</span>
<span class="comment-copy">@Toren, <code>def method(lst): return [key + (cnt,) for key, cnt in Counter(lst).items()]</code></span>
<span class="comment-copy">What is import scope ? Can I import somewhere before the method ?</span>
<span class="comment-copy">@Toren, Yes before the method. <code>import</code> statement in the beginning of the module (file) is recommended.</span>
<span class="comment-copy"><a href="https://docs.python.org/3/whatsnew/3.5.html#whatsnew-pep-448" rel="nofollow noreferrer"><code>(*i, j)</code> syntax is available in Python 3.5+</a>. The question is tagged <code>python-2.7</code></span>
<span class="comment-copy">This can be combined into: <code>result = [(a,b,l.count((a,b))) for (a,b) in set(l)]</code></span>
<span class="comment-copy">Great ! Can this code be converted to PySpark map?</span>
