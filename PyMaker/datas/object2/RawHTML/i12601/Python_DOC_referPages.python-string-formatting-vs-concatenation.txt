<div class="post-text" itemprop="text">
<p>I'm developing an application in which I perform some requests to get an object id. After each one of them, I call a method (<code>get_actor_info()</code>) passing this id as an argument (see code below).</p>
<pre><code>ACTOR_CACHE_KEY_PREFIX = 'actor_'

def get_actor_info(actor_id):
    cache_key = ACTOR_CACHE_KEY_PREFIX + str(actor_id)
</code></pre>
<p>As can be noticed, I'm casting <code>actor_id</code> to <code>string</code> and concatenating it with a prefix. However, I know I could do it in multiple other ways (<code>.format()</code> or <code>'%s%d'</code>, for instance) and that results in my question: would <code>'%s%d'</code> be better than string concatenation in terms of readability, code convention and efficiency?</p>
<p>Thanks</p>
</div>
<div class="post-text" itemprop="text">
<p>This could easily become an opinion-based thread, but I find formatting to be more readable in most cases, and more maintainable. It's easier to visualize what the final string will look like, without doing "mental concatenation". Which of these is more readable, for example?</p>
<pre><code>errorString = "Exception occurred ({}) while executing '{}': {}".format(
    e.__class__.__name__, task.name, str(e)
)
</code></pre>
<p>Or:</p>
<pre><code>errorString = "Exception occurred (" + e.__class__.__name__
    + ") while executing '" + task.name + "': " + str(e)
</code></pre>
<p>As for whether to use <code>%</code> or <code>.format()</code>, I can answer more objectively: Use <code>.format()</code>. <code>%</code> is the "old-style", and, per the <a href="http://docs.python.org/3.2/tutorial/inputoutput.html#old-string-formatting">Python Documentation</a> they may soon be removed:</p>
<blockquote>
<p>Since <code>str.format()</code> is quite new, a lot of Python code still uses the <code>%</code> operator. However, because this old style of formatting will eventually be removed from the language, <code>str.format()</code> should generally be used.</p>
</blockquote>
<p>Later versions of the documentation have stopped mentioning this, but nonetheless, <code>.format()</code> is the way of the future; use it!</p>
<p>Concatenation is faster, but that should not be a concern. Make your code readable and maintainable as a first-line goal, and then optimize the parts you need to optimize later. Premature optimization is the root of all evil ;)</p>
</div>
<div class="post-text" itemprop="text">
<p>Concatenation is better when it comes to performance. In your example, both concatenation and substitution are readable but when it comes to more complex templates, substitution wins the simplicity and readability race. </p>
<p>For example, if you have data and you want show it in html, concatenation will cause you headache, while substitution will be simple and readable.</p>
</div>
<div class="post-text" itemprop="text">
<p>Python 3.6 will introduce yet another option:</p>
<pre><code>ACTOR_CACHE_KEY_PREFIX = 'actor_'

def get_actor_info(actor_id):
    cache_key = f'{ACTOR_CACHE_KEY_PREFIX}{actor_id}'
</code></pre>
<p>Performance should be comparable to <code>'{}{}'.format(ACTOR_CACHE_KEY_PREFIX, actor_id)</code>, but is arguably more readable.</p>
</div>
<div class="post-text" itemprop="text">
<p>I guess that, if all the terms to concatenate are constants, the concatenation with the <code>+</code> operator might be optimized by python for performance. Ex.:</p>
<pre><code>DB_PREFIX = 'prod_'
INDEX_PREFIX = 'index_'

CRM_IDX_PREFIX = DB_PREFIX + INDEX_PREFIX + 'crm_'
</code></pre>
<p>But most of the cases the format function and operators are used to concatenate with variable content. E.g:</p>
<pre><code>crm_index_name = "{}_{}".format(CRM_IDX_PREFIX, index_id)
</code></pre>
<p>In practical terms, if you use the <code>+</code> operator to concatenate like this:</p>
<pre><code>crm_index_name = CRM_IDX_PREFIX + '_' + str(index_id)
</code></pre>
<p>you are defining the format by custom code in a fixed way. If you use a format string with named references the code is more readable. E.g:</p>
<pre><code>crm_index_name = "{db_prefix}_{idx_prefix}_{mod_prefix}_{id}".format(
   db_prefix=CRM_IDX_PREFIX,
   idx_prefix=INDEX_PREFIX,
   mod_prefix='crm',
   id=index_id,
)
</code></pre>
<p>That way you have the advantage to define the format as a constant. E.g:</p>
<pre><code>IDX_FORMAT = "{db_prefix}_{idx_prefix}_{mod_prefix}_{id}"

crm_index_name = IDX_FORMAT.format(
   db_prefix=CRM_IDX_PREFIX,
   idx_prefix=INDEX_PREFIX,
   mod_prefix='crm',
   id=index_id,
)
</code></pre>
<p>And this result more clear in case that you need to change the format in the future. 
For example, in order to change the order of the separators you only need change the 
format string to:</p>
<pre><code>IDX_FORMAT = "{db_prefix}_{mod_prefix}_{idx_prefix}-{id}"
</code></pre>
<p>As a plus, in order to debug you can assign all those variables to a dictionary and pass it as keyword parameters to the format function:</p>
<pre><code>idx_name_parts = {
   'db_prefix': CRM_IDX_PREFIX,
   'idx_prefix': INDEX_PREFIX,
   'mod_prefix': 'crm',
   'id': index_id,
}
crm_index_name = IDX_FORMAT.format(**idx_name_parts)
</code></pre>
<p>Taking advantage of the <a href="https://docs.python.org/3.5/library/functions.html#globals" rel="nofollow noreferrer">globals()</a> function we can also:</p>
<pre><code>IDX_FORMAT = "{CRM_IDX_PREFIX}_{mod_prefix}_{INDEX_PREFIX}-{index_id}"

crm_index_name = IDX_FORMAT.format(mod_prefix = 'crm', **globals())
</code></pre>
<p>That is similar to the python3's <a href="https://docs.python.org/3/reference/lexical_analysis.html#formatted-string-literals" rel="nofollow noreferrer">formatted string literal</a>:</p>
<pre><code>crm_index_name = f"{CRM_IDX_PREFIX}_crm_{INDEX_PREFIX}-{index_id}"
</code></pre>
<p>I also see <em>Internationalization</em> as another use context where formatted expressions are more useful that <code>+</code> operator. Take the following code:</p>
<pre><code>message = "The account " + str(account_number) + " doesn't exist"
</code></pre>
<p>if you use a translation feature like the <a href="https://docs.python.org/2/library/gettext.html#module-gettext" rel="nofollow noreferrer">gettext module</a> with the <code>+</code> operator it would be:</p>
<pre><code>message = _("The account ") + str(account_number) + _(" doesn't exist")
</code></pre>
<p>so it is better to translate the whole format string: </p>
<pre><code>message = _("The account {account_number} doesn't exist").format(account_number)
</code></pre>
<p>so that the complete message has more sense in the spanish translation file:</p>
<pre><code>#: main.py:523
msgid "The account {account_number} doesn't exist"
msgstr "La cuenta {account_number} no existe."
</code></pre>
<p>That is specially helpful in translation to natural languages whose grammatic impose change in the order of the sentence, like <em>german</em> language. </p>
</div>
<span class="comment-copy">You can check by yourself: <a href="https://docs.python.org/2/library/timeit.html" rel="nofollow noreferrer">docs.python.org/2/library/timeit.html</a></span>
<span class="comment-copy">Thanks @brunodesthuilliers! However this answers only the time efficiency part of the question.</span>
<span class="comment-copy">Yes sorry... wrt/ readability and conventions, the answer is plain simple: use <code>.format()</code>.</span>
<span class="comment-copy">Concatenation is <i>worse</i> when it comes to performance. See <a href="https://waymoot.org/home/python_string/" rel="nofollow noreferrer">waymoot.org/home/python_string</a> and <a href="http://leadsift.com/python-string-concatenation/" rel="nofollow noreferrer">leadsift.com/python-string-concatenation</a></span>
