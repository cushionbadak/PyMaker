<div class="post-text" itemprop="text">
<p>I'm having trouble inserting binary data into a <code>longblob</code> column in MySQL using MySQLdb from Python 2.7, but I'm getting an encoding warning that I don't know how to get around:</p>
<pre><code>./test.py:11: Warning: Invalid utf8 character string: '8B0800'
  curs.execute(sql, (blob,))
</code></pre>
<p>Here is the table definition:</p>
<pre><code>CREATE TABLE test_table (
  id int(11) NOT NULL AUTO_INCREMENT,
  gzipped longblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;
</code></pre>
<p>And the test code:</p>
<pre><code>#!/usr/bin/env python

import sys
import MySQLdb

blob = open("/tmp/some-file.gz", "rb").read()
sql = "INSERT INTO test_table (gzipped) VALUES (%s)"

conn = MySQLdb.connect(db="unprocessed", user="some_user", passwd="some_pass", charset="utf8", use_unicode=True)
curs = conn.cursor()
curs.execute(sql, (blob,))
</code></pre>
<p>I've searched here and elsewhere for the answer, but unfortunately although many questions seem like they are what I'm looking for, the posters don't appear to be having encoding issues.</p>
<p>Questions:</p>
<ol>
<li>What is causing this warning?</li>
<li>How do I get rid of it?</li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p>After some more searching I've found the answers.</p>
<ol>
<li>It is actually MySQL generating this warning.</li>
<li>It can be avoided by using <code>_binary</code> before the binary parameter.</li>
</ol>
<p><a href="https://bugs.mysql.com/bug.php?id=79317" rel="nofollow">https://bugs.mysql.com/bug.php?id=79317</a></p>
<p>So the Python code needs to be updated as follows:</p>
<blockquote>
<p>sql = "INSERT INTO test_table (gzipped) VALUES (<strong>_binary</strong> %s)"</p>
</blockquote>
</div>
