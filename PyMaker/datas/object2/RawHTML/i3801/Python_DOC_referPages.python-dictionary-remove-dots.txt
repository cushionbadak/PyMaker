<div class="post-text" itemprop="text">
<p>i have multiple CSVs which i need to import into MangoDB. These csv's have a dot in the header which is failing when i insert them into MangoDB. apparently they dont allow dots in the keys. How can i remove the dots? i cannot modify the CSV as the csv's are loaded at runtime</p>
<pre><code>  df = pd.read_csv(filepath) #csv file which you want to import
  records_ = df.to_dict(orient = 'records')
  print(records_)
  result = db.matchstats.insert_many(records_ )
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You are converting your data to a dictionary here:</p>
<pre><code>records_ = df.to_dict(orient = 'records')
</code></pre>
<p>Thus, you can just apply a <a href="https://stackoverflow.com/questions/1747817/create-a-dictionary-with-list-comprehension-in-python#1747827">dictionary comprehension</a> (I am assuming operating on the dictionary <code>keys</code> here, as per your question.) You can just use a <a href="https://docs.python.org/3/howto/regex.html" rel="nofollow noreferrer">regex</a> to replace individual items. </p>
<p>For example (note that this assumes Py 3):</p>
<pre><code>import re
records_ = {re.sub(r"\.+", "", k):v for k,v in records_.items()} # replace one or more stops using re.sub
</code></pre>
<p>However, the overall approach of just replacing dots seems dangerous as it can lead to duplicate keys / dropped keys; you might reconsider it based on your data. </p>
</div>
<span class="comment-copy"><a href="http://pandas.pydata.org/pandas-docs/stable/text.html#splitting-and-replacing-strings" rel="nofollow noreferrer">Pandas has excellent documentation</a> - and methods to replace/transform strings.  If you search I imagine there are a number of SO Q&amp;A's regarding removing or replacing substrings in Pandas DataFrames or Series.</span>
<span class="comment-copy"><i>MangoDB</i> == MongoDB?</span>
<span class="comment-copy">hey, thanks for your answer. i'm getting the error 'list' object has no attribute 'items' now.</span>
<span class="comment-copy">ah indeed, the <code>to_dict</code> returns a list when you use the 'records' setting. Can you do a <code>print (_records[0])</code> and reproduce results here, indicating which item you want to convert?</span>
