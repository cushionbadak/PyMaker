<div class="post-text" itemprop="text">
<p>For a reason that I cannot resolve, my "subdirs" variable in my first for loop becomes an "unused variable" when it is written inside a function, which results in a incomplete search of my directory to achieve the goal of the function. But when it is not part of a function, it's recognized as a variable and my code is able to successfully search the entire directory and performed the desired tasks. I'm relatively new to python, please let me know how I can fix my function so "subdirs" will be recognized as a variable. Thanks a lot! </p>
<h1>My For Loop With "Subdirs" Within a Function</h1>
<pre><code>import os

def function(rootdir, keyPhrases):

    path = rootdir # Enter the root directory you want to search from

    key_phrases = [keyPhrases] # Enter here the key phrases in the lines you hope to find 

    # This for loop allows all sub directories and files to be searched
    for (path, subdirs, files) in os.walk(path): 
        files = [f for f in os.listdir(path) if f.endswith('.txt') or f.endswith('.log')] # Specify here the format of files you hope to search from (ex: ".txt" or ".log")
        files.sort() # file is sorted list

        files = [os.path.join(path, name) for name in files] # Joins the path and the name, so the files can be opened and scanned by the open() function

        # The following for loop searches all files with the selected format
        for filename in files:

                # Opens the individual files and to read their lines
                with open(filename) as f:
                    f = f.readlines()

                # The following loop scans for the key phrases entered by the user in every line of the files searched, and stores the lines that match into the "important" array
                for line in f:
                    for phrase in key_phrases: 
                        if phrase in line:
                            print(line)
                            break 

    print("The end of the directory has been reached, if no lines are printed then that means the key phrase does not exist in the root directory you entered.")
</code></pre>
<h1>My For Loop With "Subdirs"By Itself</h1>
<pre><code>import os

path = r"D:\(Chosen Root Directory)"

key_phrases = ["example_keyPhrase1"] # Enter here the key phrases in the lines you hope to find 

    # This for loop allows all sub directories and files to be searched
for (path, subdirs, files) in os.walk(path): 
    files = [f for f in os.listdir(path) if f.endswith('.txt') or f.endswith('.log')] # Specify here the format of files you hope to search from (ex: ".txt" or ".log")
    files.sort() # file is sorted list

    files = [os.path.join(path, name) for name in files] # Joins the path and the name, so the files can be opened and scanned by the open() function

    # The following for loop searches all files with the selected format
    for filename in files:

        # Opens the individual files and to read their lines
        with open(filename) as f:
            f = f.readlines()

            # The following loop scans for the key phrases entered by the user in every line of the files searched, and stores the lines that match into the "important" array
            for line in f:
                for phrase in key_phrases: 
                    if phrase in line:
                        print(line)
                        break 

print("The end of the directory has been reached, if no lines are printed then that means the key phrase does not exist in the root directory you entered.")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You never reference subdirs in your first code, so that's why you're getting the warning. However, that is not the reason your code doesn't work as you intended.</p>
<p>This line is the issue: <code>files = [f for f in os.listdir(path) if f.endswith('.txt') or f.endswith('.log')]</code></p>
<p><code>os.listdir(path)</code> will list all the directories in that path [1], not including the subdirectories within each directory. The variable 'subdirs' already contains that information. But you don't need it. The variable 'files' already has what you want, so you can change the line to this:</p>
<p><code>files = [f for f in files if f.endswith('.txt') or f.endswith('.log')]</code></p>
<p>[1] <a href="https://docs.python.org/3/library/os.html#os.listdir" rel="nofollow noreferrer">https://docs.python.org/3/library/os.html#os.listdir</a></p>
</div>
<span class="comment-copy">Hi Shea, thank you for the response. I swapped my line of code with yours, and after running it couple of times, it is still not working. Any other ideas on what's wrong? Thanks!</span>
<span class="comment-copy">I realized that when I type in the full line I'm looking for, I'm able to locate it, but not when I just type in the key words.</span>
<span class="comment-copy">You will have to be more specific in what isn't working. Add some debug prints and determine what part is not working, because the first half (finding the files) should work. One thing that might be causing issues is that you're using the same variable (path) for multiple things. Remove the line <code>path = rootdir</code> and just use 'rootdir' as the parameter in os.walk (<code>os.walk(rootdir)</code>).</span>
<span class="comment-copy">What's not working is that I'm still not able to find some lines (not all) by inputting their key words. I still believe it's the unused variable in the for loop "subdirs" that's causing this problem because when my code was not under a function, and when my IDE did not show subdirs as an unused varaible, I was able to always find and output the lines that corresponds to the key phrases I input. However, I don't know how to fix this problem, and what do you mean by referencing it? It wouldn't make sense to reference it as a parameter for the function would it? Thanks!</span>
<span class="comment-copy">I doubt that's what is causing the problem. The problem is likely in your string searching logic (haven't had time to thoroughly look at that part). When I say reference, I mean use, as in if you "reference" a variable. By using <code>for (path, subdirs, files) in os.walk(rootdir)</code>, you are defining the variables path, subdirs, and files. os.walk puts values in those variables, but you don't have to use them. The warning is just letting you know that you have variables defined that you are not using, which in most cases you should just remove, but for this case it is okay.</span>
