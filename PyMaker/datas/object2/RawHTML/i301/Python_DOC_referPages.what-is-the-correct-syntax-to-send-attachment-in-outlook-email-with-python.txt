<div class="post-text" itemprop="text">
<p>I'm trying to send an attachment with this Python code to send emails via Outlook. </p>
<p>The code at the moment looks like this and it works to send text msg, but my Eexcel file is not attaching.</p>
<pre><code>import win32com.client
olMailItem = 0x0
obj = win32com.client.Dispatch("Outlook.Application")
newMail = obj.CreateItem(olMailItem)
newMail.Subject = "test"
newMail.Body = "123"
newMail.To = "abc@outlook.com"
attachment1 = "C:/Users/myuser/Desktop/aaa.xls"
newMail.Send()   
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You never actually attach a file - add a line like</p>
<pre><code>newMail.Attachments.Add(attachment1)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><em>Also Attachment Path Use <strong><code>r</code></strong> so the string is treated as a raw string.</em></p>
<p><em>Example</em> </p>
<pre><code>attachment1 = r"C:/Users/myuser/Desktop/aaa.xls"
newMail.Attachments.Add(attachment1)
</code></pre>
<p><a href="https://docs.python.org/3/reference/lexical_analysis.html#string-literals" rel="nofollow noreferrer">https://docs.python.org/3/reference/lexical_analysis.html#string-literals</a></p>
</div>
<span class="comment-copy">Why don't you just use the SMTP library?</span>
<span class="comment-copy">is it possible to send outlook email with it? it uses webbrowser to do it? becouse i have outlook.com blocked in my browser for company reasons.</span>
<span class="comment-copy">Pretty sure it just sends and receives requests. You can setup the server addresses yourself. Do you know the email credentials? All you need is the email server address, the protocols it uses and the username/password and you can send without need of the outlook client itself</span>
<span class="comment-copy">It doesnt use a web browser, it is all do as a script and only uses python.</span>
<span class="comment-copy">If it's just like a hotmail account, I'm pretty certain you'll have no issues :)</span>
