<div class="post-text" itemprop="text">
<p>Trying to loop through titles of movies in a text file to call API and store the response to a text file. </p>
<p>file contains one title on every line ex. </p>
<pre><code>Titanic
Avatar
A Star Is Born
</code></pre>
<p>the api i am trying to use is from www.odmpapi.com</p>
<p>This is what i have to correctly join and create the weblink</p>
<pre><code>import requests
import sys

prefixURL = 'http://www.omdbapi.com/?t='
suffixURL = '&amp;apikey=xxx4s23'

text_file = open("url.txt", "w")

with open('print.txt', 'r') as f:
    for i in f:
        uri = prefixURL + i.rstrip(' \n\t') + suffixURL
        print uri
        text_file.write(url)
        text_file.write('\n')

text_file.close()

text_file = open("responses.txt", "w")


with open('url.txt', 'r') as f2:
    for i in f2:
        url = i.strip(' \n\t')
        batch = requests.get(i.rstrip(' \n\t'))
        data = batch.text
        print data
    text_file.write(data)
    text_file.write('\n')

text_file.close()
</code></pre>
<p>This writes to responses.txt only the last title in the list. </p>
</div>
<div class="post-text" itemprop="text">
<p>Try the following kind of approach:</p>
<pre><code>import requests
import sys

base_url = 'http://www.omdbapi.com/?t={}&amp;apikey=xxx4s23'

with open('print.txt', 'r') as f_input, open('responses.txt', 'w') as f_output:
    for line in f_input:
        search_term = line.strip(' \n\t')
        url = base_url.format(search_term)
        print url
        batch = requests.get(url)
        f_output.write("{},{}\n".format(url, batch.text))
</code></pre>
<p>This writes the URL and the result into the output file. Python's <code>.format()</code> command can be used to put your search time into the <code>base_url</code> without having to split it up and use string concatenation. It works by replacing each <code>{}</code> with a passed argument.</p>
</div>
<span class="comment-copy">There is no reference to par1 &amp; part2 I think you need to refactor these to prefixURL &amp; suffixURL.</span>
<span class="comment-copy">@wwii Thanks. used &lt;code&gt;&lt;/code&gt; Newbie mistake.</span>
<span class="comment-copy">You have a loop, and looks like you know how to write to a file.  What are you having problems with? Are you trying to figure out how to make the request? Have you looked through the <a href="https://docs.python.org/3/library/urllib.request.html" rel="nofollow noreferrer"><code>urllib.requests</code></a> docs or the <a href="http://docs.python-requests.org/en/master/" rel="nofollow noreferrer"><code>Requests: HTTP for Humans</code></a> docs?</span>
<span class="comment-copy">I think you might benefit from looking into <a href="https://jeffknupp.com/blog/2016/03/07/python-with-context-managers/" rel="nofollow noreferrer">context managers</a> in order to avoid leaking file descriptors. Maybe not relevant here, but good for future.</span>
<span class="comment-copy">@wwii I am doing this but it only writes to responses.txt only the last title in the list  ``` text_file = open("responses.txt", "w")  #send every uri to the api and write the respsones to a textfile with open('url.txt', 'r') as f2: 	for i in f2: 		url = i.strip(' \n\t') 		batch = requests.get(i.rstrip(' \n\t')) 		data = batch.text 		print data 	text_file.write(data) 	text_file.write('\n')  text_file.close() ```</span>
