<div class="post-text" itemprop="text">
<p>I need to write code in python for kafka consumer. I have the topic name. And the data from the topic ia as shown below:</p>
<pre><code>{"MT":"500","FISC_YR":"1958","RETRIEVAL_ID":1,"INDICATOR":"I","CHANGED_ON":"20181012","ZNGED_AT":"102708","ZGED_BY":"PT"}
{"MT":"500","FISC_YR":"1958","RETRIEVAL_ID":1,"INDICATOR":"I","CHANGED_ON":"20181013","ZNGED_AT":"102709","ZGED_BY":"PT"}
</code></pre>
<p>I need to write a code to convert the above to a csv file having data as below:</p>
<pre><code>MT,FISC,RETRIEVAL_ID,INDICATOR,CHANGED_ON,ZNGED_AT,ZGED_BY
500,1958,1,I,20181012,102708,PT  
500,1957,2,F,20181013,102709,AT
</code></pre>
<p>I m completely new to KAFKA. I have started with the below code.</p>
<pre><code>from kafka import KafkaConsumer
consumer = KafkaConsumer('my_topic')
for msg in consumer:
    print (msg)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.python.org/3/library/csv.html#csv.DictWriter" rel="nofollow noreferrer">DictWriter</a> function to do so:</p>
<pre><code>import csv
import json

data = [{'MT': '500', 'FISC_YR': '1958', 'RETRIEVAL_ID': 1,'INDICATOR': 'I', 'CHANGED_ON': '20181012', 'ZNGED_AT': '102708', 'ZGED_BY': 'PT'},
        {'KT': '500', 'FISC_YEAR': '1958', 'RETRIEVAL_ID': 1,'INDICATOR': 'I', 'CHANGED_ON': '20181013', 'ZNGED_AT': '102709', 'ZGED_BY': 'PT'}]

data = json.loads((json.dumps(data).replace('KT', 'MT').replace('FISC_YR', 'FISC')))

with open('result.csv', 'w', newline='') as f:
    writer = csv.DictWriter(f, fieldnames=['MT', 'FISC', 'RETRIEVAL_ID', 'INDICATOR', 'CHANGED_ON', 'ZNGED_AT', 'ZGED_BY'])
    writer.writeheader()
    writer.writerows(data)
</code></pre>
<p>Output file:</p>
<pre><code>MT,FISC,RETRIEVAL_ID,INDICATOR,CHANGED_ON,ZNGED_AT,ZGED_BY
500,1958,1,I,20181012,102708,PT
500,1958,1,I,20181013,102709,PT
</code></pre>
</div>
<span class="comment-copy">The question is not to the topic. Your problem is about writing a json to a file in a csv format, its got nothing to do with Kafka. You've already written a code to print JSON, instead of printing to stdout, you will be writing to a file. In summary, your question is misleading</span>
<span class="comment-copy">Can u help me on how to direct it to file and convert the json to csv</span>
<span class="comment-copy">Thanks Aldereven. But where shd i add the above code in my code.. :( i m totally confused...</span>
<span class="comment-copy">its my typo in question. so this replace can be ommitted. Editing my question now. Can u help me furthur</span>
<span class="comment-copy">Any help for my doubt?</span>
<span class="comment-copy">Sorry, have no ideas.</span>
<span class="comment-copy">Can u modify the above code without replace. and taking input from a file pls</span>
