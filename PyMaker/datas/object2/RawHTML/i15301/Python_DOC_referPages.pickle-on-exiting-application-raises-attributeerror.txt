<div class="post-text" itemprop="text">
<p>I'm trying to pickle a class instance after the main application is closed but I'm getting </p>
<pre><code>Exception AttributeError: "'NoneType' object has no attribute 'dump'" in &lt;bound method MainFrame.__del__ of &lt;__main__.MainFrame object at 0x03BA6508&gt;&gt; ignored
</code></pre>
<p>Here's a sample code:</p>
<pre><code>from PySide.QtGui import *
import sys
import pickle

class Progress:
    def __init__(self, value):
        self.x = value

    def __del__(self):
        pickle.dump(self, open("pickle_file.p", "wb"))


class MainFrame(QWidget):
    def __init__(self):
        QWidget.__init__(self)
        pass

    # def __del__(self):
    #     pickle.dump(progress, open("pickle_file.p", "wb"))

if __name__ == "__main__":
    try:
        with open("pickle_file.p", "r") as p_file:
            progress = pickle.load(p_file)
    except (EOFError, IOError):
        progress = Progress(1)

    app = QApplication(sys.argv)
    main = MainFrame()
    main.show()
    sys.exit(app.exec_())
</code></pre>
<p>Both methods of <code>__del__</code> raise the same error.</p>
<p>How can I do that?</p>
</div>
<div class="post-text" itemprop="text">
<p>Never use <a href="https://docs.python.org/3/reference/datamodel.html#object.__del__" rel="nofollow"><code>__del__</code></a> unless you really, <em>really</em> know what you're doing.</p>
<p>If you want to save things on exit, reimplement the <a href="https://qt-project.org/doc/qt-4.8/qwidget.html#closeEvent" rel="nofollow"><code>closeEvent</code></a> of the main window:</p>
<pre><code>class MainFrame(QWidget):
    ...

    def closeEvent(self, event):
        pickle.dump(progress, open("pickle_file.p", "wb"))            
</code></pre>
</div>
<span class="comment-copy">plus 1 for linking to documentation of <code>__del__</code></span>
