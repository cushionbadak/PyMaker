<div class="post-text" itemprop="text">
<pre><code>new_i = csv.DictWriter(file_obj, fieldnames)
new_i.writeheader()
for item in new_list:
  new_i.writerow(item)
</code></pre>
<p>It hasn't created an out of order csv file for me yet, but I wanted to know if it could. Couldn't the writerow function write the dictionary values in any order?</p>
</div>
<div class="post-text" itemprop="text">
<p>No, because the writer uses the order of <code>fieldnames</code> to produce the rows. This guarantees that all rows use the same order.</p>
<p>This is <a href="https://docs.python.org/3/library/csv.html#csv.DictWriter" rel="nofollow noreferrer">explicitly documented</a>:</p>
<blockquote>
<p>The <em>fieldnames</em> parameter is a sequence of keys <strong>that identify the order in which values in the dictionary passed to the <code>writerow()</code> method are written to file <em>f</em></strong>.</p>
</blockquote>
<p>Bold emphasis mine. The documentation also links to the source code, where you can <a href="https://github.com/python/cpython/blob/v3.6.1/Lib/csv.py#L152" rel="nofollow noreferrer">see how this is achieved</a>:</p>
<pre><code>return (rowdict.get(key, self.restval) for key in self.fieldnames)
</code></pre>
<p>At no point is the order of the dictionary consulted.</p>
</div>
<span class="comment-copy"><a href="https://hg.python.org/cpython/file/4243df51fe43/Lib/csv.py#l152" rel="nofollow noreferrer">Relevant line of source</a>.</span>
<span class="comment-copy">@IgnacioVazquez-Abrams: keep up! GitHub is the source of truth for the Python source code these days! :-D (and I already added a link to the very same line).</span>
<span class="comment-copy">They changed <i>again</i>? They should make up their minds already :P</span>
<span class="comment-copy">@IgnacioVazquez-Abrams: relevant accepted PEP: <a href="https://www.python.org/dev/peps/pep-0512/" rel="nofollow noreferrer">python.org/dev/peps/pep-0512</a> (although there were a few predecessors that didn't make it).</span>
