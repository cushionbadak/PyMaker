<div class="post-text" itemprop="text">
<p>I'm trying to use Scapy to sniff my HTTPS network packets. I've already installed <a href="https://github.com/tintinweb/scapy-ssl_tls" rel="nofollow noreferrer">scapy_ssl_tls</a>:</p>
<pre><code>Requirement already satisfied: scapy-ssl_tls in path\python36\lib\site-packages (2.0.0)
Requirement already satisfied: pycryptodomex&gt;=3.4 in path\python36\lib\site-packages (from scapy-ssl_tls) (3.7.3)
Requirement already satisfied: scapy==2.4.* in path\python36\lib\site-packages (from scapy-ssl_tls) (2.4.2)
Requirement already satisfied: tinyec&gt;=0.3.1 in path\python36\lib\site-packages (from scapy-ssl_tls) (0.3.1)
</code></pre>
<p>but when I try this snippet:</p>
<pre><code>from scapy_ssl_tls.ssl_tls import TLS
</code></pre>
<p>I have this exception:</p>
<pre><code>Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "path\Python36\lib\site-packages\scapy_ssl_tls\ssl_tls.py", line 8, in &lt;module&gt;
    from scapy.layers import x509
  File "path\Python36\lib\site-packages\scapy\layers\x509.py", line 31, in &lt;module&gt;
    class ASN1P_OID(ASN1_Packet):
  File "path\Python36\lib\site-packages\scapy\layers\x509.py", line 33, in ASN1P_OID
    ASN1_root = ASN1F_OID("oid", "0")
  File "path\Python36\lib\site-packages\scapy\asn1fields.py", line 55, in __init__
    self.default = self.ASN1_tag.asn1_object(default)
  File "path\Python36\lib\site-packages\scapy\asn1\asn1.py", line 120, in asn1_object
    return self._asn1_obj(val)
  File "path\Python36\lib\site-packages\scapy\asn1\asn1.py", line 403, in __init__
    val = conf.mib._oid(plain_str(val))
AttributeError: 'Conf' object has no attribute 'mib'
</code></pre>
<p>I've already tried using Python 2.7, and when I run the same command, the output is:</p>
<pre><code>Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "path\Python27\lib\site-packages\scapy_ssl_tls\ssl_tls.py", line 7, in &lt;module&gt;
    from scapy.layers.inet import TCP, UDP
  File "path\Python27\lib\site-packages\scapy\layers\inet.py", line 14, in &lt;module&gt;
    from scapy.layers.l2 import *
  File "path\Python27\lib\site-packages\scapy\layers\l2.py", line 14, in &lt;module&gt;
    from scapy.ansmachine import *
  File "path\Python27\lib\site-packages\scapy\ansmachine.py", line 14, in &lt;module&gt;
    from sendrecv import send,sendp,sniff
  File "path\Python27\lib\site-packages\scapy\sendrecv.py", line 13, in &lt;module&gt;
    import arch
  File "path\Python27\lib\site-packages\scapy\arch\__init__.py", line 80, in &lt;module&gt;
    from windows import *
  File "path\Python27\lib\site-packages\scapy\arch\windows\__init__.py", line 17, in &lt;module&gt;
    from scapy.sendrecv import debug, srp1
ImportError: cannot import name debug
</code></pre>
<p>Can someone help me or can they suggest another way to sniff https packets from the network using scapy?</p>
</div>
<div class="post-text" itemprop="text">
<ul>
<li>You can try using the built in Scapy TLA module, rather than Scapy-ssltls, via <code>load_layer("tls")</code></li>
<li>make sure youâ€™re running the latest Scapy version</li>
<li>install <code>wireshark</code> (where Scapy gets its manuf data from)</li>
</ul>
</div>
