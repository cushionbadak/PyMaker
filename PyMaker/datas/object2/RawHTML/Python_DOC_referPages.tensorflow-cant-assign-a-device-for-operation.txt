<div class="post-text" itemprop="text">
<p>I am trying to run <a href="https://github.com/tkarras/progressive_growing_of_gans" rel="nofollow noreferrer">NVidia's face generating demo</a> on my computer. I am using Windows 10. I have downloaded the source, and am trying to follow the steps further down the page. I have installed the latest NVidia drivers for my GTX1060, which should be a device that supports cuda functionality. I have installed the Cuda Toolkit, as well as the cuDNN SDK that TensorFlow requires. </p>
<p>However, when running the <code>import_example.py</code> script I am getting the below error. Can anyone tell me what I am doing wrong? </p>
<pre><code>   2019-03-19 20:16:26.112574: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2
    WARNING:tensorflow:From C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\framework\op_def_library.py:263: colocate_with (from tensorflow.python.framework.ops) is deprecated and will be removed in a future version.
    Instructions for updating:
    Colocations handled automatically by placer.
    Traceback (most recent call last):
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\client\session.py", line 1334, in _do_call
        return fn(*args)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\client\session.py", line 1319, in _run_fn
        options, feed_dict, fetch_list, target_list, run_metadata)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\client\session.py", line 1407, in _call_tf_sessionrun
        run_metadata)
    tensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation G_paper_1/Run/G_paper_1/latents_in: {{node G_paper_1/Run/G_paper_1/latents_in}}was explicitly assigned to /device:GPU:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0 ]. Make sure the device specification refers to a valid device. The requested device appears to be a GPU, but CUDA is not enabled.
             [[{{node G_paper_1/Run/G_paper_1/latents_in}}]]

    During handling of the above exception, another exception occurred:

    Traceback (most recent call last):
      File ".\import_example.py", line 21, in &lt;module&gt;
        images = Gs.run(latents, labels)
      File "C:\Users\me\Desktop\progressive_growing_of_gans-master\tfutil.py", line 668, in run
        mb_out = tf.get_default_session().run(out_expr, dict(zip(self.input_templates, mb_in)))
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\client\session.py", line 929, in run
        run_metadata_ptr)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\client\session.py", line 1152, in _run
        feed_dict_tensor, options, run_metadata)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\client\session.py", line 1328, in _do_run
        run_metadata)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\client\session.py", line 1348, in _do_call
        raise type(e)(node_def, op, message)
    tensorflow.python.framework.errors_impl.InvalidArgumentError: Cannot assign a device for operation G_paper_1/Run/G_paper_1/latents_in: node G_paper_1/Run/G_paper_1/latents_in (defined at C:\Users\me\Desktop\progressive_growing_of_gans-master\tfutil.py:508) was explicitly assigned to /device:GPU:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0 ]. Make sure the device specification refers to a valid device. The requested device appears to be a GPU, but CUDA is not enabled.
             [[node G_paper_1/Run/G_paper_1/latents_in (defined at C:\Users\me\Desktop\progressive_growing_of_gans-master\tfutil.py:508) ]]

    Caused by op 'G_paper_1/Run/G_paper_1/latents_in', defined at:
      File ".\import_example.py", line 21, in &lt;module&gt;
        images = Gs.run(latents, labels)
      File "C:\Users\me\Desktop\progressive_growing_of_gans-master\tfutil.py", line 645, in run
        out_expr = self.get_output_for(*in_split[gpu], return_as_list=True, **dynamic_kwargs)
      File "C:\Users\me\Desktop\progressive_growing_of_gans-master\tfutil.py", line 508, in get_output_for
        named_inputs = [tf.identity(expr, name=name) for expr, name in zip(in_expr, self.input_names)]
      File "C:\Users\me\Desktop\progressive_growing_of_gans-master\tfutil.py", line 508, in &lt;listcomp&gt;
        named_inputs = [tf.identity(expr, name=name) for expr, name in zip(in_expr, self.input_names)]
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\util\dispatch.py", line 180, in wrapper
        return target(*args, **kwargs)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\ops\array_ops.py", line 81, in identity
        ret = gen_array_ops.identity(input, name=name)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\ops\gen_array_ops.py", line 4537, in identity
        "Identity", input=input, name=name)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\framework\op_def_library.py", line 788, in _apply_op_helper
        op_def=op_def)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\util\deprecation.py", line 507, in new_func
        return func(*args, **kwargs)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\framework\ops.py", line 3300, in create_op
        op_def=op_def)
      File "C:\Users\me\AppData\Local\Programs\Python\Python37\lib\site-packages\tensorflow\python\framework\ops.py", line 1801, in __init__
        self._traceback = tf_stack.extract_stack()

    InvalidArgumentError (see above for traceback): Cannot assign a device for operation G_paper_1/Run/G_paper_1/latents_in: node G_paper_1/Run/G_paper_1/latents_in (defined at C:\Users\me\Desktop\progressive_growing_of_gans-master\tfutil.py:508) was explicitly assigned to /device:GPU:0 but available devices are [ /job:localhost/replica:0/task:0/device:CPU:0 ]. Make sure the device specification refers to a valid device. The requested device appears to be a GPU, but CUDA is not enabled.
             [[node G_paper_1/Run/G_paper_1/latents_in (defined at C:\Users\me\Desktop\progressive_growing_of_gans-master\tfutil.py:508) ]]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p>Cannot assign a device for operation
  G_paper_1/Run/G_paper_1/latents_in: {{node
  G_paper_1/Run/G_paper_1/latents_in}}was explicitly assigned to
  /device:GPU:0 but available devices are [
  /job:localhost/replica:0/task:0/device:CPU:0 ]</p>
</blockquote>
<p>have you installed <code>tensorflow</code> or <code>tensorflow-gpu</code>? The later is the one you want if you want to use your GPU.</p>
<hr/>
<p>It might also be a version compatibility issue. 
First, check if you have your nvidia driver installed with: <code>nvidia-smi</code>, you should get something like this:</p>
<pre><code>Mon Apr 1 12:30:02 2019       
+------------------------------------------------------+                       
| NVIDIA-SMI 3.295.41   Driver Version: 295.41         |                       
|-------------------------------+----------------------+----------------------+
| Nb.  Name                     | Bus Id        Disp.  | Volatile ECC SB / DB |
| Fan   Temp   Power Usage /Cap | Memory Usage         | GPU Util. Compute M. |
|===============================+======================+======================|
| 0.  GeForce GTX 580           | 0000:25:00.0  N/A    |       N/A        N/A |
|  54%   70 C  N/A   N/A /  N/A |  25%  383MB / 1535MB |  N/A      Default    |
|-------------------------------+----------------------+----------------------|
| Compute processes:                                               GPU Memory |
|  GPU  PID     Process name                                       Usage      |
|=============================================================================|
|  0.           Not Supported                                                 |
+-----------------------------------------------------------------------------+
</code></pre>
<p>After that, check which cuda version you have with <code>nvcc --version</code>. Example:</p>
<pre><code>nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2016 NVIDIA Corporation
Built on Mon_Apr__1_12:34:01_CDT_2016
Cuda compilation tools, release 8.0, V8.0.44
</code></pre>
<p>Ultimately, check if you have compatible versions for the python/tensorflow/cuda installed. For that, using this <a href="https://stackoverflow.com/questions/50622525/which-tensorflow-and-cuda-version-combinations-are-compatible">table</a> as reference seems to work for most people.</p>
<hr/>
<p>Don't forget to reboot after installing the driver!</p>
</div>
<span class="comment-copy">Seems like CUDA is not enabled (you only have CPU devices and no GPU). Is tensorflow GPU installed (which version) and have you tried removing tensorflow ?</span>
<span class="comment-copy">did you include the cuda library path in your environment paths ?</span>
<span class="comment-copy">Once you verify the items mentioned above, make sure you have the right version of cuda installed.  1.13 and 2.0 alpha/nightly) require cuda 10.</span>
