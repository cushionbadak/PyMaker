<div class="post-text" itemprop="text">
<p>I have a file 'purchases.txt' which has a repeating city <strong>Fort Worth</strong>.
I want to write each line from each city into an output file based on the city name (eg. Fort Worth.txt)</p>
<p><strong>purchases.txt</strong></p>
<pre><code>2012-01-01  09:00   San Jose    Men's Clothing  214.05  Amex
2012-01-01  09:00   Fort Worth  Women's Clothing    153.57  Visa
2012-01-01  09:00   San Diego   Music   66.08   Cash
2012-01-01  09:00   Pittsburgh  Pet Supplies    493.51  Discover
2012-01-01  09:00   Omaha   Children's Clothing 235.63  MasterCard
2012-01-01  09:00   Stockton    Men's Clothing  247.18  MasterCard
2012-01-01  09:00   Austin  Cameras 379.6   Visa
2012-01-01  09:00   New York    Consumer Electronics    296.8   Cash
2012-01-01  09:00   Corpus Christi  Toys    25.38   Discover
2012-01-01  09:00   Fort Worth  Toys    213.88  Visa
</code></pre>
<p><strong>Main code</strong></p>
<pre><code>with open('purchases.txt') as input:    

      for line in input:

         city=line.split('\t')[2]

         with open('%s.txt' %city, 'w') as output:

            output.write(line)
</code></pre>
<p>It works almost perfectly but why is it that Fort Worth.txt only has 1 line of text instead of 2? How do I solve this?</p>
<p><strong>My Fort Worth.txt</strong></p>
<pre><code>2012-01-01  09:00   Fort Worth  Toys    213.88  Visa
</code></pre>
<p><strong>Desired Fort Worth.txt</strong></p>
<pre><code>2012-01-01  09:00   Fort Worth  Women's Clothing    153.57  Visa
2012-01-01  09:00   Fort Worth  Toys    213.88  Visa
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could always collect <strong>all</strong> the information in a <code>defaultdict</code> first:</p>
<pre><code>from collections import defaultdict

outputs = defaultdict(list)
with open('purchases.txt') as input:    

      for line in input:

         city = line.split('\t')[2]
         outputs[city].append(line)

for city,lines in outputs.items()
     with open('%s.txt' %city, 'w') as output:
         for line in lines:
            output.write(line)
</code></pre>
<p>Now you open the files once and write all the collected lines in one go.</p>
<p>This does assume that the file <code>purchases.txt</code> is not too large that its contents will overflow main memory.</p>
</div>
<div class="post-text" itemprop="text">
<p>That is because you are using "w" when trying to write the file. Use <strong>"a"</strong> to append content to a file</p>
<p>Change </p>
<pre><code>with open('%s.txt' %city, 'w') as output:
</code></pre>
<p>to</p>
<pre><code>with open('%s.txt' %city, 'a') as output:
</code></pre>
</div>
<span class="comment-copy">More on file modes in python: <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer">docs.python.org/3/library/functions.html#open</a></span>
<span class="comment-copy">Is there a way to still use 'w' without using 'a' to get the 2 lines of text in Fort Worth.txt? Because if I keep on running the code, it will just keep on appending to all 9 files which isn't what I really want.</span>
<span class="comment-copy">unfortunately no. using "w" initialize the file from the start. only using "a" can you append content to a file.</span>
<span class="comment-copy">You probably need to change the logic of the script to have your desired output of having only Fort Worth.txt with 2 lines</span>
