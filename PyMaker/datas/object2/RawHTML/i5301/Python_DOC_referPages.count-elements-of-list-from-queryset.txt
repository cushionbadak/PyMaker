<div class="post-text" itemprop="text">
<p>I get a queryset from a model that saves the data to a <code>charfield</code>. The charfield is displayed on a form as <code>MultipleChoiceField</code> with a <code>CheckboxSelectMultiple</code> widget. The max amount of choices is 5.</p>
<p>I want to count the number of elements in the queryset. Each queryset can vary in the amount of the elements in the list. Now, when I get <code>len</code> of the list, the value is 5 times the amount of elements. Is the list in the dict not a list but something else? When I create a list manually without the queryset and get <code>len</code> of said list, the value is correct. E.g. list with 3 elements returns 3. </p>
<p><code>query = MyModel.objects.all().values('myvalue')</code></p>
<pre><code>print(query[0])
{'myvalue': "['3']"}
print(query[1])
{'myvalue': "['1', '4']"}

print(query[0]['myvalue']
['3']
print(query[1]['myvalue']
['1', '4']

print(len(query[0]['myvalue']))
5

print(len(query[1]['myvalue']))
10
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use the <strong><a href="https://docs.python.org/3/library/ast.html" rel="nofollow noreferrer">ast module</a></strong> to convert the string list to list object and get the len</p>
<pre><code>import ast

a = ast.literal_eval("['3']")      #print(len(ast.literal_eval(query[0]['myvalue'])))
b = ast.literal_eval("['1', '4']")
print len(a)  # returns 1
print len(b)  # returns 2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you use a charfield to store the data, everything while being stored willl get converted to a char so you can't use len on it directly.
You can use use a JSONField or ListField if your're using postgres as your db backend.
If you have to use a CharField or a TextField then you'll need to first convert it back. You can create a custom field inheriting from TextField which will do it everywhere you use it or just use json.loads() after you load the data from the database</p>
</div>
<span class="comment-copy">So instead of <code>5 and 10</code> you are expecting <code>1 and 2</code> right ?</span>
<span class="comment-copy">Yes, that's what I expect and want.</span>
