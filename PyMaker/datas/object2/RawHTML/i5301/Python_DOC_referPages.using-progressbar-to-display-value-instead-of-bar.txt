<div class="post-text" itemprop="text">
<p>Part of my python program is to load the contents of a (csv) file into a list. Since this file is large, I'd like to add some progress data about it. This is what I'm doing right now:</p>
<pre><code>def loadFile(infilepath):
    answer = []
    with open(infilepath) as infile:
        for progress,row in enumerate(csv.reader(infile), 1):
            if not progress%10000:
                progress = format(progress, ',')
                print(progress, '\b'*len(progress), sep='', end='', flush=True)
            answer.append(doStuffWith(row))
    return answer

print("Loading Data... ", end='', flush=True)
data = loadData('path/to/file')
</code></pre>
<p>Normally, I'd replace the <code>print(progress, '\b'*len(progress), ...)</code> with <code>print(progress, '\r', ...)</code> to bring the cursor back to the start of the line. But that's not an option here, as the start of line is offset by <code>"Loading Data... "</code>. I was told that I could use <a href="https://pypi.python.org/pypi/progressbar2" rel="nofollow noreferrer">progressbar2</a> for this, but I can't seem to figure out how to make it write actual values, instead of a progress bar.</p>
<p>I'd appreciate any help on this</p>
</div>
<div class="post-text" itemprop="text">
<p>Use a custom widget:</p>
<pre><code>import time
from progressbar import ProgressBar, FormatLabel, UnknownLength

def transform(n):
    return format(n, ',')

widget = FormatLabel('Loading Data... %(value)s')
widget.mapping = {**widget.mapping, 'value': ('value', transform)}
with ProgressBar(widgets=[widget], max_value=UnknownLength) as bar:
    for i in range(1, 1234):
        time.sleep(0.001)
        bar.update(i)
</code></pre>
</div>
<span class="comment-copy">I can't have <code>'Loading Data... '</code> as part of the the update message</span>
<span class="comment-copy">Why not?  What difference does it make whether this is part of the progress bar context or not?</span>
<span class="comment-copy">It would require too much refactoring. <code>Loading Data... </code> isn't always the same - different functions that call this function print different string beforehand... and too many functions call this for me to refactor the function to take an extra parameter - I'd like to avoid that</span>
<span class="comment-copy">Also, your solution doesn't work, as it doesn't update progress based on the input file, which has an unknown number of lines (usually much greater than 100). So <code>bar.update(lineNumber)</code> is a <code>ValueError</code></span>
<span class="comment-copy">Then you can't use \r, you have to keep track of the offset position of the start of line somehow.  Either with your own idea (a bunch of \b characters) or learn <a href="https://docs.python.org/3/howto/curses.html" rel="nofollow noreferrer">curses</a>.</span>
