<div class="post-text" itemprop="text">
<p>I'm trying to extract some specifics elements from a XML. I download the data from an API and save in a variable as <code>sitios2</code>.</p>
<p>xml code:</p>
<pre><code>&lt;?xml version="1.0" encoding="utf-8" standalone="yes"?&gt;
&lt;lista&gt;&lt;sitio sitio_id="131997"&gt;
&lt;custom_id/&gt;    &lt;lang&gt;&lt;/lang&gt;
    &lt;fecha_alta&gt;2017-06-22 22:38:18&lt;/fecha_alta&gt;
&lt;observaciones/&gt;    &lt;ultimas24hrs&gt;  &lt;item id='imps24ad'&gt;0&lt;/item&gt;
    &lt;item id='clicks24'&gt;0&lt;/item&gt;
    &lt;item id='imps24blank'&gt;0&lt;/item&gt;
    &lt;item id='ctr24'&gt;0&lt;/item&gt;
&lt;/ultimas24hrs&gt;
&lt;fecha_baja/&gt;   &lt;sitio_id&gt;131997&lt;/sitio_id&gt;
    &lt;estado&gt;1&lt;/estado&gt;
    &lt;hex_sitio_id&gt;2039D
&lt;/hex_sitio_id&gt;
    &lt;url&gt;https://www.google.com.ar/&lt;/url&gt;
    &lt;nombre&gt;google.com.ar&lt;/nombre&gt;
&lt;/sitio&gt;
</code></pre>
<p>My code:</p>
<pre><code>import xml.etree.ElementTree as ET
root = ET.fromstring(sitios2)
for child in root:
    print(child.tag, child.attrib)
for item in root.iter('item'):
    print(item.attrib)
</code></pre>
<p>output I have is:</p>
<pre><code>('sitio', {'sitio_id': '131997'})

{'id': 'imps24ad'}
{'id': 'clicks24'}
</code></pre>
<p>what i'm looking for is a txt file with all data but only with the information I need:</p>
<pre><code>sitio_id="131997" 
fecha_alta 2017-06-22 22:38:18
imps24blank 0
estado 1 
url https://www.google.com.ar/
nombre google.com.ar
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.python.org/3/library/xml.etree.elementtree.html#xpath-support" rel="nofollow noreferrer">xpath</a></p>
<pre><code>for child in root.find("./sitio"):
    print(child.tag, child.text)
for item in root.findall('./sitio/ultimas24hrs/item'):
    print(item.tag, item.attrib, item.text)
</code></pre>
<p>output:</p>
<pre><code>custom_id None
lang None
fecha_alta 2017-06-22 22:38:18
observaciones None
ultimas24hrs   
fecha_baja None
sitio_id 131997
estado 1
hex_sitio_id 2039D

url https://www.google.com.ar/
nombre google.com.ar
item {'id': 'imps24ad'} 0
item {'id': 'clicks24'} 0
item {'id': 'imps24blank'} 0
item {'id': 'ctr24'} 0
</code></pre>
<p><strong>NOTE:</strong>
Your provided xml is not valid, so I assumed that your xml is:</p>
<pre><code>&lt;?xml version="1.0" encoding="utf-8" standalone="yes"?&gt;
&lt;lista&gt;
  &lt;sitio sitio_id="131997"&gt;
    &lt;custom_id/&gt;
    &lt;lang/&gt;
    &lt;fecha_alta&gt;2017-06-22 22:38:18&lt;/fecha_alta&gt;
    &lt;observaciones/&gt;
    &lt;ultimas24hrs&gt;
      &lt;item id="imps24ad"&gt;0&lt;/item&gt;
      &lt;item id="clicks24"&gt;0&lt;/item&gt;
      &lt;item id="imps24blank"&gt;0&lt;/item&gt;
      &lt;item id="ctr24"&gt;0&lt;/item&gt;
    &lt;/ultimas24hrs&gt;
    &lt;fecha_baja/&gt;
    &lt;sitio_id&gt;131997&lt;/sitio_id&gt;
    &lt;estado&gt;1&lt;/estado&gt;
    &lt;hex_sitio_id&gt;2039D&lt;/hex_sitio_id&gt;
    &lt;url&gt;https://www.google.com.ar/&lt;/url&gt;
    &lt;nombre&gt;google.com.ar&lt;/nombre&gt;
  &lt;/sitio&gt;
&lt;/lista&gt;
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Just iterate through <code>sitio</code> elements, and use XPath to find all information needed within current <code>sitio</code> in every iteration :</p>
<pre><code>for s in root.findall('sitio'):
    id = s.find('sitio_id')
    fa = s.find('fecha_alta')
    i24 = s.find('*/item[@id="imps24blank"]')
    estado = s.find('estado')
    url = s.find('url')
    nombre = s.find('nombre')

    print(id.tag, id.text)
    print(fa.tag, fa.text)
    print(i24.tag, i24.text)
    print(estado.tag, estado.text)
    print(url.tag, url.text)
    print(nombre.tag, nombre.text)
</code></pre>
<p><strong><kbd><a href="https://eval.in/943012" rel="nofollow noreferrer"><code>eval.in demo</code></a></kbd></strong></p>
<p>Break down of the XPath expression used to find <code>i24</code> value :</p>
<ul>
<li><code>*</code>: find child element of any name</li>
<li><code>/item</code>: then from such elements, find child elements named <code>item</code> where...</li>
<li><code>[@id="imps24blank"]</code>: ...<code>id</code> attribute value equals string "imps24blank"</li>
</ul>
</div>
<span class="comment-copy">I'm not exactly sure what you are looking for. Output a (stripped down) xml file again, the one you posted in the end of your post? Or extracting certain elements into a python-type, like a dict? What do you want to do with the data?</span>
<span class="comment-copy">Your XML tags don't match.</span>
<span class="comment-copy">I just edited @ascripter</span>
<span class="comment-copy">Yes, it's indeed a broken XML file. If that's what you need to handle, a regex-approach might be best. Otherwise fix your XML first.</span>
<span class="comment-copy">I fix the XML, do you have an idea how I can extract what I'm looking for? @ascripter</span>
<span class="comment-copy">The second for, I need the inner values: <code>item {'id': 'imps24blank'} "0"</code></span>
<span class="comment-copy">and also, why I can extract the information for only 1 sitio?? because I have more information as before but different sitio_id in the xml</span>
<span class="comment-copy">@MartinBouhier see the updated code</span>
<span class="comment-copy">@MartinBouhier if you need just item <code>id="imps24blank"</code> you can add if into for statement</span>
<span class="comment-copy">how can I mix all values as <code>custom_id None lang None fecha_alta 2017-06-22 22:38:18 observaciones None ultimas24hrs    fecha_baja None sitio_id 131997 estado 1 hex_sitio_id 2039D url https://www.google.com.ar/ nombre google.com.ar item {'id': 'imps24ad'} 0 item {'id': 'clicks24'} 0 item {'id': 'imps24blank'} 0 item {'id': 'ctr24'} 0</code></span>
<span class="comment-copy">I don´t understand how I should create a variable to extract the <code>imps24blank </code> with the results... <code>i24 = s.find('*/item[@id="imps24blank"]')</code>don't show me anything</span>
<span class="comment-copy">@MartinBouhier the eval.in demo provided in this answer showcases otherwise, it prints <code>item 0</code>. Please create minimal eval.in demo that demonstrate your problem, otherwise I have no idea how to help because the same code works in my demo..</span>
<span class="comment-copy">yes I saw then and I had the results I was looking for! Thanks man! Could you help me with my new questions?? it is very similar with this. <a href="https://stackoverflow.com/questions/48512286/fix-xml-syntax-errors-in-python?noredirect=1#comment84019908_48512286" title="fix xml syntax errors in python">stackoverflow.com/questions/48512286/…</a></span>
