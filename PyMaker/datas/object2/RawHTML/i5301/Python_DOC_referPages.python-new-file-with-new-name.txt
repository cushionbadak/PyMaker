<div class="post-text" itemprop="text">
<p>I have a python script which reads every new email in outlook and save the contents to a file. The problem is that the file gets over written when I receive a new email</p>
<p>How can I create a new file with different name in the same directory without overwriting the other file every time I receive a new email. here is what I have so far:</p>
<pre><code>import win32com.client
import pythoncom
path = "C:\\Users\\..\\....\\newEmail.txt"

class Handler_Class(object):
    def OnNewMailEx(self, receivedItemsIDs):
        for ID in receivedItemsIDs.split(","):
            mailitem_properties.aspx
            mailItem = outlook.Session.GetItemFromID(ID)

            file = open(path, "w")
            file.write(mailItem.SenderEmailAddress + "\n")
            file.write(mailItem.Subject + "\n")
            file.write(mailItem.Body + "\n")
            file.close()
outlook = win32com.client.DispatchWithEvents("Outlook.Application", Handler_Class)
pythoncom.PumpMessages()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>you can append time of creation to the file name every time you are about to create it like below:</p>
<pre><code>import win32com.client
import pythoncom
import time

class Handler_Class(object):
    def OnNewMailEx(self, receivedItemsIDs):
        for ID in receivedItemsIDs.split(","):
            mailitem_properties.aspx
            mailItem = outlook.Session.GetItemFromID(ID)
            path = "C:\\Users\\..\\....\\newEmail_" + time.ctime().replace(' ', '_') +  ".txt"
            file = open(path, "w")
            file.write(mailItem.SenderEmailAddress + "\n")
            file.write(mailItem.Subject + "\n")
            file.write(mailItem.Body + "\n")
            file.close()
outlook = win32com.client.DispatchWithEvents("Outlook.Application", Handler_Class)
pythoncom.PumpMessages()
</code></pre>
<p>Alternatively, you can get <code>mailItem</code> received time and append to the filename, so that it becomes unique filename.</p>
</div>
<span class="comment-copy">So generate a new email name. Take a look at the <a href="https://docs.python.org/3/library/os.path.html" rel="nofollow noreferrer"><code>os.path</code> module</a> to help you construct filenames and paths.</span>
<span class="comment-copy">@ascripter: they want new files, not to append to a single file.</span>
<span class="comment-copy">I have an error on: mailitem_properties.aspx. the is that the name is not defined</span>
<span class="comment-copy">That should be different problem, can you add full stack trace to your question or post it as new question?</span>
