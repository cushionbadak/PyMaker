<div class="post-text" itemprop="text">
<p>I want to write a python parser to turn dir result into csv or json.</p>
<h2>For example,the following is the result of <code>dir /a/s/od/ta</code>.</h2>
<pre><code>磁碟區 C 中的磁碟沒有標籤。
 磁碟區序號:  123-1234

 C:\ 的目錄

2009/07/14  上午 11:20    &lt;DIR&gt;          PerfLogs
2009/07/14  下午 01:08    &lt;JUNCTION&gt;     Documents and Settings [C:\Users]
2018/03/14  下午 04:09    12,796,198,912 hiberfil.sys
2018/03/14  下午 04:09    17,061,601,280 pagefile.sys
2018/03/14  下午 04:16    &lt;DIR&gt;          Recovery
2018/03/14  下午 04:17    &lt;DIR&gt;          Users
2018/03/14  下午 04:17    &lt;DIR&gt;          $Recycle.Bin
2018/03/14  下午 04:42    &lt;DIR&gt;          Intel
2018/03/14  下午 05:46    &lt;DIR&gt;          Python27
2018/03/22  下午 01:19                40 87E27E492B63
2018/03/31  上午 11:08    &lt;DIR&gt;          py36
2018/05/04  下午 06:12    &lt;DIR&gt;          ProgramData
2018/05/04  下午 06:12    &lt;DIR&gt;          Program Files (x86)
2018/05/04  下午 06:15    &lt;DIR&gt;          Windows
2018/05/07  上午 10:17    &lt;DIR&gt;          System Volume Information
2018/05/07  上午 10:19    &lt;DIR&gt;          Config.Msi
2018/05/08  上午 10:39    &lt;DIR&gt;          Program Files
               3 個檔案  29,857,800,232 位元組
</code></pre>
<hr/>
<p>I want it can be like the following.</p>
<pre><code>============================================================
|**name      |path  |lastaccess             |type**       |
|PerfLogs    |C:\   |2009/07/14 上午 11:20  |&lt;DIR&gt;         |
|hiberfil.sys|C:\   |2018/03/14  下午 04:09 |12,796,198,912|
|pagefile.sys|C:\   |2018/03/14  下午 04:09 |17,061,601,280|
|Recovery    |C:\   |2018/03/14  下午 04:16 |&lt;DIR&gt;         |
|Users       |C:\   |2018/03/14  下午 04:17 |&lt;DIR&gt;         |
|$Recycle.Bin|C:\    |2018/03/14  下午 04:17 |&lt;DIR&gt;         |
|Intel       |C:\   |2018/03/14  下午 04:42 |&lt;DIR&gt;         |
|Python27    |C:\   |2018/03/14  下午 05:46 |&lt;DIR&gt;         |
|87E27E492B63|C:\   |2018/03/22  下午 01:19 |40            |
|py36        |C:\   |2018/03/31  上午 11:08 |&lt;DIR&gt;         |
|ProgramData |C:\   |2018/05/04  下午 06:12 |&lt;DIR&gt;         |
|Windows     |C:\   |2018/05/04  下午 06:15 |&lt;DIR&gt;         |
|Config.Msi  |C:\   |2018/05/07  上午 10:19 |&lt;DIR&gt;         |
|ProgramFiles|C:\   |2018/05/08  上午 10:39 |&lt;DIR&gt;         |
===========================================================
</code></pre>
<p>Do you know any python library that I could use? 
Or,would you give me some advice if there were no library to use?
Thanks you very much.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can definitely use <strong>Pandas Library</strong> to create <strong>CSV</strong> files.</p>
<pre><code>import pandas as pd
</code></pre>
<p>Then store your dataframe or columns &amp; rows in a variable, Ex. <strong>df</strong>.</p>
<pre><code>df.to_csv(file_name, index = False, sep=',')
</code></pre>
<p>Here, your values will be seperated by a <strong>comma (,)</strong>. You can use <strong>"|"</strong> as your separator too.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <code>os.popen</code> with <code>re</code>:</p>
<pre><code>import os, re 
import csv
rows = [i.strip('\n') for i in os.popen('dir /a/s/od/ta')]
drive = re.findall('[A-Z]:', '\n'.join(rows))[0]+'\\'
directories = [re.split('\s{2,}|(?&lt;=\d)\s|\s(?=\d)', i) for i in rows if re.findall('^\d+/\d+/\d+|\&lt;[A-Z]+\&gt;', i)]
with open('dir_results.csv', 'w') as f:
  write = csv.writer(f)
  write.writerows([['**name', 'path', 'lastaccess', 'type**']]+[[c]+[drive]+[' '.join(a)]+[b] for *a, b, c in directories]) 
</code></pre>
<p>Output:</p>
<pre><code>**name,path,lastaccess,type**
PerfLogs,C:\,2009/07/14 上午 11:20,&lt;DIR&gt;
Documents and Settings [C:\Users],C:\,2009/07/14 下午 01:08,&lt;JUNCTION&gt;
hiberfil.sys,C:\,2018/03/14 下午 04:09,"12,796,198,912"
pagefile.sys,C:\,2018/03/14 下午 04:09,"17,061,601,280"
Recovery,C:\,2018/03/14 下午 04:16,&lt;DIR&gt;
Users,C:\,2018/03/14 下午 04:17,&lt;DIR&gt;
$Recycle.Bin,C:\,2018/03/14 下午 04:17,&lt;DIR&gt;
Intel,C:\,2018/03/14 下午 04:42,&lt;DIR&gt;
Python27,C:\,2018/03/14 下午 05:46,&lt;DIR&gt;
87E27E492B63,C:\,2018/03/22 下午 01:19,40
py36,C:\,2018/03/31 上午 11:08,&lt;DIR&gt;
ProgramData,C:\,2018/05/04 下午 06:12,&lt;DIR&gt;
Program Files (x86),C:\,2018/05/04 下午 06:12,&lt;DIR&gt;
Windows,C:\,2018/05/04 下午 06:15,&lt;DIR&gt;
System Volume Information,C:\,2018/05/07 上午 10:17,&lt;DIR&gt;
Config.Msi,C:\,2018/05/07 上午 10:19,&lt;DIR&gt;
Program Files,C:\,2018/05/08 上午 10:39,&lt;DIR
</code></pre>
</div>
<span class="comment-copy">Why not use the <a href="https://docs.python.org/2/library/csv.html" rel="nofollow noreferrer">csv</a> library?</span>
<span class="comment-copy">Because I don't know how to avoid redundant strings like "磁碟區 C 中的磁碟沒有標籤。 磁碟區序號:  123-1234 C:\ 的目錄". And I want to put file path into it.</span>
<span class="comment-copy">Why don't you use <a href="https://docs.python.org/3/library/os.html#os.listdir" rel="nofollow noreferrer"><code>os.listdir()</code></a> or <a href="https://docs.python.org/3/library/os.html#os.walk" rel="nofollow noreferrer"><code>os.walk()</code></a> coupled with <a href="https://docs.python.org/3/library/os.html#os.stat" rel="nofollow noreferrer"><code>os.stat()</code></a> instead of trying to parse a non-consistent external <code>dir</code> output?</span>
<span class="comment-copy">Well,there is a little problem. All path are "C:\". How can I do if I need full path?</span>
<span class="comment-copy">@BBBruce What constitutes the full path? <code>C:\ 的目錄</code>?</span>
<span class="comment-copy">Here is output after I run your code on Desktop. Why is the path not <code>C:\Users\Users\Desktop</code>? <a href="https://imgur.com/a/oKxplcd" rel="nofollow noreferrer">link</a></span>
<span class="comment-copy">@BBBruce Currently, the code only finds the drive. Is it possible that a path such as <code>C:\Users\Users\Desktop</code> could exist in the input?</span>
<span class="comment-copy">What do you mean""Is it possible that a path such as <code>C:\Users\Users\Desktop</code> could exist in the input?""??</span>
