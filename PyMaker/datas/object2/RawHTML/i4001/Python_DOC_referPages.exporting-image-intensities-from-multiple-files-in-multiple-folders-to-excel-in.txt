<div class="post-text" itemprop="text">
<p>I need to export lists of pixel intensities derived from multiple images in multiple folders to an excel spreadsheet. Each folder contains a list of tiff files each representing a certain time point in a timelapse. I've managed to obtain the pixel intensities of each folder subset, but I'm struggling with the output to excel using DataFrames with pandas. The data frame only displays the list of values from the last folder, and I need the spreadsheet to display each list in a separate row. Here is what I have:</p>
<pre><code>import os
import matplotlib.pyplot as plt
import skimage.external.tifffile as tiff
import pandas as pd
from pandas import DataFrame

#to read images in each folder
def load_images_from_folder(folder):
images=[]
for filename in os.listdir(folder):
    if any([filename.endswith(x) for x in ['.tif']]):
        img=tiff.imread(os.path.join(folder, filename))
        if img is not None:
            images.append(img)
return images

folders = [
    'path to folder1',
    'path to folder2',
    'path to folder3',
]

for folder in folders:
    images=load_images_from_folder(folder)

#ratio the mean green to red signal in each image 
    ratios = [image[..., 1].mean() / image[..., 0].mean() for image in 
    images]
    plt.plot(range(len(images)), ratios)
    plt.show()


df=DataFrame({'Ratios':ratios})
df.to_excel('Ratios.xlsx', sheet_name='sheet1', index=0)
</code></pre>
<p>Printing out the ratios gives: 
Folder1:
[list of values]
Folder2:
[list of values]
Folder3:
[list of values 
etc.
But the data displayed by df (DataFrame) is only from the list in Folder3. So, what do I need to do differently to export values derived from multiple folders into Excel? I also made sure that each image is read as a ndarray and the type=uint8.  </p>
</div>
<div class="post-text" itemprop="text">
<p>Replacing the assignment sentence inside the for loop by a call to the <a href="https://docs.python.org/3/tutorial/datastructures.html" rel="nofollow noreferrer"><code>extend</code></a> list method should fix the issue:</p>
<pre><code>images = []
for folder in folders:
    images.extend(load_images_from_folder(folder))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>import tkinter
from tkinter import filedialog
from tkinter import *
from tkinter import messagebox
from tkinter.filedialog import askdirectory
import os
import matplotlib.pyplot as plt
import skimage.external.tifffile as tiff
import pandas as pd
from pandas import DataFrame
import numpy as np

def load_images_from_folder(folder):
    images=[]
    for filename in os.listdir(folder):
        if any([filename.endswith(x) for x in ['.tif']]):
            img=tiff.imread(os.path.join(folder, filename))
            if img is not None:
                images.append(img)
    return images

tkinter.Tk().withdraw()   
dirname = askdirectory(initialdir="/", title='Please select a directory')
os.chdir(dirname)

data = pd.DataFrame([])
ratiodata = []
foldernames = []
for folder in os.listdir(dirname):  
    if not folder.endswith('.xlsx'):
       images=load_images_from_folder(folder)
       green=[image[..., 1].mean() for image in images]
       red=[image[..., 0].mean() for image in images]
       ratios= [img[..., 1].mean() / img[..., 0].mean() for img in images]
       #PLOTS
       temp = pd.DataFrame({folder + " ratios" : ratios})
       data = pd.concat([data,temp],axis=1)
data.to_excel('test.xlsx', sheet_name='sheet1')
</code></pre>
</div>
<span class="comment-copy">The extend list method did not work well when I tried to create the dataframes. Sorry I forgot to add the answer after I figured it out.</span>
<span class="comment-copy">No such luck. Also, shouldn't the name 'images' first be defined after the for loop?</span>
<span class="comment-copy">Indeed, you need to create <code>images</code> before invoking <code>extend</code> from it. By the way, you should fix indentation.</span>
<span class="comment-copy">The dataframe generates a list of all the data now. I'll just specify where to cut it to generate multiple columns in the spreadsheet.</span>
