<div class="post-text" itemprop="text">
<p>Let us say I have a list of dates:</p>
<pre><code>mydates = [Timestamp('2017-03-31 00:00:00'),
  Timestamp('2017-06-30 00:00:00')     
  Timestamp('2017-09-30 00:00:00'),
 Timestamp('2017-12-31 00:00:00'),
 Timestamp('2018-03-31 00:00:00')]
</code></pre>
<p>And I get a new date and want to know which position to insert it.  If the date is already in the list we assume we will insert it again to the right of existing date.</p>
<p>I.e., <code>'2016-12-10'</code> would be inserted in position 0, left to <code>Timestamp('2017-03-31 00:00:00')</code>, etc.</p>
</div>
<div class="post-text" itemprop="text">
<p>In general, the best you can do to find the location is a logarithmic search. But the details depends on what you have.</p>
<p>Also, notice that even if you improve the search from linear time to logarithmic, if you're using a data structure like a <code>list</code> or <code>array</code>, the <code>insert</code> is still going to take linear time (because it has to shift the rest of the list up). So you may be optimizing the wrong thing.</p>
<ul>
<li>For a very small collection, like a <code>list</code> of 5 values, you're probably better off just using linear search.</li>
<li>If you're doing almost all of your inserts in one phase, and then almost all of your searches after the collection is mostly already built, just collect everything with <code>set.add</code> or <code>list.append</code>, then <code>sort</code> it at the end of the phase. This is still effectively (amortized) log time, but with a much better multiplier.</li>
<li>For a <code>list</code> or other plain <code>Sequence</code>, use <a href="https://docs.python.org/3/library/bisect.html" rel="nofollow noreferrer"><code>bisect</code></a> from the stdlib. </li>
<li>For a numpy <code>array</code>, or something built on top of it like a pandas <code>Series</code>: use numpy's <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.searchsorted.html" rel="nofollow noreferrer"><code>searchsorted</code></a>. (If you're storing a bunch of Pandas <code>Timestamp</code> objects, you probably should be using one of these data structures instead of a <code>list</code>, if you aren't already.)</li>
<li>If you're doing lots of inserts (and deletes?) interleaved with lookups, you may want to switch to a logarithmic data structure. There are many options here, but something like <a href="https://pypi.org/project/blist/" rel="nofollow noreferrer"><code>blist</code></a> is a good place to start.</li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>If you have a sorted list, you can insert the new date and sort the result. You can also use <a href="https://pymotw.com/2/bisect/" rel="nofollow noreferrer">bisect</a>.</p>
</div>
<span class="comment-copy">It doesn't look like your dates are sorted.</span>
<span class="comment-copy">So what is <code>Timestamp</code>?</span>
<span class="comment-copy">Assuming <code>Timestamp</code> is from the pandas library, you should leverage <code>np.searchsorted</code>: <code>np.searchsorted(mydates, Timestamp('2016-12-10'))</code> â€” returns 0.</span>
<span class="comment-copy">If you have a sorted array, binary search is generally the best way to search it.</span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/8024571/insert-an-item-into-sorted-list-in-python">Insert an item into sorted list in Python</a></span>
