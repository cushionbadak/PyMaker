<div class="post-text" itemprop="text">
<p>So as you'll see from the code below, I'm scraping some info with Scrapy. Everything works fine, I'm just not happy the way the scraped data is stored. With the current code, I get results as a column of 'X' and a column of 'Y' side by side (which is fine), but the results for 'U' show up as a row as it is run from a 2nd loop. So what I would like, is to have the scraped data in three columns side by side: X / Y / U. Can anyone help with this? Thanks in advance!</p>
<pre><code>def parse(self, response):
    U = []
    for l in response.css('div.property-info-wrapper'):
        yield {
            'X': l.css('span.info-price::text').extract_first(),
            'Y': l.css('li::text').extract_first(),
        }

    for i in response.selector.xpath('//div[@class="property-info-location ellipsis-element-control"]/text()').extract():
        U.append(i)
    yield {'U':U}
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use <code>itertools.zip_longest</code> to zip both results together and yield them based on their Truth value <sup>*</sup>.</p>
<pre><code>from itertools import zip_longest

def parse(self, response):
    locations = response.selector.xpath('//div[@class="property-info-location ellipsis-element-control"]/text()').extract()
    css = response.css('div.property-info-wrapper')

    for loc, c in zip_longest(css, locations):
        if loc:
            yield {
                'X': loc.css('span.info-price::text').extract_first(),
                'Y': loc.css('li::text').extract_first(),
            }
        if c:
            yield {'U': c}  # since spider needs to return dict
</code></pre>
<hr/>
<p><sub>
*  <a href="https://docs.python.org/3/library/itertools.html#itertools.zip_longest" rel="nofollow noreferrer">itertools.zip_longest(*iterables, fillvalue=None)</a>:
Make an iterator that aggregates elements from each of the iterables. If the iterables are of uneven length, missing values are filled-in with fillvalue. Iteration continues until the longest iterable is exhausted.</sub></p>
<p></p></div>
<span class="comment-copy">can you post a minimal and testable html fragment containing all the needed items?</span>
<span class="comment-copy">Hi, the issue got fixed but thanks for the help!</span>
<span class="comment-copy">Hi, thank you for your answer. I made a small mistake in the initial code, 'locations' was intended to be 'U'. Don't know if that makes any difference in your answer.</span>
<span class="comment-copy">@fg42 Yeah I guessed that. I doesn't make any difference tho.</span>
<span class="comment-copy">I'm getting this error from scrapy: "Spider must return Request, BaseItem, dict or None, got 'str'". X &amp; Y are scraped correctly though.</span>
<span class="comment-copy">@fg42 I think that's because of <code>yield c</code> you can change it to <code>{'U': c}</code> or smth.</span>
<span class="comment-copy">okay it does work. Weirdly I get a lot of blank cells but I can remove them easily so that's not really an issue because all the data is scraped. Many thanks!</span>
