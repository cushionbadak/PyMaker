<div class="post-text" itemprop="text">
<p>I’d like to write a function to iterate over excel files that are in different folders. Parts of the path of each file are the same, for instance:  </p>
<p>C:\Main\Division\Reports\Year\Data.xls   </p>
<p>The only part of each path that changes is ‘Year’.  The files all have the same name.    </p>
<p>Is there a way to do this with a placeholder for Year?  If not, what approach should I take? </p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.python.org/3/library/os.html#os.listdir" rel="nofollow noreferrer">os.listdir</a> function</p>
<pre><code>directory = "C:\Main\Division\Reports"
root_dir = os.path.dirname(directory)
for data in os.listdir(directory):
      file_name = os.path.join(root_dir, data, 'Data.xls')
      # do something
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could try os.walk</p>
<pre><code>import os

parent = "C:\Main\Division\Reports"

for root, directory, files in os.walk(parent):
    print root
    print directory
    print files
</code></pre>
</div>
<span class="comment-copy">To clarify, do you need to iterate over all the directories in the parent directory (C:\Main\Division\Reports)?</span>
<span class="comment-copy"><code>from pathlib import Path</code> then <code>for p in Path(r'C:\Main\Division\Reports').glob('*/Data.xls'): do_stuff(p)</code></span>
<span class="comment-copy">@Sach I'd like to pull data from 1 file located in each Year folder</span>
<span class="comment-copy">@juanpa.arrivillaga thanks for your reply. I received an OSError: [WinError 123] The filename, directory name, or volume label syntax is incorrect. It seems .glob referenced the first folder listed in the Reports directory instead of the one I need</span>
<span class="comment-copy">@BeginnerKruman hm, I wrote that quickly and used unix syntax in the glob argument. Try using windows syntax. I don't really have a windows box to experiment with atm...</span>
