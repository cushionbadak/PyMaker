<div class="post-text" itemprop="text">
<p>I want to open multiple pdf files from a specific directory.The name of these files are taken from a csv file and it opened each matching between the csv and the name of the pdf file.</p>
<p>My problem is that only first match is opened not all.How can I fix that?</p>
<p>The code that I tried:</p>
<pre><code>import csv
import os
from pathlib import *

file1=open('CSV file.csv','r')
reader=csv.reader(file1,delimiter=';')
file_name=[]

dir_path = Path('C:\\path\\of\\directory')
pdf_files = dir_path.glob('*.pdf')

for item in reader:
    file_name=item[1]
    print(file_name)#just to see the file name that I want to open
    for pdffile in pdf_files:
        if item[1] in pdffile.name:
            os.startfile("%s"%(pdffile))

file1.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Ignoring potential filename lettercase issues, the reason only one pdf file is being opened is because <code>dir_path.glob('*.pdf')</code> returns a <a href="https://docs.python.org/3/glossary.html#term-generator" rel="nofollow">generator</a> object which you attempt to iterate over multiple times using the nested <code>for pdffile in pdf_files:</code> loop.</p>
<p>The simplest way to fix that is to convert the generator into a sequence object, like a <code>list</code>, that can be iterated over multiple times. I've done this in the code below as well as corrected or simplified a couple of other things.</p>
<pre><code>import csv
import os
from pathlib import *

dir_path = Path('C:\\path\\of\\directory')
pdf_files = list(dir_path.glob('*.pdf'))  # convert result to a list

with open('CSV file.csv', newline='') as file1:
    for row in csv.reader(file1, delimiter=';'):
        file_name = row[1]
        print(file_name)
        for pdffile in pdf_files:
            if file_name in pdffile.name:
                os.startfile(str(pdffile))
                break
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I suggest to iterate over the file names in your csv file and check every time if the file exists, instead of creating another list with existing files in the directory. You could use <code>os.path.isfile()</code> for that check.</p>
<p>Here's an example:</p>
<pre><code>import csv
import os

# access list with file names
with open('file1.csv', 'r') as file1:
    reader=csv.reader(file1,delimiter=';')

# iterate over files and open them
for item in reader:
    if os.path.isfile(item):
        print item
        os.startfile(item)
</code></pre>
<p>By using the <code>with open()</code> formalism, you don't have to bother closing the file afterwards. </p>
</div>
<div class="post-text" itemprop="text">
<p>The following should do what you want. First it reads in the second column entries from the CSV file and creates a lowercased set holding all of the filenames to be searched for. Next it uses the <code>glob.glob()</code> function to get a list of PDF files from your chosen folder. Lastly it checks to see if the file is in the list of required <code>pdf_filenames</code>, and if it is, launches them using the shell.</p>
<pre><code>import subprocess    
import glob    
import csv
import os

folder = r'C:\path\of\directory\*.pdf'

# Read the list of PDF filenames from the CSV
with open('CSV file.csv','r') as f_pdf_list:
    pdf_filenames = set(row[1].lower() for row in csv.reader(f_pdf_list, delimiter=';'))

# Get the list of files in the folder    
for pdf_file in glob.glob(folder):
    pdf_file = os.path.basename(pdf_file).lower()

    if pdf_file in pdf_filenames:
        subprocess.Popen([pdf_file], shell=True)
</code></pre>
<p>Note, I lowercase all of the filenames as Windows is case insensitive.        </p>
</div>
<span class="comment-copy">sorry I was wrong</span>
<span class="comment-copy">When you say you want to open PDF files, what do you mean? Do you want to somehow extract information from them, or perhaps launch them in a PDF viewer?</span>
<span class="comment-copy">Second option..thank you!</span>
<span class="comment-copy">Thank you!...now it is  working as I wanted.</span>
<span class="comment-copy">In this case, the path of csv should be the same with path of pdf files directory ?</span>
<span class="comment-copy">To be more specific...the csv file provide a code and I want to open from a specific directory the pdf file that match or contains in the file name respective code</span>
<span class="comment-copy">if <code>item</code> is absolute (something like 'C://path/file1.pdf'), you can use the code in my answer.  However if the file name <code>item</code> is relative (like <i>file1.pdf</i>), the files have to be in the current working directory. Otherwise you can easily connect a "path-string" to your filename-string: <code>fullpath = path + filename</code></span>
<span class="comment-copy">"item" from reader object is not like 'C://path/file1.pdf' , it is like 'file1' and I want to open from a specific directory the pdf file('C://path/file1.pdf') with name "file1" like I open it with double-click mouse ,but the issue is that  my code that I tried open only first match. How can I open the other pdf files from that directory that also were matched with the item from reader?</span>
<span class="comment-copy">Not sure if I understood. are there several files in a folder that match <i>file1</i>?</span>
<span class="comment-copy">thank you for your answer, but it seems that no pdf file is open....neither the one that I managed to open it with my code</span>
<span class="comment-copy">I'm guessing your csv file only contains the name and not the path. I've modified the script.</span>
<span class="comment-copy">Exactly...my csv contains only the names of pdf files</span>
