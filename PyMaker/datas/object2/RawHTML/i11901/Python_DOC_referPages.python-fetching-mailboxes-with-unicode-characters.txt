<div class="post-text" itemprop="text">
<p>I'm trying to write custom mail agent.
I am trying to fetch all mails, but my mailbox has polish letter in mailboxnames...
So this code (cut all prints from listing):</p>
<pre><code>def parse_list_response(self, line):
    list_response_pattern = re.compile(r'\((?P&lt;flags&gt;.*?)\) "(?P&lt;delimiter&gt;.*)" (?P&lt;name&gt;.*)')
    line=line.decode(encoding='utf_8')
    flags, delimiter, mailbox_name = list_response_pattern.match(line).groups()
    mailbox_name = mailbox_name.strip('"')
    return (flags, delimiter, mailbox_name)

def fetch_mails(self, from_who, since_when):
    server = imaplib.IMAP4_SSL(self.hostname)
    server.login(self.owner, self.password)
    rc, mailboxes = server.list()
    for line in mailboxes:
        mailbox=self.parse_list_response(line)[2]
        server.select(mailbox)
        try:
            messages = server.search('FROM "{}"'.format(from_who))
</code></pre>
<p>Gives me for example mailbox:</p>
<p>decoded = (\Flagged \HasNoChildren) "/" "[Gmail]/Oznaczone gwiazdk&amp;AQU-"</p>
<p>See: &amp;AQU-... it is polish "Ä…"</p>
<p>Question is how to get rid of this? I cannot find how to decode this bytecode</p>
</div>
<div class="post-text" itemprop="text">
<p>The encoding is IMAP4 Modified UTF-7, which is a convention used for international mailbox names, as defined in RFC3501, section <a href="http://tools.ietf.org/html/rfc3501#section-5.1.3" rel="nofollow">5.1.3</a>.</p>
<p>Unfortunately, the <a href="http://docs.python.org/3/library/imaplib.html#module-imaplib" rel="nofollow">imaplib</a> module doesn't currently support it - although there are several issues on the python bug tracker that suggest that may change in the near future (e.g. <a href="http://bugs.python.org/issue5305" rel="nofollow">issue 5305</a> and <a href="http://bugs.python.org/issue22598" rel="nofollow">issue 22598</a>).</p>
<p>Anyway, in the meantime, it looks like you will have to find a third-party package to handle this (e.g. <a href="http://bitbucket.org/mjs0/imapclient/" rel="nofollow">imapclient</a>).</p>
</div>
<span class="comment-copy">What type of object is <code>line</code> when it's passed into the method? Could you add an example of a raw <code>line</code>?</span>
