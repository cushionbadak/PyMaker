<div class="post-text" itemprop="text">
<p>I am working with Python on Spark and reading my dataset from a .csv file whose first a few rows are:</p>
<pre><code>17  0.2  7
17  0.2  7
39  1.3  7
19   1   7
19   0   7
</code></pre>
<p>When I read from the file line by line with the code below:</p>
<pre><code># Load and parse the data
def parsePoint(line):
   values = [float(x) for x in line.replace(',', ' ').split(' ')]
   return LabeledPoint(values[0], values[1:])
</code></pre>
<p>I get the this error: </p>
<pre><code>Traceback (most recent call last):
  File "&lt;stdin&gt;", line 3, in parsePoint
ValueError: could not convert string to float: "17"
</code></pre>
<p>Any help is greatly appreciated.</p>
</div>
<div class="post-text" itemprop="text">
<p>Following the comments below this answer, you should use:</p>
<pre><code>[float(x.strip(' "')) for x in line.split(',')]
</code></pre>
<p>You do not need to replace <code>','</code> with <code>' '</code>, you should simply <code>split</code> on <code>,</code> and then remove leading and trailing whitespaces and quotes (<code>x.strip(' "')</code>) before converting to <code>float</code>.</p>
<p>Also, have a look at the <a href="https://docs.python.org/3/library/csv.html" rel="nofollow"><code>csv</code></a> packages which may simplify your work.</p>
<hr/>
<p><em>Below is the answer to the original question (before comments).</em></p>
<p>You need to use <code>.split()</code> instead of <code>.split(' ')</code>. You have multiple consecutive space characters in your line, so splitting on <code>' '</code> results in empty strings, e.g. your first line is split into:</p>
<pre><code>['17', '', '0.2', '', '7']
</code></pre>
<p>The problem are those empty strings that you (obviously) cannot convert to <code>float</code>.</p>
<p>Using <code>split()</code> will solve the problem thanks to the behaviour of <code>split</code> when its <code>sep</code> argument is <code>None</code> (or not present):</p>
<blockquote>
<p>If the optional second argument sep is absent or None, the words are separated by arbitrary strings of whitespace characters (space, tab, newline, return, formfeed).</p>
</blockquote>
<p>See the doc of <a href="https://docs.python.org/2/library/string.html#string.split" rel="nofollow"><code>split</code></a>, and a small example to understand the difference:</p>
<pre><code>&gt;&gt;&gt; sp5 = ' ' * 5
&gt;&gt;&gt; sp5.split()
[]
&gt;&gt;&gt; sp5.split(' ')
['', '', '', '', '', '']
</code></pre>
</div>
<span class="comment-copy">You should be using <code>.split('|')</code>, not <code>.split(' ')</code></span>
<span class="comment-copy">I put those '|' characters to clarify the borders of the cells while posting my question. They do not exist in the actual file.</span>
<span class="comment-copy">Ah, well the whitespace should do that.  Just put the text into your question exactly how it is in the file.</span>
<span class="comment-copy">I will keep that in mind next time. Thanks.</span>
<span class="comment-copy">Could you <a href="https://stackoverflow.com/posts/36113328/edit">edit</a> the question then?</span>
<span class="comment-copy">I tried exactly as you said. Now, the same error except that it complains about another value which is 35. <code>Traceback (most recent call last):   File "&lt;stdin&gt;", line 3, in parsePoint ValueError: could not convert string to float: "35"</code></span>
<span class="comment-copy">@EmreBulut Could you show the line where this <code>35</code> is?</span>
<span class="comment-copy">The file has more than 1 million rows. I do not know which 35 it is complaining about..  I opened the file with a text editor this time: "35","1.3","7"  "29","1","7"  "24","1.2","7"  "24","1.1","7"  "19","0","7" "36","0","7" "19","1.2","7" "24","1.3","7"</span>
<span class="comment-copy">@EmreBulut One good idea to find the line could be to wrap your code into a try such as: <code>try: [float(x) for x in line.replace(',', ' ').split(' ')]; except ValueError: print(line); exit(1)</code>.</span>
<span class="comment-copy">@EmreBulut But it looks like your values are wrapped between <code>"</code> characters?</span>
