<div class="post-text" itemprop="text">
<p>So I used the distance function found on "<a href="https://gist.github.com/nickjevershed/6480846" rel="nofollow noreferrer">https://gist.github.com/nickjevershed/6480846</a>" as shown below</p>
<pre><code>def dist(lat1, long1, lat2, long2):

        # Convert latitude and longitude to 
        # spherical coordinates in radians.
        degrees_to_radians = math.pi/180.0

        # phi = 90 - latitude
        phi1 = (90.0 - lat1)*degrees_to_radians
        phi2 = (90.0 - lat2)*degrees_to_radians

        # theta = longitude
        theta1 = long1*degrees_to_radians
        theta2 = long2*degrees_to_radians

        # Compute spherical distance from spherical coordinates.

        # For two locations in spherical coordinates 
        # (1, theta, phi) and (1, theta, phi)
        # cosine( arc length ) = 
        #    sin phi sin phi' cos(theta-theta') + cos phi cos phi'
        # distance = rho * arc length

        cos = (math.sin(phi1)*math.sin(phi2)*math.cos(theta1 - theta2) + 
               math.cos(phi1)*math.cos(phi2))
        arc = math.acos( cos )

        # Remember to multiply arc by the radius of the earth 
        # in your favorite set of units to get length.
        return arc * 3959
</code></pre>
<p>However, When I tried to use it to calculate the value below, it gives me an math domain error. </p>
<pre><code>    dist(47.62, 122.35, 47.62, 122.35)

    ---------------------------------------------------------------------------
    ValueError                                Traceback (most recent call last)
    &lt;ipython-input-164-c70b6ce05167&gt; in &lt;module&gt;()
    ----&gt; 1 dist(47.62, 122.35, 47.62, 122.35)

    &lt;ipython-input-78-5d1b406c1007&gt; in dist(lat1, long1, lat2, long2)
         24     cos = (math.sin(phi1)*math.sin(phi2)*math.cos(theta1 - theta2) + 
         25            math.cos(phi1)*math.cos(phi2))
    ---&gt; 26     arc = math.acos( cos )
         27 
         28     # Remember to multiply arc by the radius of the earth

    ValueError: math domain
</code></pre>
<p>I've tried other values and all work fine. Is there some hidden logic I missed in the distance function or is there a requirement for the values to be calculated? </p>
</div>
<div class="post-text" itemprop="text">
<p>the problem is coming the fact you want to calculate a distance between same points so the result should be zero.</p>
<p>but with problem of rounding, you have a value cos &gt; 1</p>
<p>so its the reason of error. I suggest you to add a test:</p>
<pre><code>    # with your sample dist(47.62, 122.35, 47.62, 122.35)
    # cos = 1.0000000000000002, not good
    cos = (math.sin(phi1)*math.sin(phi2)*math.cos(theta1 - theta2) + 
           math.cos(phi1)*math.cos(phi2))
    cos = min(cos,1.0) #to securise the value
</code></pre>
<p>in this case you have the waited result: 0.0</p>
</div>
<span class="comment-copy">Can't reproduce - works fine for me (Python 3.7.2). Maybe try restarting your session (Kernel -&gt; restart) in case you've overwritten a value</span>
<span class="comment-copy">Restarting doesn't seem to work. Still getting the same error.</span>
<span class="comment-copy">Which Python version? Is your code exactly the same as you have here?</span>
<span class="comment-copy">Python 3.6.4. Jupyter Notebook 5.4.0. Both Anaconda distribution. The code is exactly the same</span>
