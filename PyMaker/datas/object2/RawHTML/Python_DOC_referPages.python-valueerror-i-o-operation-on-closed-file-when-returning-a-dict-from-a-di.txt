<div class="post-text" itemprop="text">
<p>I am getting ValueError: I/O operation on closed file when I return a dict from a csv file.  How should I do this? </p>
<pre><code>def main():
    groups = get_groups()
    for line in groups:
        print(line)

def get_groups():
    file1 = 'groups.csv'
    with open(file1, 'r') as file:
        groups = csv.DictReader(file)
    return groups
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could return a list</p>
<pre><code>def get_groups():
    file1 = 'groups.csv'
    with open(file1, 'r') as file:
        groups = csv.DictReader(file)
        return list(groups)
</code></pre>
<p>Or keep the file opened in main()</p>
<pre><code>def main():
    f = open('groups.csv')
    groups = get_groups(f)
    # Do your work
    f.close()

def get_groups(f):
    return csv.DictReader(f)
</code></pre>
</div>
<span class="comment-copy">This is happening because the <code>DictReader</code> <code>groups</code> isn't a memory copy of the whole file. It only retrieves a fresh <code>dict</code> from the file when you iterate over it. When your code closes the scope of the <code>with</code>, the context manager closes the file. But <code>DictReader</code> needs it to be open so that it can retrieve the data from it.</span>
