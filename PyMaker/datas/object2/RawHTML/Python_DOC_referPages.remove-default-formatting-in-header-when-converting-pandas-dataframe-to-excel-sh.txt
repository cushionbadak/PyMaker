<div class="post-text" itemprop="text">
<p>This is something that has been answered and re-answered time and time again because the answer keeps changing with updates to pandas. I tried some of the solutions I found here and elsewhere online and none of them have worked for me on the current version of pandas. Does anyone know the current, March 2019, pandas 0.24.2, fix for removing the default styling that a DataFrame gives to its header when converting it to an excel sheet? Simply using xlsxwriter to overwrite the styling does not work because of an issue with precedence. </p>
</div>
<div class="post-text" itemprop="text">
<p>Based largely on an example provided in the Xlsxwriter Docs (<a href="https://xlsxwriter.readthedocs.io/example_pandas_header_format.html" rel="nofollow noreferrer">link here</a>), the fully reproducible example below removes the default pandas header format in pandas 0.24.2.  Of note is that in <code>df.to_excel()</code>, I'm changing the <code>header</code> and <code>startrow</code> parameters.</p>
<pre><code>import xlsxwriter
import pandas as pd
import numpy as np

# Creating a dataframe 
df = pd.DataFrame(np.random.randn(100, 3), columns=list('ABC'))
column_list = df.columns
# Create a Pandas Excel writer using XlsxWriter engine.
writer = pd.ExcelWriter("test.xlsx", engine='xlsxwriter')

df.to_excel(writer, sheet_name='Sheet1', startrow=1, header=False, index=False)

# Get workbook and worksheet objects
workbook  = writer.book
worksheet = writer.sheets['Sheet1']


for idx, val in enumerate(column_list):
    worksheet.write(0, idx, val)

writer.save()

print(pd.__version__)
</code></pre>
<p>Expected Output:</p>
<pre><code>0.24.2
</code></pre>
<p><a href="https://i.stack.imgur.com/8TcVH.png" rel="nofollow noreferrer"><img alt="Expected Output" src="https://i.stack.imgur.com/8TcVH.png"/></a></p>
</div>
<span class="comment-copy">Could you add links of the previous questions/answers that no longer work?</span>
<span class="comment-copy">For example, this thread was a bust for me  <a href="https://stackoverflow.com/questions/36694313/pandas-xlsxwriter-format-header/36694513" title="pandas xlsxwriter format header">stackoverflow.com/questions/36694313/â€¦</a></span>
<span class="comment-copy">Clever solution. So you're essentially just removing the column labels, and then in a for loop, adding them back in, thus bypassing the default header styles. Worked great, thanks!</span>
