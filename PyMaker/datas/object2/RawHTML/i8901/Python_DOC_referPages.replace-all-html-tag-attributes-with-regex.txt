<div class="post-text" itemprop="text">
<p>I'm trying to figure out how can I add attribute <code>id=ID_&lt;number&gt;</code> to all tags in <code>html</code> snippet and remove another attributes.</p>
<p>For example:</p>
<pre><code>&lt;div class="..."&gt;...&lt;/div&gt;
</code></pre>
<p>to:</p>
<pre><code>&lt;div id="DIV_1"&gt;...&lt;/div&gt;
</code></pre>
<p>The <code>DIV</code> is a tag name in uppercase and _1 means ordering. So if this <code>&lt;div&gt;</code> would be a second tag, it would have <code>DIV_2</code> id. The ordering is in DFS meaning so if the <code>&lt;div id="DIV_2"&gt;..&lt;/div&gt;</code> has some child like <code>&lt;div id="DIV_2"&gt;&lt;ul class=".." style=".."&gt;...&lt;/ul&gt;&lt;/div&gt;</code>, the <code>ul</code> tag would have id: <code>UL_3</code>.</p>
<p>I tried to find all tags and then, remove their attributes and one by one add them their ID's.</p>
<p><code>re.findall(r'&lt;([a-z][a-z0-9]*)\b[^&gt;]*&gt;',snippet)</code> </p>
<p>This finds all tags. My idea is like:</p>
<pre><code>for i,tag in enumerate(tags):

    remove_all_attributes_from_tag
    get name of the tag and add set attribute "{}_{}".format(tag_name.upper,i)
</code></pre>
<p>But can't figure out how to continue.</p>
<p>The snippet:</p>
<pre><code>&lt;div id="wtab" class="pd_cont" style="display: table;"&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Display&lt;/h4&gt;&lt;span&gt;5.20-inch&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Processor&lt;/h4&gt;&lt;span&gt;2GHz octa-core&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Front Camera&lt;/h4&gt;&lt;span&gt;8-megapixel&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Resolution&lt;/h4&gt;&lt;span&gt;1080x1920 pixels&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;RAM&lt;/h4&gt;&lt;span&gt;3GB&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;OS&lt;/h4&gt;&lt;span&gt;Android 6.0&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Storage&lt;/h4&gt;&lt;span&gt;32GB&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Rear Camera&lt;/h4&gt;&lt;span&gt;16-megapixel&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Battery Capacity&lt;/h4&gt;&lt;span&gt;2650mAh&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>First replace all tag attributes with the id structure and a unique identifier. In a second step replace the unique identifier one by one in a loop.</p>
<p><strong>Code</strong></p>
<pre><code>import re
html_orig = '&lt;div id="wtab" class="pd_cont" style="display: table;"&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Display&lt;/h4&gt;&lt;span&gt;5.20-inch&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Processor&lt;/h4&gt;&lt;span&gt;2GHz octa-core&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Front Camera&lt;/h4&gt;&lt;span&gt;8-megapixel&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Resolution&lt;/h4&gt;&lt;span&gt;1080x1920 pixels&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;RAM&lt;/h4&gt;&lt;span&gt;3GB&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;OS&lt;/h4&gt;&lt;span&gt;Android 6.0&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Storage&lt;/h4&gt;&lt;span&gt;32GB&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Rear Camera&lt;/h4&gt;&lt;span&gt;16-megapixel&lt;/span&gt;&lt;/div&gt;&lt;div class="pd_colmn"&gt;&lt;h4&gt;Battery Capacity&lt;/h4&gt;&lt;span&gt;2650mAh&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;'
html_edit = re.sub('(&lt;[\w\d]+)(\s?[\w\d\s=;"_:]*)(&gt;)',
                   '\g&lt;1&gt; id="DIV_!id!\g&lt;3&gt;', html_orig)
i = 1
while True:
    sub = re.subn('!id!', str(i), html_edit, count=1)
    if sub[1] == 0:
        break
    html_edit = sub[0]
    i += 1
</code></pre>
<p><a href="https://docs.python.org/3/library/re.html#re.subn" rel="nofollow noreferrer"><code>re.subn()</code></a> returns a tuple including the number of subs, this enables the break condition for the loop.</p>
<p><strong>Result</strong></p>
<pre><code>'&lt;div id="DIV_1&gt;&lt;div id="DIV_2&gt;&lt;h4 id="DIV_3&gt;Display&lt;/h4&gt;&lt;span id="DIV_4&gt;5.20-inch&lt;/span&gt;&lt;/div&gt;&lt;div id="DIV_5&gt;&lt;h4 id="DIV_6&gt;Processor&lt;/h4&gt;&lt;span id="DIV_7&gt;2GHz octa-core&lt;/span&gt;&lt;/div&gt;&lt;div id="DIV_8&gt;&lt;h4 id="DIV_9&gt;Front Camera&lt;/h4&gt;&lt;span id="DIV_10&gt;8-megapixel&lt;/span&gt;&lt;/div&gt;&lt;div id="DIV_11&gt;&lt;h4 id="DIV_12&gt;Resolution&lt;/h4&gt;&lt;span id="DIV_13&gt;1080x1920 pixels&lt;/span&gt;&lt;/div&gt;&lt;div id="DIV_14&gt;&lt;h4 id="DIV_15&gt;RAM&lt;/h4&gt;&lt;span id="DIV_16&gt;3GB&lt;/span&gt;&lt;/div&gt;&lt;div id="DIV_17&gt;&lt;h4 id="DIV_18&gt;OS&lt;/h4&gt;&lt;span id="DIV_19&gt;Android 6.0&lt;/span&gt;&lt;/div&gt;&lt;div id="DIV_20&gt;&lt;h4 id="DIV_21&gt;Storage&lt;/h4&gt;&lt;span id="DIV_22&gt;32GB&lt;/span&gt;&lt;/div&gt;&lt;div id="DIV_23&gt;&lt;h4 id="DIV_24&gt;Rear Camera&lt;/h4&gt;&lt;span id="DIV_25&gt;16-megapixel&lt;/span&gt;&lt;/div&gt;&lt;div id="DIV_26&gt;&lt;h4 id="DIV_27&gt;Battery Capacity&lt;/h4&gt;&lt;span id="DIV_28&gt;2650mAh&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;'
</code></pre>
</div>
<span class="comment-copy">Thanks, this works almost perfectly. Just one thing. If there is for example id="wtab-8585" instead of id="wtab", it starts to replace IDS from the second tag. &lt;div id="wtab-8585" class="pd_cont" style="display: table;"&gt;&lt;div id="DIV_1&gt;&lt;h4 id="DIV_2&gt;Display&lt;...</span>
<span class="comment-copy">I've added "-" and it works great.</span>
