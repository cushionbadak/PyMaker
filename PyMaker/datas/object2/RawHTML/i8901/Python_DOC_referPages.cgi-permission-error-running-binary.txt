<div class="post-text" itemprop="text">
<p>I'm testing with a simple cgi example, but I can't get around a permission error. Here are the details.</p>
<p><strong>a.c</strong></p>
<pre><code>#include &lt;stdio.h&gt;

int main(void)
{
    puts("Content-type: text/html\n");
    puts("Hello, world!");
    return 0;
}
</code></pre>
<p>compiled with</p>
<pre><code>gcc a.c
</code></pre>
<p><strong>index.html</strong></p>
<pre><code>&lt;html&gt;
    &lt;body&gt;
        &lt;p&gt;Hello, world!&lt;/p&gt;
        &lt;a href="cgi-bin/a.out"&gt;test&lt;/a&gt;
    &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p><strong>start-server.sh</strong></p>
<pre><code>sudo python -m http.server --cgi 80
</code></pre>
<p>Whenever I click 'test', the server complains that permission is denied, with this log.</p>
<pre><code>Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...
192.168.0.1 - - [24/Feb/2017 19:41:48] "GET / HTTP/1.1" 200 -
192.168.0.1 - - [24/Feb/2017 19:41:49] "GET /cgi-bin/a.out HTTP/1.1" 200 -
----------------------------------------
Exception happened during processing of request from ('192.168.0.1', 51670)
Traceback (most recent call last):
  File "/usr/lib/python3.6/http/server.py", line 1126, in run_cgi
    os.execve(scriptfile, args, env)
PermissionError: [Errno 13] Permission denied: '/home/mj/http/cgi-bin/a.out'
----------------------------------------
192.168.0.1 - - [24/Feb/2017 19:41:49] CGI script exit status 0x7f00
</code></pre>
<p>If it matters, the permission for <code>a.out</code> is <code>rwxr-xr-x</code></p>
</div>
<div class="post-text" itemprop="text">
<p>The documentation for <a href="https://docs.python.org/3/library/http.server.html#http.server.CGIHTTPRequestHandler" rel="nofollow noreferrer">http.server.CGIHTTPRequestHandler</a> has the following notice:</p>
<blockquote>
<p>Note that CGI scripts will be run with UID of user nobody, for security reasons. Problems with the CGI script will be translated to error 403</p>
</blockquote>
<p>Your problem is that you started the server with <code>sudo</code> and therefore the server is running as root and <em>thus</em> capable of changing the <em>uid</em> to <em>nobody</em>. If you ran it without <code>sudo</code>, then it would be executing with your user account and perfectly capable of running that cgi script.</p>
</div>
<span class="comment-copy">The error seems is likely not about the content of the script, but about access permissions to it for the user of the web server process.</span>
<span class="comment-copy">@dmi Okay, so how do I grant access permissions for the user, or are you saying there's a better stackexchange site for such problem?</span>
<span class="comment-copy">This is not a C question <b>at all</b>, your cgi is not even executed.</span>
<span class="comment-copy">The server fails to run without sudo. It fails in <code>self.socket.bind(self.server_address)</code></span>
<span class="comment-copy">Because you cannot bind the port 80 without root - use another port then (you're hopefully not doing a <b>production</b> system with this setup anyway)</span>
<span class="comment-copy">It's a home server for testing web-apps. Anyway your answer helps.</span>
<span class="comment-copy">I wouldn't expect <code>http.server</code> to behave in the same manner as a real webserver would; I'd recommend installing apache, nginx or such, even if on a home server.</span>
