<div class="post-text" itemprop="text">
<p>Total beginner with Python, need help to achieve a task!</p>
<p>I have two csv files. old.csv and new.csv</p>
<p>Both have same structure (A to Z columns), and each record has a unique identifier which is a number, in column F (sixth column). Between these two CSVs there are a few duplicates records.</p>
<p>Iâ€™m looking for a way to eliminate records that are also in the old.csv, from the new.csv and output to a new file that has the same structure, so the new output.csv has truly only the new records.</p>
<p>What's a good way to achieve this? I need to be able to run this on a windows machine through a command line.</p>
<p>Any help is appreciated! Thanks in advance!</p>
</div>
<div class="post-text" itemprop="text">
<p>Read the csv file and map it to tuple</p>
<pre><code>import csv

f = open('old.csv', 'rb')
reader = csv.reader(f)
reader =  map(tuple,reader)

fn = open('new.csv', 'rb')
readern = csv.reader(fn)
readern = map(tuple,readern)
</code></pre>
<p>Get all unique identifiers in old.csv</p>
<pre><code>from operator import itemgetter
reader= map(itemgetter(5), reader)
</code></pre>
<p>add all items whose identifier is not in old.csv, add them to unique list</p>
<pre><code>unique= [item for item in readern if item[5] not in reader]
</code></pre>
<p>Write the rows to output.csv</p>
<pre><code>output = open("output.csv", 'wb')
wr = csv.writer(output)
for row in unique:
        wr.writerow(row)
output.close()
</code></pre>
<p>Hope this helps!</p>
</div>
<div class="post-text" itemprop="text">
<p>A simple approach would be:</p>
<ul>
<li>collect all identifiers from old.csv in a set</li>
<li>loop through new.csv</li>
<li>if a record has an identifier that's noz in your set, write it to output.csv</li>
</ul>
<p>You will probably want to use the <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">csv</a> module for reading and writing the files.</p>
</div>
<span class="comment-copy">you need to remove the duplicate identifier in new.csv and output to another file? am i right?</span>
<span class="comment-copy">yes, that's correct</span>
