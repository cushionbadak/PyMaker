<div class="post-text" itemprop="text">
<p>I have a .py file with a script. </p>
<p>I want to run it from the PowerShell. I can do it by writing:</p>
<pre><code>C:\Users\AAA\AppData\Local\Continuum\Anaconda3\pythonw.exe "X:\Data\_Private\Data\test.py"
</code></pre>
<p>However I want to pass some arguments to the script. Thus, I set all script as a <code>main(argument1, argument2)</code> function. It looks like this:</p>
<pre><code>def main(argument1, argument2):
    def Hello(argument1, argument2):
        print("Hi " + argument1 + " and " + argument2 + "!")
</code></pre>
<p>And the rest of the script continues.</p>
<p>Maybe someone could tell me how can I run that script from PowerShell in one line and passing arguments?</p>
</div>
<div class="post-text" itemprop="text">
<p>I think something like this is what you are looking for:</p>
<pre><code>import sys

def Hello(argument1, argument2):
    print("Hi " + argument1 + " " + argument2 + "!")

if __name__ == "__main__":
    Hello(sys.argv[1],sys.argv[2])
</code></pre>
<p>And from PowerShell:</p>
<pre><code>python test.py 1 2
</code></pre>
<p>Of course you probably want to check your argv indices are within range.</p>
</div>
<div class="post-text" itemprop="text">
<p>The use of the main funciton should looks like this:</p>
<pre><code>import sys

def hello(argument1,argument2):
    print("Hi " + argument1 " and " + argument2 "!"

if __name__ == "__main__":
    arg1 = sys.argv[1]
    arg2 = sys.argv[2]
    hello(arg1, arg2)
</code></pre>
<p>You only define the function main but you never call it.</p>
<p>Read for example here more about main: <a href="https://docs.python.org/3/library/__main__.html" rel="nofollow noreferrer">main</a><br/>
Read more about sys.argv: <a href="https://docs.python.org/3/library/sys.html" rel="nofollow noreferrer">sys_argv</a></p>
</div>
<span class="comment-copy">Thank  you for the solution, it works !! However, I have some packages in my script that don't want to load, e.g. {from monthdelta import monthdelta} or {from openpyxl import Workbook} . I get the error: &lt;pre&gt;ImportError: No module named 'monthdelta'&lt;code&gt;. However, {import pandas as pd} or several other packages don't cause the same problem. Maybe you could help on this as well?</span>
<span class="comment-copy">Give me an accept if you think the answer works.</span>
<span class="comment-copy">Only just saw your comment. Try typing on the powershell prompt: pip install monthdelta</span>
<span class="comment-copy">It worked after I tried to run by writing full path to python (C:/..../python.exe). However, I encountered another error. I have a logger in the script, that send an e-mail when script raises an error. Even though, script runs well and delivers the correct result, I get an error, that argument was not passed to the function (without the argument I wouldn't get desired result). Maybe, you what might be an issue?</span>
<span class="comment-copy">Thank  you for the solution, it works !! However, I have some packages in my script that don't want to load, e.g. from monthdelta import monthdelta or from openpyxl import Workbook . I get the error: ImportError: No module named 'monthdelta'. However, import pandas as pd or several other packages don't cause the same problem. Maybe you could help on this as well?</span>
<span class="comment-copy">Did you install the modules? You have to install them (pip install &lt;modulename&gt;.</span>
<span class="comment-copy">I have all modules installed and it worked after I tried to run by writing full path to python (C:/..../python.exe) to PowerShell instead of 'python'. However, I encountered another error. I have a logger in the script, that send an e-mail when script raises an error. Even though, script runs well and delivers the correct result, I get an error, that argument was not passed to the function (without the argument I wouldn't get desired result). Maybe, you what might be an issue?</span>
