<div class="post-text" itemprop="text">
<p><a href="https://stackoverflow.com/questions/14197782/win32api-pyhook-how-to-get-the-users-typing-language">win32api &amp; pyhook - How to get the user's typing language?</a></p>
<p>In this topic there is clear answer how to get current user language, but I wanna use set with get.</p>
<p>This probably should be a function </p>
<p><code>ctypes.windll.user32.ActivateKeyboardLayout()</code> </p>
<p>With some params.</p>
<p>Is there a way in python how to use this function (in the way like it was described in topic above?)</p>
</div>
<div class="post-text" itemprop="text">
<p>I just read the question update (that was reverted). Here's how to do it via <a href="https://docs.python.org/3/library/ctypes.html#module-ctypes" rel="nofollow noreferrer">[Python 3]: ctypes - A foreign function library for Python</a>:</p>
<p><em>code.py</em>:</p>
<pre class="lang-py prettyprint-override"><code>#!/usr/bin/env python3

import ctypes
from ctypes import wintypes


KLF_ACTIVATE = 0x00000001


def main():
    locale_id_bytes = b"00000409"
    klid = ctypes.create_string_buffer(locale_id_bytes)
    user32_dll = ctypes.WinDLL("user32")
    kernel32_dll = ctypes.WinDLL("kernel32")
    LoadKeyboardLayout = user32_dll.LoadKeyboardLayoutA
    LoadKeyboardLayout.argtypes = [wintypes.LPCSTR, wintypes.UINT]
    LoadKeyboardLayout.restype = wintypes.HKL
    GetLastError = kernel32_dll.GetLastError
    GetLastError.restype = wintypes.DWORD

    klh = LoadKeyboardLayout(klid, KLF_ACTIVATE)
    print("{} returned: {}".format(LoadKeyboardLayout.__name__, hex(klh)))
    print("{} returned: {}".format(GetLastError.__name__, GetLastError()))


if  __name__ == "__main__":
    main()
</code></pre>
<p><strong>Output</strong>:</p>
<blockquote>
<pre><code>(py35x64_test) E:\Work\Dev\StackOverflow\q048287040&gt;"e:\Work\Dev\VEnvs\py35x64_test\Scripts\python.exe" code.py
LoadKeyboardLayoutA returned: 0x4090409
GetLastError returned: 0
</code></pre>
</blockquote>
</div>
<span class="comment-copy">You want to do it for the current thread? Or how? You'll have to be more specific. Also you should provide your attempts to get this done, instead of waiting for someone to magically do it for you.</span>
<span class="comment-copy">yes, in same thread, and i was already did it myself via module win32api using "win32api.LoadKeyboardLayout(laycode,1)", where laycode is '00000409' for english and can be found here <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd318693(v=vs.85).aspx" rel="nofollow noreferrer">msdn.microsoft.com/en-us/library/windows/desktop/â€¦</a> . I found decision i looked for, but i still want to know if it possible via ctypes</span>
<span class="comment-copy">I see. However could you post (in the question not in a comment) the <i>win32api</i> code so it's obvious what it <i>ctypes</i> counterpart should do?</span>
<span class="comment-copy"><a href="//meta.stackexchange.com/a/116105/295637">You do not need to mark questions as "SOLVED" via editing the title</a>, or <a href="//meta.stackexchange.com/a/109959/295637">posting updates/thanks in posts</a>. Simply add your own answer, and mark as accepted. Anything additional can be perceived as noise for future visitors. See: <a href="//stackoverflow.com/help/self-answer">Can I answer my own question?</a>.</span>
