<div class="post-text" itemprop="text">
<p>Please, help. I have a data file with 4 columns (userid, movieid, score, timestamp) that looks like this:</p>
<pre><code>196 242 3   881250949
186 302 3   891717742
22  377 1   878887116
196 51  2   880606923
62  257 2   879372434
</code></pre>
<p>I am trying to create a nested dictionary that should look like this:</p>
<blockquote>
<p>users = {'196': [('242', '3'), ('51', '2')], '186': ['302','3'] ...}</p>
</blockquote>
<p>My code only picks up one tuple (movieid, score) for each userid:</p>
<pre><code>def create_users_dict():
    try:
        users = {}
        for line in open('u.data'):
            (id, movieid, rating, timestamp) = line.split('\t')[0:4]
            users[id] = (movieid, rating)
    except IOError as ioerr:
        print('There is an error with the file:' + str(ioerr))
    return users
users = create_users_dict()
</code></pre>
<blockquote>
<p>users = {'196': ('51', '2'), '186': ('302', '3')...}</p>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="https://docs.python.org/3/library/stdtypes.html#dict.setdefault" rel="nofollow noreferrer">setdefault</a>:</p>
<pre><code>def create_users_dict():
    try:
        users = {}
        for line in open('u.data'):
            uid, movie_id, rating, timestamp = line.split()
            users.setdefault(uid, []).append((movie_id, rating))
        return users
    except IOError as ioerr:
        print('There is an error with the file:' + str(ioerr))
users = create_users_dict()

print(users)
</code></pre>
<p><strong>Output</strong></p>
<pre><code>{'196': [('242', '3'), ('51', '2')], '62': [('257', '2')], '186': [('302', '3')], '22': [('377', '1')]}
</code></pre>
<p>A possible alternative is to check if the key (<code>uid</code>) is in the dictionary, in case is missing initialize the value with the empty list and then simply append.</p>
<pre><code>def create_users_dict():
    try:
        users = {}
        for line in open('u.dat'):
            uid, movie_id, rating, timestamp = line.split()
            if uid not in users:
                users[uid] = []
            users[uid].append((movie_id, rating))
        return users
    except IOError as ioerr:
        print('There is an error with the file:' + str(ioerr))
</code></pre>
<p>As a <em>side note</em> you should not use <code>id</code> as a name because it shadows the built-in function <a href="https://docs.python.org/3/library/functions.html#id" rel="nofollow noreferrer">id</a>.</p>
</div>
<span class="comment-copy">Fantastic! Very much thank you!!!</span>
