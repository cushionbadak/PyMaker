<div class="post-text" itemprop="text">
<p>I am trying to loop through sites on Rightmove.co.uk and print out price of listings into an excel spreadsheet. For this final step (printing to excel), i figured I might need a double 'for' loop, however i am getting a TypeError with the zip function.</p>
<p>Please see my code below:</p>
<pre><code>import re
from urllib.request import urlopen as uReq
from bs4 import BeautifulSoup as soup
from xlwt import Workbook, Formula


wb = Workbook()                     # Create workbook
sheet1 = wb.add_sheet('Sheet 1')    # Create sheet, name Sheet 1 etc.
wb.save('xlwt.example.xls')         # Save the workbook under the name

postcode_list = {"5E2764","5E1682","5E757"} #   Define list of strings referring to each postcode to query


#### Loop through the various postcodes  ####
for url in postcode_list:
    my_url = "https://www.rightmove.co.uk/property-to-rent/find.html?searchType=RENT&amp;locationIdentifier=OUTCODE%"+ url +"&amp;insId=1&amp;radius=0.0&amp;minPrice=&amp;maxPrice=&amp;minBedrooms=&amp;maxBedrooms=&amp;displayPropertyType=&amp;maxDaysSinceAdded=&amp;sortByPriceDescending=&amp;_includeLetAgreed=on&amp;primaryDisplayPropertyType=&amp;secondaryDisplayPropertyType=&amp;oldDisplayPropertyType=&amp;oldPrimaryDisplayPropertyType=&amp;letType=&amp;letFurnishType=&amp;houseFlatShare="
    print(my_url)

# Opening connection and grabbing page
uClient = uReq(my_url)
page_html = uClient.read()
uClient.close()                 # Closes after reading

page_soup = soup(page_html, "html.parser")

containers = page_soup.findAll("span",{"class":"propertyCard-priceValue"})
print(len(containers))      # the number of containers on one page


for container, i in zip(containers, 25):   # loop through all containers
    price_container = container.get_text()
    sheet1.write(i,0,price_container)
    print(price_container)
    wb.save('xlwt.example.xls')
</code></pre>
<p>Any suggestions would be very much appreciated.
Thanks,</p>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/functions.html#zip" rel="nofollow noreferrer"><code>zip</code></a> takes iterables as arguments and produces a tuple by zipping each together. For examples <code>zip('abc', 'def')</code> produces <code>['ad', 'be', 'cf']</code> (I converted to a list).</p>
<p>It looks like you want want the index of each element in <code>containers</code>. In that case you can use <a href="https://docs.python.org/3/library/functions.html#enumerate" rel="nofollow noreferrer"><code>enumerate</code></a>:</p>
<pre><code>for i, container in enumerate(containers):
    ...
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><code>zip</code> requires an iterator to loop, <code>25</code> is not an iterator.</p>
<p>You probably want to use:</p>
<pre><code>for container, i in zip(containers, range(25)):
</code></pre>
<p>if 25 is the length of the container, then use enumerate:</p>
<pre><code>for i, container in enumerate(containers):
</code></pre>
</div>
<span class="comment-copy">What are you intending to do with <code>zip(containers, 25)</code>?</span>
<span class="comment-copy">Please explain what <code>zip(iterable, integer)</code> is supposed to produce.</span>
<span class="comment-copy">Perhaps you want to use <code>for container, i in enumerate(containers)</code> instead?</span>
<span class="comment-copy">Thank you so much. It now works. I will read into the enumerate function.</span>
<span class="comment-copy">Thanks for your reply. So I chose 25 because that is the length of 'containers', given there are 25 listings per page.  Why does range(containers) or len(containers) not work in place of that '25'? I have just tried and I have the error again.</span>
<span class="comment-copy">range(containers) is not valid, range expects numbers as parameters. len(containers) returns just one value, not an iterator, so you need to call range on your value.</span>
<span class="comment-copy">Thank you for clarifying this. Really appreciate you response.</span>
