<div class="post-text" itemprop="text">
<p>I am trying to modify the values of one column if they fall between the following time (17:00 to 23:00), otherwise, they have to keep the same values. This is my code:</p>
<pre><code>lclstd['Response KWH/hh (per half hour) ']=lclstd['KWH/hh (per half hour) '].astype(float)
</code></pre>
<p>Extracting time from datetime column </p>
<pre><code>lclstd['Time']=pd.to_datetime(lclstd['DateTime']).dt.strftime ('%H:%M:%S')
</code></pre>
<p>Assigning response only during peak time from 17:00 to 23:00</p>
<pre><code>lclstd.loc[(lclstd['Time'] == '17:00:00') | (lclstd['Time'] == '17:30:00') | (lclstd['Time'] == '18:00:00') | (lclstd['Time'] == '18:30:00') | (lclstd['Time'] == '19:00:00') | (lclstd['Time'] == '19:30:00') | (lclstd['Time'] == '20:00:00') | (lclstd['Time'] == '20:30:00') | (lclstd['Time'] == '21:00:00') | (lclstd['Time'] == '21:30:00') | (lclstd['Time'] == '22:00:00') | (lclstd['Time'] == '22:30:00') | (lclstd['Time'] == '23:00:00') , 'Response KWH/hh (per half hour) '] = 0.9*lclstd['Response KWH/hh (per half hour) ']
</code></pre>
<p>but I get the following error</p>
<pre><code>ValueError: cannot reindex from a duplicate axis
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.dt.time.html" rel="nofollow noreferrer"><code>pd.Series.dt.time</code></a> returns <a href="https://docs.python.org/3/library/datetime.html#datetime.time" rel="nofollow noreferrer"><code>datetime.time</code></a> objects. So you can perform a comparison via <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.between.html" rel="nofollow noreferrer"><code>pd.Series.between</code></a> to create mask. Then feed to <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.loc.html" rel="nofollow noreferrer"><code>loc</code></a>:</p>
<pre><code>from datetime import time

time1, time2 = time(17), time(23)                # 17:00, 23:00

df['Time'] = pd.to_datetime(df['Time'])          # convert to datetime if necessary
mask = df['Time'].dt.time.between(time1, time2)  # inclusive of boundaries by default

df.loc[mask, 'Response KWH/hh (per half hour) '] *= 0.9
</code></pre>
</div>
<span class="comment-copy">Could you provide the input dataframe lclstd?</span>
<span class="comment-copy">The data can be download it from this link because it is too heavy, it is one of the 168 files, you can select whatever of those, all of them contain information of 36 different households  <a href="https://data.london.gov.uk/dataset/smartmeter-energy-use-data-in-london-households" rel="nofollow noreferrer">data.london.gov.uk/dataset/â€¦</a>  I cut it with the following function to make it easier to manipulate  lclstd=pd.read_csv('Power-Networks-LCL-June2015(withAcornGps)v2_2.csv', index_col=0, nrows=1000)</span>
<span class="comment-copy">I tried your solution but the following error pops up  time() takes no arguments (1 given)</span>
<span class="comment-copy">Did you <code>from datetime import time</code> ? Works fine for me on Python 3.6.</span>
<span class="comment-copy">@JonathanBudez, More likely you've named another variable <code>time</code> earlier on (don't do this; use more descriptive variables so there's no clash).</span>
