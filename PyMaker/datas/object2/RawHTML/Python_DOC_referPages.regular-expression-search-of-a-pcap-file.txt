<div class="post-text" itemprop="text">
<p>We have been given a PCAP file and my job is to find: </p>
<p><em>The user of the host PC tried to access some suspected website whose domain name ends with <strong>.top</strong>. Use Python (with the help of Regular Expression) to find the susceptible website.</em></p>
<p>By opening the PCAP file on notepad and doing a Ctrl + F search through it I have already found the correct answer to be: <strong><a href="http://p27dokhpz2n7nvgr.1jw2lx.top" rel="nofollow noreferrer">http://p27dokhpz2n7nvgr.1jw2lx.top</a></strong></p>
<p>However this is obviously not the purpose of the assignment as I have to use Python and Regular Expression to return that website</p>
<p>The code I have tried so far is:</p>
<pre><code>import re

pcapfile = open('CyberSecurity2019.pcap', 'rb')

mypattern = re.compile(rb"\S+\.top\b")

x = mypattern.findall(pcapfile.read())

print("x = ", x)
</code></pre>
<p>However this is what it returns:</p>
<pre><code>x =  [b"c('_SS','R','20',0,'/');f=_w.top", b'g_triggerElems!==e&amp;&amp;(g_triggerElems[i].isHotSpotDisabled=!1);v=i+1,r=s[i],a=_ge("sc_hst"+v),a.style.left=r.locx+"%",a.style.top', b't=u.getBoundingClientRect(),o=t.width?Math.abs(t.right-t.left):t.width,a=s(u,"paddingLeft");o=o-(a?parseInt(a):0);v=t.height?Math.abs(t.bottom-t.top', b'n=document.getElementById(keyMap.Notification),t;n&amp;&amp;(n.parentNode.removeChild(n),t=document.getElementById("id_h"),t&amp;&amp;(t.style.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'http://p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top']
</code></pre>
<p>and that goes on and on for a while.</p>
<p>Any help in setting me on the right track would be appreciated.</p>
<p>Thank you</p>
</div>
<div class="post-text" itemprop="text">
<p>Since all links you want to extract start with <code>http</code> or <code>https</code> you may use</p>
<pre><code>rb'https?://\S+?\.top\b'
</code></pre>
<p>See the <a href="https://regex101.com/r/1LXza3/1" rel="nofollow noreferrer">regex demo</a>. Note that <code>r</code> string literal prefix defines a <a href="https://stackoverflow.com/questions/12871066/what-exactly-is-a-raw-string-regex-and-how-can-you-use-it"><em>raw</em> string literal</a> (so as all backslashes were treated as literal backslashes and not as part of <a href="https://docs.python.org/2.0/ref/strings.html" rel="nofollow noreferrer">string escape sequences</a>) and <code>b</code> is necessary here because <em>PCAP</em> files are binary, hence the pattern should also be a binary string.</p>
<p><strong>Details</strong></p>
<ul>
<li><code>https?://</code> - <code>http://</code> or <code>https://</code></li>
<li><code>\S+?</code> - 1 or more non-whitespace characters</li>
<li><code>\.top</code> - a <code>.top</code> substring (note the escaped dot, an unescaped dot matches any char other than a line break char in Python <code>re</code>)</li>
<li><code>\b</code> - a word boundary (note that <code>r</code> prefix allows the use of a single backslash to define a regex escape, if you do not use <code>r</code> prefix, you would need to write it as <code>\\b</code>)</li>
</ul>
</div>
<span class="comment-copy">Escape the special chars that you want to be matched as literal chars, <code>re.compile(rb"\.top")</code>. Also, since you already compiled the regex object, use <code>x = mypattern.findall(pcapfile.read())</code>. Note that if you want to match a part before <code>.top</code>, use something like <code>rb'\S+\.top\b'</code></span>
<span class="comment-copy">Ok so I just implemented your suggestion and the return is x =  [b"c('_SS','R','20',0,'/');f=_w.top", b'g_triggerElems!==e&amp;&amp;(g_triggerElems[i].isHotSpotDisabled=!1);v=i+1,r=s[i],a=_ge("sc_hst"+v),a.style.left=r.locx+"%",a.style.top', b't=u.getBoundingClientRect(),o=t.width?Math.abs(t.right-t.left):t.width,a=s(u,"paddingLeft");o=o-(a?parseInt(a):0);v=t.height?Math.abs(t.bottom-t.top', b'n=document.getElementById(keyMap.Notification),t;n&amp;&amp;(n.parentNode.removeChild(n),t=document.getElementById("id_h"),t&amp;&amp;(t.style.top', b'p27dokhpz2n7nvgr.1jw2lx.top', b'p27dokhpz2n7nvgr.1jw2lx.top',....</span>
<span class="comment-copy">No idea, you asked the question because the dot was not escaped, now, I do not know what the issue is. Please consider updating the question.</span>
<span class="comment-copy">so the good news it that the code returns the website in quesiton. Is there anyway for the regular expression to filter out all the other junk and only return the website. I was thinking maybe there is a way to force it to only return a line if there is http:// at the beginning and .top at the end or something?</span>
<span class="comment-copy">If all links start with <code>http</code>, use <code>rb'https?://\S+?\.top\b'</code></span>
<span class="comment-copy">@SNIPERATI0N Just <a href="https://stackoverflow.com/questions/12871066/what-exactly-is-a-raw-string-regex-and-how-can-you-use-it">added the link</a></span>
<span class="comment-copy">Thank you, I appreciate it. Just upvoted</span>
