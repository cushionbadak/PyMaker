<div class="post-text" itemprop="text">
<p>In a file I have the following text:</p>
<pre><code> xxxxxx
    PCTFREE    10
    INITRANS   8
    MAXTRANS   255
    STORAGE    (
                BUFFER_POOL      DEFAULT
               ),
)
</code></pre>
<p>I am trying to search for line that startswith(")") and remove the "," from the previous line. </p>
</div>
<div class="post-text" itemprop="text">
<p>What you're asking for in your description doesn't match anything in your sample input, or even come close to it. None of your lines starts with <code>)</code>. One of your lines starts with some whitespace and a ), but the line before that is a blank line, and the last non-blank line before that doesn't have a comma anywhere to remove.</p>
<p>But I'll ignore the sample input and explain how to do what you were asking for in the description.</p>
<p>The simplest way is to just keep track of the previous line while iterating the lines:</p>
<pre><code>lastline = None
for line in infile:
    line = line.rstrip()
    if line.startswith(")"):
        if lastline is not None:
            lastline = lastline.rstrip(",")
    if lastline is not None:
        outfile.write(lastline + '\n')
    lastline = line
if lastline is not None:
    outfile.write(lastline + '\n')
</code></pre>
<hr/>
<p>You can make this a little cleaner and more compact by using a <code>pairwise</code> iterator wrapper like the one in the <a href="https://docs.python.org/3/library/itertools.html#itertools-recipes" rel="nofollow noreferrer"><code>itertools</code> recipes</a>, but slightly modified to include the "extra" pair at the end:</p>
<pre><code>def pairwise(iterable):
    "s -&gt; (s0,s1), (s1,s2), (s2, s3), ..."
    a, b = itertools.tee(iterable)
    next(b, None)
    return itertools.zip_longest(a, b, fillvalue='')

stripped = (line.rstrip() for line in infile)
for line, nextline in pairwise(stripped):
    if nextline.startswith(")"):
        line = line.rstrip(",")
    if line is not None:
        outfile.write(line + '\n')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>with open('filename') as f:
    print(f.read().replace(',\n)','\n)')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can loop over the text line by line and check one index ahead for a <code>)</code>:</p>
<pre><code>new_s = [i.strip('\n') for i in open('filename.txt')]
final_data = '\n'.join(new_s[i][:-1] if new_s[i+1].startswith(')') else new_s[i] for i in range(len(new_s)-1))
</code></pre>
<p>Output:</p>
<pre><code>xxxxxx
PCTFREE    10
INITRANS   8
MAXTRANS   255
STORAGE    (
        BUFFER_POOL      DEFAULT
       )
)
</code></pre>
</div>
<span class="comment-copy">None of your lines starts with <code>)</code>. One of your lines starts with some whitespace and a <code>)</code>, but the line before that is a blank line, and the last non-blank line before that doesn't have a comma anywhere to remove.</span>
<span class="comment-copy">Welcome to StackOverflow.  Please read <a href="https://stackoverflow.com/help/how-to-post">How to post</a>, and post a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, Verifiable Example</a>.  Your question starts well, but we can't see specifically what you tried.  StackOverflow is not the right place to ask "Please write code for me."  But if you give it a serious try and show us, we can show you where you went wrong.</span>
<span class="comment-copy">the first simple aspect worked!</span>
<span class="comment-copy">the file contains more then one occurrence of this, thats why I have the above xxx. I can not remove all the "," just the ones before the )</span>
<span class="comment-copy"><code>str.replace</code> replaces <b>all</b> occurrences</span>
<span class="comment-copy">This content is in a file, so should I be reading the file.</span>
