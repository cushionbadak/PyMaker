<div class="post-text" itemprop="text">
<p>I am developing an application wherein I am receiving serial byte packets of varying length which are marked by framing flags into a buffer and then utilizing the collected bytes to access a dictionary to identify values.  Currently, my serial read function watches the serial line until an END_FLAG byte is present or a timeout occurs as such...</p>
<pre><code>def receive_command(self):
    self.rxBuff = list(self.ser.read(1))
    #Keep receiving bytes until END_FLAG or timeout
    while self.rxBuff[-1] != chr(flagDict["END_FLAG"]):
        tBuff = self.ser.read(1)
        if len(tBuff) != 1:
            print "Timeout"
        else:
            self.rxBuff.append(tBuff)
</code></pre>
<p>This ultimately reads the hex bytes into the buffer wherein they are represented with the escape character "\x##" or as their ASCII value.  Within the code I have a dictionary which allows me to identify the microcontoller model based on a four byte hex value as such:</p>
<pre><code>STM32_TYPE = {
0x410: "STM32F103RB",
0x415: "STM32L152RG",        
0x417: "STM32L053R8",    
0x421: "STM32F446RE",
0x431: "STM32F411RE",
0x433: "STM32F401RE",
0x437: "STM32L152RE",
0x439: "STM32F302R8",    
0x438: "STM32F334R8",        
0x440: "STM32F030R8",
0x442: "STM32F091RC",
0x446: "STM32F303RE",
0x447: "STM32L073RZ",    
0x448: "STM32F070RB/STM32F072RB",
0x458: "STM32F410RB",    
}
</code></pre>
<p>The problem I am having is that in order to access the values in this dictionary I need to combine two separate bytes(bytes 3 &amp; 4 from the following packet). </p>
<pre><code>['\x12','\x03','F','\x04','\x13']
</code></pre>
<p>My goal is to reassemble bytes 3 and 4 into the value 0x0446 to use to access the previously mentioned dictionary.  However I am at a loss as to how to accomplish this as all attempts to do so have yielded either simply combined strings (which makes sense given that these are string representations), or integer values which are not held to be equivalent when I attempt to access the dictionary.  My question is, is there a way to combine these hex values (the 'F' and '\x04') so as to use them to access the dictionary value with key 0x0446?  OR, is there a better way to receive the hex bytes during my serial read function so that they are stored in a manner more conducive to combining them later on?</p>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/struct.html" rel="nofollow noreferrer"><code>struct</code></a></p>
<pre><code>&gt;&gt;&gt; struct.unpack('&lt;H', b'F\x04')
(1094,)
</code></pre>
</div>
<span class="comment-copy">KeyError: '(1094,)'</span>
<span class="comment-copy">Yes, because your keys are numbers, not tuples. Index the tuple.</span>
<span class="comment-copy">Sorry, I didn't mean for that to be a short comment.  I understand that that value is the equivalent decimal value but it for some reason generates a keyerror.</span>
<span class="comment-copy">Ok, thank you.  I had seen the index [0] getting used on unpack in multiple places but it makes sense now.  It was spitting out a tuple and I overlooked that.</span>
