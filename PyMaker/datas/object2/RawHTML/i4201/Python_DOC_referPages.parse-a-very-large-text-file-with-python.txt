<div class="post-text" itemprop="text">
<p>So, the file has about 57,000 book titles, author names and a ETEXT No. I am trying to parse the file to only get the ETEXT NOs</p>
<p>The File is like this:</p>
<pre><code>TITLE and AUTHOR                                                     ETEXT NO.

Aspects of plant life; with special reference to the British flora,      56900
 by Robert Lloyd Praeger

The Vicar of Morwenstow, by Sabine Baring-Gould                          56899
 [Subtitle: Being a Life of Robert Stephen Hawker, M.A.]

Raamatun tutkisteluja IV, mennessä Charles T. Russell                    56898
 [Subtitle: Harmagedonin taistelu]
 [Language: Finnish]

Raamatun tutkisteluja III, mennessä Charles T. Russell                   56897
 [Subtitle: Tulkoon valtakuntasi]
 [Language: Finnish]

Tom Thatcher's Fortune, by Horatio Alger, Jr.                            56896

A Yankee Flier in the Far East, by Al Avery                              56895
 and George Rutherford Montgomery
 [Illustrator: Paul Laune]

Nancy Brandon's Mystery, by Lillian Garis                                56894

Nervous Ills, by Boris Sidis                                             56893
 [Subtitle: Their Cause and Cure]

Pensées sans langage, par Francis Picabia                                56892
 [Language: French]

Helon's Pilgrimage to Jerusalem, Volume 2 of 2, by Frederick Strauss     56891
 [Subtitle: A picture of Judaism, in the century
  which preceded the advent of our Savior]

Fra Tommaso Campanella, Vol. 1, di Luigi Amabile                         56890
 [Subtitle: la sua congiura, i suoi processi e la sua pazzia]
 [Language: Italian]

The Blue Star, by Fletcher Pratt                                         56889

Importanza e risultati degli incrociamenti in avicoltura,                56888
 di Teodoro Pascal
 [Language: Italian]
</code></pre>
<p>And this is what I tried:</p>
<pre><code>def search_by_etext():

    fhand = open('GUTINDEX.ALL')
    print("Search by ETEXT:")

    for line in fhand:
        if not line.startswith(" [") and not line.startswith("~"):
            if not line.startswith(" ") and not line.startswith("TITLE"):
                    words = line.rstrip()
                    words = line.lstrip()
                    words = words[-7:]
                    print (words)


search_by_etext()
</code></pre>
<p>Well the code mostly works. However for some lines it gives me part of title or other things. Like:
This kind of output(), containing 'decott' which is a part of author name and shouldn't be here.
<img alt="This kind of output" src="https://i.stack.imgur.com/Zi8Eh.png"/><a href="https://i.stack.imgur.com/Zi8Eh.png" rel="nofollow noreferrer">2</a></p>
<p>For this:
The Bashful Earthquake, by Oliver Herford                                56765
 [Subtitle: and Other Fables and Verses]</p>
<p>The House of Orchids and Other Poems, by George Sterling                 56764</p>
<p>North Italian Folk, by Alice Vansittart Strettel Carr                    56763
 and Randolph Caldecott
 [Subtitle: Sketches of Town and Country Life]</p>
<p>Wild Life in New Zealand. Part 1, Mammalia, by George M. Thomson         56762
 [Subtitle: New Zealand Board of Science and Art, Manual No. 2]</p>
<p>Universal Brotherhood, Volume 13, No. 10, January 1899, by Various       56761</p>
<p>De drie steden: Lourdes, door Émile Zola                                 56760
 [Language: Dutch]</p>
<p>Another example:</p>
<p><img alt="" src="https://i.stack.imgur.com/PQAKv.png"/><a href="https://i.stack.imgur.com/PQAKv.png" rel="nofollow noreferrer">4</a></p>
<p>For 
Rhandensche Jongens, door Jan Lens                                       56702
 [Illustrator: Tjeerd Bottema]
 [Language: Dutch]</p>
<p>The Story of The Woman's Party, by Inez Haynes Irwin                     56701</p>
<p>Mormon Doctrine Plain and Simple, by Charles W. Penrose                  56700
 [Subtitle: Or Leaves from the Tree of Life]</p>
<p>The Stone Axe of Burkamukk, by Mary Grant Bruce                          56699
 [Illustrator: J. Macfarlane]</p>
<p>The Latter-Day Prophet, by George Q. Cannon                              56698
 [Subtitle: History of Joseph Smith Written for Young People]</p>
<p>Here: Life] shouldn't be there. Lines starting with blank space has been parsed out with this:</p>
<pre><code>if not line.startswith(" [") and not line.startswith("~"):
</code></pre>
<p>But Still I am getting those off values in my output results. </p>
</div>
<div class="post-text" itemprop="text">
<p>It could be that those extra lines that are not being filtered out start with whitespace other than a " " char, like a tab for example. As a minimal change that might work, try filtering out lines that start with any whitespace rather than specifically a space char?</p>
<p>To check for whitespace in general rather than a space char, you'll need to use <a href="https://docs.python.org/3/library/re.html" rel="nofollow noreferrer">regular expressions</a>. Try <code>if not re.match(r'^\s', line) and ...</code></p>
</div>
<div class="post-text" itemprop="text">
<p>Simple solution: regexps to the rescue !</p>
<pre><code>import re
with open("etext.txt") as f:
    for line in f:
        match = re.search(r" (\d+)$", line.strip())
        if match:
            print(match.group(1))
</code></pre>
<p>the regular expression <code>(\d+)$</code> will match "at least one space followed by 1 or more digits at the end of the string", and capture only the "one or more digits" group. </p>
<p>You can eventually improve the regexp - ie if you know all etext codes are exactly 5 digits long, you can change the regexp to <code>(\d{5})$</code>.</p>
<p>This works with the example text you posted. If it doesn't properly work on your own file then we need enough of the real data to find out what you really have.</p>
</div>
<span class="comment-copy">Consider posting text in your question as text, instead of as pictures.</span>
<span class="comment-copy">Isn't better to look when the line has max length and the last word is a number, in order to individuate a record delimiter? It should be more robust to whatever text you have on the left side.</span>
<span class="comment-copy">While you <a href="https://stackoverflow.com/posts/50060521/edit">edit</a> your question please include a small sample of the input that illustrates the problem.</span>
<span class="comment-copy">What khelwood said. You should make it easy for someone to fix your code &amp; test their fix with your sample data. They can't test it on an image! or further details, please see <a href="http://meta.stackoverflow.com/questions/285551/why-may-i-not-upload-images-of-code-on-so-when-asking-a-question">Why may I not upload images of code on SO when asking a question?</a></span>
<span class="comment-copy">Yes, please <a href="https://stackoverflow.com/posts/50060521/edit">edit</a> your question and include the <i>relevant</i> parts of your data and code <i>as text</i>.</span>
<span class="comment-copy">Result is the same...</span>
<span class="comment-copy">Well, seems to work after your edit....Gonna test the whole code. Thanks.</span>
<span class="comment-copy">There must have been invisible characters at the start of your strings - looked like a space, but something else. We can't see them, but Python and so <code>startswith(" ")</code> wasn't true. Glad I could help out.</span>
<span class="comment-copy">There's a much simpler solution...</span>
<span class="comment-copy">I think both solutions are good to have on here. Mine is a minimal change to what the OP posted which explains exactly what the problem was. Yours is a much more compact solution, better starting point for someone else finding the question and teaches a little about regex. Room for both, I'll vote you up now!</span>
<span class="comment-copy">Misses the first line ETEXT. Should start with 56900, but starts with 56899.</span>
<span class="comment-copy">@Azazel I copy pasted your text example (the one in a code block) to test my script and it DOES output all of the etext nums. If something is missing then your example is not truely representative of your real data.</span>
<span class="comment-copy">@Azazel I obviously can not debug this without the original file (well, the start of it at least) - to fix a problem you have to have it first and I don't have it with what you posted ;)</span>
<span class="comment-copy">@Azazel to answer your previous question : the regexp module is part of the stdlib and extensively documented: <a href="https://docs.python.org/3/library/re.html" rel="nofollow noreferrer">docs.python.org/3/library/re.html</a></span>
<span class="comment-copy">@Azazel can you test with this regexp instead : <code>r"\s(\d+)$"</code> ? I suspect you have a tab or something on some lines.</span>
