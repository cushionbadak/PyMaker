<div class="post-text" itemprop="text">
<p>I am trying to follow this code <a href="http://alexminnaar.com/time-series-classification-and-clustering-with-python.html" rel="nofollow noreferrer">http://alexminnaar.com/time-series-classification-and-clustering-with-python.html</a> for doing time series clustering; when I try to follow the example in order to start understanding how it works, I get this error: </p>
<pre><code>import pandas as pd
import numpy as np
import matplotlib.pylab as plt
import random

def k_means_clust(data,num_clust,num_iter,w=5):
    centroids=random.sample(data,num_clust)
    counter=0
    for n in range(num_iter):
        counter+=1
        #print counter
        assignments={}
        #assign data points to clusters
        for ind,i in enumerate(data):
            min_dist=float('inf')
            closest_clust=None
            for c_ind,j in enumerate(centroids):
                if LB_Keogh(i,j,5)&lt;min_dist:
                    cur_dist=DTWDistance(i,j,w)
                    if cur_dist&lt;min_dist:
                        min_dist=cur_dist
                        closest_clust=c_ind
            if closest_clust in assignments:
                assignments[closest_clust].append(ind)
            else:
                assignments[closest_clust]=[]

        #recalculate centroids of clusters
        for key in assignments:
            clust_sum=0
            for k in assignments[key]:
                clust_sum=clust_sum+data[k]
            centroids[key]=[m/len(assignments[key]) for m in clust_sum]

    return centroids

train = np.genfromtxt('datasets/train.csv', delimiter='\t')
test = np.genfromtxt('datasets/test.csv', delimiter='\t')
data=np.vstack((train[:,:-1],test[:,:-1]))

import matplotlib.pylab as plt

centroids=k_means_clust(data,4,10,4)
for i in centroids:

    plt.plot(i)

plt.show()
</code></pre>
<blockquote>
<p>--------------------------------------------------------------------------- <strong>TypeError                                 Traceback (most recent call
  last)  in ()</strong>
        5 import matplotlib.pylab as plt
        6 
  ----&gt; 7 centroids=k_means_clust(data,4,10,4)
        8 for i in centroids:
        9 </p>
<p> in k_means_clust(data, num_clust,
  num_iter, w)
        2 
        3 def k_means_clust(data,num_clust,num_iter,w=5):
  ----&gt; 4     centroids=random.sample(data,num_clust)
        5     counter=0
        6     for n in range(num_iter):</p>
<p>C:\Users\Luis\Anaconda3\lib\random.py in sample(self, population, k)
      309             population = tuple(population)
      310         if not isinstance(population, _Sequence):
  --&gt; 311             raise TypeError("Population must be a sequence or set.  For dicts, use list(d).")
      312         randbelow = self._randbelow
      313         n = len(population)</p>
<p><strong>&gt; TypeError: Population must be a sequence or set.  For dicts, use
  list(d).</strong></p>
</blockquote>
<pre><code>This is the data I am loading:


[[-0.37693558  1.2248643   0.34387438 ...,  0.91834602 -1.3117417
  -1.1971462 ]
 [ 0.64440621  0.41326914 -0.86227849 ...,  1.3981403   0.08574208
   0.02499741]
 [-0.97866735 -0.40623244  0.82242857 ...,  0.66612895  0.10699555
   0.08271546]
 ..., 
 [ 0.8455511   0.05714152  1.2228095  ..., -0.51199761 -0.86978484
  -0.2057573 ]
 [ 1.9725294   0.41645028  1.6845052  ..., -1.3956278  -1.0317821
  -1.1345864 ]
 [ 1.5162553   1.1602023   1.2666022  ..., -0.85115838 -0.85573754
  -1.0178208 ]]
</code></pre>
<p><strong><em>Should I convert that to a sequence? How should I fix it?</em></strong></p>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.vstack.html#numpy-vstack" rel="nofollow noreferrer">[SciPy]: numpy.vstack</a> returns an <a href="https://docs.scipy.org/doc/numpy-1.14.0/reference/generated/numpy.ndarray.html#numpy-ndarray" rel="nofollow noreferrer">[SciPy]: numpy.ndarray</a>, <br/>while <a href="https://docs.python.org/3/library/random.html#random.sample" rel="nofollow noreferrer">[Python]: random.<strong>sample</strong>(<em>population, k</em>)</a> expects a sequence (<a href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" rel="nofollow noreferrer">[Python]: <em>class</em> collections.abc.<strong>Sequence</strong></a>)</p>
<p><strong>Example</strong>:</p>
<blockquote>
<pre><code>&gt;&gt;&gt; import sys
&gt;&gt;&gt; import random
&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt;
&gt;&gt;&gt; "Python {:s} on {:s}".format(sys.version, sys.platform)
'Python 3.5.4 (v3.5.4:3f56838, Aug  8 2017, 02:17:05) [MSC v.1900 64 bit (AMD64)] on win32'
&gt;&gt;&gt;
&gt;&gt;&gt; a = np.array([[1], [2], [3]])
&gt;&gt;&gt; b = np.array([[2], [3], [4]])
&gt;&gt;&gt; data = np.vstack((a, b))
&gt;&gt;&gt; data
array([[1],
       [2],
       [3],
       [2],
       [3],
       [4]])
&gt;&gt;&gt; random.sample(data, 4)
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "e:\Work\Dev\VEnvs\py35x64_test\lib\random.py", line 320, in sample
    raise TypeError("Population must be a sequence or set.  For dicts, use list(d).")
TypeError: Population must be a sequence or set.  For dicts, use list(d).
&gt;&gt;&gt; random.sample(data.tolist(), 4)
[[3], [4], [2], [3]]
</code></pre>
</blockquote>
<p><strong>Fix</strong>:</p>
<p>Use <code>numpy.ndarray.tolist()</code>. In your code, replace</p>
<pre><code>centroids=random.sample(data,num_clust)
</code></pre>
<p>by</p>
<pre><code>centroids = random.sample(data.tolist(), num_clust)
</code></pre>
<p>or use <code>list(data)</code> (as the exception text instructs (for <code>dict</code>s)).</p>
</div>
<div class="post-text" itemprop="text">
<p>In the function:</p>
<pre><code>   def k_means_clust(data,num_clust,num_iter,w=5):
       centroids=random.sample(data,num_clust) 
</code></pre>
<p>you are using random on a numpy array: 
The random library does not work with numpy arrays, so what you can do, is to convert the numpy array into a list:</p>
<pre><code>   def k_means_clust(data,num_clust,num_iter,w=5):
       centroids=random.sample(list(data),num_clust) 
</code></pre>
</div>
