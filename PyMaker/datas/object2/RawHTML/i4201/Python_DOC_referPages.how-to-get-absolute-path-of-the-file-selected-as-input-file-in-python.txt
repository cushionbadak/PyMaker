<div class="post-text" itemprop="text">
<p>I want the absolute path of the file selected as input file (from file browser in the form) using the python code below:</p>
<pre><code> for attr, document in request.files.iteritems():
        orig_filename = document.filename
        print os.path.abspath(orig_filename)
        mhash = get_hash_for_doc(orig_filename)
</code></pre>
<p>This prints the path of current working directory along(where the python script is executing) with the 'orig_filename' appended to it, which is the wrong path. I am using python 2.7, flask 0.12 under linux OS.</p>
<p>The requirement is to find the hash value of the file before uploading it to the server to check deduplication. So I need to use the algorithm by passing the file selected for hashing to another function as:</p>
<pre><code>def get_hash_for_doc(orig_filename):
    mhash = None
    hash = sha1()#md5()
    with open(mfile, "rb") as f:
        for chunk in iter(lambda: f.read(128 * hash.block_size), b""):
            hash.update(chunk)
    mhash = hash.hexdigest()

    return mhash
</code></pre>
<p>In this function I want to read file from absolute path of the orig_filename before uploading. Avoided all other code checks here.</p>
</div>
<div class="post-text" itemprop="text">
<p>First you need to create a temp file to simulate this required file then make your process on it</p>
<pre><code>import tempfile, os
try:
    fd, tmp = tempfile.mkstemp()
    with os.fdopen(fd, 'w') as out:
        out.write(file.read())
    mhash = get_hash_for_doc(tmp)
finally:
    os.unlink(tmp)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.python.org/3/library/pathlib.html" rel="nofollow noreferrer">pathlib</a> to find the absolute path of the selected file.</p>
</div>
<span class="comment-copy">What is <code>secure_filename</code>, can't you just use <code>os.path.abspath(document.filename)</code> ?</span>
<span class="comment-copy">There's no way to answer this question. What is <code>requeat.files</code>? What is <code>secure_filemame</code>?</span>
<span class="comment-copy">This is what I want to avoid! copying it</span>
<span class="comment-copy">for a temp time, I think you can't read it from the request directly, try this if worked, then try to find a fined solution of it</span>
<span class="comment-copy">&gt;&gt;&gt; from pathlib import Path &gt;&gt;&gt; p = Path("python3.4").resolve() &gt;&gt;&gt; p PosixPath('/opt/python3/bin/python3.4') &gt;&gt;&gt; str(p) '/opt/python3/bin/python3.4'</span>
