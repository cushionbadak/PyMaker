<div class="post-text" itemprop="text">
<p>I am working on a program to unzip/extract all <code>.tar.gz</code> files in a given folder. This folder can have several sub directories with multiple <code>.tar.gz</code> files as well. I am trying to extract all of them, while maintaining the folder structure, but running into some issues.</p>
<p>My current code is below, <code>extractall()</code> seems to only extract to the current working directory, and I can't quite figure out how to maintain the directory structure.</p>
<pre><code>for zipped_file in pathlib.Path(path).glob('**/*.tar.gz'):
    tar = tarfile.open(zipped_file, 'r:gz')
    tar.extractall()
    tar.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/tarfile.html" rel="nofollow noreferrer">https://docs.python.org/3/library/tarfile.html</a></p>
<pre><code>TarFile.extractall(path=".", members=None, *, numeric_owner=False)
    Extract all members from the archive to the current working directory or directory path.
</code></pre>
<p>So:</p>
<pre><code>import os

for path, directories, files in os.walk('/foo/bar'):
    for f in files:
        if f.endswith(".tar.gz"):
            tar = tarfile.open(os.path.join(path,f), 'r:gz')
            tar.extractall(path=path)
            tar.close()
</code></pre>
</div>
<span class="comment-copy">Change the CWD to where you want to extract to before extracting.</span>
<span class="comment-copy"><code>os.walk()</code> might be better approach</span>
