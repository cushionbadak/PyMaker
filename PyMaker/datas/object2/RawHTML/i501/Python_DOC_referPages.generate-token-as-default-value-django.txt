<div class="post-text" itemprop="text">
<p>So I'm using python <a href="https://docs.python.org/3/library/secrets.html#secrets.token_urlsafe" rel="nofollow noreferrer">secrets</a> library so I can generate token, so I want to add it as a default like this</p>
<p><code>token=models.CharField(max_length=32, default=secrets.token_urlsafe(32))</code></p>
<p>strange thing it will generate 43 characters rather than 32, so can anyone help me understand why?</p>
<p>Thanks</p>
</div>
<div class="post-text" itemprop="text">
<p>That <code>default</code> argument must point to a <em>callable</em>, not a function call with arguments (which are only evaluated once when Django starts). You need to write your own wrapper function and refer to that instead. For example:</p>
<pre><code>def my_secret():
    return secrets.token_urlsafe(32)[:32] # Return only the first 32 characters.
#...
token=models.CharField(max_length=32, default=my_secret)
</code></pre>
<p>Refer to this answer: <a href="https://stackoverflow.com/a/12654998/4082726">https://stackoverflow.com/a/12654998/4082726</a></p>
<hr/>
<p>Regarding the length: <code>token_urlsafe</code>'s argument is the number of <em>bytes</em>, not <em>characters</em>. According to the <a href="https://docs.python.org/3/library/secrets.html#secrets.token_urlsafe" rel="nofollow noreferrer">documentation</a> this means roughly 1.3 characters per byte, so 32 * 1.3 = ~42.</p>
</div>
<span class="comment-copy">yes, but it will return the same, I'm experimenting right now,  basically it somehow generating more then it should be</span>
<span class="comment-copy">Oh, I see. According to the documentation it generates ~1.3 characters per byte. That argument is not the number of characters, but rather bytes. So 32 * 1.3 = ~42. See here: <a href="https://docs.python.org/3/library/secrets.html#secrets.token_urlsafe" rel="nofollow noreferrer">docs.python.org/3/library/secrets.html#secrets.token_urlsafe</a></span>
<span class="comment-copy">ok, so, It's better to use <code>save()</code> method on it</span>
<span class="comment-copy">What <code>save()</code> method? If you really want only 32 to characters, then you can just slice the string. I will update the answer.</span>
<span class="comment-copy">Note to @malberts: the arguments are not ignored actually (that part of your answer is wrong). The problem with calling the function is that it's only called once when Django is started and loaded in memory, so every user would receive the same token until you restart your app server. By setting <code>default</code> to a <i>callable</i> you ensure it's run every time a new instance is initialised.</span>
