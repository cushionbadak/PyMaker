<div class="post-text" itemprop="text">
<p>In python, I am unable to understand the operator precedence. </p>
<pre><code>a = set([1, 2, 3])

a|set([4])-set([2])
</code></pre>
<p>The above expression returns {1,2,3,4}. However, I thought the operator | shall be executed before - but this doesn't seem like happening. </p>
<p>When I apply parenthesis, it returns me the desired output, i.e. {1,3,4}</p>
<pre><code>  (a|set([4]))-set([2])
</code></pre>
<p>So, my question is why is this happening and what is the operator (for set operators like -, |, &amp;, ^, etc) precedence when applying set operations. </p>
</div>
<div class="post-text" itemprop="text">
<p>python <a href="https://docs.python.org/3/reference/expressions.html#operator-precedence" rel="nofollow noreferrer">operator precedence</a> rules give priority to <code>-</code> operator and then to bitwise <code>|</code> operator:</p>
<p>Now we have a <code>set</code> with <code>union</code>, overloaded with <code>|</code>, and <code>difference</code>, oveloaded with <code>-</code>:</p>
<pre><code>a = set([1, 2, 3])

a|set([4])-set([2])
</code></pre>
<p>The question now became: why do the same rules of precedence apply?</p>
<p>This is because python evaluates operator expressions applying the same rules precedence for all classes that overload the standard operators:</p>
<pre><code>class Fagiolo:

    def __init__(self, val):
        self.val = val

    def __or__(self, other):
        return Fagiolo("({}+{})".format(self.val, other.val))

    def __sub__(self, other):
        return Fagiolo("({}-{})".format(self.val, other.val))

    def __str__(self):
        return self.val

red = Fagiolo("red")
white = Fagiolo("white")

new_born = red | white - Fagiolo("blue")

print(new_born)
</code></pre>
<p>gives:</p>
<pre><code>(red+(white-blue))
</code></pre>
</div>
<span class="comment-copy">Assuming operators have a set precedence regardless of context, <code>-</code> has a higher precedence than <code>|</code>: <a href="http://www.mathcs.emory.edu/~valerie/courses/fall10/155/resources/op_precedence.html" rel="nofollow noreferrer">mathcs.emory.edu/~valerie/courses/fall10/155/resources/â€¦</a></span>
<span class="comment-copy">@Carcigenicate That is a valid assumption; the expression is parsed before the (run-time) types of any of the operands is known.</span>
<span class="comment-copy"><code>|</code> with sets isn't a bitwise operator; like <code>-</code>, it's <i>just</i> an operator whose actual operation is determined by the types it is used with. Operator precedence is decided by the <i>grammar</i>; operator <i>semantics</i> are determined by types (which aren't known until run-time).</span>
