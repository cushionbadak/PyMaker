<div class="post-text" itemprop="text">
<p>I have been trying to understand logging in python. I have an <strong>init</strong> module, two other modules and a main module. For some reason, when I run my module, log details jump the code flow and are printed first before the other outputs</p>
<p>Could someone tell me why this is happening</p>
<p>this is in <code>__init__.py</code> </p>
<pre><code>from dir1.mod1 import FirstClass
from dir1.mod2 import SecondClass

logger = logging.getLogger(__name__)

logger.setLevel(logging.DEBUG)
f_handler=logging.FileHandler('python_logs.log')
f_handler.setLevel(logging.DEBUG)
c_handler = logging.StreamHandler()
c_handler.setLevel(logging.ERROR)

f_formatter = logging.Formatter('%(name)s - %(levelname)s - %(message)s')
c_formatter = logging.Formatter('%(name)s - %(levelname)s - %(message)s')

f_handler.setFormatter(f_formatter)
c_handler.setFormatter(c_formatter)

logger.addHandler(f_handler)
logger.addHandler(c_handler)
</code></pre>
<p>This is in other two modules(written inside <code>__init__()</code> of the resp class</p>
<pre><code>self.logger = logging.getLogger(__name__)
</code></pre>
<p>snippet of addn() function defined inside one of the module</p>
<pre><code>def addn(self):
    z=self.x +self.y
    print('sum is '+z)
    self.logger.error('incrementing number!')
    self.logger.info('Still incrementing number!!')
    return z
</code></pre>
<p>And my main modules(which I run) has this:</p>
<pre><code>from dir1.mod1 import FirstClass
from dir1.mod2 import SecondClass

number = FirstClass(2,2)
print('addition results')
number.addn()
</code></pre>
<p><strong>I was expecting a output as below</strong></p>
<p>addition results </p>
<p>sum is 3</p>
<p><code>dir1.mod1</code> - ERROR - incrementing number!</p>
<p><strong>But what I got was</strong></p>
<p><code>dir1.mod1</code> - ERROR - incrementing number!</p>
<p><code>dir1.mod1</code> - ERROR - incrementing number!</p>
<p>addition results:</p>
<p>sum is 3</p>
<p>Why is the log message printed first jumping out of code flow? And also could someone tell me why log message gets printed twice??</p>
</div>
<div class="post-text" itemprop="text">
<p>Python StreamHandler will log to stderr by default while you print statements goes to stdout. Those are two different pipelines and the ordering isn't guaranteed between them.</p>
<p>To ensure proper ordering start by sending all output to the same pipe. For example you could add the <code>file=sys.stderr</code> argument to your print statements.</p>
</div>
<div class="post-text" itemprop="text">
<p>U can try disable the propagate property of your logger.</p>
<blockquote>
<p><strong>Propagate</strong>: If this attribute evaluates to true, events logged to this logger will be passed to the handlers of higher level (ancestor) loggers, in addition to any handlers attached to this logger. Messages are passed directly to the ancestor loggersâ€™ handlers - neither the level nor filters of the ancestor loggers in question are considered.</p>
</blockquote>
<p>This is an example of init logger that uses file and stdout with different debug level:</p>
<pre><code>def init_logger_singleton():

    global logger

    logger = logging.getLogger(name='loggerName')
    logger.propagate = False
    logger.setLevel(10)
    formatter = logging.Formatter(
        '\t%(message)s'
    )

    filehandler = logging.StreamHandler()
    filehandler.setLevel(40)
    filehandler.setFormatter(formatter)
    logger.addHandler(filehandler)
</code></pre>
<p>I used number to define the log level, but 10 = DEBUG and 40 = ERRO. More information at <a href="https://docs.python.org/3/library/logging.html#logging-levels" rel="nofollow noreferrer">this link.</a></p>
</div>
<span class="comment-copy">In your <code>addn</code> function, you're mixing <code>print</code> and logging. What happens if you replace <code>print</code> with <code>self.logger.info</code> ? I suspect flushing of print and logger doesn't occur in the order you imagine.</span>
<span class="comment-copy">In that case, 'addition results' should ideally be printed first because it gets executed before addn function is called right?... but I am still getting addition results after log messages</span>
<span class="comment-copy">Thanks that worked!. But I am still unsure on why the logs are printing two times</span>
