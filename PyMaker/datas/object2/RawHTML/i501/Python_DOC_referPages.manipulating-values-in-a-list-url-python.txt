<div class="post-text" itemprop="text">
<p>I would like to re-format value from a list. I am trying to extract urls from a website with scrapy. Scrapy returns relative URL which are then stored in the list. I would like to join absolute url with relative url and do some match and replace in relative url within list itself which would then be used for next step.</p>
<p>This is how current list looks like:</p>
<pre><code>regions = ['/listings/in/spain%2Fandalucia', '/listings/in/spain%2Faragon', '/listings/in/spain%2Fasturias', '/listings/in/spain%2Fbalearic-islands']
</code></pre>
<p><strong>And this is how it would look ideally.</strong></p>
<pre><code>regions_final = ['https://worldmap.com/listings/in/spain/andalucia', 'http://worldmap.comlistings/in/spain/Faragon', 'http://worldmap.comlistings/in/spain/fasturias', 'http://worldmap.com/listings/in/spain/balearic-islands']
</code></pre>
<p>I would need a simple find and replace of "%2F" for "/" and append "<a href="https://worldmap.com" rel="nofollow noreferrer">https://worldmap.com</a>" in front of the current values.
If anyone has any tips I would very appreciate the help!</p>
<p>Thank you</p>
</div>
<div class="post-text" itemprop="text">
<p>Here is a more robust way to create the URL:</p>
<pre><code>from urllib.parse import unquote

region_urls = [response.urljoin(unquote(x)) for x in regions]
</code></pre>
<p><a href="http://doc.scrapy.org/en/latest/topics/request-response.html#scrapy.http.Response.urljoin" rel="nofollow noreferrer"><code>urljoin</code></a> takes care of creating the correct absolute URL based on whatever the current response's base URL is, plus the relative URL.</p>
<p><a href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.unquote" rel="nofollow noreferrer"><code>unquote</code></a> takes care of the <code>%..</code> symbols, in case you get others as well.</p>
</div>
<div class="post-text" itemprop="text">
<p>Use a list comprehension and adding strings:</p>
<pre><code>regions = ['/listings/in/spain%2Fandalucia', '/listings/in/spain%2Faragon', '/listings/in/spain%2Fasturias', '/listings/in/spain%2Fbalearic-islands']

region_urls = ['https://www.worldmap.com' + x.replace('%2F', '/') for x in regions]
#['https://www.worldmap.com/listings/in/spain/andalucia',
# 'https://www.worldmap.com/listings/in/spain/aragon',
# 'https://www.worldmap.com/listings/in/spain/asturias',
# 'https://www.worldmap.com/listings/in/spain/balearic-islands']
</code></pre>
</div>
<span class="comment-copy">What have you tried so far?</span>
<span class="comment-copy">Even more elegant: <code>region_urls = [response.urljoin(unquote(x)) for x in regions]</code></span>
<span class="comment-copy">Thank you for this malberts!</span>
<span class="comment-copy">@Matija≈Ωiberna You have accepted a solution that will fail immediately you as soon as any other encoded character appears in the URL. Go with the answer that suggests <code>urllib</code>.</span>
<span class="comment-copy">Thank you @Jondiedoop. The solution worked but I went with malberts since it's more robust. Cheers</span>
