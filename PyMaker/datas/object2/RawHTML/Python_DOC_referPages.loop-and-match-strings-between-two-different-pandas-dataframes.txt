<div class="post-text" itemprop="text">
<p>I have two different dataframes df and df2, and i want to loop through each row of df in search of certain matches within specific rows in df2 and return a txt file for each match.</p>
<p>df=</p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-css lang-css prettyprint-override"><code>name	Tec	   Location
jhon	js sr	      nz
mark	python ssr    us
alan	java jr	      mx</code></pre>
</div>
</div>
</p>
<p>df2=</p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-css lang-css prettyprint-override"><code>company	        job	  Country	   Index
company a	js jr	      uk	    1
company b	python ssr    us	    2
company c	java jr	      mx	    3</code></pre>
</div>
</div>
</p>
<p>So far i've been doing the following:</p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-html lang-html prettyprint-override"><code>for index, row in df.iterrows():
    for indexb, rowb in df2.iterrows():
        if str(row.Tec) in str(rowb.job) and str(row.Location) in rowb.Country:              
            print ('Match with ' + str(rowb.company))
            sys.stdout= open(r'path\to\file\%s.txt'%(row['name']+ str(rowb.Index),), 'w')
    else:
        pass</code></pre>
</div>
</div>
</p>
<p>I keep getting text files with wrong matches or with the first row from df2 repeated within all output txt files.
I want to compare Tec against job and Location against country.
So for example, an output for this case would be:
mark 2.txt , where the file contains the text "Match with company b"</p>
<p>Any idea ?</p>
</div>
<div class="post-text" itemprop="text">
<p>Iterating rows is not the preferred way of working with Pandas DataFrames.</p>
<p>You might want to try joining df and df2. Then apply a filter to keep the rows you want to save into csv.</p>
<pre><code>df = pd.DataFrame([['jhon', 'js sr', 'nz'], ['mark', 'python ssr', 'us'], ['alan', 'java jr', 'mx']], columns=['name', 'Tec', 'Location'])
df2 = pd.DataFrame([['company a', 'js jr', 'uk'], ['company b', 'python ssr', 'us'], ['company c', 'java jr', 'mx']], columns=['company', 'job', 'Country'])
# Merge the two dataframes
df3 = df.merge(df2, how='right', left_on=['Tec', 'Location'], right_on=['job', 'Country'])
df3 = df3[df3['name'].notnull()]
df3['name'].to_csv('output.csv')
</code></pre>
</div>
<span class="comment-copy">What columns are you planning to match both dataframes on? Please add expected output for the sample input.</span>
<span class="comment-copy">Done, thanks for the advise</span>
