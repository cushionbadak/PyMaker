<div class="post-text" itemprop="text">
<p>Im learning regular expressions, specifically named capture groups.</p>
<p>Having an issue where I'm not able to figure out how to write an if/else statement for my function <strong>findVul()</strong>.</p>
<p>Basically how the code works or should work is that <strong>findVul()</strong> goes through <strong>data1</strong> and <strong>data2</strong>, which has been added to the list <strong>myDATA</strong>.</p>
<p>If the regex finds a match for the entire named group, then it should print out the results. It currently works perfectly.</p>
<p><strong>CODE:</strong></p>
<pre><code>import re

data1 = '''

dwadawa231d .2 vulnerabilities discovered dasdfadfad .One vulnerability discovered 123e2121d21 .12 vulnerabilities discovered sgwegew342 dawdwadasf

2r3232r32ee

'''

data2 = ''' d21d21 .2 vul discovered adqdwdawd .One vulnerability disc d12d21d .two vulnerabilities discovered 2e1e21d1d f21f21

'''

def findVul(data):
    pattern = re.compile(r'(?P&lt;VUL&gt;(\d{1,2}|One)\s+(vulnerabilities|vulnerability)\s+discovered)')
    match = re.finditer(pattern, data)

    for x in match:
        print(x.group())


myDATA = [data1,data2] count_data = 1

for x in myDATA:
    print('\n---&gt;Reading data{0}\n'.format(count_data))
    count_data+=1
    findVul(x)
</code></pre>
<p><strong>OUTPUT:</strong></p>
<pre><code>---&gt;Reading data1

2 vulnerabilities discovered
One vulnerability discovered
12 vulnerabilities discovered

---&gt;Reading data2
</code></pre>
<p>Now I want to add an if/else statement to check if there are any matches for the entire named group.</p>
<p>I tried something like this, but it doesn't seem to be working.</p>
<p><strong>CODE:</strong></p>
<pre><code>def findVul(data):
    pattern = re.compile(r'(?P&lt;VUL&gt;(\d{1,2}|One)\s+(vulnerabilities|vulnerability)\s+discovered)')
    match = re.finditer(pattern, data)

    if len(list(match)) != 0:
        print('\nVulnerabilities Found!\n')
        for x in match:
            print(x.group())

    else:
        print('No Vulnerabilities Found!\n')
</code></pre>
<p><strong>OUTPUT:</strong></p>
<pre><code>---&gt;Reading data1


Vulnerabilities Found!


---&gt;Reading data2

No Vulnerabilities Found!
</code></pre>
<p>As you can see it does not print the vulnerabilities that should be in <strong>data1</strong>.</p>
<p>Could someone please explain the correct way to do this and why my logic is wrong. 
Thanks so much :) !!</p>
</div>
<div class="post-text" itemprop="text">
<p>The problem is that <a href="https://docs.python.org/3/library/re.html#re.finditer" rel="nofollow noreferrer"><code>re.finditer()</code></a> returns an iterator that is evaluated when you do the <code>len(list(match)) != 0</code> test; when you iterate over it again in the for-loop, it is already exhausted and there are no items left. The simple fix is just to add a <code>match = list(match)</code> line after the <code>finditer()</code> call.</p>
</div>
<div class="post-text" itemprop="text">
<p>I did some more research after @AdamKG response.</p>
<p>I wanted to utlize the re.findall() function.</p>
<p>re.findall() will return a list of all matched substrings. In my case I have capture groups inside of my named capture group. This will return a list with tuples.</p>
<p>For example the following regex with data1:</p>
<pre><code>pattern = re.compile(r'(?P&lt;VUL&gt;(\d{1,2}|One)\s+ 
(vulnerabilities|vulnerability)\s+discovered)')

match = re.findall(pattern, data)
</code></pre>
<p>Will return a list with tuples:</p>
<pre><code>[('2 vulnerabilities discovered', '2', 'vulnerabilities'), ('One vulnerability 
discovered', 'One', 'vulnerability'), ('12 vulnerabilities discovered', '12', 
'vulnerabilities')]
</code></pre>
<p><strong>My Final Code for findVul():</strong></p>
<pre><code>pattern = re.compile(r'(?P&lt;VUL&gt;(\d{1,2}|One)\s+(vulnerabilities|vulnerability)\s+discovered)')
match = re.findall(pattern, data)

if len(match) != 0:
    print('Vulnerabilties Found!\n')
    for x in match:
        print('--&gt; {0}'.format(x[0]))
else:
    print('No Vulnerability Found!\n')
</code></pre>
</div>
<span class="comment-copy">thanks so much AdamKG ! , this is my first time using the re.finditer() function , i usually use re.findall() . Would implementing re.finditer() be the best way to find my named capture group or is there a better way ?</span>
<span class="comment-copy">Just a side note: you can shorten your Regex a bit with <code>(vulnerabilit(?:y|ies))</code> part :) But on the other side it becomes a bit less legible. <a href="https://regex101.com/r/EHurjy/2" rel="nofollow noreferrer">Demo on Regex101</a></span>
