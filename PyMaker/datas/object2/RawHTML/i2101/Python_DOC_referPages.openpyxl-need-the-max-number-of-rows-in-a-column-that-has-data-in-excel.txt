<div class="post-text" itemprop="text">
<p>I need the last row in a particular column that contains data in Excel. In openpyxl sheet.max_row or max_column gets us the maximum row or column in the whole sheet. But what I want is for a particular column.</p>
<p>My scenario is where I have to get some values from database and append it to the end of a particular column in Excel sheet.</p>
<p>In this screenshot, if I want max_column containing data in column 'C', it should return 10:</p>
<p><img alt="image" src="https://i.stack.imgur.com/BKx5M.jpg"/></p>
<p>In the above image if I want last cell containing data  of column 'C', it should return 10</p>
<p>------------- Solution 1 --------------------</p>
<pre><code>import pandas as pd

# lt is the dataframe containing the data to be loaded to excel file

for index,i in enumerate(lt):
   panda_xl_rd = pd.read_excel('file.xlsx',"sheet_Name") # Panda Dataframe
   max = len(panda_xl_rd.iloc[:,(col-1)].dropna())+2     ''' getting the 
                                                             row_num of 
                                                             last record in 
                                                             column 
                                                             dropna removes 
                                                             the Nan 
                                                             values else we 
                                                             will get 
                                                             the entire 
                                                             sheets max 
                                                             column length . 
                                                             +2 gets 
                                                             the next column 
                                                             right after the 
                                                             last column to 
                                                             enter data '''
   cellref = sheet.cell(row = max+index, column=col)
   cellref.value = i
   del panda_xl_rd
</code></pre>
<p>------------------------Solution 2 ----------------------</p>
<blockquote>
<p><a href="https://stackoverflow.com/a/52816289/10003981">https://stackoverflow.com/a/52816289/10003981</a></p>
</blockquote>
<p>------------------------Solution 3 ----------------------</p>
<blockquote>
<p><a href="https://stackoverflow.com/a/52817637/10003981">https://stackoverflow.com/a/52817637/10003981</a></p>
</blockquote>
<p>Maybe solution 3 is a more concise one !! </p>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p><strong>Question</strong>:  i want max_column containing data in Column 'C' it should return 10:</p>
</blockquote>
<p>Simple count <code>cell.value not Empty</code><br/>
Documentation <a href="https://openpyxl.readthedocs.io/en/stable/tutorial.html#loading-from-a-file" rel="nofollow noreferrer">Accessing many cells</a></p>
<blockquote>
<p><strong>PSEUDOCODE</strong> </p>
<pre><code>for cell in Column('C'):
    if not cell.value is empty:
        count += 1
</code></pre>
</blockquote>
<hr/>
<blockquote>
<p><strong>Comment</strong>: What if we have an empty cell in between?  </p>
</blockquote>
<p>Count the Rows in sync with the Column Range, and use a <code>maxRowWithData</code> variable. This will also work with <strong>no</strong> empty cell between.  </p>
<blockquote>
<p><strong>PSEUDOCODE</strong> </p>
<pre><code>for row index, cell in enumerate Column('C'):
    if not cell.value is empty:
        maxRowWithData = row index
</code></pre>
<p><strong>Note</strong>: The cell index of <code>openpyxl</code> is <strong>1-based</strong>!  </p>
</blockquote>
<p>Documentation: <a href="https://docs.python.org/3/library/functions.html#enumerate" rel="nofollow noreferrer"> enumerate(iterable, start=0)</a> </p>
</div>
<div class="post-text" itemprop="text">
<p>"Empty" is a relative concept so your code should be clear about this. The methods in openpyxl are guaranteed to return orthogonal result sets: the length of rows and columns will always be the same.</p>
<p>Using this we can work deduce the row highest row in column of a cell where the value is not None.</p>
<pre><code>max_row_for_c = max((c.row for c in ws['C'] if c.value is not None))
</code></pre>
<p>None))</p>
</div>
<div class="post-text" itemprop="text">
<p>I think I just found a way using pandas:</p>
<pre><code>import pandas as pd

# lt is the dataframe containing the data to be loaded to excel file

for index,i in enumerate(lt):
    panda_xl_rd = pd.read_excel('file.xlsx',"sheet_Name") # Panda Dataframe
    max = len(panda_xl_rd.iloc[:,(col-1)].dropna())+2     ''' getting the row_num of 
                                                            last record in column 
                                                            dropna removes the Nan 
                                                            values else we will get 
                                                            the entire sheets max 
                                                            column length . +2 gets 
                                                            the next column right 
                                                            after the last column to 
                                                            enter data '''
    cellref = sheet.cell(row = max+index, column=col)
    cellref.value = i
    del panda_xl_rd
</code></pre>
</div>
<span class="comment-copy">What if we have an empty cell in between? Normally we would'nt have , but just being curious</span>
<span class="comment-copy">This is working good for me !! Thanks for the prompt reply . Will update both solutions in the question section itself!!</span>
<span class="comment-copy">Thanks for the prompt reply ! But this is just returning me the Column name : 'C'</span>
<span class="comment-copy">It's been updated.</span>
