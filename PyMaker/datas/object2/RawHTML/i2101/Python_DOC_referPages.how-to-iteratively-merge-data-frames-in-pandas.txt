<div class="post-text" itemprop="text">
<p>Given a list of data frames, I want to iteratively merge them and return single dataframe. Inputs: <code>frames</code> (list of pandas data frames) and <code>on_columns</code> (string or list of strings containing the column names to merge). How do I use <code>df.merge</code> to accomplish this?
    """
    Given a list of data frames, iteratively merge them and return a 
    single dataframe</p>
<pre><code>"""HINT: Use slice on frames when iterating and merging.

Arguments:
    frames {list} -- a list of pandas DataFrames
    on_columns {string or list} -- a string or list of strings
     containing the column names on which to join

Returns:
    df -- a pandas.DataFrame containing a merged version of the 
    two provided dataframes. If frames is None or an empty list return None
"""
def merge(frames, on_columns):
     #implementation here
     df = #merged df



return df
</code></pre>
<p>Edit: I think maybe I can use df.concat but am not sure how?</p>
</div>
<div class="post-text" itemprop="text">
<p>Something like this should work,</p>
<pre><code>def merge(frames, on_columns):
    #implementation here
    if not frames:
        return None
    if len(frames) == 1:
        return frames[0]
    out = frames[0]
    for df in frames[1:]:
        out = out.merge(df, on=on_columns)
    return out
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre class="lang-py prettyprint-override"><code>import pandas as pd

df = next(dfs)
for records in dfs:
    df = df.append(records)

# the above is equivalent to
df = pd.concat(dfs)
</code></pre>
<p>caveats:</p>
<ul>
<li><code>dfs</code> is an iterator of pandas.DataFrame objects</li>
<li>each of the <code>dfs</code> has the same columns</li>
<li>might want to reindex after all the appends are done</li>
<li>tried <a href="https://docs.python.org/3/library/functools.html#functools.reduce" rel="nofollow noreferrer">https://docs.python.org/3/library/functools.html#functools.reduce</a> but it's not obvious what the function(df1, df2) should be (i.e. <code>pd.concat</code> expects an iterable); anyway the <code>pd.concat</code> utility does the reduce</li>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/reference/general_functions.html" rel="nofollow noreferrer">http://pandas.pydata.org/pandas-docs/stable/reference/general_functions.html</a> lists the <code>pd.concat</code> and other utilities

<ul>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.merge.html#pandas.merge" rel="nofollow noreferrer">http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.merge.html#pandas.merge</a></li>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html#pandas.concat" rel="nofollow noreferrer">http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.concat.html#pandas.concat</a></li>
</ul></li>
</ul>
<p>P.S. don't create a function that the library provides already, be happy to read the docs and re-read the docs, esp. since the pandas docs are volumes</p>
</div>
<span class="comment-copy">Are the on columns the same in each case? Seems like a case for <code>reduce</code> as <a href="https://stackoverflow.com/questions/52614977/concatenate-distinct-columns-in-two-dataframes-using-pandas-and-append-similar/52615147#52615147">answered here</a></span>
<span class="comment-copy">It is similar but I want to merge all the columns that are provided in <code>on_columns</code> not just ones that are different from each other.</span>
<span class="comment-copy">Can you provide a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a> with some sample data and your expected output?</span>
<span class="comment-copy">I edited it - hope that helps a bit.</span>
<span class="comment-copy">That worked! Thanks!</span>
<span class="comment-copy">Cool, can you accept this as the answer then by upvoting?</span>
<span class="comment-copy">you can remove the second if statement</span>
<span class="comment-copy">@DoganAskan I did, but since I am not above 15 reputation yet, my upvote isn't publicly displayed.</span>
