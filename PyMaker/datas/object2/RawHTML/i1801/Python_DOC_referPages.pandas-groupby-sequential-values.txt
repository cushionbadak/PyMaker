<div class="post-text" itemprop="text">
<p>I have no idea how to call this operation, so I couldn't really google anything, but here's what I'm trying to do:</p>
<p>I have this dataframe:</p>
<pre><code>df = pd.DataFrame({"name": ["A", "B", "B", "B", "A", "A", "B"], "value":[3, 1, 2, 0, 5, 2, 3]})
df
  name  value
0    A      3
1    B      1
2    B      2
3    B      0
4    A      5
5    A      2
6    B      3
</code></pre>
<p>And I want to group it on <code>df.name</code> and apply a <code>max</code> function on <code>df.values</code> but only if the names are in sequence. So my desired result is as follows:</p>
<pre><code>df.groupby_sequence("name")["value"].agg(max)
  name  value
0    A      3
1    B      2
2    A      5
3    B      3
</code></pre>
<p>Any clue how to do this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Using <code>pandas</code>, you can groupby when the name changes from row to row, using <code>(df.name!=df.name.shift()).cumsum()</code>, which essentially groups together consecutive names:</p>
<pre><code>&gt;&gt;&gt; df.groupby((df.name!=df.name.shift()).cumsum()).max().reset_index(drop=True)
  name  value
0    A      3
1    B      2
2    A      5
3    B      3
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Not exactly a pandas solution, but you could use <a href="https://docs.python.org/3/library/itertools.html#itertools.groupby" rel="nofollow noreferrer">groupby</a> from itertools:</p>
<pre><code>from operator import itemgetter

import pandas as pd
from itertools import groupby

df = pd.DataFrame({"name": ["A", "B", "B", "B", "A", "A", "B"], "value":[3, 1, 2, 0, 5, 2, 3]})

result = [max(group, key=itemgetter(1)) for k, group in groupby(zip(df.name, df.value), key=itemgetter(0))]

print(result)
</code></pre>
<p><strong>Output</strong></p>
<pre><code>[('A', 3), ('B', 2), ('A', 5), ('B', 3)]
</code></pre>
</div>
<span class="comment-copy">Very smart use of <code>shift</code> and <code>cumsum</code>, thanks!</span>
