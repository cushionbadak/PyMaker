<div class="post-text" itemprop="text">
<p>I'm trying to use the execute function of sqlite3 to sanitize the string that I got. However, I can't do it in my case because I can't figure out how to use the values in the tuple more than one time.</p>
<p>What I can do is this,</p>
<pre><code>cursor.execute("""
                    select *
                    from rides r
                    where r.cno = c.cno
                    and (r.src like '%{0}%'
                    or r.dst like '%{0}%'
                    or e.lcode like '%{0}%'
                    and (r.src like '%{1}%'
                    or l3.address like '%{1}%')
                    and (r.src like '%{2}%'
                    or l1.address like '%{2}%')
                    ;
                    """.format(keywords[0], keywords[1], keywords[2]))
</code></pre>
<p>However, I learnt that it is open for sqlinjection attacks since the input is being directly used in here. Is there a way I could still use tuples at the end of the execute function multiple times?</p>
</div>
<div class="post-text" itemprop="text">
<p>sqlite3 puts their sanitation front-and-center in the docs. Use the named placeholder style.</p>
<p><a href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.execute" rel="nofollow noreferrer">https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.execute</a></p>
<pre><code># This is the qmark style:
cur.execute("insert into people values (?, ?)", (who, age))

# And this is the named style:
cur.execute("select * from people where name_last=:who and age=:age", {"who": who, "age": age})
</code></pre>
<p>This answer to a previous post could help you visualize the fix as well:
<a href="https://stackoverflow.com/a/12184247/10553976">https://stackoverflow.com/a/12184247/10553976</a></p>
</div>
<span class="comment-copy">Wow, thank you for that. What I did as a solution is repeating the variables in the tuple again and again to match the question mark. Your way is much better though. Thank you for your answer, Charles Landau.</span>
<span class="comment-copy">You're very welcome! If the response resolves your issue, please mark it as the answer.</span>
