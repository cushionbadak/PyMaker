<div class="post-text" itemprop="text">
<p>I have a setup, where I want to connect from a Windows7 VM to a Linux Server through passwordless SSH with private/public keys.</p>
<p>The SSH connection works fine through the Cygwin terminal.</p>
<p>With Paramiko, I can connect from my client to my host if I accept missing host keys, but if I try to use <code>known_hosts</code> instead, I get the error: </p>
<blockquote>
<p>Server XXX not found in known_hosts.</p>
</blockquote>
<p>Is Paramiko at all able to read the <code>known_hosts</code> file in Windows/Cygwin? Can I somehow provide the path?</p>
<p>My <code>.ssh</code> folder is located under <code>C:\cygwin64\home\&lt;user&gt;\.ssh</code>.</p>
<p>Thank you a lot for your help,<br/>
Thomas</p>
</div>
<div class="post-text" itemprop="text">
<p>I assume you are using <a href="https://docs.paramiko.org/en/stable/api/client.html#paramiko.client.SSHClient.load_system_host_keys" rel="nofollow noreferrer"><code>SSHClient.load_system_host_keys</code></a>.</p>
<p>By default, the methods loads <code>os.path.expanduser('~/.ssh/known_hosts')</code> file. What does not match your <code>C:\cygwin64\home\&lt;user&gt;\.ssh</code> location, as on Windows <a href="https://docs.python.org/3/library/os.path.html#os.path.expanduser" rel="nofollow noreferrer"><code>os.path.expanduser</code></a> uses <code>USERPROFILE</code> environment variable, which points to <code>C:\Users\&lt;user&gt;</code>.</p>
<hr/>
<p>You can fix that by:</p>
<ul>
<li>Changing your Cygwin configuration somehow (but it can break other things);</li>
<li>or creating directory junction from <code>C:\Users\&lt;user&gt;\.ssh</code> to <code>C:\cygwin64\home\&lt;user&gt;\.ssh</code> (probably the most portable solution);</li>
<li>or explicitly specifying <code>filename</code> argument in a call to <code>SSHClient.load_system_host_keys</code> (not portable);</li>
<li>or setting <code>HOME</code> environment variable to point to <code>C:\cygwin64\home\&lt;user&gt;</code> before running your Python script - <code>os.path.expanduser</code> prefers <code>HOME</code> to <code>USERPROFILE</code> - and Windows does not use <code>HOME</code> (can break other things).</li>
</ul>
</div>
<span class="comment-copy">Note that <i>"passwordless connection"</i> has nothing to do with <i>"known_hosts file"</i>.</span>
<span class="comment-copy">Where's your cygwin <code>.ssh</code> folder physically?</span>
<span class="comment-copy">Hello Martin, thank you for your answer.I realize that passwordless has nothing to do with it, I just mentioned it because it is my actual use case. Otherwise I could just use my current setup, auto-add missing host files and provide a password. If I only auto-add missing host files without providing a password I get a "No Athentication methods available" error.</span>
<span class="comment-copy">My .ssh folder is located under C:\cygwin64\home\&lt;user&gt;\.ssh</span>
<span class="comment-copy">Creating a directory junction did not work, because the path expands to 'C:\\Users\\&lt;user&gt;/.ssh/known_hosts', so I ended up supplying the filename directly.  Since Paramiko has the same problem for the private key file the key_filename paramter has to be set supplying the private key location.  Thank you for your help, it works perfectly now</span>
<span class="comment-copy">OK. Though I still do not understand why directory junction didn't work.</span>
