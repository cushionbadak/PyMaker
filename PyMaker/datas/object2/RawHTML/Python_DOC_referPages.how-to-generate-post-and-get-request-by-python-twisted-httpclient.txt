<div class="post-text" itemprop="text">
<p>I am writing an HTTP Client. It is a simple mock bank site. It needs to be able to send two kinds of request out:</p>
<ol>
<li>When user login:
POST /login?user=bob&amp;pass=abc123 
HTTP/1.1 
Host:  bank.com</li>
<li>When the user transfers money:
GET /transfer?to=badguy&amp;amt=100 
HTTP/1.1 
Host:  bank.com
Cookie: login=fde874</li>
</ol>
<p>I am implementing it by python twisted, I write a subclass of HTTPClient:</p>
<pre><code>class BankClient(HTTPClient):
    def genReq():
       # How to write code to generate and send the Two request?

    def connectionMode(self):
        genReq()



class BankCllientFactory(ClientFactory):
    protocol = BankClient
    def __init__(self):
       self.done = Defered()


def main(reactor):
   factory= BankClientFactory()
   reactor.connectTCP('localhost',8080,factory)
   return factory.done
if __name__ =='__main__':
    task.react(main)

</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You want to stop using <code>HTTPClient</code>.  Instead, use <a href="https://twistedmatrix.com/documents/current/web/howto/client.html#the-agent" rel="nofollow noreferrer"><code>Agent</code></a> or the third-party <a href="https://treq.readthedocs.io/en/release-17.8.0/" rel="nofollow noreferrer"><code>treq</code></a>.</p>
<p>To generate <code>GET</code> and <code>POST</code> with <code>Agent</code>:</p>
<pre><code>from twisted.web.client import Agent
from twisted.internet import reactor
agent = Agent(reactor)
d_get = agent.request(b"GET", uri)
d_post = agent.request(b"POST", uri)
</code></pre>
<p>To generate <code>GET</code> and <code>POST</code> with <code>treq</code>:</p>
<pre><code>import treq
d_get = treq.get(url)
d_post = treq.post(url)
</code></pre>
</div>
