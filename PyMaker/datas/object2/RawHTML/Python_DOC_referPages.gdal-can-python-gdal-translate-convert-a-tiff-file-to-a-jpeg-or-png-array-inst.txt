<div class="post-text" itemprop="text">
<p>I have python code to convert a <code>GeoTIFF</code> image file to a <code>JPEG</code> image file. However, I would like to do this in-memory, meaning that I would like to read the <code>GeoTIFF</code> file, convert it to JPEG, then store the converted data to an in-memory structure, like a <code>numpy</code> array ideally. Is there a way to do this?</p>
<p>Here is some sample code I was hoping to adapt:</p>
<pre><code>from osgeo import gdal

scale = '-scale min_val max_val'
options_list = [
    '-ot Byte',
    '-of JPEG',
    scale
] 
options_string = " ".join(options_list)

gdal.Translate('test.jpg',
               'test.tif',
               options=options_string)
</code></pre>
<p>This code uses the <code>GDAL</code> python api, but it requires an output type referencing a file like <code>test.jpg</code> in the code above. But I don't want to specify an output file--instead I want to output the result to some sort of array.</p>
<p>Note that I did try this conversion without using <code>GDAL</code> too, but all of the pixel intensity ranges were getting compressed to a very small range instead of the range generated from <code>GDAL.Translate()</code>. </p>
<p><strong>RESEARCHED ANSWERS THAT DON'T APPLY</strong></p>
<p>Note that I researched some other Stack Exchange Posts on this topic, but they all will convert the <code>GeoTIFF</code> file to another file. I don't want to write a new file. I am including the link here for convenience, but key point is that existing posted questions don't match this one. </p>
<p><a href="https://stackoverflow.com/questions/50207292/how-to-convert-geotiff-to-jpg-in-python-or-java">how to convert geotiff to jpg in python or java?</a></p>
<p>Any ideas?</p>
</div>
<div class="post-text" itemprop="text">
<p>In case you want to convert an existing Gdal Dataset or a Band into a <code>numpy</code> array you can convert it with <code>ReadAsArray()</code> function, for example:</p>
<pre><code>ds = gdal.Open('test.tif')
band = ds.GetRasterBand(1)
data = band.ReadAsArray()
</code></pre>
<p>You can check the datatype,</p>
<pre><code>type(data)
</code></pre>
<p>and confirm you have a <code>numpy</code> array.</p>
</div>
<span class="comment-copy">You do realize that you can't do much with a JPEG in memory except write it to a file, right? If you want to do something at a pixel level that's a whole different question.</span>
<span class="comment-copy">I am coding some imagery from the original GeoTIFF format to a <code>TFRecords</code> format for machine learning. So I never actually use the PNG or JPEG files, I just need the data converted from TIFF format into a format that is formatted like PNG or JPEG. It needs to be formatted like PNG or JPEG so that I can validate that the image went into <code>TFRecords</code> properly when I decode the data.</span>
<span class="comment-copy">You should have put that information in the question. You don't actually want PNG or JPEG format, you want something that can be used natively by <code>tf</code> without reading it from a file.</span>
<span class="comment-copy">@MarkRansom Good point. <code>Tensorflow</code> is so ambiguous. So you can technically I can write any kind of information as a string to this <code>TFRecords</code> format. So I could even directly code the TIFF file to string and pass it to <code>Tensorflow</code>. BUT, <code>Tensorflow</code> does have some built in functions to parse JPEGs and PNGs, and I need to make sure that <code>Tensorflow</code> recognizes this as an image. I just thought some of these details might distract from the core of the question. But I definitely could have added more context to help explain the question.</span>
