<div class="post-text" itemprop="text">
<p>I have UTF-8 (no BOM) encoded CSV file:</p>
<pre><code>aaa;bbb;ccc
fff;äää;ööö
</code></pre>
<p>Following snippet reads the the file and then saves it again using different encoding:</p>
<pre><code>import csv

rows = []
with open('test_in.csv', 'r', newline='') as file:
    csvReader = csv.reader(file, delimiter=';')
    for row in csvReader:
        rows.append(row)

with open('test_out.csv', 'w', newline='', encoding='iso-8859-1') as file:
    csvWriter = csv.writer(file, delimiter=';', quoting=csv.QUOTE_MINIMAL)
    for row in rows:
        csvWriter.writerow(row)
</code></pre>
<p><strong>Problem:</strong> Saved file is not iso-8859-1, but utf-8 encoded. </p>
<p>If I replace the file read with following list in my UTF-8 encoded source code file, it works correctly:</p>
<pre><code>rows = [
    ['aaa','bbb','ccc'],
    ['fff','äää','ööö']
]
</code></pre>
<p>Is this a bug in Python?  Or do I have to use additional encoding options?</p>
<p>Tested with Python 3.4.</p>
</div>
<div class="post-text" itemprop="text">
<p>I tried with python3.5.1 and it worked fine for me:</p>
<pre><code>sharad@ss:~$ rm test_out.csv
sharad@ss:~$ ls test_in.csv
test_in.csv
sharad@ss:~$ cat my.py
import csv

rows = []
#with open('my.csv', 'r', newline='', encoding='utf-8') as file:
with open('test_in.csv', 'r', newline='') as file:
    csvReader = csv.reader(file, delimiter=';')
    for row in csvReader:
        rows.append(row)

with open('test_out.csv', 'w', newline='', encoding='iso-8859-1') as file:
    csvWriter = csv.writer(file, delimiter=';', quoting=csv.QUOTE_MINIMAL)
    for row in rows:
        csvWriter.writerow(row)
sharad@ss:~$
sharad@ss:~$ python3.5 my.py
sharad@ss:~$ ls test_out.csv
test_out.csv
sharad@ss:~$ file test_*.csv
test_in.csv:  UTF-8 Unicode text
test_out.csv: ISO-8859 text, with CRLF line terminators
sharad@ss:~$
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>It seems <code>encoding</code> option for <code>open()</code> doesn't work as I thought (I assumed it defaults to UTF-8). Docs for <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow">open</a> say:</p>
<blockquote>
<p><em>encoding</em> is the name of the encoding used to decode or encode the file. This should only be used in text mode. <strong>The default encoding is platform dependent (whatever <code>locale.getpreferredencoding()</code> returns)</strong>, but any text encoding supported by Python can be used. ...</p>
</blockquote>
<p>And on my system it seems to default to <em>cp1252</em>. Thus <code>repr(rows)</code> returns </p>
<pre><code>[['aaa', 'bbb', 'ccc'], ['fff', 'Ã¤Ã¤Ã¤', 'Ã¶Ã¶Ã¶']]
</code></pre>
<p>Fix is to explicitly specify encoding also for the input file:</p>
<pre><code>with open('test_in.csv', 'r', newline='', encoding='utf-8') as file:
</code></pre>
</div>
