<div class="post-text" itemprop="text">
<p>If I change environment variable using <code>os.environ</code>, do the modules I import afterwards see that change?</p>
<p>Specifically, <code>sqlite3</code> <a href="https://stackoverflow.com/a/23251896/336527">requires</a> the use of an environment variable to determine its temporary file location. But if I use <code>os.environ['SQLITE_TMPDIR'] = '.'</code> before <code>import sqlite3</code>, it does not have the desired effect. Why?</p>
</div>
<div class="post-text" itemprop="text">
<p>The <code>sqlite3</code> module is just a wrapper for the SQLite C library, so it will not directly see any changes made to <code>os.environ</code>.</p>
<p>However, the <a href="https://docs.python.org/3/library/os.html#os.environ" rel="nofollow noreferrer">documentation</a> says:</p>
<blockquote>
<p>If the platform supports the <a href="https://docs.python.org/3/library/os.html#os.putenv" rel="nofollow noreferrer">putenv()</a> function, this mapping may be used to modify the environment as well as query the environment. <a href="https://docs.python.org/3/library/os.html#os.putenv" rel="nofollow noreferrer">putenv()</a> will be called automatically when the mapping is modified.</p>
</blockquote>
<p>So if the SQLite library is initialized after you've changed <code>os.environ</code>, it will see the changes.</p>
<p>Please note that SQLite reads different environment variables <a href="https://stackoverflow.com/a/23251896/336527">on Unix-y OSes</a> and <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa364992.aspx" rel="nofollow noreferrer">on Windows</a>.</p>
</div>
<span class="comment-copy">RTFM: os.environ: "This mapping is captured the first time the os module is imported, typically during Python startup as part of processing site.py. Changes to the environment made after this time are not reflected in os.environ, except for changes made by modifying os.environ directly."  Also see docs for os.putenv, which has some platform-dependent features.</span>
<span class="comment-copy">It is easier to read the manual if you <a href="https://docs.python.org/3/library/os.html#os.environ" rel="nofollow noreferrer">link to it</a>.</span>
<span class="comment-copy">@PaulCornelius You misunderstood the documentation. It says changes to the environment won't be reflected in <code>os.environ</code>. I'm trying to do the opposite: change <code>os.environ</code> in order to change the environment. The docs say nothing about it.</span>
