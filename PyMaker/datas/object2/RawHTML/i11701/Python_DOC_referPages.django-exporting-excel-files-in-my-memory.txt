<div class="post-text" itemprop="text">
<p>I want to export some Excel file in my memory, and here is my code.</p>
<pre><code>wrapper = open('/home/filename.xlsx')
response = HttpResponse(wrapper,content_type='application/force-download')
response['Content-Disposition'] = 'attachment ; filename=%s' % smart_str('filename.xlsx')
response['X-Sendfile'] = smart_str('/home/filename.xlsx')
        return response
</code></pre>
<p>There is no problem when i use Python 2.7 but if i use Python 3.5 it occurs error </p>
<pre><code>'utf-8' codec can't decode byte 0x9c in position 10:invalid start byte 
</code></pre>
<p>I guess the error is because of their difference (open function)</p>
<p>What is the appropriate way to open excel file in my memory and export it?</p>
</div>
<div class="post-text" itemprop="text">
<p>In Python 3.x files are opened in text mode by default. Change your first line to:</p>
<pre><code>wrapper = open('/home/filename.xlsx', 'rb')
</code></pre>
<p>From <a href="https://docs.python.org/3/tutorial/inputoutput.html#reading-and-writing-files" rel="nofollow">Python 3 documentation</a> (emphasis mine):</p>
<blockquote>
<p>Normally, files are opened in text mode, that means, you read and write strings from and to the file, which are encoded in a specific encoding. If encoding is not specified, the default is platform dependent (see open()). 'b' appended to the mode opens the file in binary mode: now the data is read and written in the form of bytes objects. <strong>This mode should be used for all files that donâ€™t contain text.</strong></p>
</blockquote>
</div>
