<div class="post-text" itemprop="text">
<p>Column 'signal' is populated with 0 or 1, and I want column 'reversal to tell me when there is a change in this column (i.e., from 0 to 1 or 1 to 0). </p>
<h2>Issue: the code below gives me this information correctly for all the rows except the first one. The reason is that it tries to look at the value before the first one for column 'signal', and, since it does not find any value (of course - it is the first one!), it says that there is a change (as it does when the column's value changes from 0 to 1 or 1 to 0).</h2>
<h2>How can I fix it? I would like the code to disregard the first discrepancy, basically.</h2>
<pre><code>import pandas as pd
import numpy as np

d= {'signal':[0,0,0,1,1,0]}
df_zinc = pd.DataFrame(data=d)

df_zinc['reversal'] = np.where(df_zinc['signal']!=df_zinc['signal'].shift(),1,0)

print(df_zinc)
</code></pre>
<p>OUTPUT</p>
<pre><code>  signal reversal
0     0     1 
1     0     0 
2     0     0 
3     1     1 
4     1     0 
5     0     1 
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you are looking for the changes, I'd suggest using diff instead:</p>
<pre><code>df_zinc['signal'].diff().fillna(0)!=0
</code></pre>
<p>if you prefer it as a int instead of a boolean:</p>
<pre><code>bool_s = df_zinc['signal'].diff().fillna(0)!=0

int_s = bool_s.astype(int)
</code></pre>
<p><strong>Testing:</strong></p>
<pre><code>df_zinc['reversal'] = (df_zinc['signal'].diff().fillna(0)!=0).astype(int)
</code></pre>
<p>Output</p>
<pre><code> signal reversal
0   0   0
1   0   0
2   0   0
3   1   1
4   1   0
5   0   1
</code></pre>
</div>
<span class="comment-copy">Please format your code properly.</span>
<span class="comment-copy">Welcome to Stack overflow, Please provide minimal example, sample input and output. <a href="https://stackoverflow.com/help/mcve">stackoverflow.com/help/mcve</a></span>
<span class="comment-copy">I added the sample code and output. Thanks for pointing it out. do you know how to solve that?</span>
<span class="comment-copy">thanks ecortazar. this does not solve the problem unfortunately. I added inputs and outputs for you to have an easier way to verify.</span>
<span class="comment-copy">I've tested (results above) and get what I expected was the target answer. Could you please clarify what the goal is?</span>
<span class="comment-copy">i was fixing my code in the wrong way probably. now i get the problem solved. Thanks!!</span>
