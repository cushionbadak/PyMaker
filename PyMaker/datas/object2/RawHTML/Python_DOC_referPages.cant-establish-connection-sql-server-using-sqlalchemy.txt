<div class="post-text" itemprop="text">
<p>I'm trying to use Python to upload from a Pandas dataframe to a SQL Server table, but I can't successfully create a connection using sqlalchemy. I understand I first need to create an engine object using create_engine(), and create a connection object using engine.connect(), but no string I enter in create_engine() seems to work. I've tried the following:</p>
<pre><code>engine = create_engine('mssql+pyodbc://myServer/myDB')
conn = engine.connect()
</code></pre>
<p>and:</p>
<pre><code>engine = create_engine('mssql+pyodbc://Server=myServer;Database=myDB;')
conn = engine.connect()
</code></pre>
<p>and:</p>
<pre><code>engine = create_engine('mssql+pyodbc://Driver={SQL Server};Server=myServer;Database=myDB;Trusted_Connection=yes;')
conn = engine.connect()
</code></pre>
<p>but all result in the following error:</p>
<blockquote>
<p>InterfaceError: (pyodbc.InterfaceError) ('IM002', '[IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified (0) (SQLDriverConnect)')</p>
</blockquote>
<p>I've also tried:</p>
<pre><code>engine = create_engine('mssql+pyodbc://Driver={SQL Server Native Client 11.0};Server=myServer;Database=myDB;Trusted_Connection=yes;')
conn = engine.connect()
</code></pre>
<p>which results in the following error:</p>
<blockquote>
<p>DBAPIError: (pyodbc.Error) ('IM010', '[IM010] [Microsoft][ODBC Driver
  Manager] Data source name too long (0) (SQLDriverConnect)')</p>
</blockquote>
<p>While I can successfully connect using pyodbc like this:</p>
<pre><code>conn = pyodbc.connect('DRIVER={SQL Server};Server=myServer;Database=myDB;Trusted_Connection=yes;')
</code></pre>
<p>I can't seem to make this work for sqlalchemy.</p>
<p>Any help would be appreciated.</p>
</div>
<div class="post-text" itemprop="text">
<p>The solution:</p>
<pre><code>engine = create_engine('mssql+pyodbc://ERRSTSDBP2/ActPri?driver=SQL+Server+Native+Client+11.0')
</code></pre>
<p>Thanks to norbeq for getting me most of the way there!</p>
</div>
<div class="post-text" itemprop="text">
<p>You can try connection like this:</p>
<p><code>engine = create_engine('mssql+pyodbc://user:password@host:port/myDB')
conn = engine.connect()</code></p>
</div>
<span class="comment-copy">I don't have a password, I connect with Windows authentication. What does 'host:port' mean? I tried the following, it didn't work:  engine = create_engine('mssql+pyodbc://login@myServer/myDB') conn = engine.connect()</span>
<span class="comment-copy">Ok, so engine should be : <code>engine = create_engine('mssql+pyodbc://@myServer/myDB?trusted_connection=yes&amp;driver=SQLServer+Native+Client+11.0')</code></span>
<span class="comment-copy">Still getting this error:  InterfaceError: (pyodbc.InterfaceError) ('IM002', '[IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified (0) (SQLDriverConnect)')</span>
<span class="comment-copy">I got it!  The solution:  engine = create_engine('mssql+pyodbc://myServer/myDB?driver=SQL+Server+Native+Client+11.0')</span>
