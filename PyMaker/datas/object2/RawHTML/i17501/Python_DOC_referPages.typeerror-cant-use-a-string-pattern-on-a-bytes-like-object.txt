<div class="post-text" itemprop="text">
<pre><code>import json
import requests

url = 'http://developer.usa.gov/1usagov.json'
r = requests.get(url, stream=True)

for line in r.iter_lines():
    if line:
        print (json.loads(line))
</code></pre>
<p>Gives this error:</p>
<pre><code>TypeError: can't use a string pattern on a bytes-like object
</code></pre>
<p>While viewing through the browser i do see that the response is a Json but request library says its a bytes like object why so ?</p>
</div>
<div class="post-text" itemprop="text">
<p>If you use Python 3.x, you should pass <code>str</code> object to <a href="http://docs.python.org/3/library/json.html#json.loads" rel="nofollow noreferrer"><code>json.loads</code></a>.</p>
<p>Replace following line:</p>
<pre><code>print(json.loads(line))
</code></pre>
<p>with:</p>
<pre><code>print(json.loads(line.decode()))
</code></pre>
<p>UPDATE: The behavior changed in Python 3.6. The argument can now be of type bytes or bytearray. The input encoding should be UTF-8, UTF-16 or UTF-32.</p>
</div>
<span class="comment-copy">Generally when things are passed around the network, they're in the form of bytes</span>
<span class="comment-copy">Pesky Python 3.</span>
<span class="comment-copy">@nehemiah I'd rather get an exception than have a bug in my code.</span>
<span class="comment-copy">No, json loads expects a string, which means it would coerce(try to convert) the incoming object into string, which is what happens in p2 and it's very pythonic. Why do you think this will lead to a bug?</span>
<span class="comment-copy">@nehemiah, Behavior changed in Python 3.6: Changed in version 3.6: s can now be of type bytes or bytearray. The input encoding should be UTF-8, UTF-16 or UTF-32. (<a href="https://docs.python.org/3/library/json.html#json.loads" rel="nofollow noreferrer">docs.python.org/3/library/json.html#json.loads</a>) This question is tagged python-3.x, so I answered based on Python 3.x behavior (prior to Python 3.6).</span>
<span class="comment-copy"><a href="https://i.imgur.com/DFoQzSK.png" rel="nofollow noreferrer">i.imgur.com/DFoQzSK.png</a> (run in Python 3.5.3)</span>
