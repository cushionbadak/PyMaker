<div class="post-text" itemprop="text">
<p>I'm able to get stdin/out working just fine with mozjpeg 3 if I just run without any flags. 
Example(Python):</p>
<pre><code>fp = urllib.urlopen(http://path.to/unoptimized.jpg)
out_im2 = StringIO.StringIO(fp.read()) # StringIO Image
subp = subprocess.Popen(["/home/ubuntu/mozjpeg/cjpeg"],stdin=subprocess.PIPE,stdout=subprocess.PIPE)
    image_results = subp.communicate(input=out_im2.getvalue())
</code></pre>
<p>If, however, I attempt to customize this with switches(For example "-quality 70"), I cannot get it to work. I'm not sure if this is a bug or if I'm missing something. Any insight would be greatly appreciated:</p>
<pre><code>subp = subprocess.Popen(["/home/ubuntu/mozjpeg/cjpeg", "-quality 70"],stdin=subprocess.PIPE,stdout=subprocess.PIPE)
image_results = subp.communicate(input=out_im2.getvalue())
</code></pre>
<p>Upon this execution, I receive the following back:</p>
<pre><code>/home/ubuntu/mozjpeg/.libs/lt-cjpeg: unknown option 'quality 70'
usage: /home/ubuntu/mozjpeg/.libs/lt-cjpeg [switches] [inputfile]
Switches (names may be abbreviated):
  -quality N[,...]   Compression quality (0..100; 5-95 is useful range)
.... &lt;Rest of --help screen&gt;
</code></pre>
<p>Thanks in advance for any help.</p>
</div>
<div class="post-text" itemprop="text">
<p>Thanks to <a href="https://github.com/njdoyle" rel="nofollow">https://github.com/njdoyle</a>
“-quality 70” should be “-quality”, “70”. Two parameters.</p>
<p>So:</p>
<pre><code>subp = subprocess.Popen(["/home/ubuntu/mozjpeg/cjpeg", "-quality","70"],stdin=subprocess.PIPE,stdout=subprocess.PIPE)
image_results = subp.communicate(input=out_im2.getvalue())
</code></pre>
</div>
<span class="comment-copy">why do you use <code>out_im2</code> StringIO instead of passing <code>subp.communicate(input=fp.read())</code> directly? You even can <a href="http://stackoverflow.com/a/28724272/4279">redirect subprocess' stdin from the socket (it works on Ubuntu) without loading it in memory</a>.</span>
<span class="comment-copy">read <a href="https://docs.python.org/3/library/subprocess.html#frequently-used-arguments" rel="nofollow noreferrer">"Frequently Used Arguments" section in subprocess' docs</a> to avoid being stuck on simple things.</span>
