<div class="post-text" itemprop="text">
<p>Consider the following minimal example:</p>
<pre><code>try:
  raise Exception('foo')
except Exception:
  try:
    raise Exception('bar')
  except Exception:
    pass
  raise 
</code></pre>
<p>Running this code with Python 2 raises exception bar, running it with Python 3 raises exception foo. Yet, the documentation for both <a href="https://docs.python.org/2/reference/simple_stmts.html#raise" rel="nofollow">Python 2</a> and <a href="https://docs.python.org/3/reference/simple_stmts.html#raise" rel="nofollow">Python 3</a> states that <code>raise</code> with no expression will raise "the last exception that was active in the current scope". Why is the scope different in Python 2 and 3? Is the difference documented anywhere?</p>
</div>
<div class="post-text" itemprop="text">
<p>The scopes are different because Python 3 is more advanced.  :)</p>
<p>The scope for <code>bar</code> starts with the indented <code>try</code>, and ends after the last statement in its <code>except</code> clause (or <code>finally</code> clause had there been one); the bare <code>raise</code> is clearly in the the <code>foo</code> <code>except</code> stanza, and that is what is reraised.</p>
<p>This is one of those little things that was fixed in Python 3.  The docs could be clearer, though.</p>
</div>
<span class="comment-copy">You can see the 2.x vs. 3.x changes to exceptions at <a href="https://docs.python.org/3.0/whatsnew/3.0.html#changes-to-exceptions" rel="nofollow noreferrer">docs.python.org/3.0/whatsnew/3.0.html#changes-to-exceptions</a></span>
<span class="comment-copy">Thanks. It seems that this relates to the implicit cleanup of exception names from blocks introduced by PEP 3110 <a href="https://www.python.org/dev/peps/pep-3110/" rel="nofollow noreferrer">python.org/dev/peps/pep-3110</a> and mentioned in the documentation with a change between 2 and 3: <a href="https://docs.python.org/2/reference/compound_stmts.html#try" rel="nofollow noreferrer">docs.python.org/2/reference/compound_stmts.html#try</a> <a href="https://docs.python.org/3/reference/compound_stmts.html#try" rel="nofollow noreferrer">docs.python.org/3/reference/compound_stmts.html#try</a>. Yet this is incomplete at best, because it claims that this only applies to exceptions assigned using "as target".</span>
<span class="comment-copy">Behavior difference verified in 2.7.9 and 3.4.3rc1.  Can you raise an issue on the tracker (bugs.python.org)?  (If not one already.)</span>
<span class="comment-copy">@TerryJanReedy: done: <a href="http://bugs.python.org/issue23556" rel="nofollow noreferrer">bugs.python.org/issue23556</a></span>
<span class="comment-copy">OK, I agree that the Python 3 way is more intuitive. I essentially wanted confirmation that this was known and that the documentations should be improved, so I guess there is nothing more to say until issue 23556 is dealt with by the Python people. Thanks!</span>
