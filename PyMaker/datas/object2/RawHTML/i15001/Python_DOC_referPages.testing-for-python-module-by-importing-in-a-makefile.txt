<div class="post-text" itemprop="text">
<p>I am trying to create a generate Makefile.  Is there a way to test whether a python module exists and then perform different actions in the Makefile based on that?</p>
<p>I have tried something like this</p>
<pre><code>all:

ifeq (,$(@ python -c 'import somemodule'))                                                                                                                                                                                                          
echo "DEF MODULE = 1" &gt; settings.pxi                                                                                                                                                                                                     
else                                                                                                                                                                                                                                                 
echo "DEF MODULE = 0" &gt; settings.pxi                                                                                                                                                                                                     
endif                                                                                                                                                                                                                                                
    python setup.py build_ext --build-lib . --build-temp build --pyrex-c-in-temp 
</code></pre>
<p>however doing this does not produce any result.  Also if the module does not exist, python throws an error- how to store this information rather than simply crashing?</p>
</div>
<div class="post-text" itemprop="text">
<p>Consider making use of Python's <a href="https://docs.python.org/2/library/imp.html" rel="nofollow" title="imp">imp</a> module. Specifically, <code>imp.find_module</code> should be exactly what you're looking for.</p>
</div>
<span class="comment-copy">You'll need to try/catch the body of the python code to have python not explode on you I think. Does running that code by hand produce output?</span>
<span class="comment-copy">What you've written here is not a valid makefile; if you try to run make with that you'll get an error (<i>missing separator</i>).  Makefiles are not shell scripts.</span>
<span class="comment-copy">Edited to show actual makefile</span>
<span class="comment-copy">I also can't seem to do a try/except block using python -c...</span>
<span class="comment-copy">I think this gives the same problem as testing an import using just 'import somemodule', because it will also throw an error when the module is not found.</span>
<span class="comment-copy">You've noticed you can't use try/catch from command line, so you'll need a module for this, with a module name passed in as an argument. That's going to be a string, but you can't use <code>import</code> with a string. That's where <code>imp.find_module</code> becomes useful.</span>
<span class="comment-copy">Since 3.4, imp has been deprecated, so try <a href="https://docs.python.org/3/library/importlib.html" rel="nofollow noreferrer">docs.python.org/3/library/importlib.html</a> instead.</span>
