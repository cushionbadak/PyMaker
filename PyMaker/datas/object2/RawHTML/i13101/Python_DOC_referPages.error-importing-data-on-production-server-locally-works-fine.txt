<div class="post-text" itemprop="text">
<p>I'm trying to import this CSV file. It works perfectly on my local setup on django. However- it won't import on my actual server/production version. </p>
<p>I am using SQLite (locally), and Postgres on the server. But I don't see any settings that would affect it. Any suggestions?</p>
<p>My import file:</p>
<pre><code>import sys, os
import django

sys.path.append('/srv/apps/stashdDB/code')
os.environ['DJANGO_SETTINGS_MODULE'] = 'stashdDB.settings'

django.setup()

import stashd.models as m




import csv

l = list(csv.reader(open('test_data.csv', encoding='utf-8', errors='ignore')))

Gender_CHOICES = {
    'Male': 1,
    'Female': 2,
    'Unisex': 3,
}

Stock_CHOICES = {
    'in stock': 1,
    'low stock': 2,
    'out of stock': 3,
    'discountinued': 4
}

for i in l[1:]:
        cat = m.Category.objects.get_or_create(category_name = i[4])[0]
        prod = m.Product(
            name = i[0],
            link = i[1],
            description = i[6],
            brand = i[7],
            gender = Gender_CHOICES[i[8]] if i[8] in Gender_CHOICES else 3,
            store = m.Store.objects.get_or_create(store_name = i[2])[0]
            )
        prod.save()
        var = m.Variation(
            product = prod,
            variation = "default"
            )
        var.save()
        img = m.Image(
            variation = var,
            image = i[5]
            )
        img.save()
        size = m.Size(
            variation = var
            )
        size.save()
        price = m.Price(
            variation = var,
            price = float(i[3])
            )
        price.save()
        stock = m.Stock(
            size = size,
            stock = Stock_CHOICES[i[9]] if i[9] in Stock_CHOICES else 4
            )
        stock.save()
        prod.category.add(cat)
</code></pre>
<p>Error:</p>
<pre><code>Traceback (most recent call last):
  File "update_fromcsv.py", line 18, in &lt;module&gt;
    l = list(csv.reader(open('test_data.csv', encoding='utf-8', errors='ignore')))
TypeError: 'errors' is an invalid keyword argument for this function
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You are using different versions of Python locally and on the server. </p>
<p>Locally, you are likely using Python 3, because <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow">Python 3.4 knows</a> the <code>errors</code> argument for <code>open()</code></p>
<pre><code>open(file, mode='r', buffering=-1, encoding=None, errors=None, 
     newline=None, closefd=True, opener=None)
</code></pre>
<p>On the server, you probably run Python 2, because in <a href="https://docs.python.org/2/library/functions.html#open" rel="nofollow">in Python 2.7</a> the <code>errors</code> argument does not exist</p>
<pre><code>open(name[, mode[, buffering]])
</code></pre>
<p>That's why the error message is complaining about 'errors' being "invalid". </p>
</div>
<span class="comment-copy">Have you installed Django on the server? The error is because it can't find Django package. If you have virtualenv installed, is the virtualenv active on the server?</span>
<span class="comment-copy">Check whether django is installed or virtual environment is activated in production.</span>
<span class="comment-copy">Right. And also, always keep a requirements.txt in project dir. Keep on updating it whenever you update it on local after installing any package.</span>
<span class="comment-copy">Yes- I have a requirements.txt which has all my pip installs/ Django is installed on the Virtualenv part of the server, and I'm running the command/import.py from the virutla env. What next can I check?</span>
<span class="comment-copy">Check if it is the python in your virtual dev that is running this and not another installation of it</span>
