<div class="post-text" itemprop="text">
<p>I'm a new coder, currently trying to create a sample code for something bigger. I google'd most of my problems but I could not find any answers for the "final" problem, so I decided to post it.</p>
<p>This code is basically something that opens a Excel file, gets a specific column's data, edits the data and saves it to a text file called "Saved.txt". The code works good till here. My problem is when I'm trying to upload all the data line by line into row by row to another Excel file. Please help me out!</p>
<pre><code>import openpyxl
from openpyxl import Workbook

Code = "0507"
Save = open("Saved.txt","a")     

#Reading from XLSX and writing into a TEXT FILE after appending the data.
fname = 'Wekanda 2.xlsx'
wb = openpyxl.load_workbook(fname)
sheet = wb.get_sheet_by_name('Wekanda 2')
for rowOfCellObjects in sheet['R2':'R282']:
    for cellObj in rowOfCellObjects:
    line_w = cellObj.value
    line_w = str(line_w)
    line_w = line_w.replace(" ","@")
    Save.write("\n"+Code+line_w)
    test = str(line_w)
Save.close()
</code></pre>
<blockquote>
<p>This code works perfectly till here.</p>
</blockquote>
<pre><code>#Storing into Excel!
book = Workbook()
sheet = book.active

with open("Saved.txt","r") as f:
for line in f:
    for i in range(1,281):
        Pointer = "A"+str(i)
        sheet[Pointer] = line

book.save("Next.xlsx")
</code></pre>
<h1>OUTPUT</h1>
<h2> - EXCEL FILE   |         TEXT FILE       |        OUTPUT FILE</h2>
<ul>
<li>50 B2-3/3          |        050750@B2-3/3        |          050715</li>
</ul>
<hr/>
<ul>
<li>50 B2-3/4          |        050750@B2-3/4        |          050715</li>
</ul>
<hr/>
<ul>
<li>50 B2-3/5          |        050750@B2-3/5         |        050715</li>
</ul>
<hr/>
<p>I want the content in the TEXT FILE to exactly be there on the OUTPUT FILE.</p>
<p>Content in Text FILE.</p>
<ul>
<li>050730</li>
<li>050740</li>
<li>050740A</li>
<li>050740B</li>
<li>050740-1/1</li>
<li>050740-1/2</li>
<li>050740-2/1</li>
<li>050740-2/2</li>
<li>050740-3/1</li>
<li>050740-3/2</li>
<li>050740-4/1</li>
<li>050740-4/2</li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>I assume that you found the issue by now but I thought I'd pitch in with the answer here anyway (so we can start emptying the forum on unanswered questions).</p>
<p>You are creating a lot of cells that are then assigned the same value i.e. line. I assume that the value that you see in the output is part of the complete list of values? As a side note I might add that you are using a hard coded value in the range which should be avoided when possible.</p>
<p>Being a beginner myself I venture to suggest a solution that might work better.</p>
<pre><code>with open("Saved.txt","r") as f:
for i, line in enumerate(f):
    Pointer = "A{}".format(i+1)
    sheet[Pointer] = line
</code></pre>
<p>For more details on the enumerate function check out the official documentation <a href="https://docs.python.org/3/library/functions.html#enumerate" rel="nofollow noreferrer">here</a>. Basically it provides an index value for each element starting at zero.
Edit: Accidentally kept the str() around the i.</p>
</div>
<span class="comment-copy">Can we get a sample of the contents of <code>Saved.txt</code>? That'll help us a lot in helping you. Thanks!</span>
<span class="comment-copy">Yes, I have provided them above! @SeanFrancisN.Ballais</span>
