<div class="post-text" itemprop="text">
<p>I need to create a multi tiered dict in Python that ends up similar to this</p>
<pre><code>    "objects": {
    "LOCATION 1": {
        "EMPLOYEE 1": {
            "19": 3,
            "20": 0,
            "21": 0,
            "40": 4
        },
        "EMPLOYEE 2": {
            "24": 0,
            "42": 11,
            "43": 13
        }
    },...
      ...
      ...
</code></pre>
<p>Its a dict that shows work hours logged by each employee per week by Location. </p>
<p>A typical record follows this format [LOCATION,EMPLOYEE,HOURS_LOGGED,DATE], For each record I am deriving the week number from the date.</p>
<p>My current algorithm which takes approx 10 secs to make this using 10,000 records is as follows</p>
<pre><code>        result={}
        if (location in result):
            if (engineer in result[location]):
                if (week in result[location][engineer]):
                    result[location][engineer][week]=result[location][engineer][week]+laborminutes
                else:
                    result[location][engineer][week]=laborminutes
            else:
                result[location][engineer]={week:laborminutes}
        else:
            result[location]={engineer:{week:laborminutes}}
</code></pre>
<p>Anyway I can imrpove on this</p>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/collections.html#collections.defaultdict" rel="nofollow noreferrer"><code>collections.defaultdict</code></a> offers one way:</p>
<pre><code>from collections import defaultdict

result = defaultdict(lambda: defaultdict(lambda: defaultdict(int)))
result[location][engineer][week] += laborminutes
</code></pre>
<p><code>collections.defaultdict</code> is a subclass of <code>dict</code>. We have defined a nested structure of <code>dict(dict(dict(int)))</code>. Since the defaultvalue for <code>int</code> is 0, we can easily increment values by <code>laborminutes</code> given arbitrary keys <code>location</code>, <code>engineer</code>, <code>week</code>.</p>
</div>
<span class="comment-copy"><a href="https://codereview.stackexchange.com/">codereview.stackexchange.com</a></span>
<span class="comment-copy">Since SO is meant for users who have code that is not working, you will want to use the link Arnav provided and post this over on CodeReview. CR is dedicated to helping programmers improve the quality and efficiency of their code. You'll get an answer over there that will be far more likely to help you improve.</span>
<span class="comment-copy">Thanks will try it out</span>
<span class="comment-copy">The snippet above is off-topic on Code Review, though, since its missing several parts to get actually reviewed. Please <a href="https://codereview.stackexchange.com/help/on-topic">have a look at the help center</a> before you post your code there.</span>
<span class="comment-copy">@ArnavBorborah Please have a look at <a href="https://codereview.meta.stackexchange.com/questions/5777/a-guide-to-code-review-for-stack-overflow-users" title="a guide to code review for stack overflow users">codereview.meta.stackexchange.com/questions/5777/â€¦</a> before you redirect users to CR.</span>
<span class="comment-copy">Thanks I will give this a try</span>
<span class="comment-copy">This seems to work, I will have to confirm that the data is correct</span>
