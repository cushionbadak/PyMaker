<div class="post-text" itemprop="text">
<p>I'm attempting to allow an optional argument that takes a single command line argument of a filename:</p>
<pre><code>parser.add_argument('--somefile', nargs=1, type=argparse.FileType('r'),
                     required=False, default='defaultfile.json')
</code></pre>
<p>The problem is when I specify a file using the <code>--somefile foo.json</code> I get back a handle in a list:</p>
<pre><code>args.somefile=[&lt;_io.TextIOWrapper name='foo.json' mode='r' encoding='UTF-8'&gt;]
</code></pre>
<p>When I don't specify it and want the default, I get back a handle, but not in a list:</p>
<pre><code>args.somefile=&lt;_io.TextIOWrapper name='defaultfile.json' mode='r' encoding='UTF-8'&gt;
</code></pre>
<p>How do I get args.somefile to return the same type of structure (handle either in a list or not in a list) consistently?</p>
</div>
<div class="post-text" itemprop="text">
<p>Remove <a href="https://docs.python.org/3/library/argparse.html#nargs" rel="nofollow noreferrer"><code>nargs</code></a> argument.</p>
<blockquote>
<p>Note that <code>nargs=1</code> produces a list of one item. This is different from the default, in which the item is produced by itself.</p>
</blockquote>
<p><strong>UPDATE on comment</strong></p>
<blockquote>
<p>Removing <code>nargs=1</code> would eliminate the requirement to specify the filename argument.</p>
</blockquote>
<p>Lets check:</p>
<pre><code>&gt;&gt;&gt; import argparse
&gt;&gt;&gt; parser = argparse.ArgumentParser()
&gt;&gt;&gt; parser.add_argument('--somefile', type=argparse.FileType('r'), required=False, default='/tmp/data.json')
_StoreAction(option_strings=['--somefile'], dest='somefile', nargs=None, const=None, default='/tmp/data.json', type=FileType('r'), choices=None, help=None, metavar=None)
&gt;&gt;&gt; args = parser.parse_args(['--somefile',])
usage: [-h] [--somefile SOMEFILE]
: error: argument --somefile: expected one argument
</code></pre>
</div>
<span class="comment-copy">Removing <code>nargs=1</code> would eliminate the requirement to specify the filename argument.</span>
<span class="comment-copy">@Omniver, no, its not. Check it by yourself.</span>
<span class="comment-copy">Thank you.  I did not read far enough in the documentation.  'nargs - The number of command-line arguments that should be consumed.'  Later though: 'ArgumentParser objects <b>usually associate a single command-line argument with a single action to be taken</b>. The nargs keyword argument associates a different number of command-line arguments with a single action.'</span>
