<div class="post-text" itemprop="text">
<p>I want to close an excel file after opening it. I searched this site but I cannot get a solution. Can anyone help?</p>
<pre><code>import os

#TODO: close the file 'myexcel.xlsx' before writing

#writing data to 'myexcel.xlsx' here

a = os.startfile('myexcel.xlsx')#open the file for reading
</code></pre>
<p>Thank you very much.</p>
</div>
<div class="post-text" itemprop="text">
<p>This isn't possible using <code>startfile()</code>. According to the <a href="https://docs.python.org/3/library/os.html#os.startfile" rel="nofollow noreferrer">os.startfile</a> documentation:</p>
<blockquote>
<p>startfile() returns as soon as the associated application is launched. There is no option to wait for the application to close, and no way to retrieve the application’s exit status.</p>
</blockquote>
<p>You might consider using the <a href="https://docs.python.org/3/library/subprocess.html" rel="nofollow noreferrer"><code>subprocess</code></a> module. There are a load of options depending on what <em>exactly</em> you're trying to do at this question: <a href="https://stackoverflow.com/questions/4789837/how-to-terminate-a-python-subprocess-launched-with-shell-true">How to terminate a python subprocess launched with shell=True</a></p>
</div>
<span class="comment-copy">What are you trying to do Depending on what you want to do, launching it as a subprocess and tracking it's process ID might be more interesting for you.</span>
<span class="comment-copy">Can we kill the process in Windows if 'myexcel.xlsx' is opened?</span>
<span class="comment-copy">Using <code>startfile()</code>? I don't believe so -- not without using <code>taskkill</code>. Maybe this would be of help there? <a href="https://stackoverflow.com/questions/6278847/is-it-possible-to-kill-a-process-on-windows-from-within-python" title="is it possible to kill a process on windows from within python">stackoverflow.com/questions/6278847/…</a></span>
<span class="comment-copy">Thank you, sam.</span>
