<div class="post-text" itemprop="text">
<p>I am trying to read a streamed xlsx file. The user inputs the data via user interface and then the data is passed to me via streaming in xlsx. How do i read it ? I couldn't find any documentation.</p>
<p>cat text.xlsx | python myprogram.py</p>
<p>How do i read this stream ? Any help would be appreciated. I am not sure whether openpyxl allows this read. I am using python3</p>
</div>
<div class="post-text" itemprop="text">
<p><code>openpyxl.load_workbook</code>'s first argument <code>filename</code> can be not only a filename, but also a file-like object, and <a href="https://docs.python.org/3/library/sys.html#sys.stdin" rel="nofollow noreferrer"><code>sys.stdin</code></a> is the file-like object representing your program's stdin.</p>
<p>You need it in binary mode though, see the note in the docs regarding binary standard streams.</p>
<pre><code>import sys
from openpyxl import load_workbook

wb = load_workbook(sys.stdin.buffer)
print(wb.sheetnames)
</code></pre>
<p>Run:</p>
<pre><code>$ cat test.xlsx | python test.py
['Sheet1', 'Sheet2']
</code></pre>
</div>
<span class="comment-copy">I am getting the following error:      raise BadZipFile("File is not a zip file") zipfile.BadZipFile: File is not a zip file</span>
<span class="comment-copy">@KumarGovind Are you sure that's XLSX and not XLS? Can you maybe upload a sample file somewhere. You can also try <code>file test.xlsx</code> in console: it should recognise the type as "Microsoft OOXML" or something along these lines.</span>
<span class="comment-copy">it is certainly a xlsx file.</span>
<span class="comment-copy">@KumarGovind I cannot reproduce the error. XLSX is a zip file, so it is rather odd that openpyxl is telling you it isn't.</span>
<span class="comment-copy">@KumarGovind Literally all of it is in the answer.</span>
