<div class="post-text" itemprop="text">
<p>I have a Python Dataframe (named dfFull) that outputs the following:</p>
<pre><code>Email         System 6 System 7 System 1 System 4 Count System 5 System 3 System 2
test1@test.com  1         0         0        0       2     1         0       0
test2@test.com  0         1         0        1       3     0         1       0
test3@test.com  0         0         1        1       4     1         0       1
</code></pre>
<p>The amount of systems vary (the amount of systems is calculated earlier in the code and is equal to the variable SystemCount). I would like to restructure the Dataframe to have the email and count column first, than all the systems in order afterwards. </p>
<p>I thought using a for loop would be best for this and have the loop set up below, but I'm not sure what to put inside the loop since I want the email and count column first (Python newbie). I also know that sort_values() would probably work, but even with the python documentation I couldn't get the arguments to work properly</p>
<pre><code>for count in range(1, int(SystemCount)+1): #counts up to the system amount
</code></pre>
<p>Expected out put would be the columns and their contents in this order:</p>
<pre><code>Email Count System 1 ..... System 8
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can create <a href="https://docs.python.org/3/howto/sorting.html#key-functions" rel="nofollow noreferrer">lambda key function</a> by all columns from <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Index.difference.html" rel="nofollow noreferrer"><code>difference</code></a> of first columns names:</p>
<pre><code>c = ['Email','Count']
c1 = df.columns.difference(c)
cols = c +  sorted(c1, key=lambda x: int(x.split()[1]))
print (cols)
['Email', 'Count', 'System 1', 'System 2', 'System 3', 
 'System 4', 'System 5', 'System 6', 'System 7']

df = df[cols]
print (df)
            Email  Count  System 1  System 2  System 3  System 4  System 5  \
0  test1@test.com      2         0         0         0         0         1   
1  test2@test.com      3         0         0         1         1         0   
2  test3@test.com      4         1         1         0         1         1   

   System 6  System 7  
0         1         0  
1         0         1  
2         0         0  
</code></pre>
</div>
<span class="comment-copy">What is expected output?</span>
<span class="comment-copy">This has been added, thank you</span>
<span class="comment-copy">This worked perfectly, can you help me understand this section of the code sorted(c1, key=lambda x: int(x.split()[1]))</span>
<span class="comment-copy">You can create <a href="https://docs.python.org/3/howto/sorting.html#key-functions" rel="nofollow noreferrer">lambda key function</a> for custom formating - here split values of columns by whitespace, seelct second value and convert to <code>int</code>, what is used for sorting.</span>
