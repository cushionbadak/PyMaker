<div class="post-text" itemprop="text">
<p>I am trying to learn the new TF 2.0 alpha release. I'm training a <code>Sequential</code> model for a binary classification purpose. My datatable is <code>df</code>, which is a numpy array. <code>classification</code> is the one-hot encoding dataframe of the classes I must predict.</p>
<p>The definition of the model is clear, as it is the definition of loss and accuracy functions and the (Adam) optimizer. 
However, I get an error at the point of training:</p>
<pre><code>loss_history = []
accuracy_history = []

for epoch in range(n_epochs):

    with tf.GradientTape() as tape:

        # compute binary crossentropy loss (bce_loss)
        current_loss = bce_loss(model(df), classification.astype(np.float64))
        loss_history.append(current_loss)

        # train the model based on the gradient of loss function
        gradients = tape.gradient(current_loss, model.trainable_variables)
        optimizer.apply_gradients([gradients, model.trainable_variables])  # optimizer = Adam


    # print the training progress
    print(str(epoch+1) + '. Train Loss: ' + str(metrics) + ', Accuracy: ' + str(current_accuracy))

print('\nTraining complete.')
</code></pre>
<p>At this point, I get error pointed at <code>optimizer.apply_gradients()</code>. The error message says:</p>
<blockquote>
<p>ValueError: too many values to unpack (expected 2)</p>
</blockquote>
<p>Where is my mistake?</p>
<p>I did some research on this type of error, but I found nothing useful related to this particular function. Any help is appreciated.</p>
</div>
<div class="post-text" itemprop="text">
<p>Try this instead:</p>
<pre><code>optimizer.apply_gradients(zip(gradients, model.trainable_variables))
</code></pre>
</div>
<span class="comment-copy">By accepting the answer the question is already marked as solved. No need to edit the question. See also <a href="https://meta.stackexchange.com/questions/116101/is-it-ok-to-add-solved-to-the-title-of-a-question" title="is it ok to add solved to the title of a question">meta.stackexchange.com/questions/116101/â€¦</a></span>
