<div class="post-text" itemprop="text">
<p>Is there a way to change the text-formatting of a .odt file using a programming software? I'm trying to make some text editions which is time consuming to be done manually in lib.office (text is big). Using R or python I can edit spaces and carriage breaks using brute force, but, to do edits like left, right-justify etc., I have to finally go back to the editor to do it. I can see there are functions in python to include tabs, change case etc., but is it possible to do right-left-centre justification in a .odt text file indirectly using a programming software?</p>
</div>
<div class="post-text" itemprop="text">
<p>This is a great job for a scripting language like Python. I think you want string methods like <a href="http://docs.python.org/3/library/stdtypes.html?highlight=ljust#str.ljust" rel="nofollow">str.ljust</a>. That method left-justifies strings.
to open the file.</p>
<p>Alternately, you might try defining a macro in OpenOffice (if they exist and your task is simple) - or investing some time in learning emacs or something and using that (<a href="http://www.emacswiki.org/emacs/OpenDocumentText" rel="nofollow">this</a> link shows at least some degree of emacs support for .odt files). Or learn vim, that is the one true way!</p>
<p>Edit: after some research I found <a href="http://www.linuxjournal.com/article/9347?page=0,0" rel="nofollow">this</a>. It seems you could unzip the .odt file, read files within it, and manually edit the text nodes of the XML there. However, it seems like it might be easier to use a library - here are two:</p>
<p><a href="https://pypi.python.org/pypi/odfpy" rel="nofollow">https://pypi.python.org/pypi/odfpy</a></p>
<p><a href="http://ooopy.sourceforge.net/" rel="nofollow">http://ooopy.sourceforge.net/</a></p>
<p>Edit 2: in terms of actually justifying the text, presuming you have extracted it, this:</p>
<pre><code>def justify(string, left=True):
if left:
    return "\n".join(line.lstrip() for line in string.splitlines())
else:
    lines = string.splitlines()
    longest_line = len(max(lines, key=len))
    return "\n".join(line.rjust(longest_line) for line in lines)
</code></pre>
<p>should work.</p>
</div>
<span class="comment-copy">aren't str.ljust, rjust etc. about padding a selected text with a specific width of characters? or, can we use the command in ways to do the intended 'left or right-justify' task?</span>
