<div class="post-text" itemprop="text">
<p>So I'm trying to change the ntp server settings in Windows (XP and 7) using the following:</p>
<pre><code>import subprocess
subprocess.call(['net', 'stop', 'w32time'])
subprocess.call(['reg', 'add','HKLM\Software\Microsoft\Windows\CurrentVersion\DateTime\Servers', '/f /v \"0\" /t REG_SZ /d \"ntp.craven.k12.nc.us\"'])
subprocess.call(['reg', 'add', 'HKLM\Software\Microsoft\Windows\CurrentVersion\DateTime\Servers', '/f /v \"(Default)\" /t REG_SZ /d \"0\"'])
subprocess.call(['net', 'start', 'w32time'])
subprocess.call(['w32tm', '/resync'])
</code></pre>
<p>But this fails miserably. I'm sure the problem lies in how I'm formatting the parameters, but I have yet to come upon how to do it properly.</p>
</div>
<div class="post-text" itemprop="text">
<p>Your last arguments are not splitted. You probably need to replace <code>'/f /v \"0\" /t REG_SZ ...'</code> with <code>] + ['/f', '/v', '0', '/t', 'REG_SZ'] + [...]</code>.</p>
<p>As an alternative, pass the whole command as a string (as you would on the command line).</p>
</div>
<span class="comment-copy">Yes, the first and last two commands run as I would expect them too, it's the ones that edit the registry that have proved tricky.</span>
<span class="comment-copy">unrelated: you don't need <code>subprocess</code> to edit the registry, see <a href="http://docs.python.org/3/library/winreg.html" rel="nofollow noreferrer">winreg</a></span>
<span class="comment-copy">You need to escape the '\' character or use raw strings, e.g., <code>'HKLM\\Software\\Microsoft\\...'</code> or <code>r'HKLM\Software\Microsoft\...'</code></span>
<span class="comment-copy">@J.F.Sebastian I'm coming to the conclusion that there's a good reason for the inclusion of winreg in version 3, but I'm limited to using 2.7. I've noticed that if I perform a subprocess.call with a reg query it will give a different response than had I run it directly. Any idea why?</span>
<span class="comment-copy">winreg is called _winreg in Python 2</span>
