<div class="post-text" itemprop="text">
<p>I'm currently getting this error and don't know what is means. Its a scrapy python project, this is the error I'm seeing:</p>
<pre><code>  File "/bp_scraper/bp_scraper/httpmiddleware.py", line 22, in from_crawler
    return cls(crawler.settings)
  File "/bp_scraper/bp_scraper/httpmiddleware.py", line 12, in __init__
    if parts[1]:
TypeError: '_sre.SRE_Match' object has no attribute '__getitem__'
</code></pre>
<p>The code:</p>
<pre><code>import re
import random
import base64
from scrapy import log
class RandomProxy(object):
    def __init__(self, settings):
        self.proxy_list = settings.get('PROXY_LIST')
        f = open(self.proxy_list)

        self.proxies = {}
        for l in f.readlines():
            parts = re.match('(\w+://)(\w+:\w+@)?(.+)', l)

            if parts[1]:
                parts[1] = parts[1][:-1]

            self.proxies[parts[0] + parts[2]] = parts[1]

        f.close()
    @classmethod
    def from_crawler(cls, crawler):
        return cls(crawler.settings)
</code></pre>
<p>Thanks in advance for your help!</p>
</div>
<div class="post-text" itemprop="text">
<p>The result of a <code>re.match</code> call is a <code>SRE_Match</code> object, which does not support the <code>[]</code> operator (a.k.a. <code>__getitem__</code>).  I think you want</p>
<pre><code>if parts is not None:
    if parts.group(1):
        &lt;blah&gt;
</code></pre>
<p>Unfortunately, <code>parts.group(1)</code> is not mutable, so you'll have to make another variable to hold the changes you want to make to it.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can not access the matched results as:</p>
<pre><code>        if parts[1]:
            parts[1] = parts[1][:-1]
</code></pre>
<p>Instead do this,</p>
<pre><code>        if parts:
            matched = parts.group(1)[:-1]
</code></pre>
<p>More on regex matched groups <a href="http://docs.python.org/2/library/re.html#re.MatchObject.groups" rel="nofollow">here</a></p>
</div>
<span class="comment-copy"><code>re.match</code> returns a <a href="http://docs.python.org/2/library/re.html#match-objects" rel="nofollow noreferrer">match object</a>, which does not overload the <code>[]</code> operator. Did you mean <code>re.findall</code> instead?</span>
<span class="comment-copy">with python 3.6 this should work (see <a href="https://docs.python.org/3/library/re.html#re.match.__getitem__" rel="nofollow noreferrer">documentation</a>)</span>
<span class="comment-copy">You can get rid of <code>is not None</code> part. <code>if parts</code> is same as <code>if parts is not None</code>.</span>
<span class="comment-copy">I choose to be as explicit as possible in my Python code.  <code>if parts</code> is not exactly the same as <code>if parts is not None</code>; the former tests whether the current boolean interpretation of <code>parts</code> is <code>True</code>, while the latter explicitly tests whether <code>parts</code> has a value of <code>None</code>.  In this example they would evaluate to the same thing, but I would rather not teach readers shortcuts that turn out not to work in some future case.</span>
<span class="comment-copy">This is no longer the case in Python 3.6, where you can use <code>[]</code>, see <a href="https://docs.python.org/3/whatsnew/3.6.html#re" rel="nofollow noreferrer">docs</a>.</span>
