<div class="post-text" itemprop="text">
<p>I want to create a function that will return output of a shell, I have something like this:</p>
<pre><code>def shell_exec(code):
    buff = StringIO.StringIO()
    subprocess.call(code, shell=True, stdout=buff)
    return buff.getvalue()
</code></pre>
<p>but got error:</p>
<pre><code>Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "&lt;stdin&gt;", line 3, in shell_exec
  File "/usr/lib/python2.7/subprocess.py", line 524, in call
    return Popen(*popenargs, **kwargs).wait()
  File "/usr/lib/python2.7/subprocess.py", line 703, in __init__
    errread, errwrite) = self._get_handles(stdin, stdout, stderr)
  File "/usr/lib/python2.7/subprocess.py", line 1115, in _get_handles
    c2pwrite = stdout.fileno()
AttributeError: StringIO instance has no attribute 'fileno'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="http://docs.python.org/3/library/subprocess.html#subprocess.check_output" rel="nofollow"><code>subprocess.check_output</code></a>. It returns command output.</p>
<pre><code>def shell_exec(code):
    try:
        return subprocess.check_output(code, shell=True)
    except subprocess.CalledProcessError as e:
        return e.output
</code></pre>
<p>BTW, valid values for <code>stdin</code>,<code>stdout</code>,<code>stderr</code> are <code>PIPE</code>, <code>DEVNULL</code>, an existing file descriptor (a positive integer), an existing file object, and <code>None</code>. </p>
</div>
<span class="comment-copy">Why did you remove <code>shell=True</code>? Can you write it as a function with that key as before?</span>
<span class="comment-copy">@jcubic, Sorry, it was removed by accident. I meant to remove only <code>stdout=..</code>. I updated the answer accordingly. Thank you for pointing that.</span>
