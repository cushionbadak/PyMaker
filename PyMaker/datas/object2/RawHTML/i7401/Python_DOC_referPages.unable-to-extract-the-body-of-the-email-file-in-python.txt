<div class="post-text" itemprop="text">
<p>I am reading an email file stored in my machine,able to extract the headers of the email, but unable to extract the body. </p>
<pre><code>    # The following part is working , opening a file and reading the header .

    import email
    from email.parser import HeaderParser
    with open(passedArgument1+filename,"r",encoding="ISO-8859-1") as f:
        msg=email.message_from_file(f)
        print('message',msg.as_string())
        parser = HeaderParser()
        h = parser.parsestr(msg.as_string())
        print (h.keys())  

       # The following snippet gives error
        msgBody=msg.get_body('text/plain')
</code></pre>
<p>Is there any proper way to extract only the body message.Stuck at this point.</p>
<p>For reference the email file can be downloaded from </p>
<p><a href="https://drive.google.com/file/d/0B3XlF206d5UrOW5xZ3FmV3M3Rzg/view" rel="nofollow noreferrer">https://drive.google.com/file/d/0B3XlF206d5UrOW5xZ3FmV3M3Rzg/view</a> </p>
</div>
<div class="post-text" itemprop="text">
<p><strong>Update</strong></p>
<p>If you are having the <code>AttributeError: 'Message' object has no attribute 'get_body'</code> error, you might want to read what follows.</p>
<p>I did some tests, and it seems the doc is indeed erroneous compared to the current library implementation (July 2017).</p>
<p>What you might be looking for is actually the function <code>get_payload()</code> it seems to do what you want to achieve:</p>
<blockquote>
<p>The conceptual model provided by an EmailMessage object is that of an
  ordered dictionary of headers coupled with a payload that represents
  the RFC 5322 body of the message, which might be a list of
  sub-EmailMessage objects</p>
</blockquote>
<p><code>get_payload()</code> is not in current July 2017 <a href="https://docs.python.org/3/library/email.message.html#email.message.EmailMessage.get_body" rel="noreferrer">Documentation</a>, but the <code>help()</code> says the following:</p>
<blockquote>
<pre><code>get_payload(i=None, decode=False) method of email.message.Message instance
  Return a reference to the payload.
</code></pre>
<p>The payload will either be a list object or a string.  If you mutate
  the list object, you modify the message's payload in place.  Optional
  <code>i</code> returns that index into the payload.</p>
<p>Optional <code>decode</code> is a flag indicating whether the payload should be decoded or not, according to the Content-Transfer-Encoding
  header (default is <code>False</code>).</p>
<p>When <code>True</code> and the message is not a multipart, the payload will be decoded if this header's value is 'quoted-printable' or 'base64'.  If some other encoding is used, or the header is missing, or if the payload has bogus data (i.e. bogus base64 or uuencoded data), the payload is returned as-is.</p>
<p>If the message is a multipart and the decode flag is <code>True</code>, then <code>None</code> is returned.</p>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>The 3.6 email lib uses an API that is compatible with Python 3.2 by default and that is what is causing you this problem.</p>
<p>Note the default policy in the declaration below from the docs:</p>
<p><code>email.message_from_file(fp, _class=None, *, policy=policy.compat32)</code></p>
<p>If you want to use the "new" API that you see in the 3.6 docs, you have to create the message with a different policy.</p>
<pre><code>import email
from email import policy
...
msg=email.message_from_file(f, policy=policy.default)
</code></pre>
<p>will give you the new API that you see in the docs which will include the very useful: <code>get_body()</code></p>
</div>
<span class="comment-copy">What is the error message?</span>
<span class="comment-copy">AttributeError: 'Message' object has no attribute 'get_body'</span>
<span class="comment-copy">it seems like the method does not exist. Did you check the doc?</span>
<span class="comment-copy">Was referring this document link  <a href="https://docs.python.org/3/library/email.message.html#email.message.EmailMessage.get_body" rel="nofollow noreferrer">docs.python.org/3/library/â€¦</a></span>
<span class="comment-copy">This refers to <code>EmailMessage</code> not <code>Message</code>, you need do go one level down within the object. You are looking for <code>class email.message.EmailMessage</code></span>
<span class="comment-copy">Let me quickly try and update you</span>
<span class="comment-copy">Gives me the following message msgBody=msg.EmailMessage.get_body('text/plain') AttributeError: 'Message' object has no attribute 'EmailMessage'</span>
<span class="comment-copy">Yes get_payload() , works thanks for the answer</span>
<span class="comment-copy">Thanks for  a detailed answer Fabien, sure most people will be benefitted by the answer.</span>
<span class="comment-copy">Ah, thanks!  I just spent a good while wondering why the library and documentation don't match.</span>
