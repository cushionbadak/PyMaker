<div class="post-text" itemprop="text">
<p>I want to launch Python HTTPServer on heroku. Note that this is no Python framework. The code snippet is attached below. How will I be able to launch this server on Heroku? I am able to run this server on my local machine. But I want it deployed on Heroku. Please provide insights.</p>
<p>Server Code:</p>
<pre><code>import http.server
from http.server import HTTPServer, BaseHTTPRequestHandler
import socketserver
import threading

PORT = 5001

class myHandler(BaseHTTPRequestHandler):
    def do_GET(self):
        self.write("Heroku is awesome")

class ThreadedTCPServer(socketserver.ThreadingMixIn, socketserver.TCPServer):
    pass

try:
    server = ThreadedTCPServer(('', PORT), myHandler)
    print ('Started httpserver on port ' , PORT)
    ip,port = server.server_address
    server_thread = threading.Thread(target=server.serve_forever)
    server_thread.daemon = True
    server_thread.start()
    allow_reuse_address = True
    server.serve_forever()

except KeyboardInterrupt:
    print ('CTRL + C RECEIVED - Shutting down the REST server')
    server.socket.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>When heroku runs your process, it defines the environment variable <code>PORT</code> to the internal port you should expose your server on. Your server will then be accessible from the internet on port 80, the default HTTP port.</p>
<p>Python can access environment variables with <code>os.environ</code>. </p>
<p>So you can use:<br/>
<code>PORT = environ['PORT']</code></p>
<p><code>os.envron</code> docs <a href="https://docs.python.org/3/library/os.html#os.environ" rel="nofollow noreferrer">here</a></p>
<p>You can read more about how Heroku handles ports <a href="https://devcenter.heroku.com/articles/runtime-principles#web-servers" rel="nofollow noreferrer">here</a>.</p>
</div>
<div class="post-text" itemprop="text">
<p>Create a <code>Procfile</code> with a single line:</p>
<pre><code>web: python yourscript.py
</code></pre>
</div>
<span class="comment-copy">This doesn't help. used PORT = environ['PORT'] rather than using PORT = 8081. It shows key error at environ['PORT'].</span>
<span class="comment-copy">What is it exactly that I need to do so this works?</span>
<span class="comment-copy">Are you receiving the error when running on heroku, or when you run it on your local machine?</span>
<span class="comment-copy">I am receiving error when I am running on both heroku and local machine. When I give PORT = 8081 it is at least running on localhost:8081 but when I give PORT = environ['PORT'], it is not working at all.</span>
<span class="comment-copy">On your local machine, the <code>PORT</code> environment variable is likely not set, which is likely causing the issues, whereas it is set automatically on the Heroku instance.  You can either test locally using <code>heroku local</code> in your shell, or you could use something like <code>PORT = environ.get('PORT', "8080")</code> which will return a default when the env var is not found</span>
<span class="comment-copy">The above comment is not working. Because I am defining a port you see. I am opening <a href="https://myprojectname.heroku.com" rel="nofollow noreferrer">myprojectname.heroku.com</a> but the web page is not loading or it is not printing the output. What's the proper way to make this work?</span>
