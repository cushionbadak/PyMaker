<div class="post-text" itemprop="text">
<p>I am trying to replace nonunicode characters with an _ but this program despite compiling with no errors, does not solve the issue and I cannot determine why.</p>
<pre><code>import csv
import unicodedata
import pandas as pd

df = pd.read_csv('/Users/pabbott/Desktop/Unicode.csv', sep = ',', 
index_col=False, converters={'ClinetEMail':str, 'ClientZip':str, 
'LocationZip':str, 'LicenseeName': str, 'LocationState':str, 
'AppointmentType':str, 'ClientCity':str, 'ClientState':str})

data = df
for row in data:
    for val in row:
        try:
            val.encode("utf-8")
        except UnicodeDecodeError:
            replace(val,"_")

data.to_csv('UnicodeExport.csv', sep=',', index=False, 
quoting=csv.QUOTE_NONNUMERIC)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>UnicodeDecodeError: 'utf-8' codec can't decode byte 0xa4 in position 4: invalid start byte
</code></pre>
<p>The above message (thrown from <code>pd.read_csv</code>) shows that the file is not saved in <code>utf-8</code>. You need to </p>
<ul>
<li><strong><em>either</em></strong> save the file as <code>utf-8</code>, </li>
<li><strong><em>or</em></strong> read a file using proper encoding. </li>
</ul>
<p>For instance (the latter variant), add <code>encoding='windows-1252'</code> to <code>df = pd.read_csv(…</code> as follows:</p>
<pre><code>df = pd.read_csv('/Users/pabbott/Desktop/Unicode.csv', sep = ',', encoding='windows-1252',
 index_col=False, converters={'ClinetEMail':str, 'ClientZip':str, 
 'LocationZip':str, 'LicenseeName': str, 'LocationState':str, 
 'AppointmentType':str, 'ClientCity':str, 'ClientState':str})
</code></pre>
<p>Then, you can omit all the stuff <strike><code>try: val.encode("utf-8")</code></strike> in <code>for row in data: for val in row:</code> loops.</p>
<p>Read <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html" rel="nofollow noreferrer">pandas.read_csv</a>:</p>
<blockquote>
<p><code>encoding</code> : <code>str</code>, default <code>None</code></p>
<p>Encoding to use for UTF when reading/writing (ex. <code>'utf-8'</code>). <a href="https://docs.python.org/3/library/codecs.html#standard-encodings" rel="nofollow noreferrer">List of
  Python standard encodings</a>.</p>
</blockquote>
</div>
<span class="comment-copy">what is the error you receive?</span>
<span class="comment-copy">Posting a dump of code is not a question.</span>
<span class="comment-copy">I do not receive any error as the code compiles correctly though in the new file those nonunicode characters are not properly replaced by an _. I am wondering if it is a problem with the data.apply function?</span>
<span class="comment-copy">This is the error I got before with the UnicodeCharacter - UnicodeDecodeError: 'utf8' codec can't decode byte 0xa4 in position 4: invalid start byte. This is the exact character -¤ and there are some more other than that.</span>
<span class="comment-copy">I want this to be able to detect any nonunicode characters in a csv file and replace them with an underscore. Can somebody please help!</span>
