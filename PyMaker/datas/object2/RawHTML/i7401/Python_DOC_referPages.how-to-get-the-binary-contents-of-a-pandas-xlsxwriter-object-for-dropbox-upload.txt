<div class="post-text" itemprop="text">
<p>I am trying to upload to dropbox an Excel sheet with multiple tabs made with <code>pandas</code> and <code>xlsxwriter</code>. Not very big files, just around 5MB. I am using the <code>dropbox</code> module for Python 3</p>
<p>I am doing:</p>
<pre><code>filename = pd.ExcelWriter('myfile.xlsx' ,engine='xlsxwriter')
actions.to_excel(filename, sheet_name="Combined Actions")
filename.save()

with open(filename, "rb") as f:
    dbx.files_upload(f.read(), "/MyAPP/"+filename)
</code></pre>
<p>I read in the docs that <code>files_upload</code> expects a bytes object. I am getting the error: <code>Type Error: Invalid file: &lt;pandas.io.excel__XlsxWriter object at 0x000000000071C48&gt;</code></p>
<p>Is this error because I am not supplying the file in the needed format? How can I do this upload so I don't get a type error?</p>
</div>
<div class="post-text" itemprop="text">
<p>You are trying to use the built in function <code>open</code> to open an object. It requires a string as its first argument (which represents a file path). More information on the <code>open</code> function can be found in the <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer">docs</a>. </p>
<p>The <a href="https://github.com/pandas-dev/pandas/blob/2e24a8f8886a1481af8324d44224cddb2ee1b53c/pandas/io/excel.py#L754" rel="nofollow noreferrer">source</a> for pandas ExcelWriter shows it stores the filename you pass to it in <code>.path</code>. So renaming your variables to better represent what they are and using the <code>.path</code> attribute of the ExcelWriter instance:</p>
<pre><code>excel_file = pd.ExcelWriter('myfile.xlsx', engine='xlsxwriter')
actions.to_excel(excel_file, sheet_name="Combined Actions")
excel_file.save()

with open(excel_file.path, 'rb') as f:
    dbx.files_upload(f.read(), '/MyAPP/'+excel_file.path)
</code></pre>
</div>
<span class="comment-copy">Thanks, it was definitely a simple mistake. Your solution is correct, also another correct solution would be to just use <code>myfile.xlsx</code> instead of <code>filename</code> in the <code>with open...</code> and in <code>dbx.files_upload</code>.</span>
