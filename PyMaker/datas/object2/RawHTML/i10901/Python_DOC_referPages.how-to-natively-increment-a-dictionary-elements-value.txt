<div class="post-text" itemprop="text">
<p>When working with Python 3 dictionaries, I keep having to do something like this:</p>
<pre><code>d=dict()
if 'k' in d:
    d['k']+=1
else:
    d['k']=0
</code></pre>
<p>I seem to remember there being a native way to do this, but was looking through the documentation and couldn't find it. Do you know what this is?</p>
</div>
<div class="post-text" itemprop="text">
<p>This is the use case for <a href="https://docs.python.org/3/library/collections.html#collections.defaultdict" rel="noreferrer"><code>collections.defaultdict</code></a>, here simply using the <code>int</code> callable for the default factory. </p>
<pre><code>&gt;&gt;&gt; from collections import defaultdict
&gt;&gt;&gt; d = defaultdict(int)
&gt;&gt;&gt; d
defaultdict(&lt;class 'int'&gt;, {})
&gt;&gt;&gt; d['k'] +=1
&gt;&gt;&gt; d
defaultdict(&lt;class 'int'&gt;, {'k': 1})
</code></pre>
<p>A <code>defaultdict</code> is configured to create items whenever a missing key is searched. You provide it with a callable (here <code>int()</code>) which it uses to produce a default value whenever the lookup with <code>__getitem__</code> is passed a key that does not exist. This callable is stored in an instance attribute called <code>default_factory</code>.  </p>
<p>If you don't provide a <code>default_factory</code>, you'll get a <code>KeyError</code> as per usual for missing keys. </p>
<p>Then suppose you wanted a different default value, perhaps 1 instead of 0. You would simply have to pass a callable that provides your desired starting value, in this case very trivially </p>
<pre><code>&gt;&gt;&gt; d = defaultdict(lambda: 1)
</code></pre>
<p>This could obviously also be any regular named function. </p>
<hr/>
<p>It's worth noting however that if in your case you are attempting to just use a dictionary to store the count of particular values, a <a href="https://docs.python.org/3/library/collections.html#collections.Counter" rel="noreferrer"><code>collections.Counter</code></a> is more suitable for the job. </p>
<pre><code>&gt;&gt;&gt; from collections import Counter
&gt;&gt;&gt; Counter('kangaroo')
Counter({'a': 2, 'o': 2, 'n': 1, 'r': 1, 'k': 1, 'g': 1})
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Take note that you can always remove the clutter from the <code>if</code> stamemt by using it in an expression:</p>
<pre><code>d['k'] = d['k'] + 1 if 'k' in d else 0
</code></pre>
</div>
