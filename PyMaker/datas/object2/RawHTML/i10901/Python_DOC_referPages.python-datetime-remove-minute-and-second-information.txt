<div class="post-text" itemprop="text">
<p>I have a datetime array which has hour, minute and second information. I want to remove the minute and second infromation from it and change the hour to the next hour.</p>
<p>i.e. 
peak_interval</p>
<pre><code>array([datetime.datetime(2010, 12, 13, 6, 0),
       datetime.datetime(2011, 1, 12, 7, 0),
       datetime.datetime(2011, 3, 23, 16, 45),
       datetime.datetime(2011, 4, 19, 17, 15)], dtype=object)
</code></pre>
<p>I want to obtain the following:</p>
<pre><code>peak_interval
array([datetime.datetime(2010, 12, 13, 7, 0),
       datetime.datetime(2011, 1, 12, 8, 0),
       datetime.datetime(2011, 3, 23, 17, 0),
       datetime.datetime(2011, 4, 19, 18, 0)], dtype=object)
</code></pre>
<p>I can write some kind of for loop but I am trying to use some smart method if possible.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can easily modify just a few fields using <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime.replace" rel="nofollow noreferrer"><code>datetime.datetime.replace</code></a></p>
<pre><code>old_date = datetime.datetime(2011, 3, 23, 16, 45)
new_date = old_date.replace(minute=0, second=0) + datetime.timedelta(hours=1)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>One option is to use <code>timedelta</code> from <code>datetime</code>:</p>
<pre><code>import datetime
import numpy as np
def reset(dt):
    return dt + datetime.timedelta(hours = 1, minutes = -dt.minute, seconds = -dt.second)

np.vectorize(reset)(peak_interval)

# array([datetime.datetime(2010, 12, 13, 7, 0),
#        datetime.datetime(2011, 1, 12, 8, 0),
#        datetime.datetime(2011, 3, 23, 17, 0),
#        datetime.datetime(2011, 4, 19, 18, 0)], dtype=object)
</code></pre>
</div>
<span class="comment-copy">This may help you: <a href="http://stackoverflow.com/questions/3743222/how-do-i-convert-datetime-to-date-in-python" title="how do i convert datetime to date in python">stackoverflow.com/questions/3743222/â€¦</a> Keep in mind, though, that the result in that case would be a date object.</span>
