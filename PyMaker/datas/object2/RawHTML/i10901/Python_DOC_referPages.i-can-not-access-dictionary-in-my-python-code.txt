<div class="post-text" itemprop="text">
<p>I have written a function that takes code from a sites script element, strips characters, adds double quotes to keys using string replace, and whats returned was what I thought was a dictionary. yet I can't pull values from it. I tried to access values by doing </p>
<pre><code>results['file']
</code></pre>
<p>and that didn't work. I was given an error message saying something like </p>
<pre><code>it expected a number and instead got a string.
</code></pre>
<p>I then tried </p>
<pre><code>results[0]
</code></pre>
<p>and all that was returned was </p>
<pre><code>{
</code></pre>
<p>I also tried </p>
<pre><code>results.file
</code></pre>
<p>and that didn't work. So while googling and researching python books I saw a values function being used on a dictionary like this</p>
<pre><code>dict.values()
</code></pre>
<p>but when I tried it I got </p>
<pre><code>'str' object has no attribute 'values'
</code></pre>
<p>Heres my code for my function</p>
<pre><code>def panties():
        pan_url = 'http://www.panvideos.com'
        html = requests.get(pan_url, headers=headers)
        soup = BeautifulSoup(html.text, 'html5lib')
        video_row = soup.find_all('div', {'class': 'video'})

        def youtube_link(url):
            youtube_page = requests.get(url, headers=headers)
            soupdata = BeautifulSoup(youtube_page.text, 'html5lib')
            video_row = soupdata.find('div', {'class': 'video-player'})
            entries = [{'text': str(div),
                        } for div in video_row][3]['text']

            oldstring = str(entries)
            removed = '&lt;script type="text/javascript"&gt;jwplayer("video-setup").setup('
            newstring = oldstring.replace(removed, "")
            removed_two = ');&lt;/script&gt;'
            newstring_two = newstring.replace(removed_two, "")


            #Allows for multiple string replacement
            rdict = {
                'file': '"file"',
                'image': '"image"',
                'primary': '"primary"',
                'stretching': '"stretching"',
                'width': '"width"',
                'aspectratio': '"aspectratio"',
                'autostart': '"autostart"',
                'logo': '"logo"',
                'position': '"position"',
                # 'link': '"link"',
                'sharing': '"sharing"',
            }

            robj = re.compile('|'.join(rdict.keys()))
            result = robj.sub(lambda m: rdict[m.group(0)], newstring_two)
            parsed_json = json.loads(json.dumps(result))

            soc = parsed_json.replace('link', ' "link" ', 2)

            return soc
</code></pre>
<p>and here is what it returns</p>
<pre><code>{"file":"http://www.youtube.com/watch?v=slCSLeZueI4",
  "image":"http://i1.ytimg.com/vi/slCSLeZueI4/maxresdefault.jpg",
  "primary":"html5",
  "stretching":"fill",
  "controlbar":"bottom",
  "width":"100%",
  "aspectratio":"16:9",
  "autostart":"true",
  "logo":{
      "file":"http://www.panvideos.com/uploads/bien-png578aab16676e1.png",
      "position":"bottom-right", 
      "link" :"http://www.panvideos.com/"},
      "sharing":{ 
          "link" :"http://www.panvideos.com/video/3178/la-nina-y-el-lobo-video-oficial/","sites":
       ["facebook","twitter","linkedin","pinterest","tumblr","googleplus","reddit"]}}
</code></pre>
<p>I tested it in a json validator, it has double quotes like json is supposed to, it's enclosed in curly brackets. What's the correct syntax to make this work. also this is in a django app. I put that just to be complete and just in case this makes a difference</p>
<p>EDIT:
my views.py</p>
<pre><code>        pan = panties()
        context = {
            'pan': pan,
        }
</code></pre>
<p>and in my template</p>
<pre><code>    {% for p in pan %}
        Title: {{p.text}}&lt;br&gt;
        Href: {{p.href}}&lt;br&gt;
        Tube: {{p.tube}}&lt;hr&gt;
    {% endfor %}
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The message</p>
<pre><code>'str' object has no attribute 'values'
</code></pre>
<p>tells you that "results" is a string. You can use <a href="https://docs.python.org/3/library/json.html" rel="nofollow">python-json</a> to decode the string to a python object:</p>
<pre><code>somevariable = json.loads(results)
</code></pre>
</div>
<span class="comment-copy">show the code that calls this function? Are you sure you put return value in results?</span>
<span class="comment-copy">There are some things you can do to narrow this down - your `&lt;dictionary&gt;[&lt;key&gt;]' is right - and your error message suggests that what you think is a dictionary is actually a string ,...</span>
<span class="comment-copy">@TonySuffolk66 thanks for the response. If I try to use json.loads I get this error message "Expecting ',' delimiter: line 1 column 436 (char 435)"</span>
<span class="comment-copy">that messages says to me that your json is broken in some way. Certainly whatever <code>results</code> is - it isn't a dictionary - and the error message tells you it is a string.</span>
<span class="comment-copy">@TonySuffolk66 but when I put it in the json validator it's fine</span>
<span class="comment-copy">thanks for the response. I just tried it and got the following error message "Expecting ',' delimiter: line 1 column 436 (char 435)"</span>
<span class="comment-copy">So on line 1 of your json string - at column 436 (or close to there), you are missing a ',' - the message is very clear.</span>
<span class="comment-copy">Where line 436 and 435 is doesnt make sense.</span>
