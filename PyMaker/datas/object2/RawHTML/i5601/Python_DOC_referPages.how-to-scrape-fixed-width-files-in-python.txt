<div class="post-text" itemprop="text">
<p>In Python 3 I have a series of links with "fixed-width files". They are websites with public information about companies. Each line has information about companies</p>
<p>Example links:</p>
<p><a href="http://idg.receita.fazenda.gov.br/orientacao/tributaria/cadastros/cadastro-nacional-de-pessoas-juridicas-cnpj/consultas/download/F.K03200UF.D71214AC" rel="nofollow noreferrer">http://idg.receita.fazenda.gov.br/orientacao/tributaria/cadastros/cadastro-nacional-de-pessoas-juridicas-cnpj/consultas/download/F.K03200UF.D71214AC</a></p>
<p>and</p>
<p><a href="http://idg.receita.fazenda.gov.br/orientacao/tributaria/cadastros/cadastro-nacional-de-pessoas-juridicas-cnpj/consultas/download/F.K03200UF.D71214RO" rel="nofollow noreferrer">http://idg.receita.fazenda.gov.br/orientacao/tributaria/cadastros/cadastro-nacional-de-pessoas-juridicas-cnpj/consultas/download/F.K03200UF.D71214RO</a></p>
<p>I have these links in a dictionary. The key is the name of the region of the country in which the companies are and the value is the link</p>
<pre><code>for chave, valor in dict_val.items():
    print (f'Region of country: {chave} - and link with information: {valor}')

Region of country: Acre - and link with information: http://idg.receita.fazenda.gov.br/orientacao/tributaria/cadastros/cadastro-nacional-de-pessoas-juridicas-cnpj/consultas/download/F.K03200UF.D71214AC
Region of country: Esp√≠rito Santo - and link with information: http://idg.receita.fazenda.gov.br/orientacao/tributaria/cadastros/cadastro-nacional-de-pessoas-juridicas-cnpj/consultas/download/F.K03200UF.D71214ES
...
</code></pre>
<p>I want to read these links (fixed-width files) and save the content to a CSV file. Example content:</p>
<pre><code>0107397388000155ASSOCIACAO CULTURAL                                                                                                                                                          
02073973880001552              16MARIA DO SOCORRO RODRIGUES ALVES BRAGA                                                                                                                      
0101904573000102ABREU E SILVA COMERCIO DE MEDICAMENTOS LTDA-ME  - ME                                                                                                                         
02019045730001022              49JETEBERSON OLIVEIRA DE ABREU                                                                                                                                
02019045730001022              49LUZINETE SANTOS DA SILVA ABREU                                                                                                                              
0101668652000161CONSELHO ESCOLAR DA ESCOLA ULISSES GUIMARAES                                                                                                                                 
02016686520001612              10REGINA CLAUDIA RAMOS DA SILVA PESSOA                                                                                                                        
0101631137000107FORTERM * REPRESENTACOES E COMERCIO LTDA                                                                                                                                     
02016311370001072              49ANTONIO MARCOS GONCALVES                                                                                                                                    
02016311370001072              22IVANEIDE BERNARDO DE MENEZES 
</code></pre>
<p>But to fill the rows of the CSV columns I need to separate and test on each line of the links with "fixed-width files"</p>
<p>I must follow rules like these:</p>
<p><strong>1.</strong> If the line begins with "01" is a line with the company's registration number and its name. Example: <code>"0107397388000155ASSOCIACAO CULTURAL"</code></p>
<p><strong>1.1</strong> - The "01" indicates this /</p>
<p><strong>1.2</strong> - The next 14 positions on the line are the company code - starts at position 3 and ends at 16 - (07397388000155) /</p>
<p><strong>1.3</strong> - The following 150 positions are the company name - starts at position 17 and ends at 166 - (ASSOCIACAO CULTURAL)</p>
<p>and</p>
<p><strong>2.</strong> If the line starts with "02" it will have information about the partners of the company. Example: <code>"02073973880001552              16MARIA DO SOCORRO RODRIGUES ALVES BRAGA"</code> /</p>
<p><strong>2.1</strong> - The "02" indicates this /</p>
<p><strong>2.2</strong> - The next fourteen positions are the company registration code - starts at position 3 and ends at 16 (07397388000155) /</p>
<p><strong>2.3</strong> - The next number is a member identifier code, which can be 1, 2 or 3  - starts and ends at position 17 - (2) /</p>
<p><strong>2.4</strong> - The next fourteen positions are another code identifying the member - starts at position 18 and ends at 31 -("" - in this case is empty) /</p>
<p><strong>2.5</strong> - The next two positions are another code identifying the member - starts at position 32 and ends at 33 (16) /</p>
<p><strong>2.6</strong> - And the 150 final positions are the name of the partner - starts at position 34 and ends at 183 (MARIA DO SOCORRO RODRIGUES ALVES BRAGA)</p>
<p>Please in this case one possible strategy would be to save each link as TXT? And then try to separate the positions?
Or is there a better way to wipe a fixed-width files?</p>
</div>
<div class="post-text" itemprop="text">
<p>You can take a look at any URL parsing modules. I recommend <a href="http://docs.python-requests.org/en/master/" rel="nofollow noreferrer">Requests</a>, although you can use <a href="https://docs.python.org/3/library/urllib.request.html#module-urllib.request" rel="nofollow noreferrer">urllib</a> which comes bundled with python.</p>
<p>With that in mind, you can the text from the page, and seeing as it doesn't require a login of any from, with requests it would simply be a matter of:</p>
<pre><code>import requests
r = requests.get('Your link from receita.fazenda.gov.br')
page_text = r.text
</code></pre>
<p>Read more in the <a href="http://docs.python-requests.org/en/master/user/quickstart/#make-a-request" rel="nofollow noreferrer">Quickstart</a> section of requests. I'll leave the 'position-separating' to you. </p>
<p>Hint: Use regex.</p>
</div>
<div class="post-text" itemprop="text">
<p>Using <code>scrapy</code> it's possible to read the content from the link as a stream and process it without saving to file. Documentation for <code>scrapy</code> is <a href="https://scrapy.readthedocs.io/en/latest/index.html#" rel="nofollow noreferrer">here</a></p>
<p>There's also a related question here: <a href="https://stackoverflow.com/questions/36226727/how-do-you-open-a-file-stream-for-reading-using-scrapy">How do you open a file stream for reading using Scrapy?</a></p>
</div>
