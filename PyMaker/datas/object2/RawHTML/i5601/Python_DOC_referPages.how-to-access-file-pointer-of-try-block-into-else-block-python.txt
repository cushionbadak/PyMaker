<div class="post-text" itemprop="text">
<p>In following program, I have declared fptr outside the try block because I want to close the file into else block. But getting  "AttributeError: 'NoneType' object has no attribute 'close' ". How to close file which was open in try block in this case</p>
<pre><code>def openFile(fileName):
    fptr = open(fileName,"r")
    fptr.close()

def creatNewFile():
    fileName = input("Enter file name : ")
    fptr = open(fileName,"w")
    fptr.close()

def main():
    fileName = input("Enter file name with extension: ")
    fptr = 0
    try:
        fptr = openFile(fileName)
    except Exception as ex:
        print("File is not exist")
        choice  = input("Do you want to create new file(Y/N)")
        if((choice == 'N') or (choice == 'n')):
            print("Exiting program");
            exit(0)
        elif((choice == 'Y' or choice == 'y')):
            creatNewFile()

        else :
            print("Invalid choice, exiting program ")
    else:               
        fptr.close();

main()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You are not returning the file object in <strong>openFile()</strong> and <strong>createNewFile()</strong>.</p>
<p>Try this:</p>
<pre><code>def openFile(fileName):
    fptr = open(fileName, "r")
    return fptr


def creatNewFile():
    fileName = input("Enter file name : ")
    fptr = open(fileName, "w")
    return fptr


def main():
    fileName = input("Enter file name with extension: ")
    fptr = 0
    try:
        fptr = openFile(fileName)
        fptr.close()
    except Exception as ex:
        print("File is not exist")
        choice = input("Do you want to create new file(Y/N)")
        if ((choice == 'N') or (choice == 'n')):
            print("Exiting program")
            exit(0)
        elif ((choice == 'Y' or choice == 'y')):
            newfptr = creatNewFile()
            newfptr.close()
        else:
            print("Invalid choice, exiting program ")


main()
</code></pre>
</div>
<span class="comment-copy">Consider using <a href="https://docs.python.org/3/library/os.path.html#os.path.exists" rel="nofollow noreferrer">os.path.exists</a> for checking if file/directory exists and <a href="https://docs.python.org/3.6/tutorial/inputoutput.html#reading-and-writing-files" rel="nofollow noreferrer">with statement</a></span>
