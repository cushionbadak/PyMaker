<div class="post-text" itemprop="text">
<p>I know python does a lot of stuff automatically. 
So if we don't close the file manually then it can automatically close the file. 
But I have observed that just closing the file (close()) does not flush the buffer (flush()).
So is this the particular case where python does not do automatically?</p>
</div>
<div class="post-text" itemprop="text">
<p>Here, I have an example:</p>
<pre><code># no_flush_on_close.py
def write_file(filename):
    f = open(filename, 'w')
    f.write('Hello, world\n')
    f.close()

write_file('no_flush_on_close.txt')
</code></pre>
<p>Running this script will create the text file with the line "Hello, world" in it. It tells me that flush() was called on <code>close()</code>. Now, comment out the <code>f.close()</code> line, delete the text file and try again--same result.</p>
<p>The only case where this does not work is when you have an exeption (error) raised, then the file will not be flushed. To deal with that situation, use the context manager form of <code>open()</code> (AKA the <code>with</code> statement):</p>
<pre><code>def write_file(filename):
    with open(filename, 'w') as f:
        f.write('Hello, world\n')
        raise RuntimeError('Will it flush?')  # Yes, it will flush and close
</code></pre>
<p>The context manager ensures that the file is properly flushed and closed, so it is a good practice to use it.</p>
</div>
<span class="comment-copy">Usually if you close a handle, it will first flush it automatically. Can you provide an example where it does not flush first?</span>
<span class="comment-copy">Do you have code to prove that there is no flushing on close?</span>
<span class="comment-copy">@HaiVu,  Here is the code without using flush: f = open("file_text.txt","w") f.write("this is first line\n") f.write("this is 2nd line") f.close</span>
<span class="comment-copy">The C standard library, which Python backends into, guarantees that unwritten file contents will be flushed on close. The claim that this doesn't happen automatically demands proof.</span>
<span class="comment-copy">From the documentation of <a href="https://docs.python.org/3/library/io.html?highlight=file%20close#io.IOBase.close" rel="nofollow noreferrer"><code>close()</code></a>: <b>Flush and close this stream.</b></span>
<span class="comment-copy">Nope, without flush, it does not write to the file. The text file is empty.  I am using this code in jupyter notebook on Mac OSX. Is that something related to that?</span>
<span class="comment-copy">I cannot reproduce what you saw. Here is my Jupyter notebook: <a href="https://anaconda.org/haivu/will_it_flush/notebook" rel="nofollow noreferrer">anaconda.org/haivu/will_it_flush/notebook</a></span>
