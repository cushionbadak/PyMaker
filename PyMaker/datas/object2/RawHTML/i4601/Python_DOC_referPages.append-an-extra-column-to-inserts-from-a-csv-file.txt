<div class="post-text" itemprop="text">
<p>I need to append a column/value to the below insert. The value is the same for every row.I can append the column name to the cols tuple, but cannot seem to append the value to the data.I am reading from hundreds of text files of varying format, and the target is sql server table Any help very grateful. THANKS!!!</p>
<pre><code>    with open (full_path, 'r',encoding=my_encoding) as f:
        reader = csv.reader(f, delimiter=my_delim, quotechar=my_quote)
        cols = next(reader) 
        qry = 'insert into '+ my_table_name +'({0}) values ({1})'
        qry = qry.format(','.join(cols), ','.join('?' * len(cols)))
        cursor = cnn.cursor()
        for data in reader:
           cursor.execute(qry, data)
        cursor.commit()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Since the way you are using <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">csv</a> returns lists, you can simply append the extra column name to the <code>cols</code> list ...</p>
<pre class="lang-python prettyprint-override"><code>cols = next(reader) + ['MY_FILE_NUMBER']
</code></pre>
<p>... and append the extra value to the end of the <code>data</code> list inside the loop</p>
<pre class="lang-python prettyprint-override"><code>for data in reader:
    crsr.execute(qry, data + [100])
</code></pre>
</div>
<span class="comment-copy">You don't show appending the new column to <code>cols</code> - what does that look like? What value do you want to append to <code>data</code>?</span>
<span class="comment-copy">This is the untouched code. I want to add a column and value. Column name is MY_FILE_NUMBER.   value is. 100.     current attempt at APPEND IS.  Cols.append("MY_FILE_NUMBER")    That works, appending value does not.</span>
<span class="comment-copy">I think I got it I think I need to add column name and value as a pair to the COLS tuple.</span>
