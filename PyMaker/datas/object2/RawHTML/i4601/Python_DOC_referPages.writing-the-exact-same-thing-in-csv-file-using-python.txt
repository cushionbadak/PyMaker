<div class="post-text" itemprop="text">
<p>I've encountered an issue with my writing CSV program for a web-scraping project.</p>
<p>I got a data formatted like this : </p>
<pre><code>table = {
    "UR": url,
    "DC": desc,
    "PR": price,
    "PU": picture,
    "SN": seller_name,
    "SU": seller_url
}
</code></pre>
<p>Which I get from a loop that analyze a html page and return me this table.
Basically, this table is ok, it changes every time I've done a loop.</p>
<p>The thing now, is when I want to write every table I get from that loop into my  CSV file, it is just gonna write the same thing over and over again.
The only element written is the first one I get with my loop and write it about 10 millions times instead of about 45 times (articles per page)</p>
<p>I tried to do it vanilla with the library 'csv' and then with pandas.</p>
<p>So here's my loop :</p>
<pre><code>if os.path.isfile(file_path) is False:
    open(file_path, 'a').close()
file = open(file_path, "a", encoding = "utf-8")

i = 1
while True:
    final_url = website + brand_formatted + "+handbags/?p=" + str(i)
    request = requests.get(final_url)
    soup = BeautifulSoup(request.content, "html.parser")
    articles = soup.find_all("div", {"class": "dui-card searchresultitem"})
    for article in articles:
        table = scrap_it(article)
        write_to_csv(table, file)
    if i == nb_page:
        break
    i += 1
file.close()
</code></pre>
<p>and here my method to write into a csv file :</p>
<pre><code>def write_to_csv(table, file):
import csv

writer = csv.writer(file, delimiter = " ")
writer.writerow(table["UR"])
writer.writerow(table["DC"])
writer.writerow(table["PR"])
writer.writerow(table["PU"])
writer.writerow(table["SN"])
writer.writerow(table["SU"])
</code></pre>
<p>I'm pretty new on writing CSV files and Python in general but I can't find why this isn't working. I've followed many guide and got more or less the same code for writing csv file.</p>
<p>edit: Here's an output in an img of my csv file</p>
<p><a href="https://i.stack.imgur.com/qVnQV.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/qVnQV.png"/></a></p>
<p>you can see that every element is exactly the same, even if my table change</p>
<p>EDIT: I fixed my problems by making a file for each article I scrap. That's a lot of files but apparently it is fine for my project.</p>
</div>
<div class="post-text" itemprop="text">
<p>This might be solution you wanted</p>
<pre><code>import csv

fieldnames = ['UR', 'DC', 'PR', 'PU', 'SN', 'SU']    

def write_to_csv(table, file):
    writer = csv.DictWriter(file, fieldnames=fieldnames)
    writer.writerow(table)
</code></pre>
<p>Reference: <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">https://docs.python.org/3/library/csv.html</a></p>
</div>
<span class="comment-copy">share the error ?</span>
<span class="comment-copy">I edit the post</span>
<span class="comment-copy">I would think that the function <code>writer.writerow</code> is meant for writing a row, not a single field.</span>
<span class="comment-copy">That wasn't that but I give  you an upvote because it's well better formatted than mine ! Thanks !</span>
