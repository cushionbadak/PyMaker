<div class="post-text" itemprop="text">
<p>I have a folder with a lot of .sh scripts. How can I use an already set up dask distributed cluster to run them in parallel? </p>
<p>Currently, I am doing the following:</p>
<pre><code>import dask, distributed, os

# list with shell commands that I want to run
commands = ['./script1.sh', './script2.sh', './script3.sh']

# delayed function used to execute a command on a worker
run_func = dask.delayed(os.system)

# connect to cluster
c = distributed.Client('my_server:8786')

# submit job
futures = c.compute( [run_func(c) for c in commands])

# keep connection alive, do not exit python
import time
while True:
    time.sleep(1)
</code></pre>
<p>This works, however for this scenario it would be ideal if the client could disconnect without causing the scheduler to cancel the job. I am looking for a way to compute my tasks that does not require an active client connection. How could this be done?</p>
</div>
<div class="post-text" itemprop="text">
<p>Have you seen <a href="http://distributed.readthedocs.io/en/latest/api.html#distributed.client.fire_and_forget" rel="nofollow noreferrer">http://distributed.readthedocs.io/en/latest/api.html#distributed.client.fire_and_forget</a> ? That would be a way to ensure that some task runs on the cluster after the client has gone.</p>
<p>Note also that you have functions like <a href="http://distributed.readthedocs.io/en/latest/api.html#distributed.client.wait" rel="nofollow noreferrer"><code>wait()</code></a> or even <code>gather()</code> so you don't need sleep-forever loops. </p>
<p>In general, though, <a href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen" rel="nofollow noreferrer"><code>subprocess.Popen</code></a> will launch a child process and <em>not</em> wait for it to finish, so you don't even need anything complex from dask, since it doesn't appear you are interested in any output from the call.</p>
</div>
<span class="comment-copy">I just figured out <code>fire_and_forget</code> is also nicely documented here: <a href="http://dask.pydata.org/en/latest/futures.html#fire-and-forget" rel="nofollow noreferrer">dask.pydata.org/en/latest/futures.html#fire-and-forget</a></span>
