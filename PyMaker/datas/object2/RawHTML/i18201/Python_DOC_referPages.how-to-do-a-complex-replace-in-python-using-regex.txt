<div class="post-text" itemprop="text">
<p>Here is the scenario:</p>
<pre><code>dict = {'t1': 'm1', 'year': '2003'}
pattern = re.compile(r'#\{(.*?)\}')
str = "select * from records where year = #{year} and t1 = #{t1}"
</code></pre>
<p>What I want to do is to replace the <code>str</code> to <strong>"select * from records where year = 2003 and t1 = m1"</strong></p>
<p>Could anyone tell me how to do it using python regex? Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>If you use <code>{..}</code> instead of <code>#{..}</code>, you can use <a href="http://docs.python.org/3/library/stdtypes#str.format" rel="nofollow"><code>str.format_map</code></a> or <a href="http://docs.python.org/3/library/stdtypes#str.format" rel="nofollow"><code>str.format</code></a>:</p>
<pre><code>&gt;&gt;&gt; d = {'t1': 'm1', 'year': '2003'}
&gt;&gt;&gt; fmt = "select * from records where year = {year} and t1 = {t1}"
&gt;&gt;&gt; fmt.format_map(d) # available only in Python 3.2+
'select * from records where year = 2003 and t1 = m1'
&gt;&gt;&gt; fmt.format(**d)
'select * from records where year = 2003 and t1 = m1'
</code></pre>
<hr/>
<p>Regular expression solution: Use <a href="http://docs.python.org/3/library/re.html#re.sub" rel="nofollow"><code>re.sub</code></a> with the replacement function as the second argument.</p>
<pre><code>&gt;&gt;&gt; d = {'t1': 'm1', 'year': '2003'}
&gt;&gt;&gt; fmt = "select * from records where year = #{year} and t1 = #{t1}"
&gt;&gt;&gt; import re
&gt;&gt;&gt; re.sub(r'#\{(.*?)\}', lambda m: d[m.group(1)], fmt) # m -&gt; match object
'select * from records where year = 2003 and t1 = m1'
</code></pre>
</div>
<span class="comment-copy">cool! thanks bro.</span>
