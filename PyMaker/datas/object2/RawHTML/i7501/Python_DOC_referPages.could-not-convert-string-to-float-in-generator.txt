<div class="post-text" itemprop="text">
<p>I am trying to do some basic operations with a nest listed of data in Python 2.7.  A simplified version of my data is presented below:</p>
<pre><code>resultlistdata = [
['sell','EURUSD',-1092.0,'Sometext'],
['buy','GBPUSD',2342.0,'Moretext'],
['buy','EURUSD',2122.0,'Yetmoretext'],
['not opened','','',''],
['sell','EURJPY',-483,'Difftext'],
['sell','EURJPY',269,'Anothertext'],
etc...
]
</code></pre>
<p>The list is a few thousand lines long.  I'm trying to count the number of times the third item in the list is greater than or equal to zero (so the correct result in the case above would be 3).  I am using the generator expression (or is it list comprehension?):</p>
<pre><code>profittrades = sum(1 for x in resultdatalist if x[2] &gt;= 0)
</code></pre>
<p>which gives an answer equal to the number of items in the list (so 6 in the case above, which is wrong).  I have also tried:</p>
<pre><code>profittrades = sum(1 for x in resultdatalist if float(x[2]) &gt;= 0)
</code></pre>
<p>which gives the error "ValueError:  Could not convert string to float".</p>
<p>I am almost certain the problem is caused by the line where the 'not opened' occurs, and it cannot convert the empty string to a float, I just don't know what to do about it!</p>
<p>Is there a way to do the counting using a 'one-liner' list comprehension approach, or do I need to make a loop?  </p>
<p>The "resultslistdata" is compiled by me, so if there is something clever I can do when creating it that would help I can give it a try.  Im reluctant to enter a value of "0" as the profit for trades that are "never opened" because later when I do averages it will skew my results (?!).</p>
<p>Thank you to anyone who can help me!</p>
</div>
<div class="post-text" itemprop="text">
<p>If all trades that were never opened (or something of that sort) are all blanks <code>''</code>, then you can do:</p>
<pre><code>profittrades = sum(1 for x in resultdatalist if x[2] and float(x[2]) &gt;= 0)
</code></pre>
<p>This checks first that the string is not <em>falsy</em> i.e. blank, before attempting the <code>float</code> cast.</p>
</div>
<div class="post-text" itemprop="text">
<p>Using python 3.5 I can do:</p>
<pre><code>profittrades = sum(
    1 for x in resultdatalist if float(x[2] if x[2] != "" else -1) &gt;= 0
)
</code></pre>
<p>I don't know though if this still working in earlier version of python.</p>
</div>
<div class="post-text" itemprop="text">
<p>You may use <a href="https://docs.python.org/3/library/functions.html#sum" rel="nofollow noreferrer"><code>sum</code></a> with the <em>generator expression</em> as:</p>
<pre><code>&gt;&gt;&gt; sum((val or 0) and val&gt;=0 for _, _, val, _ in resultlistdata)
3
</code></pre>
<p>OR, alternatively you may also use the <code>if</code> filter within your generator expression as:</p>
<pre><code>&gt;&gt;&gt; sum(1 for _, _, val, _ in resultlistdata if val and val&gt;=0)
3
</code></pre>
</div>
<span class="comment-copy">Thank you Moses - it looks so simple when its "done for me" like this!  I thought that writing "if x[2]" is equivalent to writing "if x[2] is true", which I didn't think it ever would be because its an empty string, and I would have thought that putting it in the generator expression would mean that both "tests" would be run each time and therefore I would still get the error.  This clearly isn't the case though, and your suggested code works perfectly - thank you once again!</span>
<span class="comment-copy">@Paul Glad I could help.</span>
