<div class="post-text" itemprop="text">
<p>I have an Excel spreadsheet. In column A I have an ID, column B I have the description. </p>
<p>The same ID and same text repeats <code>x</code> times, but the final row of that ID has no description. And then the ID changes. </p>
<p>Here is a screenshot of the file:</p>
<p><a href="https://i.stack.imgur.com/40E6y.png" rel="nofollow noreferrer"><img alt="excel file" src="https://i.stack.imgur.com/40E6y.png"/></a></p>
<p>I want with Python to read downwards. When it finds a new ID, append it to a dictionary with its description, and then go to the next ID with its description. </p>
<p>ItÂ´s like the <code>vlookup</code> formula, but with Python. </p>
</div>
<div class="post-text" itemprop="text">
<p>I think this does what you're trying to achieve:</p>
<pre><code>import csv
datafile = open('asdf.csv', 'r')
datareader = csv.reader(datafile,delimiter=',')
data = []
for row in datareader:
    data.append(row)    

output = []
ids = []
for d in data:
    if d[0] not in ids:
        ids.append(d[0])
        output.append(d)

print(output)
</code></pre>
<p>From this:</p>
<p><a href="https://i.stack.imgur.com/iGnJB.png" rel="nofollow noreferrer"><img alt="" src="https://i.stack.imgur.com/iGnJB.png"/></a></p>
<p>You get this:</p>
<pre><code>[['\xef\xbb\xbf1', 'ab'], ['1', 'b'], ['2', 'ab'], ['3', 'z'], ['33', 'ab']]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can load the data into pandas dataframe using <code>read_excel</code>, and then use <code>fillna</code> with <code>method='ffill'</code> on description column, after which you save the table. A three-liner, basically.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can try this if you like using <a href="http://pandas.pydata.org/" rel="nofollow noreferrer">pandas</a>:</p>
<p>in case you don't know how to read excel files with pd it's done with <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_excel.html" rel="nofollow noreferrer">pandas.read_excel</a>:</p>
<pre><code>import pandas as pd
# header = None in case you don't have any header rows in your excel
# names are the columns names
df = pd.read_excel(file_dir,sheetName,header=None,names=['A','B','C']) 
</code></pre>
<p>for this case i used this data set:</p>
<pre><code>     A      B      C
0  ID1  Desc1  stuff
1  ID1  Desc1  stuff
2  ID1  Desc1  stuff
3  ID1    NaN    NaN    # NaN are empty cells ( missing values )
4  ID2  Desc2  stuff
5  ID2  Desc2  stuff
6  ID2    NaN    NaN
</code></pre>
<p>so once you have your dataframe, all you need to create your dicts are <a href="http://pandas.pydata.org/pandas-docs/version/0.17.1/generated/pandas.DataFrame.drop_duplicates.html" rel="nofollow noreferrer">pandas.drop_duplicates</a> and <a href="https://docs.python.org/3/library/functions.html#zip" rel="nofollow noreferrer">zip</a> built-in function:</p>
<pre><code>df.drop_duplicates(['A'],keep='first',inplace=True)
d = {k:v for k,v in zip(df['A'],df['B'])}
</code></pre>
<p>that will give you <code>d</code>:</p>
<pre><code>{'ID1': 'Desc1', 'ID2': 'Desc2'}
</code></pre>
<p>Hope that was helpful.</p>
</div>
<span class="comment-copy">hi, are you willing to use pandas ? it makes it very easy. all in all two lines of code</span>
