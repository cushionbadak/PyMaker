<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/29783450/python-strip-not-working-inside-a-function">Python strip() not working inside a function</a>
<span class="question-originals-answer-count">
                    2 answers
                </span>
</li>
</ul>
</div>
<p>I have an issue using regex in <code>lxml</code> <code>etree.XPath</code> expression in Python 3.6</p>
<p>In this example i'm searching for 4 digit number surrounded by white space, on the <strong>stackoverflow</strong> homepage. And returning the <code>xpath</code> of that element.</p>
<p>I'm getting match's that are just white space. I cant seem to be able to filter them out. My feelings are that it may be some encoding issue, but cant put my finger on it...</p>
<p>The picture below is from <code>https://regex101.com/</code>. Correctly giving me 1 match.</p>
<p>here is a link to the homepage html:
<a href="https://drive.google.com/open?id=0B3HIB_5rVAxmZU9ialZHdzhscE0" rel="nofollow noreferrer">https://drive.google.com/open?id=0B3HIB_5rVAxmZU9ialZHdzhscE0</a></p>
<p><a href="https://i.stack.imgur.com/BuiAq.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/BuiAq.png"/></a></p>
<p><strong>Here's my code</strong></p>
<pre><code>from lxml import html
from lxml import etree

with open('stackoverflow.html', 'r', encoding='utf8') as f:
    page_html = f.read()

html_tree = html.fromstring(page_html)

regexpNS = "http://exslt.org/regular-expressions"
find = etree.XPath("//*[re:test(., '(\s\d{4}\s)', 'i')]",
                       namespaces={'re':regexpNS})

tree = etree.fromstring(page_html)
tree = etree.ElementTree(tree)
for element in find(tree):
    text = str(element.text)
    str(text).strip()
    if text != '':
        print(text)
        print(len(text))
        print(tree.getpath(element))
        print('##############################################################')
</code></pre>
<p><strong>Outputs</strong></p>
<pre><code>    None
    4
    / *
    ##############################################################

    13
    / * / *[2]
    ##############################################################

    13
    / * / *[2] / * [8]
    ##############################################################

    17
    / * / *[2] / * [8] / *
    ##############################################################

    21
    / * / *[2] / * [8] / * / *
    ##############################################################

    25
    / * / *[2] / * [8] / * / * / * [18]
    ##############################################################

    29
    / * / *[2] / * [8] / * / * / * [18] / *
    ##############################################################

    33
    / * / *[2] / * [8] / * / * / * [18] / * / * [2]
    ##############################################################
    site
    design / logo Â© 2017
    Stack
    Exchange
    Inc;
    user
    contributions
    licensed
    under
    117
    / * / *[2] / * [8] / * / * / * [18] / * / * [2] / *
    ##############################################################
</code></pre>
<p>Whats up with the blank text lines with <code>len</code> &gt; 0 that should have been stripped???</p>
<p>Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/stdtypes.html#str.strip" rel="nofollow noreferrer"><code>str.strip</code></a> returns a stripped text, but does not change <code>text</code>.</p>
<pre><code>&gt;&gt;&gt; text = '    a    '
&gt;&gt;&gt; text.strip()   # returns a new string
'a'
&gt;&gt;&gt; text  # `text` is not changed
'    a    '
</code></pre>
<hr/>
<p>If you want change <code>text</code>, you need to reassign the return value of the above expression back to <code>text</code> (BTW, you don't need to call <code>str(..)</code> because <code>text</code> is already a <code>str</code> object:</p>
<pre><code>str(text).strip()
</code></pre>
<p>should be replaced with:</p>
<pre><code>text = text.strip()
</code></pre>
</div>
<span class="comment-copy">Hmm... no one explained why I was getting multiple results for the xpath regex expression... A work around was good enough. The root question is different to the reason it is a duplicate. I suppose it doesn't matter anyway.</span>
<span class="comment-copy">Arhh, a string is immutable? That's why? and yeah i saw that but  I was trying to Jam it into a type because it was being odd...</span>
<span class="comment-copy">@JamesSchinner, Yes, strings are immutable in python.</span>
<span class="comment-copy">Yes that solved my problem. I'm now able to filter out the blanks. So thanks! Though, I still don't know why i'm getting blank matches and even a <code>None</code> type.</span>
<span class="comment-copy">@JamesSchinner, Because it's converted to string <code>'None'</code> (because of <code>str(element.text)</code>. You can filter that out just below the <code>for ...</code>: <code>if element.text is None: continue</code></span>
<span class="comment-copy">The None isn't a <code>None</code> it's a "None" - solved. Cheers mate!</span>
