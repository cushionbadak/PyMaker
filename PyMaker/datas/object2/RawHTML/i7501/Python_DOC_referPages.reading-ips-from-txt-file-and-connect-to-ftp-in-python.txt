<div class="post-text" itemprop="text">
<p>I'm trying to write a script in python which connects to all our ftps and tells me that they are up and lists they dirs when connecting.</p>
<p>I'll try that with a file called "ips.txt" where all our ips are in - one each line and the following script:</p>
<pre><code>import socket
import ftplib

username = "xxx"
password = "xxx"



for server in open("ips.txt", "r").readlines():
    try:
        ftp = ftplib.FTP(server)
        welcome = ftp.getwelcome()
        print (welcome)

        try:
            attempt = ftp.login(user=username, passwd=password)
            success = ("[****] Working " + server + '\n')

            print(success)
            data = []
            ftp.dir(data.append)
            for lines in data:
                print (lines)

        except:
            print (server, username, password)
            pass

    except:
        print ("Timeout...")
</code></pre>
<p>But it seems like the script is skipping everything and just prints "Timeout..." :(</p>
<p>I'm a bloody python beginner, so please be patient.</p>
<p>EDIT:
After removing the outer try/except I got a traceback:</p>
<pre><code>    Traceback (most recent call last):
  File "ftp.py", line 12, in &lt;module&gt;
    ftp = ftplib.FTP(server)
  File "C:\Python3.5.1\lib\ftplib.py", line 118, in __init__
    self.connect(host)
  File "C:\Python3.5.1\lib\ftplib.py", line 153, in connect
    source_address=self.source_address)
  File "C:\Python3.5.1\lib\socket.py", line 693, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
  File "C:\Python3.5.1\lib\socket.py", line 732, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 11001] getaddrinfo failed
</code></pre>
<p>the ips.txt looks like:</p>
<pre><code>10.10.10.10
10.10.10.11
10.10.10.21
10.10.10.33
</code></pre>
<p>So new line for each IP</p>
</div>
<div class="post-text" itemprop="text">
<p>Based on the file that you are providing, when you make a <code>readlines</code> call, you are still preserving the newline character at the end of each IP. This is most likely why you are getting the <code>gaierror</code> you are getting. </p>
<p>Replicating on my end, with a newline character, my traceback yields:</p>
<pre><code>&gt;&gt;&gt; FTP('10.10.10.10\n')

Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/ftplib.py", line 118, in __init__
    self.connect(host)
  File "/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/ftplib.py", line 153, in connect
    source_address=self.source_address)
  File "/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/socket.py", line 693, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
  File "/Library/Frameworks/Python.framework/Versions/3.5/lib/python3.5/socket.py", line 732, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno 8] nodename nor servname provided, or not known
</code></pre>
<p>Simply do: </p>
<pre><code>FTP(server.strip())
</code></pre>
<p>You will then strip out the <code>\n</code> at the end of your IP and you should at the very least make the call to the <em>right</em> IP address.</p>
<p>Alternatively, you <em>could</em> try to see if <code>splitlines</code> works for you, considering you are dealing with a single list of IP addresses, it could be a good alternative.</p>
<p><a href="https://docs.python.org/3/library/stdtypes.html#str.splitlines" rel="nofollow noreferrer">splitlines</a> will remove line breaks for you against a <code>string</code>, so you need to call <code>read</code> on your open object as well. Like this:</p>
<pre><code>for server in open("ips.txt", "r").read().splitlines():
</code></pre>
</div>
<span class="comment-copy">Did you try printing the contents of <code>server</code> in each iteration to see what you are passing to the <code>FTP</code> class? Can you provide a few lines from your txt file as a sample?</span>
<span class="comment-copy">Didnt try that.  the file just looks like:  10.10.10.10 10.10.10.11 10.10.10.19 ...</span>
<span class="comment-copy">Remove the outer <code>try/except</code> and you'll know what error pops up. <code>try/except</code>s are a debugger's nightmare.</span>
<span class="comment-copy">Are the ip's delimited by space? Or newlines?</span>
<span class="comment-copy">You are not stripping each line of its newline character. Do <code>server.strip()</code>.</span>
<span class="comment-copy">Thats it! THANKS!!!</span>
