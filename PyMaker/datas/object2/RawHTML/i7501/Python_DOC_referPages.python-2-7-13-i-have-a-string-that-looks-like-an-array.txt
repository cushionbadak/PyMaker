<div class="post-text" itemprop="text">
<p>I'm trapping an error but cannot extract what I want out of the returned message.
Here's the code:</p>
<pre><code>  except purestorage.PureHTTPError as response:
     print "LUN Creation failed:"

     print dir(response)
     print "args:{}".format(response.args)
     print "code:{}".format(response.code)
     print "headers:{}".format(response.headers)
     print "message:{}".format(response.message)
     print "reason:{}".format(response.reason)
     print "rest_version:{}".format(response.rest_version)
     print "target:{}".format(response.target )
     print "text:{}".format(response.text)
</code></pre>
<p>Here's the output:</p>
<pre><code>LUN Creation failed:
['__class__', '__delattr__', '__dict__', '__doc__', '__format__', '__getattribute__', '__getitem__', '__getslice__', '__hash__', '__init__', '__module__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__setstate__', '__sizeof__', '__str__', '__subclasshook__', '__unicode__', '__weakref__', 'args', 'code', 'headers', 'message', 'reason', 'rest_version', 'target', 'text']
args:()
code:400
headers:{'Content-Length': '113', 'Set-Cookie': 'session=....; Expires=Wed, 05-Jul-2017 16:28:26 GMT; HttpOnly; Path=/', 'Server': 'nginx/1.4.6 (Ubuntu)', 'Connection': 'keep-alive', 'Date': 'Wed, 05 Jul 2017 15:58:26 GMT', 'Content-Type': 'application/json'}
message:
reason:BAD REQUEST
rest_version:1.8
target:array1
text:[{"pure_err_key": "err.friendly", "code": 0, "ctx": "lun-name", "pure_err_code": 1, "msg": "Volume already exists."}]
</code></pre>
<p>I want to pull out <code>msg</code> and <code>pure_err_code</code> but the <code>text</code> isn't a list.
The <code>[{ ... }]</code> is confusing me.  The <code>response.text[0]</code> is <code>[</code> and <code>response.text['msg']</code> throws an index error so this is acting like a string (afaIk).</p>
</div>
<div class="post-text" itemprop="text">
<p>You have <a href="https://en.wikipedia.org/wiki/JSON" rel="nofollow noreferrer">JSON data</a>. The response headers even tell you this:</p>
<pre><code>'Content-Type': 'application/json'
</code></pre>
<p>Use the <a href="https://docs.python.org/3/library/json.html" rel="nofollow noreferrer"><code>json</code> module</a> to decode this:</p>
<pre><code>error_info = json.loads(response.text)
</code></pre>
<p><code>error_info</code> is then a <em>list</em> containing a single dictionary in this case (suggesting there could be 0 or more results). You could loop, or assume that there is always 1 result, at which point you can use <code>[0]</code> to extract just that one dictionary</p>
<pre><code>print(error_info[0]['pure_err__key'])
print(error_info[0]['msg'])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>It seems that your <code>response.text</code> is a JSON, so first parse it and then access your data:</p>
<pre><code>import json

data = json.loads(response.text)
print(data[0]["pure_err_code"])
print(data[0]["msg"])
# etc.
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Your response is json so something like this will help you:</p>
<pre><code>import json

a = '[{"pure_err_key": "err.friendly", "code": 0, "ctx": "lun-name", "pure_err_code": 1, "msg": "Volume already exists."}]'

h = json.loads(a)

print(h[0]['code']) #prints 0
</code></pre>
</div>
<span class="comment-copy">and thanks to zwer too!</span>
<span class="comment-copy">Thanks pyjg - it works.  I guess that's 2 hours of my life I won't get back!</span>
<span class="comment-copy">@IanJones you are welcome!</span>
