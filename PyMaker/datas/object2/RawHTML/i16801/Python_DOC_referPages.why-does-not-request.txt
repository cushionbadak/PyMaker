<div class="post-text" itemprop="text">
<p>please help fix the code. </p>
<p>model.py: </p>
<pre><code>class Friends(models.Model):        
    user_id = models.IntegerField(
        blank=False,
        null=False,
    )   
    friend_id = models.IntegerField(
        blank=False,
        null=False, 
    )   

    @classmethod
    def get_entry(self, user_id, friend_id):
        return False
</code></pre>
<p>views.py: </p>
<pre><code>@ login_required 
def user_personal(request, id):         
    if request.method == 'POST':    
        path_pk = id
        user_id = int(request.user.pk)

        if request.POST.get('action', '') == 'add':         
            try: 
                with open(os.path.join(settings.BASE_DIR, "add1.txt"), "wb") as f:
                    f.write(bytes(user_id, 'UTF-8'))                    
                Friends.get_entry(user_id=user_id, friend_id=path_pk)   #
            except: 
                with open(os.path.join(settings.BASE_DIR, "add2.txt"), "wb") as f:
                    f.write(bytes(user_id, 'UTF-8'))                                        
                Friends.set_entry(user_id=user_id, friend_id=path_pk)

    t = loader.get_template('user_personal.html')
    c = RequestContext(request, {}) 
    return HttpResponse(t.render(c))
</code></pre>
<p>the problem is that when it works </p>
<pre><code>user_personal (request, 3) 
</code></pre>
<p>, Then there is a write debug file add1.txt. and there is no record debug file add2.txt. the content of the debug file add1.txt following: </p>
<pre><code>NUL NUL 
</code></pre>
<p>because this function does not work </p>
<pre><code>Friends.get_entry (user_id = user_id, friend_id = path_pk)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>In Python3, the <a href="https://docs.python.org/3/library/stdtypes.html#bytes" rel="nofollow">bytes</a> type represents a sequence of integers. Passing an integer to convert to a byte object will create a <code>bytes</code> type with a sequence of <code>NUL</code> characters, aka <code>\x00</code>, with the length of the integer passed. I guess that the <code>pk</code> of your user object is <code>2</code>, so the following line:</p>
<pre><code>f.write(bytes(user_id, 'UTF-8'))   
</code></pre>
<p>will write the integer sequence <code>\x00\x00</code> to the file. Your text editor represents this as <code>NUL NUL</code>. </p>
</div>
<span class="comment-copy">Are you by any chance using python 3?</span>
<span class="comment-copy">yes. i use python3.3</span>
