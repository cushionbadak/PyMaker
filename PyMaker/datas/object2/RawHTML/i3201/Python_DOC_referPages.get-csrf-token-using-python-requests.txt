<div class="post-text" itemprop="text">
<p>I am currently using Python Requests, and need a CSRF token for logging in to a site. from my understanding requests.Session() gets the cookie, but obviously I need the token. And Also I would like to know where to place it in my code.
    import requests</p>
<pre><code>user_name = input('Username:')
payload = {
'username': 'user_name',
'password': 'randompass123'
}


with requests.Session() as s:
p = s.post('https://examplenotarealpage.com', data=payload)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>See the following code example. You can use it directly to login into a website that only uses cookies to store login information.</p>
<pre><code>import requests

LOGIN_URL = 'https://examplenotarealpage.com'
headers = {
    'accept': 'text/html,application/xhtml+xml,application/xml',
    'user-agent': 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36'
}

response = requests.get(LOGIN_URL, headers=headers, verify=False)

headers['cookie'] = '; '.join([x.name + '=' + x.value for x in response.cookies])
headers['content-type'] = 'application/x-www-form-urlencoded'
payload = {
    'username': 'user_name',
    'password': 'randompass123'
}

response = requests.post(LOGIN_URL, data=payload, headers=headers, verify=False)
headers['cookie'] = '; '.join([x.name + '=' + x.value for x in response.cookies])
</code></pre>
<p>There are a few possible locations of the <code>CSRF</code> token. Different websites use different ways to pass it to browser. Here are some of them: </p>
<ul>
<li>It can come with response headers, in that case getting it is easy. </li>
<li><p>Sometimes page meta holds the CSRF token. You have to parse the html content of the page to get it. Find the proper CSS selector for it. See an example: </p>
<pre><code>from bs4 import BeautifulSoup
soup = BeautifulSoup(response.text, 'lxml')
csrf_token = soup.select_one('meta[name="csrf-token"]')['content']
</code></pre></li>
<li><p>It can be inside of a script tag with JavaScript code. Getting it will be tricky. But, you can always use <a href="https://docs.python.org/3/library/re.html" rel="nofollow noreferrer">regex</a> to isolate it.</p></li>
</ul>
</div>
<span class="comment-copy">This website talks you through the process fairly simply: <a href="http://kazuar.github.io/scraping-tutorial/" rel="nofollow noreferrer">kazuar.github.io/scraping-tutorial</a> Basically, look in the page source for an input tag called something like "csrftoken" or similar.</span>
