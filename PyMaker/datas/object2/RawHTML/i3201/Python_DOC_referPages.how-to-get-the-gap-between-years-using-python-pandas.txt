<div class="post-text" itemprop="text">
<p>I am having a data frame like this</p>
<pre><code>Series_id  F start end data

3               A     2012 2018  [[2012,0],[2014,0],[2015,1],[2017,3],[2019,0],[2020.1]]
</code></pre>
<p>I need Output like this </p>
<p>{series_id:3,start:2013,end:2013,count:1},{series_id:3,start:2016,end:2016,count:1}{series_id:3,start:2018,end:2018,count:1},</p>
<p>I have to iterate over the data frame of each row and find the gap between year in the data column The data column is a list of a list which has the year and some data in each list</p>
<p>I have to check with consecutive and missing years and count.
count example: take series id:3 start=2014 end=2018 on iterating the 2013,2016 and 2018 are missed but in between, 2017 is there so for that I have to get like this
{series_id:3,start:2013,end:2013,count:1},
{series_id:3,start:2016,end:2016,count:1},{series_id:3,start:2018,end:2018,count:1}</p>
<p>How can I achieve this even I not able to iterate it?
Please Need a help</p>
</div>
<div class="post-text" itemprop="text">
<p>If your question is how to convert a query operation performed on a pandas dataframe into a list. There is a method called as to_json() on pandas.
Find the link below to see examples and implementation.</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.to_json.html" rel="nofollow noreferrer">enter link description here</a></p>
<p>Use orient = records
Then you can use <a href="https://docs.python.org/3/library/json.html" rel="nofollow noreferrer">json.loads()</a> to convert to a list.</p>
<p>Now you can iterate over it.</p>
</div>
<span class="comment-copy">I don't understand how you're getting the <code>count</code>.  Also why do you have random duplicate entries?</span>
<span class="comment-copy">I have improved the Question</span>
<span class="comment-copy">Thanks for improving. Still hard to understand. Your result contains <code>{series_id:2,start:2013,end:2013,count:1}</code> but there is no 2013 in Series_id:2. Please explain.</span>
<span class="comment-copy">What I need is the missing years in the result.2013 is missing between 2012 and 2014 so for that.</span>
<span class="comment-copy">Please post a simple understandable dataframe and a expected output for that</span>
