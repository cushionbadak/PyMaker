<div class="post-text" itemprop="text">
<p><strong>Problem:</strong></p>
<p>In Python 3, I'm using csv.DictWriter to append a row to an existing file. However, CRLF line endings are being used instead of the expected LF line endings.</p>
<p><strong>Code example:</strong></p>
<pre><code>#!/usr/bin/env python3
import csv

with open("test.csv", 'a', newline='') as test_f:
    test_csv = csv.DictWriter(test_f, delimiter='|', fieldnames=['1', '2'])
    test_csv.writerow({'1': "test1", '2': "test2"})
</code></pre>
<p><strong>Expected result:</strong></p>
<pre><code>$ cat -e test.csv
test1|test2$
</code></pre>
<p><strong>Actual result:</strong></p>
<pre><code>$ cat -e test.csv
test1|test2^M$
</code></pre>
<p><strong>Notes:</strong></p>
<ul>
<li>The existing file's fileformat is "unix", not "dos".</li>
<li>I have tried setting <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow">newline</a> to None (the default) and '\n' as well (even that should be unnecessary since the default value is os.linedep, which is already '\n' on Linux), but the result is the same.</li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>By specifying <a href="https://docs.python.org/3/library/csv.html#csv.Dialect.lineterminator" rel="nofollow"><code>lineterminator</code></a>, you can control it.</p>
<pre><code>test_csv = csv.DictWriter(
    test_f,
    delimiter='|',
    lineterminator='\n',  # &lt;--------
    fieldnames=['1', '2'])
</code></pre>
</div>
