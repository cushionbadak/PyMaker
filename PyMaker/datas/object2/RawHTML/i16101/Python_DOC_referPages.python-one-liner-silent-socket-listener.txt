<div class="post-text" itemprop="text">
<p>Is it possible to write python one-liner, which will be listen on specific tcp port, accept connections, and response nothing.</p>
<p>I can do this in two lines:</p>
<pre><code>import socket; s = socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.bind(("", 5555)); s.listen(1); accepter = s.accept();
while True: data = accepter[0].recv(1024);
</code></pre>
<p>But I want to run this from <code>python -c</code>, So it should be one line.</p>
<p>How can I achieve this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Using <a href="https://docs.python.org/2/library/itertools.html#itertools.count" rel="nofollow"><code>itertools.count</code></a> and <a href="https://docs.python.org/2/library/functions.html#reduce" rel="nofollow"><code>reduce</code></a> (In Python 3.x, you need to use <a href="https://docs.python.org/3/library/functools.html#functools.reduce" rel="nofollow"><code>functools.reduce</code></a>):</p>
<pre><code>import socket, itertools; s = socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.bind(('', 5555)); s.listen(1); accepter = s.accept(); reduce(lambda x, y: accepter[0].recv(1024), itertools.count())
</code></pre>
<p>You can also use other infinite iterator like <a href="https://docs.python.org/2/library/functions.html#reduce" rel="nofollow"><code>itertools.cycle</code></a> or <a href="https://docs.python.org/2/library/itertools.html#itertools.repeat" rel="nofollow"><code>itertools.repeat</code></a>.</p>
<p>Following lines are an expanded version of above one-liner.</p>
<pre><code>import socket, itertools
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.bind(('', 5555))
s.listen(1)
accepter = s.accept()
reduce(lambda x, y: accepter[0].recv(1024), itertools.count())
</code></pre>
</div>
<span class="comment-copy">Note: <a href="http://stackoverflow.com/questions/2043453/executing-python-multi-line-statements-in-the-one-line-command-line" title="executing python multi line statements in the one line command line">stackoverflow.com/questions/2043453/â€¦</a></span>
<span class="comment-copy">How does the oneliner work with python -c ?</span>
<span class="comment-copy">@kingsdeb, <code>python -c "...."</code> (Replace <code>...</code> with the given one-liner)</span>
<span class="comment-copy">@kingsdeb, With <code>-c</code> option python interpret the given string as a program content.</span>
<span class="comment-copy">Traceback (most recent call last):   File "&lt;string&gt;", line 1, in &lt;module&gt;   File "socket.py", line 2, in &lt;module&gt;     s = socket.socket(socket.AF_INET, socket.SOCK_STREAM); s.bind(("", 5555)); s.listen(1); accepter = s.accept() AttributeError: 'module' object has no attribute 'AF_INET'</span>
<span class="comment-copy">@kingsdeb, What is you python version? What is your platform?</span>
