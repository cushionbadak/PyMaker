<div class="post-text" itemprop="text">
<p>Im trying to do a http 'POST' with multipart/form-data to a python GAE backend.
My server side method is receiving the complete body but i have absolutely no idea how to parse the body content without going over it manually and splitting the text for values.</p>
<p>My request looks like this:</p>
<pre><code>POST /android/v4/MyPostMethod HTTP/1.1
Accept: */*
Accept-Charset: *
Content-Length: 186808
Content-Type: multipart/form-data; boundary=*****; charset="utf-8"
Content_Length: 186808
Content_Type: multipart/form-data; boundary=*****
Host: myhost.appspot.com
User-Agent: Dalvik/1.6.0 (Linux; U; Android 4.1.2; GT-I9300 Build/XXXXX)
Via: HTTP/1.1 MSP-YV

--*****
Content-Disposition: form-data; name="value1"
Content-Type: text/plain; charset=UTF-8

f0ef73c5-54dd-40cf-9ee7-5c4cb764eb28
--*****
Content-Disposition: form-data; name="value2"
Content-Type: text/plain; charset=UTF-8

10d71e73-4d4d-4607-b271-f7efcfd0c59d
--*****
Content-Disposition: form-data; name="value3"
Content-Type: text/plain; charset=UTF-8

10d71e73-4d4d-4607-b271-f7efdfdfdfdf
--*****
Content-Disposition: form-data; name="logText"; filename="log.txt"
Content-Type: text/plain
Content-Transfer-Encoding: binary

xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
...
--*****--
</code></pre>
<p>I've searched around and couldn't find a good explanation of how to do this trivial thing.
Appreciate if someone could help me here. Thanks.</p>
</div>
<div class="post-text" itemprop="text">
<p>For some reason cgi.FieldStorage() wasnt working for me, but only the deprecated method :</p>
<pre><code>pdict = {'boundary':'*****'}
cgi.parse_multipart(self.request.body_file, pdict)
</code></pre>
<p>Dont know why but as long as its working im fine with that.</p>
</div>
<div class="post-text" itemprop="text">
<p>You want the <a href="https://docs.python.org/3/library/cgi.html" rel="nofollow">.cgi</a> python library. </p>
<p>Specifically something like this:</p>
<pre><code>import cgi
form = cgi.FieldStorage() 
value1 = form.getfirst("value1", "")
value2 = form.getfirst("value2", "") 
value3 = form.getfirst("value3", "") 
logtext = form.getfirst("logText", "")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you want the uploaded files, you can do this</p>
<p><code>for upload in self.get_uploads():</code></p>
<p>If you want just a text field:</p>
<p><code>x = self.request.get('value1')</code></p>
</div>
<span class="comment-copy">This is not ideal for large files. From the documentation "This is easy to use but not much good if you are expecting megabytes to be uploaded â€” in that case, use the FieldStorage class instead which is much more flexible."</span>
