<div class="post-text" itemprop="text">
<pre><code>class QuotesSpider(scrapy.Spider):
    name = "googlemailverif"

    with open('input.csv', "r") as csvfile:
        datareader = csv.reader(csvfile)

        start_urls=['https://www.google.fr/search?q=email'+str(row[2]) for row in datareader]



    # starting parsing
    def parse(self, response):
        yield {
                'url': response.url,
                'nom': "nom",
                'emails': re.findall(r"[a-zA-Z0-9_\.+-]+@[a-zA-Z0-9_\.+-]+\.[a-zA-Z]{2,6}",''.join(response.xpath("//body//text()").extract()).strip()),
                'SIRET':"SIRET",
                    }
</code></pre>
<p>This is a code that try from a csv file (with in 3rd column to extract a name of a company) to check for emails on google. 
The first column contains an information i want to extract in the csv as "SIRET".
How can I do it? </p>
<p>If i extract it in start_urls when reading the csv, my url will be bad. If I use it it parse I will not : have the good data related to the data parsed, and I may have an error because accessing a file 2 times. </p>
<p>How can I make the information out of the first reading going to SIRET in the parse function? </p>
<p>I am struggling for hours on it :( </p>
<p>Best,</p>
</div>
<div class="post-text" itemprop="text">
<p>We can use <a href="https://docs.python.org/3/library/functions.html#zip" rel="nofollow noreferrer"><code>zip</code></a> for this.</p>
<pre><code>sirets, start_urls = zip(*[(row[0], 'https://www.google.fr/search?q=email'+str(row[2])) for row in datareader])
</code></pre>
<p>Now you have one list containing the SIRET values and another list containing urls</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>"SIRET","NIC","L1_NORMALISEE","L2_NORMALISEE","L3_NORMALISEE","L4_NORMALISEE","L5_NORMALISEE","L6_NORMALISEE","L7_NORMALISEE","L1_DECLAREE","L2_DECLAREE","L3_DECLAREE","L4_DECLAREE","L5_DECLAREE","L6_DECLAREE","L7_DECLAREE","NUMVOIE","INDREP","TYPVOIE","LIBVOIE","CODPOS","CEDEX","RPET","LIBREG","DEPET","ARRONET","CTONET","COMET","LIBCOM","DU","TU","UU","EPCI","TCD","ZEMET","SIEGE","ENSEIGNE","IND_PUBLIPO","DIFFCOM","AMINTRET","NATETAB","LIBNATETAB","APET700","LIBAPET","DAPET","TEFET","LIBTEFET","EFETCENT","DEFET","ORIGINE","DCRET","DATE_DEB_ETAT_ADM_ET","ACTIVNAT","LIEUACT","ACTISURF","SAISONAT","MODET","PRODET","PRODPART","AUXILT","NOMEN_LONG","SIGLE","NOM","PRENOM","CIVILITE","RNA","NICSIEGE","RPEN","DEPCOMEN","ADR_MAIL","NJ","LIBNJ","APEN700","LIBAPEN","DAPEN","APRM","ESSEN","DATEESS","TEFEN","LIBTEFEN","EFENCENT","DEFEN","CATEGORIE","DCREN","AMINTREN","MONOACT","MODEN","PRODEN","ESAANN","TCA","ESAAPEN","ESASEC1N","ESASEC2N","ESASEC3N","ESASEC4N","VMAJ","VMAJ1","VMAJ2","VMAJ3","DATEMAJ"
"005720164","00028","SA SAINTE ISABELLE","","","236 ROUTE D AMIENS","","80100 ABBEVILLE","FRANCE","SA SAINTE-ISABELLE","","","236 RTE D AMIENS","","80100 ABBEVILLE","","236","","RTE","D AMIENS","80100","","32","Nord-Pas-de-Calais-Picardie","80","1","98","001","ABBEVILLE","80","4","01","248000556","41","2209","1","","1","O","201209","","","8610Z","Activités hospitalières","2008","22","100 à 199 salariés","100","2015","1","19830928","19830928","NR","99","","P","S","O","","0","SA SAINTE-ISABELLE","","","","","","00028","32","80001","","5599","SA à conseil d'administration (s.a.i.)","8610Z","Activités hospitalières","2008","","","","22","100 à 199 salariés","100","2015","ETI","19570101","201209","1","S","O","","","","","","","","","","","","2014-07-30T00:00:00"
"005720784","00031","ETABLISSEMENTS DECAYEUX","","","ZONE INDUSTRIELLE","","80210 FEUQUIERES EN VIMEU","FRANCE","ETABLISSEMENTS DECAYEUX","","","ZONE INDUSTRIELLE","","80210 FEUQUIERES EN VIMEU","","","","","ZONE INDUSTRIELLE","80210","","32","Nord-Pas-de-Calais-Picardie","80","1","17","308","FEUQUIERES EN VIMEU","80","1","18","248000630","15","0055","0","","1","O","201209","","","2572Z","Fabrication de serrures et de ferrures","2008","22","100 à 199 salariés","100","2015","4","19930401","19930401","NR","99","","P","S","O","","0","ETABLISSEMENTS DECAYEUX","","","","","","00015","32","80308","","5710","SAS/// société par actions simplifiée","2599A","Fabrication d'articles métalliques ménagers","2008","","N","20160915","32","250 à 499 salariés","200","2015","ETI","19570101","201209","3","S","O","2012","6","2599A","2599A","2599B","2572Z","4649Z","","","","","2001-12-13T00:00:00"
</code></pre>
<p>This is an extract from the csv</p>
<p>Each time I have an "SIRET" as a sirets value, but the other var increments and changes everytime </p>
<p>Thank you so much ++ </p>
</div>
<span class="comment-copy">check scrapy's documentation, specifically the <a href="https://doc.scrapy.org/en/latest/topics/spiders.html#scrapy.spiders.Spider.start_requests" rel="nofollow noreferrer"><code>start_requests</code></a> method</span>
<span class="comment-copy">@roganjosh If you look at the original question, you will see that it was already a class, but was not formatted correctly.  All I did was Ctrl-k</span>
<span class="comment-copy">Thanks, it is very encouraging ! Nevertheless, the self.sirets[0] or self.siret always show the first line, and nothing after line 1.. And I have no idea of how increment the variable sirets</span>
<span class="comment-copy">could you post a couple of lines from <code>datareader</code>?  It's difficult to debug without the data</span>
<span class="comment-copy">Sure Patrick :) Thank you +++</span>
<span class="comment-copy">I think I understood something. When giving the var row[0] to sirets, it doesn't go in the process scrapy goes in. So that the var isn't incremented correctly.  Actually, the var should go with the url in the middlewares and the pipeline to be sorted in the extract. Do you have any idea of how doing this? :/</span>
