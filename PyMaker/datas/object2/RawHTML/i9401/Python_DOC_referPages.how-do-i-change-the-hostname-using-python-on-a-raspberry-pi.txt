<div class="post-text" itemprop="text">
<p>I tried using (going from memory, this may not be 100% accurate):</p>
<pre><code>import socket
socket.sethostname("NewHost")
</code></pre>
<p>I got a permissions error. </p>
<p>How would I approach this entirely from within the Python program?</p>
</div>
<div class="post-text" itemprop="text">
<p>I wanted to change the hostname permanently, which required making changes in a few places, so I made a shell script:</p>
<pre><code>#!/bin/bash
# /usr/sbin/change_hostname.sh - program to permanently change hostname.  Permissions
# are set so that www-user can `sudo` this specific program.

# args:
# $1 - new hostname, should be a legal hostname

sed -i "s/$HOSTNAME/$1/g" /etc/hosts
echo $1 &gt; /etc/hostname
/etc/init.d/hostname.sh
hostname $1  # this is to update the current hostname without restarting
</code></pre>
<p>In Python, I ran the script with <a href="https://docs.python.org/3/library/subprocess.html#subprocess.run" rel="nofollow noreferrer">subprocess.run</a>:</p>
<pre><code>subprocess.run(
    ['sudo', '/usr/sbin/change_hostname.sh', newhostname])
</code></pre>
<p>This was happening from a webserver which was running as <code>www-data</code>, so I allowed it to <code>sudo</code> this specific script without a password.  You can skip this step and run the script without <code>sudo</code> if you're running as <code>root</code> or similar:</p>
<pre><code># /etc.d/sudoers.d/099-www-data-nopasswd-hostname
www-data ALL = (root) NOPASSWD: /usr/sbin/change_hostname.sh
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you only need to do change the hostname until the next reboot, many linux system can change it with:</p>
<pre><code>import subprocess
subprocess.call(['hostname', 'newhost'])
</code></pre>
<p>or with less typing but some potential pitfalls:</p>
<pre><code>import os
os.system('hostname %s' % 'newhost')
</code></pre>
</div>
<span class="comment-copy">Thanks for this</span>
