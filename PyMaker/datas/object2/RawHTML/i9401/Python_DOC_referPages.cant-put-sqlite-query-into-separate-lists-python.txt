<div class="post-text" itemprop="text">
<p>I have sqlite and I query two columns from a table like this: </p>
<pre><code>result_set = conn.execute("SELECT time, MeanCurrent from MEASUREMENTS")
</code></pre>
<p>then, I want to put each column into a separate list, what I'm doing so far is this: </p>
<pre><code>list1 = [record[0] for record in result_set]
list2 = [record[1] for record in result_set]
</code></pre>
<p>The problem is that, while list1 prints the first column perfectly, list2 appears empty, while, if I remove the first line, list2 prints the second column perfectly as well!</p>
<p>So it's like, after the first line execution, something changes in my query but I don't know what.</p>
<p>Is there any way to deal with this?</p>
</div>
<div class="post-text" itemprop="text">
<p><code>conn.execute()</code> returns a cursor object. You can't iterate over a cursor more than once; when you reach the end, it won't start at the beginning again when iterating a second time. Either load all rows into a list first, or use a different technique that only needs to iterate <em>once</em>. </p>
<p>I'd use the <a href="https://docs.python.org/3/library/functions.html#zip" rel="nofollow noreferrer"><code>zip()</code> function</a> to pair up columns:</p>
<pre><code>list1, list2 = zip(*result_set)
</code></pre>
<p>but you could use <code>results = list(result_set)</code> or <code>results = result_set.fetchall()</code> to materialise all rows into a list first, or you could use a single loop that uses <code>list1.append()</code> and <code>list2.append()</code> to add the column values to the two lists.</p>
</div>
<span class="comment-copy">I don't know enough Python to express this with actual syntax, but I would define the arrays, then have a loop to iterate over the <code>result_set</code> and <code>push</code> the fields of the <code>record</code> into the list arrays.</span>
<span class="comment-copy">Thank you very much, spent so much time trying to figure this out!</span>
