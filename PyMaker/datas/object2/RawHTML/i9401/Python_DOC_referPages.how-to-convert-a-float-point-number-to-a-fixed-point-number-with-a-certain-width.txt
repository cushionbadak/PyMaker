<div class="post-text" itemprop="text">
<p>I need a function to convert a float number to a fixed-point number, represented in binary so that I can put it to the hardware accelerator which can only accept fix-point number. for example, when I input a float number 5.625, giving data width 8, precision 4(4 bits for mantissa), it will return b'01011010, or h'5a or d'90. Is there any functions like this in python libraries?</p>
</div>
<div class="post-text" itemprop="text">
<p>That's the same as multiplying by 16 and converting to an int.</p>
<pre><code>&gt;&gt;&gt; int(5.625 * (2 ** 4))
90
</code></pre>
<p>The 16 depends on the number of bits in the precision, but it's easily calculated.</p>
<p>If the number has to go in multiple bytes (like 2 or 4), use the <code>struct</code> module. E.g. for 300.625 with 32 data bits, 8 of which are precision:</p>
<pre><code>&gt;&gt;&gt; int(300.625 * (2**8))
76960
&gt;&gt;&gt; struct.pack('I', 76960)  # 'I' is 4-byte unsigned int
b'\xaa,\x01\x00'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Try to use <a href="https://docs.python.org/3/library/decimal.html" rel="nofollow noreferrer">decimal</a> module.</p>
<p>You may pass it a float formatted as a string with required format and precision:</p>
<pre><code>&gt;&gt;&gt; from decimal import Decimal

&gt;&gt;&gt; '{:5f}'.format(10.0)
'10.000000'

&gt;&gt;&gt; Decimal('{:5f}'.format(10.0))
Decimal('10.000000')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>def float2fix(val, width, precision):
    integer = abs(int(val * 2 ** precision))
    if val &lt; 0:
        integer = 2 ** (width-1) - integer
    if val &gt;= 0:
        fix_str = bin(integer).replace('0b', '').rjust(width, '0')
    else:
        fix_str = '1'+bin(integer).replace('0b', '').rjust(width-1, '0')
    return fix_str
</code></pre>
</div>
<span class="comment-copy">Try the built-in <code>Decimal</code> module: <a href="https://docs.python.org/3.5/library/decimal.html" rel="nofollow noreferrer">docs.python.org/3.5/library/decimal.html</a></span>
<span class="comment-copy">see <a href="http://stackoverflow.com/questions/422247/fixed-point-arithmetic">stackoverflow.com/questions/422247/fixed-point-arithmetic</a></span>
<span class="comment-copy">that works perfectly! Thank you!</span>
<span class="comment-copy">On this site, show your appreciation by upvoting all the useful answers. You do that by clicking the up-arrow at the top-left of the answer. In addition, accept the best answer (if it actually answers your question) by clicking the checkmark near the top-left of the answer. That is better than saying thanks in a comment. It also helps others to see that your question was answered.</span>
<span class="comment-copy">Don't see how that helps with the binary format he's describing.</span>
<span class="comment-copy">As a way to prepare to real format. Next step tweak to topic starter format with Decimal Contexts.</span>
<span class="comment-copy">But the precision you can set with decimal context is in number of base-10 digits, it never maps exactly to a number of bits.</span>
