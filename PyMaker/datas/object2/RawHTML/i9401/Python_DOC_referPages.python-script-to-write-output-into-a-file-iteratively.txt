<div class="post-text" itemprop="text">
<p>First of all I am a newbie, and has no background on coding.</p>
<p>i am trying to create a python script that will create an xml api file which can be used later,</p>
<p>i have a csv file where each line is for one api call. I might have 200+ such lines. 
I am trying to read one line at time and print the xml data into a file, lets say file-1.xml </p>
<p>I can print the data with out any issues, but I could not find a way to redirect this output a file which should be named iteratively (e.g for i in range(1..200) or something)</p>
<pre><code>#!/usr/bin/python
import csv
with open('file.csv', 'r') as f:
    reader = csv.reader(f)
    for row in reader:
        length=len(row)
        print """&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
      &lt;value&gt;
       &lt;array&gt;
        &lt;data&gt;
         &lt;value&gt;&lt;i4&gt;%s&lt;/i4&gt;&lt;/value&gt;
         &lt;value&gt;&lt;i4&gt;%s&lt;/i4&gt;&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;&lt;i4&gt;%s&lt;/i4&gt;&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
         &lt;value&gt;&lt;i4&gt;%s&lt;/i4&gt;&lt;/value&gt;
         &lt;value&gt;%s&lt;/value&gt;
        &lt;/data&gt;
       &lt;/array&gt;
      &lt;/value&gt;
     &lt;/member&gt;
    &lt;/struct&gt;
   &lt;/value&gt;
  &lt;/param&gt;
 &lt;/params&gt;
&lt;/methodCall&gt;
                    """ % tuple(row)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The <code>csv.reader</code> class has a line number attribute for each row: <code>line_num</code>. Simply use <code>reader.line_num</code> as part of the file name like</p>
<pre><code>for row in reader:
    with open('file-{0}.xml'.format(reader.line_num), 'w+') as out:
        xml_template = "..."    # Put your xml template here
        out.write(xml_template % tuple(row))
</code></pre>
<p>No fancy extra code needed.
This does assume, though, that each request is on its own, single line.</p>
<p>Also, with new formatting guidelines, it is customary to use the {0} and .format style of string formatting. So instead of <code>%s</code> all through your template and <code>% tuple(row)</code> at the end, use <code>{0}</code> and <code>.format(tuple(row))</code> at the end. Just a suggestion, though. See <a href="https://www.python.org/dev/peps/pep-3101/" rel="nofollow noreferrer">PEP 3101</a>.</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>import csv
with open('file.csv', 'r') as f:
    reader = csv.reader(f)
    for i, row in enumerate(reader, start=1):
        with open('file-{}.xml'.format(i), 'w+') as outfile:
            outfile.write(pattern % tuple(row)) #for brevity omitted template
</code></pre>
<p>You just need to open the file and <code>write</code> to it, much like you read from files. To keep track of which number we're on, we'll use <a href="https://docs.python.org/3/library/functions.html#enumerate" rel="nofollow noreferrer"><code>enumerate</code></a></p>
</div>
