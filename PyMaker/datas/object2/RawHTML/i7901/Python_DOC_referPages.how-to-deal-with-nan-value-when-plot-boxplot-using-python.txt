<div class="post-text" itemprop="text">
<p>I am using matplotlitb to plot a box figure but there are some missing values (NaN). Then I found it doesn't display the box figure within the columns having NaN values. 
Do you know how to solve this problem? 
Here are the codes.</p>
<pre><code>import numpy as np
import matplotlib.pyplot as plt

#==============================================================================
# open data
#==============================================================================
filename='C:\\Users\\liren\\OneDrive\\Data\\DATA in the first field-final\\ks.csv'

AllData=np.genfromtxt(filename,delimiter=";",skip_header=0,dtype='str')

TreatmentCode = AllData[1:,0]
RepCode = AllData[1:,1]
KsData= AllData[1:,2:].astype('float')
DepthHeader = AllData[0,2:].astype('float')
TreatmentUnique = np.unique(TreatmentCode)[[3,1,4,2,8,6,9,7,0,5,10],]
nT = TreatmentUnique.size#nT=number of treatments
#nD=number of deepth;nR=numbers of replications;nT=number of treatments;iT=iterms of treatments
nD = 5
nR = 6
KsData_3D = np.zeros((nT,nD,nR)) 

for iT in range(nT):
    Treatment = TreatmentUnique[iT]

    TreatmentFilter = TreatmentCode == Treatment

    KsData_Filtered = KsData[TreatmentFilter,:]

    KsData_3D[iT,:,:] = KsData_Filtered.transpose()iD = 4

fig=plt.figure()
ax = fig.add_subplot(111)
plt.boxplot(KsData_3D[:,iD,:].transpose())
ax.set_xticks(range(1,nT+1))
ax.set_xticklabels(TreatmentUnique)
ax.set_title(DepthHeader[iD])
</code></pre>
<p>Here is the final figure and some of the treatments are missing the box.</p>
<p><img alt="enter image description here" src="https://i.stack.imgur.com/GsLLW.png"/></p>
</div>
<div class="post-text" itemprop="text">
<p>You can remove the <code>NaN</code>s from the data first, then plot the filtered data.</p>
<p>To do that, you can first find the <code>NaN</code>s using <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.isnan.html" rel="noreferrer"><code>np.isnan(data)</code></a>, then perform the bitwise inversion of that boolean array using the <a href="https://docs.python.org/3/library/operator.html#mapping-operators-to-functions" rel="noreferrer"><code>~</code> operator</a>. Use that to index the data array, and you filter out the <code>NaN</code>s. </p>
<pre><code>filtered_data = data[~np.isnan(data)]
</code></pre>
<p>In a complete example (adapted from <a href="https://matplotlib.org/examples/pylab_examples/boxplot_demo.html" rel="noreferrer">here</a>) </p>
<h3>For 1D data:</h3>
<pre><code>import matplotlib.pyplot as plt
import numpy as np

# fake up some data
spread = np.random.rand(50) * 100
center = np.ones(25) * 50
flier_high = np.random.rand(10) * 100 + 100
flier_low = np.random.rand(10) * -100
data = np.concatenate((spread, center, flier_high, flier_low), 0)

# Add a NaN
data[40] = np.NaN

# Filter data using np.isnan
filtered_data = data[~np.isnan(data)]

# basic plot
plt.boxplot(filtered_data)

plt.show()
</code></pre>
<h3>For 2D data:</h3>
<p>For 2D data, you can't simply use the mask above, since then each column of the data array would have a different length. Instead, we can create a list, with each item in the list being the filtered data for each column of the data array.</p>
<p>A list comprehension can do this in one line: <code>[d[m] for d, m in zip(data.T, mask.T)]</code></p>
<pre><code>import matplotlib.pyplot as plt
import numpy as np

# fake up some data
spread = np.random.rand(50) * 100
center = np.ones(25) * 50
flier_high = np.random.rand(10) * 100 + 100
flier_low = np.random.rand(10) * -100
data = np.concatenate((spread, center, flier_high, flier_low), 0)

data = np.column_stack((data, data * 2., data + 20.))

# Add a NaN
data[30, 0] = np.NaN
data[20, 1] = np.NaN

# Filter data using np.isnan
mask = ~np.isnan(data)
filtered_data = [d[m] for d, m in zip(data.T, mask.T)]

# basic plot
plt.boxplot(filtered_data)

plt.show()
</code></pre>
<p>I'll leave it as an exercise to the reader to extend this to 3 or more dimensions, but you get the idea.</p>
</div>
<span class="comment-copy">Replace the NaN values or filter out the data which does not have Nan</span>
<span class="comment-copy">@ERIC please take the <a href="https://stackoverflow.com/tour">tour</a>, read <a href="https://stackoverflow.com/questions/how-to-ask">How to Ask</a> and <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a>. Then update your question to provide the needed detail, such that someone can help you.</span>
<span class="comment-copy">Well, it's not really a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a>, but at least it shows the problem. Next time, please invent some arbitrary data inside the code to make the example complete and verifiable.</span>
<span class="comment-copy">Thanks, it works quite well in one dimension but not in 2 and 3 dimensions.</span>
<span class="comment-copy">@ERIC, See my edit for 2D data.</span>
<span class="comment-copy">(and note that your data is 2D, not 3D, since you slice the data with <code>[:, iD, :]</code>)</span>
<span class="comment-copy">Since boxplot can only show 1D and 2D data and since there is no version of boxplot in the mplot3d toolkit, it's a bit unclear where this excercise for the reader may lead to.</span>
<span class="comment-copy">Thanks Tom. Really helpful.</span>
