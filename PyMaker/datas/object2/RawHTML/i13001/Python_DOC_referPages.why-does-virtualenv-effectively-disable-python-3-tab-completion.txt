<div class="post-text" itemprop="text">
<p>When I create an python3 virtual-env, tab-completion (default with python3) does not work any more. Why is that?</p>
<pre><code>virtualenv -p /usr/bin/python3 --system-site-packages ~/venv3.site
. ~/venv3.site/bin/activate
</code></pre>
<p>Without <code>--system-site-packages</code> it has the same problem: no tab-completion. If I run <code>python3</code> without any virtual-env activated, tab-completion works.</p>
</div>
<div class="post-text" itemprop="text">
<p>Quoting Carl Meyer on <a href="https://github.com/pypa/virtualenv/issues/228#issuecomment-4165148" rel="noreferrer">this GitHub comment</a>,</p>
<blockquote>
<p>Yes, one of the uglier aspects of virtualenv's implementation is that it has to have its own copy of the site module, which is used for all virtualenvs regardless of which version of Python they are created with.</p>
</blockquote>
<p>The problem is in the <code>$VIRTUAL_ENV/lib/python3.4/site.py</code> file, which does not setup tab completion. It does not provide the <code>enablerlcompleter</code> function. Compare it with the <a href="https://github.com/python/cpython/blob/3.4/Lib/site.py#L383" rel="noreferrer">site.py</a> file distributed with Python 3.</p>
<p>If you're using Python 3.3 or newer, I advise <a href="https://docs.python.org/3/library/venv.html" rel="noreferrer">pyvenv</a> instead of <code>virtualenv</code>.</p>
<pre><code>python3 -mvenv ~/venv3.site
</code></pre>
<p>Another thing you could do is roll your own Python startup script and refer to it in the <code>PYTHONSTARTUP</code> environment variable. Put tab completion and other startup tweaks in there. See Mike Covington's answer for an example of such script.</p>
</div>
<div class="post-text" itemprop="text">
<p>This is how I got my tab-completion back:</p>
<p>Added the following to <code>~/.pythonrc.py</code>:</p>
<pre><code>try:
    import readline
except ImportError:
    print("Module readline not available.")
else:
    import rlcompleter
    readline.parse_and_bind("tab: complete")
</code></pre>
<p>Added the following to <code>~/.bash_profile</code>:</p>
<pre><code>export PYTHONSTARTUP=$HOME/.pythonrc.py
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Sticking with <code>virtualenv</code> (Python 3.6 installed with brew on Mac OS X High Sierra)...
In my virtualenv I did <code>pip install readline</code>
I tried to add the <code>~/.pythonrc</code> to my <code>~/.bash_profile</code> but it was not the issue. <code>.virtualenvs/py3cv4/lib/python3.6/readline.so</code> was looking for <code>/usr/local/opt/readline/lib/libreadline.7.dylib</code> but for some reason I had 8. </p>
<p>I created the link</p>
<p><code>ln -s /usr/local/opt/readline/lib/libreadline.8.dylib /usr/local/opt/readline/lib/libreadline.7.dylib</code></p>
<p>No need to add anything to <code>~/.bash_profile</code></p>
</div>
<div class="post-text" itemprop="text">
<p>I got into similar situation. It might be caused by a different reason. But I just want to keep it here so that other people would not spent another one day to debug through this. </p>
<p>I am using Ubuntu 16.04 LTS, Python 3.5.2 with pyvenv, Virtualenv 15.1.0. I kept getting "<strong>tab &amp; then terminal disappear</strong>" problem. In some of batch files that I did "source ", I had "set -e". Apparently, when you do "set -e" in that terminal session, the autocomplete will terminate that terminal window. Remove the "set -e" from those batch files, the issue was resolved.</p>
</div>
<div class="post-text" itemprop="text">
<p>The previously mentioned solutions didn't work for me (Python 3.6 installed with brew on <strong>Mac OS X High Sierra</strong>).</p>
<p>So I had to slightly change my <code>~/.pythonrc.py</code> file:</p>
<pre><code>import readline
import rlcompleter
readline.parse_and_bind('bind ^I rl_complete')
</code></pre>
<p>And of course, you still need this line in your <code>~/.bash_profile</code>:</p>
<pre><code>export PYTHONSTARTUP=$HOME/.pythonrc.py
</code></pre>
<p>On Ubuntu, rather use:</p>
<pre><code>import readline
import rlcompleter
readline.parse_and_bind("tab: complete")
</code></pre>
</div>
<span class="comment-copy">Somehow, I got the same problem as virtualenv when I used pyvenv.</span>
<span class="comment-copy">Wait... I cannot use tabs at the beginning of lines then...</span>
<span class="comment-copy">@FrederickZhang Weird. I'm able to. Which versions of python and headline are you using?</span>
<span class="comment-copy"><code>Python 2.7.14</code> and <code>readline==6.2.4.1</code></span>
<span class="comment-copy">Doesn't seem to work with <code>python -i somescript.py</code>, but only under virtualenvs. The <code>.pythonrc.py</code> is executed, including the necessary <code>parse_and_bind</code> function, but tab is back to inserting tabs.</span>
<span class="comment-copy">I am posting the only solution that actually worked for me on Mac OS X, I don't really understand why is it down-voted, while it could help people in the same situation as I wasâ€¦</span>
