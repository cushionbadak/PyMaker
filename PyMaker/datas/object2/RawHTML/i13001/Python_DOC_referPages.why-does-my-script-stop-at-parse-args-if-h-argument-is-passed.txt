<div class="post-text" itemprop="text">
<p>I tried to run the following script to know what's inside the namespace returned by <code>command.parse_args()</code>.</p>
<pre><code>#!/usr/bin/python3                                 

import argparse

command = argparse.ArgumentParser()
command.add_argument("test")

print("test1")
args = command.parse_args()
print("test2")
print(args)
</code></pre>
<p>If I run a "complete" command (like <code>./test.py 1</code>) everything is ok and the Namespace is displayed.</p>
<p>But if I do something like <code>./test.py -h</code> it fails and stops at <code>args = 
command.parse_args()</code>, <code>print("Test2")</code> isn't called.</p>
<p>I got no error. But the rest of the script isn't interpreted.</p>
<p>Why?</p>
<p>Is there some kind of error this way?</p>
<p>Is <code>./test.py -h</code> invalid for some reason (Even if it seems to work fine)?</p>
<p>Does <code>args = command.parse_args()</code> cause an exit before the script's end?</p>
</div>
<div class="post-text" itemprop="text">
<p>By default, <a href="https://docs.python.org/3/library/argparse.html#add-help" rel="nofollow">help options are added</a> to the argument parser. Then, when the help argument is passed, the help action is invoked which will print the help, and then end the program execution.</p>
<p>If you donâ€™t want that to happen, you need to set the <code>add_help</code> argument to <code>False</code> but that will also stop the argument parser from providing a help functionality.</p>
<p>The exit behavior is pretty obvious if you actually look at the help text that is printed:</p>
<pre><code>-h, --help  show this help message and exit
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Take a look at argparse.py source code.</p>
<p><a href="https://github.com/python/cpython/blob/master/Lib/argparse.py#L1007" rel="nofollow">https://github.com/python/cpython/blob/master/Lib/argparse.py#L1007</a></p>
<p>The argparse has the default help <code>-h</code>, which is an action to show the help and exit.</p>
<p>The <code>_HelpAction.__call__</code> handle this action.</p>
</div>
<span class="comment-copy"><code>-h</code> means "show the help info and then exit". So it exits.</span>
<span class="comment-copy">@khelwood It seems to be that indeed, I didn't know this behaviour. Thank you :)</span>
<span class="comment-copy">The docs are full of examples (I counted 36 on the <a href="https://docs.python.org/3/library/argparse.html" rel="nofollow noreferrer">argparse</a> page) and that message is also printed when you call your script with the <code>-h</code> option. Kind of hard to miss...</span>
<span class="comment-copy">@TimPietzcker I mean I knew for the help displaying but not for the exit.</span>
<span class="comment-copy">The 'exit' part is burried in the 'help' subsection of <a href="https://docs.python.org/3/library/argparse.html#action" rel="nofollow noreferrer">docs.python.org/3/library/argparse.html#action</a></span>
<span class="comment-copy">That's right. My bad.</span>
