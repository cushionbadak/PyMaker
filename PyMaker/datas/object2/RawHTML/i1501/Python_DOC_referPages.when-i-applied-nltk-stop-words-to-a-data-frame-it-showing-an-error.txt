<div class="post-text" itemprop="text">
<pre><code>  Reviews                                               Label
0   Bromwell High is a cartoon comedy. It ran at t...   Positive
1   Homelessness (or Houselessness as George Carli...   Positive
2   Brilliant over-acting by Lesley Ann Warren. Be...   Positive
</code></pre>
<p>The above one is my data frame with columns: Reviews and Label When I excecuted the code below : `</p>
<pre><code>nltk.download('stopwords') This is used to update stop words.
from nltk.corpus import stopwords
stop = stopwords.words('english')
final_without_stopwords = final[['Reviews','Label']].apply(lambda x: ' '.join([word for word in x.split() if word not in (stop)])).str.replace('[^\w\s]','')
print(final_without_stopwords)`
</code></pre>
<p>Result:</p>
<pre><code>KeyError                                  Traceback (most recent call last)
~\Anaconda3\lib\site-packages\pandas\core\indexes\base.py in get_loc(self, key, method, tolerance)
   3077             try:
-&gt; 3078                 return self._engine.get_loc(key)
   3079             except KeyError:

pandas\_libs\index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas\_libs\index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas\_libs\hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas\_libs\hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: ('Reviews', 'Label')

During handling of the above exception, another exception occurred:

KeyError                                  Traceback (most recent call last)
&lt;ipython-input-52-cb4ca290db84&gt; in &lt;module&gt;()
      5 #final['Reviews'].apply(lambda x: ' '.join([word for word in x.split() if word not in (stop_words)]))
      6 
----&gt; 7 final_without_stopwords = final['Reviews','Label'].apply(lambda x: ' '.join([word for word in x.split() if word not in (stop)])).str.replace('[^\w\s]','')
      8 print(final_without_stopwords)

~\Anaconda3\lib\site-packages\pandas\core\frame.py in __getitem__(self, key)
   2686             return self._getitem_multilevel(key)
   2687         else:
-&gt; 2688             return self._getitem_column(key)
   2689 
   2690     def _getitem_column(self, key):

~\Anaconda3\lib\site-packages\pandas\core\frame.py in _getitem_column(self, key)
   2693         # get column
   2694         if self.columns.is_unique:
-&gt; 2695             return self._get_item_cache(key)
   2696 
   2697         # duplicate columns &amp; possible reduce dimensionality

~\Anaconda3\lib\site-packages\pandas\core\generic.py in _get_item_cache(self, item)
   2487         res = cache.get(item)
   2488         if res is None:
-&gt; 2489             values = self._data.get(item)
   2490             res = self._box_item_values(item, values)
   2491             cache[item] = res

~\Anaconda3\lib\site-packages\pandas\core\internals.py in get(self, item, fastpath)
   4113 
   4114             if not isna(item):
-&gt; 4115                 loc = self.items.get_loc(item)
   4116             else:
   4117                 indexer = np.arange(len(self.items))[isna(self.items)]

~\Anaconda3\lib\site-packages\pandas\core\indexes\base.py in get_loc(self, key, method, tolerance)
   3078                 return self._engine.get_loc(key)
   3079             except KeyError:
-&gt; 3080                 return self._engine.get_loc(self._maybe_cast_indexer(key))
   3081 
   3082         indexer = self.get_indexer([key], method=method, tolerance=tolerance)

pandas\_libs\index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas\_libs\index.pyx in pandas._libs.index.IndexEngine.get_loc()

pandas\_libs\hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

pandas\_libs\hashtable_class_helper.pxi in pandas._libs.hashtable.PyObjectHashTable.get_item()

KeyError: ('Reviews', 'Label')
    enter code here
</code></pre>
<p>**</p>
<blockquote>
<p>Actually I want to apply stop words to my data frame which only has two columns. When I excecuted this code with single column (Reviews) it worked well
  but when I excecuted with two columns (Reviews &amp; Label) it is showing
  some error. Any suggestions how to handle this code with both columns.</p>
</blockquote>
<p>**</p>
</div>
<div class="post-text" itemprop="text">
<p>If you want to apply a function elementwise to the dataframe, use <code>applymap</code>:</p>
<p>A simplified example:</p>
<pre><code>import pandas as pd

stop = set(['a','the','i','is'])
df = pd.DataFrame( {'sentence1':['i am a boy','i am a girl'],
                    'sentence2':['Bromwell High is a cartoon comedy','i am a girl']})

df[['sentence1','sentence2']].applymap(lambda x: ' '.join(i for i in x.split() if i not in stop))


   sentence1    sentence2
0   am boy       Bromwell High cartoon comedy
1   am girl      am girl
</code></pre>
<p>If you want to reassign the values without stopwords into your dataframe, use:</p>
<pre><code>df[['sentence1','sentence2']] = df[['sentence1','sentence2']].applymap(lambda x: ' '.join(i for i in x.split() if i not in stop))
</code></pre>
</div>
<span class="comment-copy">Did you mean to do something like <code>final['Reviews_n'] = final[[Reviews'].apply(lambda x: ' '.join...</code>? Why would you want to remove stopwords from <code>Label</code>?</span>
<span class="comment-copy">@BernardL Sir, in the above data frame there are only two columns but if there are multiple columns how to apply <b>Stop Words</b> to all columns?  I actually tested with <b>Label</b> Column but it throwing an error. I want to work with multiple columns. Is it possible Sir?</span>
<span class="comment-copy">Yes, it is possible, refer to my answer below.</span>
<span class="comment-copy">sir it worked fine. Thank you so much. It would be very helpful if you can suggest good resources to learn in-depth knowledge of python.</span>
<span class="comment-copy">Read documentation. For <a href="https://docs.python.org/3/" rel="nofollow noreferrer">Python</a> and <a href="https://pandas.pydata.org/pandas-docs/stable/" rel="nofollow noreferrer">Pandas</a>, it might be a bit dry just reading it, but work along with it and always have them open when you are coding.</span>
