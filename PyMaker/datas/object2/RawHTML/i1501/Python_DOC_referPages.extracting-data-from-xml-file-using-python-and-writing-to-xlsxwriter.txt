<div class="post-text" itemprop="text">
<p>I am trying to extract the output of a XML file using python and write it to excel sheet using xlsxwriter module.</p>
<p>Given below is the code I have tried:</p>
<pre><code>row = 4
col = 0
row1 = 5
col1 = 0

for elem in tree.iter():
    worksheet1.write(row, col, elem.tag)
    for subelem in elem:
        worksheet1.write(row1, col1, subelem.text)
    col += 1
    col1 +=1
</code></pre>
<p>The above returns values headers but does not return any of the corresponding values. </p>
<p>I am trying to store it such that first row has the list of all labels and row 2 has the corresponding data as provided in the xml file.</p>
<p>Data I am trying to work is:</p>
<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;PARENT&gt;
  &lt;CHILD&gt;
&lt;Action&gt;add&lt;/Action&gt;
&lt;BillNo&gt;6446&lt;/BillNo&gt;
&lt;CustomerID/&gt;
&lt;Customer&gt;
  &lt;Name/&gt;
  &lt;CustCode&gt;ABC&lt;/CustCode&gt;
&lt;/Customer&gt;
&lt;Remarks&gt;
  &lt;Remark&gt;
HELLO&lt;/Remark&gt;
  &lt;Remarks&gt;123&lt;/Remarks&gt;
&lt;/Remarks&gt;
&lt;Store&gt;sf&lt;/Store&gt;
&lt;StoreType/&gt;
&lt;Urgency&gt;false&lt;/Urgency&gt;
&lt;StoreTypes&gt;
  &lt;StoreType&gt;
    &lt;Action&gt;new&lt;/Action&gt;
    &lt;Name&gt;Type1&lt;/Name&gt;
    &lt;StoreID&gt;46433&lt;/StoreID&gt;
    &lt;StopAlias&gt;1&lt;/StopAlias&gt;
    &lt;Type&gt;45643&lt;/Type&gt;
    &lt;Type1&gt;dsff&lt;/Type1&gt;
    &lt;Type2&gt;egrg&lt;/Type2&gt;
    &lt;Type3&gt;geetf&lt;/Type3&gt;
    &lt;Type4/&gt;
    &lt;Type5&gt;khfd&lt;/Type5&gt;
    &lt;Type6&gt;sfgdg&lt;/Type6&gt;
    &lt;Type7&gt;dsfee&lt;/Type7&gt;
  &lt;/StoreType&gt;
&lt;/StoreTypes&gt;
&lt;Category1&gt;
  &lt;CatGroup&gt;
    &lt;Action&gt;new&lt;/Action&gt;
    &lt;D1&gt;hello&lt;/D1&gt;
    &lt;D2&gt;world&lt;/D2&gt;
    &lt;D3&gt;2&lt;/D3&gt;
    &lt;Type&gt;how&lt;/Type&gt;
    &lt;D4&gt;dfvf&lt;/D4&gt;
    &lt;D5&gt;david&lt;/D5&gt;
    &lt;D6&gt;f5453&lt;/D6&gt;
    &lt;D7&gt;this&lt;/D7&gt;
    &lt;D8&gt;is&lt;/D8&gt;
    &lt;D9&gt;a&lt;/D9&gt;
    &lt;Type4/&gt;
    &lt;Feedback/&gt;
    &lt;Customer&gt;
      &lt;F1&gt;test&lt;/F1&gt;
      &lt;F2&gt;remark&lt;/F2&gt;
      &lt;F3&gt;file&lt;/F3&gt;
    &lt;/Customer&gt;
    &lt;R1&gt;
      &lt;RR1&gt;for&lt;/RR1&gt;
      &lt;RR1&gt;test&lt;/RR1&gt;
      &lt;RR1&gt;tested&lt;/RR1&gt;
    &lt;/R1&gt;
  &lt;/CatGroup&gt;
 &lt;/Category1&gt;
 &lt;/CHILD&gt;
 &lt;/PARENT&gt;
</code></pre>
<p>Could anyone advice as to where am I going wrong. I am trying to keep this generic without defining the columns name while looping. Thanks</p>
</div>
<div class="post-text" itemprop="text">
<p>Check out this <a href="https://stackabuse.com/reading-and-writing-xml-files-in-python/" rel="nofollow noreferrer">stackabuse</a> article or this <a href="https://docs.python.org/3/library/xml.etree.elementtree.html" rel="nofollow noreferrer">xml.etree.ElementTree</a> link from the python documentation.</p>
<p>Both contain step by step examples on how to read xml documents.</p>
<p>Here is some example code from the first link:</p>
<pre><code>from xml.dom import minidom

# parse an xml file by name
mydoc = minidom.parse('items.xml')

items = mydoc.getElementsByTagName('item')

# one specific item attribute
print('Item #2 attribute:')  
print(items[1].attributes['name'].value)

# all item attributes
print('\nAll attributes:')  
for elem in items:  
    print(elem.attributes['name'].value)

# one specific item's data
print('\nItem #2 data:')  
print(items[1].firstChild.data)  
print(items[1].childNodes[0].data)

# all items data
print('\nAll item data:')  
for elem in items:  
    print(elem.firstChild.data)
</code></pre>
</div>
