<div class="post-text" itemprop="text">
<p>I am plotting some data and I want to automatically generate a report. I can save the plot and then add it to my document. However, I prefer to do it directly, without saving step. Going through the python-docx documentation I doubt it is doable by this package. Is there another way?</p>
<p>My code looks like this right now</p>
<pre><code>from docx import Document
from docx.shared import Inches
import matplotlib.pyplot as plt
import numpy as np

t = np.arange(0.0, 2.0, 0.01)
s = 1 + np.sin(2*np.pi*t)
plt.plot(t, s)
plt.savefig('test.png')

document = Document()
document.add_heading('Report',0)
document.add_picture('test.png', width=Inches(1.25))

document.save('report.docx')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use StringIO :</p>
<blockquote>
<p>This module implements a file-like class, StringIO, that reads and
  writes a string buffer (also known as memory files).</p>
</blockquote>
<pre><code>from docx import Document
from docx.shared import Inches
import matplotlib.pyplot as plt
import numpy as np
from pandas.compat import StringIO

memfile = StringIO()
t = np.arange(0.0, 2.0, 0.01)
s = 1 + np.sin(2*np.pi*t)
plt.plot(t, s)
plt.savefig(memfile)

document = Document()
document.add_heading('Report',0)
document.add_picture(memfile, width=Inches(1.25))

document.save('report.docx')
memfile.close()
</code></pre>
<p>Python 3 : <a href="https://docs.python.org/3/library/io.html" rel="nofollow noreferrer">https://docs.python.org/3/library/io.html</a></p>
<p>Python 2 : <a href="https://docs.python.org/2/library/stringio.html" rel="nofollow noreferrer">https://docs.python.org/2/library/stringio.html</a></p>
<p>Or use StringIO from <code>pandas.compat</code></p>
</div>
<span class="comment-copy">Thanks. I got it working with io. It is strange though that I get the error "TypeError: string argument expected, got 'bytes'" when using Pandas. I would prefer to use pandas!</span>
<span class="comment-copy">I would prefer io if you use python3 as it is standard</span>
