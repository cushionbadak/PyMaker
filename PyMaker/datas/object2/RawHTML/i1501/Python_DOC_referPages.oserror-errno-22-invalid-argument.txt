<div class="post-text" itemprop="text">
<p>I'm scraping a lot of reviews from a site with Python, for each review I call the "review" function and then open the file and append it to it. It works for a while but then the following error appears me everytime and not it the same review.</p>
<blockquote>
<p>OSError: [Errno 22] Invalid argument</p>
</blockquote>
<p>I tried json.dumps:</p>
<pre><code>scraped_data = reviews(line)
with open('reviews','a' ) as f:
    f.write(json.dumps(scraped_data,f,indent = 4))
</code></pre>
<p>but the same error keeps appearing. I also tried json.dump:</p>
<pre><code>scraped_data = reviews(line)
with open('reviews','a' ) as f:
    json.dump(scraped_data,f,indent = 4))
</code></pre>
<p>and, for some reason, I tried without indent too.</p>
<p>edit: full traceback for json.dumps:</p>
<pre><code>Traceback (most recent call last):
File "s.py", line 202, in &lt;module&gt;
with open('reviews','a' ) as f:
OSError: [Errno 22] Invalid argument: 'reviews' 
</code></pre>
<p>full traceback for json.dump:</p>
<pre><code>Traceback (most recent call last):
File "s.py", line 203, in &lt;module&gt;
json.dump(scraped_data,f,indent = 4)
OSError: [Errno 22] Invalid argument: 'reviews'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>try giving it the full path of the file.</p>
<p>make sure you have permission to write in that directory (whatever user the app is running under)</p>
<p>also, if the file does not already exist, it cannot append to it... instead of <code>a</code> try <code>a+</code></p>
<p>plus sign means if it is not there then create it</p>
</div>
<div class="post-text" itemprop="text">
<p>Why don't you open your file as a variable?</p>
<pre><code>f = open("reviews", "a")
f.write(json.dumps(scraped_data,f,indent = 4))
f.close()
</code></pre>
</div>
<span class="comment-copy">Would you mind to share the full traceback?</span>
<span class="comment-copy">Yes, I edited the question</span>
<span class="comment-copy">I believe this would require further debugging, as it looks like, the problem is not with writing the dump to file but to dump the scraped data in the first place, try printing the scraped data to find out what's causing the problem.</span>
<span class="comment-copy">What's the exact Linux you are running on? The Errno 22 could have platform dependent meaning. I suggest running <code>man 2 open</code>, and reading descriptions for <code>EINVAL</code> messages. The best theory I came up with is <code>O_APPEND</code> (<code>'a'</code>) is somehow badly supported on your system. Try using (<code>'w'</code>), this would overwrite file, but if this works then we know the problem is in <code>'a'</code>.</span>
<span class="comment-copy">Anoter idea just popped into my head: are you using multithreading or multiprocessing or viewing this file form another program? The root of all obscure bugs is concurrency ;)</span>
<span class="comment-copy">I tried, and at least on macOS and Debian 'a' works fine for creating new files...</span>
<span class="comment-copy">see <a href="https://stackoverflow.com/a/46410981/2399138">stackoverflow.com/a/46410981/2399138</a></span>
<span class="comment-copy">:shrug: <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer">docs</a> say that '+' is for <i>reading</i> and writing, but whatevs...</span>
<span class="comment-copy">You are correct @AndrewMorozko if it is not one of those then they are having an error that is either path or permissions related.</span>
<span class="comment-copy">yep, didn't thing of permissions, although there's <code>EACCES</code> for that. Can't we all just agree that errno mechanism is a great solution? Nothing confusing ever happens with it!</span>
<span class="comment-copy">Can you explain how this will solve the OPs problem? Using a Context Manager to handle opening and closing files is ubiquitous.</span>
<span class="comment-copy">This would not change the call to <code>open</code> which produces an error, but would fail to close the file descriptor if something went wrong.</span>
