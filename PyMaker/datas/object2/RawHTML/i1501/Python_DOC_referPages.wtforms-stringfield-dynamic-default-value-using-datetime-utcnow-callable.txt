<div class="post-text" itemprop="text">
<p>I have a WTForm with the following:</p>
<pre><code>class MyForm(FlaskForm):
    ...
    timestamp = DateTimeField("Timestamp", default = datetime.utcnow, validators = [Required()])
    name = StringField("Name", default = str(int(datetime.utcnow().timestamp())), validators = [Optional()])
    ...
</code></pre>
<p>Upon creating a new form the default timestamp field updates as expected while the default name field continues to use the timestamp of when the app was started. I can successfully set the timestamp in my route, my preference is to utilize the default functionality of the form. Looking here:</p>
<p><a href="https://wtforms.readthedocs.io/en/stable/fields.html#the-field-base-class" rel="nofollow noreferrer">The Field base class</a></p>
<p>It states that default "May be a callable." but I haven't been able to find a working example of this. I'm assuming if I make this a callable, the default value will update with current timestamp. Does anyone know how to make default get its value from a function?</p>
<p>Thanks in advance,</p>
<p>Brian</p>
</div>
<div class="post-text" itemprop="text">
<p>In your <code>timestamp</code> field, you provide a callable - <code>datetime.datetime.utcnow</code> to <code>default</code>, so each time the form is instantiated the callable is called and the new result is used.  </p>
<p>In your <code>name</code> field, <code>datetime.datetime.utcnow().timestamp()</code> is evaluated when the form is compiled, so the default value is the same for every instance of the form.</p>
<p>If you want the default value of <code>name</code> to be evaluated every time the form is instantiated, pass it a function (a callable) that returns <code>datetime.datetime.utcnow().timestamp()</code>.</p>
<p>Like this:</p>
<pre><code>def get_default():
    datetime.datetime.utcnow().timestamp()


class MyForm(FlaskForm):
    timestamp = DateTimeField("Timestamp", default=datetime.utcnow, validators=[Required()])
    name = StringField("Name", default=get_default, validators=[Optional()])
</code></pre>
<p>or if you prefer, you can use a <a href="https://docs.python.org/3/tutorial/controlflow.html#lambda-expressions" rel="nofollow noreferrer">lambda</a>:</p>
<pre><code>class MyForm(FlaskForm):
    timestamp = DateTimeField("Timestamp", default=datetime.utcnow, validators=[Required()])
    name = StringField("Name", default=lambda : datetime.datetime.utcnow().timestamp(), validators=[Optional()])
</code></pre>
</div>
