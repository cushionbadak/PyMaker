<div class="post-text" itemprop="text">
<p>I have some code that combines multiple excel workbooks together. What I need to further do is to add a new column with the filename associated with each record. I put a note as to where I think i'm getting caught up.</p>
<p>Here's what I have so far:</p>
<pre><code>import pandas as pd
import os
os.chdir('path')

# filenames
excel_names = [
        "a.xlsx",
        "b.xlsx"
       ]

# read them in
excels = [pd.ExcelFile(name) for name in excel_names]

# turn them into dataframes
frames = [x.parse(x.sheet_names[0], header=None,index_col=None) for x in excels]

# delete the first row for all frames except the first
# i.e. remove the header row -- assumes it's the first
frames[1:] = [df[1:] for df in frames[1:]]

# concatenate them..
combined = pd.concat(frames)

#i'm getting caught up here
combined = pd.concat([pd.read_excel(fp).assign(New=os.path.basename(fp)) for fp in excel_names])

# write it out
combined.to_excel("a and b combined.xlsx", header=False, index=False)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Try this:</p>
<pre><code>#[...]

# i.e. remove the header row -- assumes it's the first
frames[1:] = [df[1:] for df in frames[1:]]

####TO ADD
#add a filename column and put the excel name
for i in range(0,len(frames)):
   frames[i]['filename']=excel_names[i]
##########

# concatenate them..
combined = pd.concat(frames)

#[...]
</code></pre>
</div>
<span class="comment-copy">Another question. Is there a faster way to read all .xlsx files in a directory instead of having to write each file out?</span>
<span class="comment-copy">Absolutely, you may use os.listdir(dir_path) function, take a look on official documentation <a href="https://docs.python.org/3/library/os.html#os.listdir" rel="nofollow noreferrer">docs.python.org/3/library/os.html#os.listdir</a> if required</span>
