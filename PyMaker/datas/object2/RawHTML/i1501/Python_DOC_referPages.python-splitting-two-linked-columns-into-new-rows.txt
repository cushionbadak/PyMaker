<div class="post-text" itemprop="text">
<p>I have the following dataframe:</p>
<pre><code>N1   FF1; FF2                PP1; PP2
N2   FF3                     PP3
N3   FF4; FF5; FF6           PP4; PP5; PP6
</code></pre>
<p>Columns FF &amp; PP have the following relation, every FF is linked to PP with the same number, i.e. FF1 is linked to PP1 and so forth.</p>
<p>The output that I need is as follows:</p>
<pre><code>N1 FF1 PP1
N1 FF2 PP2
N2 FF3 PP3
N3 FF4 PP4
N3 FF5 PP5
N3 FF6 PP6
</code></pre>
<p>So far I have tried the following:</p>
<pre><code>df_copy = df["F","P"].str.split(";").apply(Series,1).stack()
</code></pre>
<p>However I receive a KeyError and am puzzled on how to proceed... </p>
<p>Very new to programming, I'd highly appreciate some guidance.</p>
<p>Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>With Pandas / NumPy, you should use vectorised methods where possible. <code>apply</code> + <code>pd.Series</code> is an inefficient, Python-level loop.</p>
<p>For example, using <a href="https://docs.python.org/3/library/itertools.html#itertools.chain.from_iterable" rel="nofollow noreferrer"><code>itertools.chain</code></a> and <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.repeat.html#numpy.repeat" rel="nofollow noreferrer"><code>np.repeat</code></a>:</p>
<pre><code>from itertools import chain

df = pd.DataFrame([['N1', 'FF1; FF2', 'PP1; PP2'],
                   ['N2', 'FF3', 'PP3'],
                   ['N3', 'FF4; FF5; FF6', 'PP4; PP5; PP6']])

split1, split2 = df[1].str.split('; '), df[2].str.split('; ')
n = split1.str.len()

res = pd.DataFrame({0: df[0].values.repeat(n.values),
                    1: list(chain.from_iterable(split1)),
                    2: list(chain.from_iterable(split2))})

print(res)

    0    1    2
0  N1  FF1  PP1
1  N1  FF2  PP2
2  N2  FF3  PP3
3  N3  FF4  PP4
4  N3  FF5  PP5
5  N3  FF6  PP6
</code></pre>
</div>
<span class="comment-copy">Thank you @jpp for the fast response, much obliged!!</span>
