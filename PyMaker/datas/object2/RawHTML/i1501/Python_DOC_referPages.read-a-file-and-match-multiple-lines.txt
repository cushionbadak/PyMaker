<div class="post-text" itemprop="text">
<p>The text file is like:</p>
<pre><code>    &lt;field&gt;
        &lt;/field&gt;
</code></pre>
<p>I want to match the block and write something in between the two <strong>field</strong> tag. I have got the following code which is from <a href="https://stackoverflow.com/questions/4940032/how-to-search-for-a-string-in-text-files">How to search for a string in text files?</a></p>
<pre><code>!/usr/bin/env python3
import mmap
import os

with open('sample.txt', 'rb+', 0) as file, \
     mmap.mmap(file.fileno(), 0, access=mmap.ACCESS_READ) as s:
    if s.find(b'&lt;field&gt;\n&lt;\field&gt;') != -1:
        file.write("Hello")
</code></pre>
<p>My solution doesn't work even if I use <strong>\t</strong> to detect the tab </p>
<pre><code>'&lt;field&gt;\n\t&lt;\field&gt;'
</code></pre>
<p>I think my issue is how to match multiple lines that have some space or tab in it. Thanks everyone. </p>
</div>
<div class="post-text" itemprop="text">
<p>Please refer to this question: <a href="https://stackoverflow.com/questions/587345/regular-expression-matching-a-multiline-block-of-text">Regular expression matching a multiline block of text</a></p>
<p>Your goal is simple enough using regexes. The following script finds <code>&lt;field&gt;</code> tags in the variable <code>html</code>, and puts <code>&lt;text to put between the tags&gt;</code> in between the tags.</p>
<pre><code>import mmap
import os
import re

# do logic here

# test for what you want from variable s:

a = re.sub('&lt;field&gt;(.*\n*)&lt;\/field&gt;', '&lt;text to put between the tags&gt;', html)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I got the answer from: <a href="https://stackoverflow.com/questions/12044927/pythonic-way-of-inserting-lines-to-a-file">Pythonic way of inserting lines to a file</a></p>
<p>The solution doesn't use mmap. That's true we cannot insert data into a file, but we can replace the data.</p>
<pre><code>        target = "&lt;field&gt;Hello&lt;/field&gt;"

        with open(os.path.join(root, filename), 'r') as file:
            filedata = file.read()

        # Replace the target string
        filedata = filedata.replace('&lt;field&gt;&lt;/field&gt;', target)

        # Write the file out again
        with open(os.path.join(root, filename), 'w') as file:
            file.write(filedata)
</code></pre>
</div>
<span class="comment-copy">(1) You can't insert data into a file, you have to rewrite it at least from insertion point to the end. (2) You call <code>find</code> but didn't use the position returned by it. (3) The position returned by <code>find</code> would be at beginning of <code>b'&lt;field&gt;</code>. (4) If you are a beginner in Python you should start with something simpler: <a href="https://docs.python.org/3/tutorial/" rel="nofollow noreferrer">docs.python.org/3/tutorial</a></span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/587345/regular-expression-matching-a-multiline-block-of-text">Regular expression matching a multiline block of text</a></span>
<span class="comment-copy">You must refer to the mmaped file: mm= mmap.mmap(file.fileno(),...) . See the documentation, here is an example, too: <a href="https://docs.python.org/3/library/mmap.html" rel="nofollow noreferrer">docs.python.org/3/library/mmap.html</a></span>
