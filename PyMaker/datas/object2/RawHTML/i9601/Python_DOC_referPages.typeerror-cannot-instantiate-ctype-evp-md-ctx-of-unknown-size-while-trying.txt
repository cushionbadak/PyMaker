<div class="post-text" itemprop="text">
<p>Below is the code</p>
<pre><code>import httplib2, argparse, os, sys, json
from oauth2client import tools, file, client
from oauth2client.service_account import ServiceAccountCredentials
from googleapiclient import discovery
from googleapiclient.errors import HttpError

scope = ['https://www.googleapis.com/auth/prediction','https://www.googleapis.com/auth/devstorage.read_only']

def get_api(api, scope, service_account=True):
     storage = file.Storage('oAuth2.json')
     creds = storage.get()

     if creds is None or creds.invalid:
        creds = ServiceAccountCredentials.from_json_keyfile_name('service_account.json',
                                                             scopes=scope)
        storage.put(creds)

     http = creds.authorize(httplib2.Http())
     return discovery.build(api, 'v1.6', http=http)

api = get_prediction_api('prediction')
</code></pre>
<p>Below is the error</p>
<blockquote>
<p>TypeError: cannot instantiate ctype 'EVP_MD_CTX' of unknown size</p>
</blockquote>
<p>Based on this <a href="http://cloudacademy.com/blog/google-prediction-api/" rel="nofollow noreferrer">blog</a></p>
<p>Using this <a href="https://github.com/google/google-api-python-client" rel="nofollow noreferrer">google-api-python-client</a></p>
</div>
<div class="post-text" itemprop="text">
<p>I found this post <a href="https://github.com/google/oauth2client/issues/641" rel="nofollow noreferrer">oauth2client</a> relating the problem, in my case the problem was solved updating to latest version of pyOpenSSL, 16.2.0 at the time of writing.</p>
</div>
<div class="post-text" itemprop="text">
<p>The google-api-python-client that I installed (link above) only works with python2. As of today, it doesn't work with python2 inside of conda env, only outside of conda env, and doesn't work with python 3.5.</p>
</div>
<div class="post-text" itemprop="text">
<p>I don't have the points to upvote but Chemary's answer worked for me. I am using python 3.5. I faced the same issue and it got resolved when I installed pyOpenSSL.</p>
<pre><code>pip install --upgrade pyOpenSSL
</code></pre>
</div>
<span class="comment-copy">Should've asked earlier, but which python version did you use? and did you use conda venv or python venv?</span>
<span class="comment-copy">do you have a reference for that? The <a href="https://github.com/google/google-api-python-client" rel="nofollow noreferrer">github page</a> says it's fully compatible with Python 3.4 and <code>This library may work on later versions of 3, but we do not currently run tests against those versions.</code> I'm just surprised that it would work on 3.4 and not 3.5</span>
<span class="comment-copy">Hmm I have a similar experience, this error does go away when I try python 2.7</span>
<span class="comment-copy">Actually I have this working now in Anaconda Python 3.5.2. Unfortunately I don't have the exact steps but I believe it was <code>pip install pyopenssl</code> and making sure <code>GOOGLE_APPLICATION_CREDENTIALS</code> was set</span>
<span class="comment-copy">I didn't have any reference as in blogs/articles, but I tried it out on my own. My thought exactly like yours after I read the github page. I didn't upgrade pyopenssl, so maybe that's why it didn't work for python 3.5 inside conda for me. Did you install or upgrade pyopenssl and is it inside of conda env ? I have pyopenssl 16.0.0, and it looks like I need to upgrade it to 16.2.0 according to @Chemary above</span>
<span class="comment-copy">no that is a difference, I'm using python <a href="https://docs.python.org/3/library/venv.html" rel="nofollow noreferrer">venv</a> but I was getting the same error</span>
