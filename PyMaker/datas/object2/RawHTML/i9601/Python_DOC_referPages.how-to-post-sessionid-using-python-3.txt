<div class="post-text" itemprop="text">
<p>I'm a noob and I need to use the sessionid to post other commands like search.do, Im using Python 3.5 but Im not sure the best way to get and post it.
here is how I posted the request. </p>
<pre><code>import urllib.parse

url = 'https://myapi.application.com/dmapi/login.do'
values = {'account' : 'MYACCOUNT', 'username': 'admin', 'password':     'pas1234', 'appid':'12346'}

data = urllib.parse.urlencode(values)
data = data.encode('utf-8') # data should be bytes
req = urllib.request.Request(url, data)
resp = urllib.request.urlopen(req)
respData = resp.read()


print(respData)
</code></pre>
<p>printing gets this result.</p>
<pre><code>b'errorcode=0\r\nsessionid=ef9a9cbd-e063-4be2-9301-9de59891304c\r\n'
</code></pre>
<p>I need to use the sessionid in subsequent request.  Whats the best way to go about this. </p>
</div>
<div class="post-text" itemprop="text">
<p>In fact the response in composed of lines (in bytes) one of which contains the session id. You could simply read and parse what you get:</p>
<pre><code>resp = urllib.request.urlopen(req)
errorcode = None
sessionid = None
for line in resp.read():
    line = line.strip()   # remove end of line
    if line.startswith(b'errorcode'):
        errorcode = line.split(b'=')[1]
    if line.startswith(b'sessionid'):
        sessionid = line.split(b'=')[1]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>One idea is to <a href="https://docs.python.org/3/library/stdtypes.html#str.split" rel="nofollow noreferrer">split</a> by <code>sessionid=</code> and extract the last item:</p>
<pre><code>&gt;&gt;&gt; respData.split("sessionid=")[-1].strip()
'ef9a9cbd-e063-4be2-9301-9de59891304c'
</code></pre>
<p>Another, is to use a regular expression:</p>
<pre><code>&gt;&gt;&gt; import re
&gt;&gt;&gt;
&gt;&gt;&gt; re.search(r"sessionid=([A-Za-z0-9-]+)", respData).group(1)
'ef9a9cbd-e063-4be2-9301-9de59891304c'
</code></pre>
</div>
