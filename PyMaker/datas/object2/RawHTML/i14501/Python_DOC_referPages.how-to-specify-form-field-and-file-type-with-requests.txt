<div class="post-text" itemprop="text">
<p>I want to upload an image using requests module (Python 3). Sadly, the server answers my request with an error, saying that I should only upload files of type jpg, png or gif. 
I guess I should fill every field of the form, but I want to figure out how despite all my tests.</p>
<p>Here is the HTML form : </p>
<pre><code>&lt;form class="upload" enctype="multipart/form-data" action="?action=upload" method="post"&gt;
            &lt;h3&gt;Envoyez votre image !&lt;/h3&gt;
    &lt;input name="MAX_FILE_SIZE" value="15360000" type="hidden" /&gt; 
    &lt;input name="img" size="30" type="file" /&gt;
    &lt;input value="Envoyer" type="submit" /&gt;
&lt;/form&gt;
</code></pre>
<p>I use this Python code : </p>
<pre><code>with open(image, 'rb') as img:
    toup = {'img': (os.path.basename(image), img)}
    res= requests.post('http://url/?action=upload', files = toup)
</code></pre>
<p>How can I fill the <code>MAX_FILE_SIZE</code> field and specify the type of the uploaded file?</p>
</div>
<div class="post-text" itemprop="text">
<p>You could <a href="http://docs.python-requests.org/en/latest/user/quickstart/#post-a-multipart-encoded-file" rel="nofollow">set the mime type</a> of the file:</p>
<pre><code>toup = {'img': (os.path.basename(image), img, 'image/jpeg')}
</code></pre>
<p>To get exact MIME of the file, you can use <a href="https://docs.python.org/3/library/mimetypes.html" rel="nofollow">mimetypes</a> library.</p>
</div>
<div class="post-text" itemprop="text">
<p>MAX_FILE_SIZE seems to be a normal HTTP POST data:</p>
<pre><code>with open(image, 'rb') as img:
    toup = {'img': (os.path.basename(image), img)}
    res= requests.post('http://url/?action=upload', files = toup, data={'MAX_FILE_SIZE': '15360000'})
</code></pre>
</div>
<span class="comment-copy">Are you certain the file you're attempting to upload is jpg, png or gif?   Can you provide some more code, maybe a running sample?</span>
<span class="comment-copy">yes, I'm sure it's a jpg :)</span>
<span class="comment-copy">That's what I was lookink for, how to specify the mimetype. It works! Thanks a lot.</span>
<span class="comment-copy">It doesn't work neither. I stille have the answer about file type. If someone wants to try, it is with <a href="http://pix.toile-libre.org" rel="nofollow noreferrer">pix.toile-libre.org</a> :     <code>res= requests.post('http://pix.toile-libre.orgl/?action=upload', files = toup, data={'MAX_FILE_SIZE': '15360000'})</code></span>
