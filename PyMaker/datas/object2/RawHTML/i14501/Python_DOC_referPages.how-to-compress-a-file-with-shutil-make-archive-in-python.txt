<div class="post-text" itemprop="text">
<p>I want to compress one text file using <code>shutil.make_archive</code> command. I am using the following command:</p>
<pre><code>shutil.make_archive('gzipped'+fname, 'gztar', os.path.join(os.getcwd(), fname))

OSError: [Errno 20] Not a directory: '/home/user/file.txt'
</code></pre>
<p>I tried several variants but it keeps trying to compress the whole folders. How to do it correctly? </p>
</div>
<div class="post-text" itemprop="text">
<p><code>shutil</code> can't create an archive from one file. You can use <code>tarfile</code>, instead:</p>
<pre><code>tar = tarfile.open(fname + ".tar.gz", 'w:qz')
os.chdir('/home/user')
tar.add("file.txt")
tar.close()
</code></pre>
<p>or</p>
<pre><code>tar = tarfile.open(fname + ".tar.gz", 'w:qz')
tar.addfile(tarfile.TarInfo("/home/user/file.txt"), "/home/user/file.txt")
tar.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Actually <a href="https://docs.python.org/3.7/library/shutil.html#shutil.make_archive" rel="nofollow noreferrer"><code>shutil.make_archive</code></a> can make one-file archive! Just pass path to target directory as <code>root_dir</code> and target filename as <code>base_dir</code>.</p>
<p>Try this:</p>
<pre><code>import shutil

file_to_zip = 'test.txt'            # file to zip
target_path = 'C:\\test_yard\\'     # dir, where file is

try:
    shutil.make_archive(target_path + 'archive', 'zip', target_path, file_to_zip)
except OSError:
    pass
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Try this and Check <a href="https://docs.python.org/3/library/shutil.html" rel="nofollow">shutil</a></p>
<p>copy your file to a directory.</p>
<p>cd directory </p>
<pre><code>shutil.make_archive('gzipped', 'gztar', os.getcwd())
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you don't mind doing a file copy op:</p>
<pre><code>def single_file_to_archive(full_path, archive_name_no_ext):
    tmp_dir = tempfile.mkdtemp()
    shutil.copy2(full_path, tmp_dir)
    shutil.make_archive(archive_name_no_ext, "zip", tmp_dir, '.')
    shutil.rmtree(tmp_dir)
</code></pre>
</div>
<span class="comment-copy">copy file.txt to a directory and try invoking that on that directory</span>
<span class="comment-copy">what directory? file.txt is in <code>/home/user</code></span>
<span class="comment-copy">What's the minimum version for this to work? At python 2.7.6 supplying a filename as base_dir resulted in an empty zip files</span>
