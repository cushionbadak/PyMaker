<div class="post-text" itemprop="text">
<p>Im trying to provide wildcard support to one of <code>CLI</code> scripts and I am using pythons <code>glob</code> module for it. For a test i tried this:</p>
<pre><code>&gt;&gt;&gt; import glob
&gt;&gt;&gt; for f in glob.glob('/Users/odin/Desktop/test_folder/*.log'):
...     print f
...
/Users/odin/Desktop/test_folder/test1.log
/Users/odin/Desktop/test_folder/test2.log
/Users/odin/Desktop/test_folder/test3.log
</code></pre>
<p>This works perfectly and gives the right output as i do have the 3 files given above.
However when I have the same code under my argument in the <code>CLI</code> it fails. I do this</p>
<pre><code>#code...
parser.add_argument( "-f", "--file", type=str, help="Full path to the file to upload." )
#code...
if args.file:
    for f in glob.glob(args.file):
        _upload_part(f)
</code></pre>
<p>I run this as</p>
<pre><code>python cli.py -f /Users/odin/Desktop/test_folder/*.log
</code></pre>
<p>This gives me the error:</p>
<pre><code>cli.py: error: unrecognized arguments: /Users/odin/Desktop/test_folder/test2.log /Users/odin/Desktop/test_folder/test3.log
</code></pre>
<p>I dont understand why all files are being added to the argument at once when I am going through the list one by one.</p>
<p>EDIT-</p>
<p><code>nargs</code> was a step in the right direction but now this error shows up:</p>
<pre><code> `Traceback (most recent call last):
      File "cli.py", line 492, in &lt;module&gt;
        for f in glob.glob(args.file):
      File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/glob.py", line 27, in glob
        return list(iglob(pathname))
      File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/glob.py", line 38, in iglob
        dirname, basename = os.path.split(pathname)
      File "/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/posixpath.py", line 92, in split
        i = p.rfind('/') + 1
    AttributeError: 'list' object has no attribute 'rfind'`
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Here's what your script receives:</p>
<pre class="lang-none prettyprint-override"><code>python cli.py -f file1 file2 file3 fileN
</code></pre>
<p>Where <em>N</em> is a total number of files matched by that pattern (Shell expands wildcards automatically). On the other hand, your <em>file</em> argument is configured to receive just one file/pattern, thus the simplest (and the best, in my opinion) solution is to add the <a href="https://docs.python.org/3/library/argparse.html#nargs" rel="nofollow"><code>nargs='+'</code> argument</a>:</p>
<pre><code>parser.add_argument('-f', '--file', type=str, help='...', nargs='+')
# code
for f in args.file:
    print(f)
</code></pre>
<p>This will allow you to remove all <code>glob</code> calls and <code>if args.file</code> checks.</p>
<p>Another option is to quote your command line argument:</p>
<pre class="lang-none prettyprint-override"><code>python cli.py -f '/Users/odin/Desktop/test_folder/*.log'
</code></pre>
</div>
<span class="comment-copy">is this on a Linux/Mac?  beware of shell wildcard expansions.  basically, the OS will figure out what matches your wildcard and then hand the expanded results over to your program's arguments.  not what you want.  vaultah's answer is correct.   see also <a href="http://stackoverflow.com/questions/11456403/stop-shell-wildcard-character-expansion" title="stop shell wildcard character expansion">stackoverflow.com/questions/11456403/â€¦</a></span>
<span class="comment-copy">Yes this is on an <code>Mac</code></span>
<span class="comment-copy">if you are getting an nargs from wildcard expansion then you don't need to/shouldn't use glob.glob.  one or the other.</span>
<span class="comment-copy">I tried this, I get - <code>No File named *.log found at /Users/odin/Desktop/test_folder/*.log</code></span>
<span class="comment-copy">what does a print(":%s:" % (args.file)) show when you do this?  glob.glob calls generally work very well once setup, but almost always requires me a bit of fiddling to adjust to any given use of it.</span>
<span class="comment-copy">It wont get to the print statement since the program receives all the files at once and throws the error I posted in my question.</span>
<span class="comment-copy">I added an edit to the question on the error I get now, it was too long to post as a comment</span>
<span class="comment-copy">@letsc see the update. In short, you don't need to use <code>glob</code>.</span>
