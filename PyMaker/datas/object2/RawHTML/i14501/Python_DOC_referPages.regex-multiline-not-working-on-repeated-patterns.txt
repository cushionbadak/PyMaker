<div class="post-text" itemprop="text">
<p>I am trying to get a regex expression to match multiple patterns with multilines but it keeps matching everything. For instance I want to match two times this code:</p>
<pre><code>STDMETHOD(MyFunc)(
D2D1_SIZE_U size,
_In_opt_ CONST void *srcData,
) PURE;

STDMETHOD(MyFunc2)(
_In_opt_ CONST void *srcData2,
UINT32 pitch2, 
) PURE;
</code></pre>
<p>I followed this link:</p>
<p><a href="https://stackoverflow.com/questions/159118/how-do-i-match-any-character-across-multiple-lines-in-a-regular-expression">How do I match any character across multiple lines in a regular expression?</a></p>
<p>and came up with this pattern:</p>
<pre><code>\bSTDMETHOD\b((.|\n|\r)*)\bPURE\b
</code></pre>
<p>however it does not work. The <code>((.|\n|\r)*)</code> matches the whole thing. I want it to stop when it finds "PURE". In other words a proper match would have given me two matches of the code above, but instead my expression only stops at the last "PURE" key word, making just one match.</p>
<p>let me know if you see why it does not work.</p>
</div>
<div class="post-text" itemprop="text">
<p>You should use <a href="http://www.rexegg.com/regex-quantifiers.html#lazy" rel="nofollow noreferrer">Lazy quantifiers</a>, as they stop on the first match they find:</p>
<pre><code>\bSTDMETHOD\b((.|\n|\r)*?)\bPURE\b
</code></pre>
<p>Tested on Regexr.com</p>
<p><img alt="enter image description here" src="https://i.stack.imgur.com/zubkY.jpg"/></p>
</div>
<div class="post-text" itemprop="text">
<p>Instead of <code>(.|\n|\r)*</code>, use <code>.*?</code> (dot with the non-greedy modifier <code>?</code>) and add the <code>s</code> and <code>g</code> flags, like this:</p>
<pre><code>/\bSTDMETHOD\b(.*?)\bPURE\b/sg
</code></pre>
<p>The <code>s</code> flag means that <code>.</code> matches <code>\r</code> and <code>\n</code>, and the <code>g</code> flag lets you capture all matching strings in the subject text.</p>
<p><a href="https://regex101.com/r/uP8bM7/1" rel="nofollow"><strong>Demo</strong></a></p>
</div>
<div class="post-text" itemprop="text">
<p>In Python, try:</p>
<pre><code>txt='''\
STDMETHOD(MyFunc)(
D2D1_SIZE_U size,
_In_opt_ CONST void *srcData,
) PURE;

STDMETHOD(MyFunc2)(
_In_opt_ CONST void *srcData2,
UINT32 pitch2, 
) PURE;'''

import re

for i, m in enumerate(re.finditer(r'\bSTDMETHOD\b(.*?)\bPURE\b', txt, flags=re.S | re.M)):
    print 'Match {}:\n{}\n==='.format(i, m.group(1))
</code></pre>
<p>Prints:</p>
<pre><code>Match 0:
(MyFunc)(
D2D1_SIZE_U size,
_In_opt_ CONST void *srcData,
) 
===
Match 1:
(MyFunc2)(
_In_opt_ CONST void *srcData2,
UINT32 pitch2, 
) 
===
</code></pre>
<p>Note the regex <code>\bSTDMETHOD\b(.*?)\bPURE</code> with the <a href="https://docs.python.org/3/howto/regex.html#compilation-flags" rel="nofollow">flags</a> <code>re.S | re.M</code></p>
<p>The <code>re.S</code> says that <code>Make . match any character, including newlines</code></p>
<p>If you anchor your matches, you want <code>re.M</code> so that <code>^</code> and <code>$</code> match the beginning and end of lines with <code>re.S</code></p>
</div>
<span class="comment-copy">Read "laziness instead of greediness": <a href="http://www.regular-expressions.info/repeat.html" rel="nofollow noreferrer">regular-expressions.info/repeat.html</a></span>
<span class="comment-copy">thank you answered my other post too!</span>
<span class="comment-copy">haha, no problem</span>
<span class="comment-copy">btw, mark as a response if solved your problem and upvote answers that helped you</span>
