<div class="post-text" itemprop="text">
<p>I would like to do an histogram with mixture 1D gaussian as the picture. </p>
<p><a href="https://i.stack.imgur.com/Ggwit.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/Ggwit.png"/></a> </p>
<p>Thanks Meng for the picture. </p>
<p>My histogram is this: </p>
<p><a href="https://i.stack.imgur.com/fwxWh.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/fwxWh.png"/></a></p>
<p>I have a file with a lot of data (4,000,000 of numbers) in a column: </p>
<pre><code>1.727182
1.645300
1.619943
1.709263
1.614427
1.522313
</code></pre>
<p>And I'm using the follow script with modifications than Meng and Justice Lord have done :</p>
<pre><code>from matplotlib import rc
from sklearn import mixture
import matplotlib.pyplot as plt
import numpy as np
import matplotlib
import matplotlib.ticker as tkr
import scipy.stats as stats

x = open("prueba.dat").read().splitlines()

f = np.ravel(x).astype(np.float)
f=f.reshape(-1,1)
g = mixture.GaussianMixture(n_components=3,covariance_type='full')
g.fit(f)
weights = g.weights_
means = g.means_
covars = g.covariances_

plt.hist(f, bins=100, histtype='bar', density=True, ec='red', alpha=0.5)
plt.plot(f,weights[0]*stats.norm.pdf(f,means[0],np.sqrt(covars[0])), c='red')
plt.rcParams['agg.path.chunksize'] = 10000

plt.grid()
plt.show()
</code></pre>
<p>And when I run the script, I have the follow plot:</p>
<p><a href="https://i.stack.imgur.com/clSos.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/clSos.png"/></a></p>
<p>So, I don't have idea how put the start and end of all gaussians that must be there.  I'm new in python and I'm confuse with the way to use the modules. Please, Can you help me and guide me how can I do this plot?</p>
<p>Thanks a lot</p>
</div>
<div class="post-text" itemprop="text">
<p>It's all about reshape.
First, you need to reshape f.
For pdf, reshape before using stats.norm.pdf. Similarly, sort and reshape before plotting.</p>
<pre><code>from matplotlib import rc
from sklearn import mixture
import matplotlib.pyplot as plt
import numpy as np
import matplotlib
import matplotlib.ticker as tkr
import scipy.stats as stats

# x = open("prueba.dat").read().splitlines()

# create the data
x = np.concatenate((np.random.normal(5, 5, 1000),np.random.normal(10, 2, 1000)))

f = np.ravel(x).astype(np.float)
f=f.reshape(-1,1)
g = mixture.GaussianMixture(n_components=3,covariance_type='full')
g.fit(f)
weights = g.weights_
means = g.means_
covars = g.covariances_

plt.hist(f, bins=100, histtype='bar', density=True, ec='red', alpha=0.5)

f_axis = f.copy().ravel()
f_axis.sort()
plt.plot(f_axis,weights[0]*stats.norm.pdf(f_axis,means[0],np.sqrt(covars[0])).ravel(), c='red')

plt.rcParams['agg.path.chunksize'] = 10000

plt.grid()
plt.show()
</code></pre>
<p><a href="https://i.stack.imgur.com/NKdxN.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/NKdxN.png"/></a></p>
</div>
<span class="comment-copy">what line gives this error?</span>
<span class="comment-copy">I suppose the part of of gaussianmixture, i don't know exactly. If I do only the histogram, there is no problem.</span>
<span class="comment-copy">Thanks Meng, but I want to see the histogram with the gaussians separate, from the data of my file. The problem is that I have 4000000 of data and I dont know how indicate where start or ending the gaussian. I use now the reshape and i have this error from my script: ValueError: operands could not be broadcast together with shapes (4000000,1) (3,1)</span>
<span class="comment-copy">Which line gives you the error? If you could provide the data, I can use your data. Here I am just making up some data.</span>
<span class="comment-copy">Sure. Thanks. How can I send you the data?.</span>
<span class="comment-copy">Cool.!! This kind of plot I want to do it. My histogram is at the beginning of this blog. I will publish my script and the question is: I think the line plt.plot(f,weights[0]*stats.norm.pdf(f,means[0],np.sqrt(covars[0])), c='red')  I need it to change and add others, but i dont know how. Please, can you see my script in the   next part. Thanks a lot.</span>
<span class="comment-copy">I think what you are missing is the sorting step. I updated my answer.</span>
