<div class="post-text" itemprop="text">
<p>Here is an <a href="https://stackoverflow.com/questions/3715493/encoding-an-image-file-with-base64">answer</a> which gives some information on how to base64 encode a file. However, I also want to pass in the filetype and mimetype. for the information in the base64 encoded string. </p>
<p>So far I have for my <code>base64</code> string: </p>
<pre><code>x=base64.b64encode(open('/Users/user/Desktop/img.PNG').read())
</code></pre>
<p>What is the correct information to prepend, and how would I do this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Perhaps something along these lines:</p>
<pre><code>from __future__ import print_function
import base64
import binascii
import os

def base64_encode_file(filename):
    filetype = os.path.splitext(filename)[1][1:]  # remove leading '.' from ext
    with open(filename) as file:
        data = file.read()
        return base64.b64encode(','.join((filename, filetype, data))), data

filename = 'C:/Users/martin/Desktop/img.PNG'
#filename = '/Users/user/Desktop/img.PNG'

encoded, data = base64_encode_file(filename)
print('encoded: {} (hex file data: {})'.format(encoded, binascii.hexlify(data)))

decoded = base64.b64decode(encoded).split(',', 2)
print('decoded:', decoded[0], decoded[1], binascii.hexlify(decoded[2]))
</code></pre>
<p>Output:</p>
<pre class="lang-none prettyprint-override"><code>encoded: QzovVXNlcnMvbWFydGluL0Rlc2t0b3AvaW1nLlBORyxQTkcsiVBORwo= 
          (hex file data: 89504e470a)
decoded: C:/Users/martin/Desktop/img.PNG PNG 89504e470a
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>It seems like the following is how I would get the <code>base64</code> file information to pass to the server:</p>
<pre><code>file = '/Users/user/Desktop/img.PNG'
prepend_info = 'data:%s;base64' % mimetypes.guess_type(file)[0]
base_64_data = open(file).read().encode('base64')
image_data_base64 = '%s,%s' % (prepend_info, base_64_data)
</code></pre>
<p>This then gives me:</p>
<pre><code>data:image/png;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wB...
</code></pre>
</div>
<span class="comment-copy">You need to be more specific. How do you expect us to know what the correct information you need is, let alone how to represent it. We have no idea what you are doing with the base64 string...</span>
<span class="comment-copy">@TomDalton thanks for the feedback. The user is passing a base64 string to us and we're uploading that file for the user to be able to download from a url. Having the extension is useful for doing something like '<a href="http://myurl.com/file.png" rel="nofollow noreferrer">myurl.com/file.png</a>'</span>
<span class="comment-copy">Are you looking for <a href="https://docs.python.org/3/library/uu.html" rel="nofollow noreferrer"><code>uu</code></a>?</span>
<span class="comment-copy">@David so you're writing a client application run on the user's machine? Isn't the file extension already part of the filename? Or are you really wanting to try to detect the file's actual mimetype, e.g. based on header information in the file itself? What other information are you considering under your 'etc'?</span>
<span class="comment-copy">@TomDalton ok I updated my question to remove the <code>etc</code> ambiguity. Thanks for your feedback on that.</span>
<span class="comment-copy">I only made <code>base64_encode_file()</code> return the both the encoded information and the raw file data to make it easy to verify that things had been done properly after the decoding was done -- so the <code>, data</code> on the <code>return</code> statement could be left off because only the encoded string needs to returned to get the functionality you want.</span>
<span class="comment-copy">Seems reasonable! :-)</span>
