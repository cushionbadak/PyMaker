<div class="post-text" itemprop="text">
<p>In this pseudo code, the destructor of <code>o</code> is never called.</p>
<pre><code>class MyObj():
   def __del__():
      print "Destroyed!"
      do_upon_death()

def parse():
   o = MyObj()
   print "Ok so far..."
   raise Exception

run_in_QThread(parse)

do_other_things()
</code></pre>
<p>I see the exception printed on the terminal, but <code>o</code> seems not being garbage-collected. The interpreter does not exit upon the exception (the main thread keeps running). </p>
<p>The whole purpose behind this is to be able to do certain cleanup in the destructor when exceptions occur.</p>
<p>Another way to explain this is with a different pattern:</p>
<pre><code>try:
   run_in_thread(parse)
except:
   print "Will I ever get printed?"
</code></pre>
<p>Exceptions happening in <code>parse</code> will not get caught.</p>
<p>Even further:</p>
<pre><code>with MyContextManager() as manager:
    run_in_thread(lambda: do_something(manager))
</code></pre>
<p>Here <code>manager.__exit__()</code> will get called with all <code>None</code> arguments as if the code completed cleanly, even if there is an exception in <code>do_something</code>.</p>
<p>The purpose behind this is because I'm running certain tasks which can fail for too many different reasons, and these tasks can be done partially in the main thread, and partially in a worker thread. It can fail in either.</p>
<p>So my initial idea was to keep references to an object while the task was running, so if the task completed by exiting the context or by an exception, references would be lost and eventually the destructor would be run.</p>
<p>I'm trying to keep track of these tasks and keep a visual indicator on a GUI of which tasks are still doing their job.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can catch Exception after it was raised and do what you want to do </p>
<pre><code>try:
   o = MyObj()
   print "Ok so far..."
   raise Exception

except Exception:
   del o
</code></pre>
<p>or use such form if is no difference was exception raised or not:</p>
<pre><code>finaly:
   del o
</code></pre>
<p>If you need just keep Thread alive, may be, you should use: Thread.sleep()</p>
<p>As i understood in Thread is only parse(), so you need to create signal by emit() about deleting and send it in main thread</p>
<p>I believe that caughting destructor is not the best decision, it will be better to catch some signal. Please add more info about why you do this all. </p>
</div>
<span class="comment-copy">Read the documentation for <a href="https://docs.python.org/3/reference/datamodel.html#object.__del__" rel="nofollow noreferrer"><code>__del__</code></a>.</span>
<span class="comment-copy">I read the documentation. Any deeper thoughts?</span>
<span class="comment-copy">I just added some more detail. Thanks.</span>
