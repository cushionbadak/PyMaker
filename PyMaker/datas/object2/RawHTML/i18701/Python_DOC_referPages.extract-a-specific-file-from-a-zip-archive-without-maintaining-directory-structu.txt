<div class="post-text" itemprop="text">
<p>I'm trying to extract a specific file from a zip archive using python.</p>
<p>In this case, extract an apk's icon from the apk itself.</p>
<p>I am currently using</p>
<pre><code>with zipfile.ZipFile('/path/to/my_file.apk') as z:
    # extract /res/drawable/icon.png from apk to /temp/...
    z.extract('/res/drawable/icon.png', 'temp/')
</code></pre>
<p>which does work, in my script directory it's creating <code>temp/res/drawable/icon.png</code> which is temp plus the same path as the file is inside the apk.</p>
<p>What I actually want is to end up with <code>temp/icon.png</code>.</p>
<p>Is there any way of doing this directly with a zip command, or do I need to extract, then move the file, then remove the directories manually?</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="http://docs.python.org/3/library/zipfile.html#zipfile.ZipFile.open" rel="nofollow noreferrer">zipfile.ZipFile.open</a>:</p>
<pre><code>import os
import shutil

with zipfile.ZipFile('/path/to/my_file.apk') as z:
    with z.open('/res/drawable/icon.png') as zf, open('temp/icon.png', 'wb') as f:
        shutil.copyfileobj(zf, f)
</code></pre>
<p>Or use <a href="http://docs.python.org/3/library/zipfile.html#zipfile.ZipFile.read" rel="nofollow noreferrer">zipfile.ZipFile.read</a>:</p>
<pre><code>import os

with zipfile.ZipFile('/path/to/my_file.apk') as z:
    with open('temp/icon.png', 'wb') as f:
        f.write(z.read('/res/drawable/icon.png'))
</code></pre>
</div>
<span class="comment-copy">Both very nice answers, far more eloquent than just moving it like I was. Minor correction to fit question asked, is with open(os.path.join(tDir,os.path.basename(icon[1])), 'wb') as f:  so that the output icon is in the temp dir, not cwd() where script is. Thanks</span>
<span class="comment-copy">It's worth noting that the CPython implementations of <code>extract</code> and <code>extract_all</code> use the "<code>zipfile.ZipFile.open</code>" version: e.g. <a href="https://github.com/python/cpython/blob/v3.7.0/Lib/zipfile.py#L1647" rel="nofollow noreferrer">github.com/python/cpython/blob/v3.7.0/Lib/zipfile.py#L1647</a></span>
