<div class="post-text" itemprop="text">
<p>I want to upload an ASCII file. This used to work in Python 2:</p>
<pre><code>ftp = ftplib.FTP('ftp.domain.com')
ftp.login('domain.com',password)
ftp.cwd('subdirectory')
ftp.storlines('STOR ' + 'file.htm', open('file.htm','r'))
ftp.close()
</code></pre>
<p>However, in Python 3 it returns this error:</p>
<pre><code>  File "/usr/local/lib/python3.3/ftplib.py", line 497, in storlines
    if buf[-1] in B_CRLF: buf = buf[:-1]
TypeError: Type str doesn't support the buffer API
</code></pre>
<p>What am I doing wrong?</p>
</div>
<div class="post-text" itemprop="text">
<p>I read the documentation:
<a href="http://docs.python.org/3/library/ftplib.html#ftplib.FTP.storlines" rel="noreferrer">http://docs.python.org/3/library/ftplib.html#ftplib.FTP.storlines</a></p>
<p>"Lines are read until EOF from the file object file (opened in binary mode) using its readline() method to provide the data to be stored."</p>
<p>So I just had to open in binary mode:</p>
<pre><code>ftp.storlines('STOR ' + 'file.htm', open('file.htm','rb'))
</code></pre>
</div>
<span class="comment-copy">I believe when tommy answered his own question, he left off a/the critical character ftp.storlines('STOR ' + 'file.htm', open('file.htm','rb')) unless I am mistaken.</span>
<span class="comment-copy">Thanks Raleigh! Fixed.</span>
<span class="comment-copy">I had the exact same issue, but my error was <code>TypeError: a bytes-like object is required, not 'str'</code> Maybe a newer version?</span>
<span class="comment-copy">@HansGoldman using Python 3.6? I get your error on 3.6, but the other exception 'Type str doesn't support the buffer API' occurs on python 3.4 and lower..</span>
<span class="comment-copy">@JackO'neill I am using Python 3.5.2</span>
