<div class="post-text" itemprop="text">
<p>My script connects to a MySQL database using sqlalchemy</p>
<pre><code>from sqlalchemy import *
engine = create_engine("mysql+mysqlconnector://user:password@ip:port/dbName")
</code></pre>
<p>Then reads in txt files using pandas read_csv function and the dataframe is used to create a new table in the database using:</p>
<pre><code>df.to_sql(tableName, con=engine, flavor='mysql', schema=None, if_exists='replace', index=False)
</code></pre>
<p>Script works perfectly fine, except randomly it seems to get stuck on the previous statement i.e. writing to the database. By random I mean that this is not file specific and so for example does not simply take longer to upload larger files. If I restart it, the file on which it was previously 'frozen' is uploaded instantly, but then it freezes again say 12 files afterwards or 1 file afterwards (very random). The table it 'freezes' on is actually fully uploaded (when I check the database, its all there) so it seems to freeze from going to the next statement. (No errors are thrown; script seems to be running normally except nothing happens). Any help is appreciated.</p>
<p>EDIT:</p>
<p>After enabling debugging, when freezing it seems to do all the tasks (hence why the table shows up even in the database) i.e.</p>
<pre><code>2016-03-16 03:16:19,720 INFO sqlalchemy.engine.base.Engine {}
2016-03-16 03:16:19,806 INFO sqlalchemy.engine.base.Engine COMMIT
2016-03-16 03:16:19,935 INFO sqlalchemy.engine.base.Engine BEGIN (implicit)
2016-03-16 03:16:20,015 INFO sqlalchemy.engine.base.Engine INSERT INTO `tableName` COLUMNS (***shortened this***)
2016-03-16 03:16:21,482 INFO sqlalchemy.engine.base.Engine COMMIT
2016-03-16 03:16:21,686 INFO sqlalchemy.engine.base.Engine SHOW FULL TABLES FROM `dbName`
2016-03-16 03:16:21,686 INFO sqlalchemy.engine.base.Engine {}
</code></pre>
<p>it simply does not continue to go on to the next command which is next iteration (again this is not always the case; seems to stop after about 1-3 tables now)</p>
</div>
<div class="post-text" itemprop="text">
<p>It could be Python garbage collection. Check in your system activity monitor. GC should show up as the Python process using lots of CPU.</p>
<p>The <a href="https://docs.python.org/3/library/gc.html" rel="nofollow">gc</a> library can help you troubleshooting and tuning the garbage collector.</p>
</div>
<span class="comment-copy">Is it a remote database? Are you sure you have internet when it gets stuck like that?</span>
<span class="comment-copy">Yes it is a remote database. 100% positive network is not dropping. Turning echo to true, basically 'freezes' here:  <code>code</code> INFO sqlalchemy.engine.base.Engine {} INFO sqlalchemy.engine.base.Engine COMMIT INFO sqlalchemy.engine.base.Engine BEGIN (implicit) INFO sqlalchemy.engine.base.Engine INSERT INTO etc etc etc... INFO sqlalchemy.engine.base.Engine ({'list goes here'}) INFO sqlalchemy.engine.base.Engine COMMIT INFO sqlalchemy.engine.base.Engine SHOW FULL TABLES FROM <code>dbname</code> INFO sqlalchemy.engine.base.Engine {} <code>code</code></span>
<span class="comment-copy">CPU is hardly used and GC process is not listed. Using pycharm as an IDE and it uses 1.3% CPU when the script 'freezes'.</span>
