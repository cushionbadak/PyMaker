<div class="post-text" itemprop="text">
<p>I am debugging an application and would like to use the bottle SimpleTemplate to render both HTML and Python. If I use a template as a separate file (views/simple.tpl), then Python is rendered correctly.</p>
<p>If I try passing in Python as a string, I get <code>NameError("name 'demo' is not defined",)</code></p>
<pre><code>from bottle import template

text = "debugging"
return template(
    "&lt;p&gt;{{text}}&lt;/p&gt;" + 
    "% demo = 'hello world'" + 
    "&lt;p&gt;{{demo}}&lt;/p&gt;",
    text=text
)
</code></pre>
<p>Is this possible?</p>
</div>
<div class="post-text" itemprop="text">
<p>Lines with embedded Python code must start with <code>%</code>. The problem is that you're using string concatenation, which doesn't preserve newlines. Simply put, that string is equivalent to the following line:</p>
<pre class="lang-html prettyprint-override"><code>&lt;p&gt;{{text}}&lt;/p&gt;% demo = 'hello world'&lt;p&gt;{{demo}}&lt;/p&gt;
</code></pre>
<p>Since <code>%</code> isn't the first character, it doesn't mean anything to Bottle.</p>
<p>Add newlines manually:</p>
<pre><code>return template(
    "&lt;p&gt;{{text}}&lt;/p&gt;\n"
    "% demo = 'hello world'\n" 
    "&lt;p&gt;{{demo}}&lt;/p&gt;",
    text=text
)
</code></pre>
<p>As a side note, you can use <a href="https://docs.python.org/3/reference/lexical_analysis.html#string-literal-concatenation" rel="nofollow">implicit string literal concatenation</a> (as shown in the code above).</p>
</div>
