<div class="post-text" itemprop="text">
<p>I am running a Raspberry pi with connected camera and want to use crontab to automatically upload taken pictures once per hour.</p>
<p>Pictures are taken by another shell script every 6 minutes, which is also controlled by crontab and works fine.</p>
<p>The python script to upload the files works as intended when calling it from the shell. It builds the correct file names and uploads them. Here is the script:</p>
<pre><code>#!/usr/bin/env python 
import dropbox
import os.path
import time
#pictures are taken every 6 minutes so this is used to build the file names:
interval = ('00','06','12','18','24','30','36','42','48','54')

access_token = "my_token"
client = dropbox.client.DropboxClient(access_token)

#get current time
t = time.strftime("%Y-%m-%d_%H")

for x in interval:
        #build file name:
        file =  t+x+'.jpg'
        #check if file exsists:
        if os.path.isfile(file):
                #open file
                pic = open(file, 'rb')
                #upload picture:
                response = client.put_file(file, pic)
                print "picture " + file + " uploaded"
                pic.close()
</code></pre>
<p>I added the following in crontab -e (the path is correct). So that it should upload every hour at :56 minutes</p>
<p><code>56 * * * * python /home/pi/Pictures/pyPictureUpload.py</code></p>
<p>However, nothing is ever uploaded. I also tried it with the same command in a shell script and call the shell script in crontab instead:</p>
<p><code>56 * * * * /home/pi/Pictures/runUpload.sh</code></p>
<p>This is the very short shell script:</p>
<pre><code>!/bin/bash
python /home/pi/Pictures/pyPictureUpload.py
</code></pre>
<p>All scripts work as intended when called from the shell directly but nothing works automatized by crontab. What am I doing wrong?</p>
</div>
<div class="post-text" itemprop="text">
<p>I suspect it's a problem with the working directory being different in the shell versus when cron is running. My experience in similar situations has been that it is safer to specify the full path every time. The <a href="https://docs.python.org/3/library/os.path.html" rel="nofollow">os.path</a> module has a number of helpful functions for this.</p>
<p>The problem being that you define the filename as <code>file =  t+x+'.jpg'</code> but never give a directory where those files are stored. If you are manually running the python script in the same directory as the images, it will work fine. But when the cron daemon runs it, it isn't starting in that same directory.</p>
<p>Try:</p>
<pre><code>...
basePath = '/path/to/my/images'
for x in interval:
    #build file name:
    file = os.path.join(basePath, t+x+'.jpg')
    #check if file exsists:
    if os.path.isfile(file):

...
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>There could be many reasons for the failure.</p>
<p>(this is an answer that I provided yesterday for a similar question but I do not know how to insert a link from my phone app. I may edit this tomorrow)</p>
<p>The environment variables of the cron daemon are not the same as the login shells. </p>
<p>In particular the <strong>PATH</strong> variable which is used to locate commands might not be the one you expect: some commands would not be found in such situation, for example.</p>
<p>Could you provide all errors and output generated when the script was run by cron daemon?</p>
<hr/>
<h1>How to debug a script executed by the cron daemon?</h1>
<p>At first, add <strong>set -x</strong> to the script in order to make bash generates trace messages:</p>
<pre><code>$ cat /home/william/bin/script.sh
#!/bin/bash --
set -x
</code></pre>
<h2>Solution 1</h2>
<p>By default error output and standard output are all gathered and sent into an email to the current user mailbox.
All logins have their own local mailbox on linux and UNIX.
Connect as the user which own the crontab and type <strong>mail</strong>:</p>
<pre><code>$ crontab -l
* * * * * /home/william/bin/script.sh
$ mail
</code></pre>
<p>The <strong>mail</strong> command offers a text interface and enables you to list and read emails received.
There is a help.</p>
<h2>Solution 2</h2>
<p>Edit the crontab and redirect output to a file on the disk</p>
<pre><code>$ crontab -l
* * * * * /home/william/bin/script.sh 2&gt;/tmp/script.out &gt;&amp;2
</code></pre>
<p>Wait that cron daemon runs the script and debug with information logged into the /tmp/script.out file.</p>
</div>
<span class="comment-copy">Thank you for your quick answer! I tried your solutions but "mail" was not recognized on my system. Your second solution worked so far that I now know that crontab is actually working. But the only text I got in script.out was "+ sudo python /home/pi/Pictures/pyPictureUpload.py", which is the actual command in my script.sh.</span>
<span class="comment-copy">this is nice that you found a solution. I understand that the second *.py does not generate output or error. In such situation modify the *.py to make it generate trace message in order to enable debugging.</span>
