<div class="post-text" itemprop="text">
<p>I try to mock a dictionary at module level:</p>
<pre><code>with mock.patch('mymodule.mydict', new_callable=mock.PropertyMock) as mock_dict:
    mock_dict.return_value={'foo': 'bar'}
    ...
</code></pre>
<p>But it does not work. Inside the with-statement the dictionary is empty.</p>
<p>I read the <a href="http://www.voidspace.org.uk/python/mock/mock.html#mock.PropertyMock" rel="nofollow">docs</a>, but could not find a solution.</p>
<p>Any hints?</p>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="https://docs.python.org/3/library/unittest.mock.html#patch-dict" rel="nofollow"><code>patch.dict</code></a> to mock a dictionary:</p>
<pre><code>with patch.dict('mymodule.mydict', {'newkey': 'newvalue'}):
    assert mymodule.mydict == {'newkey': 'newvalue'}
</code></pre>
</div>
<span class="comment-copy">From the docs: <i>A mock intended to be used as a property, or other descriptor, <b>on a class</b>.</i> A descriptor <b>requires</b> a class to work, it cannot work at the global (module) scope.</span>
