<div class="post-text" itemprop="text">
<p>I have written this piece of python code which downloads a number of images from a repository of images and saves them in specified folder. The code looks like this: </p>
<pre><code>import urllib.request
import cv2
import numpy as np
import os

def store_raw_images():
    neg_images_link = 'http://image-  net.org/api/text/imagenet.synset.geturls?wnid=n00464651'
    neg_images_urls =  urllib.request.urlopen(neg_images_link).read().decode()

    if not os.path.exists('neg'):
       os.makedirs('neg')

    pic_num = 1
    for i in neg_images_urls.split('\n'):
        try:
            print(i)
            urllib.request.urlretrieve(i, "neg/{}.jpg".format(pic_num))
            img = cv2.imread("neg/{}.jpg".format(pic_num) + cv2.IMREAD_GRAYSCALE)
            resized_image = cv2.resize(img, (100, 100))
            cv2.imwrite("neg/{}.jpg".format(pic_num), resized_image)
            pic_num = pic_num + 1
            print(pic_num)

        except Exception as e:
            print(str(e))

store_raw_images()
</code></pre>
<p>For some reason the images are replaced and I do NOT see all images. I keep seeing one image <code>1.jpg</code> and all the images seem to replaced, though I expect the name of the images to go <code>1.jpg</code>, <code>2.jpg</code> , ... .</p>
<p>I also see this warning/error but I am not sure if it is relevant to this problem or not. </p>
<pre class="lang-none prettyprint-override"><code>Can't convert 'int' object to str   
http://www.azjeugd.nl/site/modules/xcgal/albums/20082009seizoen/a1/groningen_thuis/IMG_7798.jpg
  HTTP Error 403: Forbidden
  http://www.ga-eagles.nl/images/duels1e0809/gaetel6.jpg
</code></pre>
<p>Where do you think the problem lies? </p>
<p>Note that I am incrementing the image number: </p>
<pre><code>        pic_num = pic_num + 1
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You have everything in one <code>try/except</code> block. Assuming <code>cv2.imwrite</code> fails but all the other lines are executed without any problems, your code will never reach <code>picnum = picnum + 1</code>.
Try rearranging your code where you first increase <code>picnum</code> and check which lines actually gives you the error.</p>
</div>
<span class="comment-copy">What's this <code>+</code> in here <code>cv2.imread("neg/{}.jpg".format(pic_num) + cv2.IMREAD_GRAYSCALE)</code>. I don't think that should be there.</span>
<span class="comment-copy">Why not change the file names like this instead?  <code>"pic "+str(pic_num)+".jpg"</code></span>
<span class="comment-copy">I believe the problem was only the '+' sign. Will why do you think <code>"neg/{}.jpg".format(pic_num)</code> and <code>"neg/" + str(pic_num) + ".jpg"</code> are different? Thanks Rawing for detecting it out !</span>
<span class="comment-copy">The images are being downloaded one after the other neatly. However at some point the program stops with this error: <code>http://pic20.picturetrail.com/VOL1483/5506924/11018757/343396474.jpg terminate called after throwing an instance of 'std::out_of_range'   what():  basic_string::substr. Process finished with exit code 134</code>  Is this kind of a memory problem? How can I solve it?</span>
<span class="comment-copy">I noticed the error occurs when querying image No 149. Is there anyway I can reset the downloading from this image number?</span>
<span class="comment-copy">To OP: You can avoid mistakes like this if you use <a href="https://docs.python.org/3/library/functions.html?highlight=enumerate#enumerate" rel="nofollow noreferrer"><code>enumerate</code></a>: <code>for pic_num, i in enumerate(neg_images_urls.split('\n'), 1):</code>.</span>
<span class="comment-copy">Good idem thanks.</span>
<span class="comment-copy">A few more suggestions, except for the good idea by @Rawing. You use <code>"neg/{}.jpg".format(pic_num)</code> three times, use a variable instead, less work if you want to change it later. <code>split('\n')</code> can be written as <code>splitlines()</code> and will save you the unnecessary empty last field.</span>
<span class="comment-copy">Maxim thanks, I applied your suggestion to the code.</span>
