<div class="post-text" itemprop="text">
<p>I am trying to read Address information from excel break it down into street name street number direction zip code and then write it in another excel or csv again based on the classification Done.</p>
<pre><code>Sample input
Address1
107 ALVISO DR 
12418 SUNNYGLEN DR 
2292 MAGNOLIA ST 
2092 ATWATER AVE 
1242 CARLSBAD PL
</code></pre>
<p>Sample output</p>
<pre><code>ZipCode StreetNamePostDirectional   StreetNamePreDirectional

777                E                          N
</code></pre>
<p>Based on certain set of rules. I am using the below code.
The problem is when i write the data to the csv it just retruns 1 row.</p>
<pre><code>import csv
import usaddress
import xlsxwriter


file_name = 'Address.xlsx'
import pandas as pd
xl_workbook = pd.ExcelFile(file_name)  # Load the excel workbook
df = xl_workbook.parse("Sheet1")  # Parse the sheet into a dataframe
aList = df['Address1'].tolist()

di = {}
dicts ={}
for i in aList:
    i = str(i)
    x = usaddress.parse(i)
    for ele in x:
        try:
          di[ele[1]].append(ele[0])
        except KeyError:
          di[ele[1]] = [ele[0],]
dicts.update(di)


with open("test.csv", "w") as outfile:
   writer = csv.writer(outfile)
   writer.writerow(dicts.keys())
   writer.writerows(zip(*dicts.values()))
</code></pre>
<p>Not sure what is going wrong</p>
</div>
<div class="post-text" itemprop="text">
<p>If you make your table into a CSV with appropriate headers you can do the following to access the data in each row:</p>
<pre><code>import csv
with open('C:\folder\\file.csv') as csvfile:
reader = csv.DictReader(csvfile)
for row in reader:
    var1 = (row["street namezip code"])
    var2 = (row["street number"])
    var3 = (row["zip code"])
</code></pre>
<p>from there you can use these variables to create your output.
I hope this helps.</p>
</div>
<span class="comment-copy">I'd use <code>pd.read_excel()</code>. Try <a href="https://docs.python.org/3/library/csv.html#csv.DictWriter" rel="nofollow noreferrer">csv.DictWriter()</a></span>
<span class="comment-copy">@Arthur when I use csv.DictWriter() for dicts.values() it gives me type hashable error</span>
<span class="comment-copy">thanks but the thing is usaddress.parse returns 26 keys so I want to create the headers and rows dynamically..</span>
<span class="comment-copy">Sorry I couldn't help more buddy</span>
