<div class="post-text" itemprop="text">
<p>In shells like the interactive python shell, you can usually use the arrow keys to move around in the current line or get previous commands (with arrow-up) etc.</p>
<p>But after I ssh into another machine and start <code>python</code> there, I get sessions like:</p>
<pre><code>&gt;&gt;&gt; import os 
&gt;&gt;&gt; ^[[A    
</code></pre>
<p>where the last character comes from arrow-up. Or, using arrow-left:</p>
<pre><code>&gt;&gt;&gt; impor^[[D
</code></pre>
<p>How can I fix this?</p>
<p>In the regular bash, arrow keys work fine. The weird behavior is just in the interactive python (or perl etc.) shell.</p>
</div>
<div class="post-text" itemprop="text">
<p>Looks like readline is not enabled. Check if <code>PYTHONSTARTUP</code> variable is defined, for me it points to <code>/etc/pythonstart</code> and that file is executed by the python process before going interactive, which setups readline/history handling.</p>
<p>Thanks to @chown here is the docs on this: <a href="http://docs.python.org/2/tutorial/interactive.html" rel="noreferrer">http://docs.python.org/2/tutorial/interactive.html</a></p>
</div>
<div class="post-text" itemprop="text">
<p>I've solved this issue by installing <code>readline</code> package:</p>
<pre><code>pip install readline
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>On OS X, I have different problem.</p>
<p>When I using system python shell, the keys is no problem, but problem in virtualenv. I'd try to reinstall/upgrade virtualenv/readline and nothing fixed.</p>
<p>While I try to <code>import readline</code> in problem python shell, get this error message:</p>
<pre><code>ImportError: dlopen(/Users/raptor/.virtualenvs/bottle/lib/python2.7/lib-dynload/readline.so, 2): Library not loaded: /usr/local/opt/readline/lib/libreadline.6.dylib
Referenced from: /Users/raptor/.virtualenvs/bottle/lib/python2.7/lib-dynload/readline.so
Reason: image not found
</code></pre>
<p>Cause there is <code>/usr/local/opt/readline/lib/libreadline.7.dylib</code> but not <code>libreadline.6.dylib</code>, so I make a symbol link:</p>
<pre><code>ln libreadline.7.dylib libreadline.6.dylib
</code></pre>
<p>Problem has been solved!</p>
</div>
<div class="post-text" itemprop="text">
<p>On OS X, Xcode updates sometimes break <code>readline</code>. Solution:</p>
<pre><code>brew uninstall readline
brew upgrade python3
brew install readline
pip3 install readline
</code></pre>
<p>If the problem still persists, try to remove <code>readline</code> using <code>pip</code> and install it using <code>easy_install</code>:</p>
<pre><code>pip3 uninstall readline
easy_install readline
</code></pre>
</div>
<div class="post-text" itemprop="text">
<ol>
<li>install readline-devel package. </li>
<li>recompile python with readline module</li>
<li>Bingo!</li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p>On OS X, using python 3.5 and virtualenv</p>
<pre><code>$ pip install gnureadline
</code></pre>
<p>In the interpreter do: </p>
<pre><code>import gnureadline
</code></pre>
<p>Now arrow keys should work properly. </p>
<hr/>
<p>Additional information...</p>
<p>Note that as of Oct 1, 2015 - readline has been <strong>DEPRECATED</strong> (source <a href="https://github.com/ludwigschwardt/python-readline" rel="noreferrer">https://github.com/ludwigschwardt/python-readline</a>)</p>
<p>Use <strong>gnureadline</strong> instead (see: <a href="https://github.com/ludwigschwardt/python-gnureadline" rel="noreferrer">https://github.com/ludwigschwardt/python-gnureadline</a>)</p>
<p>If I install readline instead of gnureadline using python 3.5, I receive errors after attempt to import in the interpreter: </p>
<pre><code>&gt;&gt;&gt; import readline
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
ImportError: dlopen(/Users/pi/tmp/python-readline-test/.venv/lib/python3.5/readline.so, 2): Library not loaded: /usr/local/opt/readline/lib/libreadline.6.dylib
  Referenced from: /Users/pi/tmp/python-readline-test/.venv/lib/python3.5/readline.so
  Reason: image not found
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Here are the steps which worked for me in ubuntu 12.04 for python 3.3.</p>
<p>1) open teminal and write <code>sudo apt-get install libreadline-dev</code></p>
<p>2) download the source file of python 3.3.2 from <a href="http://www.python.org/ftp/python/3.3.2/Python-3.3.2.tar.xz" rel="noreferrer">http://www.python.org/ftp/python/3.3.2/Python-3.3.2.tar.xz</a></p>
<p>3) extract it and navigate to the Python-3.3.2/ directory in a shell</p>
<p>4) execute the following command:</p>
<pre><code>./configure
make
make test
sudo make install
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I had problems with shell history(tab/arrows commands) of Python 3.6.x  on Ubuntu 16.04 LTS.</p>
<p>Python 3.6.x was installed from source.</p>
<p>What solved for me was install the module "gnureadline" as said by user12345, using this command line:</p>
<pre><code>sudo pip3.6 install gnureadline
</code></pre>
<p>:)</p>
</div>
<div class="post-text" itemprop="text">
<p>Was impacted after upgrading Mac to High Sierra, this successfully resolved it for me:</p>
<pre><code>brew unlink python
xcode-select --install
brew install python
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>On CentOS, I fix this by </p>
<p><code>yum install readline-devel</code></p>
<p>and then recompile python 3.4.</p>
<p>On OpenSUSE, I fix this by</p>
<pre><code>pip3 install readline
</code></pre>
<p>following Valerio Crini's answer.</p>
<p>Perhaps "pip3 install readline" is a general solution. Haven't tried on my CentOS.</p>
</div>
<div class="post-text" itemprop="text">
<p>I fixed this by doing the following:</p>
<ul>
<li>yum install readline-devel</li>
<li><p>pip install readline</p>
<ul>
<li><p>I encountered another error here:</p>
<p><code>gcc: readline/libreadline.a: No such file or directory</code></p>
<p><code>gcc: readline/libhistory.a: No such file or directory</code></p>
<p>I fixed this by installing <code>patch</code>:</p>
<p><code>yum install patch</code></p></li>
</ul></li>
</ul>
<p>After that I managed to run <code>pip install readline</code> successfully which solved the escape characters in my python shell.</p>
<p>FYI, I'm using RedHat</p>
</div>
<div class="post-text" itemprop="text">
<p>If you use Anaconda Python, you can fix this by running:</p>
<pre><code>conda install readline
</code></pre>
<p>Worked for me!</p>
</div>
<div class="post-text" itemprop="text">
<p>Did you call ssh with the <em>-t</em> parameter to tell ssh to allocate a virtual terminal for you?</p>
<p>From the man page:</p>
<blockquote>
<p>-t<br/>
   Force pseudo-tty allocation. This can be used to execute arbitrary screen-based programs on a remote machine, which can be very useful, e.g. when implementing menu services. Multiple -t options force tty allocation, even if ssh has no local tty.</p>
</blockquote>
<p>Additionally you may also have to set the <em>TERM</em> environment variable on the server correctly as suggested in another post.</p>
</div>
<div class="post-text" itemprop="text">
<p>Have you tried using a different SSH client? Some SSH clients have special, built-in keymappings for different remote processes. I ran into this one a lot with emacs.</p>
<p>What client are you using? I'd recommend trying Putty and SecureCRT to compare their behavior.</p>
</div>
<div class="post-text" itemprop="text">
<p>For those using conda, installing the readline package from conda-forge channel will fix the problem:</p>
<pre><code>conda install -c conda-forge readline=6.2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I have run into this issue recently and after reading a lot about <code>pip install readline</code> (does not work for mac osx) and <code>pip install gnureadline</code> and not being satisfied, this is now my setup which enables using arrow keys in any python console:</p>
<ol>
<li>install gnureadline using <code>pip install gnureadline</code></li>
</ol>
<p>now you can either do <code>import gnureadline</code> (a step omitted in many tutorials) and arrow keys should work as expected. To make them work automatically follow the following steps:</p>
<ol start="2">
<li>create (or append to) file <code>~/.startup.py</code>: <code>import gnureadline</code></li>
<li>append to file <code>~/.bash_profile</code>: <code>export PYTHONSTARTUP=~/.startup.py</code></li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p>How's your env variable $TERM set [a] when things work fine and [b] when they don't?  Env settings are often the key to such problems.</p>
</div>
<div class="post-text" itemprop="text">
<p>Try getting a key code library running on the server. If that does not work try to download a library with read-key ability.</p>
</div>
<div class="post-text" itemprop="text">
<p>I was trying build Python 2.7 on Ubuntu 14.0. You will need libreadline-dev. However, if you get it from apt-get, the current version is 6.3, which is incompatible with Python 2.7 (not sure about Python 3). For example, the data type "Function" and "CPPFunction", which were defined in previous versions of readline has been removed in 6.3, as reported here:</p>
<p><a href="https://github.com/yyuu/pyenv/issues/126" rel="nofollow">https://github.com/yyuu/pyenv/issues/126</a></p>
<p>That is to say you need to get the source code of an earlier version of readline. I installed libreadline 5.2 from apt-get for the library, and get the source code of 5.2 for the header files. Put them in /usr/include. </p>
<p>Finally the issue has been resolved. </p>
</div>
<div class="post-text" itemprop="text">
<p>readline module has been deprecated which will cause invalid pointer error in latest python versions when executing quit() or exit() in python shell.
<code>pip install gnureadline</code> instead</p>
</div>
<span class="comment-copy">Smells of termtype problem.</span>
<span class="comment-copy">I think this belongs on server-fault. This is caused by an incorrect terminal type.</span>
<span class="comment-copy">I agree with cartman below that it's a readline issue, not a terminal type issue.</span>
<span class="comment-copy">easy_install readline and then easy_install ipython works perfect in mac.</span>
<span class="comment-copy">@LeonWANG gives a bad answer - don't install something as huge as anaconda just to get your .pystartup file working. Completely unnecessary.</span>
<span class="comment-copy">Thanks, I agree that readline seems to be the issue. The system does have /usr/lib/libreadline.so.5 though. There is no /etc/pythonstart.</span>
<span class="comment-copy">After some googling it seems python on that system might have to be recompiled, after installing readline-devel.</span>
<span class="comment-copy">Yes you will have to recompile.</span>
<span class="comment-copy">The environment variable is <code>PYTHONSTARTUP</code>, not <code>PYTHONSTART</code>.  Not sure about the distribution-specific <code>/etc/pythonstart</code> file.</span>
<span class="comment-copy">Actually, reading <a href="http://docs.python.org/2/tutorial/interactive.html" rel="nofollow noreferrer">docs.python.org/2/tutorial/interactive.html</a> gives all the info needed for a pystartup file.</span>
<span class="comment-copy">I had to install <code>libncurses-dev</code> on my Ubuntu machine, then readline installed correctly.</span>
<span class="comment-copy">Installed <code>ncurses-devel</code> on CentOS and then <code>readline</code> installed no problem. Interactive shell is now working.</span>
<span class="comment-copy">yum install ncurses-devel</span>
<span class="comment-copy">can't <code>pip install readline</code> on my OS X machine, fails every time even after successfully doing <code>brew install readline</code></span>
<span class="comment-copy">@user5359531 I also had to do <code>brew link readline</code></span>
<span class="comment-copy">Thank you so much man! This saved my life! :D</span>
<span class="comment-copy">After looking and looking I was able to fix the issue with this suggestion. Thanks!</span>
<span class="comment-copy">Won't this cause a problem if something calls v6, not realising that it's actually v7?</span>
<span class="comment-copy">I had the same problem, but instead of these instructions, I did <code>brew update &amp;&amp; brew upgrade</code>.  Whether this broke PHP in the process remains as yet to be seen.</span>
<span class="comment-copy">Thank you, the only solution in this post that actually works...</span>
<span class="comment-copy">is there an equivalent if you are using system Python 2.7.10?</span>
<span class="comment-copy">@user5359531 I've updated the answer with an <code>easy_install</code> option</span>
<span class="comment-copy">OSX 10.12 users also: <a href="https://stackoverflow.com/questions/7375545/ipython-complaining-about-readline" title="ipython complaining about readline">stackoverflow.com/questions/7375545/â€¦</a></span>
<span class="comment-copy">Using <code>easy_install</code> works for me, while the one with pip doesn't work.</span>
<span class="comment-copy">This combined with the <code>brew link readline</code> (even though it was already linked) fixed it for me.</span>
<span class="comment-copy">Thanks for improving my quality of life! {;-) On Centos 5.5, that's yum install readline-devel and you don't have to explicitly specify readline in the recompilation</span>
<span class="comment-copy">How do we recompile Python? Do I need to install extract python from source (./configure, make, make install), set up virtualenv and install all my packages again?</span>
<span class="comment-copy">OR do <code>pip install readline</code>.</span>
<span class="comment-copy">Yay! This in the only thing that works now.</span>
<span class="comment-copy">Only this worked for me!</span>
<span class="comment-copy">this works, <i>but</i> it means I need to add <code>import gnureadline</code> at the top of every interactive session which is really annoying.  Is there a way to kick this off at the beginning of every interactive session?</span>
<span class="comment-copy">@Panchishin try to use the <a href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONSTARTUP" rel="nofollow noreferrer">PYTHONSTARTUP</a> environment variable to name a file that has Python commands executed before the interactive prompt is displayed (i.e. <code>import gnureadline</code>). For possible other ideas also see: <a href="https://stackoverflow.com/questions/9409762/run-python-command-line-interpreter-with-imports-loaded-automatically">run python command line interpreter with imports loaded automatically</a></span>
<span class="comment-copy">I tried all other solutions but this one worked for me for my Python 3.6</span>
<span class="comment-copy">make sure to call <code>import gnureadline</code> in the shell for it to work</span>
<span class="comment-copy">No need to use sudo</span>
<span class="comment-copy">Good call with the readline-devel tip. It worked for me on a Centos6.5 machine rumming python 2.7.8. I directly called <code>pip install readline</code> without recompiling python and it worked fine.</span>
<span class="comment-copy">CentOS 6.8, Python2.7.12, a success</span>
<span class="comment-copy">In my case, <code>readline</code> is already installed, I have to do <code>conda install ncurses</code> to make it work.</span>
<span class="comment-copy">Thanks, just tried ssh -t, but it didn't help.</span>
<span class="comment-copy">Hmm, I just use the ssh command in the terminal (ssh -v says OpenSSH_3.9p1, OpenSSL 0.9.7a Feb 19 2003).</span>
<span class="comment-copy">Try out Putty (its free) and get back to us :)</span>
<span class="comment-copy">Okay, I just installed putty and used it to connect to the machine, but the behavior there is the same.</span>
<span class="comment-copy">:( Definitely a server-side issue then. I will look into it and get back to you.</span>
<span class="comment-copy">Using the ssh command to connect to some <i>other</i> machine works fine: There, I have no problems with the arrow keys. It seems to be the one particular system that has trouble.</span>
<span class="comment-copy">I just tried some TERM variable values: vt102, vt220, ansi, xterm, but none of them changed the behavior.</span>
