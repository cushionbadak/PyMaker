<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/303200/how-do-i-remove-delete-a-folder-that-is-not-empty-with-python">How do I remove/delete a folder that is not empty with Python?</a>
<span class="question-originals-answer-count">
                    17 answers
                </span>
</li>
</ul>
</div>
<p>i wish to delete a local directory if it already exists. below is my code:</p>
<pre><code>import sys
import os
from pyspark import SparkContext
from pyspark import SparkConf

conf=SparkConf().setAppName('pyspark')
sc=SparkContext(conf=conf)

data=sc.textFile('file:///home/cloudera/Downloads/SAN_SALES_EXTRACT_TRANS_LEVEL_D0906.txt')
datamap=data.map(lambda x: ((str(x.split(',')[1]).strip(),int(x.split(",")[0])),float(x.split(",")[10])))
datagrouped=datamap.reduceByKey(lambda x,y: x+y)
if (os.path.exists("file:///home/cloudera/Downloads/store_perday_rev")):
        os.remove("file:///home/cloudera/Downloads/store_perday_rev")
else:
        datagrouped.sortByKey().saveAsTextFile("file:///home/cloudera/Downloads/store_perday_rev")
#for i in datagrouped.sortByKey().take(20):
#       print(i)
</code></pre>
<p>It doesn't delete the directory. What am i doing wrong?</p>
</div>
<div class="post-text" itemprop="text">
<p>Try os.rmdir() instead.</p>
<p>os.remove() only works for a file path, not for a directory.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can try these options .</p>
<pre><code>import os
os.rmdir("C:/test/delete/pydelete")
</code></pre>
<p>i am able to remove the folder.If you have the data in this folder then you need to call.</p>
<p><a href="https://docs.python.org/3/library/shutil.html#shutil.rmtree" rel="nofollow noreferrer">shutil.rmtree()</a></p>
<p><a href="https://i.stack.imgur.com/c9CGd.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/c9CGd.png"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>are your trying to remove the directory or the file?</p>
<p>if you are trying to remove the directory please refer to the following link:</p>
<pre><code>https://stackoverflow.com/questions/303200/how-do-i-remove-delete-a-folder-that-is-not-empty-with-python
</code></pre>
<p>Also refer to the python docs:</p>
<pre><code>https://docs.python.org/2/library/os.html
</code></pre>
</div>
<span class="comment-copy">It did not work. os.rmdir("file:///home/cloudera/Downloads/store_perday_rev") returns "no such file or directory"</span>
