<div class="post-text" itemprop="text">
<p>I am trying to download tgz file from this website:
<a href="https://plg.uwaterloo.ca/cgi-bin/cgiwrap/gvcormac/foo07" rel="nofollow noreferrer">https://plg.uwaterloo.ca/cgi-bin/cgiwrap/gvcormac/foo07</a></p>
<p>here is my script:</p>
<pre><code>import os
from six.moves import urllib
import tarfile

spam_path=os.path.join('ML', 'spam')
root_download='https://plg.uwaterloo.ca/cgi-bin/cgiwrap/gvcormac/foo07'
spam_url=root_download+'255 MB Corpus (trec07p.tgz)'

if not os.path.isdir(spam_path):
    os.makedirs(spam_path)

path=os.path.join(spam_path, 'trec07p.tgz')
if not os.path.isfile('trec07p.tgz'):
    urllib.request.urlretrieve(spam_url,path)
tar_file=tarfile.open(path)
</code></pre>
<p>I am not sure what I am missing but the following error is returned:</p>
<pre><code>---------------------------------------------------------------------------
ReadError                                 Traceback (most recent call last)
&lt;ipython-input-21-5644813e0670&gt; in &lt;module&gt;()
     18 if not os.path.isfile('trec07p.tgz'):
     19     urllib.request.urlretrieve(spam_url,path)
---&gt; 20 tar_file=tarfile.open(path)
     21 # tar_file.extractall(path)
     22 # tar_file.close()

/anaconda/lib/python2.7/tarfile.pyc in open(cls, name, mode, fileobj, bufsize, **kwargs)
   1678                         fileobj.seek(saved_pos)
   1679                     continue
-&gt; 1680             raise ReadError("file could not be opened successfully")
   1681 
   1682         elif ":" in mode:

ReadError: file could not be opened successfully
</code></pre>
<p>Thank you in advance for your help!</p>
</div>
<div class="post-text" itemprop="text">
<p>You can add additional parameters to <a href="https://docs.python.org/3/library/tarfile.html#tarfile.open" rel="nofollow noreferrer"><code>tarfile.open</code></a>. You need to set the mode to <code>'r:gz'</code>.</p>
<pre><code>tarfile.open(path, 'r:gz')
</code></pre>
<p>Working example after <em>Accept Agreement</em>:</p>
<pre><code>import tarfile

import requests

URL = 'https://plg.uwaterloo.ca/cgi-bin/cgiwrap/gvcormac/trec07p.tgz'
FILE = '/home/blake/Downloads/trec07p.tgz'

resp = requests.get(URL, stream=True)
resp.raise_for_status()

with open(FILE, 'wb') as out_file:
    for line in resp.iter_content(chunk_size=1024*4, decode_unicode=False):
        out_file.write(line)


f = tarfile.open(FILE, 'r:gz')
print(f.getnames())

f.close()
</code></pre>
<p>Output:</p>
<pre><code>['trec07p/data/inmail.35059',
 'trec07p/data/inmail.34430',
 'trec07p/data/inmail.45722',
 ..
 ..]
</code></pre>
</div>
<span class="comment-copy">I tried all modes 'r',  'r:*',  'r:',  'r:gz',  'r:bz2' but they all retuned error</span>
<span class="comment-copy">It doesn't work because that site doesn't let you download their corpus automatically -- you have to click through an agreement. Your URL is bogus too. See edit.</span>
<span class="comment-copy">@blakev I have the same problem. I downloaded the compressed file from the website but there is a problem in reading the compressed file by tarfile module. So I don't think the problem relates to the website.</span>
