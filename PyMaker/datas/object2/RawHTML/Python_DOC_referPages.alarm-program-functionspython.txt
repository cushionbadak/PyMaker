<div class="post-text" itemprop="text">
<p>I have a python file and I am running the file.  </p>
<p>If Windows is shutdown and booted up again, how I can run that file every time Windows starts?</p>
</div>
<div class="post-text" itemprop="text">
<p>Depending on what the script is doing, you may:</p>
<ol>
<li>package it into a service, that should then be installed</li>
<li>add it to the windows registry (HKCU\Software\Microsoft\Windows\CurrentVersion\Run)</li>
<li>add a shortcut to it to the startup folder of start menu - its location may change with OS version, but installers always have some instruction to put a shortcut into that folder</li>
<li>use windows' task scheduler, and then you can set the task on several kind of events, including logon and on startup.</li>
</ol>
<p>The actual solution depends on your needs, and what the script is actually doing.<br/>
Some notes on the differences:</p>
<ul>
<li>Solution #1 starts the script with the computer, while solution #2 and #3 start it when the user who installed it logs in.  </li>
<li>It is also worth to note that #1 always start the script, while #2 and #3 will start the script only on a specific user (I think that if you use the default user then it will start on everyone, but I am not sure of the details).  </li>
<li>Solution #2 is a bit more "hidden" to the user, while solution #3 leaves much more control to the user in terms of disabling the automatic start.  </li>
<li>Finally, solution #1 requires administrative rights, while the other two may be done by any user.</li>
<li>Solution #4 is something I discovered lately, and is very straightforward. The only problem I have noticed is that the python script will cause a small command window to appear.</li>
</ul>
<p>As you can see, it all boils down to what you want to do; for instance, if it is something for your purposes only, I would simply drag it into startup folder.  </p>
<p><strong>In any case, lately I am leaning on solution #4, as the quickest and most straightforward approach.</strong></p>
</div>
<div class="post-text" itemprop="text">
<p>In the following startup directory (at least this path exists on Windows XP):</p>
<pre><code>C:\Documents and Settings\All Users\Start Menu\Programs\Startup
</code></pre>
<p>put a shortcut to your python program. It should be executed every time your system starts up.</p>
</div>
<div class="post-text" itemprop="text">
<p>if can simply add the following code to your script. Nevertheless, this only works on windows!:</p>
<pre><code>import getpass
USER_NAME = getpass.getuser()


def add_to_startup(file_path=""):
    if file_path == "":
        file_path = os.path.dirname(os.path.realpath(__file__))
    bat_path = r'C:\Users\%s\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup' % USER_NAME
    with open(bat_path + '\\' + "open.bat", "w+") as bat_file:
        bat_file.write(r'start "" %s' % file_path)
</code></pre>
<p>this function create a bat file in the startup folder that run your script.</p>
<p>the file_path is the path to the file that you would like you run when your computer opens. you can leave it blank in order to add the running script to startup. </p>
</div>
<div class="post-text" itemprop="text">
<p>Haven't tested this, but I'd create a batch file that contains "python yourfile.py" and put that in the autostart folder.</p>
</div>
<div class="post-text" itemprop="text">
<p>try adding an entry to "HKLM/SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce" .
Right click -&gt;new -&gt; string value -&gt; add file path</p>
</div>
<div class="post-text" itemprop="text">
<p>You can put run_script.cmd in</p>
<pre><code>C:\Users\username\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
</code></pre>
<p>Content of run_script.cmd</p>
<pre><code>python path\to\your\script.py
</code></pre>
</div>
<span class="comment-copy">FYI:  If you use pythonw.exe instead of python.exe to start your script, it shouldn't show the command window.</span>
<span class="comment-copy">i want to do that from command line and window 7 does not give permission to write.</span>
<span class="comment-copy">@sam: I don't know what's the startup folder path in Windows 7. What I gave as an example is startup folder for all users. There should exist one for each user, and you can put the shortcut there. The shortcut can be a simple <code>bat</code> file with contents <code>python path_to_your_python_program.py</code></span>
<span class="comment-copy">Why is there a <code>""</code> after <code>start</code>. I thought it had to be around the <code>%s</code> to handle spaces but when I tried that, it didn't work (just opened a command prompt)</span>
<span class="comment-copy">There is one error ,It is in line 2 of function add_to_startup</span>
<span class="comment-copy">os.path.dirname returns the folder's path rather than including the file's path but this can easily be fixed</span>
<span class="comment-copy">where is this autostart folder is?</span>
<span class="comment-copy">On Windows 7 you can find it here: C:\Users\{my user}\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup</span>
<span class="comment-copy">What is difference between Run and RunOnce?</span>
<span class="comment-copy">@Santosh Kumar By default, the values of RunOnce registry keys are deleted immediate before running on the command line. <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/aa376977(v=vs.85).aspx" rel="nofollow noreferrer">msdn.microsoft.com/en-us/library/windows/desktop/â€¦</a></span>
<span class="comment-copy">Isn't this only ran at login?</span>
