<div class="post-text" itemprop="text">
<p>As Kaggle provides a training set and a test set, I would like to know a way to generate a validation set (dev set) from this training set.
The goal is to have three sets :<br/>
- Training set + Validation set = Kaggle's training set <br/>
- Test set = Kaggle's test set <br/><br/>
The fact is that the validation set has to have the same distribution as the test one. I would like to know if there exists a (simple) way to generate a validation set which respects this property. I am coding with Python 3 if that can help you to answer me. <br/><br/>
Many thanks</p>
</div>
<div class="post-text" itemprop="text">
<p>The simplest way to split the training data into train and validation set is to use train_test_split method from sklearn.</p>
<pre><code>from sklearn.model_selection import train_test_split
train_set, val_set = train_test_split(train_data, test_size=0.2)
</code></pre>
<p>However, the split of data will happen at random and not ensure equal distribution of classes or some other feature. Let's assume that we want to split based on distribution of target label (eg - train_data['y']). Then we should use StratifiedShuffleSplit instead.</p>
<pre><code>from sklearn.model_selection import StratifiedShuffleSplit
split = StratifiedShuffleSplit(n_splits=1, test_size=0.2)
for train_index, val_index in split.split(train_data, train_data['y']):
    strat_train_data = train_data.loc[train_index]
    strat_val_data = train_data.loc[val_index]
</code></pre>
<p>In this case, the training data will be split into train and val set, and the distribution of 'y' will be similar in both <code>strat_train_data</code> and <code>strat_val_data</code>. If we want the split to happen based on a particular feature (eg - gender, income group etc), replace the y-parameter of split() function accordingly.</p>
</div>
<span class="comment-copy">Maybe this helps? <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html" rel="nofollow noreferrer">scikit-learn.org/stable/modules/generated/â€¦</a></span>
<span class="comment-copy">Not really. The function train_test_split allows us to generate train &amp; validation sets randomly. But thank you for your answer.</span>
<span class="comment-copy">I am not sure it allows me to generate a validation set that has the same distribution as the test set. Maybe I should define what I understand from 'having the same distribution'. So, assume that we have N features x1,x2,...,xN. Two datasets - let's say A and B - have the same distribution, if and only if, A(xk) and B(xk) have the same distribution for all 1 &lt;= k &lt;= N. I want to generate this validation set which has this property as I read that validation &amp; testing sets should come from the same distribution.</span>
