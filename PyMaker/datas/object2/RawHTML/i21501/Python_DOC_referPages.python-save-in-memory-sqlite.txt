<div class="post-text" itemprop="text">
<p>Is it possible to save my in-memory sqlite database to hard disk?
If it is possible, some python code would be awesome.</p>
<p>Thanks in advance.</p>
<p><strong>EDIT:</strong></p>
<p>I succeeded this task by using apsw . It works like a charm. Thanks for your contribution.</p>
</div>
<div class="post-text" itemprop="text">
<p>(Disclosure:  I am the APSW author)</p>
<p>The only safe way to make a binary copy of a database is to use the backup API that is part of SQLite and is exposed by APSW.  This does the right thing with ordering, locking and concurrency.</p>
<p>To make a SQL (text) copy of the a database then use the APSW shell which includes a .dump implementation that is very complete.  You can use cursor.execute() to turn the SQL back into a database.</p>
<p>On recent platforms you are unlikely to see much of a difference between a memory database and a disk one (assuming you turned journaling off for the disk) as the operating system maintains a file system cache.  Older operating systems like Windows XP did have a default configuration of only using 10MB of memory for file cache no matter how much RAM you have.</p>
</div>
<div class="post-text" itemprop="text">
<p>Yes. When you create the connection to the database, replace <code>:memory:</code> with the path where you want to save the DB.</p>
<p>sqlite uses caches for file based DBs, so this shouldn't be (much) slower.</p>
</div>
<div class="post-text" itemprop="text">
<p>Per the <a href="https://docs.python.org/3/library/sqlite3.html" rel="nofollow">sqlite3 python documentation</a>, you can use the <code>iterdump()</code> method to make a .sql file dump of your in-memory database, and then it's trivial to apply that .sql file to a new sqlite file database.</p>
<pre><code># Convert file existing_db.db to SQL dump file dump.sql
import sqlite3, os

con = sqlite3.connect('existing_db.db')
with open('dump.sql', 'w') as f:
    for line in con.iterdump():
        f.write('%s\n' % line)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Open a disk based database and just copy everything from one to the other. </p>
</div>
<div class="post-text" itemprop="text">
<pre><code>import apsw

memconn = apsw.Connection(":memory:")
memcursor = memconn.cursor()
memcursor.execute("create table foo(x,y,z)")
memcursor.execute("insert into foo values(?,?,?)", (1, 1.1, None))

thediskconn = apsw.Connection("adisk.db")
with thediskconn.backup("main", memconn, "main") as backup:
    backup.step() # copy whole database in one go

memcursor.close()
memconn.close()
#continue with thediskconn
</code></pre>
</div>
<span class="comment-copy">do you mean creating a DB in <code>:memory:</code>, then working with it and saving it to disk? what would this give you vs. just creating it on disk in the first place?</span>
<span class="comment-copy">@Shansai: As well as thanks, (1) accept the answer (2) upvote it.</span>
<span class="comment-copy">I had to create an empty file and give its path in place of <code>:memory:</code>.</span>
<span class="comment-copy">Can you supply me some python code?</span>
