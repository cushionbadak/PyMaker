<div class="post-text" itemprop="text">
<p><a href="https://i.stack.imgur.com/DRlpd.jpg" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/DRlpd.jpg"/></a>I have an input in json format which contains table information. Now I want to extract the information from {tables--&gt; rows --&gt; content--&gt;"DESCRIPTION"}. How to extract the content from each?</p>
<blockquote>
<p>input.json</p>
</blockquote>
<pre><code>{"tables": [
    {
        "bbox": [
            186,
            858,
            1158,
            1218
        ],
        "column_types": [
            "table_column_description",
            "table_column_other",
            "table_column_quantity",
            "table_column_quantity",
            "table_column_quantity",
            "table_column_quantity",
            "table_column_rate",
            "table_column_amount_total"
        ],
        "page": 0,
        "rows": [
            {
                "cells": [
                    {
                        "bbox": [
                            186,
                            858,
                            408,
                            918
                        ],
                        "content": "DESCRIPTION",
                        "value": "DESCRIPTION",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            414,
                            858,
                            480,
                            918
                        ],
                        "content": "M4A\nCode",
                        "value": "M4A\nCode",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            558,
                            858,
                            648,
                            918
                        ],
                        "content": "AMOUNT\n(RM)",
                        "value": "AMOUNT\n(RM)",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            648,
                            858,
                            750,
                            918
                        ],
                        "content": "DISCOUNT\n0RM)",
                        "value": "DISCOUNT\n0RM)",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            744,
                            858,
                            870,
                            918
                        ],
                        "content": "GROSS AMOUNT\n(RM)",
                        "value": "GROSS AMOUNT\n(RM)",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            876,
                            858,
                            954,
                            918
                        ],
                        "content": "GST\n(RM)",
                        "value": "GST\n(RM)",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            954,
                            858,
                            1008,
                            918
                        ],
                        "content": "TAX\nCODE",
                        "value": "TAX\nCODE",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            1068,
                            858,
                            1158,
                            918
                        ],
                        "content": "PAYABLE\n(PRM)",
                        "value": "PAYABLE\n(PRM)",
                        "value_type": "text"
                    }
                ],
                "type": "header"
            },
            {
                "cells": [
                    {
                        "bbox": [
                            186,
                            972,
                            408,
                            1008
                        ],
                        "content": "EKOOI -CONSULTATION",
                        "value": "EKOOI -CONSULTATION",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            414,
                            972,
                            480,
                            1008
                        ],
                        "content": "",
                        "value": "",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            558,
                            972,
                            648,
                            1008
                        ],
                        "content": "90.00",
                        "value": "90.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            648,
                            972,
                            750,
                            1008
                        ],
                        "content": "0.00",
                        "value": "0.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            744,
                            972,
                            870,
                            1008
                        ],
                        "content": "90.00",
                        "value": "90.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            876,
                            972,
                            954,
                            1008
                        ],
                        "content": "5.40",
                        "value": "5.40",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            954,
                            972,
                            1008,
                            1008
                        ],
                        "content": "SR",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            1068,
                            972,
                            1158,
                            1008
                        ],
                        "content": "95.40",
                        "value": "95.40",
                        "value_type": "number"
                    }
                ],
                "type": "data"
            },
            {
                "cells": [
                    {
                        "bbox": [
                            186,
                            1008,
                            408,
                            1044
                        ],
                        "content": "EKOOI - PROCEDURE FEE",
                        "value": "EKOOI - PROCEDURE FEE",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            414,
                            1008,
                            480,
                            1044
                        ],
                        "content": "",
                        "value": "",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            558,
                            1008,
                            648,
                            1044
                        ],
                        "content": "260.00",
                        "value": "260.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            648,
                            1008,
                            750,
                            1044
                        ],
                        "content": "(26.00)",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            744,
                            1008,
                            870,
                            1044
                        ],
                        "content": "234.00",
                        "value": "234.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            876,
                            1008,
                            954,
                            1044
                        ],
                        "content": "14.04",
                        "value": "14.04",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            954,
                            1008,
                            1008,
                            1044
                        ],
                        "content": "SR",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            1068,
                            1008,
                            1158,
                            1044
                        ],
                        "content": "248.04",
                        "value": "248.04",
                        "value_type": "number"
                    }
                ],
                "type": "data"
            },
            {
                "cells": [
                    {
                        "bbox": [
                            186,
                            1038,
                            408,
                            1068
                        ],
                        "content": "EKOOI -TREATMENT FEE",
                        "value": "EKOOI -TREATMENT FEE",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            414,
                            1038,
                            480,
                            1068
                        ],
                        "content": "",
                        "value": "",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            558,
                            1038,
                            648,
                            1068
                        ],
                        "content": "125.00",
                        "value": "125.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            648,
                            1038,
                            750,
                            1068
                        ],
                        "content": "0.00",
                        "value": "0.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            744,
                            1038,
                            870,
                            1068
                        ],
                        "content": "125.00",
                        "value": "125.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            876,
                            1038,
                            954,
                            1068
                        ],
                        "content": "7.50",
                        "value": "7.50",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            954,
                            1038,
                            1008,
                            1068
                        ],
                        "content": "SR",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            1068,
                            1038,
                            1158,
                            1068
                        ],
                        "content": "132.50",
                        "value": "132.50",
                        "value_type": "number"
                    }
                ],
                "type": "data"
            },
            {
                "cells": [
                    {
                        "bbox": [
                            186,
                            1062,
                            408,
                            1170
                        ],
                        "content": "COLONOSCOPY PLUS/MINUS\nIBCOPIO/DESTRUCTION OF\nLKSOON- TREATMENT FEE",
                        "value": "COLONOSCOPY PLUS/MINUS IBCOPIO/DESTRUCTION OF LKSOON- TREATMENT FEE",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            414,
                            1062,
                            480,
                            1170
                        ],
                        "content": "H2000",
                        "value": "H2000",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            558,
                            1062,
                            648,
                            1170
                        ],
                        "content": "1,125.00\n125.00\n--o.",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            648,
                            1062,
                            750,
                            1170
                        ],
                        "content": "(112.50)\n0.00\n-.--",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            744,
                            1062,
                            870,
                            1170
                        ],
                        "content": "1,012.50\n125.00\n-----",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            876,
                            1062,
                            954,
                            1170
                        ],
                        "content": "60.75\n7.50\n.--",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            954,
                            1062,
                            1008,
                            1170
                        ],
                        "content": "5R\n-",
                        "value": "5",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            1068,
                            1062,
                            1158,
                            1170
                        ],
                        "content": "1,073.25\n132.50\n---.0-",
                        "value": null,
                        "value_type": null
                    }
                ],
                "type": "data"
            },
            {
                "cells": [
                    {
                        "bbox": [
                            186,
                            1158,
                            408,
                            1194
                        ],
                        "content": "OGDS MITH BIOPSY",
                        "value": "OGDS MITH BIOPSY",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            414,
                            1158,
                            480,
                            1194
                        ],
                        "content": "G6500",
                        "value": "G6500",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            558,
                            1158,
                            648,
                            1194
                        ],
                        "content": "405.00",
                        "value": "405.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            648,
                            1158,
                            750,
                            1194
                        ],
                        "content": "40.50)\nT0.2v",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            744,
                            1158,
                            870,
                            1194
                        ],
                        "content": "364.50",
                        "value": "364.50",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            876,
                            1158,
                            954,
                            1194
                        ],
                        "content": "21.87",
                        "value": "21.87",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            954,
                            1158,
                            1008,
                            1194
                        ],
                        "content": "SR",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            1068,
                            1158,
                            1158,
                            1194
                        ],
                        "content": "386.37",
                        "value": "386.37",
                        "value_type": "number"
                    }
                ],
                "type": "data"
            },
            {
                "cells": [
                    {
                        "bbox": [
                            186,
                            1182,
                            408,
                            1218
                        ],
                        "content": "EKOOI - TREATMENT FEE",
                        "value": "EKOOI - TREATMENT FEE",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            414,
                            1182,
                            480,
                            1218
                        ],
                        "content": "",
                        "value": "",
                        "value_type": "text"
                    },
                    {
                        "bbox": [
                            558,
                            1182,
                            648,
                            1218
                        ],
                        "content": "125.00",
                        "value": "125.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            648,
                            1182,
                            750,
                            1218
                        ],
                        "content": "0.00",
                        "value": "0.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            744,
                            1182,
                            870,
                            1218
                        ],
                        "content": "125.00",
                        "value": "125.00",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            876,
                            1182,
                            954,
                            1218
                        ],
                        "content": "7.50",
                        "value": "7.50",
                        "value_type": "number"
                    },
                    {
                        "bbox": [
                            954,
                            1182,
                            1008,
                            1218
                        ],
                        "content": "SR",
                        "value": null,
                        "value_type": null
                    },
                    {
                        "bbox": [
                            1068,
                            1182,
                            1158,
                            1218
                        ],
                        "content": "132.50",
                        "value": "132.50",
                        "value_type": "number"
                    }
                ],
                "type": "data"
            }
        ]
    }
]`
</code></pre>
<blockquote>
<p>Expected Output in --&gt; Excel or csv</p>
</blockquote>
<p>DESCRIPTION  M4A\nCode AMOUNT\n(RM) DISCOUNT\n0RM) GROSS AMOUNT\n(RM)
  EKOOI -CONSULTATION     90.00</p>
<pre><code>import json

f = open('input_json_file.json')
data = json.load(f)

print(data['tables'][0]["rows"][0]["cells"][0]["content"])
print(data['tables'][0]["rows"][0]["cells"][1]["content"])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You only need to extract some fields from your json file, and convert that to a csv file. But as some of your fields contain special characters (<code>\n</code>), I strongly advise you to use the csv module to write the csv file.</p>
<p>Code can be as simple as:</p>
<pre><code>import json
import csv

with open('input.json') as jsonfile, open('output.csv', 'w', encoding='utf-8',
                                          'newline'='') as csvfile:
    js = json.load(jsonfile)
    wr = csv.writer(csvfile)
    for table in js['tables']:
        for row in table['rows']:
            wr.writerow([cell['content'] for cell in row['cells']])
</code></pre>
<p>If your localized version of Excel uses a delimiter other than the comma (<code>,</code>), for example a semicolon (<code>;</code>) you just have to declare if to the <code>csv.writer</code>:</p>
<pre><code>    wr = csv.writer(csvfile, delimiter=';')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This code converts the json to CSV.</p>
<pre><code>import json
import sys
import os
from collections import OrderedDict                


def createOp(ipJsonFile, opCsvFile):
    jsonData = None;
    with open(ipJsonFile) as jFH:
        jsonData = json.load(jFH, object_pairs_hook=OrderedDict)

    oFH = open(opCsvFile,"w");


    for row in jsonData["tables"][0]["rows"]:
        #print "id:",id, row;
        line = "";
        for col in row["cells"]:
            #print col["value"];
            val = col["value"];
            if val != None:
                val = val.replace("\n","-");
            line += str(val) + ",";
        #print line;
        oFH.write(line + "\n")
    oFH.close();        

def main(args):
    createOp(args[1], args[2]);


if __name__ == '__main__':
    if len(sys.argv) &lt; 3:
        print "json_to_csv.py &lt;ip json file&gt; &lt;op csv file&gt;";
        sys.exit(-1);
    main(sys.argv)        
</code></pre>
<p>Run this code like this    </p>
<pre><code>python json_to_csv.py &lt;ip json&gt; &lt;op csv file&gt;
</code></pre>
<p>I changed the code(just 1 line) to run it on Python3</p>
<pre><code>import json
import sys
import os
from collections import OrderedDict


def createOp(ipJsonFile, opCsvFile):
    jsonData = None;
    with open(ipJsonFile) as jFH:
        jsonData = json.load(jFH, object_pairs_hook=OrderedDict)

    oFH = open(opCsvFile,"w");


    for row in jsonData["tables"][0]["rows"]:
        #print "id:",id, row;
        line = "";
        for col in row["cells"]:
            #print col["value"];
            val = col["value"];
            if val != None:
                val = val.replace("\n","-");
            line += str(val) + ",";
        #print line;
        oFH.write(line + "\n")
    oFH.close();

def main(args):
    createOp(args[1], args[2]);


if __name__ == '__main__':
    if len(sys.argv) &lt; 3:
        print("json_to_csv.py &lt;ip json file&gt; &lt;op csv file&gt;");
        sys.exit(-1);
    main(sys.argv)
</code></pre>
<p>And it works properly.</p>
</div>
<span class="comment-copy">Can you put a sample output for couple of rows with the input given by you?</span>
<span class="comment-copy">i want the output in excel like in the picture</span>
<span class="comment-copy">If you are familiar with pandas, there are functions to <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_json.html" rel="nofollow noreferrer">read json</a> files.</span>
<span class="comment-copy">i am new new to python .please guide me with the code</span>
<span class="comment-copy">thank you so much i got the output really i m very happy</span>
<span class="comment-copy">thanks a lot but i m getting a delimiter error while running this code</span>
<span class="comment-copy">i m running on python 3</span>
<span class="comment-copy">I think you need to change the print statements in my code and i am not so well versed in Python 3.</span>
<span class="comment-copy">currently i m using the above code to get output please check now only i added that code</span>
<span class="comment-copy">I ran the code with python3 and it works fine. I have added that code(Edited my answer)</span>
