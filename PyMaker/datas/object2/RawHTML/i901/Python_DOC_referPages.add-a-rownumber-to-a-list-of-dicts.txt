<div class="post-text" itemprop="text">
<p>I have the following dict:</p>
<pre><code>[
    {"new": "item"},
    {"from": "here"}
]
</code></pre>
<p>Is there a one-liner I can do to add in the index position of that item, for example so it ends up as:</p>
<pre><code>[
    {"idx": 0, "new": "item"},
    {"idx": 1, "from": "here"}
]
</code></pre>
<p>Note: I'd also like to make sure the position of the <code>idx</code> is at the start (dict ordering supported in python3).</p>
</div>
<div class="post-text" itemprop="text">
<p>You could use a <a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions" rel="nofollow noreferrer">list comprehension</a> with <a href="https://docs.python.org/3/library/functions.html#enumerate" rel="nofollow noreferrer">enumerate</a>:</p>
<pre><code>data = [
    {"new": "item"},
    {"from": "here"}
]

result = [{ **e, "idx" : i } for i, e in enumerate(data)]
print(result)
</code></pre>
<p><strong>Output</strong></p>
<pre><code>[{'idx': 0, 'new': 'item'}, {'from': 'here', 'idx': 1}]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>A oneliner recreates the dictionary - that is very wasteful - lots of time/memory etc needed to allocate and create the new dict. It is better to simply iterate your list of dictionaries and add the index key-value pair:</p>
<pre><code>k = [ {"new": "item"}, {"from": "here"}]

for i,d in enumerate(k):
    d["idx"] = i 

print(k)
</code></pre>
<p>Output:</p>
<pre><code>[{'new': 'item', 'idx': 0}, {'from': 'here', 'idx': 1}]
</code></pre>
</div>
<span class="comment-copy">in python3 this would add it to the end of the index, any way to get the <code>index</code> at the start?</span>
<span class="comment-copy">@DavidL Try: <code>{ "idx" : i,  **e }</code>?</span>
<span class="comment-copy">that works, thanks.</span>
<span class="comment-copy">could you please clarify what you mean by 'wasteful' ? Does it take up a lot more time/memory, or what do you mean exactly?</span>
<span class="comment-copy">thanks for the update. Is it possible to push it to the first position though? I'd like to <code>idx</code> column to be the first column.</span>
<span class="comment-copy">Think a list of 100 dicts, each with 10 key/value entries - the oneliner would create a new list, instantiate 100 new dicts, create 10 key/values in each ... to (in total) add 100 new keys in total ... if you remove the name of the source-list python can release the ressources for that .. but still - you need to instantiate a lot of stuff for just 1 new value per dict.</span>
<span class="comment-copy">dicts are input-ordered (3.7 / 3.6 IPython) - the only way to reorder a key is to recreate the full dict sorted as you like</span>
