<div class="post-text" itemprop="text">
<p>I am on windows system.</p>
<p>I created two utf-8 file <code>python_print.py</code> for python and <code>perl_print.pl</code> for perl respectively, the two files contains same line as below</p>
<pre><code>print("中")
</code></pre>
<p>and perl has <code>;</code> delimiter.</p>
<p>My CMD is in <code>code page 936</code> by default, and I run </p>
<pre><code>python python_print.py
</code></pre>
<p>I got</p>
<pre><code>中
</code></pre>
<p>However, when I run </p>
<pre><code>perl perl_print.pl
</code></pre>
<p>for the first time, it gives</p>
<pre><code>涓
</code></pre>
<p>running it for the second time, I got</p>
<p><a href="https://i.stack.imgur.com/Eg1cw.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/Eg1cw.png"/></a></p>
<p>why??</p>
<p>I continue testing, I run <code>chcp 65001</code> to change cmd encoding to utf-8, and this time, both python and perl gives correct <code>"中"</code>.</p>
<p>Now I am completely confused, it seems that print in python and perl are quite different. It seems that perl alway print out utf8 bytes? and python print can detect CMD code page to print correct byte? Can somebody explain my test result?</p>
</div>
<div class="post-text" itemprop="text">
<p>perl is printing the literal bytes you have in your source file. It sees the string as "\xe4\xb8\xad" unless you explicitly declare that your source file is utf8 with <code>use utf8;</code>.</p>
<p>Once you do that, you would (if you enabled warnings as you should) get a <code>Wide character in print</code> warning; perl requires you to specify the encoding to be used when outputing non-ASCII characters.  You can do that with <code>use open ':std' =&gt; ':encoding(cp936)';</code> or with <code>binmode STDOUT, ':encoding(cp936)';</code> or (for some filehandle you are opening) with the 3rd argument to <code>open</code>.</p>
</div>
<span class="comment-copy">Hi, ysth, Thank you so much for quick response. So what about python, why it can print correctly in both code page?</span>
<span class="comment-copy">don't know; are there environment variables set that indicate the encoding?</span>
<span class="comment-copy">In Python3, <a href="https://docs.python.org/3/howto/unicode.html#the-string-type" rel="nofollow noreferrer">"The default encoding for Python source code is UTF-8, so you can simply include a Unicode character in a string literal"</a>.</span>
<span class="comment-copy">Note that Perl tried to set handles to open with a UTF-8 encoding (if your locale iis UTF-8) by default once. It <a href="https://perldoc.pl/perl581delta#UTF-8-no-longer-default-under-UTF-8-locales" rel="nofollow noreferrer">did not work out</a>. You can activate this behavior yourself by passing <code>-CLSD</code>, but it will probably break any module you use that is not expecting it.</span>
<span class="comment-copy">Regarding the source code encoding, there was <a href="https://www.nntp.perl.org/group/perl.perl5.porters/2017/10/msg246838.html" rel="nofollow noreferrer">a proposal</a> to eventually make <code>use utf8</code> the default, but it has not yet been acted upon.</span>
