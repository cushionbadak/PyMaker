<div class="post-text" itemprop="text">
<p>I want this program to automatically check if a file exists or not. I want a way for it to always check the document folder of the current user.
<code>if  os.path.exists(r"%SystemDrive%\Users\{username}\Documents\QQOutput.bas"):</code>
So like the target is always the current user that is logged in and I don't have to keep changing the code for different users and etc. I don't want to create multiple python files for different users/directories.</p>
<pre><code>import keyboard
import time
import ctypes

def Mbox(title, text, style):
    return ctypes.windll.user32.MessageBoxW(0, text, title, style)


if  os.path.exists(r"%SystemDrive%\Users\{username}\Documents\QQOutput.bas"):
    Mbox('It exists', 'Please open the csv and then press ok. It will work after 5 seconds', 1)
    time.sleep(5)
    keyboard.press_and_release('alt+f11')
    keyboard.press_and_release('ctrl+m')
    keyboard.write("QQOutput.bas")
    keyboard.press_and_release("enter")
    keyboard.press_and_release("f5")
    keyboard.press_and_release("enter")
else:
    Mbox('Error','QQOutput.bas is not in Documents!. Please put QQOutput.bas in your document folder.', 1)
</code></pre>
<p>User: Marco<br/>
MessageBox:'Please open the csv and then press ok. It will work after 5 seconds'<br/>
User: James<br/>
MessageBox: 'Please open the csv and then press ok. It will work after 5 seconds'</p>
</div>
<div class="post-text" itemprop="text">
<p>Use the <a href="https://docs.python.org/3/library/os.path.html#os.path.expanduser" rel="nofollow noreferrer">expanduser()</a> function from the os.path module.
<code>expanduser('~')</code> returns the path of the currently logged in user's home directory. </p>
<p>You can use it in you script this way:</p>
<pre><code>(base) C:\Users\andris&gt;python
Python 3.7.0 (default, Jun 28 2018, 08:04:48) [MSC v.1912 64 bit (AMD64)] :: Anaconda, Inc. on win32
Type "help", "copyright", "credits" or "license" for more information.
&gt;&gt;&gt; import os
&gt;&gt;&gt; doc = os.path.expanduser(r"~\Documents\QQOutput.bas")
&gt;&gt;&gt; doc
'C:\\Users\\andris\\Documents\\QQOutput.bas'
&gt;&gt;&gt; if  os.path.exists(doc):
...   work()
</code></pre>
</div>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/5258647/expanding-environment-variable-in-string-using-python">Expanding Environment variable in string using python</a></span>
<span class="comment-copy">I do know about this, but I am still wondering how I would implement into this code. Especially when I still need that os.path.exists</span>
<span class="comment-copy">@Marcalitus I edited.</span>
