<div class="post-text" itemprop="text">
<p>here is my dataframe </p>
<pre><code>                    df_test
0   (-, 136), (-, 136), 1.0
1   (-, 136), (-, 438), 0.5
2   (-, 136), (-, 257), 0.5
</code></pre>
<p>I would like to see the result like this</p>
<pre><code>      df_t1   df_t2  df_val
0   (-, 136) (-, 136) 1.0
1   (-, 136) (-, 438) 0.5
2   (-, 136) (-, 257) 0.5
</code></pre>
<p>I have used this code but it is not working </p>
<pre><code>new_df[['df_t1', 'df_t2', 'df_val']] = new_df['df_test'].str.split(',',expand=True)
</code></pre>
<p>any suggestion?</p>
</div>
<div class="post-text" itemprop="text">
<p>Specific to your format, you can use <a href="https://docs.python.org/3/library/ast.html#ast.literal_eval" rel="nofollow noreferrer"><code>ast.literal_eval</code></a>. Better, try and solve the issue upstream <em>before</em> your dataframe is constructed.</p>
<pre><code>from ast import literal_eval

df = pd.DataFrame({'df_test': ['(-, 136), (-, 136), 1.0',
                               '(-, 136), (-, 438), 0.5',
                               '(-, 136), (-, 257), 0.5']})

series = df.pop('df_test').str.replace('-', '"-"').apply(literal_eval)
df = df.join(pd.DataFrame(series.values.tolist(), columns=['df_t1', 'df_t2', 'df_val']))

print(df)

      df_t1     df_t2  df_val
0  (-, 136)  (-, 136)     1.0
1  (-, 136)  (-, 438)     0.5
2  (-, 136)  (-, 257)     0.5
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use:</p>
<pre><code>new_df[['df_t1', 'df_t2', 'df_val']] = new_df['df_test'].str.rsplit('),', expand=True)
new_df[['df_t1', 'df_t2']] += ')' 
print (new_df)
                   df_test     df_t1      df_t2 df_val
0  (-, 136), (-, 136), 1.0  (-, 136)   (-, 136)    1.0
1  (-, 136), (-, 438), 0.5  (-, 136)   (-, 438)    0.5
2  (-, 136), (-, 257), 0.5  (-, 136)   (-, 257)    0.5
</code></pre>
</div>
