<div class="post-text" itemprop="text">
<p>Statement :</p>
<pre><code> df[df['Symbol'] =="TLT" &amp; df['Date'].max()]
</code></pre>
<blockquote>
<p>Error : unsupported operand type(s) for &amp;: 'str' and 'Timestamp'</p>
</blockquote>
<p>My pandas dataframe is df. It consists of a trading log.</p>
<p>When I filter the df on Symbol and(&amp;) timestamp I get the above error </p>
<p>What did I do incorrectly ? I don't want to change my timestamp to a str.</p>
<p>df</p>
<pre><code>            Date    Symbol
 49     2018-11-27  0
 50     2018-12-10  0
 51     2018-12-17  0
 52     2018-12-27  XLK
 53     2018-12-27  XLV
 54     2018-12-28  VTV
 55     2019-01-09  0
 56     2019-01-09  0
 57     2019-01-16  0
 58     2019-02-04  0
 59     2019-02-04  0
 61     2019-02-05  SPY
 62     2019-02-05  0
 60     2019-02-05  TLT
 63     2019-02-07  TLT
 64     2019-02-09  0
</code></pre>
<p>Expected results : 63</p>
<p>Actual results : unsupported operand type(s) for &amp;: 'str' and 'Timestamp'</p>
</div>
<div class="post-text" itemprop="text">
<p>You can try like below to find the result   </p>
<pre><code>df.loc[(df['Symbol'] == "TLT") &amp; (df['Date'] == df['Date'].max())]   
</code></pre>
<p>here the '&amp;' operator takes precendee over the '=='operator.</p>
</div>
<div class="post-text" itemprop="text">
<p>Add parenthesis, because <a href="https://docs.python.org/3/reference/expressions.html#operator-precedence" rel="nofollow noreferrer">operator precedence in Python</a>. The bitwise and (&amp;) has precedence over equal (==) so in this case the parenthesis are required. Also compare column <code>Date</code> with <code>max</code>:</p>
<pre><code>df['Date'] = pd.to_datetime(df['Date'])
df[(df['Symbol'] == "TLT") &amp; (df['Date'] == df['Date'].max())] 
</code></pre>
</div>
<span class="comment-copy">df['Date'].max() not a boolean condition , plz check</span>
<span class="comment-copy">Small advice - if solution not working, add comment to all answers :) So now solution is correct. If my answer was helpful, don't forget <a href="https://meta.stackexchange.com/a/5235">accept</a> it. Thanks.</span>
<span class="comment-copy">When filtering for TLT and XLK , still is empty dataframe. When filtering for SPY and VTV , this gives me data. So it still doesn't work.</span>
<span class="comment-copy">I am not getting an error now with df.loc or df statement but it is returning a blank dataframe with column names.</span>
<span class="comment-copy">What am i doing wrong ? A blank dataframe is not what I wanted</span>
