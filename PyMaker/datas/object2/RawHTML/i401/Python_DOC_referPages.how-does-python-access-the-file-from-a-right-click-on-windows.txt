<div class="post-text" itemprop="text">
<p>I've written a simple python script that takes a .csv file, rearranges it and spits out an excel file. My aim is to be able to right click on a .csv file in Windows and for it to generate an .xslx file. I've used PyInstaller to successfully create an .exe and I've used <a href="http://defaultprogramseditor.com/" rel="nofollow noreferrer">default programs editor</a> to put my executable in the context menu when csv files are right clicked. What I can't figure out is how to do the I/O correctly.</p>
<p>What I have is :</p>
<pre><code>import fileinput
import csv
try: 
    csv_filename = fileinput.filename()
    print(csv_filename)
except: print('no input')
with open(filename_csv, 'rt', newline='', encoding='utf8') as csvfile:
    # do stuff
# write xslx_filename
</code></pre>
<p>Which doesn't work. </p>
<p>How do I access the file windows passes me when I open a file?</p>
<p><strong>Edit:</strong>
Just to clear up confusion. If I hard code the location of a csv file, my script works just fine. My problem is how do I access the file that Windows (presumably) passes to my script when I right click on a csv file and choose to open with csv2xslx (my script).</p>
</div>
<div class="post-text" itemprop="text">
<p>Thanks to martineau above for the pointer. The following made it work:</p>
<pre><code>file = sys.argv[1]
with open(file, 'rt', newline='', encoding='utf8') as csvfile:
    # do stuff
# write xslx_filename
</code></pre>
<p>I'm still not sure if that is the 'correct' way of doing it, but it works so I'm happy.</p>
</div>
<span class="comment-copy">You will need to modify the Window registry and associate your .exe as one of the handlers of file with the <code>.xlsx</code> extension in way that causes it to appear in the right-click Explorer context-menu. You can probably do all of that from Python, but is going to require quite a bit of Windows expertise (and you're likely also going to need a way to undo it).</span>
<span class="comment-copy">I think you misunderstood the question (or perhaps more accurately, I expressed myself poorly). I have no problem with the .xslx bit. Using a hard coded location for the .csv input, my script happily writes a new .xslx file (thanks to xlsxwriter).  What I can't figure out is how to get python to read whatever it is that Windows passes to a program selected by the context menu.That is, how to use the csv file that was clicked on instead of one that is in a hard coded location.</span>
<span class="comment-copy">Yes, I misunderstood. Print out what's in the <a href="https://docs.python.org/3/library/sys.html#sys.argv" rel="nofollow noreferrer"><code>sys.argv</code></a> list when your script starts, I believe the filename will be one of the entries.</span>
