<div class="post-text" itemprop="text">
<p>I have a data frame created from a CSV file and I need help to filter on the data frame based on the inputs from configuration file (it can be text or CSV). The config file will contain the column name on which I have to filter and the values or condition on which I have to filter. I have the following code so far </p>
<pre><code>import pandas as pd
import os
import time
import csv
import datetime
import sys


file_loc = sys.argv[1]

input_file_1 = 'mapping_config_1.txt'

file_det = os.path.join(file_loc, input_file_1)

file_details = pd.read_csv(file_det, header = 0, delimiter = "\t")

df = pd.read_csv(r'C:\filter\test.txt', sep = "|")

for index, row in file_details.iterrows():

  filter_col = row('Target_Column')

  filter = row['Filter']

  df = df.loc[df['filter_col'].isin(filter)]

  df.head(1000).to_csv(os.path.join(file_loc, 'output.txt'), sep = "|", index = False)
</code></pre>
<p>my config text file looks like, my dataframe has a column named </p>
<pre><code>Client_Product
Filter  Target_Column
10170   Client_Product
</code></pre>
<p>I am getting <code>'Type Error' : series object is not callable</code></p>
<p>I am looking for any approach where I can pass filter conditions from a config file to a Python program</p>
</div>
<div class="post-text" itemprop="text">
<p>Looks basically OK. The error you're getting is due to the line <code>filter_col = row('Target_Column')</code>, where you are using parentheses <code>()</code> instead of brackets <code>[]</code></p>
<p>Other issues:
<code>pd.Series.isin</code> expects a list, but you're providing it a single value. 
You can just replace those first three lines with <code>df = df.loc[df[row['Target_Column']] == row['Filter']]</code></p>
<p>This also lets you avoid making a variable called <code>filter</code>, since that overwrites a <a href="https://docs.python.org/3/library/functions.html#filter" rel="nofollow noreferrer">python builtin</a> and you should avoid that. </p>
</div>
<span class="comment-copy">@P Maschhoff  thanks for response this worked perfectly, i am planning to write some more code and add more filtering scenarios like where values are greater then or equal to or less then some value. I will share the final code again for reference</span>
