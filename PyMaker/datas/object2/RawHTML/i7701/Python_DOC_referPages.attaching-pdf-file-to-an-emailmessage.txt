<div class="post-text" itemprop="text">
<p>I am trying to set up an automated email sending script. I am using the email module and the <code>EmailMessage</code> object from the <code>email.message</code> module and am sending the email using the <code>smtplib</code> module. I would like to be able to attach a .pdf file to an email but the documentation for the <code>add_attachment()</code> method for <code>EmailMessage()</code> is not very helpful and I'm not even sure I should be using it. </p>
<p>Here is what I have so far with irrelevant information removed:</p>
<pre><code>import time
import smtplib
from email.message import EmailMessage

FROM = 'my email'

s = smtplib.SMTP('smtp.gmail.com', 587)
s.ehlo()
s.starttls()
s.login('my email', 'password')

for line in open('to.csv'):
    line = line.strip()
    fields = line.split(',')

    subject = 'subject'

    email = EmailMessage()

    email['Subject'] = 'subject'
    email['From'] = FROM
    email['To'] = 'to email'


    s.send_message(email)

    print('Sent to {0}'.format(fields[TO]))

    time.sleep(5)

s.quit()
</code></pre>
<p>How do I go about attaching the pdf file? I searched and saw one answer was using the MIMEText object to add attachments but it did not appear to work pdf.</p>
</div>
<div class="post-text" itemprop="text">
<p>Late for the answer... but this is what I do:</p>
<pre><code>email = EmailMessage()

email['Subject'] = 'subject'
email['From'] = FROM
email['To'] = 'to email'

with open('example.pdf', 'rb') as content_file:
    content = content_file.read()
    email.add_attachment(content, maintype='application/pdf', subtype='pdf', filename='example.pdf')

s.send_message(email)
</code></pre>
<p>By the way, this isnt a duplicate question, in this question, he use EmailMessage and don't use MIMEText / MIMEPart, etc.</p>
</div>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/3362600/how-to-send-email-attachments-with-python" title="how to send email attachments with python">stackoverflow.com/questions/3362600/â€¦</a></span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/3362600/how-to-send-email-attachments-with-python">How to send email attachments with Python</a></span>
<span class="comment-copy">Short, succinct, and highly useable.  This should be one of the examples included within the <a href="https://docs.python.org/3/library/email.examples.html" rel="nofollow noreferrer">standard python examples</a>.</span>
<span class="comment-copy">Surely <code>maintype</code> here should be <code>application</code>?</span>
