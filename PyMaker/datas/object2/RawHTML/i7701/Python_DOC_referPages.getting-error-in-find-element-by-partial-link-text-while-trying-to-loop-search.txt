<div class="post-text" itemprop="text">
<p>What I am trying to do is creating a loop for search query and parse data in <code>.csv</code>. However code gives error on this line <code>driver.find_element_by_partial_link_text(query).click()</code> and Selenium stops working. Can't figure it out what's happening.</p>
<pre><code>from selenium import webdriver
from bs4 import BeautifulSoup 
import html5lib
import lxml.html
import csv 
import time

driver = webdriver.Chrome()
driver.get("url"


with open('your_csv.csv','r') as csvfile:
    with open('log.csv','wb') as csv_out:
        writer=csv.writer(csv_out)
        spamreader = csv.reader(csvfile)
        for query in spamreader:            
            username = driver.find_element_by_name("p_name")
            username.send_keys(query)
            driver.find_element_by_xpath("html/body/form/table[6]/tbody/tr/td[2]/input").click() #this will take you on new link
            time.sleep(4)
            driver.find_element_by_partial_link_text(query).click()

            html = driver.page_source
            soup = BeautifulSoup(html, 'html.parser')
            words = soup.find_all("td")
            ralph =  soup.get_text().encode('utf-8')

            a = list()
            for jav in words:
                    a.append((jav.text).encode('utf-8'))

            with open('data.csv', 'w') as csvfile:
                spamwriter = csv.writer(csvfile,delimiter=',')
                spamwriter.writerow(a)
</code></pre>
<p>Here is the error:</p>
<pre><code>Traceback (most recent call last):
  File "ninja.py", line 21, in &lt;module&gt;
    driver.find_element_by_partial_link_text(query).click()
  File "/Library/Python/2.7/site-packages/selenium/webdriver/remote/webdriver.py", line 361, in find_element_by_partial_link_text
    return self.find_element(by=By.PARTIAL_LINK_TEXT, value=link_text)
  File "/Library/Python/2.7/site-packages/selenium/webdriver/remote/webdriver.py", line 791, in find_element
    'value': value})['value']
  File "/Library/Python/2.7/site-packages/selenium/webdriver/remote/webdriver.py", line 256, in execute
    self.error_handler.check_response(response)
  File "/Library/Python/2.7/site-packages/selenium/webdriver/remote/errorhandler.py", line 194, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.WebDriverException: Message: unknown error: 'value' must be a string
  (Session info: chrome=58.0.3029.110)
  (Driver info: chromedriver=2.29.461585 (0be2cd95f834e9ee7c46bcc7cf405b483f5ae83b),platform=Mac OS X 10.12.5 x86_64)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I find out that csv.reader() return each row, as a list of strings. with square brackets. for example, if a row in CSV file contains.  "jarvis". it will return ["jarvis"] which is totally out of syntax. here is what i have done. is simply strip square brackets...</p>
<pre><code>with open('your_csv.csv','r') as csvfile:
    with open('log.csv','wb') as csv_out:
        writer=csv.writer(csv_out)
        spamreader = csv.reader(csvfile)
        for query in spamreader:            
            username = driver.find_element_by_name("p_name")
            username.send_keys(str(query).strip('[').strip(']')
</code></pre>
<p>...</p>
</div>
<div class="post-text" itemprop="text">
<p>The issue is that you are trying to use a list in the <code>find_element_by_link_text()</code> method. </p>
<p>You see, the  </p>
<pre><code>    spamreader = csv.reader(csvfile)
</code></pre>
<p>The <code>reader()</code> method that you have used, returns each row read, as a list of strings. <a href="https://docs.python.org/3/library/csv.html#csv.reader" rel="nofollow noreferrer">Here</a> is the Python documentation that elaborates it.</p>
<p>Now, you are passing this list of strings, which is returned in your <code>query</code> to the <code>find_element_by_link_text()</code> method, which only takes a string as an argument - example is shown <a href="http://selenium-python.readthedocs.io/locating-elements.html#locating-hyperlinks-by-link-text" rel="nofollow noreferrer">here</a>. </p>
<p>You need to use the <code>strip()</code> method to strip the string and then use the first string as your parameter in the <code>find_element</code> method.</p>
</div>
<span class="comment-copy">After the statement <code>for query in spamreader</code> insert a statement to print <code>query</code> then try running selenium and <code>driver.find_element_by_xpath("html/body/form/table[6]/tbody/tr/td[2]/input").click()</code> and <code>driver.find_element_by_partial_link_text(query).click()</code> to verify that your code is doing what you think it does <b>in an interactive environment</b>.</span>
<span class="comment-copy">@BillBell can you be more specific please.</span>
<span class="comment-copy">Do you have access to IDLE? Or, on Windows, Pythonwin? Or some other interactive environment where each statement you enter is executed immediately?</span>
<span class="comment-copy">yes, i tried with an interactive environment this line gives me error <code>driver.find_element_by_partial_link_text(query).click()</code>. @BillBell</span>
<span class="comment-copy">OK, but not why I asked. You're in the debugging phase. If you know which value of <code>query</code> resulted in the failure then you can try to follow the steps that led to that failure — one at a time — interactively. You can verify that the correct username is keyed in. Then you can see that <code>.click()</code> affects the correct element. And so  on. That's why I said re-run the code above with a print statement in it to show the value of <code>query</code> that was being processed just before the failure.</span>
<span class="comment-copy">i will  show you a example : search string  <code>wizard Inc</code> and search results are <code>wizard Incorp</code> <code>wizard boo Inc</code> it will click on which matches maximum right link. is  there any other way ? @demouser123</span>
<span class="comment-copy">can you please show me. how to do that. i am little confuse right now.</span>
<span class="comment-copy">i haven't solutoin please do something.</span>
