<div class="post-text" itemprop="text">
<p>I'm trying to apply the canny function on an image and here's the full code but it shows the error only if i put the steps within a function, but doesn't show when leaving all the code outside of any functions. Code:</p>
<pre><code>import cv2
import numpy as np

def canny(image):
    gray = cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)
    blur = cv2.GaussianBlur(gray, (5,5), 0)
    canny = cv2.Canny(blur, 50, 150) #sick
    return canny

sourceimage = cv2.imread('lane.jpg')
img = np.copy(sourceimage)
canny = canny(img)
cv2.imshow("result", canny)
cv2.waitKey(0)
</code></pre>
<p>And here is the error i get: (python 3.6.8)</p>
<pre><code>kream@KRIMZON:~/Desktop/finding-lanes-linux$ python3 lane.py
Traceback (most recent call last):
  File "lane.py", line 12, in &lt;module&gt;
    cannyer = canny(img)
  File "lane.py", line 5, in canny
    gray = cv2.cvtColor(image, cv2.COLOR_RGB2GRAY)
TypeError: Expected cv::UMat for argument 'src'
kream@KRIMZON:~/Desktop/finding-lanes-linux$
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>When I just run the code, it also complains <code>Expected cv::UMat for argument 'src'</code>. <strong>Because there is no <code>lane.jpg</code> in my PC, so <code>cv2.imread</code> return <code>NoneType</code>, and <code>np.copy</code> return <code>np.array(None, dtype=object)</code>.</strong> If you just pass such a variable to cv2, it will complain <code>Expected cv::UMat for argument 'xxx'</code>.</p>
<p><a href="https://i.stack.imgur.com/TUuoX.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/TUuoX.png"/></a></p>
<p>Yes, you shoule check sure you image exists and loaded successfully!</p>
<hr/>
<p>And notice, another bad practice is: <strong>your variable name <code>canny</code> is the same with you fucntion name <code>canny()</code></strong>. So when you call <code>canny = canny(img)</code>, the function <code>canny()</code> object is replaced by variable <code>canny</code>. If you call <code>canny()</code> next time, it will failed like this:<code>TypeError: 'numpy.ndarray' object is not callable</code> .
<a href="https://i.stack.imgur.com/qUWFB.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/qUWFB.png"/></a></p>
<p>Then use different names.</p>
<hr/>
<pre><code>&gt;&gt;&gt; src = cv2.imread("noexist.png")
&gt;&gt;&gt; img = np.copy(src)
&gt;&gt;&gt;
&gt;&gt;&gt; type(src)
&lt;class 'NoneType'&gt;
&gt;&gt;&gt; cv2.cvtColor(src, cv2.COLOR_BGR2GRAY)
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
cv2.error: OpenCV(4.0.1) d:\build\opencv\opencv-4.0.1\modules\imgproc\src\color.cpp:181: error: (-215:Assertion failed) !_src.empty() in function 'cv::cvtColor'

&gt;&gt;&gt;
&gt;&gt;&gt; img
array(None, dtype=object)
&gt;&gt;&gt; cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
TypeError: Expected cv::UMat for argument 'src'
&gt;&gt;&gt;
&gt;&gt;&gt; img()
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
TypeError: 'numpy.ndarray' object is not callable
</code></pre>
</div>
<span class="comment-copy">The issue was fixed, after finding out the original image was corrupted/modified by mistake done by me after i used the variable for the original image rather than the actual copy i made of it, fixed by replacing the original image and making sure it doesn't happen again, thanks for reading.</span>
<span class="comment-copy">Great that you solved it yourself :) -- but to make this useful, either write up a self-answer, or delete the question.</span>
<span class="comment-copy">for some reason it doesn't let me write up a self-answer before 48 hours.</span>
<span class="comment-copy">yes i know of that but it didn't create any problems, i'm sure it will when the code gets complex but following a tutorial i'm quiet sure the teacher knows it won't conflict afterwards.</span>
