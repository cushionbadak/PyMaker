<div class="post-text" itemprop="text">
<p>Trying to create a batch script for windows that runs a program with python3 if available else python2.</p>
<p>I know the script can be executed with <code>$py -2 script.py</code>
and py3 with <code>$py -3 script.py</code>.</p>
<p>and if I run <code>py -0</code>, it returns all the python versions.</p>
<p>How do I build this script?</p>
<p>I do not want to check if the python directory is available or not, I'd prefer to check in a way that is python location agnostic.</p>
</div>
<div class="post-text" itemprop="text">
<p>Piping directly <code>python.exe --version</code> to <code>find</code> or <code>findstr</code> is not working (with python 2.7).</p>
<p>Building dinamicaly and running a python script that return the version, will enable this piping ! </p>
<p>The solution :</p>
<pre><code>@echo off
set "$py=0"
call:construct

for /f "delims=" %%a in ('python #.py ^| findstr "2"') do set "$py=2"
for /f "delims=" %%a in ('python #.py ^| findstr "3"') do set "$py=3"
del #.py
goto:%$py%

echo python is not installed or python's path Path is not in the %%$path%% env. var
exit/b

:2
echo running with PY 2

exit/b

:3
echo running with PY 3

exit/b

:construct
echo import sys; print('{0[0]}.{0[1]}'.format(sys.version_info^)^) &gt;#.py
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Not a full solution, but a method to detect which version of Python is installed:</p>
<p>You can check if Python 3 is installed by running <code>py -3 --version</code> and then checking the <code>%ERRORLEVEL%</code> variable in the batch script.  If it is 0, then <code>py -3 --version</code> was successful, i.e. Python 3 is installed on the system.  If it is nonzero, then Python 3 is not installed.</p>
</div>
<span class="comment-copy">I only have python 2.7 installed ! and when I run python -3 --version it return python 2.7 and the errorlevel still 0 !!!!</span>
<span class="comment-copy">@SachaDee, <code>python.exe</code> is not <code>py.exe</code>. <code>python.exe</code> does not support <code>-0</code>, <code>-2</code> or <code>-3</code> arguments. The <a href="https://docs.python.org/3/using/windows.html#python-launcher-for-windows" rel="nofollow noreferrer">Python Launcher</a> <code>py.exe</code> does.</span>
<span class="comment-copy">I have tried to run <code>py.exe</code> in my python 2.7, but it's apparently not present !</span>
<span class="comment-copy">@SachaDee, You can get 3.7.0 launcher.msi for <a href="https://www.python.org/ftp/python/3.7.0/win32/" rel="nofollow noreferrer">x86</a> or <a href="https://www.python.org/ftp/python/3.7.0/amd64/" rel="nofollow noreferrer">x64</a>. Use command <code>msiexec /i launcher.msi ALLUSERS=1</code> to install as an Admin. If you do not use the <code>ALLUSERS</code> property then it installs to the <i>UserProfile</i>. Tested with 2.7.15 in a Win 7 VM.</span>
