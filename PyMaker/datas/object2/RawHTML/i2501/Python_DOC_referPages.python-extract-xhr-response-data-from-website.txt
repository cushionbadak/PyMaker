<div class="post-text" itemprop="text">
<p>I am trying to extract some data from <a href="https://www.barchart.com/stocks/signals/top-bottom/top?viewName=main" rel="nofollow noreferrer">https://www.barchart.com/stocks/signals/top-bottom/top?viewName=main</a>.</p>
<p>I am able to extract data from normal html using the xpath method, however i noticed that this website gets its data from a network.</p>
<p>I have found the location of where the data I want is (the table from the barchart website) which is shown in the picture below.</p>
<p><a href="https://i.stack.imgur.com/lXVKl.png" rel="nofollow noreferrer">Picture of XHR response</a></p>
<p>How can i scrape just the response portion?</p>
<p>Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>Try this code.</p>
<pre><code>from urllib import urlencode

headers = {
    'cookie': 'XSRF-TOKEN=eyJpdiI6Ikk4cFdwcGlqMVVPRHM4MFc5Vk1ROWc9PSIsInZhbHVlIjoiUHRHbjZwSTZFTUkrTFRNZVJXczZsV2xZZnN1WEhmM1puakN5WWFsM0RUODhJRUZJYVA3XC9GZ1QyOUR5R0VqaXRmdDJIR0wyV2lBdXlFcTlxXC9HWFVqZz09IiwibWFjIjoiNTlkODY2MGM0YzJlZDQxMTI5ZmIwMmE0NWI5YzkzY2Q4NDg3MjhiODg4NDAxN2Q5NmYzYTE3MmUxZWQzZjk4MiJ9; laravel_session=eyJpdiI6ImFob1k3NWw1U2pBcWhKU3JLdEpDQkE9PSIsInZhbHVlIjoidnNNcXpKSHRmQkYyMGp2NTF4eUhTVVwvSmtidnAwMDV5eGdUWWVhZ2syTUlXaVdQV1JEUldYcG5lXC9mdUtnRkl2akNMR2ZKMkY2NFlWYTFOM2NPRm1uQT09IiwibWFjIjoiYTJhODkwMTJjZjI3NzJiOTE1YWY5MWJkYTNiYTNlMjZjNjI1YjgzZmJlYzhkMTU4Mjk1OWQ5MWEzMGU5OTM5NSJ9; _ga=GA1.2.674295962.1536391451; _gid=GA1.2.1388999250.1536391451; _gat_UA-2009749-51=1; Markets09122018PageView=1; Markets09122018WebinarClosed=true',
    'dnt': '1',
    'x-xsrf-token': 'eyJpdiI6Ikk4cFdwcGlqMVVPRHM4MFc5Vk1ROWc9PSIsInZhbHVlIjoiUHRHbjZwSTZFTUkrTFRNZVJXczZsV2xZZnN1WEhmM1puakN5WWFsM0RUODhJRUZJYVA3XC9GZ1QyOUR5R0VqaXRmdDJIR0wyV2lBdXlFcTlxXC9HWFVqZz09IiwibWFjIjoiNTlkODY2MGM0YzJlZDQxMTI5ZmIwMmE0NWI5YzkzY2Q4NDg3MjhiODg4NDAxN2Q5NmYzYTE3MmUxZWQzZjk4MiJ9',
    'accept-language': 'en-US,en;q=0.9',
    'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.81 Safari/537.36',
    'accept': 'application/json',
    'referer': 'https://www.barchart.com/stocks/signals/top-bottom/top?viewName=main',
    'authority': 'www.barchart.com',
    'accept-encoding': 'gzip, deflate, br',
}

params = (
    'lists': 'stocks.signals.top.current.us',
    'orderDir': 'asc',
    'fields': 'symbol,symbolName,lastPrice,priceChange,percentChange,opinion,opinionPrevious,opinionLastWeek,opinionLastMonth,symbolCode,symbolType,hasOptions',
    'meta': 'field.shortName,field.type,field.description',
    'hasOptions': 'true',
    'page': '1',
    'limit': '100',
    'raw': '1',
)

yield Request('https://www.barchart.com/proxies/core-api/v1/quotes/get?' + urlencode(params) , headers=headers)
</code></pre>
</div>
<span class="comment-copy">Personally, if I were you, I would simply copy (as cUrl) the api GET request you displayed and make the request in your script with either <a href="https://docs.python.org/3/library/urllib.html" rel="nofollow noreferrer"><code>urllib</code></a> or <a href="http://docs.python-requests.org/en/master/" rel="nofollow noreferrer"><code>requests</code></a> to fetch the data. (note: you will need to translate the headers (e.g. <code>x-xsrf-token</code>) to the http lib of your choice).</span>
<span class="comment-copy">Do you happen to know where I can find an example to go off of?</span>
<span class="comment-copy">1. call "<a href="https://www.barchart.com/stocks/signals/top-bottom/top?viewName=main" rel="nofollow noreferrer">barchart.com/stocks/signals/top-bottom/top?viewName=main</a>" 2. extract <code>Set-Cookie</code> 3. call "<a href="https://www.barchart.com/proxies/core-api/v1/quotes/get" rel="nofollow noreferrer">barchart.com/proxies/core-api/v1/quotes/get</a>..." with headers (<code>cookie</code>: <i>value from <code>Set-Cookie</code></i>, <code>x-xsrf-token</code>: <i>urldecoded <code>XSRF-TOKEN</code> from <code>Set-Cookie</code></i>)</span>
<span class="comment-copy">hey Umair.  I added this to my code.  I got a syntax error for the params, so i made it a dictionary instead (used curly brackets).  The code ran but I was not getting anything to print out.  How can i print out the params as well?  Did the code work for you?  Thanks!</span>
