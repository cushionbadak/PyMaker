<div class="post-text" itemprop="text">
<p>I am getting an exception as I try to slice with a logical expression my Pandas dataframe.</p>
<p>My data have the following form:</p>
<pre><code>df
    GDP_norm    SP500_Index_deflated_norm
Year        
1980    2.121190    0.769400
1981    2.176224    0.843933
1982    2.134638    0.700833
1983    2.233525    0.829402
1984    2.395658    0.923654
1985    2.497204    0.922986
1986    2.584896    1.09770

df.info()
&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 38 entries, 1980 to 2017
Data columns (total 2 columns):
GDP_norm                     38 non-null float64
SP500_Index_deflated_norm    38 non-null float64
dtypes: float64(2)
memory usage: 912.0 bytes
</code></pre>
<p>The command is the following:</p>
<pre><code>df[((df['GDP_norm'] &gt;=3.5 &amp; df['GDP_norm'] &lt;= 4.5) &amp; (df['SP500_Index_deflated_norm'] &gt; 3)) | (

   (df['GDP_norm'] &gt;= 4.0 &amp; df['GDP_norm'] &lt;= 5.0) &amp; (df['SP500_Index_deflated_norm'] &lt; 3.5))]
</code></pre>
<p>The error message is the following:</p>
<pre><code>TypeError: cannot compare a dtyped [float64] array with a scalar of type [bool]
</code></pre>
<p>Your advice will be appreciated.</p>
</div>
<div class="post-text" itemprop="text">
<p>I suggest create boolean masks separately for better readibility and also easier error handling.</p>
<p>Here are missing <code>()</code> in <code>m1</code> and <code>m2</code> code, problem is in operator precedence:</p>
<p><a href="https://docs.python.org/3.6/reference/expressions.html#arithmetic-conversions" rel="nofollow noreferrer">docs</a> - 6.16. Operator precedence where see <code>&amp;</code> have higher priority as <code>&gt;=</code>:</p>
<pre><code>Operator                                Description

lambda                                  Lambda expression
if â€“ else                               Conditional expression
or                                      Boolean OR
and                                     Boolean AND
not x                                   Boolean NOT
in, not in, is, is not,                 Comparisons, including membership tests    
&lt;, &lt;=, &gt;, &gt;=, !=, ==                    and identity tests
|                                       Bitwise OR
^                                       Bitwise XOR
&amp;                                       Bitwise AND

(expressions...), [expressions...],     Binding or tuple display, list display,       
{key: value...}, {expressions...}       dictionary display, set display
</code></pre>
<hr/>
<pre><code>m1 = (df['GDP_norm'] &gt;=3.5) &amp; (df['GDP_norm'] &lt;= 4.5)
m2 = (df['GDP_norm'] &gt;= 4.0) &amp; (df['GDP_norm'] &lt;= 5.0)

m3 = m1 &amp; (df['SP500_Index_deflated_norm'] &gt; 3)
m4 = m2 &amp; (df['SP500_Index_deflated_norm'] &lt; 3.5)

df[m3 | m4]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You are suffering from the effects of <a href="https://docs.python.org/3/reference/expressions.html#comparisons" rel="nofollow noreferrer">chained comparisons</a>. What's happening is the expression <code>df['GDP_norm'] &gt;=3.5 &amp; df['GDP_norm'] &lt;= 4.5</code> is evaluated as something like:</p>
<pre><code>df['GDP_norm'] &gt;= (3.5 &amp; df['GDP_norm']) &lt;= 4.5
</code></pre>
<p>Of course, this fails since <code>float</code> cannot be compared with <code>bool</code>, as described in your error message. Instead, use parentheses to isolate each Boolean mask and assign to variables:</p>
<pre><code>m1 = (df['GDP_norm'] &gt;= 3.5) &amp; (df['GDP_norm'] &lt;= 4.5)
m2 = df['SP500_Index_deflated_norm'] &gt; 3

m3 = (df['GDP_norm'] &gt;= 4.0) &amp; (df['GDP_norm'] &lt;= 5.0)
m4 = df['SP500_Index_deflated_norm'] &lt; 3.5

res = df[(m1 &amp; m2) | (m3 &amp; m4)]
</code></pre>
</div>
