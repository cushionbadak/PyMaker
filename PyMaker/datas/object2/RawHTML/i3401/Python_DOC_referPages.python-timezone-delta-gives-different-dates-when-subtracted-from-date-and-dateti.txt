<div class="post-text" itemprop="text">
<p>I wrote a python function that gives me datetime or date in the past, with reference to current date.</p>
<pre><code>def get_past_date(no_of_days, date_only=False):
    """Returns timezone aware Datetime object in past based on no_of_days provided"""
    if date_only:
        return timezone.datetime.today().date() - timezone.timedelta(no_of_days)
    past = timezone.datetime.today() - timezone.timedelta(no_of_days)
    return timezone.make_aware(past, timezone=pytz.timezone(settings.TIME_ZONE))
</code></pre>
<p>The problem is: </p>
<pre><code>timezone.datetime.today().date() - timezone.timedelta(no_of_days)
</code></pre>
<p>and </p>
<pre><code>timezone.datetime.today() - timezone.timedelta(no_of_days)
</code></pre>
<p>return different date for same input (no_of_days)</p>
<p><code>timezone.datetime.today()</code> returns a date that is 1 day earlier than <code>timezone.datetime.today().date()</code></p>
<pre><code>timezone.datetime.today() - timezone.timedelta(6 * 365 / 12)
= datetime.datetime(2018, 1, 1, 21, 12, 43, 741750)

timezone.datetime.today().date() - timezone.timedelta(6 * 365 / 12)
= datetime.date(2018, 1, 2)
</code></pre>
<p>Am I missing something here? </p>
</div>
<div class="post-text" itemprop="text">
<p>The issue here is that you're subtracting an non-integral number of days (6 * 365 / 12 = 182.5). But the smallest unit of a <code>date</code> is a single day, and as described in <a href="https://docs.python.org/3/library/datetime.html#date-objects" rel="nofollow noreferrer">the documentation</a>, <code>timedelta</code> units smaller than the day are ignored when operating on <code>dates</code>.</p>
<p>So the <code>date</code> operation is equivalent to subtracting 182 days, while the <code>datetime</code> operation is subtracting 182.5 days.</p>
<p>An analogy would be:</p>
<pre><code>184.0 - 182.5 = 1.5
int(184.0) - int(182.5) = 2
</code></pre>
</div>
<span class="comment-copy">That makes sense! I did not take that into account. Thank you @Kevin</span>
