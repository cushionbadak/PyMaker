<div class="post-text" itemprop="text">
<p>I'm using <a href="https://github.com/Alex-D/Trumbowyg" rel="noreferrer">Trumbowyg</a>, a WYSIWYG JavaScript editor which has a feature of rendering images from URLs pasted in. It also has an <a href="https://alex-d.github.io/Trumbowyg/documentation/plugins/#plugin-upload" rel="noreferrer">upload plugin</a> which enables uploading local images and custom server side handling.  </p>
<p>My python/django function <code>upload_image()</code> can successfully detect the uploaded image - however when I use the URL image input, my python function cannot detect it. Trumbowyg simply renders the image without going through my python backend.</p>
<p>Here's my code:</p>
<pre class="lang-javascript prettyprint-override"><code>$('#id_content').trumbowyg({
    btnsDef: {
        // Create a new dropdown
        image: {
            dropdown: ['insertImage', 'upload'],
            ico: 'insertImage'
        }
    },
    // Redefine the button pane
    btns: [
        ['strong', 'em', 'del'],
        ['link'],
        ['image'], // Our fresh created dropdown
    ],
    plugins: {
        // Add imagur parameters to upload plugin for demo purposes
        upload: {
            serverPath: '/upload_image/',
            fileFieldName: 'content_image',
            urlPropertyName: 'url'
        }
    }
});
</code></pre>
<pre class="lang-python prettyprint-override"><code>def upload_image(request):
    print('Success') #only prints when I use the upload input, not the URL input
</code></pre>
<p>Why can in detect the uploaded image but not the URL input?</p>
</div>
<div class="post-text" itemprop="text">
<p>As already pointed, Trumbowyg doesn't send the URL to backend if the user uploads the image using a URL. </p>
<p>But if you really want to host the images on your own server, there's a way you can do that.</p>
<p>When the user submits the form, you'll receive the content of the textarea in your backend. You can then read the content and look for <code>&lt;img src="..."&gt;</code> tag. </p>
<p>At that point, you can check if the <code>src</code> value doesn't start with your S3 bucket hostname, you can download that image using <a href="https://docs.python.org/3/library/urllib.html" rel="nofollow noreferrer"><code>urllib</code></a> or <a href="http://docs.python-requests.org/en/master/" rel="nofollow noreferrer"><code>requests</code></a> library, save it to your bucket and replace the <code>src</code> value.</p>
<p>Since the submitted data will be in HTML format, check out the excellent <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" rel="nofollow noreferrer">Beautiful Soup</a>. It will make parsing HTML easy.</p>
</div>
<span class="comment-copy">Kindly post your urls.py as well...</span>
<span class="comment-copy">Added. I use <code>upload_image()</code> in other places and it works fine, (by using <code>url: '/upload_image/',</code> in my ajax calls.</span>
<span class="comment-copy">"Why can in detect the uploaded image but not the URL input?" Because that javascript framework doesn't support that and you need to do your own hooks</span>
<span class="comment-copy">Ah ok. Any suggestions how I can go about that? The insert URL function is here I believe: <a href="https://github.com/Alex-D/Trumbowyg/blob/develop/src/trumbowyg.js#L1305" rel="nofollow noreferrer">github.com/Alex-D/Trumbowyg/blob/develop/src/trumbowyg.js#L1305</a></span>
