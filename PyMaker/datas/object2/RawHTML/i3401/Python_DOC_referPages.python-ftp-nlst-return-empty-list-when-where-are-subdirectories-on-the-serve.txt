<div class="post-text" itemprop="text">
<p>My application needs to download all the directories from a remote FTP, I'm testing for the first time the python's <code>ftplib</code>.</p>
<p>When I try to list all the directories in the remote FTP with the command <code>ftp.nlst()</code> it return an empty list. I know for sure that the directory is not empty because this command: <code>ftp.retrlines('list')</code> returned an object displaying the names of the subfolders inside the directory.</p>
<p>While I was testing I tried other commands like <code>ftp.cwd('/other-dir/')</code> or <code>ftp.pwd()</code>, but none of these seems to work.</p>
<p>This is the code that I'm using to display the list of subdirectories:</p>
<pre><code>from ftplib import FTP

def ftpConnection():
    ftp = FTP('ftp-address')
    ftp.login('user', 'password') 
    lista = ftp.nlst()
    return (lista)

print(ftpConnection())
</code></pre>
<p>Output:</p>
<pre><code>[]
</code></pre>
<p>As you can see the list is empty.</p>
<hr/>
<p>This is my code for <code>retrlines</code>:</p>
<pre><code>def ftpConnection():
    ftp = FTP('remoteFtp')
    ftp.login('user', 'password') 
    ftp.retrlines('LIST')

print (ftpConnection())
</code></pre>
<p>Output:</p>
<pre class="lang-none prettyprint-override"><code>drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Jun 29 09:23 .
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Jun 28 05:11 103367
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Jun 29 02:01 121901
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Sep 23  2016 123233
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Jun 29 09:19 125183
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Jun 29 02:34 133028
</code></pre>
<hr/>
<p>This is the output from command-line <code>ftp</code>:</p>
<pre class="lang-none prettyprint-override"><code>230-Welcome clt_kantar_italy from remoteFtp. You are now logged in to the server.
230 User logged in, proceed.
</code></pre>
<pre class="lang-none prettyprint-override"><code>ftp&gt; dir
200 PORT command successful.
150 File status okay; about to open data connection.
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Jun 29 09:23 .
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Jun 28 05:11 103367
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Jun 29 02:01 121901
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Sep 23  2016 123233
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Jun 29 09:19 125183
drw-rw-rwx 1 clt_kantar_italy clt_kantar_italy          512 Jun 29 02:34 133028
226 Closing data connection. Transferred 481 bytes.
ftp: 484 bytes received in 0.01secondi 37.23Kbyte/sec)
</code></pre>
<pre class="lang-none prettyprint-override"><code>ftp&gt; ls
200 PORT command successful.
150 File status okay; about to open data connection.
226 Closing data connection. Transferred 0 bytes.
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>So you see it yourself with <code>ftp</code> (from the behavior I assume it's Windows <code>ftp.exe</code>).</p>
<ul>
<li><code>dir</code> command, which uses <code>LIST</code> FTP command, returns the folders;</li>
<li><code>ls</code> command, which uses <code>NLST</code> FTP command, does not return the folders.</li>
</ul>
<hr/>
<p>So it's how <em>your</em> FTP server behaves - It does not return folders in <code>NLST</code>.</p>
<p>If you need to retrieve folders from <em>your</em> FTP server, you have to use <code>LIST</code>:</p>
<ul>
<li>either use <a href="https://docs.python.org/3/library/ftplib.html#ftplib.FTP.dir" rel="nofollow noreferrer"><code>FTP.dir</code> method</a></li>
<li>or <a href="https://docs.python.org/3/library/ftplib.html#ftplib.FTP.retrlines" rel="nofollow noreferrer"><code>FTP.retrlines('LIST')</code></a>.</li>
</ul>
</div>
<span class="comment-copy">ok i'm going to edit the question</span>
<span class="comment-copy">So by <i>"local ftp"</i>, are you referring to a completely different FTP <i>server</i>? + Show us your code for <code>retrlines</code> and what does it return. + You still didn't explain the discrepancy in your problem description. + If you connect with command-line <code>ftp</code>, what do you get for <code>ls</code> and <code>dir</code> commands?</span>
<span class="comment-copy">Yes, with "local ftp" i mean a different FTP Server i'm gonna add the code to the question</span>
<span class="comment-copy">I've started thinking it's a firewall problem, could it be?</span>
<span class="comment-copy">Hardly.  - Once again:  If you connect with command-line <code>ftp</code>, what do you get for <code>ls</code> and <code>dir</code> (Windows <code>ftp</code>) or <code>nlist</code> (*nix <code>ftp</code>) commands?</span>
<span class="comment-copy">Ok now it's clear, thank you for your patience.</span>
