<div class="post-text" itemprop="text">
<p>I'm very new to Python, Pandas and programming overall, sorry in if this is a too stupid question.</p>
<p>Question is quite similar to <a href="https://stackoverflow.com/questions/49050455/pandas-split-data-frame-into-multiple-csvs-based-on-column-value">this one</a> (I've used this for my code) but i want to take it one step further and to save all separated csv's to each individual folder with the same name.</p>
<p>What do i have right now:</p>
<pre><code># this one is used to split carriers csv files 
for i, x in carriers.groupby('Contact Account Name'):
     x.to_csv(root + '/' "{}.csv".format(i.upper()), index=False)
</code></pre>
<p>+</p>
<pre><code> for i, x in carriers.groupby('Contact Account Name'):
        p = os.path.join(root, "{}.csv".format(i.upper()))
        x.to_csv(p, index=False)
</code></pre>
<p>And it is saving grouped 'Contact Account Name' values in a root folder as separate csvs. But what i need is to save it to the folder inside a root folder, named as 'Contact Account Name' values.</p>
<p>I've tried several different methods of creating folders, but failed.</p>
<p>Data Frame:</p>
<pre><code>  Contact Account Name
0 Mike
1 Jeff 
2 Todd 
3 Bill
</code></pre>
<p>How is it working right now:</p>
<p>It is creating csv's:</p>
<pre><code>root/MIKE.csv
root/JEFF.csv
root/TODD.csv
root/BILL.csv
</code></pre>
<p>How i want it to be:</p>
<pre><code>root/MIKE/MIKE.csv
root/JEFF/JEFF.csv
root/TODD/TODD.csv
root/BILL/BILL.csv
</code></pre>
<p>Thanks in advance!</p>
</div>
<div class="post-text" itemprop="text">
<p>Check folder existence with <a href="https://docs.python.org/3/library/os.path.html#os.path.exists" rel="nofollow noreferrer"><code>os.path.exists</code></a> and use <a href="https://docs.python.org/3/library/os.html#os.mkdir" rel="nofollow noreferrer"><code>os.mkdir</code></a> to create the new one:</p>
<pre><code>new_dir = os.path.join(root, "Contact Account Name")
if not os.path.exists(new_dir):
    os.mkdir(new_dir)

for i, x in carriers.groupby('Contact Account Name'):
    p = os.path.join(new_dir, "{}.csv".format(i.upper()))
    x.to_csv(p, index=False)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>All you really have to do is to add the <code>Contact Account Name</code> (i) to the <code>os.path.join</code> command - </p>
<p>So, the following should roughly work -
```</p>
<pre><code>for i, x in carriers.groupby('Contact Account Name'):
    p = os.path.join(root, i, "{}.csv".format(i.upper()))
    x.to_csv(p, index=False)
</code></pre>
<p>```</p>
<p>See more here - <a href="https://docs.python.org/2/library/os.path.html#os.path.join" rel="nofollow noreferrer">https://docs.python.org/2/library/os.path.html#os.path.join</a></p>
</div>
<div class="post-text" itemprop="text">
<p>You can define your output directory outside your loop. You may, as below, wish to check whether it exists, creating the directory via <code>os.mkdir</code> if it does not exist.</p>
<pre><code># define output directory
output_dir = os.path.join(root, 'Contact Account Name')

# create the directory if it doesn't exist
if not os.path.exists(output_dir):
    os.mkdir(output_dir)

for i, x in carriers.groupby('Contact Account Name'):
    # create output path from output directory
    p = os.path.join(output_dir, f'{i.upper()}.csv')
    x.to_csv(p, index=False)
</code></pre>
<p>Note in the example above I use f-strings, available in Python 3.6+ and more readable / efficient.</p>
</div>
