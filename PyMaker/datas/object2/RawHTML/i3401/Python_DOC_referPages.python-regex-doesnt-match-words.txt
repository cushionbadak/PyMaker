<div class="post-text" itemprop="text">
<p>folks!</p>
<p>Many thread created here about regex and unicode but unfortunately it doesnt work in my case.</p>
<p>I have the string:</p>
<pre><code> STR = "как надоела эта шляпа"
</code></pre>
<p>and </p>
<pre><code>query = "шляпа"
</code></pre>
<p>I'm building string as:</p>
<pre><code>compile = re.compile(u'\\b' + query + u'\\b')
</code></pre>
<p>If i try search:</p>
<pre><code>search = compile.search(STR, re.U + re.I)
</code></pre>
<p>It returns None.
Why i got such behavior of the regex ?</p>
</div>
<div class="post-text" itemprop="text">
<p>According to the <a href="https://docs.python.org/3/library/re.html#re.Pattern.search" rel="nofollow noreferrer">Python <code>re</code> docs</a>, <code>Pattern.search(string[, pos[, endpos]])</code> second argument is the <em>position</em> in the string where the search is to start.</p>
<p>See the values you sum:</p>
<pre><code>&gt;&gt;&gt; print(re.U)
32
&gt;&gt;&gt; print(re.I)
2
&gt;&gt;&gt; print(re.I + re.U)
34
</code></pre>
<p>There is no match in your string after Index 34.</p>
<p>So, you can either pass the <code>re.I</code> and <code>re.U</code> flags in a call to <code>re.compile</code>:</p>
<pre><code>re.compile(ur'\b{}\b'.format(query), re.U | re.I)
</code></pre>
<p>or use them as inline modifiers inside the pattern</p>
<pre><code>re.compile(ur'(?ui)\b{}\b'.format(query))
</code></pre>
<p>or use plain <a href="https://docs.python.org/3/library/re.html#re.search" rel="nofollow noreferrer"><code>re.search</code></a> where the third argument is <em>flags</em>:</p>
<pre><code>re.search(ur'\b{}\b'.format(query), STR, re.I | re.U)
</code></pre>
<p><a href="https://ideone.com/YCv9Qb" rel="nofollow noreferrer">Python code demo</a>:</p>
<pre><code>import re
STR = u"как надоела эта шляпа"
query = u"шляпа"
compile = re.compile(ur'\b{}\b'.format(query), re.U | re.I)
search = compile.search(STR)
print(search.group()) # =&gt; шляпа
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You need to pass the flags to the compilation phase.</p>
<pre><code>STR = u"как надоела эта шляпа"
query = u"шляпа"
compile = re.compile(u'\\b' + query + u'\\b', re.U | re.I)
search = compile.search(STR)
</code></pre>
</div>
<span class="comment-copy">compile is ("\bшляпа\b") but still returns None with re.u | re.I</span>
<span class="comment-copy">Yeah, because the second argument is the <i>pos</i>ition of where to start searching for the match. Either use <code>re.U | re.I</code> when compiling or pass them as inline modifiers, <code>(?ui)</code> as part of the pattern.</span>
<span class="comment-copy">See <a href="https://stackoverflow.com/a/51090708/3832970">my answer below</a>.</span>
<span class="comment-copy">Recreated string as re.compile(u'\\b' + query + u'\\b', re.U | re.I) but still None. Maybe i need to add something else?</span>
<span class="comment-copy">See my answer, and also <a href="https://ideone.com/YCv9Qb" rel="nofollow noreferrer">this Python demo online</a>.</span>
