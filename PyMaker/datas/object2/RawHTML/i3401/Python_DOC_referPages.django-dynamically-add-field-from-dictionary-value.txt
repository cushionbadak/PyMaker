<div class="post-text" itemprop="text">
<p>I'm trying to refactor some code to be DRY</p>
<p>I have an importer that imports from an API that has keys that are different than the destination.</p>
<p>Working code looks like this:</p>
<pre><code>this_event = AnEvent()
wp_event = Requests.get('someurl').json()
if 'title' in wp_event.keys():
    this_event.name = wp_event['title']
if 'description' in wp_event.keys():
    this_event.description = wp_event['description']
... and so on
</code></pre>
<p>What I am trying to do is this:</p>
<pre><code>scrape_fields  = [
    {
        'wp' : 'description',
        'django' : 'description'
    },
    {
        'wp' : 'title',
        'django' : 'name'
    }
    ... etc
]
for field in scrape_fields:
    if field['wp'] in wp_event.keys():
        # I knew this would not work when I wrote it but not sure what to do
        this_event[field['django']] = wp_event[field['wp']]
</code></pre>
<p>But Django throws an exception:</p>
<pre><code>'AnEvent' object does not support item assignment
</code></pre>
<p>Is anyone able to advise on how to assign to a field dynamically like this?</p>
</div>
<div class="post-text" itemprop="text">
<p>To dynamically assign any Python object's member values using <code>str</code> type values to reference the field name you need to use Python's built-in function <code>setattr</code>. Essentially, this line:</p>
<pre><code>this_event[field['django']] = wp_event[field['wp']]
</code></pre>
<p>Can be rewritten to this, using <code>setattr</code>:</p>
<pre><code>setattr(this_event, field['django'], wp_event[field['wp']])
</code></pre>
<p>Read: <a href="https://docs.python.org/3/library/functions.html#setattr" rel="nofollow noreferrer">Python docs</a>.</p>
</div>
<div class="post-text" itemprop="text">
<p>You want <code>setattr()</code>:</p>
<pre><code>setattr(this_event, field['django'], wp_event[field['wp'])
</code></pre>
</div>
<span class="comment-copy">Are there any duplicated <code>'wp'</code>s or <code>'django'</code>s values? If not we can boost performance of this.</span>
<span class="comment-copy">Yes! thank you.</span>
