<div class="post-text" itemprop="text">
<p>I am new to dealing with list in the data frame. I have a data frame with 1 column that contains list like values. I am trying to remove 'empty list' and 'upper case' elements from this column. Here is what I tried what am I missing in this code? </p>
<p>Data csv: </p>
<pre><code>id,list_col
1,"['',' books','PARAGRAPH','ISBN number','Harry Potter']"
2,"['',' books','TESTS','events 1234','Harry Potter',' 1 ']"
3,
4,"['',' books','PARAGRAPH','','PUBLISHES number','Garden Guide', '']"
5,"['',' books','PARAGRAPH','PUBLISHES number','The Lord of the Rings']"
</code></pre>
<p>Code: </p>
<pre><code>df = pd.read_csv('sample.csv')
# (1) # trying to remove empty list but not working 
df['list_col'] = list(filter(None, [w[2:] for w in df['list_col'].astype(str)]))
df['list_col']

# (2) remove upper case elements in the dataframe 
#AttributeError: 'map' object has no attribute 'upper'

df['list_col'] = [t for t in (w for w in df['list_col'].astype(str)) != t.upper()]
</code></pre>
<p>Output Looking for: </p>
<pre><code>id  list_col
1   [' books','ISBN number','Harry Potter']
2   [' books','events 1234','Harry Potter',' 1 ']
3   
4   [' books','PUBLISHES number','Garden Guide']
5   [' books','PUBLISHES number','The Lord of the Rings']
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>When pandas loads your CSV it loads the list as a quoted string which can be converted into a python list by eval and then you can use re.match to remove uppercase elements.</p>
<p>Code:</p>
<pre><code>import pandas as pd
from re import compile
regex = compile('^[A-Z]{1,}$')
df = pd.read_csv(r'./input.csv')
not_null_indices = df.loc[:, 'list_col'].isna()
df.loc[~not_null_indices, 'list_col'] = df.loc[~not_null_indices, 'list_col']\
    .apply(lambda x: eval(x))\
    .apply(lambda y: list(filter(lambda z: regex.match(z) is None, y)) \
           if isinstance(y, list) else list())
</code></pre>
</div>
<span class="comment-copy">is <code>filter(None, ...)</code> correct?</span>
<span class="comment-copy">I don't know if pandas converts the string with a json list directly into a list but once you have the list all you need to filter it is <code>[i for i in my_list if i != '' and i != i.upper()]</code></span>
<span class="comment-copy">k the problem might be that your list isn't actually a list, it's a string. There are quotes around the square brackets? Not sure if intentional</span>
<span class="comment-copy">@AsheKetchum The very first is the data in csv format therefore it has quotes.</span>
<span class="comment-copy">@sharp I meant that your entire list has quotes around it, so when pandas reads the csv, it sees that <code>id</code> is a number, <code>1,2,3,4,5</code> and <code>list_col</code> is a string like <code>"['',' books','PARAGRAPH','ISBN number','Harry Potter']"</code>, as a result, when you loop through it you are actually looping through the list-like string character by character.</span>
