<div class="post-text" itemprop="text">
<p>I have <code>pyspark</code> script like below.</p>
<pre><code>#!/usr/bin/env python

from datetime import datetime
from pyspark import SparkContext, SparkConf
from pyspark.sql import HiveContext

conf = SparkConf()
sc = SparkContext(conf=conf)
sqlContext = HiveContext(sc)

hivedb='MySql'
table='abc_123'

df = sqlContext.table("{}.{}".format(hivedb,table))

# Register the Data Frame as a TempTable
df.registerTempTable('mytempTable')

#Time:
date=datetime.now().strftime('%Y-%m-%d %H:%M:%S')

#Find min value ID:
min_id = sqlContext.sql("select nvl(min(id),0) as minval from mytempTable").collect()[0].asDict()['minval']

sc.stop()
</code></pre>
<p>Now I want to find out time taken by each line of code separately. Something like below</p>
<pre><code>df = sqlContext.table("{}.{}".format(hivedb,table))

Time taken for `df` to create was 10 seconds 

date=datetime.now().strftime('%Y-%m-%d %H:%M:%S')

Time taken for finding `date` was 1 second

min_id = sqlContext.sql("select nvl(min(id),0) as minval from mytempTable").collect()[0].asDict()['minval']

Time taken for `min_id` query to execute was 3 seconds
</code></pre>
<p>How can I achieve that.</p>
<p>If possible I would like to print these values as well</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use built-in <a href="https://docs.python.org/2/library/profile.html" rel="nofollow noreferrer">cProfile</a>. If you want to visualize information, you can use <a href="https://jiffyclub.github.io/snakeviz/" rel="nofollow noreferrer">Snakeviz</a></p>
<p>TLDR:
Run your script with <code>python -m cProfile [-o output_file] [-s sort_order] myscript.py</code> command and download Snakeviz and run <code>snakeviz output_file</code></p>
</div>
<span class="comment-copy">Get the time before calling function, get the time after function call and subtract and display it... <a href="https://docs.python.org/3/library/time.html#time.time" rel="nofollow noreferrer">docs.python.org/3/library/time.html#time.time</a> might be useful.</span>
