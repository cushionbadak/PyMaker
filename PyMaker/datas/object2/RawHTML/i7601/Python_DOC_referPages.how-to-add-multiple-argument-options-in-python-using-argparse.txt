<div class="post-text" itemprop="text">
<p><strong>My Requirement:</strong></p>
<p>For now when I run my python application with this command </p>
<pre><code>python main.py -d listhere/users.txt
</code></pre>
<p>The program will run and save the result file as predefined name say <strong><em>reports.txt</em></strong> </p>
<p>Now I want to add this functionality to allow users to choose what to put the filename and where to save as so </p>
<pre><code>python main.py -d -o output/newfilname -i listhere/users.txt
</code></pre>
<p>Everything is same but I want another argument -o to be passed which will determine the filpath and name to be saved. How do I do it. What is the best way to handle or combine multiple options.</p>
<p><strong>I tried this</strong> </p>
<pre><code>    parser = argparse.ArgumentParser(description = "CHECK-ACCESS REPORTING.")
    parser.add_argument('--user','-d', nargs='?')
    parser.add_argument('--output','-d -o', nargs='?')
    parser.add_argument('--input','-i', nargs='?')
    args = parser.parse_args(sys.argv[1:])

   if args.output and args.input:
        #operation that involves output filename too
   elif args.user and not args.input:
       #default operation only
   else:
      #notset
</code></pre>
<p>I am getting this error when trying to solve the issue this way</p>
<p><strong>Error:</strong></p>
<p><strong>report.py: error: unrecognized arguments: -o listhere/users.txt</strong></p>
</div>
<div class="post-text" itemprop="text">
<p>A <code>nargs='?'</code> flagged option works in 3 ways</p>
<pre><code>parser.add_argument('-d', nargs='?', default='DEF', const='CONST')
</code></pre>
<p>commandline:</p>
<pre><code>foo.py -d value # =&gt; args.d == 'value'
foo.py -d       # =&gt; args.d == 'CONST'
foo.py          # =&gt; args.d == 'DEF'
</code></pre>
<p><a href="https://docs.python.org/3/library/argparse.html#const" rel="nofollow noreferrer">https://docs.python.org/3/library/argparse.html#const</a></p>
<p>Taking advantage of that, you shouldn't need anything like this erroneous <code>-d -o</code> flag.</p>
<p>If you don't use the <code>const</code> parameter, don't use '?'</p>
<pre><code>parser.add_argument('--user','-u', nargs='?', const='CONST', default='default_user')
parser.add_argument('--output','-o', default='default_outfile')
parser.add_argument('--input','-i', default='default_infile')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Do you want to have something like this:</p>
<pre><code>import argparse

def main():
    parser = argparse.ArgumentParser(
        description='Check-Access Reporting.',
        formatter_class=argparse.ArgumentDefaultsHelpFormatter,
    )
    parser.add_argument(
        '-d',
        dest='discrepancy',
        action='store_true',
        help='Generate discrepancy report.',
    )
    parser.add_argument(
        '--input',
        '-i',
        default='users.txt',
        help='Input file for the report.',
    )
    parser.add_argument(
        '--output',
        '-o',
        default='reports.txt',
        help='Output file for the report.',
    )
    args = parser.parse_args()

    if args.discrepancy:
        print('Report type: {}'.format(args.report_type))
        print('Input file: {}'.format(args.input))
        print('Output file: {}'.format(args.output))
    else:
        print('Report type is not specified.')

if __name__ == '__main__':
    main()
</code></pre>
<p>Result of option <code>--help</code>:</p>
<pre class="lang-none prettyprint-override"><code>usage: ptest_047.py [-h] [-d] [--input INPUT] [--output OUTPUT]

Check-Access Reporting.

optional arguments:
  -h, --help            show this help message and exit
  -d                    generate discrepancy report (default: False)
  --input INPUT, -i INPUT
                        input file for the report (default: users.txt)
  --output OUTPUT, -o OUTPUT
                        output file for the report (default: reports.txt)
</code></pre>
<p>Without any option (or missing option <code>-d</code>):</p>
<pre class="lang-none prettyprint-override"><code>Report type is not specified.
</code></pre>
<p>With option <code>-d</code>:</p>
<pre class="lang-none prettyprint-override"><code>Report type: discrepancy
Input file: users.txt
Output file: reports.txt
</code></pre>
<p>With <code>-d --input input.txt --output output.txt</code>:</p>
<pre class="lang-none prettyprint-override"><code>Report type: discrepancy
Input file: input.txt
Output file: output.txt
</code></pre>
</div>
<span class="comment-copy">You can't attach more <code>-</code> options to another <code>-</code> option, no, <code>-d -o</code> is not a valid option name here. Why not just have a <code>-o</code> option to specify the output name?</span>
<span class="comment-copy">remove -d and it will work</span>
<span class="comment-copy">Why I did that is if I don't pass some values after -d it wont work . How to make -d as just the parameter without value. Tried appending default='' to -d  but not working</span>
<span class="comment-copy">if i print the value of arg with this parameter i get nothing  <code>python report.py -d -o listhere/users.txt -i list/here.txt</code></span>
<span class="comment-copy">What's the difference between the old <code>-d users.txt</code> and the new <code>-i users.txt</code>? What's the purpose of option <code>-d</code>?</span>
<span class="comment-copy">Thanks very descriptive I was very much unclear about default ,const</span>
<span class="comment-copy">Another thought: <code>-d -o</code> is split into 2 strings by the <code>bash</code>; sometimes it helps to look at <code>sys.argv</code> to seek what <code>argparse</code> has to work with.</span>
<span class="comment-copy">can you consider this please <code>python testing.py -d  -i somevalue -o somevalue</code>  I dont want to pass value after -d which result in not satisfying the condition <code>if args.users:                                            if args.input and args.output</code></span>
<span class="comment-copy">Ok did it by setting the const="some value"</span>
<span class="comment-copy">The problem there is you have to pass some value after -d flags I just want to pass the flag -d without any value to it</span>
<span class="comment-copy">@TaraPrasadGurung The order of the options does not matter, e.g.: -o output.txt -i input.txt -d. Option -d does not have any value on the command line. If the option is used somewhere on the command line, then it sets variable <code>discrepancy</code> to true.</span>
