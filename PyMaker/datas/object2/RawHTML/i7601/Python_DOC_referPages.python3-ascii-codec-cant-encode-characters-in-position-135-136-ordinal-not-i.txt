<div class="post-text" itemprop="text">
<pre><code># -*- coding: utf-8 -*-
#!/usr/bin/python3
import smtplib

gmail_user = 'X@X'
gmail_password = 'XXX'

from_add = gmail_user
to = ["X@X"]
subject ="主旨(subject)"
body ="內容(content)"
email_text = """\
From: %s
To: %s
Subject: %s
%s
"""%(from_add, ", ".join(to), subject, body)


try:
    smtpObj = smtplib.SMTP('smtp.gmail.com', 587)
    smtpObj.ehlo()
    smtpObj.starttls()
    smtpObj.login(gmail_user, gmail_password)
    smtpObj.sendmail(from_add, to, email_text)
    smtpObj.close()
    print('Email sent')
except UnicodeEncodeError as err:
    print('{}'.format(err))
except:
    print("err")
</code></pre>
<p>I got the UnicodeEncodeError:</p>
<p>'ascii' codec can't encode characters in position 73-74: ordinal not in range(128)</p>
<p>Isn't python3 defult encoding be 'UTF-8'??</p>
<p>when I run this script </p>
<p>It actually python3.5.2</p>
<p>when I print the type of body ,it is str</p>
<p>but the error seems like be asciicode not unicode for python2</p>
<p>thx</p>
</div>
<div class="post-text" itemprop="text">
<p><code>smtplib.SMTP.sendmail</code> <a href="https://docs.python.org/3/library/smtplib.html#smtplib.SMTP.sendmail" rel="nofollow noreferrer">expects its <code>msg</code> argument to be</a> a <code>str</code> containing only ascii characters or a <code>bytes</code>:</p>
<blockquote>
<p><em>msg</em> may be a string containing characters in the ASCII range, or a
  byte string. A string is encoded to bytes using the ascii codec, and
  lone <code>\r</code> and <code>\n</code> characters are converted to <code>\r\n</code> characters. A byte
  string is not modified.</p>
</blockquote>
<p>Your message is a string, but in contains non-ascii characters; you need to encode to bytes:</p>
<p><code>smtpObj.sendmail(from_add, to, email_text.encode('utf-8'))</code></p>
</div>
