<div class="post-text" itemprop="text">
<p>According to <em><a href="https://stackoverflow.com/q/3605680/3357935">Creating a simple XML file using python</a></em>, one of the simplest ways to generate an XML file in Python is to use Python's built-in ElementTree XML API.</p>
<p>However, <a href="https://docs.python.org/3/library/xml.etree.elementtree.html" rel="nofollow noreferrer">the Python 3 documentation</a> includes the following warning:</p>
<blockquote>
<p><strong>Warning:</strong> The <a href="https://docs.python.org/3/library/xml.etree.elementtree.html#module-xml.etree.ElementTree" rel="nofollow noreferrer"><code>xml.etree.ElementTree</code></a> module is not secure against maliciously constructed data. If you need to parse untrusted or unauthenticated data see <a href="https://docs.python.org/3/library/xml.html#xml-vulnerabilities" rel="nofollow noreferrer">XML vulnerabilities</a>.</p>
</blockquote>
<p>I had planned on using the ElementTree library to construct XML requests with user-inputted attribute values. However, I am now concerned about the security of my application.</p>
<p>For example, my application has a <code>logon()</code> function with arguments for a user-inputted username and password. These values are then used as XML attributes.</p>
<pre><code>import xml.etree.ElementTree as ET

def logon(username, password):
    # Create XML logon request for external webservice
    root = ET.Element("xml")
    body = ET.SubElement(root, "Logon")
    body.set("Username", username)
    body.set("Password", password)

    return ET.tostring(root, encoding="UTF-8", method="xml")
</code></pre>
<p><strong>Why is <code>xml.etree.ElementTree</code> considered insecure? Is it safe to use with user-defined XML attribute values?</strong></p>
</div>
<div class="post-text" itemprop="text">
<p>According to the section <a href="https://docs.python.org/3/library/xml.html#xml-vulnerabilities" rel="nofollow noreferrer">20.4.1. XML vulnerabilities</a> of the Python documentation, <a href="https://docs.python.org/3/library/xml.etree.elementtree.html#module-xml.etree.ElementTree" rel="nofollow noreferrer">xml.etree.ElementTree</a> is vulnerable to the <strong>Billion Laughs attack</strong> and to the <strong>quadratic blowup attack</strong>.</p>
<blockquote>
<p><strong>billion laughs / exponential entity expansion</strong></p>
<p>The Billion Laughs attack – also known as exponential entity expansion – uses multiple levels of nested entities. Each entity refers to another entity several times, and the final entity definition contains a small string. The exponential expansion results in several gigabytes of text and consumes lots of memory and CPU time.</p>
<p><strong>quadratic blowup entity expansion</strong></p>
<p>A quadratic blowup attack is similar to a Billion Laughs attack; it abuses entity expansion, too. Instead of nested entities it repeats one large entity with a couple of thousand chars over and over again. The attack isn’t as efficient as the exponential case but it avoids triggering parser countermeasures that forbid deeply-nested entities.</p>
</blockquote>
<p>As long as you don't parse maliciously crafted XML, you are safe.</p>
</div>
<span class="comment-copy">Pretty sure that's about DoS when parsing. Since you're not parsing XML, you should be fine.</span>
<span class="comment-copy">Did you read the "XML vulnerabilities" link?</span>
