<div class="post-text" itemprop="text">
<p>I am trying to send data via an API but am getting the TypeError: can't concat bytes to str. This I understand means I need to convert part of my code to bytes but I am unsure how to do this. I've tried adding b in front or using bytes('data') but might be placing them in the wrong area. </p>
<pre><code>import http.client

conn = http.client.HTTPSConnection("exampleurl.com")

payload = {
    'FilterId': "63G8Tg4LWfWjW84Qy0usld5i0f",
    'name': "Test",
    'description': "Test1",
    'deadline': "2017-12-31",
    'exclusionRuleName': "Exclude",
    'disable': "true",
    'type': "Type1"
    }

headers = {
    'content-type': "multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW",
    'x-csrf-token': "wWjeFkMcbopci1TK2cibZ2hczI",
    'cache-control': "no-cache",
    'postman-token': "23c09c76-3b030-eea1-e16ffd48e9"
    }


conn.request("POST", "/api/campaign/create", payload, headers)


res = conn.getresponse()
data = res.read()

print(data.decode("utf-8"))
</code></pre>
<p>This is the problem line:</p>
<pre><code>conn.request("POST", "/api/campaign/create", payload, headers)
</code></pre>
<p>I am unsure what and how to convert to bytes.</p>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="http://docs.python-requests.org/en/master/" rel="nofollow noreferrer"><code>requests</code></a> if you can, it's much easier to work with.</p>
<p>Otherwise, you need to <a href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlencode" rel="nofollow noreferrer"><code>urlencode</code></a> the payload to be posted to the server. The url encoded version of your payload looks like this:</p>
<pre>
description=Test1&amp;exclusionRuleName=Exclude&amp;FilterId=63G8Tg4LWfWjW84Qy0usld5i0f&amp;deadline=2017-12-31&amp;type=Type1&amp;name=Test&amp;disable=true
</pre>
<p>Here is a working example:</p>
<pre><code>import http.client
from urllib.parse import urlencode

conn = http.client.HTTPSConnection("httpbin.org")

payload = {
    'FilterId': "63G8Tg4LWfWjW84Qy0usld5i0f",
    'name': "Test",
    'description': "Test1",
    'deadline': "2017-12-31",
    'exclusionRuleName': "Exclude",
    'disable': "true",
    'type': "Type1"
    }

headers = {
    'Content-Type': 'application/x-www-form-urlencoded',
    'x-csrf-token': "wWjeFkMcbopci1TK2cibZ2hczI",
    'cache-control': "no-cache",
    'postman-token': "23c09c76-3b030-eea1-e16ffd48e9"
    }

conn.request("POST", "/post", urlencode(payload), headers)

res = conn.getresponse()
data = res.read()

print(data.decode("utf-8"))
</code></pre>
<p><a href="http://httpbin.org" rel="nofollow noreferrer">http://httpbin.org</a> returns this JSON response:</p>
<pre>
{
  "args": {}, 
  "data": "", 
  "files": {}, 
  "form": {
    "FilterId": "63G8Tg4LWfWjW84Qy0usld5i0f", 
    "deadline": "2017-12-31", 
    "description": "Test1", 
    "disable": "true", 
    "exclusionRuleName": "Exclude", 
    "name": "Test", 
    "type": "Type1"
  }, 
  "headers": {
    "Accept-Encoding": "identity", 
    "Cache-Control": "no-cache", 
    "Connection": "close", 
    "Content-Length": "133", 
    "Content-Type": "application/x-www-form-urlencoded", 
    "Host": "httpbin.org", 
    "Postman-Token": "23c09c76-3b030-eea1-e16ffd48e9", 
    "X-Csrf-Token": "wWjeFkMcbopci1TK2cibZ2hczI"
  }, 
  "json": null, 
  "origin": "220.233.14.203", 
  "url": "https://httpbin.org/post"
}
</pre>
<p>Note that I am using <a href="http://httpbin.org/" rel="nofollow noreferrer">httpbin.org</a> as a test server, posting to <a href="https://httpbin.org/post" rel="nofollow noreferrer">https://httpbin.org/post</a>.</p>
<p>Also, I have changed the Content-type header to application/x-www-form-urlencoded because that is the format returned by urlencode().</p>
</div>
<span class="comment-copy">why not use the <code>requests</code> module instead?</span>
<span class="comment-copy">I receive a 'ssl.SSLError: [SSL: CERTIFICATE_VERIFY_FAILED]' error when trying to use that. Thought this issue might be easier to fix than that.</span>
<span class="comment-copy">@nvachhan: the server at <a href="https://exampleurl.com" rel="nofollow noreferrer">exampleurl.com</a> does not have a valid SSL certificate. You can test with just HTTP, or try using <a href="http://httpbin.org" rel="nofollow noreferrer">httpbin.org</a> as shown in my answer. Better still, use <code>requests</code> as suggested.</span>
<span class="comment-copy">I will post another question with the code I used with requests</span>
<span class="comment-copy">Your code definitely works but my url does not, it is not actually 'exampleurl.com'. Mine does not return any errors now but also does not execute the api post. Could this just be a problem with my payload data? Or the site itself?</span>
<span class="comment-copy">What is returned? Try <code>print('{} {}'.format(res.status, res.reason))</code> and print the body of the response. I'm sure that the data will be posted to any URL that you specify, but it's up to the server to process it. There is nothing wrong with your payload data, assuming that the server expects those fields. The headers are more likely the problem - especially suspect is the <code>content-type: multipart/form-data</code> header which requires that the body of the request be formatted a particular way.</span>
<span class="comment-copy">@nvachhan: are you using a public API or is it something custom?</span>
<span class="comment-copy">@nvachhan: anyway. I think that I have answered your original question, so you might consider accepting it.</span>
<span class="comment-copy">It is something custom, not a public API. I modified to what you said and got the following result printed "401 Unauthorized"</span>
