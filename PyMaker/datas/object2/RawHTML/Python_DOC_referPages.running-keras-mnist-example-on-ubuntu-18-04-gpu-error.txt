<div class="post-text" itemprop="text">
<p>I was running the following Keras/TensorFlow code code after setting up Anaconda 2018.12 on Ubuntu 18.04.  I have Nvidia driver 390.116 and have a GTX 1070 GPU.  However, when I try to run this simple MNIST example </p>
<pre><code>import tensorflow as tf
mnist = tf.keras.datasets.mnist

(x_train, y_train),(x_test, y_test) = mnist.load_data()
x_train, x_test = x_train / 255.0, x_test / 255.0

model = tf.keras.models.Sequential([
  tf.keras.layers.Flatten(input_shape=(28, 28)),
  tf.keras.layers.Dense(512, activation=tf.nn.relu),
  tf.keras.layers.Dropout(0.2),
  tf.keras.layers.Dense(10, activation=tf.nn.softmax)
])
model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

model.fit(x_train, y_train, epochs=5)
model.evaluate(x_test, y_test)
</code></pre>
<p>I get a traceback that points to an insufficiently new NVidia driver. The entire traceback is long, but I think the key line is</p>
<blockquote>
<p>File
  "/home/christopher/anaconda3/envs/tensorflow_gpuenv/lib/python3.6/site-packages/tensorflow/python/client/session.py",
  line 676, in <strong>init</strong>
      self._session = tf_session.TF_NewSessionRef(self._graph._c_graph, opts) tensorflow.python.framework.errors_impl.InternalError:
  cudaGetDevice() failed. Status: CUDA driver version is insufficient
  for CUDA runtime version</p>
</blockquote>
<p>This doesn't seem to make sense, as this is the most current driver for Ubuntu 18.04 that is available.  This is not a duplicate of the earlier insufficient driver issue because I am using Nvidia driver 390.116. </p>
</div>
<div class="post-text" itemprop="text">
<p>I solved this by looking at the article on pugetsystems mentioned above.  However, purging the old driver and installing the suggested driver from that article did not work for me. However, after purging the original Nvidia driver, (390.116), switching to Nouveau, rebooting, and installing Nvidia driver 415.27 using the Additional Drivers property page in the Software and Sources application, I was able to successfully run the example code.  </p>
</div>
<span class="comment-copy">What version of tensorflow are you running?</span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/41409842/ubuntu-16-04-cuda-8-cuda-driver-version-is-insufficient-for-cuda-runtime-vers">Ubuntu 16.04, CUDA 8 - CUDA driver version is insufficient for CUDA runtime version</a></span>
<span class="comment-copy">Tensorflow version is 1.12.0.</span>
<span class="comment-copy">I don't feel qualified to answer officially, but TF doesn't seem to want the newest drivers. I had luck creating a virtual environment for tensorflow using conda, that was self consistent without having to roll back the drivers on the system, per the instructions here: <a href="https://www.pugetsystems.com/labs/hpc/Install-TensorFlow-with-GPU-Support-the-Easy-Way-on-Ubuntu-18-04-without-installing-CUDA-1170/" rel="nofollow noreferrer">pugetsystems.com/labs/hpc/â€¦</a></span>
