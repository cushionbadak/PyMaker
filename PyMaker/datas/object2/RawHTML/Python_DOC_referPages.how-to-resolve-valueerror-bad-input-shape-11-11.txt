<div class="post-text" itemprop="text">
<p>I am new to Python and Machine Learning. I found a project online that incorporates both Arduino and Python and I decided to give it a try. The github link of the project is <a href="https://github.com/reshu-b7/Sign-Language-Glove" rel="nofollow noreferrer">here</a> btw. The Arduino part is already functional and I can already write the data into csv files. I'm trying to insert data from the csv file into training in svm. However, I can't get past the training part. The code is as follows.</p>
<pre><code>import numpy as np
import csv
from sklearn import svm
from sklearn.metrics import accuracy_score
from sklearn.metrics import confusion_matrix
import pandas as pd
dataframe= pd.read_csv("csvdata.csv", delimiter=',')

from sklearn.model_selection import train_test_split
train, test = train_test_split(df, test_size = 0.2)

train_features = train[['LABEL','F1','F2','F3','F4','F5','X','Y','Z','C1','C2']]
train_label = train.values

test_features = test[['LABEL','F1','F2','F3','F4','F5','X','Y','Z','C1','C2']]
test_label = test.values

## SVM
model = svm.SVC(kernel='linear', gamma=1, C=1)
model.fit(train_features, train_label)
</code></pre>
<p>Whenever I run the code, I stumble upon this error in the last line:</p>
<pre><code>Traceback (most recent call last):
  File "C:\Python27\projects\practice\modeling.py", line 32, in &lt;module&gt;
    model.fit(train_features, train_label)
  File "C:\Python27\lib\site-packages\sklearn\svm\base.py", line 149, in fit
    accept_large_sparse=False)
  File "C:\Python27\lib\site-packages\sklearn\utils\validation.py", line 761, in check_X_y
    y = column_or_1d(y, warn=True)
  File "C:\Python27\lib\site-packages\sklearn\utils\validation.py", line 797, in column_or_1d
    raise ValueError("bad input shape {0}".format(shape))
ValueError: bad input shape (11, 11)
</code></pre>
<p>I'm really confused I don't know what to do anymore. I have no idea how labels and features and training via csv works. I've studied training via manual insertion of data in the Python script and they work, but I have found no solution in training from csv .</p>
<p>here are the contents of the csv file</p>
<pre><code>F1,F2,F3,F4,F5,X,Y,Z,C1,C2

525, 505, 544, 557, 545, 1268, -8264, 14888, 1, 1

523, 505, 544, 557, 545, 1480, -8320, 14684, 1, 1

517, 505, 544, 557, 544, 1460, -8352, 14712, 1, 1

524, 505, 544, 557, 545, 1436, -8312, 14496, 1, 1

568, 506, 544, 557, 544, 1308, -8348, 14744, 1, 1

578, 506, 544, 557, 544, 1128, -8484, 14376, 1, 1

583, 506, 544, 557, 545, 1376, -8180, 14768, 1, 1

583, 505, 544, 557, 545, 1380, -8220, 14636, 1, 1

550, 505, 544, 557, 544, 1332, -8376, 14700, 1, 1

510, 505, 544, 557, 545, 1412, -8320, 14620, 1, 1

510, 505, 544, 557, 545, 1412, -8320, 14620, 1, 1

510, 505, 544, 557, 545, 1412, -8320, 14620, 1, 1
</code></pre>
<p>I hope anybody could help it's been weeks now I wanna figure this out. Thank you.</p>
</div>
<div class="post-text" itemprop="text">
<p>In your <code>model.fit</code>, you should pass the features and the labels; but as is (<code>train_label = train.values</code>), you end up with your features &amp; labels being essentially the same thing. Your labels are expected to be 1-dimensional (you can see a <code>y = column_or_1d</code> in the error message), and certainly <em>not</em> a part of your features.</p>
<p>You should change the features &amp; labels definitions as follows:</p>
<pre><code>train_features = train[['F1','F2','F3','F4','F5','X','Y','Z','C1','C2']]
train_label = train['LABEL']

test_features = test[['F1','F2','F3','F4','F5','X','Y','Z','C1','C2']]
test_label = test['LABEL']
</code></pre>
<p>And if your <code>model.fit</code> doesn't work as is, try:</p>
<pre><code>model.fit(train_features.values, train_label.values)
</code></pre>
</div>
<span class="comment-copy">You are missing a <code>LABEL</code> column in your posted data (not the cause of your error)</span>
<span class="comment-copy">train.values is of shape (11,11), it must be a 1d numpy array for it to be labels</span>
