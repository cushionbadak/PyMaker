<div class="post-text" itemprop="text">
<p>Suppose I have a main dataframe</p>
<pre><code>main_df

  Cri1  Cri2   Cr3  total
0   A1    A2    A3  4
1   B1    B2    B3  5
2   C1    C2    C3  6
</code></pre>
<p>I also have 3 dataframes</p>
<pre><code>df_1

      Cri1   Cri2  Cri3 value
    0   A1    A2    A3  1
    1   B1    B2    B3  2

df_2
      Cri1  Cri2  Cri3  value
    0   A1    A2    A3  9
    1   C1    C2    C3  10

df_3
      Cri1  Cri2  Cri3  value
    0   B1    B2    B3  15
    1   C1    C2    C3  17
</code></pre>
<p>What I want is to add value from each frame <code>df</code> to total in the <code>main_df</code> according to Cri
i.e. main_df will become</p>
<p>main_df </p>
<pre><code>      Cri1  Cri2  Cri3  total
    0   A1    A2    A3  14
    1   B1    B2    B3  22
    2   C1    C2    C3  33
</code></pre>
<p>Of course I can do it using for loop, but at the end I want to apply the method to a large amount of data, say 50000 rows in each dataframe.</p>
<p>Is there other ways to solve it?</p>
<p>Thank you!</p>
</div>
<div class="post-text" itemprop="text">
<p>First you should align your numeric column names. In this case:</p>
<pre><code>df_main = df_main.rename(columns={'total': 'value'})
</code></pre>
<p>Then you have a couple of options.</p>
<h3>concat + groupby</h3>
<p>You can concatenate and then perform a <code>groupby</code> with <code>sum</code>:    </p>
<pre><code>res = pd.concat([df_main, df_1, df_2, df_3])\
        .groupby(['Cri1', 'Cri2', 'Cri3']).sum()\
        .reset_index()

print(res)

  Cri1 Cri2 Cri3  value
0   A1   A2   A3     14
1   B1   B2   B3     22
2   C1   C2   C3     33
</code></pre>
<h3>set_index + reduce / add</h3>
<p>Alternatively, you can create a list of dataframes indexed by your criteria columns. Then use <a href="https://docs.python.org/3/library/functools.html#functools.reduce" rel="nofollow noreferrer"><code>functools.reduce</code></a> with <a href="https://pandas.pydata.org/pandas-docs/version/0.23/generated/pandas.DataFrame.add.html" rel="nofollow noreferrer"><code>pd.DataFrame.add</code></a> to sum these dataframes.</p>
<pre><code>from functools import reduce

dfs = [df.set_index(['Cri1', 'Cri2', 'Cri3']) for df in [df_main, df_1, df_2, df_3]]

res = reduce(lambda x, y: x.add(y, fill_value=0), dfs).reset_index()

print(res)

  Cri1 Cri2 Cri3  value
0   A1   A2   A3   14.0
1   B1   B2   B3   22.0
2   C1   C2   C3   33.0
</code></pre>
</div>
