<div class="post-text" itemprop="text">
<p>I have installed <a href="http://qpdf.sourceforge.net/" rel="nofollow noreferrer">qpdf</a> and am trying to call it via Python.</p>
<p>I have added the path to my system Environment Variables and can successfully run the following command via the command prompt:</p>
<pre><code>qpdf --decrypt input.pdf output.pdf
</code></pre>
<p>This runs, no issues.</p>
<p>However, when trying to call via Python (code from <a href="https://stackoverflow.com/a/40621173/4650297">here</a>), I get</p>
<blockquote>
<p>'qpdf' is not recognized as an internal or external command,
  operable program or batch file.</p>
</blockquote>
<pre><code>import subprocess
subprocess.call(["cmd", "/c", "qpdf --decrypt input.pdf output.pdf"], shell=True)
# or 
subprocess.run(["qpdf", "--decrypt", "input.pdf", "output.pdf"], shell=True)
# or
subprocess.run(["qpdf --decrypt input.pdf output.pdf"], shell=True)
</code></pre>
<p>Why can I run this via cmd, but not in Python?</p>
</div>
<div class="post-text" itemprop="text">
<p>As per the comments:</p>
<p>The problem is that environment variables are only loaded when you launch your executable/shell session/whatever. Here, a directory was added to the <code>PATH</code> environment variable, so sublime text needed to be restarted before it could see the updated <code>PATH</code>. This isn't specific to sublime, the same would be true if you were running directly from a terminal or another IDE.</p>
</div>
<span class="comment-copy">ensure that you have your python program in the same directory in from which the CMD works .</span>
<span class="comment-copy">It may be that you're using a shell session from before you added <code>qpdf</code> to <code>PATH</code>. Try running the python from a new session.</span>
<span class="comment-copy">According to <a href="https://docs.python.org/3/library/subprocess.html" rel="nofollow noreferrer">the docs</a> "On Windows with shell=True, the COMSPEC environment variable specifies the default shell. The only time you need to specify shell=True on Windows is when the command you wish to execute is built into the shell (e.g. dir or copy). You do not need shell=True to run a batch file or console-based executable."</span>
<span class="comment-copy">@JMAA - Aha! I had SublimeText open before, during, and after installation of <code>qpdf</code>.  I exited out and re-opened and it's not throwing the error anymore.  That was it, a simple fix thankfully :D</span>
<span class="comment-copy">(@JMAA - If you want to turn that in to an answer, go for it and I can the question as Answered)</span>
