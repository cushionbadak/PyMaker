<div class="post-text" itemprop="text">
<p>I am rather new to Python and have been trying to run a .cmd file with it, but it won't run it from the correct location. My file Run_setup.cmd, is setting up another a different software with a bunch of related files and so I have sequestered them to their own folder for my sanity.</p>
<p>Currently I can get the .cmd file to run from the same location as my source code. I know I am messing up the file path for it with <strong>cwd=r'%s'</strong> based on what the documentation says, but I don't get how.</p>
<blockquote>
<p>If <strong>cwd</strong> is not <em>None</em>, the function changes the working directory to <strong>cwd</strong> before executing the child. cwd can be a str and path-like object. In particular, the function looks for executable (or for the first item in args) relative to cwd if the executable path is a relative path.</p>
</blockquote>
<p>I currently have it using <strong>cwd=r' C:\LargeFolder\Files\CorrectFolder'</strong> based off <a href="https://stackoverflow.com/questions/5469301/run-a-bat-file-using-python-code">this post</a>, and it seems that it works for any file path, but I can't seem to get it to work for me.</p>
<pre><code>from subprocess import Popen

def runCmdfile():
    # File Path to source code:    'C:\LargeFolder\Files'
    myDir = os.getcwd()

    # File Path to .cmd file:      'C:\LargeFolder\Files\CorrectFolder'
    myDir = myDir + '\CorrectFolder'

    runThis = Popen('Run_setup.cmd', cwd=r'%s' % myDir)

    stdout, stderr = runThis.communicate()
</code></pre>
<p>What am I missing here, and furthermore what is the purpose of using <strong>cwd=r' '</strong> ?</p>
</div>
<div class="post-text" itemprop="text">
<p>this one works for me:</p>
<pre><code>def runCmdfile():
    # File Path to source code:    'C:\LargeFolder\Files'
    myDir = os.getcwd()

    # File Path to .cmd file:      'C:\LargeFolder\Files\CorrectFolder'
    myDir = os.path.join(myDir, 'CorrectFolder')

    # Popen does not take cwd into account for the file to execute
    # so we build the FULL PATH on our own
    runThis = Popen(os.path.join(myDir, 'Run_setup.cmd'), cwd=myDir)

    stdout, stderr = runThis.communicate()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>the parameter is <code>cwd=</code>. The <code>r""</code> part only needs to exist in the definition of your string, to have a raw string and make python ignore special sequences using backslashes.</p>
<p>Since your string comes from <code>os.getcwd</code>, you don't need it.</p>
<pre><code>def runCmdfile():
    # File Path to source code:    'C:\LargeFolder\Files'
    myDir = os.getcwd()

    # File Path to .cmd file:      'C:\LargeFolder\Files\CorrectFolder'
    myDir = os.path.join(myDir, 'CorrectFolder')

    runThis = Popen('Run_setup.cmd', cwd=myDir)

    stdout, stderr = runThis.communicate()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Your error is due to not escaping your \.
You need to escape your "\" where you're adding in your subfolder and then you should be good to go.</p>
<pre><code>myDir = myDir + '\CorrectFolder'
</code></pre>
<p>should be</p>
<pre><code>myDir = myDir + '\\CorrectFolder'
</code></pre>
</div>
<span class="comment-copy"><code>os.getcwd()</code> isn't the directory of the source code.</span>
<span class="comment-copy"><code>cwd=r' '</code> it's a raw string see (<a href="https://docs.python.org/3/reference/lexical_analysis.html" rel="nofollow noreferrer">docs.python.org/3/reference/lexical_analysis.html</a>)</span>
<span class="comment-copy">This works for me, thanks for the help.</span>
<span class="comment-copy">When using your code I keep getting the error 'FileNotFoundError: [WinError 2] The system cannot find the file specified'. I don't know why it can't find the file as  I have confirmed it is in the right folder.</span>
<span class="comment-copy">@NeverSundae does <code>print(myDir)</code> right before <code>runThis ...</code> really show the correct path? you may try even a <code>print('*'+myDir+'*')</code> to detect leading/trailing blanks etc.</span>
<span class="comment-copy">@ack I tried printing like you suggested, but there are no blanks.</span>
<span class="comment-copy">@nosklo  I seemed to have solved my problem, does anyone know why this seems to work?:   runThis = Popen('C:\LargeFolder\Files\CorrectFolder\Run_setup.cmd')</span>
