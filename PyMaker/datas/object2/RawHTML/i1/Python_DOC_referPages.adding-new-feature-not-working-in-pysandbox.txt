<div class="post-text" itemprop="text">
<p>I am using the <a href="https://github.com/vstinner/pysandbox" rel="nofollow noreferrer">pysandbox</a> to run the Python code in sandbox environment. I got it up and running, but I want it to support python <code>datetime</code> module. As per the documentation, I added 'datetime' in the config as follows,</p>
<pre><code>sandbox = SandboxConfig('datetime', cpython_restricted=False)
</code></pre>
<p>but if I run the code I still get the error,</p>
<p><strong>'global name datetime is not defined'</strong></p>
</div>
<div class="post-text" itemprop="text">
<p>There is some issue with the pysandbox. Looks like you are passing some parameter to the sandboxed function through the <code>locals</code> variable. In this case, the import is not added to the global namespace. </p>
<p>Simply write <code>global datetime</code> right after you import it and it will work. Otherwise, you may also pass it as a function parameter.</p>
</div>
<span class="comment-copy">This works for me with pysandbox version 1.5.1. Which version are you using?</span>
<span class="comment-copy">I am using the same version 1.5.1. Did you do any additional configuration apart from adding 'datetime' to the config? In my case, I had to modify the SandboxConfig to enable 'traceback' for pysandbox to get the path of 'datetime' module. It still doesn't work for me.</span>
<span class="comment-copy">All I did was create a new virtualenv, run <code>pip install pysandbox</code>, and then do <code>from sandbox import SandboxConfig; sandbox = SandboxConfig('datetime', cpython_restricted=False)</code>. I'm using Python 2.7. Does that work for you?</span>
<span class="comment-copy">Thanks! I did a deep dive into this issue and figured out that my global imports are not available inside any function. <code>import datetime def get_today(): print(datetime.date.today())</code> gives <b>global name datetime is not defined</b> error. But if I pass datetime as an argument to the function only then it works.</span>
<span class="comment-copy">thanks! it worked for me.</span>
