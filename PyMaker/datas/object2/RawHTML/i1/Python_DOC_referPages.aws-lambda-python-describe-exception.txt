<div class="post-text" itemprop="text">
<p>working code:</p>
<pre><code>import boto3
def lambda_handler(event, context):
    ec2 = boto3.client('ec2')

    # Get list of regions
    regions = ec2.describe_regions().get('Regions',[] )

    # Iterate over regions
    for region in regions:
        print("*************** Checking region  --   %s " % region['RegionName'])
        reg = region['RegionName']
        print(reg)
</code></pre>
<p>Output:</p>
<pre><code>*************** Checking region  --   eu-north-1 
eu-north-1
*************** Checking region  --   ap-south-1 
ap-south-1
*************** Checking region  --   eu-west-3 
eu-west-3
*************** Checking region  --   eu-west-2 
eu-west-2
*************** Checking region  --   eu-west-1
</code></pre>
<p>its iterating and showing all the regions but my code is simply exiting with first iteration after i try to describe the resource details.</p>
<pre><code>import boto3
def lambda_handler(event, context):
    ec2 = boto3.client('ec2')

    # Get list of regions
    regions = ec2.describe_regions().get('Regions',[] )

    # Iterate over regions
    for region in regions:
        print("*************** Checking region  --   %s " % region['RegionName'])
        reg = region['RegionName']
        print(reg)
        print ("+++++++++++++ Starting EC2 Instances now -----------------") 
        client = boto3.client('ec2', region_name=reg)
        response = client.describe_instances()
</code></pre>
<p>output error out:</p>
<pre><code>Response:
{
  "errorMessage": "2019-03-14T18:08:00.104Z 5fb67a9a-3bf9-40e3-ad56 Task timed out after 3.00 seconds"
}

Request ID:
"5fb67a9a-3bf9-40e3-ad56"

Function Logs:
START RequestId: 5fb67a9a-3bf9-40e3-ad56 Version: $LATEST
*************** Checking region  --   eu-north-1 
eu-north-1
+++++++++++++ Starting EC2 Instances now -----------------
*************** Checking region  --   ap-south-1 
ap-south-1
+++++++++++++ Starting EC2 Instances now -----------------
END RequestId: 5fb67a9a-3bf9-40e3-ad56
REPORT RequestId: 5fb67a9a-3bf9-40e3-ad56-Duration: 3003.21 ms  Billed Duration: 3000 ms    Memory Size: 128 MB Max Memory Used: 79 MB  
2019-03-14T18:08:00.104Z 5fb67a9a-3bf9-40e3-ad56-Task timed out after 3.00 seconds
</code></pre>
<p>i have given all permissions to lambda role to access the resources.
Can anyone help me what wrong i'm doing and how to know what is the error?</p>
</div>
<div class="post-text" itemprop="text">
<p>Your code iterated <code>eu-north-1</code> and <code>ap-south-1</code> successfully but then timed out after the default Lambda timeout of 3 seconds. You need to either make your code run faster or extend the Lambda timeout.</p>
<ol>
<li>Go to your <a href="https://console.aws.amazon.com/lambda/home" rel="nofollow noreferrer">Lambda console</a></li>
<li>Find your function and open it</li>
<li>Scroll down and look for Timeout under Basic settings</li>
<li>Extend your timeout (15 minutes is the current maximum)</li>
<li>Click Save on the top</li>
</ol>
</div>
<span class="comment-copy">The Lambda seems to be timing out, can you add a try/catch around the client.describe_instances() call? And maybe increase timeout a bit, see if you're getting any error</span>
<span class="comment-copy">Its working after increasing timeout ...thanks</span>
<span class="comment-copy">FYI, highly recommended not to increase it to the max timeout, if you run into an issue it might cause it to run for a lot longer than necessary. Glad it worked though :)</span>
