<div class="post-text" itemprop="text">
<p>How can I rename the last column in a dataframe, that was passed along in a method chain? Think about the following example (the real use case is more complex). How can the rename function refer to the dataframe that it processes (which is different from the "table" dataframe? Is there something like the following? Unfortunately "self" does not exist.</p>
<pre><code>result = table.iloc[:,2:-1].rename(columns={self.columns[-1]: "Text"})
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use <code>pipe()</code>:</p>
<pre><code>result = table.iloc[:,2:-1].pipe(lambda df: df.rename(columns={df.columns[-1]: "Text"}))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I think that you can just do the following:</p>
<pre><code>result = table.iloc[:,2:-1]
result.columns = result.columns[:-1] + ["Text"]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could use <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.pipe.html" rel="nofollow noreferrer"><code>pipe</code></a>:</p>
<pre><code>result = xxx.pipe(lambda df: df.rename(columns={df.columns[-1]: 'text'}))
</code></pre>
</div>
<span class="comment-copy">We have the same answer... except you have a typo! It's <code>df.rename</code>...</span>
<span class="comment-copy">@Wen-Ben that should not be my fault. You try to do things in a chain, you should know the risk (or you assumed that would not be the case).</span>
<span class="comment-copy">@IanS typo fixed. thanks</span>
<span class="comment-copy">Awesome, thanks to all who suggested pipe()</span>
<span class="comment-copy">@Wen-Ben I'm not sure I understand your point.</span>
<span class="comment-copy">Yes, but I want to keep the chain.</span>
