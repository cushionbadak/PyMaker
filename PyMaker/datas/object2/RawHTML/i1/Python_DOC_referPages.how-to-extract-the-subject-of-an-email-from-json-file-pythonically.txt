<div class="post-text" itemprop="text">
<p>I want to extract the subject of a spam email from a json file but the subject could be anywhere in the file, within the 'content' or 'header' or 'body' . Using regex, I am unable to extract the subject despite using this below code:Could someone point to what is incorrect in the below regex or code?</p>
<pre><code>import re
import json
with open("test.json", 'r') as fp:
    json_decode = json.loads(fp.read())


p = re.compile('([\[\(] *)?.*(RE?S?|FWD?|re\[\d+\]?) *([-:;)\]][ :;\])-]*|$)|\]+ *$', re.IGNORECASE)
for line in json_decode:
    print(p.sub('', line).strip())
</code></pre>
<p>OUTPUT(incorrect) : body</p>
<p>My test.json file is this:</p>
<pre><code>    {'attachment': [{'content_header': {'content-disposition': ['attachment; '
                                                        'filename="image006.jpg"'],
                                'content-id': ['&lt;image006.jpg@01D35D21.756FEE10&gt;']
     'body': [{'content': ' \n'
                  ' \n'
                  'From: eCard Delivery [mailto:ecards@789greeting.com] \n'
                  'Sent: Monday, November 13, 2017 9:14 AM\n'
                  'To: Zhang, Jerry (352A-Affiliate) '

                  'Subject: Warmest Wishes! You have a Happy Thanksgiving '
                  'ecard delivery!\n'
                  ' \n'
                  ' \tDear Jerry,\n'
     'header': {'date': '2017-11-14T08:20:42-08:00',

        'header': {'accept-language': ['en-US'],
                   'content-language': ['en-US'],
                   'content-type': ['multipart/mixed; '
                                    'boundary="--boundary-LibPST-iamunique-1500317751_-_-"'],
                   'date': ['Tue, 14 Nov 2017 08:20:42 -0800']
                   'subject': 'FW: Warmest Wishes! You have a Happy Thanksgiving '
                   'ecard delivery!'}}
</code></pre>
<p>^ Above here is the right format of the json file. </p>
</div>
<div class="post-text" itemprop="text">
<p><strong>Alrighty - So now given the fact that you original JSON file may not contain <code>newline characters</code> I'm hoping this works, and may even be more accurate</strong></p>
<pre><code>&gt;&gt;&gt; string = '''{'attachment': [{'content_header': {'content-disposition': ['attachment; ''filename="image006.jpg"'],'content-id': ['&lt;image006.jpg@01D35D21.756FEE10&gt;'] 'body': [{'content': ' '' ''From: eCard Delivery [mailto:ecards@789greeting.com] ''Sent: Monday, November 13, 2017 9:14 AM''To: Zhang, Jerry (352A-Affiliate) ''Subject: Warmest Wishes! You have a Happy Thanksgiving ''ecard delivery!'' ''   Dear Jerry,' 'header': {'date': '2017-11-14T08:20:42-08:00','header': {'accept-language': ['en-US'], 'content-language': ['en-US'], 'content-type': ['multipart/mixed; ''boundary="--boundary-LibPST-iamunique-1500317751_-_-"'], 'date': ['Tue, 14 Nov 2017 08:20:42 -0800'] 'subject': 'FW: Warmest Wishes! You have a Happy Thanksgiving ' 'ecard delivery!'}}'''

&gt;&gt;&gt; subjects_test = re.findall('([\'|\"]*[\S]ubject[\S\s]+?[\'|\"]+)(?=\n|$|\s|\})', string)


&gt;&gt;&gt; for subject in subjects_test:
        print(subject)



#OUPUT: #Kind of off I guess, but I don't know the full format of the file so this is the safest bet    

''Subject: Warmest Wishes! You have a Happy Thanksgiving ''ecard delivery!''
'subject': 'FW: Warmest Wishes! You have a Happy Thanksgiving '
</code></pre>
<p><strong>Edit - Given your comment below, using the String you supplied above. Hopefully I'm understanding your requirements. I use both regex samples I provided.</strong></p>
<pre><code>&gt;&gt;&gt; string = '''{'attachment': [{'content_header': {'content-disposition': ['attachment; '
                                                    'filename="image006.jpg"'],
                            'content-id': ['&lt;image006.jpg@01D35D21.756FEE10&gt;']
 'body': [{'content': ' \n'
              ' \n'
              'From: eCard Delivery [mailto:ecards@789greeting.com] \n'
              'Sent: Monday, November 13, 2017 9:14 AM\n'
              'To: Zhang, Jerry (352A-Affiliate) '

              'Subject: Warmest Wishes! You have a Happy Thanksgiving '
              'ecard delivery!\n'
              ' \n'
              ' \tDear Jerry,\n'
 'header': {'date': '2017-11-14T08:20:42-08:00',

    'header': {'accept-language': ['en-US'],
               'content-language': ['en-US'],
               'content-type': ['multipart/mixed; '
                                'boundary="--boundary-LibPST-iamunique-1500317751_-_-"'],
               'date': ['Tue, 14 Nov 2017 08:20:42 -0800']
               'subject': 'FW: Warmest Wishes! You have a Happy Thanksgiving '
               'ecard delivery!'}}'''



&gt;&gt;&gt; subjects_test_1 = re.findall('([\'\"]*[S|s]ubject[:\s]*?(?:[\'|\"]*[\S\s]*?(?=[\'|\"])*))(?=\n|$)', string)


&gt;&gt;&gt; for subject in subjects_test_1:
        print(subject)

#OUPUT: 
'Subject: Warmest Wishes! You have a Happy Thanksgiving '
'subject': 'FW: Warmest Wishes! You have a Happy Thanksgiving '


########################################################

&gt;&gt;&gt; subjects_test_2 = re.findall('([\'|\"]*[\S]ubject[\S\s]+?[\'|\"]*)(?=\n|$)', string)


&gt;&gt;&gt; for subject in subjects_test_2:
        print(subject)

#OUPUT: 
'Subject: Warmest Wishes! You have a Happy Thanksgiving '
'subject': 'FW: Warmest Wishes! You have a Happy Thanksgiving '
</code></pre>
<p>.</p>
<p>Or try this function:</p>
<p><strong>For the line where you call the function, replace <code>'PATH_TO_YOUR_FILE'</code> with... you know, the path to your file ...</strong></p>
<pre><code>&gt;&gt;&gt; def email_subject_parse(file_path):
        import re
        email_subjects = []
        try:
            with open(file_path) as file:
                string = file.read()
                email_subjects = re.findall('([\'\"]*[S|s]ubject[:\s]*?(?:[\'|\"]*[\S\s]*?(?=[\'|\"])*))(?=\n|$)', string)
                #Or less complicated 
                #email_subjects = re.findall('([\'|\"]*[\S]ubject[\S\s]+?[\'|\"]*)(?=\n|$)', string)
                return email_subjects
        except:
            print('You have likely provided a bad file path')


&gt;&gt;&gt; subjects = email_subject_parse('PATH_TO_YOUR_FILE')


&gt;&gt;&gt; for subject in subjects:
        print(subject)



#OUPUT: 
'Subject: Warmest Wishes! You have a Happy Thanksgiving '
'subject': 'FW: Warmest Wishes! You have a Happy Thanksgiving '
</code></pre>
</div>
<span class="comment-copy">The contents of the <code>test.json</code> shown in your question isn't in valid JSON syntax â€” so I doubt that's actually what's in it.</span>
<span class="comment-copy">I removed some text as I wasn't supposed to share specific emails and names but the format is unchanged.</span>
<span class="comment-copy">@martineau added the valid json file the way it is.</span>
<span class="comment-copy">If that's the contents of your file, then the <code>json.loads()</code> would fail.</span>
<span class="comment-copy">Sooo, tbh, you approached it going wayyyy  left. If you're trying to find things related to <code>s/Subject</code> have <code>ubject</code> somewhere in the regex. You can also use something like <code>'([\'|\"][\S\s]+?[\'|\"])(?=\s|$)'</code> to capture things inside of the quotes. I give a more precise solution below</span>
<span class="comment-copy">This doesn't work for me. I used the regex and below is my code: <code>filename = "45.json" with open(filename) as file:     string = file.read()     email_subjects = re.findall('([\'\"]*[S|s]ubject[:\s]*?(?:[\'|\"]*[\S\s]*?(?=[\'|\"])*))(?=\n|$)', string)     print(email_subjects[0])</code> and this prints out the entire json as one dict with the subject line 'Subject: Warmest Wishes! You have a Happy Thanksgiving ' at the beginning of the dictionary.</span>
<span class="comment-copy">Hmmm... That shouldn't be possible given the format of the file you posted. I edited in 2 other examples using what you provided as a string. let me know what your output is for those.</span>
<span class="comment-copy">Yes your example works perfectly, I just tested it out. However it looks like when I use it with the complete json file ( posted below) it just outputs the whole file as a string :(</span>
<span class="comment-copy">I cannot post the json file here due to character limitation</span>
<span class="comment-copy">Hmmm... it might be because the original JSON File has no line breaks. If that's the case I'll make another edit. One second</span>
