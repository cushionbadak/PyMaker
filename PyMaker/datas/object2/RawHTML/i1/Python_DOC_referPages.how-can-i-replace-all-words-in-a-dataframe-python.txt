<div class="post-text" itemprop="text">
<p>I'm trying to convert an AGL bill into dataframe so that I can put the needed values into an excel spreadsheet.</p>
<p>I'm stuck trying to <code>.replace()</code> characters in the rows with nothing so that just numbers are left (Trying to remove all words in the dataframe). The other issue is that in each cell there are multiple words and numbers. </p>
<p><a href="https://i.stack.imgur.com/j65uh.png" rel="nofollow noreferrer">Here is the current database:</a></p>
<pre><code>from tabula import read_pdf
import openpyxl
from openpyxl import load_workbook
import pandas as pd
import numpy as np

df1 = tabula.read_pdf('C:/Users/Blake/Desktop/Python/AGL_Bill.pdf',guess=False, pages=2)
df1.columns = ['Description', 'Blank', 'Values']




df1.drop(labels=None, axis=None, index=[0,1,3,4,7,8,25,26,19,15,16,20,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62], columns=None, level=None, inplace=True, errors='raise')
df1.drop(labels=None, axis=1, columns=['Values'], level=None, inplace=True, errors='raise')





df1['Description'].str.replace('kWh', '')



print (df1)

df1.to_csv('Tableone.csv', encoding='utf-8')


wb2 = load_workbook('C:/Users/Blake/Desktop/ETemplate.xlsx')


wb2.create_sheet('DATA')
wb2.save('C:/Users/Blake/Desktop/Template.xlsx')`
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you are trying to replace the characters with nothing - then RegEx using numbers, each cell - joining them together. </p>
<p>import re</p>
<pre><code>import pandas as pd

data={'1':'Some dumb data $200.22 for me','2':'Some more really dumb data $5.23'}
df=pd.DataFrame.from_dict(data,orient='index')
df.columns=['Data']

def Num_Only(val):
    return ' '.join(re.findall('[\d\.]+',val))

df['New']=''
df.New=df.Data.apply(lambda x: Num_Only(x))
Which should output a new Dataframe ... like this
</code></pre>
<p>The output is now...  I have remove the $ as it serves no purpose.</p>
<pre><code>1.   Some dumb data $200.22 for me  200.22
2   Some more really dumb data $5.23    5.23
</code></pre>
<p>Hope that gets you going</p>
</div>
<span class="comment-copy">I just tried this and I'm getting: AttributeError: 'DataFrame' object has no attribute 'Data'</span>
<span class="comment-copy">"Data" is the name of the column in my test DataFrame.  Your columns are 'Description' and 'Blank' .... To set them do something like      df.columns=['ColName1','ColName2']</span>
<span class="comment-copy">That worked thanks but now it says:  TypeError: expected string or bytes-like object</span>
<span class="comment-copy">The Num_Only function needs some error handling and checking in it. So it can handle cells with no (or maybe repeating groups)..... As I was rushing I did not add this.... Homework for you I am afraid :)</span>
<span class="comment-copy">Thanks Tim!! I got that working, just had to change the columns to a str before passing to Num_only.</span>
