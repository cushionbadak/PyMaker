<div class="post-text" itemprop="text">
<p>I'm trying to call a post rest API using python requests library. I'm able to get a proper response when I request using postman. When I tried to call it using python request library I get an internal server error.</p>
<pre><code>import requests

url = "http://192.188.9.146:9886/getcontext/"

payload = "------WebKitFormBoundary7MA4YWxkTrZu0gW\r\nContent-Disposition: form-data; name=\"project\"\r\n\r\ndaynight\r\n------WebKitFormBoundary7MA4YWxkTrZu0gW\r\nContent-Disposition: form-data; name=\"file\"; filename=\"D:\\Downloads\\GTA.Imaging.Services\\GTA.Imaging.Services.Wrapper.TestApp\\PatternMatchingdata\\Go_To_Setting_Screen.jpg\"\r\nContent-Type: image/jpeg\r\n\r\n\r\n------WebKitFormBoundary7MA4YWxkTrZu0gW--"
headers = {
    'content-type': "multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW",
    'cache-control': "no-cache",
    'Postman-Token': "79668e4b-305b-404e-904f-92fc71a12f9f"
    }

response = requests.request("POST", url, data=payload, headers=headers)

print(response.text)
</code></pre>
<p>this gives me error as below </p>
<pre><code>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN"&gt;
&lt;title&gt;500 Internal Server Error&lt;/title&gt;
&lt;h1&gt;Internal Server Error&lt;/h1&gt;
&lt;p&gt;The server encountered an internal error and was unable to complete your request.  Either the server is overloaded or there is an error in the application.&lt;/p&gt;
</code></pre>
<p>When I use the postman client app I get output with the expected response 
<a href="https://i.stack.imgur.com/LIdUu.png" rel="nofollow noreferrer">Postman client</a>
what am I doing wrong?
Any guidance will be very helpful thanks.</p>
</div>
<div class="post-text" itemprop="text">
<p>Remove the <code>payload</code> parameter and add <code>files</code>. Refer to <a href="http://docs.python-requests.org/en/master/user/quickstart/#post-a-multipart-encoded-file" rel="nofollow noreferrer">requests documentation</a> which explains this option of requests.request function.</p>
<pre><code>import requests

url = "http://192.188.9.146:9886/getcontext/"

files = {'file': open('PATH_TO_FILE\Go_To_Setting_Screen.jpg','rb')}
data  = {'project': 'daynight'}

response = requests.request("POST", url, files = files, data = data)

print(response.text)
</code></pre>
</div>
<span class="comment-copy">Use wireshark to grab the outbound TCP data from both postman &amp; python, and compare. Also, do you <i>need</i> to put the "project" and "file" attributes into different form sections? Could they maybe appear together?</span>
<span class="comment-copy">Hi, can you share some example done with Wireshark? Yes, I need to put both attributes together. Something like this</span>
<span class="comment-copy">Multipart requests are a built-in feature of the <code>requests</code> module. Don't roll your own. Read how to use it: <a href="http://docs.python-requests.org/en/master/user/quickstart/#post-a-multipart-encoded-file" rel="nofollow noreferrer">docs.python-requests.org/en/master/user/quickstart/â€¦</a></span>
<span class="comment-copy">If <a href="http://192.188.9.146:9886/getcontext/" rel="nofollow noreferrer">192.188.9.146:9886/getcontext</a> is an internal app - check the server logs.</span>
<span class="comment-copy">yes it is running in local server , made up of flask</span>
