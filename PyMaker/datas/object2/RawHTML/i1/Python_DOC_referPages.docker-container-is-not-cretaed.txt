<div class="post-text" itemprop="text">
<p>I work with a Python tool that uses the docker for project management. I run the setup process with command, </p>
<pre><code>$ bin/butler.py setup
</code></pre>
<p>The went through seamlessly but when I try to install new Php plugins using the <code>composure</code>, the tool doesn't find the container itself. </p>
<p>So, my conclusion is the tool is not creating the container properly in the first place. </p>
<p>I describe the process below for the setup. After the initial configuration, this is where it starts, </p>
<pre><code>    # all done

    print("pull doker images images")
    self.docker.compose_pull(self.local_yml)
    print("create containers")

    self.docker.compose_setup(self.local_yml)
    print("setup completed")
</code></pre>
<p>This is the general command for the docker execution. I know it has a security bug, but, at this moment this is not the concern. </p>
<pre><code>def compose(self, params, yaml_path="docker-compose.yml"):
    """ execte docker-compose commmand """
    cmd = f"docker-compose -f {yaml_path} {params}"
    print(cmd)
    try:
        subprocess.run(cmd, shell=True, check=True)
    except Exception:
        pass

   def compose_pull(self, yaml_path):
       self.compose("pull --ignore-pull-failures", yaml_path)

   def compose_setup(self, yaml_path):
       self.compose(f"--project-name {self.project_name} up --no-start ", yaml_path)
</code></pre>
<p>The printout provides with the commands, </p>
<pre><code>pull doker images images

# We use a docker-compose.yml and perform the pull operation
docker-compose -f /Users/chaklader/PycharmProjects/Welance-Craft-Starter/build/docker-compose.yml pull --ignore-pull-failures
Pulling database ... 
Pulling craft    ... 
create containers

# We use a docker-compose.yml and perform the up operation for the project

docker-compose -f /Users/chaklader/PycharmProjects/Welance-Craft-Starter/build/docker-compose.yml --project-name p13-27 up --no-start 
Creating network "p13-27_default" with the default driver
Creating p13-27_database ... 
Creating p13-27_craft    ... 
setup completed
</code></pre>
<p>The <code>docker-compose.yml</code> file is provided, </p>
<pre><code>services:
  craft:
    container_name: p13-27_craft
    environment:
      CRAFT_ALLOW_UPDATES: 'false'
      CRAFT_DEVMODE: 1
      CRAFT_EMAIL: admin@welance.de
      CRAFT_ENABLE_CACHE: 0
      CRAFT_LOCALE: en_us
      CRAFT_PASSWORD: welance
      CRAFT_SITENAME: Welance
      CRAFT_SITEURL: //localhost
      CRAFT_USERNAME: admin
      DB_DATABASE: craft
      DB_DRIVER: mysql
      DB_PASSWORD: craft
      DB_PORT: '3306'
      DB_SCHEMA: public
      DB_SERVER: database
      DB_TABLE_PREFIX: craft_
      DB_USER: craft
      ENVIRONMENT: dev
      HTTPD_OPTIONS: ''
      LANG: C.UTF-8
      SECURITY_KEY: some_key_:)
    image: welance/craft:3.1.17.2
    links:
    - database
    ports:
    - 80:80
    volumes:
    - /var/log
    - ./docker/craft/conf/apache2/craft.conf:/etc/apache2/conf.d/craft.conf
    - ./docker/craft/conf/php/php.ini:/etc/php7/php.ini
    - ./docker/craft/logs/apache2:/var/log/apache2
    - ./docker/craft/adminer:/data/adminer
    - ../config:/data/craft/config
    - ../templates:/data/craft/templates
    - ../web:/data/craft/web
  database:
    command: mysqld --character-set-server=utf8  --collation-server=utf8_unicode_ci
      --init-connect='SET NAMES UTF8;'
    container_name: p13-27_database
    environment:
      MYSQL_DATABASE: xyz
      MYSQL_PASSWORD: xyz
      MYSQL_ROOT_PASSWORD: xyz
      MYSQL_USER: xyz
    image: mysql:5.7
    volumes:
    - /var/lib/mysql
version: '3.1'
</code></pre>
<p>In the summary, my base image is <code>welance/craft:3.1.17.2</code> and I use that to create the container named <code>p13-27_craft</code>. The additional configuration is provided in the <code>docker-compose.yml</code> file and I run the <code>pull</code> and <code>up</code> command with the docker. </p>
<p>I think the container is itself not created. For example, I provided the data for customer ID 15 and project ID 55 and the printout says informs <code>Creating p15-55_craft    ... done</code>. </p>
<p>When I run the command to see if the container is created from the terminal, I find, </p>
<pre><code>$ docker ps 
CONTAINER ID        IMAGE                    COMMAND                  CREATED             STATUS              PORTS                 NAMES
cf2ea4638772        welance/craft:3.1.17.1   "/data/scripts/run-c…"   37 minutes ago      Up 37 minutes       0.0.0.0:80-&gt;80/tcp    p13-17_craft
4504ae62035f        mysql:5.7                "docker-entrypoint.s…"   About an hour ago   Up About an hour    3306/tcp, 33060/tcp   p13-17_database
518e3535859b        mysql:5.7 
</code></pre>
<p>So the information from the print is not correct and container is not created in the first place. </p>
<p>How do I investigate what is the issue here and why the container is not creating?</p>
<p>Thank you. </p>
</div>
<div class="post-text" itemprop="text">
<p>Get rid of the <code>--no-start</code> option, and add the <code>-d</code> flag to run as daemon (background process). If I run my own solution:</p>
<pre class="lang-sh prettyprint-override"><code>docker-compose up --no-start
Creating alerts-cache ... done
Creating mongoClientTemp ... done
Creating apilayer_alerts-api_1 ... done

$ docker ps
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</code></pre>
<p>Nothing is found, even though my containers are created.</p>
<pre class="lang-sh prettyprint-override"><code>docker-compose up -d
Starting alerts-cache ... done
Starting mongoClientTemp ... done
Starting apilayer_alerts-api_1 ... done

docker ps
CONTAINER ID        IMAGE                          COMMAND                  CREATED             STATUS              PORTS                      NAMES
af557a2add73        bdsdev.azurecr.io/rva_flask    "python app.py alert…"   2 minutes ago       Up 1 second         0.0.0.0:5000-&gt;5000/tcp     apilayer_alerts-api_1
829da0fabe62        bdsdev.azurecr.io/temp_mongo   "docker-entrypoint.s…"   2 minutes ago       Up 2 seconds        27017/tcp                  mongoClientTemp
cdb67a305233        mongo
</code></pre>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p>How do I investigate what is the issue here and why the container is
  not creating?</p>
</blockquote>
<p>Your configuration seems correct and <code>docker-compose</code> does not report any error, its probably that your container <strong>was created</strong> but either <strong>was not started or exited right after being started</strong>. You are using <code>docker ps</code> which only shows running container, you will probably see your missing container by running <code>docker ps -a</code>. </p>
<p><code>docker-compose</code> won't report any error if container is created (and started) successfuly but exited right after starting. If you can see your container with <code>docker ps -a</code>, try running <code>docker logs &lt;container name&gt;</code> to see why your container exited. The step to solve the issues afterward will depend on how your container works. </p>
</div>
<span class="comment-copy"><i>"The went through seamlessly but when I try to install new Php plugins using the composure, the tool doesn't find the container itself."</i> How are you installing the php plugins and what error is it raising?</span>
<span class="comment-copy">The tool doesn't find the container and bug come from there. Would you please re-read the question? I updated it from the output of the <code>$ docker ps</code></span>
<span class="comment-copy">try <code>docker ps -a</code>, could be exited</span>
<span class="comment-copy">Also, per <a href="https://docs.docker.com/compose/reference/up/" rel="nofollow noreferrer">docs</a>, <code>--no-start:  Don't start the services after creating them.</code></span>
<span class="comment-copy">@C.Nivs you are correct. The command <code>docker ps -a</code> informs that the containers are created but also exiting afterward. Do you know why does it happen?</span>
<span class="comment-copy">Your answer helps me. Thank you.</span>
