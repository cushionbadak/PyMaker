<div class="post-text" itemprop="text">
<p>I'm working on a project where I want to establish communication between a VB.NET application (client) on windows and a python application (server) on raspberry pi, which I have managed to do. </p>
<p>Whenever I send a message, the Client App sends it across to the Server App (as a string), where it's converted to UTF-8. The text is converted correctly, however, there is one extra character at the end of each message and one extra line is added.</p>
<p><a href="https://i.stack.imgur.com/tzXvT.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/tzXvT.png"/></a></p>
<p>My Python Code</p>
<pre><code>import socket
import threading
import datetime


class Server:
    sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    connections = []

    def __init__(self):
        self.sock.bind(('0.0.0.0', 8521))
        self.sock.listen(1)

    def handler(self, c, a):
        while True:
            currentDT = datetime.datetime.now()
            data = c.recv(1024)
            for connection in self.connections:
                connection.send(data)
                dat = data.decode()
                print(currentDT.strftime("%I:%M:%S %p") + str(data, 'utf-8', 'ignore'))

                if data=='ShutDown':
                    break
            if not data:
                print(str(a[0]) + ':' + str(a[1]), "Disconnected")
                self.connections.remove(c)
                c.close()
                break


    def run(self):
        while True:
            c, a = self.sock.accept()
            cThread = threading.Thread(target=self.handler, args=(c, a))
            cThread.daemon=True
            cThread.start()
            self.connections.append(c)
            print(str(a[0]) + ':' + str(a[1]), "connected")
        c.close()


server = Server()
server.run()
</code></pre>
<p>The PART of VB.NET code which is responsible for sending the message</p>
<pre class="lang-vb prettyprint-override"><code>Dim client As TcpClient
Dim sWriter As StreamWriter
'.....
 Private Sub send(ByVal str As String)
    Try
        sWriter = New StreamWriter(client.GetStream)

        sWriter.WriteLine(str)

        sWriter.Flush()
    Catch ex As Exception
        xUpdate("You're not server")
    End Try
End Sub
</code></pre>
<p>Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>Actually, thinking on this further, the extra character you're seeing is probably the carriage return and the extra line is probably because of the line feed at the end. For example, if you pass "Hello World" to <code>WiteLine</code>, the Python code is probably interpreting that as two lines, with the first ending with a carriage return and the second being an empty string. What you probably need to do is call <code>Write</code> instead of <code>WriteLine</code> and if you're writing a single <code>String</code> containing line breaks, replace all CR-LF pairs with just LF:</p>
<pre class="lang-vb prettyprint-override"><code>Private Sub send(ByVal str As String)
    Try
        sWriter = New StreamWriter(client.GetStream)

        sWriter.Write(str.Replace(ControlChars.CrLf, ControlChars.Lf))

        sWriter.Flush()
    Catch ex As Exception
        xUpdate("You're not server")
    End Try
End Sub
</code></pre>
<p>You may also need to write a single LF before all but the first message if you're sending multiple.</p>
</div>
<span class="comment-copy"><code>WriteLine</code> will write the text followed by a carriage return and a line feed. Is the Python code possibly reading that as two separate line breaks rather than one?</span>
<span class="comment-copy">@jmcilhinney you hit the nail on the head! I changed WriteLine to Write on the VB code and it works perfectly now! THANK YOU!</span>
