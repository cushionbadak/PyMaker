<div class="post-text" itemprop="text">
<p>I'm trying to create groups and mailing lists using the Directory API but it seems that there is something wrong. I'm using the code from <a href="https://developers.google.com/admin-sdk/directory/v1/quickstart/python" rel="nofollow noreferrer">Python Quickstart</a> and it works fine. But when I'm trying to change the scope to :<code>https://www.googleapis.com/auth/admin.directory.group.member</code> in order to create or access groups, I'm getting the following error:</p>
<blockquote>
<p>https://www.googleapis.com/admin/directory/v1/users?customer=my_customer&amp;orderBy=email&amp;alt=json&amp;maxResults=10 returned "Insufficient Permission: Request had insufficient authentication scopes."&gt;</p>
</blockquote>
<p>Do you know how I can fix that?</p>
</div>
<div class="post-text" itemprop="text">
<p>To get the list of users, as in the line </p>
<pre><code>results = service.users().list(customer='my_customer',maxResults=10,orderBy='email').execute()
</code></pre>
<p>you need the <code>admin.directory.user</code> scope. 
If you want to list the users, you need to include the correct scope in the <code>SCOPES</code> list. If you don't, removing this line should fix this error. The rest of the example does rely on this line though.</p>
</div>
<span class="comment-copy">The different scope has been used in the example that you linked ('<a href="https://www.googleapis.com/auth/admin.directory.user'" rel="nofollow noreferrer">googleapis.com/auth/admin.directory.user'</a>). Maybe this is the issue?</span>
<span class="comment-copy">Actually I can get the list of users. The example I linked works fine. The problem is that I need to modify this example in order to create groups. For this reason I tried to change the scope to : <code>https://www.googleapis.com/auth/admin.directory.group.member</code></span>
<span class="comment-copy">@at91 You can only get the list of users if you have the<code>admin.directory.user</code> scope. As soon as you remove this from the list of scopes, the request no longer has access to the list of users (even if the account making the request does) and so you get this error when trying to get the list of users.</span>
<span class="comment-copy">@Davis These are the modifications to the code I'm using. I changed the scope because I'm trying to have access to the groups not the users and it raises an errror. <code>SCOPES = ['https://www.googleapis.com/auth/admin.directory.group.member']</code>   `  service = build('admin', 'directory_v1', credentials=creds)`    ` res= service.groups().list().execute()`</span>
<span class="comment-copy"><code>&lt;HttpError 403 when requesting https://www.googleapis.com/admin/directory/v1/groups?alt=json returned "Insufficient Permission: Request had insufficient authentication scopes."&gt;</code> and this is the error I'm getting</span>
<span class="comment-copy">@at91 It looks like you are trying to access the list of groups on your domain. To view this you need the <code>https://www.googleapis.com/auth/admin.directory.group.readonly</code> scope or the <code>https://www.googleapis.com/auth/admin.directory.group</code> scope if you want to edit the groups (not group members). For full information on which scopes do what, you can refer to the developer guide provided by google at <a href="https://developers.google.com/identity/protocols/googlescopes#admindirectory_v1" rel="nofollow noreferrer">developers.google.com/identity/protocols/â€¦</a>. Bear in mind that you will likely need different scopes for different requests.</span>
