<div class="post-text" itemprop="text">
<p>Do you know how to solve this in python? I would like to have a dataframe with data arranged in the correct column. </p>
<p>Thanks in advance!</p>
<p>Here is an example of a string from a dataframe. </p>
<p>' Huidigefuncties Michael Jordan 2015 - present Director Marketing &amp; Indirect Channels, Ricoh Nederland 2010 - present Basketball Center, Center for Business-Expertise Loopbaan Michael Jordan 2012 - 2015 Director Marketing &amp; Business Development, Ricoh Opleiding Michael Jordan 1988 - 1992 Marketing , Harvard '</p>
<p>Preferred result</p>
<pre><code>type          from     to        function                                   organization           
current       2015     present    Director Marketing &amp; Indirect Channels    Ricoh Nederland 
current       2010     present    Owner &amp; Consultant                        Basketball Center
old           2012     2015       Director Marketing &amp; Business Development Ricoh
school        1988     1992       Marketing                                 Harvard                           
</code></pre>
<p>Current df</p>
<pre><code>Name             Data
Michael Jordan   ' Huidigefuncties Michael Jordan 2015 - present Director Marketing &amp; Indirect Channels, Ricoh Nederland 2010 - present Basketball Center, Center for Business-Expertise Loopbaan Michael Jordan 2012 - 2015 Director Marketing &amp; Business Development, Ricoh Opleiding Michael Jordan 1988 - 1992 Marketing , Harvard '
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Well, this is a solution that I did for this problem</p>
<pre><code>import pandas as pd
beautiful_data = 'Huidigefuncties Michael Jordan 2015 - present Director Marketing &amp; Indirect Channels, Ricoh Nederland 2010 - present Basketball Center, Center for Business-Expertise Loopbaan Michael Jordan 2012 - 2015 Director Marketing &amp; Business Development, Ricoh Opleiding Michael Jordan 1988 - 1992 Marketing , Harvard'
main_dict = {'type':[], 'from':[], 'to':[], 'function':[], 'organization': []}
data = beautiful_data.split(' ')
i = 0
huidi_index = data.index('Huidigefuncties')
loopbaan_index = data.index('Loopbaan')
ople_index = data.index('Opleiding')
# print(data)
while i &lt; len(data):
    if data[i] == 'Huidigefuncties':
        line = ' '.join(data[i + 1: loopbaan_index])
        i = loopbaan_index
        print(line)
        type_data = 'current'
    elif data[i] == 'Loopbaan':
        line = ' '.join(data[i + 1: ople_index])
        i = ople_index
        print(line)
        type_data = 'old'
    elif data[i] == 'Opleiding':
        line = ' '.join(data[i+1: ])
        i = len(data)
        print(line)
        type_data = 'school'
    else:
        i += 1
    data_line = line.split('-')
    if len(data_line) == 2:
        print(type_data)
        main_dict['type'].append(type_data)
        from_data = data_line[0].strip().split(' ')[-1]
        print(from_data)
        main_dict['from'].append(from_data)
        to_data = data_line[1].strip().split(' ')[0]
        print(to_data)
        main_dict['to'].append(to_data)
        function_data = ' '.join(data_line[1].strip().split(' ')[1:-1])[:-1]
        print(function_data)
        main_dict['function'].append(function_data)
        organization_data = data_line[1].split(',')[-1].strip()
        print(organization_data)
        main_dict['organization'].append(organization_data)

    elif len(data_line) &gt; 2:
        j = 0
        while j &lt; len(data_line):
            register_data = data_line[j:j+2]
            if len(register_data) &gt; 1:
                if len(register_data[0].split(' ')) &gt; 1 and len(register_data[1].split(' ')) &gt; 1: 
                    if j == 0:
                        print(register_data)
                        print('----------')
                        print(type_data)
                        main_dict['type'].append(type_data)
                        from_data = register_data[0].strip().split(' ')[-1]
                        print(from_data)
                        main_dict['from'].append(from_data)
                        to_data = register_data[1].strip().split(' ')[0]
                        print(to_data)
                        main_dict['to'].append(to_data)
                        function_org = register_data[1].strip().split(',')
                        function_data = ' '.join(function_org[0].split(' ')[1:])
                        print(function_data)
                        main_dict['function'].append(function_data)
                        org_data = ' '.join(function_org[1].split(' ')[:-1]).strip()
                        print(org_data)
                        main_dict['organization'].append(org_data)
                        print('-----------')
                    else:
                        print('-----------')
                        print(register_data)
                        print(type_data)
                        main_dict['type'].append(type_data)
                        from_data = register_data[0].strip().split(' ')[-1]
                        print(from_data)
                        main_dict['from'].append(from_data)
                        to_data = register_data[1].strip().split(' ')[0]
                        print(to_data)
                        main_dict['to'].append(to_data)
                        function_org = register_data[1].strip().split(',')
                        function_data = ' '.join(function_org[0].split(' ')[1:])
                        print(function_data)
                        main_dict['function'].append(function_data)
                        org_data = ' '.join(function_org[1].split(' ')).strip()
                        print(org_data)
                        main_dict['organization'].append(org_data)
                        print('-----------')
            j += 1

df = pd.DataFrame(main_dict)
</code></pre>
<p>Tested</p>
<p><a href="https://i.stack.imgur.com/ZyvWT.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/ZyvWT.png"/></a> </p>
</div>
<span class="comment-copy">Where are you getting the column <code>type</code> ?</span>
<span class="comment-copy">Huidigefunctie = current Loopbaan = old Opleiding = school</span>
<span class="comment-copy">Are you reading for a csv with header? are you file multiline ?</span>
<span class="comment-copy">No it's not a csv. it from beautifulsoup.</span>
<span class="comment-copy">Are you sharing the right data ? the <code>owner &amp; consultant</code> function is not in the string</span>
<span class="comment-copy">Amazing! Thanks!!</span>
