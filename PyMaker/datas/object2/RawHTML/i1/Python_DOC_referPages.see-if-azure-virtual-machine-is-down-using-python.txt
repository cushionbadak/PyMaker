<div class="post-text" itemprop="text">
<p>I am trying to write a python program that will alert me when a VM is down. I know PowerShell might be better but would prefer python.  </p>
</div>
<div class="post-text" itemprop="text">
<p>Why do you think it would be better with PowerShell :). Python rules ;)</p>
<p>If you want a more reactive programming, you should look at EventGrid + LogicApp + WebApp/Function first. It's like IFTTT for Azure, EventGrid will trigger an event, and LogicApp will be able to consume this event and send it to a WebApp or Function (that you can write in Python).
Example:
<a href="https://docs.microsoft.com/en-us/azure/event-grid/monitor-virtual-machine-changes-event-grid-logic-app" rel="nofollow noreferrer">https://docs.microsoft.com/en-us/azure/event-grid/monitor-virtual-machine-changes-event-grid-logic-app</a></p>
<p>If you want a more "I pull every minute" experience, just use the azure-mgmt-compute package:
<a href="https://pypi.org/project/azure-mgmt-compute/" rel="nofollow noreferrer">https://pypi.org/project/azure-mgmt-compute/</a></p>
<p>Basic sample:
<a href="https://github.com/Azure-Samples/virtual-machines-python-manage" rel="nofollow noreferrer">https://github.com/Azure-Samples/virtual-machines-python-manage</a></p>
<p>You will need the instance view of the VM, to get the power state, with <a href="https://docs.microsoft.com/en-us/python/api/azure-mgmt-compute/azure.mgmt.compute.v2018_10_01.operations.virtualmachinesoperations?view=azure-python#instance-view-resource-group-name--vm-name--custom-headers-none--raw-false----operation-config-" rel="nofollow noreferrer">instance_view</a></p>
<p>Hope this helps!</p>
<p>(I work at MS in the Azure SDK for Python team)</p>
<p><strong>EDIT:</strong></p>
<p>It seems EventGrid does not support trigger from VM power state yet, you could still use LogicApp with a poll schedule for solution 1: <a href="https://docs.microsoft.com/en-us/azure/connectors/connectors-native-recurrence" rel="nofollow noreferrer">https://docs.microsoft.com/en-us/azure/connectors/connectors-native-recurrence</a></p>
</div>
