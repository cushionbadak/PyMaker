<div class="post-text" itemprop="text">
<pre><code>import pandas as pd
from io import StringIO

mystr = StringIO("""beat,crimedescr
A,10851(A)VC TAKE VEH W/O OWNER
B,459 PC  BURGLARY RESIDENCE
C,10851(A)VC TAKE VEH W/O OWNER
A,476 PC PASS FICTICIOUS CHECK
B,459 PC  BURGLARY-UNSPECIFIED
C,530.5 PC USE PERSONAL ID INFO""")

df = pd.read_csv(mystr, header=0)

for i in df.beat.unique():
    df.loc[df.beat==i].to_csv(f'{i}.csv', index=False)
</code></pre>
<p>I'd like to export 4 csv files from this dataframe including:
A file with the entire dataframe and 3 separate files (A,B,C). 
I know it's possible to simply df.to_csv and add another for loop. 
How to do it in strictly one for loop since most of time the condition is very complicated in df.loc[()&amp;()..] which separated export made codes very hard to read?</p>
</div>
<div class="post-text" itemprop="text">
<p>try this,</p>
<pre><code>for u, v in df.groupby('beat'):
    v.to_csv(u+'.csv',index=False)
df.to_csv('all.csv',index=False)
</code></pre>
<p>Edit-1: For single loop</p>
<pre><code>flag=True
for u, v in df.groupby('beat'):
    if flag:
        df.to_csv('all.csv',index=False)
        flag=False
    v.to_csv(u+'.csv',index=False)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>alist = df.beat.unique().reshape(1,-1).tolist()
blist = df.beat.unique().reshape(len(df.beat.unique()), -1).tolist()
alist.extend(blist)

for i in alist:
    df[df.beat.isin(i)].to_csv(f'{i}.csv', index=False)
</code></pre>
<p>My own solution is to make a list to satisfy the for loop. The 'alist' will be [['A', 'B', 'C'], ['A'], ['B'], ['C']]
But maybe the way to create the list can be simpler.</p>
</div>
<span class="comment-copy">Is there any way to export 4 files in "one for loop"? Thank you for the quick answer!</span>
<span class="comment-copy">Yeah it's still in single loop :)</span>
<span class="comment-copy">@AngusLuo - take  a look to updated solution</span>
<span class="comment-copy">FYI, using <code>isin</code> will affect your efficiency moreover you're adding more complex for the simple solution :(</span>
<span class="comment-copy">Thank your for reminding this. I admit this do add more complexity.</span>
