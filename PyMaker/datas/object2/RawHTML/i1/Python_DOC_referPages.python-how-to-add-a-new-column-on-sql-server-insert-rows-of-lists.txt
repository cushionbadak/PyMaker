<div class="post-text" itemprop="text">
<p>I want to insert values to SQL Server from python. Here's my code:</p>
<pre><code>for value in rows:
    cursor.execute ("""INSERT INTO Table ([ColumnOne]) VALUES (?)""", value)
cnxn.commit()
</code></pre>
<p>In <code>rows</code> , it contains lists (iteration) of rows, something like this:
row 1 contains of lists of float numbers </p>
<blockquote>
<p>1.0
  2.0
  1.5
  1.75</p>
</blockquote>
<p>..... (in total of 1000 values in a row/column), 
And it goes the same with row2, row3, and so on. 
But, when I tried to run the code, I have this error</p>
<blockquote>
<p>pyodbc.ProgrammingError: ('The SQL contains 1 parameter markers, but
  1000 parameters were supplied', 'HY000')</p>
</blockquote>
<p>Is there any way that I could do so the float values are not treated individually or to fix this problem?
I think maybe I should use <code>','.join</code> statement to make it as string? 
Considering I am not good at explaining and new to python, please correct me if i have some mistakes. Thank you.</p>
</div>
<div class="post-text" itemprop="text">
<p>When you attempt to insert multiple table rows in one query, you need to supply a list of values for each row.</p>
<p>For example, the following query would insert two rows:</p>
<pre class="lang-sql prettyprint-override"><code>INSERT INTO Table (ColumnOne) VALUES (1.0), (2.0);
</code></pre>
<p>So your python code needs to prepare the correct <code>VALUES</code> part of the query:</p>
<pre class="lang-py prettyprint-override"><code>for row in rows:
    values = ", ".join(("(?)",) * len(row))
    cursor.execute(f"INSERT INTO Table (ColumnOne) VALUES {values}", row)
</code></pre>
</div>
<span class="comment-copy">Thank you, got it!</span>
