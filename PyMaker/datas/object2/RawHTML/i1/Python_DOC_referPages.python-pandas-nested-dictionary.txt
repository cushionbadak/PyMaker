<div class="post-text" itemprop="text">
<p>I have a list of dictionaries that I wish to manipulate using Pandas. Say:</p>
<pre><code>m = [{"topic": "A", "type": "InvalidA", "count": 1}, {"topic": "A", "type": "InvalidB", "count": 1}, {"topic": "A", "type": "InvalidA", "count": 1}, {"topic": "B", "type": "InvalidA", "count": 1}, {"topic": "B", "type": "InvalidA", "count": 1}, {"topic": "B", "type": "InvalidB", "count": 1}]
</code></pre>
<p>1) first create a dataframe using the constructor:</p>
<pre><code>df = pd.DataFrame(m)
</code></pre>
<p>2) Group by columns ['topic] and ['type'] and count</p>
<pre><code>df_group = df.groupby(['topic', 'type']).count()
</code></pre>
<p>I end up with:</p>
<pre><code>                    count
topic   type    
 A      InvalidA    2
        InvalidB    1
 B      InvalidA    2
        InvalidB    1
</code></pre>
<p>I want to now convert this to a nested dict:</p>
<pre><code>{ "A" : {"InvalidA" : 2,
         "InvalidB" : 1},
  "B" : {"InvalidA" : 2,
         "InvalidB":  1}
}
</code></pre>
<p>Any suggestions on how to get from <code>df_group</code> to a nested dict? </p>
</div>
<div class="post-text" itemprop="text">
<p>Using <code>unstack</code> + <code>to_dict</code></p>
<pre><code>df_group['count'].unstack(0).to_dict()
Out[446]: {'A': {'InvalidA': 2, 'InvalidB': 1}, 'B': {'InvalidA': 2, 'InvalidB': 1}}
</code></pre>
<p>And also slightly change you <code>groupby</code> to <code>crosstab</code></p>
<pre><code>pd.crosstab(df.type,df.topic).to_dict()
Out[449]: {'A': {'InvalidA': 2, 'InvalidB': 1}, 'B': {'InvalidA': 2, 'InvalidB': 1}}
</code></pre>
</div>
