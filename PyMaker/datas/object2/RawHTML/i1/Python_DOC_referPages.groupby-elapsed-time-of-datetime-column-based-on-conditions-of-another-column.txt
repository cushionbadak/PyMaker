<div class="post-text" itemprop="text">
<p>I have the following dataset</p>
<pre><code>lst=[
 ['a','2019-03-02 23:20:28',0],
 ['a','2019-03-02 23:21:29',0],
 ['a','2019-03-02 23:22:30',1],
 ['a','2019-03-02 23:30:31',0.5],
 ['a','2019-03-02 23:38:32',0.5],
 ['a','2019-03-02 23:50:32',0.5],  
 ['a','2019-03-02 23:50:32',0], 
 ['b','2019-03-02 23:10:32',0],  
 ['b','2019-03-02 23:12:32',0],  
 ['b','2019-03-02 23:20:32',1],  
 ['b','2019-03-02 23:30:32',0.5],  
 ['b','2019-03-02 23:50:32',1],  
 ['b','2019-03-02 23:55:32',1],  
 ['b','2019-03-02 23:56:32',0],
 ['a','2019-03-02 22:20:28',0],
 ['a','2019-03-02 22:21:29',0],
 ['a','2019-03-02 22:22:30',1],
 ['a','2019-03-02 22:30:31',0.5],  
 ['a','2019-03-02 22:30:32',0], 
  ]

df = pd.DataFrame(lst,columns=['ID','ts','signal'])
df['ts']=pd.to_datetime(df['ts'])
</code></pre>
<p>I would like to get all those rows per ID that the total elapsed time between 0s in signal column is greater than 15 minutes.</p>
<p>i.e. for a only:</p>
<p><a href="https://i.stack.imgur.com/BETXv.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/BETXv.png"/></a></p>
<p>and for b only:</p>
<p><a href="https://i.stack.imgur.com/n6tjZ.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/n6tjZ.png"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>Use:</p>
<pre><code>#filter out rows with 0
df1 = df[df['signal'].ne(0)]
#create Series from original column for unique consecutive groups for non 0 rows
a = df['signal'].eq(0).cumsum()

thr = pd.Timedelta(15, unit='min')

#get difference between first and last value per group and filtering by thresh
df2 = df1[df1['ts'].groupby(a).transform(lambda x: x.iat[-1] - x.iat[0]) &gt; thr]
print (df2)
   ID                  ts  signal
2   a 2019-03-02 23:22:30     1.0
3   a 2019-03-02 23:30:31     0.5
4   a 2019-03-02 23:38:32     0.5
5   a 2019-03-02 23:50:32     0.5
9   b 2019-03-02 23:20:32     1.0
10  b 2019-03-02 23:30:32     0.5
11  b 2019-03-02 23:50:32     1.0
12  b 2019-03-02 23:55:32     1.0
</code></pre>
</div>
<span class="comment-copy">apologies but that was typo. it should be clear now</span>
<span class="comment-copy">Great, only the <code>pd.Timedelta(15, unit='min')</code> only works with <code>pd.Timedelta(15)</code> for me.</span>
