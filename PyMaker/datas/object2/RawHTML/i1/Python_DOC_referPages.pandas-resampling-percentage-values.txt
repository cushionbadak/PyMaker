<div class="post-text" itemprop="text">
<p>I have a pandas dataframe of monthly observations with datetime index. I would like to convert to yearly observations. The problem is that the values in my dataframe are performance values (for example: monthly pct. change of stock price). How can i resample to yearly values while aggregating correctly?</p>
<p>example of what i would need to to: </p>
<pre><code>     m1  0.1     to      q1 0.331
     m2  0.1             q2 0.089
     m3  0.1
     m4 -0.1
     m5  0.1
     m6  0.1
</code></pre>
<p>monthly to quarterly resampling, 1.1^3-1 = 0.331 , 0.9*(1.1^2)-1 = 0.089</p>
</div>
<div class="post-text" itemprop="text">
<p>Given that your data resides in a dataframe named <code>df</code> with the column <code>val</code> holding the integer:</p>
<pre><code>(df.val + 1).groupby(df.index // 3).prod() - 1
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Using the answer of feliks, if you donÂ´t want to change your index, you can apply a regex before grouping:</p>
<pre><code>regex_pattern = lambda s: (int(re.search(r'\d+', s).group())-1)//3
d1 = (df.val + 1).groupby(regex_pattern).prod() - 1
</code></pre>
<p>out:</p>
<pre><code>0    0.331
1    0.089
Name: val, dtype: float64
</code></pre>
</div>
<span class="comment-copy">Thank you, I get the Idea. Im still having some issues because df.values converts my df into a float64 file. However, I'm confident I'll get it working eventually.</span>
<span class="comment-copy">Simply add casts wherever they are needed.</span>
