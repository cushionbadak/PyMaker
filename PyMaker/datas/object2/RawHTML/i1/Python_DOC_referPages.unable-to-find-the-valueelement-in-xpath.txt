<div class="post-text" itemprop="text">
<p>Unable to find the element in xpath even though the element is there in the webpage.Actually code neither throw Exception nor find element.</p>
<pre><code>for c in range(sheet.ncols):
    for r in range(sheet.nrows):
        st = (sheet.cell_value(r, c))
        print(str(st))
        xpath1 = "//input[@value='Analyze' and contains(@onclick,'" + str(st) + "')]"
        #xpath = "//input[@value='Analyze'][.='" + st + "']"
        print(driver.title)
        print(len(driver.find_elements_by_xpath(xpath1)))
        if driver.find_elements_by_xpath(xpath1):
            print("loop")
            driver.find_element_by_xpath(xpath1).click()  # Here new window will open
            time.sleep(2)
            #Main_Window = driver.current_window_handle
            driver.switch_to.window(driver.window_handles[-1])
            driver.find_element_by_xpath('/html/body/table/tbody/tr[4]/td/table/tbody/tr[9]/td[3]/input').click()
            driver.close()
            driver.switch_to.window(driver.window_handles[-1])
            xpath2 = "//*[@id='create_button']"
            xpath3 = "//*[@id='update_button']"
            if check_exists_by_xpath(xpath2):
                driver.find_element_by_xpath(xpath2).click()
                driver.close()
                driver.switch_to.window(driver.window_handles[0])

            elif check_exists_by_xpath(xpath3):
                driver.close()
                driver.switch_to.window(driver.window_handles[0])
                continue
</code></pre>
<p>Expected output should be:</p>
<p>1635645
ST
1
loop
2M274203FZ
ST
1
2M27430052
ST
1
1618745
ST
1</p>
<p><a href="https://i.stack.imgur.com/Uf4KK.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/Uf4KK.png"/></a></p>
<p>But got the below output when ran the above code:
1635645
ST
1
loop
2M274203FZ
ST
0
2M27430052
ST
0
1618745
ST
0</p>
<p><a href="https://i.stack.imgur.com/ceH8L.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/ceH8L.png"/></a></p>
<p>What's wrong in the code?</p>
<p>Thanks in advance.</p>
</div>
<div class="post-text" itemprop="text">
<p>Just have to switch to the right window and frame.</p>
<pre><code>      if check_exists_by_xpath(xpath2):
            driver.find_element_by_xpath(xpath2).click()

      #else not required as you are not using the xpath3 to click

      driver.close()
      driver.switch_to.window(driver.window_handles[0])
      driver.switch_to.frame(base_frame_locator/index)
      driver.switch_to.frame(child_frame_locator/index)
      continue
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I, too would like to see your HTML or get a link to the webpage to check the xpaths.  However based on your output I think it is likely that you are not switching to the [0] indeexed window.  You are executing the window switch inside your if statements, so if neither of those conditions are met you will not switch windows.  Try taking the window switch out of your if, maybe like this:</p>
<pre><code>for c in range(sheet.ncols):
    for r in range(sheet.nrows):
        st = (sheet.cell_value(r, c))
        print(str(st))
        xpath1 = "//input[@value='Analyze' and contains(@onclick,'" + str(st) + "')]"
        #xpath = "//input[@value='Analyze'][.='" + st + "']"
        print(driver.title)
        print(len(driver.find_elements_by_xpath(xpath1)))
        if driver.find_elements_by_xpath(xpath1):
            print("loop")
            driver.find_element_by_xpath(xpath1).click()  # Here new window will open
            time.sleep(2)
            #Main_Window = driver.current_window_handle
            driver.switch_to.window(driver.window_handles[-1])
            driver.find_element_by_xpath('/html/body/table/tbody/tr[4]/td/table/tbody/tr[9]/td[3]/input').click()
            driver.close()
            driver.switch_to.window(driver.window_handles[-1])
            xpath2 = "//*[@id='create_button']"
            xpath3 = "//*[@id='update_button']"
            if check_exists_by_xpath(xpath2):
                driver.find_element_by_xpath(xpath2).click()
            driver.close()
            driver.switch_to.window(driver.window_handles[0])
</code></pre>
<p>I don't think you even need your second if statement because it just contains</p>
<pre><code>driver.close()
driver.switch_to.window(driver.window_handles[0])
</code></pre>
</div>
<span class="comment-copy">Can you provide the html for your xpath where the result return 0 element found?</span>
<span class="comment-copy">Still doubt that you are not pointing to the right window. You can keep a break point  at <code>print(len(driver.find_elements_by_xpath(xpath1)))</code> and try with all 4 items (in debug window) when you are in the first execution itself. You have to pass the xpath rather xpath1, in the debug window.</span>
<span class="comment-copy">We can't answer without seeing the html where the result is 0 instead of 1, but <code>find_elements_</code> won't throw an exception if no element was found.</span>
<span class="comment-copy">Oh! But in html element is there.</span>
<span class="comment-copy">.exe file isn't working</span>
<span class="comment-copy">Sometimes i'm getting error on File "C:/Users/xyz/PycharmProjects/Python/ST.py", line 50, in &lt;module&gt;     driver.find_element_by_xpath('/html/body/table/tbody/tr[4]/td/table/tbody/tr[9]/td[3]/input').click()</span>
<span class="comment-copy">make sure you have the expected condition visible, so that the script will wait until the element is visible. Just to handle the sync issue.</span>
<span class="comment-copy">Yes, it's visible</span>
<span class="comment-copy">what error you are getting?</span>
<span class="comment-copy">raise exception_class(message, screen, stacktrace) selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"xpath","selector":"/html/body/table/tbody/tr[4]/td/table/tbody/tr[9]/td[3]/input"}</span>
