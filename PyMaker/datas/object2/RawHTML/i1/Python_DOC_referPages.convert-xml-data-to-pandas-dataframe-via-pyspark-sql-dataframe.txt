<div class="post-text" itemprop="text">
<p>My background: long-time SAS and R user, trying to figure out how to do some elementary things in Azure Databricks using Python and Spark. Sorry for the lack of a reproducible example below; I'm not sure how to create one like this.</p>
<p>I'm trying to read data from a complicated XML file. I've reached this point, where I have a pyspark.sql.dataframe (call it xml1) with this arrangement:  </p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-html lang-html prettyprint-override"><code>RESPONSE:array
  element:array
    element:struct
      VALUE:string
      VARNAME:string</code></pre>
</div>
</div>
</p>
<p>The xml1 dataframe looks like this:  </p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-html lang-html prettyprint-override"><code>[Row(RESPONSE=[[Row(VALUE='No', VARNAME='PROV_U'), Row(VALUE='Included', VARNAME='ADJSAMP'), Row(VALUE='65', VARNAME='AGE'), ...</code></pre>
</div>
</div>
</p>
<p>When I use xml2=xml1.toPandas(), I get this:  </p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-html lang-html prettyprint-override"><code>                      RESPONSE
0   [[(No, PROV_U), (Included, ADJSAMP), (65, AGE)...
1   [[(Included, ADJSAMP), (71, AGE), ...
...</code></pre>
</div>
</div>
</p>
<p>At a minimum, I would like to convert this to a Pandas dataframe with two columns VARNAME and VALUE. A better solution would be a dataframe with columns named with VARNAME values (such as PROV_U, ADJSAMP, AGE), with one row per RESPONSE. Helpful hints with names of correct Python terms in intermediate steps are appreciated! </p>
</div>
<div class="post-text" itemprop="text">
<p>To deal with array of structs explode is your answer. Here is link on how to use explode <a href="https://hadoopist.wordpress.com/2016/05/16/how-to-handle-nested-dataarray-of-structures-or-multiple-explodes-in-sparkscala-and-pyspark/" rel="nofollow noreferrer">https://hadoopist.wordpress.com/2016/05/16/how-to-handle-nested-dataarray-of-structures-or-multiple-explodes-in-sparkscala-and-pyspark/</a></p>
</div>
<span class="comment-copy">Link-only answers are discouraged on Stack Overflow, as they are rendered useless if the link disappears for whatever reason. You should <a href="https://stackoverflow.com/posts/55389138/edit">edit</a> your answer to include the most important parts that are relevant to the question in the answer itself.</span>
<span class="comment-copy">Thank you Anand K ! This solved my problem.</span>
