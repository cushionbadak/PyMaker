<div class="post-text" itemprop="text">
<p><strong>Sample DF:</strong></p>
<pre><code>ID   Name        Price     Date             Fit_Test
1    Apple         10      2018-01-15          Super_Fit
2    Apple         10      2018-01-15          Super_Fit
3    Apple         10      2019-01-15          Super_Fit

4    Orange        12      2019-02-15          Not_Fit
5    Orange        12      2018-09-25          Not_Fit
6    Orange        12      NaT                 Not_Fit
7    Orange        12      2028-01-25          Not_Fit

8    Banana        15      2019-12-25          Medium_Fit
9    Banana        15      NaT                 Medium_Fit

10   Cherry         30     2021-06-23          Super_Fit

11   PineAp         30     2023-02-03          Medium_Fit
12   PineAp         30     2020-12-13          Medium_Fit
</code></pre>
<p><strong>Expected DF:</strong></p>
<pre><code>ID   Name        Price     Date             Fit_Test
1    Apple         10      2018-01-15          Super_Fit
2    Apple         10      2018-01-15          Super_Fit
3    Apple         10      2019-01-15          Super_Fit

7    Orange        12      2028-01-25          Not_Fit

8    Banana        15      2019-12-25          Medium_Fit
9    Banana        15      NaT                 Medium_Fit

10   Cherry         30     2021-06-23          Super_Fit

11   PineAp         30     2023-02-03          Medium_Fit
</code></pre>
<p><strong>Problem Statement:</strong></p>
<p>I want to <code>group-by</code> by <code>Name</code> and <code>Price</code> and then filter based on <code>Date</code> with <code>Fit_Test</code> as conditional column.</p>
<ol>
<li><p>If Fit_Test is <code>Super_Fit</code> then don't the no operation is needed. <strong>(Rows 1,2,3 and 10 is same in Input and Expected DF)</strong></p></li>
<li><p>If within a <code>Name</code> and <code>Price</code> conditions and Fit_Test is not <code>Super_Fit</code> and there is no <code>NaT</code> in that group then compare the dates, whichever has the <strong>highest date keep it</strong> <strong>(ID 11&amp;12 and in Expected 12 is deleted)</strong></p></li>
<li><p>If within a <code>Name</code> and <code>Price</code> conditions and Fit_Test is not <code>Super_Fit</code> and there is a <code>NaT</code> in that group:</p>
<p>3.1 If the count in that group is greater than 2, then compare the dates, whichever has the <strong>highest date keep it</strong> <strong>(ID 4,5,6,7 and in Expected 4,5,6 is deleted)</strong></p>
<p>3.2 If the count in that group is equal to 2, then keep both the rows  ** 
 (ID 8,9 and in Expected 8,9 is there)**</p></li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p>Use:</p>
<pre><code>df['Date'] = pd.to_datetime(df['Date'])

m1 = df['Fit_Test'].eq('Super_Fit').groupby([df['Name'],df['Price']]).transform('all')

m2 = df['Date'].notna().groupby([df['Name'],df['Price']]).transform('all')

m22 = df['Date'].eq(df.groupby(['Name', 'Price'])['Date'].transform('max'))

m3 = df.groupby(['Name', 'Price'])['Date'].transform('size').eq(2)

df = df[m1 | (m2 &amp; m22) | (~m2 &amp; m3) | (~m2 &amp; m22)]
#it seems conditions should be simplify
#df = df[m1 | m22 | (~m2 &amp; m3)]
print (df)
    ID    Name  Price       Date    Fit_Test
0    1   Apple     10 2018-01-15   Super_Fit
1    2   Apple     10 2018-01-15   Super_Fit
2    3   Apple     10 2019-01-15   Super_Fit
6    7  Orange     12 2028-01-25     Not_Fit
7    8  Banana     15 2019-12-25  Medium_Fit
8    9  Banana     15        NaT  Medium_Fit
9   10  Cherry     30 2021-06-23   Super_Fit
10  11  PineAp     30 2023-02-03  Medium_Fit
</code></pre>
</div>
<span class="comment-copy">What have you tried so far? Where you get stuck?</span>
<span class="comment-copy">I am not able to write queries to chain these conditions. For Point 1, I have <code>m1 = df['Fit_Test'].eq('Super_Fit').groupby([df['Name'],df['Price']]).transform('all')</code>. I want similar queries for Point 2 &amp;3 so I can chain them</span>
<span class="comment-copy">I don't think there is a straight forward way to do this, filter each condition from main df and concat result once, would be my choice.</span>
<span class="comment-copy">Getting this warning <code>FutureWarning: In the future, 'NAT == x' and 'x == NAT' will always be False.</code> for <code>m22</code></span>
<span class="comment-copy">@RahulAgarwal - what is your pandas version?</span>
<span class="comment-copy">0.23.0 ,my pandas version</span>
<span class="comment-copy">@RahulAgarwal - for me it working correctly in pandas 0.24.2</span>
<span class="comment-copy">cool will update</span>
