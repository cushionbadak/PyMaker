<div class="post-text" itemprop="text">
<p>I'm new to python. I have a feeling there is a quick fix, but nothing has seemed quick to me yet. </p>
<p>I have a 150,000+ row dataframe, <code>data</code>. Within it are two series: <code>gridcode</code> and <code>CH4_Flux</code> among others. I want to create a new categorical column, called <code>category</code> that assigns a categorical identifier to each row based on the four conditions shown here: </p>
<pre><code>cat1 = data[(data.gridcode &lt;= threshAV) &amp; (data.CH4_Flux &gt;= threshAM)]
cat2 = data[(data.gridcode &gt;= threshAV) &amp; (data.CH4_Flux &gt;= threshAM)]
cat3 = data[(data.gridcode &lt;= threshAV) &amp; (data.CH4_Flux &lt;= threshAM)]
cat4 = data[(data.gridcode &gt;= threshAV) &amp; (data.CH4_Flux &lt;= threshAM)]
</code></pre>
<p>where <code>threshAV</code> is a predesignated threshold for <code>gridcode</code>, and <code>threshAM</code> is a predesignated threshold for <code>CH4_Flux</code>. Essentially either both exceed the threshold, neither exceed, or one or the other exceeds. Preferably the categorical labels would simply be the integers 1,2,3, and 4 respectively following the logic of <code>cat1</code>,<code>cat2</code>,<code>cat3</code>,and <code>cat4</code> above. </p>
<p>I have tried <code>for</code> loops and <code>if</code> and <code>where</code> statements but have struck out. </p>
<p>When experimenting with <code>for</code> loops, I commonly get the error: </p>
<p><code>ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().</code></p>
<p>Thank you in advance for any advice or direction! </p>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.select.html" rel="nofollow noreferrer"><code>numpy.select</code></a> for new columns by multiple boolean masks:</p>
<pre><code>#removed filtering by data[]
m1 = (data.gridcode &lt;= threshAV) &amp; (data.CH4_Flux &gt;= threshAM)
m2 = (data.gridcode &gt;= threshAV) &amp; (data.CH4_Flux &gt;= threshAM)
m3 = (data.gridcode &lt;= threshAV) &amp; (data.CH4_Flux &lt;= threshAM)
m4 = (data.gridcode &gt;= threshAV) &amp; (data.CH4_Flux &lt;= threshAM)

data['category'] = np.select([m1, m2, m3, m4], [1,2,3,4])
</code></pre>
<p>Or:</p>
<pre><code>data['category'] = np.select([m1, m2, m3, m4], ['cat1','cat2','cat3','cat4'])
</code></pre>
</div>
<span class="comment-copy">This did not work for me. <code>data['category'] = np.select([cat1, cat2, cat3, cat4], [1,2,3,4])</code> returned <code>ValueError: shape mismatch: objects cannot be broadcast to a single shape</code></span>
<span class="comment-copy">@celder88 There was error?</span>
<span class="comment-copy">Yes the error was <code>ValueError: shape mismatch: objects cannot be broadcast to a single shape</code></span>
<span class="comment-copy">@celder88 - Is possible add some data samples?</span>
<span class="comment-copy">I'm not sure what you mean. You want to see a sample of the dataframe?</span>
