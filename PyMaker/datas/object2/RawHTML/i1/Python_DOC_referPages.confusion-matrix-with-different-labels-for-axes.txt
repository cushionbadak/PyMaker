<div class="post-text" itemprop="text">
<p>I tried to train and test a Naive Bayes classifier. </p>
<p>The following is part of my code:</p>
<pre><code>from sklearn.feature_extraction.text import CountVectorizer
matrix = CountVectorizer(ngram_range=(1,1))
X = matrix.fit_transform(data).toarray()
y =  [re.sub('[^A-Za-z]', ' ', y).strip(' ') for y in mobiles.iloc[:, 2]]

# split train and test data
from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y)

# Naive Bayes 
from sklearn.naive_bayes import GaussianNB

classifier = GaussianNB()

classifier.fit(X_train, y_train)

# predict class
y_pred = classifier.predict(X_test)

res = pd.DataFrame({'y_test':y_test, 'y_pred':y_pred})
print(res)
# Confusion matrix
from sklearn.metrics import confusion_matrix, classification_report, accuracy_score, f1_score
cm = confusion_matrix(y_test, y_pred)
cr = classification_report(y_test, y_pred)

brands = list(set(y))

accuracy = accuracy_score(y_test, y_pred)
print("accuracy:", accuracy)
print("Confusion Matrix:")
import seaborn as sn
import pandas  as pd
import matplotlib.pyplot as plt

aylabels = brands #[str(i) for i in aylabels]
axlabels = brands #[str(i) for i in range(50)]

plt.figure(figsize=(10, 10))
sn.set(font_scale=1.4)  # for label size
sn.heatmap(cm, annot=True, annot_kws={"size": 12}, xticklabels=axlabels, yticklabels=aylabels)  # font size
plt.show()
</code></pre>
<p>The following is the confusion matrix I built from a <code>hitmap</code> in the code above. while I set <code>aylabels</code> and <code>axlabels</code> the same thing, but the rows and columns are different in the plot.</p>
<p><a href="https://i.stack.imgur.com/5leVR.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/5leVR.png"/></a></p>
<p>I don't know what happened!</p>
</div>
<div class="post-text" itemprop="text">
<p>You forget to set labels parameter in confusion_matrix.</p>
<pre><code>cm = confusion_matrix(y_test, y_pred, labels=brands)
</code></pre>
</div>
<span class="comment-copy">Could you provide some data so we can recreate the heatmap? Also, why do you use "brands = list(set(y))", ie. cast y through a set and then through a list, thus possibly messing the original order of entries in y?</span>
<span class="comment-copy">@InonPeled I tried to make them unique? Is it wrong? but it works!</span>
