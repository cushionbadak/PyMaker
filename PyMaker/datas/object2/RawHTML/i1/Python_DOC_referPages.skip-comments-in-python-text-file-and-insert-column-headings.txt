<div class="post-text" itemprop="text">
<p>I am working on a large dataset, in which I have the data in the following format (this is not the true data),</p>
<pre><code>#relation 'train'
#attri 'x' real
#attri 'y' integer
#attri 'z' binary (0/1)
#attri 'a' real
#attri 'b' integer
#attri 'class' binary(good/bad)
#data
1.2, 5, 0, 2.3, 4, good
1.3, 6, 1, 1.8, 5, bad
1.6, 7, 0, 1.9, 6, good
2.1, 8, 1, 2.1, 8, good
</code></pre>
<p>I tried with pandas (although I would like to use python alone).
<a href="https://i.stack.imgur.com/6ZhrA.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/6ZhrA.png"/></a></p>
<p>I want 'x', 'y', 'z', 'a', 'b', 'class' as the heading of the columns. Thanks for helping me with this.</p>
</div>
<div class="post-text" itemprop="text">
<p>Here's one potential solution:</p>
<p>1) Read the <code>DataFrame</code> in ignoring comments, with no header.</p>
<p>2) Read the file in again including comments, but limiting the row number to just the number of columns of <code>df</code> + 1.</p>
<p>3) Use a regex pattern to extract the header name.</p>
<p>4) Assign the headers to the column names of your original <code>DataFrame</code></p>
<pre><code>df = pd.read_csv('test.txt', sep=',', comment='#', header=None)

s = pd.read_csv('test.txt', nrows=len(df.columns)+1, names=['headers'])
columns = s.headers.str.extract(r'^#attri \'(.+)\'').dropna().values.flatten()

df.columns = columns
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>First we can extract the column names from the <code>.txt</code> file like following:</p>
<pre><code>import re

columns = []

with open('test.txt', 'r') as f:
    lines=f.readlines()
    for line in lines:
        l = line.strip()
        if l.startswith('#attri'):
            columns.append(re.findall(r"'(.{1})'", l))

columns = [item for sublist in columns for item in sublist]
</code></pre>
<p>Apparently your csv has no header, so you have to explicitly use the <code>headers</code> argument in <a href="http://s.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" rel="nofollow noreferrer"><code>pd.read_csv</code></a> like following: </p>
<pre><code>df = pd.read_csv('test.txt', comment='#', header=None)

# Now we can set the column names correctly
df.columns = columns
</code></pre>
<p><strong>2nd option</strong> use <code>names</code> argument:</p>
<pre><code>df = pd.read_csv('test.txt', 
                 comment='#', 
                 header=None,
                 names=columns)
</code></pre>
<p><strong>Test</strong></p>
<pre><code>import re

columns = []

with open('test.txt', 'r') as f:
    lines=f.readlines()
    for line in lines:
        l = line.strip()
        if l.startswith('#attri'):
            columns.append(re.findall(r"'(.{1})'", l))

columns = [item for sublist in columns for item in sublist]

print(columns)
['x', 'y', 'z', 'a', 'b']

# Now we have the column names, we can read the csv
from io import StringIO

a = StringIO('''
1.2, 5, 0, 2.3, 4, good
1.3, 6, 1, 1.8, 5, bad
1.6, 7, 0, 1.9, 6, good
2.1, 8, 1, 2.1, 8, good
''')

df = pd.read_csv(a, 
                 comment='#', 
                 header=None,
                 names=columns)

print(df)
     x  y    z  a      b
1.2  5  0  2.3  4   good
1.3  6  1  1.8  5    bad
1.6  7  0  1.9  6   good
2.1  8  1  2.1  8   good
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you want to rename the columns of a pandas dataframe you can use</p>
<pre><code>df.columns = [ 'x', 'y', 'z', 'a', 'b']
</code></pre>
</div>
<span class="comment-copy">Thank you!! This works as I wanted.</span>
<span class="comment-copy">Youâ€™re welcome! Glad it worked</span>
<span class="comment-copy">Can we automate this column name task? Because I have more than 200 columns and corresponding names.</span>
<span class="comment-copy">Are the column names stored somewhere? Apparently they are not in <code>test.txt</code> am I right?</span>
<span class="comment-copy">The data here I have mentioned is a small dataset (dummy). But my actual data contains more than 200 columns and names as mentioned in the above post. It is of course in the same text file.</span>
<span class="comment-copy">Made an edit, but I see youre already helped :) @Mass17</span>
<span class="comment-copy">Thanks Erfan!! Much appreciated :)</span>
<span class="comment-copy">This is incorrect, first row is been imported as header, so this will remove the first row.</span>
