<div class="post-text" itemprop="text">
<p>I would like to use PyQt5 to take a screenshot of a webpage. (A full webpage, including the stuff a user wouldn't see unless they scrolled down.)</p>
<p><a href="https://stackoverflow.com/questions/29547460/render-web-content-offscreen-using-qtwebengine">Supposedly, it is possible to do this in PyQt5 using QtWebEngine</a>. How would you do it though? I specifically don't want the user to see a browser window opening or rendering. I just want a screenshot in a PNG file.</p>
</div>
<div class="post-text" itemprop="text">
<p>-This code was tested in : <strong>QT_VERSION_STR = 5.12.1</strong> , <strong>PYQT_VERSION_STR = 5.12</strong></p>
<blockquote>
<p><strong>NOTE:</strong> QtWebKit got deprecated upstream in Qt 5.5 and removed in 5.6.</p>
<p>Instead it is replaced with "QtWebEngineWidgets". So you have to make changes in code. </p>
<blockquote>
<p>For more informations: <a href="http://doc.qt.io/qt-5/qtwebenginewidgets-qtwebkitportingguide.html" rel="nofollow noreferrer">http://doc.qt.io/qt-5/qtwebenginewidgets-qtwebkitportingguide.html</a></p>
</blockquote>
</blockquote>
<pre><code>from PyQt5.QtGui import QPainter, QImage
from PyQt5 import QtWebKitWidgets
from functools import partial



class Screenshot(QtWebKitWidgets.QWebView):
    def __init__(self):
        QtWebKitWidgets.QWebView.__init__(self)

    def capture(self, url, output_file):
        self.load(QUrl(url))
        self.loadFinished.connect(partial(self.onDone, output_file))

    def onDone(self,output_file):
        # set to webpage size
        frame = self.page().mainFrame()
        self.page().setViewportSize(frame.contentsSize())
        # render image
        image = QImage(self.page().viewportSize(), QImage.Format_ARGB32)
        painter = QPainter(image)
        frame.render(painter)
        painter.end()
        image.save(output_file)


s = Screenshot()
s.capture('https://pypi.org/project/PyQt5/', 'C:/Users/user/Desktop/web_page.png')
</code></pre>
<p>result:</p>
<p><a href="https://i.stack.imgur.com/AFskI.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/AFskI.png"/></a></p>
</div>
<span class="comment-copy">I have not tested it. However, my interest is in doing this with PyQt5.</span>
<span class="comment-copy">Edited question to remove PyQt4 references</span>
<span class="comment-copy">Have you seen <a href="https://stackoverflow.com/questions/10705712/screenshot-of-a-window-using-python">this?</a>. Not sure if it will take a screen shot of the stuff the user wouldn't see though...</span>
<span class="comment-copy">This looks like what I want, but some code was lost while pasting into SO. There's no class definition, etc. When run, does this code show a browser window? I would like to keep it hidden from the user.</span>
<span class="comment-copy">no,its not showing browser window, its just saving png of gaven url</span>
<span class="comment-copy">What is the definition of __init__() and the class?</span>
<span class="comment-copy">I just edit my post, now you have code with class definition</span>
<span class="comment-copy">True. I think this is a useful answer to have (so please don't delete it), but it doesn't work in the version of Qt I use.</span>
