<div class="post-text" itemprop="text">
<p>I am wanting to reshape the following data from long to wide using both <code>port1</code> and <code>port2</code> as the variables of interest</p>
<pre><code>            port1  port2     w_ret
date                              
2006-01-01    0.0    0.0  0.067991
2006-01-01    0.0    1.0  0.033219
2006-01-01    1.0    0.0  0.073324
2006-01-01    1.0    1.0  0.039730
2006-01-02    0.0    0.0  0.033616
2006-01-02    0.0    1.0  0.022452
2006-01-02    1.0    0.0 -0.024854
2006-01-02    1.0    1.0  0.020411
</code></pre>
<p>I wish for the rearranged data to look like this:</p>
<pre><code>             0.00.0     0.01.0    1.00.0    1.01.0     

date
2006-01-01  0.067991   0.033219  0.073324  0.039730   
2006-01-02  0.033616   0.022452 -0.024854  0.020411
</code></pre>
<p>The numbers at the top resemble <code>port1</code> and <code>port2</code> numbers together. I am not sure what would end up going there when the correct code is used.</p>
<p>I have tried <code>unstack()</code> when making <code>port1</code> and <code>port2</code> an index with <code>date</code>and had a go at using <code>pivot_table</code>, but no luck in achieving this output. </p>
<p>Any ideas would be awesome!</p>
</div>
<div class="post-text" itemprop="text">
<p>First join columns together, then <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.set_index.html" rel="nofollow noreferrer"><code>DataFrame.set_index</code></a> with parameter <code>append=True</code> and last reshape by <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.unstack.html" rel="nofollow noreferrer"><code>Series.unstack</code></a>:</p>
<pre><code>s = df['port1'].astype(str) + df['port2'].astype(str)
df = df.set_index(s, append=True)['w_ret'].unstack()
print (df)
              0.00.0    0.01.0    1.00.0    1.01.0
date                                              
2006-01-01  0.067991  0.033219  0.073324  0.039730
2006-01-02  0.033616  0.022452 -0.024854  0.020411
</code></pre>
</div>
<span class="comment-copy">thats clever.. :D</span>
