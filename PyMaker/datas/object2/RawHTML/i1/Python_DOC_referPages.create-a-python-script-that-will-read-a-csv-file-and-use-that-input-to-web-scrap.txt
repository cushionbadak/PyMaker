<div class="post-text" itemprop="text">
<p>I'm trying to pull in a list of stocks from a csv file, upload each stock ticker into finviz.com, and export the data to csv file. I'm new to Python programing but I know this will help me and others. This is what I got so far.</p>
<pre><code>    import csv
import urllib.request
from bs4 import BeautifulSoup

with open('shortlist.csv', 'r') as csvfile:
    reader = csv.reader(csvfile, delimiter=',')
    name = None
    for row in reader:
        if row[0]:
            name = row[0]
        print(name)
write_header = True

sauce = print(name)
soup = BeautifulSoup(sauce.text, 'html.parser')

print(soup.title.text)

symbols = name
""""
print(symbols)
"""
URL_BASE = "https://finviz.com/quote.ashx?t="

with open('output.csv', 'w', newline='') as file:
    writer = csv.writer(file)

    for ticker in symbols:
        URL = URL_BASE + ticker
        try:
            fpage = urllib.request.urlopen(URL)
            fsoup = BeautifulSoup(fpage, 'html.parser')

            if write_header:
                # note the change
                writer.writerow(['ticker'] + list(map(lambda e: e.text, fsoup.find_all('td', {'class': 'snapshot-td2-cp'}))))
                write_header = False

            # note the change
            writer.writerow([ticker] + list(map(lambda e: e.text, fsoup.find_all('td', {'class': 'snapshot-td2'}))))
        except urllib.request.HTTPError:
            print("{} - not found".format(URL))
</code></pre>
<p>I'm missing the output on the csv file "output.csv". I'm only seeing the data from my input csv file "shortlist". The tie or link is not correctly linked.I've spent a couple of weeks researching/working on how to do this. You're help is greatly appreciated.</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>import csv
import urllib.request
from bs4 import BeautifulSoup

with open('shortlist.csv', 'r') as csvfile:
    reader = csv.reader(csvfile, delimiter=',')
    name = None
    for row in reader:
        if row[0]:
            name = row[0]
        print(name)
write_header = True

#sauce = print(name)
#soup = BeautifulSoup(sauce.text, 'html.parser')

#print(soup.title.text)

symbols = name
""""
print(symbols)
"""
URL_BASE = "https://finviz.com/quote.ashx?t="

with open('output.csv', 'w', newline='') as file:
    writer = csv.writer(file)

    for ticker in symbols:
        URL = URL_BASE + ticker
        try:
            fpage = urllib.request.urlopen(URL)
            fsoup = BeautifulSoup(fpage, 'html.parser')

            if write_header:
                # note the change
                writer.writerow(['ticker'] + list(map(lambda e: e.text, fsoup.find_all('td', {'class': 'snapshot-td2-cp'}))))
                write_header = False

            # note the change
            writer.writerow([ticker] + list(map(lambda e: e.text, fsoup.find_all('td', {'class': 'snapshot-td2'}))))
        except urllib.request.HTTPError:
</code></pre>
<p>This is the output:
<a href="https://i.stack.imgur.com/N9amR.png" rel="nofollow noreferrer">enter image description here</a></p>
</div>
<span class="comment-copy">This is the error and output I get: Traceback (most recent call last):   File "C:/Users/PycharmProjects/test1", line 15, in &lt;module&gt;     soup = BeautifulSoup(sauce.text, 'html.parser') AttributeError: 'NoneType' object has no attribute 'text' Symbol PDD SNCR VSTM EYES OTIV</span>
<span class="comment-copy">I know I'm missing a loop. Just don't know how to write it.</span>
