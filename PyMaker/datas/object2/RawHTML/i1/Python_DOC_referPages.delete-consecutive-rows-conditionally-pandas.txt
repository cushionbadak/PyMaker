<div class="post-text" itemprop="text">
<p>I have a df with columns (A, B, C, D, F). I want to:
1) Compare consecutive rows
2) if the absolute difference between consecutive E &lt;=1 AND absolute difference between consecutive C&gt;7, then delete the row with the lowest C value.
Sample Data:</p>
<pre><code>     A       B    C      D       E
0   94.5    4.3  26.0   79.0    NaN
1   34.0    8.8  23.0   58.0    54.5
2   54.2    5.4  25.5   9.91    50.2
3   42.2    3.5  26.0   4.91    5.1
4   98.0    8.2  13.0   193.7   5.5
5   20.5    9.6  17.0   157.3   5.3
6   32.9    5.4  24.5   45.9    79.8
</code></pre>
<p>Desired result:</p>
<pre><code>     A       B    C      D       E
0   94.5    4.3  26.0   79.0    NaN
1   34.0    8.8  23.0   58.0    54.5
2   54.2    5.4  25.5   9.91    50.2
3   42.2    3.5  26.0   4.91    5.01
4   32.9    5.4  24.5   45.9    79.8
</code></pre>
<p>Row 4 was deleted when compared with row 3. Row 5 is now row 4 and it was deleted when compared to row 3.</p>
<p>This code returns the results as boolean (not df with values) and does not satisfy all the conditions.</p>
<pre><code>df = (abs(df.E.diff(-1)) &lt;=1 &amp; (abs(df.C.diff(-1)) &gt;7.)
</code></pre>
<p>The result of the code:</p>
<pre><code>0    False
1    False
2    False
3     True
4    False
5    False
6    False
dtype: bool
</code></pre>
<p>Any help appreciated.</p>
</div>
<div class="post-text" itemprop="text">
<p>Using <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.shift.html" rel="nofollow noreferrer">shift()</a> to compare the rows, and a while loop to iterate until no new change happens:</p>
<pre><code>while(True):
    rows = len(df)
    df = df[~((abs(df.E - df.E.shift(1)) &lt;= 1)&amp;(abs(df.C - df.C.shift(1)) &gt; 7))]
    df.reset_index(inplace = True, drop = True)
    if (rows == len(df)):
        break
</code></pre>
<p>It produces the desired output:</p>
<pre><code>    A       B       C       D       E
0   94.5    4.3     26.0    79.00   NaN
1   34.0    8.8     23.0    58.00   54.5
2   54.2    5.4     25.5    9.91    50.2
3   42.2    3.5     26.0    4.91    5.1
4   32.9    5.4     24.5    45.90   79.8
</code></pre>
</div>
