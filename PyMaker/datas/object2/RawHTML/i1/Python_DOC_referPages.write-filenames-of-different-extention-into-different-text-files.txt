<div class="post-text" itemprop="text">
<pre><code>import os

exts = ['ppt', 'pptx', 'doc', 'docx', 'txt', 'pdf', 'epub']
files = []

for root, dirnames, filenames in os.walk('.'):
    for i in exts:
        for file in filenames:
            if file.endswith(i):
                file1 = os.path.join(root, file)
                print(file1)
                with open(os.getcwd()+ r"\ally_"+i+".txt", 'w+') as f:
                    f.write("%s\n" % file1)
</code></pre>
<p>I m trying this code. How do I write all files in my system with ex. doc extention into a file named all_docs.txt in my desktop? file.write() inside for loop only write the last line of each extention into the files.</p>
</div>
<div class="post-text" itemprop="text">
<p>You need to open the log file in append mode (<code>a</code>) and not in write mode (<code>w</code>), because with <code>w</code> the file gets truncated (all content deleted) before anything new is written to it.</p>
<p>You can look into the docs of <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer"><code>open()</code></a>. <a href="https://stackoverflow.com/a/1466036/9225671">This answer</a> also has an overview of all the file modes.</p>
<p>Does it work with <code>a</code> for you?</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>with open(os.getcwd()+ r"\ally_"+i+".txt", 'w+') as f:
    f.write("%s\n" % file1)
</code></pre>
<p>According to <a href="https://docs.python.org/2/library/functions.html#open" rel="nofollow noreferrer">https://docs.python.org/2/library/functions.html#open</a> the "w+" operation truncates the file.</p>
<blockquote>
<p>Modes 'r+', 'w+' and 'a+' open the file for updating (reading and writing); <strong>note that 'w+' truncates the file</strong>. </p>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>The mode <code>w+</code> for <code>open</code> causes to truncate the file, this is the reason for losing the lines, and only the last one will stay there.
An other little problem can be that this method of joining the path and the file name is not portable. You should user <code>os.path.join</code> for that purpose.</p>
<pre><code>            with open(os.path.join(os.getcwd(),"ally_"+i+".txt"), 'a') as f:
                f.write("%s\n" % file1)
</code></pre>
<p>An other issue can be the week performance which you can have in case of many directories and files.
In your code you run through the filenames in the directory for each extension and open the output file again and again.
One more issue can be the checking of the extension. In most cases the extension can be determined by checking the ending of the file name, but sometimes it can be misleading. E.g. <code>'.doc'</code> is an extension however in a filename <code>'Medoc'</code> the ending <code>'doc'</code> is just 3 letters in a name.
So I give an example solution for these problems:</p>
<pre><code>import os

exts = ['ppt', 'pptx', 'doc', 'docx', 'txt', 'pdf', 'epub']
files = []
outfiles = {}
for root, dirnames, filenames in os.walk('.'):
        for filename in filenames:
            _, ext = os.path.splitext(filename)
            ext = ext[1:] # we do not need "."
            if ext in exts:
                file1 = os.path.join(root, filename)
                #print(i,file1)
                if ext not in outfiles:
                    outfiles[ext] = open(os.path.join(os.getcwd(),"ally_"+ext+".txt"), 'a')
                outfiles[ext].write("%s\n" % file1)
for ext,file in outfiles.iteritems():
    file.close()
</code></pre>
</div>
<span class="comment-copy">Please reformat your code</span>
<span class="comment-copy">What exactly is not working? Any problems?</span>
<span class="comment-copy">the output in ally_doc.txt file only contains 1 file name. but I want all files in my system of .doc extension to write to ally_doc.txt. How should I approach this problem?</span>
<span class="comment-copy">I think you need to open the file in "a" (append) mode</span>
<span class="comment-copy">Yes. "a" mode worked!! many thanks :)</span>
<span class="comment-copy">yes "a" worked. Thank you</span>
<span class="comment-copy">Right! How would you approach this problem? It would be of help</span>
<span class="comment-copy">Sure. I've edited the answer to include my suggestions.</span>
