<div class="post-text" itemprop="text">
<p>I have 100 csv files. Each file contains columns that may or may not be in the other .csv files. I need to merge all of the csv files into one and sum all columns that have the same column name. Below is an example with two csv files, but imagine it can go up to 100 csv files: </p>
<p><strong>first csv file:</strong></p>
<pre><code> User  col1 col2 col3 col4 col5 ....colX
 A     1    1     1    2    6        5
 B     4    5     6    7    23       6
 C     4    6     1    2     4       4
</code></pre>
<p><strong>second csv file</strong></p>
<pre><code>User  col1 col2 col3 col4 col5 ....colY
 A     1    1     5    3    2       3
 B     20   4     3    9    6       4 
 C     2    1     4    3    4       1
</code></pre>
<p><strong>Result DataFrame</strong></p>
<pre><code>User   col1   col2    col3   col4   col5 ....colX colY
 A     1+1    1+1     1+5    2+3    6+2       5    3
 B     4+20   5+4     6+3    7+9    23+6      6    4
 C     4+2    6+1     1+4    2+3    4+4       4    1
</code></pre>
<p>I have tried doing the following to combine the csv, but columns are not aggregating. </p>
<pre><code>csvArray = []
for x in range(1,101): 
   csvArray.append(pd.read_csv("myCsv"+str(x)+".csv"))

full_df = pd.concat(csvArray).fillna(0)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can create index by <code>User</code> column and use <code>sum</code> by first level:</p>
<pre><code>csvArray = []
for x in range(1,101): 
   csvArray.append(pd.read_csv("myCsv{}.csv".format(x), index_col=['User']))
</code></pre>
<p>Or:</p>
<pre><code>csvArray = [pd.read_csv("myCsv{}.csv".format(x), index_col=['User']) for x in range(1,101)]
</code></pre>
<hr/>
<pre><code>full_df = pd.concat(csvArray).fillna(0).sum(level=0).reset_index()
</code></pre>
<p>In your solution should aggregate by <code>User</code> column:</p>
<pre><code>full_df = pd.concat(csvArray).fillna(0).groupby('User', as_index=False).sum()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Also you can try:</p>
<pre><code>data = pd.DataFrame()
for x in range(1, 101):
    df = pd.read_csv('mycsv'+str(x)+'.csv').set_index('User')
    data = data.add(df, fill_value = 0).fillna(0)
</code></pre>
</div>
<span class="comment-copy">Awesome! That solved it!</span>
<span class="comment-copy">@user5844628 - You are welcome! If my answer was helpful, don't forget accept it.</span>
