<div class="post-text" itemprop="text">
<p>I am currently learning pandas in python and have come across a problem.
I have a csv file containing US census data <a href="https://www2.census.gov/programs-surveys/popest/technical-documentation/file-layouts/2010-2015/co-est2015-alldata.pdf" rel="nofollow noreferrer">csv variables info</a>. For this question we can focus columns named STNAME (eg. albama) and a column named COUNTY.</p>
<p>The STNAME has repeating values for every county.That is it can have multiple 'albama' for every county in it.
<a href="https://i.stack.imgur.com/n4cbt.png" rel="nofollow noreferrer"><img alt="Census_Dataset" src="https://i.stack.imgur.com/n4cbt.png"/></a></p>
<p>The question is : Which state has the most counties in it? (hint: consider the sumlevel key carefully! You'll need this for future questions too...)</p>
<p>What i am trying : 
1.a&gt;  <code>census_df[census_df.groupby('STNAME')['COUNTY'].count() == max(census_df.groupby('STNAME')['COUNTY'].count())]</code></p>
<p>1.b&gt; <code>census_df[census_df.groupby('STNAME')['COUNTY'].count() == (census_df.groupby('STNAME')['COUNTY'].count().max())]</code></p>
<p>1.c&gt; <code>census_df.groupby('STNAME')[census_df.groupby('STNAME')['COUNTY'].count() == (census_df.groupby('STNAME')['COUNTY'].count().max())]</code></p>
<p>Here I am trying to fetch the record which has the max county count.
The last one gives an error : 'Columns not found: False, True'</p>
<p>2&gt; </p>
<pre><code>x = (census_df.groupby('STNAME')['COUNTY'].count() == census_df.groupby('STNAME')['COUNTY'].count().max() )
x[x['COUNTY'] == True]
</code></pre>
<p>Here I am grouping by state name and counting the counties for each state and fetching the max value</p>
<p>I can fetch the value as a bool. as in there is only a single state with bool "True". but I don't know how to fetch only that single record.</p>
<p>How should i procceed ?</p>
</div>
<div class="post-text" itemprop="text">
<p>I found it!</p>
<pre><code>census_df.groupby('STNAME')['COUNTY'].count()[census_df.groupby('STNAME')['COUNTY'].count() == (census_df.groupby('STNAME')['COUNTY'].count().max())]
</code></pre>
<p>I thought that the only thing that was missing was ['COUNTY'].count() . I thought that it was unneccessary before as i was querying it within the [] brackets , but i guess I was wrong. My understanding is that the outermost part was of different format than that which was being fetched by querying.</p>
</div>
