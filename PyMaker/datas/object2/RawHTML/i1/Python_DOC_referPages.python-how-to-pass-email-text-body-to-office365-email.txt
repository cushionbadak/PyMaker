<div class="post-text" itemprop="text">
<p>Trying to make the script below work for office365. Sends out an email but I cannot get the script to recognize the actual email text body (only the Subject line being sent). Below script worked for gmail. Any ideas where I need to modify?</p>
<p>Thanks! </p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-html lang-html prettyprint-override"><code>import smtplib, ssl

port = 587 
smtp_server = "smtp.office365.com"
sender_email = "me@email.com"
receiver_email = {'User1': 'user1@email.com'}
password = "password"

subject = input('Enter the subject line: ')
message = input('Enter the message: ')

email = """\
Subject: %s
%s
""" % (subject, message)

for key, value in receiver_email.items():                   

    context = ssl.create_default_context()
    with smtplib.SMTP(smtp_server, port) as server:
        server.ehlo()  # Can be omitted
        server.starttls(context=context)
        server.ehlo()  # Can be omitted
        server.login(sender_email, password)
        server.sendmail(sender_email, value, email)               
        server.quit()</code></pre>
</div>
</div>
</p>
</div>
<div class="post-text" itemprop="text">
<p>was missing a "\n" in the email object. It now works. </p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-html lang-html prettyprint-override"><code>email = """\
Subject: %s\n
%s
""" % (subject, message)</code></pre>
</div>
</div>
</p>
</div>
