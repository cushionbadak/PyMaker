<div class="post-text" itemprop="text">
<p>Consider the following DataFrame:</p>
<pre><code>import numpy as np
import pandas as pd

arrays = [['foo', 'foo', 'foo', 'bar', 'bar', 'bar'],
      ['A', 'B', 'C', 'A', 'B', 'C']]
tuples = list(zip(*arrays))
index_values = pd.MultiIndex.from_tuples(tuples)
df = pd.DataFrame(np.random.rand(6), index = index_values)

print(df)

              0
foo A  0.726699
    B  0.001700
    C  0.936495
bar A  0.298490
    B  0.167234
    C  0.476725
</code></pre>
<p>Say I want to scale df with the following values:</p>
<pre><code>df_scale = pd.DataFrame([0,1,4], index=['A','B','C'])
print(df_scale)

   0
A  0
B  1
C  4
</code></pre>
<p>That is, I want all A's to be multiplied by 0, all B's by 1, and all C's by 4. </p>
<p>Currently, I use the following approach:</p>
<pre><code>df_new = df.copy()
list_df_new_index = list(df_new.index)
for index in list_df_new_index:
    cntr, prod = index
    df_new.loc[cntr, prod] = df_new.loc[cntr, prod]*df_scale.loc[prod]
print(df_new)

              0
foo A  0.000000
    B  0.001700
    C  3.745981
bar A  0.000000
    B  0.167234
    C  1.906900
</code></pre>
<p>While this works, I can't help but think there is a functionality within pandas that would allow me to do just that. </p>
<p>I went through the answers on <a href="https://stackoverflow.com/questions/53927460/select-rows-in-pandas-multiindex-dataframe">Select rows in pandas MultiIndex DataFrame</a>. </p>
<p>At first I thought I could use df.xs(), but if I understand correctly this only allows me to select and not change values. </p>
<p>Next I looked into pd.IndexSlice(), but I don't see how I can use this to change multiple values.</p>
<p>Does pandas offer the functionality of changing multiple values in a lower level of a MultiIndex DataFrame?</p>
</div>
<div class="post-text" itemprop="text">
<p>You can multiple by <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.mul.html" rel="nofollow noreferrer"><code>DataFrame.mul</code></a>:</p>
<pre><code>df = df.mul(df_scale, level=1, axis=0)
#if want multiple by column 0
#df = df.mul(df_scale[0], level=1, axis=0)
print (df)
              0
foo A  0.000000
    B  0.393081
    C  2.495880
bar A  0.000000
    B  0.880499
    C  1.196688
</code></pre>
</div>
