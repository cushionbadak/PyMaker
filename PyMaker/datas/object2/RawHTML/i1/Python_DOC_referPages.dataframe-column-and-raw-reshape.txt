<div class="post-text" itemprop="text">
<p>Hi I have a dataframe that I want to shape.</p>
<p>The dataframe</p>
<pre><code>Month   StartAt WorksDone
    0   2017-1  1000
    1   2017-1  1000
    2   2017-1  1000
    3   2017-1  800
    4   2017-1  800
    5   2017-1  800
    0   2017-2  800
    1   2017-2  800
    2   2017-2  800
    3   2017-2  800
    4   2017-2  800
</code></pre>
<p>I want to reshape it into</p>
<pre><code>    2017-1  2017-2
0   1000    800
1   1000    800
2   1000    800
3   800     800
4   800     800
5   800 
</code></pre>
<p>I found df.T can swap columns and rows but I only want to move specific column. Any suggestion how to do this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Take a look at the pivot function, or in this case the unstack method:</p>
<pre><code>df.unstack(level=-1)
</code></pre>
<p>should give you the result you are looking for</p>
<p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.unstack.html#pandas.DataFrame.unstack" rel="nofollow noreferrer">Source</a></p>
</div>
<div class="post-text" itemprop="text">
<p>you need <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.crosstab.html" rel="nofollow noreferrer">pd.crosstab</a></p>
<pre><code>import numpy as np
pd.crosstab(df['Month'],df['StartAt'],values=df['WorksDone'],aggfunc=np.mean).reset_index(drop=True)

out[]:
StartAt 2017-1  2017-2
0       1000.0  800.0
1       1000.0  800.0
2       1000.0  800.0
3       800.0   800.0
4       800.0   800.0
5       800.0   NaN
</code></pre>
</div>
<span class="comment-copy">Hi The result looks strange, also it becomes series. The result has 1 to 10 in first column and the second column has 0,1,2,3,4,5,0,1,2,3,4, 2017-1, 2017-1, 2017-1, 2017-1, 2017-1, 2017-1, 2017-2, 2017-2, 2017-2, 2017-2, 2017-2, 1000,1000,1000, 800, 800, 800, 800, 800, 800, 800, 800</span>
