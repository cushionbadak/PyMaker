<div class="post-text" itemprop="text">
<p>I have many files in a directory, like <code>['FredrikstadAvst1.dbf', 'FredrikstadAvst2.dbf', ...]</code>. I want to write a Python script to concatenate these files into a new <code>"*.dbf"</code> file.</p>
<p>I have a Python script that almost does the job. But on the output file it overwrites all the time. So when the job is finished the output file only containes of the last file that is in my directory.</p>
<p>Here is my script:</p>
<pre><code>import os, glob, shutil

folder_path = r'C:\Tom\Oppdrag_2019\Pendle\2018'
for filename in glob.glob(os.path.join(folder_path, '*.dbf')):

    fd = open(filename, 'r')

    List = []
    List.append(fd)

    print filename
wfd = open(r"C:\Tom\Oppdrag_2019\Pendle\FredrikstadAvst.dbf",'a')
shutil.copyfileobj(fd, wfd, 1024*1024*10)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Consider the following:</p>
<pre><code>import os, glob, shutil

folder_path = r'C:\Tom\Oppdrag_2019\Pendle\2018'
wfd = open(r"C:\Tom\Oppdrag_2019\Pendle\FredrikstadAvst.dbf",'w')
for filename in glob.glob(os.path.join(folder_path, '*.dbf')):
    fd = open(filename, 'r')
    shutil.copyfileobj(fd, wfd, 1024*1024*10)
    fd.close()
wfd.close()
</code></pre>
<p>By opening the file before the loop and closing only after iterating over every dbf file, it shouldn't overwrite. I removed the <code>List</code> (which is a reserved keyword so try not to use it) because I can't see what it's being used for here.</p>
</div>
<div class="post-text" itemprop="text">
<p>Almost work now. But the header writes for every file. I just want the header to write the first time. How to skip the header for each time ?</p>
</div>
<span class="comment-copy">Use the <code>a</code> mode for appending to existing file.</span>
<span class="comment-copy">You can't just append dbf files like that, it's not just a bag of bytes</span>
<span class="comment-copy">@HongOoi Oh, perhaps the <code>dbf</code> library could be helpful then</span>
<span class="comment-copy">it's not working with a mode instead of wb. It still overwrites.</span>
<span class="comment-copy">And what would that be?</span>
<span class="comment-copy">It writes everything to a file. But it looks like it's something wrong with the format. When i opens the file in Excel it's no system in the file. I could send a picture, but i don't know how to post a picture here.</span>
<span class="comment-copy">@user15888 you can't append stuff willy-nilly to a dbf file. It doesn't work that way. You have to read the data from each file into a table, then write that table out into a new file.</span>
<span class="comment-copy">Almost work now. But the header writes for every file. I just want the header to write the first time. How to skip the header for each time ?</span>
