<div class="post-text" itemprop="text">
<p>I have a csv file that I'm converting in a panda in <code>Python 3.7</code>. I want then to check if certain cells have <code>NaN</code>(i.e. there are empty in my case) and only in this case, I want to replace the content of the cell with another value. </p>
<p>I'm selecting the cell with values inside other cells in other columns (columns <code>family_name</code> and <code>first_name</code>) on the same row. Here is a <code>MWE</code>:</p>
<pre><code>import csv
import pandas as pd
import numpy as np
df = pd.DataFrame({"family_name":["smith", "duboule", "dupont"], "first_name":["john","jean-paul", "luc"], "weight":[70, 85, pd.np.nan]})
value_to_replace = 90
if df["weight"][(df["family_name"] == "dupont") &amp; (df["first_name"] == "luc")] == pd.np.nan:
    df["weight"][(df["family_name"] == "dupont") &amp; (df["first_name"] == "luc")] = value_to_replace
</code></pre>
<p>I get the following error:</p>
<pre><code>Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/Users/mymac/anaconda3/lib/python3.7/site-packages/pandas/core/generic.py", line 1576, in __nonzero__
    .format(self.__class__.__name__))
ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
</code></pre>
<p>I also tried the to add <code>.bool() == True</code> in the following form but I got the same error message: </p>
<pre><code>if pd.isna(df["weight"][(df["family_name"] == family_name) &amp; (df["first_name"] == first_name)]).bool() == True:
    df["weight"][(df["family_name"] == "dupont") &amp; (df["first_name"] == "luc")] = value_to_replace
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html" rel="nofollow noreferrer"><code>np.where</code></a></p>
<p>Works like following: <code>np.where(condition, true value, false value)</code></p>
<pre><code>df['weight'] = np.where((df.family_name == 'dupont') &amp; (df.first_name == 'luc'), value_to_replace, df.weight)

print(df)
  family_name first_name  weight
0       smith       john    70.0
1     duboule  jean-paul    85.0
2      dupont        luc    90.0
</code></pre>
<p><strong>Edit after OP's comment</strong><br/>
Only if weight is <code>NaN</code>, you can use <code>.isnull</code>:</p>
<pre><code>df['weight'] = np.where((df.family_name == 'dupont') &amp; (df.first_name == 'luc') &amp; (df.weight.isnull()), value_to_replace, df.weight)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>remove all your if statement, and use this</p>
<pre><code>df.loc[ (df["family_name"] == "dupont") &amp; 
        (df["first_name"] == "luc") &amp; 
        (df["weight"].isnull()), 'weight'] = value_to_replace
</code></pre>
<p>I suggest you to read the <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.loc.html" rel="nofollow noreferrer">pandas API</a> to learn how <code>loc</code> select/edit data</p>
</div>
<span class="comment-copy">this is a <code>Series</code>: <code>df["weight"][(df["family_name"] == "dupont") &amp; (df["first_name"] == "luc")]</code>. The error message is pretty straightforward, and suggests several ways to avoid the error.</span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/36921951/truth-value-of-a-series-is-ambiguous-use-a-empty-a-bool-a-item-a-any-o">Truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all()</a></span>
<span class="comment-copy">Thank you for your comment @DavidZemens. I saw those posts already but couldn't find an answer to the problem. I'll be very thankful If you can give a straightforward answer to the <code>MWE</code></span>
<span class="comment-copy">Unclear what you're asking. Have you tried any of the recommendations from the error message? Also, unclear why you state "I want then to check if certain cells have NaN", but that's not actually what you seem to be doing in example code.</span>
<span class="comment-copy">I mean, you could miss all this stuff and just to <code>df['weight'].fillna(value_to_replace, inplace=True)</code> if you simply want to replace the <code>NaN</code> weight values.</span>
<span class="comment-copy">Many thanks for your answer @Erfan. The code was not clear and I edited it. First, I want to check if the content of the Cell is <code>NaN</code>. Only if it is the case I want to replace it</span>
<span class="comment-copy">@ecjb See edit, this should work.</span>
<span class="comment-copy">Many thanks for your anwer @Erfan</span>
<span class="comment-copy">Thank you for your answer @Terry. The code was not clear and I edited it. First, I want to check if the content of the Cell is NaN. Only if it is the case I want to replace it with the value</span>
<span class="comment-copy">@ecjb see the edit</span>
<span class="comment-copy">Many thanks for your anwer @Terry. I upvoted your answer</span>
