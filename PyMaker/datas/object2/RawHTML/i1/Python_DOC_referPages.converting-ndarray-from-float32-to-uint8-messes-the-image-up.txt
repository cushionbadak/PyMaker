<div class="post-text" itemprop="text">
<p>Following <a href="https://github.com/fchollet/deep-learning-with-python-notebooks/blob/master/5.4-visualizing-what-convnets-learn.ipynb" rel="nofollow noreferrer">this blog</a> I am trying to apply heatmap to the original image.</p>
<p>However I have a problem converting float32 to uint8. Before converting to uint8 if I save the image with:</p>
<pre><code>plt.imshow(heatmap)
plt.savefig(f'{directory}/heatmap.png', bbox_inches='tight', pad_inches=0.0)
</code></pre>
<p>will output this image: </p>
<p><a href="https://i.stack.imgur.com/55Fyc.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/55Fyc.png"/></a></p>
<p>After the line <code>heatmap = np.uint8(255 * heatmap)</code>I save the image again and get the following output:</p>
<p><a href="https://i.stack.imgur.com/gjcC6.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/gjcC6.png"/></a></p>
<p>The shape of image in both cases is <code>(600, 600)</code>. So how can I get 2nd image to be the same as 1st after using uint8?</p>
</div>
<div class="post-text" itemprop="text">
<p>You have only negative values in <code>heatmap</code>. Since <code>uint8</code> can only hold numbers between <code>0</code> and <code>255</code> the line <code>heatmap = np.uint8(255 * heatmap)</code> will only work as intended if the original values of <code>heatmap</code> are lying between <code>0.</code> and <code>1.</code>.</p>
<p>Solution:<br/>
Rescale the array to the range of <code>[0,255]</code> before casting it to <code>uint8</code>:</p>
<pre><code>heatmap = np.uint8(np.interp(heatmap, (heatmap.min(), heatmap.max()), (0, 255)))
</code></pre>
</div>
<span class="comment-copy">When I try it, everything works fine. Can you post the full code you used?</span>
<span class="comment-copy">Funnily, after your comment I tried it on np.random.rand(32, 32) and the it worked ok. However I dumped my ndarray into .npy file where I get the same results. Link:<a href="https://ufile.io/gq308" rel="nofollow noreferrer">ufile.io/gq308</a>"</span>
