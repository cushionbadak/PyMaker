<div class="post-text" itemprop="text">
<p>Stuck on something and hoping to get some ideas on what I'm doing wrong here.  I have written out a web scraping program that scrapes all web links from the census.gov website but when I try to write my results out to a csv file, I am only getting one of the links to write out instead of the full list.  See code below.  To ensure my set was pulling correctly, I added in a line of code that first printed the results of my set and then goes into writing out the results in csv.  The initial results look correct, as I'm seeing a full list of links.  However, I am not sure why I am only able to write out one row of data to excel csv:</p>
<pre><code>import requests
from bs4 import BeautifulSoup, SoupStrainer
import bs4, csv
search_link = "https://www.census.gov/programs-surveys/popest.html"
search = requests.get(search_link).text
raw_html = search
soup = BeautifulSoup(raw_html, 'html.parser')
import re
links = soup.find_all('a', {'class': re.compile('uscb*')})
urls_set = set()
for link in links:
    my_links = link.get("href")
    if my_links not in urls_set:
        urls_set.add(my_links)
        print(my_links)
with open("Current Estimate Result.csv",'wb') as f:
         cw = csv.writer(f)
         cw.writerows(my_links)
         print(my_links)        
         f.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The issue is that the <code>my_links</code> variable holds the last read URL. So <code>cw.writerows(my_links)</code> writes out just that URL and not all of the URLs - which are actually stored in <code>urls_set</code>.</p>
<p>However, I'm not sure your usage of the <code>writerows()</code> method is entirely correct. <a href="https://docs.python.org/2/library/csv.html#csv.csvwriter.writerows" rel="nofollow noreferrer">This method expects an iterator of row objects</a> (typically a list of lists). Each nested list represents a row in the CSV file. </p>
<p>So it may be better to hold the URLs in a list rather than a set, and then wrap each URL in it's own list (row) before adding. For example:</p>
<pre><code>urls_list = []
for link in links:
    my_link = [link.get("href")]  # A row in the csv
    if my_link not in urls_list:
        urls_list.append(my_link)

    ...
    cw.writerows(urls_list)  # Pass the overall list
</code></pre>
<p>Note I renamed <code>my_links</code> to <code>my_link</code> in the example above. Using a list would also ensure that the order would be preserved.</p>
</div>
<span class="comment-copy">Add an csv output please</span>
<span class="comment-copy">So I added "cw = csv.DictWriter(f,fieldnames='',restval='', extrasaction='ignore', dialect='excel')" to the one line but still only seeing the one row of data when I print the value of "my_links"</span>
<span class="comment-copy">I refered to the output you're getting now</span>
<span class="comment-copy">This helped.  Thanks a lot</span>
