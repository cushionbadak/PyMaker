<div class="post-text" itemprop="text">
<p>How to write a text with <code>merge_range</code> using Xlsxwriter in python and put a hyperlink without change the cell format defined at</p>
<pre><code>wks.merge_range(, , , ,  'text', format)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If the url is one of the standard one recognised by <code>write()</code> then <code>merge_range()</code> will turn it into a hyperlink. The format will be whatever you define:</p>
<pre><code>import xlsxwriter

# Create an new Excel file and add a worksheet.
workbook = xlsxwriter.Workbook('merge_url.xlsx')
worksheet = workbook.add_worksheet()

# Set up a formats to use.
cell_format = workbook.add_format({'align': 'center',
                                   'color': 'blue',
                                   'underline': 1,
                                   'valign': 'vcenter',
                                   'border': 1})

worksheet.merge_range('B2:E5', 'https://www.python.org/', cell_format)

workbook.close()
</code></pre>
<p>Output:</p>
<p><a href="https://i.stack.imgur.com/hJ1hF.png" rel="nofollow noreferrer"><img alt="merged url" src="https://i.stack.imgur.com/hJ1hF.png"/></a></p>
<p>If you want to have a link but with alternative text you can overwrite the first cell of the range with the text and same format like this:</p>
<pre><code>worksheet.write_url('B2', 'https://www.python.org/', cell_format, 'text')
</code></pre>
<p>Output:</p>
<p><a href="https://i.stack.imgur.com/JT4b0.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/JT4b0.png"/></a></p>
</div>
<span class="comment-copy">Works fine. Just the presentation at LibreOffice 6.1 appear wrong. This issue was reported to the develop team.</span>
