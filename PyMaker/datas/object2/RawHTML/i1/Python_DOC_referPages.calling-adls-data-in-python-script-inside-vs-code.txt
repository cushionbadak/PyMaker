<div class="post-text" itemprop="text">
<p>I already installed the ADL extension in VS code and now i am writing a Python script, where i need to read a csv file present in Azure Data Lake Storage (ADLS Gen1). 
For local file the following code is working: </p>
<pre><code>df = pd.read_csv(Path('C:\\Users\\Documents\\breslow.csv')) 
print (df)
</code></pre>
<p>How i can read data from ADLS?
Even after successful installation and connection(with my Azure account) of ADL extension do i still need to go for creating a scope and secret and all ? </p>
</div>
<div class="post-text" itemprop="text">
<p>I tried to write a sample code to read data from a csv file in Azure Data Lake to a dataframe in pandas.</p>
<p>Here is my sample code as below.</p>
<pre><code>from azure.datalake.store import core, lib, multithread
import pandas as pd

tenant_id = '&lt;your Azure AD tenant id&gt;'
username = '&lt;your username in AAD&gt;'
password = '&lt;your password&gt;'
store_name = '&lt;your ADL name&gt;'
token = lib.auth(tenant_id, username, password)
# Or you can register an app to get client_id and client_secret to get token
# If you want to apply this code in your application, I recommended to do the authentication by client
# client_id = '&lt;client id of your app registered in Azure AD, like xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxx'
# client_secret = '&lt;your client secret&gt;'
# token = lib.auth(tenant_id, client_id=client_id, client_secret=client_secret)

adl = core.AzureDLFileSystem(token, store_name=store_name)
f = adl.open('&lt;your csv file path, such as data/test.csv in my ADL&gt;')
df = pd.read_csv(f)
</code></pre>
<p>Note: If you were using <code>client_id</code> &amp; <code>client_secret</code> for authentication, you must add the necessary access permission for the app which has <code>Reader</code> role at least in Azure AD, as the figures below. For more information about accessing security, please see the offical document <a href="https://docs.microsoft.com/en-us/azure/data-lake-store/data-lake-store-security-overview" rel="nofollow noreferrer"><code>Security in Azure Data Lake Storage Gen1</code></a>. Meanwhile, about how to register an app in Azure AD, you can refer to my answer for the other SO thread <a href="https://stackoverflow.com/questions/54760786/how-to-get-an-azureratecard-with-java/54784589#54784589">How to get an AzureRateCard with Java?</a>.</p>
<p><a href="https://i.stack.imgur.com/FN1if.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/FN1if.png"/></a></p>
<p><a href="https://i.stack.imgur.com/3SVXS.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/3SVXS.png"/></a></p>
<p>Any concern, please feel free to let me know.</p>
</div>
<div class="post-text" itemprop="text">
<p>Here is the sample code for reading csv file from ADLS.</p>
<pre><code># -*- coding: utf-8 -*-
"""
Created on Wed Mar 20 11:37:19 2019

@author: Mohit Verma
"""

from azure.datalake.store import core, lib, multithread
token = lib.auth(tenant_id, username, password)
adl = core.AzureDLFileSystem(token, store_name=store_name)

# typical operations
adl.ls('')
adl.ls('tmp/', detail=True)
adl.ls('tmp/', detail=True, invalidate_cache=True)
adl.cat('littlefile')
adl.head('gdelt20150827.csv')

# file-like object
with adl.open('gdelt20150827.csv', blocksize=2**20) as f:
    print(f.readline())
    print(f.readline())
    print(f.readline())
    # could have passed f to any function requiring a file object:
    # pandas.read_csv(f)

with adl.open('anewfile', 'wb') as f:
    # data is written on flush/close, or when buffer is bigger than
    # blocksize
    f.write(b'important data')

adl.du('anewfile')

# recursively download the whole directory tree with 5 threads and
# 16MB chunks
multithread.ADLDownloader(adl, "", 'my_temp_dir', 5, 2**24)
</code></pre>
<p>Please try this code and see if it helps.For other samples related to Azure Data Lake please refer to below github repo.</p>
<p><a href="https://github.com/Azure/azure-data-lake-store-python/tree/master/azure" rel="nofollow noreferrer">https://github.com/Azure/azure-data-lake-store-python/tree/master/azure</a></p>
<p>Also if you want to understand different type of authentication in ADLS, please check the below code base.</p>
<p><a href="https://github.com/Azure-Samples/data-lake-analytics-python-auth-options/blob/master/sample.py" rel="nofollow noreferrer">https://github.com/Azure-Samples/data-lake-analytics-python-auth-options/blob/master/sample.py</a></p>
</div>
<span class="comment-copy">Hi @Peter_Pan, first of all thank you so much for your detailed reply. Actually when i use code mentioned by you without using client_id and client secret, Ie. only this part  tenant_id = '&lt;your Azure AD tenant id&gt;' username = '&lt;your username in AAD&gt;' password = '&lt;your password&gt;' store_name = '&lt;your ADL name&gt;' token = lib.auth(tenant_id, username, password) i am getting this error : Failed to establish a new connection: [WinError 10060] currently i don't have access to AAD that's why i choosed this way :-(</span>
<span class="comment-copy">@LavMehta Fine, it's up to your real scenario. Whatever you used, to make it works fine is important first. If my answer helps, could you mark it as answer?</span>
<span class="comment-copy">Actually i am getting an error : Failed to establish a new connection: [WinError 10060]  when i execute this line to be specific: token = lib.auth(tenant_id, username, password).  and i tried marking your answer as useful but it shows : thanks for the feedback! Votes cast by those with less than 15 reputation are recorded, but do not change the publicly displayed post score. Sorry i think i need more reputation :-))</span>
<span class="comment-copy">Hi @Mohit Verma, thanks for the detailed code, All the typical operations and other commands would be helpful only after i have successful access. After 3rd line of your code i am getting some proxy error "Failed to establish a new connection: [WinError 10060] ". could you help me with that?.</span>
<span class="comment-copy">By looking at the error code, seems a proxy related issue.</span>
<span class="comment-copy">This basically means that no response (either positive or negative) was received from the remote host when the TCP connection attempt took place. One reason this may happen is because a firewall is blocking the response from the server.  Another reason is that the host name is incorrect.  This could also mean there is a (temporary) problem with the server (or some router along the way). You can try a traceroute to determine whether or not this is true.</span>
