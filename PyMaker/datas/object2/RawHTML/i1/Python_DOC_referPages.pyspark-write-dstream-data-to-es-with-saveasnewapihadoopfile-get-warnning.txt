<div class="post-text" itemprop="text">
<p>This is my code:</p>
<pre><code>  es_write_conf = {
     ¦   "es.nodes" : ES_IP,
     ¦   "es.port" : ES_PORT,
     ¦   "es.resource" : "%s/%s" % (index, doc_type),
     ¦   "es.input.json": "true",
     ¦   # "es.mapping.rich.date": "true"
     ¦   # "es.mapping.id": "guid"
     }

     dstream.foreachRDD(lambda es_rdd: es_rdd.saveAsNewAPIHadoopFile(
     ¦   path="-",
     ¦   outputFormatClass="org.elasticsearch.hadoop.mr.EsOutputFormat",
     ¦   keyClass="org.apache.hadoop.io.NullWritable",
     ¦   valueClass="org.elasticsearch.hadoop.mr.LinkedMapWritable",
     ¦   conf=es_write_conf))
</code></pre>
<p>and I got this warnning</p>
<pre><code>WARN EsOutputFormat: Speculative execution enabled for reducer - consider disabling it to prevent data corruption
</code></pre>
<p>How can I solve this warning?</p>
</div>
<div class="post-text" itemprop="text">
<p>I solve the problem by this</p>
<pre><code>     es_write_conf = {
     ¦   "es.nodes" : ES_IP,
     ¦   "es.port" : ES_PORT,
     ¦   "es.resource" : "%s/%s" % (index, doc_type),
     ¦   "es.input.json": "true",
     ¦   "mapred.reduce.tasks.speculative.execution": "false",
     ¦   "mapred.map.tasks.speculative.execution": "false",
     ¦   # "es.mapping.rich.date": "true"
     ¦   # "es.mapping.id": "guid"
     }

     dstream.foreachRDD(lambda es_rdd: es_rdd.saveAsNewAPIHadoopFile(
     ¦   path="-",
     ¦   outputFormatClass="org.elasticsearch.hadoop.mr.EsOutputFormat",
     ¦   keyClass="org.apache.hadoop.io.NullWritable",
     ¦   valueClass="org.elasticsearch.hadoop.mr.LinkedMapWritable",
     ¦   conf=es_write_conf))
</code></pre>
</div>
<span class="comment-copy">Welcome to StackOverflow! What means those ` ¦` symbols in code?</span>
<span class="comment-copy">Thanks,this code I copied from vim， ` ¦` just used to align :)</span>
