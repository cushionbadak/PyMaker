<div class="post-text" itemprop="text">
<p>I want to get only best 5 names with highest number of matches in intersection. how would I do that ? or in other words sort the matches in order(max to min) and keep only first five matches</p>
<pre><code># Sample Data
df = pd.DataFrame({'description': ['d1', 'd2', 'd3', 'd4', 'd5','d6'], 
                   'specialties': ['s1,s2,s3', 's3,s4,s5,s6', 's5,s6,s7','s3,s4,s5,s65','s35,s45,s5f,s6','s33,s4,s5,s6,s7']}, 
                   index=['name1', 'name2', 'name3','name4','name5','name6'])

# Sample Input
name_lookup = 'name3'

tgt_set = set(df.loc[name_lookup, 'specialties'].split(','))
intersection = df['specialties'].str.split(',').apply(lambda x: tgt_set.intersection(x))
match = intersection != set() # Remove companies with 0 matches

# Output:  
intersection[match] # will deliver the specialties they have in common   
df[match] # will return the data only on the ones that have at lest one specialty in common
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use:</p>
<pre><code>#s = intersection[intersection != set()] 
#alternative
s = intersection[intersection.astype(bool)]
n = s.str.len().sort_values(ascending=False).index[:5]
print (n)
Index(['name6', 'name3', 'name2', 'name5', 'name4'], dtype='object')
</code></pre>
<p>For DataFrame use:</p>
<pre><code>dftop5 = df.loc[n]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This will deliver the data for the top 5:</p>
<pre><code>df.loc[intersection.apply(len).sort_values().tail(5).index]
</code></pre>
</div>
<span class="comment-copy">Your solution not working? What is expected output?</span>
<span class="comment-copy">I want a dataframe in result having entries with maximum matches</span>
<span class="comment-copy">yes, I think what is expected data in numbers, explanation is already in question, but I cannot verify if understand what you need.</span>
<span class="comment-copy">I want a dataframe in result having entries with maximum matches</span>
<span class="comment-copy">Use <code>dftop5 = df.loc[n]</code></span>
<span class="comment-copy">I want a dataframe in result having entries with maximum matches</span>
