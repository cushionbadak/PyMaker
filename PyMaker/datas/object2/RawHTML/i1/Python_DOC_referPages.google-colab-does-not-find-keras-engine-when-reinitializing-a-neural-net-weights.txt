<div class="post-text" itemprop="text">
<p>I need to create a simple model of Neural net with small number of nodes, to train it and then to evaluate certain parameters in the resulting already trained network. </p>
<p>I need to repeat this several times(&gt;100). Thus, I just want to reinitialize the weights instead of creating a new model every single time.</p>
<p>Here is the problematic part of my code:</p>
<pre><code> import tensorflow as tf
 from tensorflow import keras
 from keras import backend as K

 def reinitLayers(model):
     session = K.get_session()
     for layer in model.layers: 
         if isinstance(layer,keras.engine.network.Network):
             reinitLayers(layer)
....
</code></pre>
<p>This is what I am getting:</p>
<pre><code> "module 'tensorflow._api.v1.keras' has no attribute 'engine'"
</code></pre>
<p>However there exist keras.engine:
<a href="https://github.com/tensorflow/tensorflow/tree/master/tensorflow/python/keras/engine" rel="nofollow noreferrer">https://github.com/tensorflow/tensorflow/tree/master/tensorflow/python/keras/engine</a></p>
<p>Very similar question is this one:
<a href="https://stackoverflow.com/questions/51186448/attributeerror-module-keras-engine-has-no-attribute-input-layer/55250831#55250831">AttributeError: module 'keras.engine' has no attribute 'input_layer'</a>
However, the answer there doesn't help me.</p>
<p>The same issue is described here, but the thread there does not help either:
<a href="https://github.com/keras-team/keras/issues/341" rel="nofollow noreferrer">https://github.com/keras-team/keras/issues/341</a></p>
</div>
<div class="post-text" itemprop="text">
<p>Could you not reshuffle the weights and use them instead of reinitializing as mentioned in <a href="https://github.com/keras-team/keras/issues/341" rel="nofollow noreferrer">https://github.com/keras-team/keras/issues/341</a>? What is the problem with that?</p>
<h2>Update</h2>
<p>I ran the following code </p>
<pre><code>def reinitLayers(model):
    session = K.get_session()
    for layer in model.layers: 
        if isinstance(layer, keras.engine.network.Network):
            reinitLayers(layer)
            continue
        print("LAYER::", layer.name)
        for v in layer.__dict__:
            v_arg = getattr(layer,v)
            if hasattr(v_arg,'initializer'):
                initializer_method = getattr(v_arg, 'initializer')
                initializer_method.run(session=session)
                print('reinitializing layer {}.{}'.format(layer.name, v))
</code></pre>
<p>(given at <a href="https://github.com/keras-team/keras/issues/341#issuecomment-423637768" rel="nofollow noreferrer">https://github.com/keras-team/keras/issues/341#issuecomment-423637768</a>) on google colab. It worked both with and without GPU, and I was able to reinitialize the network. In other words, I could not reproduce your error. Double check that you used this code, and try running it again. </p>
</div>
<span class="comment-copy">i want to repeat the same experiment multiple times. Reshuffling might bias the results</span>
<span class="comment-copy">I am getting the same mistake with PyCharm on my PC</span>
