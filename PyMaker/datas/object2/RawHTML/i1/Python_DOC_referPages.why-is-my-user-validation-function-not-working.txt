<div class="post-text" itemprop="text">
<p>The users of my app have access to some pdf files in a directory /static/pdf/ with subdirectories for several stations like station1, station2 a.s.o . If a user tries to access the files the function checks if the user has the neccessary rights to open files for said station before opening the pdf. This all works like intended if the user is just clicking on the links in my app. But if a user has already opened a pdf and now enters a path to another file manually the function does not do the redirect as intended. I can see that the function starts to confirm the access rights in those cases but the if b not in rights: part does not work. If the user is clicking on the link in my app the function works without a problem. What am i doing wrong?</p>
<pre><code>@app.route('/static/pdf/&lt;stationname&gt;/&lt;username&gt;/&lt;filename&gt;')
@login_required
def filecheck(stationname, username, filename):
rights = session['rights']
access = Station.query.filter(Station.stationname==stationname)
for a in access:
    b=a.id
if b not in rights:
    flash('Access denied')
    return redirect(url_for('data'))
return None
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You are looping over access (for a in access) and you chenage the value of b every iteration (b=a.id). After that you check if b not in rights. You only check against the last element of the access sequence. Is that what you mean to do?</p>
</div>
<span class="comment-copy">access is allways just one dataset from my database for the station in question so basically its allways just one iteration. I need the loop to get the id though. The whole function works as intended if a user sticks to the links in my app. It just doesnt work though if the user tries to trick the system and enters the url to his file manually.</span>
