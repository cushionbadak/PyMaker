<div class="post-text" itemprop="text">
<p>Given the following dataframe:</p>
<pre><code>df = pd.DataFrame({"values": ["a", "a", "a", "b", "b", "a", "a", "c"]})
</code></pre>
<p>How could I generate the given output:</p>
<pre><code>  values  out
0      a    0
1      a    1
2      a    2
3      b    0
4      b    1
5      a    0
6      a    1
7      c    0
</code></pre>
<p>I can (if it allows easier options) ensure uniqueness over groups, hence having input values like:</p>
<pre><code>df = pd.DataFrame({"values": ["a0", "a0", "a0", "b0", "b0", "a1", "a1", "c0"]})
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Using <code>shift</code> and <code>cumsum</code> create the key , then we using <code>category</code> </p>
<pre><code>df['strkey']=(df['values']!=df['values'].shift()).ne(0).cumsum()

df['values']+=df.groupby('values')['strkey'].apply(lambda x : x.astype('category').cat.codes.astype(str))
df
Out[568]: 
  values  strkey
0     a0       1
1     a0       1
2     a0       1
3     b0       2
4     b0       2
5     a1       3
6     a1       3
7     c0       4
</code></pre>
</div>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/25119524/pandas-conditional-rolling-count">Pandas: conditional rolling count</a></span>
