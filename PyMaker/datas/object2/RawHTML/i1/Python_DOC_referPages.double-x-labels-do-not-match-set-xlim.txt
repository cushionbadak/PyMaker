<div class="post-text" itemprop="text">
<p>I would like to plot two twiny x axis, according to <a href="https://pythonmatplotlibtips.blogspot.com/2018/01/add-second-x-axis-below-first-x-axis-python-matplotlib-pyplot.html" rel="nofollow noreferrer">https://pythonmatplotlibtips.blogspot.com/2018/01/add-second-x-axis-below-first-x-axis-python-matplotlib-pyplot.html</a></p>
<p>My original data is 
<a href="https://i.stack.imgur.com/NQadN.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/NQadN.png"/></a></p>
<p>My code :</p>
<pre><code>fig, ax = plt.subplots(figsize=(15,5))
index = data.coin
rects1 = ax.bar(index, data['message_count'])
ax.set_xlabel('Group')
ax.set_ylabel('message count')
ax.set_title('')
ax.legend()

ax2 = ax.twiny()
ax2.set_xticklabels(data.create_date)
ax2.xaxis.set_ticks_position('bottom') # set the position of the second x-axis to bottom
ax2.xaxis.set_label_position('bottom') # set the position of the second x-axis to bottom
ax2.spines['bottom'].set_position(('outward', 38))
ax2.set_xlabel('Create Date')
ax2.set_xlim(ax.get_xlim())
</code></pre>
<p>The plot I have:
<a href="https://i.stack.imgur.com/q2DMz.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/q2DMz.png"/></a></p>
<p>I dont know why the second axis does not match with the first one. I have tried adjusting the <code>ax2.set_xlim(ax.get_xlim())</code> but in vain.</p>
</div>
<div class="post-text" itemprop="text">
<p>Setting the x limit on the second axes objecct also changes the default x-tick positions for that axes. You can find how by printing <code>ax2.get_xticks()</code> before and after the <code>ax2.set_xlim(ax.get_xlim())</code> call.</p>
<p>You need to explicitly (re)set the x-tick positions once you change the x-limit, with <code>ax2.set_xticks()</code>, and set them to those for <code>ax</code>.</p>
<p>Below is a full example:</p>
<pre><code>import pandas as pd
import matplotlib.pyplot as plt

df = pd.DataFrame({'message_count': [557, 119, 108, 14, 9],
                   'coin': ['MEDX', 'CNX', 'IOST', 'AUTO', 'PPT'],
                   'create_date': ['2018-08-03 03:05:00',
                                   '2017-08-10 14:33:45',
                                   '2018-07-20 18:32:45',
                                   '2017-12-08 15:09:42',
                                   '2017-07-24 14:11:22']})
df['create_date'] = pd.to_datetime(df['create_date'])
print(df)

fig, ax = plt.subplots(figsize=(15,5))
index = df.coin
rects1 = ax.bar(index, df['message_count'])
ax.set_xlabel('Group')
ax.set_ylabel('message count')
ax.set_title('')
ax.legend()

ax2 = ax.twiny()
ax2.set_xticklabels(df.create_date)
ax2.xaxis.set_ticks_position('bottom') # set the position of the second x-axis to bottom
ax2.xaxis.set_label_position('bottom') # set the position of the second x-axis to bottom
ax2.spines['bottom'].set_position(('outward', 38))
ax2.set_xlabel('Create Date')
ax2.set_xlim(ax.get_xlim())
ax2.set_xticks(ax.get_xticks())
plt.tight_layout()
plt.savefig('twinplot.png')
</code></pre>
<p>which yields</p>
<p><a href="https://i.stack.imgur.com/GMJdE.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/GMJdE.png"/></a></p>
</div>
<span class="comment-copy">What do you mean by "I dont know why the second axis does not match with the first one."? They are matching perfectly and the ticks are aligned on top of each other. What output are you expecting?</span>
<span class="comment-copy">@Bazingaa The bottom labels are all shifted one position to the left. Compare the input table with the two sets of plot labels. That is also why the last item doesn't have a date label.</span>
<span class="comment-copy">@9769953 Exactly!</span>
<span class="comment-copy">Please make sure you create a <i>full</i> working example, including imports <i>and data</i>. The picture of your table 1/ is hard to read, 2/ is not copy-pasteable, 3/ is not copy-pasteable into a DataFrame, 4/ contains extra, unnecessary and distracting columns (such as two index columns, while in the code the "coin" column is used as index.</span>
