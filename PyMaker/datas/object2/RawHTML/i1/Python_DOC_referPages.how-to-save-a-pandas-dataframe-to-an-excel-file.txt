<div class="post-text" itemprop="text">
<p>I am trying to load data from the web source and save it as a Excel file but not sure how to do it. What should I do?</p>
<pre><code>import requests
import pandas as pd
import xmltodict


url = "https://www.kstan.ua/sitemap.xml"
res = requests.get(url)
raw = xmltodict.parse(res.text)

data = [[r["loc"], r["lastmod"]] for r in raw["urlset"]["url"]]
print("Number of sitemaps:", len(data))
df = pd.DataFrame(data, columns=["links", "lastmod"])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>df.to_csv("output.csv", index=False)
</code></pre>
<p>OR</p>
<pre><code>df.to_excel("output.xlsx")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use DataFrame.to_excel(). See detailed in <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_excel.html" rel="nofollow noreferrer">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_excel.html</a></p>
</div>
<div class="post-text" itemprop="text">
<p>You can write the dataframe to excel using the pandas <a href="http://pandas-docs.github.io/pandas-docs-travis/reference/api/pandas.ExcelWriter.html" rel="nofollow noreferrer">ExcelWriter</a>, such as this:</p>
<pre><code>import pandas as pd
with pd.ExcelWriter('path_to_file.xlsx') as writer:
    dataframe.to_excel(writer)
</code></pre>
</div>
<span class="comment-copy">Assuming that you don't have the any issues with reading in the XML all you have to do is: <code>df.to_excel('out.xlsx')</code> to learn more about <code>DataFrame.to_excel</code> go to:    to learn more about I/O for pandas dataframes visit: <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.to_excel.html#pandas.DataFrame.to_excel" rel="nofollow noreferrer">pandas.pydata.org/pandas-docs/stable/reference/api/…</a> <a href="https://pandas.pydata.org/pandas-docs/stable/reference/frame.html#serialization-io-conversion" rel="nofollow noreferrer">pandas.pydata.org/pandas-docs/stable/reference/…</a></span>
