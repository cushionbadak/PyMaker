<div class="post-text" itemprop="text">
<p>Suppose i have these 2 dataframes:</p>
<pre><code>a = pd.DataFrame(columns = ['a','b'], data = [[1,2],[3,4], [5,6],[7,8]])
b = pd.DataFrame(columns = ['a','b'], data = [[1,2],[7,4], [9,6],[11,8]])
</code></pre>
<p>What i want to do is to compare each element of <code>a</code> with each element of <code>b</code> and if there's a match, then add +1 to the counter, if there isn't a match, i want to append the unmatched row to the empty dataframe above.</p>
<p>This is my code so far:</p>
<pre><code>counter = 0
counts = pd.DataFrame()

for i, j in a.iterrows():
    for a, row in b.iterrows():

        if a[j] == b[row]:
            counter += 1

        else:

            counts = counts.append(a[row])
</code></pre>
<p>when i run it, i get into this error:</p>
<p><code>TypeError: 'int' object is not subscriptable</code></p>
<p>How could i get this done and fix this error?</p>
<p>Thank you</p>
</div>
<div class="post-text" itemprop="text">
<p>You can simple using <code>merge</code> with <code>indicator</code></p>
<pre><code>s=a.merge(b,indicator=True,how='outer')
s
Out[481]: 
    a  b      _merge
0   1  2        both
1   3  4   left_only
2   5  6   left_only
3   7  8   left_only
4   7  4  right_only
5   9  6  right_only
6  11  8  right_only
</code></pre>
<p>Your count</p>
<pre><code>s['_merge'].eq('both').sum()
Out[482]: 1
</code></pre>
<p>New df</p>
<pre><code>newdf=s.loc[s['_merge']=='right_only',:].copy().drop('_merge',1)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Another approach is use a mask (always avoid <code>for</code> loops in pandas when possible):</p>
<pre><code>m = (a==b).apply(np.all, axis=1)   #assuming you want both elements to be equal
counts = a[~m].copy()
counter = m.sum()
</code></pre>
</div>
<span class="comment-copy">could you also show us the final expected dataframe? Thank you</span>
<span class="comment-copy">Hi, thank you for your answer. It seems to do the job, but, is there a more elegant way to add +1 to the counter?</span>
<span class="comment-copy">@Miguel2488 what you mean add + 1 ? <code>s['_merge'].eq('both').cumsum()</code>, like this  ?</span>
<span class="comment-copy">something more like adding +=1 to the counter variable if the condition is fulfilled</span>
<span class="comment-copy">@Miguel2488 if you do need a counter , you can using for loop with the result after merge , just when the '_merge' is equal to 'both' add 1 to the counter</span>
