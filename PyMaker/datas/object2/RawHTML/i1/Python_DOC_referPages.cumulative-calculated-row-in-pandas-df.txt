<div class="post-text" itemprop="text">
<p>I have a huge pandas df as below </p>
<pre><code>Country  category brand quarter device countA  CountB  percentageA/B
XXX       A1       A2     Q2     PC    12       12       100
XXX       A1       A2     Q2     Tablet 2        4       50 
YYY       A4       A5     Q4     PC     50        50     100
YYY       A4       A5     Q4     Tablet  10       10      100
</code></pre>
<p>I need to add a row to the data which is the sum of above 2 data points</p>
<pre><code>Country  category brand quarter device countA  CountB  percentage(A/B) 
XXX       A1       A2     Q2     PC    12       12       100 % 
XXX       A1       A2     Q2     Tablet 2        4       50 %
**XXX       A1       A2     Q2     PC + Tablet 14  16      87.5%**
YYY       A4       A5     Q4     PC     50        50     100
YYY       A4       A5     Q4     Tablet  10       12     83%
**YYY       A4       A5     Q4     PC+Tablet 60      62        96.7%**
</code></pre>
<p>Please find the structure of d 
So ideally there are few Brands in the category that only have one device </p>
<pre><code>Country       category  brand    quarter         device
XXX           A1           A2       Q2         Tablet +PC
              A4          A5        Q2         Tablet+PC 
              A9          A10       Q2             PC
                          A11       Q1             PC
</code></pre>
<p>print(type(d))</p>
<p></p>
</div>
<div class="post-text" itemprop="text">
<p>use <code>groupby</code> <code>merge</code> and <code>concat</code> Also, you still never mentioned how <code>percentageA/B</code> is calculated</p>
<pre><code># groupby and apply with join to get devices
d = df.groupby(['Country','category','brand','quarter'])['device'].apply('+'.join)
# groupby with sum then merge the two groups together with reset_index
new = df.groupby(['Country','category','brand','quarter']).sum().merge(d, left_index=True, right_index=True).reset_index()
# concat original df with new
pd.concat([df,new], sort=False)

  Country category brand quarter     device  countA  CountB  percentageA/B
0     XXX       A1    A2      Q2         PC      12      12            100
1     XXX       A1    A2      Q2     Tablet       2       4             50
2     YYY       A4    A5      Q4         PC      50      50            100
3     YYY       A4    A5      Q4     Tablet      10      10            100
0     XXX       A1    A2      Q2  PC+Tablet      14      16            150
1     YYY       A4    A5      Q4  PC+Tablet      60      60            200
</code></pre>
<p>or you can try:</p>
<pre><code># groupby and apply with join to get devices
d = df.groupby(['Country','category','brand','quarter'])['device'].apply('+'.join).to_frame().reset_index()
# groupby with sum then merge the two groups together with reset_index
new = df.groupby(['Country','category','brand','quarter'], as_index=False).sum().merge(d, on=['Country','category','brand','quarter'])
# concat original df with new
final_df = pd.concat([df,new], sort=False)
final_df['percentageA/B'] = final_df['countA'] / final_df['CountB'] * 100
</code></pre>
</div>
<span class="comment-copy">We need more information. What have you tried? How are you calculating <code>percentA/B</code>? Look into <code>df.groupby('Country').sum()</code></span>
<span class="comment-copy">I tried exactly the same structure, but it gives me the output in a different format than needed df.groupby(['Country ','category','brand','quarter]).sum()</span>
<span class="comment-copy">The merge gives an error can not merge DataFrame with an instance of type &lt;class 'pandas.core.series.Series'&gt;</span>
<span class="comment-copy">@NehaSharma what version of pandas are you using because it works fine in .24.1; however, try changing <code>d</code> to <code>d.to_frame()</code></span>
<span class="comment-copy">Thanks for the patience, Chris. I am using pandas: 0.23.4. The above suggested still gives the same error</span>
<span class="comment-copy">Can you do <code>print(d.head(10))</code> and <code>print(type(d))</code> and paste the results in your question so I can see what it looks like and add the code you are trying.</span>
<span class="comment-copy">Or you can try the update i added to my answer</span>
