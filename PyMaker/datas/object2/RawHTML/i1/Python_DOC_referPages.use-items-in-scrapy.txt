<div class="post-text" itemprop="text">
<p>I use Scrapy and try to output a json file. It works great when I'm not using item but I'd like to use them.</p>
<p>So my spider code is:</p>
<pre><code>import json
import scrapy
from scrapy.loader import ItemLoader
from ccv_spiders.items import AuctionItem

class GlenMarchSpider(scrapy.Spider):
    name = 'auction_results'

    def __init__(self, *args, **kwargs):
        with open('file.json', encoding='utf-8') as data_file:
            self.data = json.load(data_file)


    def start_requests(self):
        for item in self.data:
            request = scrapy.Request(item['gm_url'], callback=self.parse)
            request.meta['item'] = item
            yield request

    def parse(self, response):
        item = response.meta['item']
        item['results'] = []

        for caritem in response.css("div.car-item-border"):
            loader= ItemLoader(item=AuctionItem(), selector=caritem, response=response)
            item['results'].append({
                loader.add_css("marque", "div.make::text"),
                loader.add_css("model", "div.make::text"),
                loader.add_css("model_year", "div.make::text"),
                loader.add_css("price_str", "div.price::text"),
                loader.add_css("auction_house", "div.auctionHouse::text"),
                loader.add_css("auction_country", "div.auctionHouse::text"),
                loader.add_css("auction_url", "div.view-auction a::attr(href)"),
                loader.add_css("img", "img.img-responsive::attr(src)")
            })
            yield loader.load_item()

        yield item
</code></pre>
<p>My items.py code is:</p>
<pre><code>import scrapy


class AuctionItem(scrapy.Item):
    marque= scrapy.Field()
    model= scrapy.Field()
    model_year= scrapy.Field()
    price_str= scrapy.Field()
    auction_house= scrapy.Field()
    auction_country= scrapy.Field()
    auction_date= scrapy.Field()
    auction_url= scrapy.Field()
    img= scrapy.Field()
</code></pre>
<p>And my Json output:</p>
<pre><code>{
    "objectID": 10000,
    "gm_url": "https://www.glenmarch.com/cars/results/quick/AC/10?unsold=1?limit=9999",
    "results": [
        [null]
    ]
},
{
    "marque": [" 1913 AC 10 hp Light Car "],
    "model": [" 1913 AC 10 hp Light Car "],
    "model_year": [" 1913 AC 10 hp Light Car "],
    "price_str": ["Â£24,150"],
    "auction_house": [" Bonhams - The Beaulieu Sale, Beaulieu, UK "],
    "auction_country": [" Bonhams - The Beaulieu Sale, Beaulieu, UK "],
    "auction_url": ["http://www.bonhams.com/auctions/23594/lot/417/?category=list"],
    "img": ["https://www.glenmarch.com/img/auctions/car/thumb/16-8-29-667feacd0f478172e463f237ba7ee692.jpg"]
}
</code></pre>
<p>But I want the second object inside the result's array and I don't know how to do it...</p>
</div>
<div class="post-text" itemprop="text">
<p>Try to collect your items first, and then yield your result only once:</p>
<pre><code>def parse(self, response):
    item = response.meta['item']
    item['results'] = []

    for caritem in response.css("div.car-item-border"):
        loader = ItemLoader(item=AuctionItem(), selector=caritem, response=response)
        loader.add_css("marque", "div.make::text")
        loader.add_css("model", "div.make::text")
        loader.add_css("model_year", "div.make::text")
        loader.add_css("price_str", "div.price::text")
        loader.add_css("auction_house", "div.auctionHouse::text")
        loader.add_css("auction_country", "div.auctionHouse::text")
        loader.add_css("auction_url", "div.view-auction a::attr(href)")
        loader.add_css("img", "img.img-responsive::attr(src)")
        item['results'].append(loader.load_item())

    yield item
</code></pre>
</div>
<span class="comment-copy">I see that you are using the structure I suggested to you in your question "How to use JSON containing URL and ID in Scrapy and structure the results?". Don't forget to mark answers as accepted if you want to receive help from the StackOverflow community. Thanks !</span>
<span class="comment-copy">Awesome ! Thank you !</span>
<span class="comment-copy">Will appreciate, if you will mark this answer as accepted. Thanks!</span>
