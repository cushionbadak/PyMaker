<div class="post-text" itemprop="text">
<p>I want to save part of screen as video. When running code below I can see the window and fps count on it (around 100-140 fps).</p>
<p>Code (installed <a href="https://python-mss.readthedocs.io/installation.html" rel="nofollow noreferrer">mss</a> and <a href="https://pypi.org/project/opencv-python/" rel="nofollow noreferrer">opencv2</a> are required):</p>
<pre><code>import numpy as np
import cv2
import time
import mss

frame_width = 1280
frame_height = 720
frame_rate = 20.0
PATH_TO_MIDDLE = "output.avi"
fourcc = cv2.VideoWriter_fourcc(*'XVID')
out = cv2.VideoWriter(PATH_TO_MIDDLE, fourcc, frame_rate, 
                      (frame_width, frame_height))

with mss.mss() as sct:
    # Part of the screen to capture
    monitor = {"top": 120, "left": 280, "width": 1368, "height": 770}

    while "Screen capturing":
        last_time = time.time()

        # Get raw pixels from the screen, save it to a Numpy array
        img = np.array(sct.grab(monitor))
        img = cv2.resize(img, (1280, 720))
        frame = img

        cv2.putText(frame, "FPS: %f" % (1.0 / (time.time() - last_time)),
                    (10, 10),  cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 255, 0), 2)
        out.write(frame)
        cv2.imshow('frame', frame)

        # Press "q" to quit
        if cv2.waitKey(25) &amp; 0xFF == ord("q"):
            break


# Clean up
out.release()
cv2.destroyAllWindows()
</code></pre>
<p>This code not produced any errors, so I don't understand what's wrong here. Output file <code>output.avi</code> created fine, but with size 5,7 KB (and this file I didn't open). I tried change <code>VideoWriter</code>, move <code>out</code> and <code>fourcc</code> inside the <code>while</code> - but didn't succeed. Also tried to change <code>frame_rate</code> and set frame <code>width</code> and <code>height</code> to more smaller values. Also looked at <a href="https://stackoverflow.com/questions/16045654/using-opencv2-write-streaming-video-in-python">this</a> question, but cannot succeed.</p>
</div>
<div class="post-text" itemprop="text">
<p>Added those two lines  after <code>frame = img</code> helps:</p>
<pre><code>frame = cv2.cvtColor(img, cv2.COLOR_RGB2BGR)
frame = cv2.cvtColor(frame, cv2.COLOR_BGR2RGB)
</code></pre>
<p>Maybe <code>opencv</code> can't save image as <code>np.array</code> so here need additional usage of <code>cv2.cvtColor</code>.</p>
</div>
<span class="comment-copy">Can you please explain <code>while "Screen capturing":</code> ?</span>
<span class="comment-copy">@balderman, it's from example <a href="https://python-mss.readthedocs.io/examples.html#opencv-numpy" rel="nofollow noreferrer">here</a>. I don't fully understand if it needed here. After deleting it and remove <code>break</code> <code>mss</code> didn't capture anything and script finish from 0 sec from start. So, maybe this <code>while</code> are needed here. Such like <code>while</code> in <code>opencv</code>, maybe..</span>
