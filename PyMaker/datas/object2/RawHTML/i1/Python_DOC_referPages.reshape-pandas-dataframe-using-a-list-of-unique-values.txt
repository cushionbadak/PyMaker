<div class="post-text" itemprop="text">
<p>I have a dataframe with 12 rows and 3 columns. Each value on the 'name' column may be associated with many values on 'target' column. For each value there is also an associated 'val' which is a numerical variable.
Example: </p>
<pre><code>name  val target
a     6.3    la
b     3.5    le
c     10     li
d     8      lo
e     2.3    lu
f     5.6    lao
g     4.7    laoo
h     4.7    laooo
a     4.8    lo
j     1.2    le
b     1.5    re
k     9.8    la
</code></pre>
<p>I want to reshape my dataframe using the unique values from the 'targets' columns as the new columns and append to each row the corresponding 'val'. Since there are different numbers of 'val' for each target the new dataframe should fill empty lines with zeros. For example:</p>
<pre><code>la     le     li     lo     lu    ...
6.3    3.5    10     8      2.3   ...
9.8    1.2     0     4.8    0     ...
</code></pre>
<p>I found a script that does that but it was quite complicated to understand what is it doing. Is it possible to do it using just a few lines using numpy and/or pandas?</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>x = pd.DataFrame.from_dict(
    df.groupby('target')['val'].apply(np.unique).to_dict(), 'index').T.fillna(0)

print(x)
</code></pre>
<p>Output:</p>
<pre><code>    la  lao  laoo  laooo   le    li   lo   lu   re
0  6.3  5.6   4.7    4.7  1.2  10.0  4.8  2.3  1.5
1  9.8  0.0   0.0    0.0  3.5   0.0  8.0  0.0  0.0
</code></pre>
</div>
