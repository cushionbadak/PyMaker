<div class="post-text" itemprop="text">
<p>I have a group of data like below</p>
<pre><code>ID  Type    value_1 value_2
1   A   12  89
2   A   13  78
3   A   11  92
4   A   9   79
5   B   15  83
6   B   34  91
7   B   2   87
8   B   3   86
9   B   7   85
10  C   9   83
11  C   3   85
12  C   2   87
13  C   12  88
14  C   11  82
</code></pre>
<p>I want to get the top 3 member of each Type according to the <code>value_1</code> . The only solution occurs to me is that: first , get each Type data into a dataframe and sorted according to the <code>value_1</code> and get the top 3; Then, merge the result together.
But is ther any simple method to solve it ? For easy discuss , I have codes below </p>
<pre><code>#coding:utf-8
import pandas as pd
_data = [
    ["1","A",12,89],
    ["2","A",13,78],
    ["3","A",11,92],
    ["4","A",9,79],
    ["5","B",15,83],
    ["6","B",34,91],
    ["7","B",2,87],
    ["8","B",3,86],
    ["9","B",7,85],
    ["10","C",9,83],
    ["11","C",3,85],
    ["12","C",2,87],
    ["13","C",12,88],
    ["14","C",11,82]
]
head= ["ID","type","value_1","value_2"]
df = pd.DataFrame(_data, columns=head)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Then we using <code>groupby</code> <code>tail</code> with <code>sort_values</code></p>
<pre><code>newdf=df.sort_values(['type','value_1']).groupby('type').tail(3)
newer
    ID type  value_1  value_2
2    3    A       11       92
0    1    A       12       89
1    2    A       13       78
8    9    B        7       85
4    5    B       15       83
5    6    B       34       91
9   10    C        9       83
13  14    C       11       82
12  13    C       12       88
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Sure! <code>DataFrame.groupby</code> can split a dataframe into different parts by the group fields and <code>apply</code> function can apply UDF on each group.</p>
<pre><code>df.groupby('type', as_index=False, group_keys=False)\
    .apply(lambda x: x.sort_values('value_1', ascending=False).head(3))
</code></pre>
</div>
