<div class="post-text" itemprop="text">
<p>I have sensor data in a pandas dataframe that looks like:   </p>
<pre><code>Timestamp           1014.temperature    1014.humidity   1015.temperature    1015.humidity   1016.temperature    1016.humidity
2017-10-01 00:00:00 11.396667           92.440806       10.513333      92.204295            11.040000            92.959605  
</code></pre>
<p>The <code>SensorID</code> is given by the 4-digit number before the dot in each column. <code>Timestamp</code> indexes the data. The data goes on for several more Timestamps and SensorIDs.</p>
<p>What can I do to retrieve the <code>SensorID</code> in each column to create a new column so that my dataframe looks like:</p>
<pre><code>Timestamp            SensorID Temperature   Humidity
2017-10-01 00:00:00  1014     11.396667     92.440806
2017-10-01 00:00:00  1015     10.513333     92.204295
2017-10-01 00:00:00  1016     11.040000     92.959605
</code></pre>
<p>Thanks.</p>
</div>
<div class="post-text" itemprop="text">
<p>First <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html" rel="nofollow noreferrer"><code>str.split</code></a> for <code>MultiIndex</code> in columns and reshape by <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.stack.html" rel="nofollow noreferrer"><code>DataFrame.stack</code></a> with first level, last <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.reset_index.html" rel="nofollow noreferrer"><code>DataFrame.reset_index</code></a> with <code>rename</code>:</p>
<pre><code>#if Timestamp is column
#df = df.set_index('Timestamp')

df.columns = df.columns.str.split('.', expand=True)
df = df.stack(level=0).reset_index().rename(columns={'level_1':'SensorID'})
print (df)
             Timestamp SensorID   humidity  temperature
0  2017-10-01 00:00:00     1014  92.440806    11.396667
1  2017-10-01 00:00:00     1015  92.204295    10.513333
2  2017-10-01 00:00:00     1016  92.959605    11.040000
</code></pre>
</div>
