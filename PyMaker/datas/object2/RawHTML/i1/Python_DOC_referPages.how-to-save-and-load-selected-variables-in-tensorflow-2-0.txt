<div class="post-text" itemprop="text">
<p>How do I save selected variables in tensorflow 2.0 shown below in a file and load them into some defined variables in another code?</p>
<pre><code>class manyVariables:
    def __init__(self):
        self.initList = [None]*100
        for i in range(100):
            self.initList[i] = tf.Variable(tf.random.normal([5,5]))
        self.makeSomeMoreVariables()

    def makeSomeMoreVariables(self):
        self.moreList = [None]*10
        for i in range(10):
            self.moreList[i] = tf.Variable(tf.random.normal([3,3]))

    def saveVariables(self):
        # how to save self.initList's 3,55 and 60th elements and self.moreList's 4th element
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>In the following code I save an array called variables to a .txt file with a name of your choosing. This file will be in the same folder as your python file. The 'wb' in the open function means write with truncation(so removing everything that was previously in the file) and uses byte format. I use pickle to handle saving/parsing the list.</p>
<pre><code>import pickle

    def saveVariables(self, variables): #where 'variables' is a list of variables
        with open("nameOfYourFile.txt", 'wb+') as file:
           pickle.dump(variables, file)

    def retrieveVariables(self, filename):
        variables = []
        with open(str(filename), 'rb') as file:
            variables = pickle.load(file)
        return variables
</code></pre>
<p>To save specific stuff to your file just add it as the variables argument in saveVariables like so:</p>
<pre><code>myVariables = [initList[2], initList[54], initList[59], moreList[3]]
saveVariables(myVariables)
</code></pre>
<p>To retrieve variables from text file with a certain name:</p>
<pre><code>myVariables = retrieveVariables("theNameOfYourFile.txt")
thirdEl = myVariables[0]
fiftyFifthEl = myVariables[1]
SixtiethEl = myVariables[2]
fourthEl = myVariables[3]
</code></pre>
<p>You could add these functions anywhere in the class. </p>
<p><em>To be able to access the initList/moreList in your example however, you should either return them from their functions(like I do with the <code>variables</code> list) or make them global.</em> </p>
</div>
<span class="comment-copy">Straightaway, got an error that variables must be a str in file.write(). Was able to save with str(variables) as file.write argument but couldn't load and convert back to tensor. There must be a better method with tf.train.Checkpoint().</span>
<span class="comment-copy">oops you are right there, I forgot to double check that. You could make it work using pickle which allows you to save many formats as byte. I will update the answer. Tensorflow might indeed have an automatic function for this, I have never worked with it so I am not sure.</span>
<span class="comment-copy">That did the job. Thank you very much. Although there should be some tensorflow specific way too so I'll wait a bit more for another answer with tf.train.Checkpoint if possible..</span>
