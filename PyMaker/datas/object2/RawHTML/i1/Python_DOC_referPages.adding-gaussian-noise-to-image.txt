<div class="post-text" itemprop="text">
<p>I'm trying to add gaussian noise to some images using the following code </p>
<pre><code>import numpy as np
import cv2
import glob 
mean = 0
var = 10
sigma = var ** 0.5
gaussian = np.random.normal(mean, sigma, (224, 224)) 



for image in glob.glob('/home/aub/myflower/flower_photos/dandelion/*.jpg'):
    img = cv2.imread(image)
    noisy_image = np.zeros(img.shape, np.float32)

    if len(img.shape) == 2:
        noisy_image = img + gaussian
    else:
        noisy_image[:, :, 0] = img[:, :, 0] + gaussian
        noisy_image[:, :, 1] = img[:, :, 1] + gaussian
        noisy_image[:, :, 2] = img[:, :, 2] + gaussian

        cv2.normalize(noisy_image, noisy_image, 0, 255, cv2.NORM_MINMAX, dtype=-1)
noisy_image = noisy_image.astype(np.uint8)

       cv2.imshow("img", img)
       cv2.imshow("gaussian", gaussian)
       cv2.imshow("noisy", noisy_image)
cv2.waitKey(0)
</code></pre>
<p>but it doesn't work and it gives me the following error </p>
<blockquote>
<p>noisy_image[:, :, 0] = img[:, :, 0] + gaussian ValueError: operands
  could not be broadcast together with shapes (315,500) (224,224)</p>
</blockquote>
<p>Kindly review and give feedback.</p>
</div>
<div class="post-text" itemprop="text">
<p>It looks like your image shape is <code>(315,500)</code>, while the shape of <code>gaussian</code> is <code>(224,224)</code>. Try changing your gaussian initialization to</p>
<pre><code>gaussian = np.random.normal(mean, sigma, (img.shape[0],img.shape[1])) 
</code></pre>
<p>By the way:
You can replace these lines</p>
<pre><code>noisy_image[:, :, 0] = img[:, :, 0] + gaussian
noisy_image[:, :, 1] = img[:, :, 1] + gaussian
noisy_image[:, :, 2] = img[:, :, 2] + gaussian
</code></pre>
<p>with</p>
<pre><code>noisy_image = img + gaussian
</code></pre>
<p>which will have the same effect: adding <code>gaussian</code> to each channel.</p>
</div>
<span class="comment-copy">thank you so much for your feedback, i changed the lines and the also changed the shape to (img.shape[0],img.shape[1]) and it works now, thank you</span>
<span class="comment-copy">You are welcome and you are right, using <code>(img.shape[0],img.shape[1])</code> is far better, I will add that to my answer.</span>
