<div class="post-text" itemprop="text">
<p>I am working with a dataframe containing two columns with ID numbers. For further research I want to make a sort of dummy variables of these ID numbers (with the two ID numbers). My code, however, does not merge the columns from the two dataframes. How can I merge the columns from the two dataframes and create the dummy variables?</p>
<p><strong><em>Dataframe</em></strong></p>
<pre><code>import pandas as pd
import numpy as np
d = {'ID1': [1,2,3], 'ID2': [2,3,4]}
df = pd.DataFrame(data=d)
</code></pre>
<p><strong><em>Current code</em></strong></p>
<pre><code>pd.get_dummies(df, prefix = ['ID1', 'ID2'], columns=['ID1', 'ID2'])
</code></pre>
<p><strong><em>Desired output</em></strong></p>
<pre><code>p = {'1': [1,0,0], '2': [1,1,0], '3': [0,1,1], '4': [0,0,1]}
df2 = pd.DataFrame(data=p)
df2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If need indicators in output use <code>max</code>, if need count values use <code>sum</code> after <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.get_dummies.html" rel="nofollow noreferrer"><code>get_dummies</code></a> with another parameters and casting values to strings:</p>
<pre><code>df = pd.get_dummies(df.astype(str), prefix='', prefix_sep='').max(level=0, axis=1)
#count alternative 
#df = pd.get_dummies(df.astype(str), prefix='', prefix_sep='').sum(level=0, axis=1)
print (df)
   1  2  3  4
0  1  1  0  0
1  0  1  1  0
2  0  0  1  1
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Different ways of skinning a cat; here's how I'd do itâ€”use an additional <code>groupby</code>:</p>
<pre><code># pd.get_dummies(df.astype(str)).groupby(lambda x: x.split('_')[1], axis=1).sum()
pd.get_dummies(df.astype(str)).groupby(lambda x: x.split('_')[1], axis=1).max()

   1  2  3  4
0  1  1  0  0
1  0  1  1  0
2  0  0  1  1
</code></pre>
<hr/>
<p>Another option is <code>stack</code>ing, if you like conciseness:</p>
<pre><code># pd.get_dummies(df.stack()).sum(level=0)
pd.get_dummies(df.stack()).max(level=0)

   1  2  3  4
0  1  1  0  0
1  0  1  1  0
2  0  0  1  1
</code></pre>
</div>
