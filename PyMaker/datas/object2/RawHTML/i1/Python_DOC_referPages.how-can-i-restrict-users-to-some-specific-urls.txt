<div class="post-text" itemprop="text">
<p>I want to restrict users to access the payment and checkout pages by typing the url in address bar like <strong>"home/shop/checkout/" and "home/shop/payment/"</strong>
I want to make these pages accessible only if either buy_now form is valid or items_buy_now form is valid</p>
<blockquote>
<p>urls.py</p>
</blockquote>
<pre><code>path('payment/',views.payment,name='payment'),
path('checkout/', views.checkout, name="checkout"),
</code></pre>
<blockquote>
<p>views.py</p>
</blockquote>
<pre><code>def checkout(request):
        request.session.pop('data', None)
        messages.success(request,'Done.Thanks for using our services.')
        return redirect("shop:mycart")

        def payment(request):
            return render(request,'shop/payment.html')

        def buy_now(request,slug):
        if not request.user.is_authenticated:
            messages.info(request, 'You have to logged in first.')
            return redirect('%s?next=%s' % (settings.LOGIN_URL, request.path))
        product = Product.objects.get(active=True, slug=slug)
        if request.method == "POST":
            form = BuyerDeliveryForm(request.POST)
            if form.is_valid():
                buyer = form.save(commit=False)
                buyer.save()
                return redirect('shop:payment')
        else:
            form = BuyerDeliveryForm()
        return render(request, 'shop/delivery_form.html', {'form': form, 'products': product})


    def items_buy_now(request):
        if not request.user.is_authenticated:
            messages.info(request, 'You have to logged in first.')
            return redirect('%s?next=%s' % (settings.LOGIN_URL, request.path))
        if request.method == "POST":
            form = BuyerDeliveryForm(request.POST)
            if form.is_valid():
                buyer = form.save(commit=False)
                buyer.save()
                return redirect('shop:payment')
        else:
            form = BuyerDeliveryForm()
        return render(request, 'shop/delivery_form.html', {'form': form})
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The best way to do it is to :</p>
<ol>
<li>Create a Mixin that manager either items_buy or items_buy</li>
<li>For all the views that have to handle the restriction, subclass it from the respective mixin.</li>
<li>In the get function of the subclass call the method to check if the user has the authorization to access to that page.</li>
</ol>
</div>
