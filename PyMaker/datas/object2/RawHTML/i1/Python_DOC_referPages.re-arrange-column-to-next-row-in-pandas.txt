<div class="post-text" itemprop="text">
<p>I have a dataframe with the following format:-</p>
<pre><code>ID   A    B    C     D     E     F
W1   a1   b1   c1    d1    e1    f1
W2   a2   b2   c2    d2    e2    f2
W3   a3   b3   c3    d3    e3    f3
W4   a4   b4   c4    d4    e4    f4
W5   a5   b5   c5    d5    e5    f5
W6   a6   b6   c6    d6    e6    f6
</code></pre>
<p>if I would like to get the following format. Using Pandas.</p>
<pre><code>ID   A    B    E     F
W1   a1   b1   e1    f1
W1   c1   d1   e1    f1
W2   a2   b2   e2    f2
W2   c2   d2   e2    f2
W3   a3   b3   e3    f3
W3   c3   d3   e3    f3
W4   a4   b4   e4    f4
W4   c4   d4   e4    f4
W5   a5   b5   e5    f5
W5   c5   d5   e5    f5
W6   a6   b6   e6    f6
W6   c6   d6   e6    f6
</code></pre>
<p>And then break this dataframe into multi dataframe to write_to individual csv files with column 1 as filename.</p>
<p>W1.csv</p>
<pre><code>W1   a1   b1   e1    f1
W1   c1   d1   e1    f1 
</code></pre>
<p>W2.csv</p>
<pre><code>W2   a2   b2   e2    f2
W2   c2   d2   e2    f2
</code></pre>
<p>W3.csv</p>
<pre><code>W3   a3   b3   e3    f3
W3   c3   d3   e3    f3
</code></pre>
<p>W4.csv</p>
<pre><code>W4   a4   b4   e4    f4
W4   c4   d4   e4    f4
</code></pre>
<p>W5.csv</p>
<pre><code>W5   a5   b5   e5    f5
W5   c5   d5   e5    f5
</code></pre>
<p>W6.csv</p>
<pre><code>W6   a6   b6   e6    f6
W6   c6   d6   e6    f6
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you have determined that <code>C-&gt;A</code> and <code>D-&gt;B</code>, you can re-concat the frames and then <code>ffill</code>.  In general, <code>d</code> just needs to relate the columns you are moving to the columns they should be placed under.</p>
<hr/>
<pre><code>d = dict(C='A', D='B')
u = df[[*d]].copy()
f = df.drop([*d], axis=1)

g = pd.concat([f, u.rename(columns=d)], sort=False).sort_index().ffill().groupby('ID')
</code></pre>
<p>Now you can use <code>g</code> to write each individual frame to a file as you choose:</p>
<pre><code>for _, group in g:
    print(group, end='\n\n')
</code></pre>
<p></p>
<pre><code>   ID   A   B   E   F
0  W1  a1  b1  e1  f1
0  W1  c1  d1  e1  f1

   ID   A   B   E   F
1  W2  a2  b2  e2  f2
1  W2  c2  d2  e2  f2

   ID   A   B   E   F
2  W3  a3  b3  e3  f3
2  W3  c3  d3  e3  f3

   ID   A   B   E   F
3  W4  a4  b4  e4  f4
3  W4  c4  d4  e4  f4

   ID   A   B   E   F
4  W5  a5  b5  e5  f5
4  W5  c5  d5  e5  f5

   ID   A   B   E   F
5  W6  a6  b6  e6  f6
5  W6  c6  d6  e6  f6
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Using pandas <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html" rel="nofollow noreferrer">concat()</a> after separating the data frame in two, filling nan's and using a for loop to generate the files:</p>
<pre><code>df1 = df[['ID', 'A', 'B', 'E', 'F']]
df2 = df[['ID', 'C', 'D']]
df2.columns = ['ID', 'A', 'B']
df = pd.concat([df1, df2], sort = True).sort_values('ID').fillna(method='ffill').reset_index(drop = True)[['ID','A','B','E','F']]
for w in df.ID.unique():
    df[df.ID == w].to_csv(w + '.csv')
</code></pre>
</div>
<span class="comment-copy">What's the rule that decides that <code>c</code> and <code>d</code> go under <code>a</code> and <code>b</code>?</span>
<span class="comment-copy">Hi User3483203, i am very new to python / pandas. Do you mind explaining in steps what your solution? Thanks in advance</span>
<span class="comment-copy">Thanks user3483203.. works great.</span>
<span class="comment-copy">Thanks Daniel.. works like a charm</span>
<span class="comment-copy">Good to know that it helped you, @ooikiam. I would kindly ask you to accept and upvote my answer if you think that it deserves.</span>
