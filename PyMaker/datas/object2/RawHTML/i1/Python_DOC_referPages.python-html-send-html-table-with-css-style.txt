<div class="post-text" itemprop="text">
<p>I'm trying to send a email with a table as a body with some CSS configurations. For that I have the following code:</p>
<pre class="lang-py prettyprint-override"><code>import csv
from tabulate import tabulate
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
import smtplib

text = """Hello, Friend.Here is your data:{table}Regards,Me"""
html = """"\
&lt;html&gt;
&lt;head&gt;
  &lt;style type="text/css"&gt;
     .tg  {border-collapse:collapse;border-spacing:0;}
     .tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
     .tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}
     .tg .tg-0lax{text-align:left;vertical-align:top} 
  &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;table class="tg"&gt;
    &lt;tr&gt;
      &lt;th class="tg-0lax"&gt;Environment&lt;/th&gt;
      &lt;th class="tg-0lax"&gt;Date&lt;/th&gt;
      &lt;th class="tg-0lax"&gt;Error_Type&lt;/th&gt;
      &lt;th class="tg-0lax"&gt;Error_Object&lt;/th&gt;
      &lt;th class="tg-0lax"&gt;Description&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td class="tg-0lax"&gt;PROD&lt;/td&gt;
      &lt;td class="tg-0lax"&gt;15/03/2019&lt;/td&gt;
      &lt;td class="tg-0lax"&gt;ERROR&lt;/td&gt;
      &lt;td class="tg-0lax"&gt;F_ORDER_DETAIL&lt;/td&gt;
      &lt;td class="tg-0lax"&gt;More columns than expected&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;"""

with open('file.csv') as input_file:
    reader = csv.reader(input_file)
    data = list(reader)
</code></pre>
<p>However I'm facing with a problem when I add the CSS style:</p>
<pre><code>html = html.format(table=tabulate(data, headers="firstrow", tablefmt="html"))
KeyError: 'border-collapse'
</code></pre>
<p>How can I add that CSS Style on my HTML Table?</p>
<p>Many thanks!!!</p>
</div>
<div class="post-text" itemprop="text">
<p>You need to use double curly-braces in oder to avoid string format interpolation.</p>
<p>For instance:</p>
<pre class="lang-html prettyprint-override"><code>  &lt;style type="text/css"&gt;
     .tg  {{border-collapse:collapse;border-spacing:0;}}
     .tg td{{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}}
     .tg th{{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:black;}}
     .tg .tg-0lax{{text-align:left;vertical-align:top}} 
  &lt;/style&gt;
</code></pre>
</div>
<span class="comment-copy">Laurent LAPORT's answer is correct. It is recommended to use inline styles rather than an embedded stylesheet, as email clients such as gmail will strip most css rules from the <code>head</code> tag.</span>
