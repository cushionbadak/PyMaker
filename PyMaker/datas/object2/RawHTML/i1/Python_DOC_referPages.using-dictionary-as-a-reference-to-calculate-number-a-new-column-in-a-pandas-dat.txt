<div class="post-text" itemprop="text">
<p>I have, what I think, is a slightly complicated problem that I am trying to solve. Here's the abstracted version. I have a list of UIDs and their friends stored in a dictionary:</p>
<pre><code>In[1]:friend_list
Out[1]:{111:[112, 113, 115],
        112:[111, 114, 115],
        113:[111, 114],
        114:[112, 113, 115],
        115:[111, 112, 114]}

</code></pre>
<p>I also have two dataframes that contain some information about these UIDs:</p>
<p>df1:</p>
<pre><code>|   | UID | Sex | Infected |
|:-:|:---:|:---:|:--------:|
| 0 | 111 |  M  |   True   |
| 1 | 112 |  F  |   True   |
| 2 | 113 |  F  |   False  |
| 3 | 114 |  M  |   False  |
| 4 | 115 |  F  |   False  |

</code></pre>
<p>df2 :</p>
<pre><code>|   | UID |  Job  | Vaccinated |
|:-:|:---:|:-----:|:----------:|
| 0 | 111 | False |    True    |
| 1 | 112 |  True |    True    |
| 2 | 113 |  True |    False   |
| 3 | 114 |  True |    False   |
| 4 | 115 | False |    False   |

</code></pre>
<p>I would like to use the dictionary and df2 to figure out how many friends of each individual are working and vaccinated (as separate columns) and aff it as a column so that the output looks as below:</p>
<p>df1:</p>
<pre><code>|   | UID | Sex | Infected | nFriends_Job | nFriends_Vacc |
|:-:|:---:|:---:|:--------:|:------------:|:-------------:|
| 0 | 111 |  M  |   True   |       2      |       1       |
| 1 | 112 |  F  |   True   |       1      |       1       |
| 2 | 113 |  F  |   False  |       1      |       1       |
| 3 | 114 |  M  |   False  |       2      |       1       |
| 4 | 115 |  F  |   False  |       2      |       2       |

</code></pre>
<p>Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>First we using for loop with <code>isin</code> lookup the <code>dict</code>   create the value we need </p>
<pre><code>l=[(df2.loc[df2.UID.isin(d[x]),'Job'].sum(),df2.loc[df2.UID.isin(d[x]),'Vaccinated'].sum()) for x in df1.UID]
#here we create the new df to concat
newdf=pd.DataFrame(l,columns=['nFriends_Jobs','nFriends_Vacc '],index=df1.index)
df1=pd.concat([df1,newdf],1)
df1
Out[187]: 
   UID Sex  Infected  nFriends_Jobs  nFriends_Vacc 
0  111   M      True              2               1
1  112   F      True              1               1
2  113   F     False              1               1
3  114   M     False              2               1
4  115   F     False              2               2
</code></pre>
</div>
<span class="comment-copy">This is mostly correct although the attributes of df2 should be referred to as df2['UID'] if I'm not wrong. Marking it as the right answer since the logic works fine. Thanks!</span>
