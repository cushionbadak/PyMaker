<div class="post-text" itemprop="text">
<p>I have the following subclass of <code>scipy.stats.rv_continuous</code>:</p>
<pre><code>from scipy.stats import rv_continuous
import math

class Distribution(rv_continuous):
    def _cdf(self, x, a, b, mu):
        return (
            math.erf(x/(math.sqrt(2)*a)) + \
            math.erf((x - mu)/(math.sqrt(2)*b)) \
            ) / 2 + math.erf(mu/(math.sqrt(2)*b)) / 2

distribution = Distribution(a = 0, b = float('inf'))
</code></pre>
<p>As far as I can tell, everything is setup correctly (I've checked the math and it is also correct). However, for some reason, it only wants to generate values between <code>0</code> and <code>mu</code>, rather than the expected <code>0</code> and <code>inf</code> as <em>explicitly</em> specified. For example, here are 50 points generated with <code>distribution.rvs(3, 1.6, 10)</code> (along with the PDF):</p>
<p><a href="https://i.stack.imgur.com/yq6lS.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/yq6lS.png"/></a></p>
<p>and here's an example with <code>distribution.rvs(0.6, 0.4, 4.85)</code>:</p>
<p><a href="https://i.stack.imgur.com/Jb65a.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/Jb65a.png"/></a></p>
<p>Why is my distribution 'capped' at <code>mu</code>? Have I setup my <code>rv_continuous</code> subclass wrong?</p>
</div>
<div class="post-text" itemprop="text">
<p>Your implementation of the CDF is not correct.  Consider:</p>
<pre><code>In [188]: distribution.cdf(25, 3, 16., 10)
Out[188]: 1.059763759070757

In [189]: distribution.cdf(40, 3, 16., 10)
Out[189]: 1.203618109186038
</code></pre>
<p>Those values are not correct.  The CDF (which you implemented in the <code>_cdf</code> method) must not exceed 1.0.</p>
</div>
<span class="comment-copy">That's odd, I must have messed up when I copied the formula. I verified from paper to wolfram alpha that the CDF approaches 1 asymptotically. I'll check how I wrote it again. Thanks for the help!</span>
<span class="comment-copy">My suggested correction was not correct! I removed it.</span>
