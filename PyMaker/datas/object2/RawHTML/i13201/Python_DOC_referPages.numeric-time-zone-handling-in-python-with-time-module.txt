<div class="post-text" itemprop="text">
<p>I have the following Python code:</p>
<pre><code>import json
import fileinput
import time

ts_pattern  = '[%d/%b/%Y:%H:%M:%S +0000]'

for line in fileinput.input():
    json_data = json.loads(line)
    etime = int(time.mktime(time.strptime(json_data['time_local'], ts_pattern)))
    print etime
</code></pre>
<p>I have made a mistake, it appears.  For example, in the JSON that I'm reading, <code>time_local</code> is <code>[06/Oct/2015:15:29:35 +0000]</code>.  My script outputs 1444166975 as the result.  However, that is not correct, so far as I can see:</p>
<pre><code>$ date -ud @1444166975
Tue Oct  6 21:29:35 UTC 2015
</code></pre>
<p>Having the linux <code>date</code> command do the conversion back gives:</p>
<pre><code>$ date +%s -ud "06-Oct-2015 15:29:35 +0000"
1444145375
</code></pre>
<p>So far as I understand (which could easily be wrong...), I want the output to be in GMT in order for the conversion to epoch to be correct.  What am I missing?</p>
</div>
<div class="post-text" itemprop="text">
<p>Don't use <code>time.mktime()</code> with UTC time. It accepts local time and therefore your code is wrong if your local timezone is not UTC.</p>
<p>Use <a href="https://docs.python.org/3/library/calendar.html#calendar.timegm" rel="nofollow noreferrer"><code>calendar.timegm()</code></a> instead:</p>
<pre><code>#!/usr/bin/env python
import time
from calendar import timegm

tt = time.strptime('[06/Oct/2015:15:29:35 +0000]',
                   '[%d/%b/%Y:%H:%M:%S +0000]')
print(timegm(tt))  # -&gt; 1444145375
</code></pre>
<p>See <a href="https://stackoverflow.com/q/8777753/4279">Converting datetime.date to UTC timestamp in Python</a></p>
</div>
<span class="comment-copy">I always like the "How do I...?", "You don't" posts, as they seem to reveal new things about a language.  That worked.  Thank you very much.</span>
