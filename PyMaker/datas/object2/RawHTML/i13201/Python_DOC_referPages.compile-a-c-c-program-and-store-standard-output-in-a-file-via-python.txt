<div class="post-text" itemprop="text">
<p>Let's say I have a C/C++ file named <code>userfile.c</code>. </p>
<p>Using Python, how can I invoke the local gcc compiler so that the file is compiled and an executable is made? More specifically, I would like to provide some input (stdin) via some file <code>input.txt</code> and I want to save the standard output into another file called <code>output.txt</code>. I saw some documentation that I will need to use subprocess, but I'm not sure how to call that and how to provide custom input.</p>
</div>
<div class="post-text" itemprop="text">
<p>A simple solution will be as given below:</p>
<pre><code>import subprocess

if subprocess.call(["gcc", "test.c"]) == 0:
    subprocess.call(["./a.out &lt;input.txt &gt;output.txt"], shell=True)
else: print "Compilation errors"
</code></pre>
<p>2 caveats:</p>
<ol>
<li>I am hardcoding stuff. You may want to parameterize and all that.</li>
<li>Setting <em>shell</em> to <em>True</em>, is a security risk, per Python documentation.</li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p>Here's a possible solution (written for Python 3):</p>
<pre><code>import subprocess

subprocess.check_call(
    ('gcc', '-O', 'a.out', 'userfile.c'),
    stdin=subprocess.DEVNULL)

with open('input.txt') as infile, open('output.txt', 'w') as outfile:
    subprocess.check_call(
        ('./a.out',),
        stdin=infile,
        stdout=outfile,
        universal_newlines=True)
</code></pre>
<p>The parameter <code>universal_newlines</code> makes <code>subprocess</code> use strings rather than bytes for input and output. If you want bytes rather than strings, open the files in binary mode and set <code>universal_newlines=False</code>.</p>
<p>On compile or run errors in the two programs, <a href="https://docs.python.org/3/library/subprocess.html#subprocess.CalledProcessError" rel="nofollow"><code>subprocess.CalledProcessError</code></a> will be raised by <code>subprocess.check_call</code>.</p>
</div>
<span class="comment-copy">You could use <a href="http://www.scons.org/" rel="nofollow noreferrer">SCons</a>.</span>
<span class="comment-copy">How does <code>input.txt</code> and <code>output.txt</code> relate to the program in <code>userfile.c</code>? Do you need to run the C executable after compilation?</span>
<span class="comment-copy">@MathiasRav: Yes, I want to provide the data from input.txt as stdin for the executable.</span>
<span class="comment-copy">This is not working in Windows, but works fine in Mac OS X. How can I make it run in Windows?</span>
<span class="comment-copy">It is not working in Windows!</span>
