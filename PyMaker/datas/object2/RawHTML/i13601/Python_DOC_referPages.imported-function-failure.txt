<div class="post-text" itemprop="text">
<p>Why does my function fail when I use it through an import? It says "re" not defined. I also tried using a basic function like <code>def x(): return 5+5</code> and that threw an error as well.</p>
<h1>Function Fails When Using As Import</h1>
<pre><code>import re
from sys import argv
from Galvanize import q1


f = open('git_script.txt','r')
q1.text_content_analyzer(f)

---------------------------------------------------------------------------

NameError                                 Traceback (most recent call last)

&lt;ipython-input-82-cdff728a66aa&gt; in &lt;module&gt;()
      1 f = open('git_script.txt','r')
----&gt; 2 q1.text_content_analyzer(f)


/Users/Rafeh/Dropbox/github/Galvanize/q1.py in text_content_analyzer(f)
      6     wordsCount = {}
      7 
----&gt; 8     for line in f:
      9         nbOfSentences += len(re.split(r'[.!?]+', line.strip()))-1
     10         lineWords = line.split()


NameError: name 're' is not defined
</code></pre>
<h1>Function Runs Successfully Normally</h1>
<pre><code>def text_content_analyzer(f):
    import re
    words = []
    nbOfSentences = 0
    punctuation = []
    wordsCount = {}

    for line in f:
        nbOfSentences += len(re.split(r'[.!?]+', line.strip()))-1
        lineWords = line.split()

        words = words + lineWords
        for word in lineWords:
            if word in wordsCount:
                wordsCount[word] += 1
            else:
                wordsCount[word] = 1

    print("Total word count: %1.0f" %len(words))
    print(wordsCount)
    print("Unique words: " , len(wordsCount.keys()))
    print(nbOfSentences)
    return len(words), wordsCount, len(wordsCount.keys()), nbOfSentences
</code></pre>
<p>Right now I am just testing out and learning how to use my own functions but I am currently having a problem here. </p>
<p><li> The function is my own and saved locally. 
<li> Using Python 3 on IPython Notebook
<li> The function runs correctly when used without an import</li></li></li></p>
</div>
<div class="post-text" itemprop="text">
<p>I am guessing the issue could be that first you created the script and missed putting <code>import re</code> and then when you ran the function in python , you got that error.</p>
<p>Then later on, you corrected the file by importing <code>re</code> and then again in the same ipython session when you are trying to run the function, its still erroring out. Your saying -</p>
<blockquote>
<p>I also tried using a basic function like <code>def x(): return 5+5</code> and that threw an error as well.</p>
</blockquote>
<p>Makes me believe this is the case.</p>
<p>If the above is correct , then the issue is that, once you import a module into Python, Python caches the module in <code>sys.modules</code> , so if you try to import it again in the same Python session , you would get the same module (which means you would get the same function) .</p>
<p>To fix this , the easiest way would be to close the ipython session, and open it again, and import it again.</p>
<p>A solution that does not involve closing the Python terminal would be to use <a href="https://docs.python.org/3/library/importlib.html#importlib.reload" rel="nofollow"><code>importlib.reload()</code></a> . If <code>q1</code> is the module, Example -</p>
<pre><code>from Galvanize import q1
import importlib
importlib.reload(q1)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you want to use module "re" inside the function, the import for "re" should be in the same file in which the function is defined. The alternative is to import "re" inside the function like you have done in your second code snippet.</p>
<pre><code>import re

def f():
    return re.findall(r'hello', 'hello world')
</code></pre>
</div>
<span class="comment-copy">I am pretty sure <code>re</code> needs to be a class.. Then you would do: `from re import x' probably why it's not working</span>
<span class="comment-copy">Whoops. Forgot to add that my function has <code>import re</code> inside of it. Good catch. (I just forgot to put that line in stack overflow). Your answer is not correct because <code>re</code> is a module that I am using for string processing. Which is why my function correctly runs normally (Without being imported). I just don't understand why it is not running now (After being imported).</span>
<span class="comment-copy">Is it something like you previously missed out <code>import re</code> in your script, and then imported it into ipython, but it failed with that error, and then later on you fixed it by adding the <code>import re</code> and then after importing again to same ipython session, it still doesn't work?</span>
<span class="comment-copy">@Rafeh The error you're showing us is saying that you haven't imported <code>re</code>, and now you're telling us that out of all lines you just happened to forgot to include the <code>import re</code> into the stackoverflow code? I don't wanna call you a liar, but <i>maybe</i> your issue is that you weren't importing <code>re</code>,</span>
<span class="comment-copy">I reverted to a incorrect version of my code before copying and pasting here. I had caught the <code>import re</code> problem earlier and that it was not in my function, so I had updated it. However I found the problem. I had to close my current Ipython notebook and reopen it after the change was made to the q1.py file. Change being <code>import re</code>. @MarkusMeskanen your comment made me think about restarting my browser and trying again before giving up so thanks haha. Your comment made me think again. I had been bashing my head there for a while. Sorry for such an easy solution!</span>
<span class="comment-copy">Yup closing and reopening was it! Also, <code>importlib.reload(foo)</code> is REALLY useful to know! Thanks!</span>
<span class="comment-copy">"The alternative is to import <code>re</code> inside the function like you have done in your second code snippet." so his import is already correct, how does your answer help him?</span>
<span class="comment-copy">Is it better to <code>import re</code> inside, or outside the function as general practice? Also why are there so many downvotes?</span>
<span class="comment-copy">@Rafeh Outside. As a general practice.</span>
<span class="comment-copy">I misunderstood the question to mean that for @Rafeh, one of the two things was working. If he imports <code>re</code> in the calling file, it doesn't work, but importing it in the function works. In that sense, my answer is somewhat helpful. :)</span>
<span class="comment-copy">@Rafeh, the name should be imported in the file where it is going to be used. So it's not about importing in the calling vs. the called file. I was answering for your particular context.</span>
