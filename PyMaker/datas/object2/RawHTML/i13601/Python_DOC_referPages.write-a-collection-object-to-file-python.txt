<div class="post-text" itemprop="text">
<p>I have a <code>Collection</code> object as below:</p>
<pre><code>Counter({'Saree': 5679, '': 4860, 'Cotton': 4201, 'Printed': 3715})
</code></pre>
<p>I would like to produce a CSV file containing the keys and values, sorted in descending order of value.</p>
<pre><code>A      B
Saree  5679
       4860
Cotton 4201
Printed 3715
</code></pre>
<p>I have tried the below code where <code>value</code> is a list as <code>['Saree','','Cotton','printed']</code>:</p>
<pre><code>for k, v in sorted(collections.Counter(value)):
    f.write(k+delimiter+v)
</code></pre>
<p>But this hasn't worked since I was assuming the Collection object is nothing but a dictionary.</p>
<p>The error that I get is as below:
    ValueError: need more than 0 values to unpack</p>
<p>at</p>
<pre><code>for k, v in sorted(collections.Counter(value)):
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Since you appear to want to see the highest count first, the Counter's <code>most_common()</code> method gives you a list of <code>(key, value)</code> pairs with the items ordered by value. You can then iterate over that list, printing out the keys and values, as below.</p>
<pre><code>for k, v in c.most_common():
    print "{:10} {:4}".format(k, v)
</code></pre>
<p>giving</p>
<pre><code>Saree      5679
           4860
Cotton     4201
Printed    3715
</code></pre>
<p>OK, you want a CSV file (we are supposed somehow to intuit). This will do the job:</p>
<pre><code>with open("file.csv", "wb") as f:
    w = csv.writer(f)
    w.writerows(c.most_common())
</code></pre>
<p>I am sure you will be able to cope with adding column headings.</p>
</div>
<span class="comment-copy">"Hasn't worked" does not tell us what is going wrong. An exception traceback would.</span>
<span class="comment-copy">The part <code>sorted(collections.Counter(value))</code> looks suspicious. What is <code>value</code> there? What is the name of the variable pointing to the collection you have?</span>
<span class="comment-copy">To write it to file, you can just use <a href="https://docs.python.org/3/library/json.html" rel="nofollow noreferrer">json</a> or <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">csv</a> or whatever. Then, when you read it back in, just convert the plain dictionary to a Counter. What exactly is the problem?</span>
<span class="comment-copy">Why don't you just <code>pickle</code> it?</span>
<span class="comment-copy">Or are you asking how to write them to file in sorted order? In this case, try <code>your_counter.most_common()</code></span>
