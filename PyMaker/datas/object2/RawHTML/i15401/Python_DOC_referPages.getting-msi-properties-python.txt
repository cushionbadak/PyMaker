<div class="post-text" itemprop="text">
<p>I have an MSI file that I'm trying to extract some of the parameters specified in the Details tab on the file properties.</p>
<p>I found the <a href="https://docs.python.org/2/library/msilib.html" rel="nofollow">msilib</a> where SummaryInformation.GetProperty(field) looks like the way to go, but I don't understand how to use it. how do I 'connect' it to that existing MSI file and not one that is being created?</p>
</div>
<div class="post-text" itemprop="text">
<p>The msi file contains both cab files and information in a database format.
See this link for more info about its structre and how to view it: <a href="https://stackoverflow.com/questions/1951289/windows-installer-msi-format">MSI structure answer</a>.</p>
<p>I never used the python msilib but by reading the documentation my guess is this:</p>
<ol>
<li><p>to get the db object, use something like:
<code>
dbobject = msilib.OpenDatabase(path, msilib.MSIDBOPEN_READONLY)
</code></p></li>
<li><p>if you want something in the <a href="https://docs.python.org/3/library/msilib.html#msilib.SummaryInformation.GetProperty" rel="nofollow noreferrer">summary info</a> then you can do something like:
<code>
info = dbobject.GetSummaryInformation(1)
prop = info.GetProperty(field)
</code></p></li>
<li><p>if the information you need is in one of the db tables then you should do a sql query against it:
<code>
view = dbobject.OpenView(sql)
rec = view.Execute(params)
str_val = rec.GetString(field)
</code></p></li>
</ol>
</div>
<span class="comment-copy">I tried about the same also, and it was indeed in the right direction. Thanks!!</span>
<span class="comment-copy">The way to do it is: 'import msilib  db = msilib.OpenDatabase(msi_path, msilib.MSIDBOPEN_READONLY)  sum_info = db.GetSummaryInformation(1)  comments = sum_info.GetProperty(msilib.PID_COMMENTS)'</span>
