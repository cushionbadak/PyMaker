<div class="post-text" itemprop="text">
<p>I am making a library that deals with Python modules.  Without getting into details, I need a list of the common Python module extensions.</p>
<p>Obviously, I want <code>.py</code>, but I'd also like to include ones such as <code>.pyw</code>, <code>.pyd</code>, etc.  In other words, I want anything that you can import.</p>
<p>Is there a tool in the standard library which will make this list for me?  Or do I have to make it myself (and hardcode all of the values)?</p>
<pre><code>extensions = ['.py', '.pyw', ...]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This functionality can be found in the <a href="https://docs.python.org/3/library/importlib.html#module-importlib.machinery" rel="nofollow"><code>importlib.machinery</code> module</a>. Inside, there are numerous constants which relate to the various Python module extensions:</p>
<pre><code>&gt;&gt;&gt; import importlib
&gt;&gt;&gt; importlib.machinery.SOURCE_SUFFIXES
['.py', '.pyw']
&gt;&gt;&gt; importlib.machinery.OPTIMIZED_BYTECODE_SUFFIXES
['.pyo']
&gt;&gt;&gt; importlib.machinery.EXTENSION_SUFFIXES
['.pyd']
&gt;&gt;&gt; importlib.machinery.DEBUG_BYTECODE_SUFFIXES
['.pyc']
&gt;&gt;&gt;
</code></pre>
<p>So, you could very easily join these into a global set<sup>1</sup>:</p>
<pre><code>&gt;&gt;&gt; set(importlib.machinery.SOURCE_SUFFIXES +
...     importlib.machinery.OPTIMIZED_BYTECODE_SUFFIXES +
...     importlib.machinery.EXTENSION_SUFFIXES +
...     importlib.machinery.DEBUG_BYTECODE_SUFFIXES)
{'.pyw', '.py', '.pyd', '.pyc', '.pyo'}
&gt;&gt;&gt;
</code></pre>
<hr/>
<p>You might also be interested in the <a href="https://docs.python.org/3/library/importlib.html#importlib.machinery.all_suffixes" rel="nofollow"><code>all_suffixes</code> function</a>:</p>
<pre><code>&gt;&gt;&gt; importlib.machinery.all_suffixes()
['.py', '.pyw', '.pyc', '.pyd']
&gt;&gt;&gt;
</code></pre>
<p>Note however that this function will replace <code>.pyc</code> with <code>.pyo</code> if Python is launched with either the <a href="https://docs.python.org/3/using/cmdline.html#miscellaneous-options" rel="nofollow"><code>-O</code> or <code>-OO</code> options</a>.  To avoid this, you can do:</p>
<pre><code>&gt;&gt;&gt; set(importlib.machinery.all_suffixes() +
...     importlib.machinery.OPTIMIZED_BYTECODE_SUFFIXES +
...     importlib.machinery.DEBUG_BYTECODE_SUFFIXES)
{'.pyw', '.py', '.pyd', '.pyc', '.pyo'}
&gt;&gt;&gt;
</code></pre>
<p>This will ensure that both <code>.pyc</code> and <code>.pyo</code> are in the set.</p>
<hr/>
<p>Finally, you should be wary of <code>importlib.machinery.BYTECODE_SUFFIXES</code>.  As @MartijnPieters noted in the comments, it will always be equal to either <code>OPTIMIZED_BYTECODE_SUFFIXES</code> or <code>DEBUG_BYTECODE_SUFFIXES</code>.  This means that if you add it to the collection, you will get either a duplicated <code>.pyc</code> or a duplicated <code>.pyo</code> value (unless you use a set of course).</p>
<p>From the <a href="https://docs.python.org/3/library/importlib.html#importlib.machinery.BYTECODE_SUFFIXES" rel="nofollow">docs</a>:</p>
<blockquote>
<p><code>importlib.machinery.BYTECODE_SUFFIXES</code></p>
<p>A list of strings representing the recognized file suffixes for bytecode modules. Set to either <code>DEBUG_BYTECODE_SUFFIXES</code> or
  <code>OPTIMIZED_BYTECODE_SUFFIXES</code> based on whether <code>__debug__</code> is true.</p>
</blockquote>
<p>I didn't bother using this constant however because I want both <code>OPTIMIZED_BYTECODE_SUFFIXES</code> and <code>DEBUG_BYTECODE_SUFFIXES</code> in the collection.  So, there is no reason to add it.</p>
<hr/>
<p><sup>1</sup>I decided to use a set because they have a faster lookup time than lists.  Meaning, they are better suited for a global collection of values that will not change and which needs no particular order.  In addition, they will ensure that we do not accidentally add duplicate extensions to the collection.</p>
</div>
<span class="comment-copy">Note that <code>all_suffixes()</code> also includes <i>extension modules</i>; on Mac this gives <code>['.py', '.pyc', '.cpython-34m.so', '.abi3.so', '.so']</code> for example.</span>
<span class="comment-copy">Also, append either <code>importlib.machinery.OPTIMIZED_BYTECODE_SUFFIXES</code> or <code>importlib.machinery.DEBUG_BYTECODE_SUFFIXES</code>, which ever is <i>not</i> equal to <code>importlib.machinery.BYTECODE_SUFFIXES</code>. Otherwise you'll have <code>.pyo</code> <i>twice</i> when running with <code>-O</code> or <code>-OO</code>.</span>
<span class="comment-copy">Yes, a set would be better still. See the [<code>importlib.machinery.BYTECODE_SUFFIXES</code>](<a href="https://docs.python.org/3/library/importlib.html#importlib.machinery.BYTECODE_SUFFIXES" rel="nofollow noreferrer">docs.python.org/3/library/â€¦</a><code>) documentation: *Set to either </code>DEBUG_BYTECODE_SUFFIXES` or <code>OPTIMIZED_BYTECODE_SUFFIXES</code> based on whether <code>__debug__</code> is true.*</span>
