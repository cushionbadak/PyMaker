<div class="post-text" itemprop="text">
<p>So, i wrote this code last week and everything ran just fine. I'm able to download the file, but now it's throwing me an error message when it tries to send the email.  I've looked around and i can't seem to find anything that specifically address this issue.  </p>
<p>UnicoderEncodeError: 'ascii' codec can't encode characters in position 651-652: ordinal not in rande(128)</p>
<p>Any and all help is appreciated. </p>
<pre><code>from selenium import webdriver
from selenium.webdriver.support.ui import Select
from selenium.webdriver.common.by import By
import smtplib
from email.mime.multipart import MIMEMultipart
from email.mime.text import MIMEText
from email.mime.base import MIMEBase
from email import encoders
import time
import os

#eliminates the "save as" pop-up
download_dir = 'C:/Users/rkrouse/Desktop/Python/AZ'
fp = webdriver.FirefoxProfile()
fp.set_preference("browser.download.folderList",2)
fp.set_preference("browser.download.manager.showWhenStarting", False)
fp.set_preference("browser.download.dir", download_dir)
fp.set_preference("browser.helperApps.neverAsk.saveToDisk", "application/vnd.ms-excel")

driver = webdriver.Firefox(firefox_profile=fp)

#navigate to website
driver.get('https://www.azroc.gov/roc/postinglist.html')

#click to download file
driver.find_element_by_partial_link_text("Dual").click()
time.sleep(5)

#sets up email delivery
EMAIL_SERVER = 'yada'
EMAIL_PORT = 25
EMAIL_FROM = 'yada'
RECIPIENT_LIST = ['yada']

msg = MIMEMultipart()
msg['From'] = EMAIL_FROM
msg['To'] = ", ".join(RECIPIENT_LIST)
msg['Subject'] = 'Arizona Dual Contractors List'

#email content
message = """&lt;html&gt;
&lt;body&gt;
Attached is the Arizona Contractors Spreadsheet.
&lt;br&gt;&lt;br&gt;

Let me know if you have any questions

&lt;/body&gt;
&lt;/html&gt;
"""

msg.attach(MIMEText(message, 'html'))

#attaches file to email
filename = r'C:\Users\rkrouse\Downloads\active_contractor_dual.xls'
attachment = open(filename, 'rb')

part = MIMEBase('application','octet-stream')
part.set_payload(attachment.read())
encoders.encode_base64(part)
part.add_header('Content-Disposition','attachment; filename= '+filename)

msg.attach(part)

#sends email
smtpserver = smtplib.SMTP(EMAIL_SERVER, EMAIL_PORT)
smtpserver.sendmail(EMAIL_FROM, RECIPIENT_LIST, msg.as_string())
smtpserver.quit()

#closes file and deletes from directory
attachment.close()
os.remove(filename) 
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>encoders.encode_base64(part) 
</code></pre>
<p>needed to be added when setting payload and header.  Code in question has been corrected to reflect solution. </p>
</div>
<span class="comment-copy">Looks like your attachment is not ascii compliant. Why dont you try converting it to unicode <a href="https://docs.python.org/3/howto/unicode.html" rel="nofollow noreferrer">docs.python.org/3/howto/unicode.html</a></span>
<span class="comment-copy">I also noticed that <code>download_dir</code> is different than <code>filename</code>. So the program is downloading one file and then trying to send another.</span>
<span class="comment-copy">so this is the traceback i'm getting: Traceback (most recent call last):   File "Az_CurrentContractorList_New_9-17.py", line 67, in &lt;module&gt;     smtpserver.sendmail(EMAIL_FROM, RECIPIENT_LIST, msg.as_string())   File "C:\Users\rkrouse\Desktop\Python\lib\smtplib.py", line 855, in sendmail     msg = _fix_eols(msg).encode('ascii')</span>
<span class="comment-copy">encoders.encode_base64(part) did the trick. I updated the code to reflect changes.  Thanks for the help.</span>
