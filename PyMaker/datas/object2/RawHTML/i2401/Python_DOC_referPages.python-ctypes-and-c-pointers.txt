<div class="post-text" itemprop="text">
<p>C++ funtion:</p>
<pre class="lang-cpp prettyprint-override"><code>DLLENTRY int VTS_API
    SetParamValue( const char *paramName, void *paramValue ) //will return zero(0) in the case of an error
  {
    rtwCAPI_ModelMappingInfo* mmi = &amp;(rtmGetDataMapInfo(PSA_StandAlone_M).mmi);
    int idx = getParamIdx( paramName );
    if (idx&lt;0) {
      return 0;                        //Error
    }

    int retval = capi_ModifyModelParameter( mmi, idx, paramValue );
    if (retval == 1 ) {
      ParamUpdateConst();
    }

    return retval;
  }
</code></pre>
<p>and my Python code:</p>
<pre class="lang-py prettyprint-override"><code>import os
from ctypes import *

print(os.getcwd())
os.chdir(r"C:\MY_SECRET_DIR")
print(os.getcwd())

PSAdll=cdll.LoadLibrary(os.getcwd()+"\PSA_StandAlone_1.dll")

setParam=PSAdll.SetParamValue
setParam.restype=c_int

setParam.argtypes=[c_char_p, c_void_p]

z=setParam(b"LDOGenSpdSetpoint", int(20) )
</code></pre>
<p>returns</p>
<pre><code>z=setParam(b"LDO_PSA_GenSpdSetpoint01", int(20) )
WindowsError: exception: access violation reading 0x00000020
</code></pre>
<p>Any idea what can help?
I already tried <code>POINTER</code> and <code>byref()</code>, but I am getting the same output</p>
</div>
<div class="post-text" itemprop="text">
<p><em>SetParamValue</em> expects a pointer (<em>void*</em> or <em>c_void_p</em>) as the 2<sup>nd</sup> argument, but you're passing an <em>int</em>. <br/>The function will interpret it as a pointer (memory address), and when attempting to dereference it (to get its content), it will <em>segfault</em> (<em>Access Violation</em>), as the process doesn't have permissions on that address.</p>
<p>To fix the problem, pass the proper arguments to the function:</p>
<pre class="lang-py prettyprint-override"><code>z = setParam(b"LDOGenSpdSetpoint", pointer(c_int(20)))
</code></pre>
<p>You can find more details on <a href="https://docs.python.org/3/library/ctypes.html#module-ctypes" rel="nofollow noreferrer">[Python 3]: ctypes - A foreign function library for Python</a>.</p>
</div>
<span class="comment-copy">What does <code>capi_ModifyModelParameter</code> do with the <code>paramValue</code> pointer? Though passing a "random" integer like 20 is pretty much never correct</span>
<span class="comment-copy">Just a quick hint: it is generally not recommended to use <code>ctypes</code> directly. <a href="https://cffi.readthedocs.io/en/latest/using.html" rel="nofollow noreferrer">cffi</a> provides a much easier and robust interface.</span>
