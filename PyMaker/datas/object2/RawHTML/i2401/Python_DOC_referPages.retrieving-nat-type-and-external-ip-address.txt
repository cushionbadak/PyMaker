<div class="post-text" itemprop="text">
<p>So far I tried using <a href="https://github.com/jtriley/pystun" rel="nofollow noreferrer">pystun</a>, but following the manual:</p>
<pre><code>import stun
nat_type, external_ip, external_port = stun.get_ip_info()
</code></pre>
<p>yields:</p>
<pre><code>&gt;&gt;&gt; import stun
&gt;&gt;&gt; nat_type, external_ip, external_port = stun.get_ip_info()
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/usr/local/lib/python3.6/dist-packages/stun/__init__.py", line 253, in get_ip_info
    stun_host=stun_host, stun_port=stun_port)
  File "/usr/local/lib/python3.6/dist-packages/stun/__init__.py", line 186, in get_nat_type
    _initialize()
  File "/usr/local/lib/python3.6/dist-packages/stun/__init__.py", line 93, in _initialize
    dictValToAttr.update({items[i][1]: items[i][0]})
TypeError: 'dict_items' object does not support indexing
</code></pre>
<p>It looks like the repository is not maintained anymore. I found <a href="https://github.com/phoemur/ipgetter" rel="nofollow noreferrer">ipgetter</a> superfast for obtaining IP address, unfortunately it does not provide NAT type information. </p>
<p>What is the alternative way to retrieve both efficiently?</p>
</div>
<div class="post-text" itemprop="text">
<p>It probably is a problem with <code>python</code> versions, the original code of <code>pystun</code> using <code>2.x</code> and you using <code>3.x</code>.</p>
<p>Looking at the <a href="https://github.com/jtriley/pystun/blob/develop/stun/__init__.py#L93" rel="nofollow noreferrer">source code line where error originates</a>, we can see that it calls the dictionaries <code>.items()</code> method and tries to access its members by position.</p>
<p>Here is the problem:</p>
<ul>
<li>In <code>python 2.x</code>, <a href="https://docs.python.org/2.7/library/stdtypes.html#dict.items" rel="nofollow noreferrer"><code>dict.items()</code></a> returns a list of tuples.</li>
<li>In <code>python 3.x</code>, <a href="https://docs.python.org/3/library/stdtypes.html#dict.items" rel="nofollow noreferrer"><code>dict.items()</code></a> returns a <a href="https://docs.python.org/3/library/stdtypes.html#dict-views" rel="nofollow noreferrer">view</a>, which cannot be accessed by position, only iterated over.</li>
</ul>
<p>Short answer: you cannot use the <code>pystun</code> repo with <code>python 3.x</code>; maybe some patching can be done, or you can just copy and modify the source code yourself instead of relying on the external repo.</p>
</div>
