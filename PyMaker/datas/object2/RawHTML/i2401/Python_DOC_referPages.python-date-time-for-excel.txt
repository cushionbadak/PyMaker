<div class="post-text" itemprop="text">
<p>How to convert following dates in excel in float values by Python.</p>
<p>Problem Statement: I have a dates data in which dates are entered but users and users used different cell format to enter dates.For example some used cell format as<code>dd-yy-yyyy</code> and some used <code>mm-dd-yyyy</code> in excel cell while entering the data  ( in fact user used different excel format for dates in their files).When I am trying to consolidate dates then find that dates are  in different cell formats randomly. In excel I can copy dates column and paste all in a separate column as a value only,It gives me integer value which is same regardless and format used in cell. And later applied a single format to all value and gets all my dates in same format.</p>
<p>But , I want to make a script in Python in which first: all different cell formats for dates are converted to float value (like i do in excel) then I will convert all dates back to standard format i.e <code>dd/mm/yyyy</code>.</p>
<p>Formet  Dates   format  Date in numeric value   Reformatted in excle as  dd-mm-yyyy
format 1    30-08-2018  dd-mm-yyyy  43342.51551 30-08-2018
format 2    08-30-2018  mm-dd-yyyy  43342.51551 30-08-2018</p>
</div>
<div class="post-text" itemprop="text">
<p>No script can tell you, if 03-05-2014 means 3rd May or 5th March. It's not God and can't do, what you're unable to do.</p>
<p>Only clues:</p>
<ul>
<li><p>If some value consists of four digits, it's the year.</p></li>
<li><p>If one value is higher than twelve, you can say that this value must be the day (or the year)</p></li>
<li><p>If there are several date values by the same user, you may presume that he or she kept consistlently one format and deduce the format from another field.</p></li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>Before answering your question, you need to know the special term for:</p>
<blockquote>
<p>dates in excel in float values</p>
</blockquote>
<p>which is actually so called <a href="http://www.cpearson.com/excel/datetime.htm" rel="nofollow noreferrer"><strong>Serial Date</strong></a> in excel</p>
<h3>Answer</h3>
<p>Assuming that the frameworks you use to read excel file does not convert cell values according to their format.</p>
<p>The easiest way to achieve this is first manually set the format of cells with dates value to Number format to get the <em>serial date</em> value.</p>
<p>Then, when you read the excel file you can convert <em>serial date</em> to <em>datetime</em> object with the following method:</p>
<pre><code>def serial_to_datetime(serial):
    """ Convert excel serial date to :class:`datetime` """
    # 30/12/1899 used instead of 01/01/1900 in order to offset 2 days due to, serial counting &amp; excel leap year bug
    dt = datetime.fromordinal(datetime(1899, 12, 30).toordinal() + int(serial))
    h, r = divmod(serial % 1 * 24, 1)
    m, r = divmod(r * 60, 1)
    return dt.replace(hour=int(h), minute=int(m), second=int(r * 60))
</code></pre>
<p>Now, you may then convert to any format you want with <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime.strftime" rel="nofollow noreferrer">datetime.strftime</a></p>
</div>
<span class="comment-copy"><i>"I want to make a script"</i> - So did you make the script? Or you mean you want someone <i>here</i> to make the script?</span>
<span class="comment-copy">Do you have any way to tell if a date is DD-MM-YYYY or MM-DD-YYYY? Any indicator in the other columns in the Excel file?</span>
<span class="comment-copy">1. I don't get the question, what exactly is your problem? 2. How can you convert a date into a float if you don't know how to interpret it?</span>
<span class="comment-copy">Yes rdimaio , in excel , we can see the date display format of cell , But i am looking for a way  to find it via python ,that python can tell me that the date dispaly format of cell is dd-mm-yyyy or mm-dd-yyy</span>
<span class="comment-copy">Thanks ,but converting any date format in float will tell the real date in excel, that why i asked this question</span>
<span class="comment-copy">Interesting: how would Excel do that?</span>
<span class="comment-copy">But I believe somewhere in Excel you set the format the date is compliant to, right?</span>
<span class="comment-copy">in excel all format converts to standerd value in float for example</span>
<span class="comment-copy">Of course, but you told excel whether your 8 is the month or the day. I believe that March 5th or May 3rd will have different floating point numbers and the point is that you don't know how to tell Excel whether your 3 is the month or the day. Or am I missing somwthing?</span>
