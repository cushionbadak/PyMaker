<div class="post-text" itemprop="text">
<p>I am trying to convert code that was previously written for <code>Python 2.7</code> to code that will work in <code>Python 3.4</code>. The code is below and I had to change <code>urllib2.urlopen()</code> to <code>urllib.request.urlopen()</code>. However, this change resulted in the error <code>TypeError: string argument expected, got 'bytes'</code> in the line <code>compressedFile.write(response.read())</code>. </p>
<pre><code>import os
import urllib2
import gzip
try:
    from StringIO import StringIO
except ImportError:
    from io import StringIO
import pandas as pd

baseURL = "http://ec.europa.eu/eurostat/estat-navtree-portlet-prod/BulkDownloadListing?file="
filename = "data/irt_euryld_d.tsv.gz"
outFilePath = filename.split('/')[1][:-3]

response = urllib2.urlopen(baseURL + filename) #Changed this to urllib.request.urlopen()
compressedFile = StringIO()
compressedFile.write(response.read())
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You should decode the bytes before passing it to the write function</p>
<pre><code>compressedFile = StringIO()
compressedFile.write(response.read().decode("utf-8"))
</code></pre>
<p>Also see <a href="https://docs.python.org/3/library/stdtypes.html#bytes.decode" rel="nofollow">the docs</a>. <code>"utf-8"</code> may be omitted because it's the default, but explicit is better than implicit ;-)</p>
</div>
<div class="post-text" itemprop="text">
<p>Append a call to <code>decode()</code> to decode the <code>bytes</code> into a <code>str</code>. </p>
<pre><code>compressedFile.write(response.read().decode())
</code></pre>
</div>
<span class="comment-copy">@TimCastlijns Thank You. However, I get the error <code>UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte</code>.</span>
<span class="comment-copy">@user131983 try with <code>response.read().decode("utf-8", errors="ignore")</code>. Note that while that should make it work, it will leave out the bytes it can't convert.</span>
<span class="comment-copy">@TimCastlijns Thanks. But, that resulted in the error <code>TypeError: can't concat bytes to str</code></span>
<span class="comment-copy">@user131983 on what line?</span>
<span class="comment-copy">Sorry its in a different line of code that I haven't posted here. I'll create a new question for it as again I don't know how to deal with it.</span>
