<div class="post-text" itemprop="text">
<p>I'm having some trouble with Python mock() and I'm not familiar enough to figure out what's going on with it.</p>
<p>I have an abstract async task class that looks something like:</p>
<pre><code>class AsyncTask(object):
    @classmethod
    def enqueue(cls):
        ....
        task_ent = cls.createAsyncTask(body, delayed=will_delay)
        ....
</code></pre>
<p>I'd like to patch the createAsyncTask method for a specific instance of this class.</p>
<p>The code I wrote looks like:</p>
<pre><code>@patch.object(CustomAsyncTaskClass, "createAsyncTask")
def test_my_test(self, mock_create_task):
    ....
    mock_create_task.return_value = "12"
    fn()    # calls CustomAsyncTaskClass.enqueue(...)
    ....
</code></pre>
<p>When I print out task_ent in enqueue, I get <code>&lt;MagicMock name='createAsyncTask()' id='140578431952144'&gt;</code></p>
<p>When I print out <code>cls.createAsyncTask</code> in enqueue, I get <code>&lt;MagicMock name='createAsyncTask' id='140578609336400'&gt;</code></p>
<p>What am I doing wrong? Why won't createAsyncTask return 12?</p>
</div>
<div class="post-text" itemprop="text">
<p>Try the following:</p>
<pre><code>@patch("package_name.module_name.createAsyncTask")
def test_my_test(self, mock_create_task):
    ....
    mock_create_task.return_value = "12"
    fn()    # calls CustomAsyncTaskClass.enqueue(...)
    ....
</code></pre>
<p>where <code>module_name</code> is the name of the module which contains the class <code>AsyncTask</code>.</p>
<p>In general, this is the guideline <a href="https://docs.python.org/3/library/unittest.mock.html#where-to-patch" rel="nofollow">https://docs.python.org/3/library/unittest.mock.html#where-to-patch</a></p>
</div>
<span class="comment-copy">ack, ignore this -- I had the arguments for something backwards. I can't figure out how to delete the question, sorry =(</span>
<span class="comment-copy">It would be much better if you wrote the answer (no matter how ridiculous) and accepted it.</span>
