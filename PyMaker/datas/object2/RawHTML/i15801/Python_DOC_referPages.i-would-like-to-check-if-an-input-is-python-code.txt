<div class="post-text" itemprop="text">
<p>I would like to check if an input is code before joining it to a larger variable to eventually execute, is there any way I can do this?
For example:</p>
<pre><code>import readline
while True:
    codelines=[]
    code=raw_input("&gt;&gt;&gt; ")
    if code.iscode():
        codelines.append(code)
    elif x=="end":
        break
    else:
        print "Not usable code."
fullcode="\n".join(codelines)
try:
    exec fullcode
except Exception, e:
    print e
</code></pre>
<p>But I know of no command that works like <code>.iscode()</code></p>
</div>
<div class="post-text" itemprop="text">
<p>You could try parsing the input with <a href="https://docs.python.org/3/library/ast.html#ast.parse" rel="nofollow"><code>ast.parse</code></a>:</p>
<pre><code>import ast
while True:
    codelines=[]
    code=raw_input("&gt;&gt;&gt; ")
    try:
        ast.parse(code)  # Try to parse the string.
    except SyntaxError:
        if x=="end":  # If we get here, the string contains invalid code.
            break
        else:
            print "Not usable code."
    else:  # Otherwise, the string was valid.  So, we add it to the list.
        codelines.append(code)
</code></pre>
<p>The function will raise a <code>SyntaxError</code> if the string is non-parseable (contains invalid Python code).</p>
</div>
<span class="comment-copy">I would be VERY careful allowing a user to enter code that will be run. I would recommend removing certain words like <code>import</code> from any entered text. To avoid things like this <code>__import__('os').system('rm -rf /')</code> from being run.</span>
<span class="comment-copy">Thank you! This helps alot!</span>
<span class="comment-copy">Of course, you are aware that accepting user input and executing it (whether in Python or sql or whatever) is just a massive security risk?  Especially with Python which can easily do something very nasty by invoking system level commands.  "import shutil;  shutil.rmtree("~")", for example.</span>
<span class="comment-copy">I just want to reiterate what @JLPeyret said. It is EXTREMELY risky to accept user input that will be run.</span>
<span class="comment-copy">+1 for @JLPeyret - if your design needs arbitrary input of python code, rethink your design - maybe implementing a subset ...</span>
<span class="comment-copy">@PeterWood - Yes, that is correct.  <code>ast.parse</code> will not execute the string, only parse it into a code object.</span>
