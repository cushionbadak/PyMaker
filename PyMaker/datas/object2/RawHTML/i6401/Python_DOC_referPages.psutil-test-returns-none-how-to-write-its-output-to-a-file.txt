<div class="post-text" itemprop="text">
<p>I'm trying to write the <code>psutil.test()</code> result to a file but instead it prints out the text that I want in the file and writes "None" to the <code>test.txt</code>.</p>
<pre><code>import psutil
from time import sleep
while True:
    proccesses = psutil.test()
    file = open("test.txt", "a")
    file.write(str(proccesses))
    file.write("\n" * 10)
    file.close()
    sleep(5)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><code>psutil.test()</code> just prints to <code>stdout</code> but returns <code>None</code>.</p>
<p>You could use <a href="https://docs.python.org/library/contextlib.html#contextlib.redirect_stdout" rel="nofollow noreferrer"><code>contextlib.redirect_stdout</code></a> to redirect the standard output (e.g. when using <code>print</code>) to a file:</p>
<pre><code>import contextlib
import time
import psutil

while True:
    with open("test.txt", 'a') as fout, contextlib.redirect_stdout(fout):
        psutil.test()
        print("\n" * 10)
    time.sleep(5)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><code>psutil.test()</code> doesn't return a string. It prints a string. A workaround would be to use <code>contextlib.redirect_stdout</code>, so that string goes to your file instead of <code>STDOUT</code>.</p>
<pre><code>import psutil
from contextlib import redirect_stdout
from time import sleep

with open("test.txt", "a") as file:
    with redirect_stdout(file):
        while True:
            psutil.test()  # Will print to file.
            file.write("\n" * 10)  # or print("\n" * 10)
            sleep(5)
</code></pre>
<p>Be sure to use both context managers (the <code>with</code> statements), or your file won't be flushed and closed. The <a href="https://docs.python.org/3/library/contextlib.html#contextlib.redirect_stdout" rel="nofollow noreferrer"><code>redirect_stdout</code> documentation</a> uses separate context managers for the file and the redirection.</p>
</div>
<span class="comment-copy">I'm guessing <code>psutil.test()</code> is producing output to <code>stdout</code> or the like, not intended to return output to the user. A function that doesn't have an explicit return value returns <code>None</code>. Check the docs for the function to see how it's supposed t owork.</span>
<span class="comment-copy">Does this close the file?</span>
<span class="comment-copy">@AryaMcCarthy Yes, upon leaving the context manager it flushes and closes the file :)</span>
<span class="comment-copy">I'm not so sure, since the file handle returned by <code>open()</code> isn't treated as a context manager itself. Also, it should be opened with mode <code>'a'</code> for append.</span>
<span class="comment-copy">@AryaMcCarthy I'm pretty sure it closes the file but you're right putting it in a contextmanager isn't hard.</span>
<span class="comment-copy">The <a href="https://docs.python.org/3/library/contextlib.html#contextlib.redirect_stdout" rel="nofollow noreferrer"><code>redirect_stdout</code> documentation</a> uses separate context managers for the file and the redirection.</span>
