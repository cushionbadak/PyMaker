<div class="post-text" itemprop="text">
<p>I have multiple files formatted as shown below and tab delimited. The bing column contains multiple values as shown below. File is named file1.txt</p>
<pre><code>#searchE    google     yahoo     bing
  1           0         2         h=1;d=-0.2;f=0.5;i=3 
  1           0         2         h=2;d=-0.6;f=1.2;i=1
</code></pre>
<p>What I am trying to do is to find the maximum value of d under the bing column. For this case the max will be -0.2 and print out the entire row with all the headers and values. I also wish to have the filename from which the row originated from printed at the start of the row. My final file will contain something like:</p>
<pre><code>              #searchE    google     yahoo     bing
file1.txt      1           0         2         h=1;d=-0.2;f=0.5;i=3
</code></pre>
<p>I am currently stuck and not even sure how to proceed. This is what I have so far:</p>
<pre><code>def main(infile, outFile):

    firstfile = []

    rIndex = 0;
    cIndex = 0;

    ignore = 1;

    prefix = "";

    with open(infile) as f:
        for line in f:
            rows = line.split("\t");

            if(rows[0] == "#searchE"):
                ignore = 0;
            elif(ignore == 1):
                prefix += line

            if(ignore == 0):
                for i in range(len(rows)):
                    rows[i] = rows[i].strip();

                    if i = 4 and 'd=' in rows[i]:
                        return 
</code></pre>
<p>I am learning, I think I am on the right path but still a long way to go. Please if you could give some explanation on an answer to help me learn, I will appreciate it. Thank you in advance</p>
</div>
<div class="post-text" itemprop="text">
<p>Using the standard's library's <a href="https://docs.python.org/2/library/csv.html" rel="nofollow noreferrer"><code>csv</code></a> module and <a href="https://docs.python.org/3/library/functions.html#max" rel="nofollow noreferrer"><code>max</code></a> with a key function and assuming the fourth column is as regular as you present it:</p>
<pre><code>import csv
with open(infile) as f:
    reader = csv.reader(f, delimiter='\t')
    next(reader)  # only if you have to skip headers
    final_row = max(reader, key=lambda r: float(r[3].split(';')[1].split('=')[1]))

with open(outfile, 'wb') as f2:
    writer = csv.writer(f, delimiter='\t')
    writer.writerow([outfile] + final_row)
</code></pre>
<p><code>reader</code> is an iterator producing lists of strings. Each string is a field in a csv row. The key function of the <code>max</code> call takes the 4th field ([3]) of a row, splits it on <code>';'</code>, takes the second token of the resulting list ('d=x'), splits again, this time on <code>'='</code>, takes the second part of that split and finally turns it into a float. This float is used to determine the row with the max value: <code>final_row</code>.</p>
</div>
<span class="comment-copy">If you're willing to learn <a href="http://pandas.pydata.org/" rel="nofollow noreferrer">pandas</a>, it will greatly simplify the file parsing and the max value function.</span>
<span class="comment-copy">Or if you want to do this just using plain Python you can read this data more easily using the standard <code>csv</code> module.</span>
<span class="comment-copy">I have not come around to pandas yet. Just learning the basics in python</span>
<span class="comment-copy">if you don't mind, could you give me a simple breakdown of the final_row here. Thank you</span>
<span class="comment-copy">Updated with an explanation, also noticed that one index was off, <code>d</code> being the second value in bing.</span>
<span class="comment-copy">Awesome thanks for the explanation. So the final_row will then be printed in the file. How will the filename from which it was generated be appended in this case for each file read?</span>
