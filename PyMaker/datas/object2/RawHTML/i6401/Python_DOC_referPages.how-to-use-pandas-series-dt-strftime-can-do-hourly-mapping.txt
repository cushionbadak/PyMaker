<div class="post-text" itemprop="text">
<p>Here's my data:</p>
<pre><code> device_create_at               
136 2014-08-27 17:29:23            
245 2015-09-06 15:46:00            
257 2014-09-29 22:26:34            
258 2014-11-05 13:02:18    
</code></pre>
<p>Here's my expected output</p>
<pre><code>  device_create_at                device_create_hour
136 2014-08-27 17:29:23            2014-08-27 17
245 2015-09-06 15:46:00            2015-09-06 15
257 2014-09-29 22:26:34            2014-09-29 22
258 2014-11-05 13:02:18            2014-11-05 13
</code></pre>
<p>As far as I know, pandas.Series.dt.strftime can do weekly mapping, the code is like this</p>
<pre><code>sheet2['device_create_week'] = sheet2['device_create_at'].dt.strftime('%Y-%V')
</code></pre>
<p>They use <code>%V</code> for week not <code>%W</code>, I try to make this hourly</p>
<pre><code>sheet2['device_create_hour'] = sheet2['device_create_at'].dt.strftime('%Y-%M-%D-%H')
</code></pre>
<p>That is doeesn't work</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>s = df.device_create_at.dt.strftime('%Y-%m-%d %H')
print(s)
136    2014-08-27 17
245    2015-09-06 15
257    2014-09-29 22
258    2014-11-05 13
Name: device_create_at, dtype: object
</code></pre>
<p>Note that the format is <code>%Y-%m-%d %H</code> with small <code>m</code> and small <code>d</code>.</p>
<p>For more info about all directives eg: %M,%m, you can find it in <a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior" rel="nofollow noreferrer">the python documentation</a>.</p>
</div>
<span class="comment-copy">Thanks for reminding me, I already update the question</span>
<span class="comment-copy">OKm my suggestion is right. The problem on my data, error message <code>Can only use .dt accessor with datetimelike values</code></span>
<span class="comment-copy">@NabihIbrahimBawazir The fundamental assumption with this method was that your column is a datetime column. If it's not, you'll need to use <code>pd.to_datetime</code> and convert it: <code>df.device_create_at = pd.to_datetime(df.device_create_at)</code></span>
<span class="comment-copy">yes, I already read this here <a href="https://stackoverflow.com/questions/33365055/attributeerror-can-only-use-dt-accessor-with-datetimelike-values" title="attributeerror can only use dt accessor with datetimelike values">stackoverflow.com/questions/33365055/â€¦</a> , and try <code>pd.to_datetime(df['device_create_at'], coerce=True)</code> and no argument call coerce</span>
<span class="comment-copy">@NabihIbrahimBawazir It's <code>pd.to_datetime(df['Date'], errors='coerce')</code> in newer versions.</span>
<span class="comment-copy">Amazing, that works</span>
