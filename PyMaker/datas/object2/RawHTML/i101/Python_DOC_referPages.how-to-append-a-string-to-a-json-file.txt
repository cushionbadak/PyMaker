<div class="post-text" itemprop="text">
<p>I am trying to append two string variables to a JSON file and I am having problems to achieve that. </p>
<p>Here is my code: </p>
<pre><code>with open('/tmp/' + thisFile, 'w') as csvfile:
        writer = csv.DictWriter(csvfile, fieldnames = ['sim_id', 'data'], delimiter = '\t', lineterminator = '\n')
        counter = 0
        for issue in results.issues:
            counter += 1
            issueMainId = issue.main_id
            print('Writer written line ' + str(counter) + ' issue_id: ' + issueMainId)
            assignedFolderId = (issue.assigned_folder.decode('utf-8'))[:1500]
            print('Writer written line ' + str(counter) + ' folder: ' + assignedFolderId)
            for label in issue.labels:
                labelText = sim.get_label(label.get('id')).label[0]['text']
                print('Writer written line ' + str(counter) + ' Label: ' + labelText)
            folderText = sim.get_folder(flat_attr(issue.assigned_folder)).label[0]['text']
            print('Writer written line ' + str(counter) + ' Folder: ' + folderText)
            print('Writer written line ' + str(counter) + ' labels: ' +     '-'.join(str(v) for v in issue.labels))
            writer.writerow({
                'sim_id': issueMainId,
                'data': json.dumps({
                    a: flat_attr(getattr(issue, a)) for a in dir(issue) if a in attr_list
                })
            })
</code></pre>
<p>to that 'data' in the writerow() function, I want to add two attributes, which are saved in the two variables above (folderText and labelText) so I get two more fields in the data field something like that {"folderName": folderText, "labelName": labelText}</p>
<p>Anyone has an idea how to do that?</p>
</div>
<div class="post-text" itemprop="text">
<p>As is, the parameter to json.dumps is a <em>dict comprehension</em>, so you can't just add key/value pairs to it as it's not a dict literal. What you want to do is first create a dict with the "hard-coded" items:</p>
<pre class="lang-py prettyprint-override"><code>data = {"folderName": folderText, "labelName": labelText}
</code></pre>
<p>then merge the current content of the comprehension to it:</p>
<pre class="lang-py prettyprint-override"><code>data.update((a, flat_attr(getattr(issue, a))) for a in dir(issue) if a in attr_list)
</code></pre>
<p>and finally pass the end-result to <code>dumps</code>:</p>
<pre class="lang-py prettyprint-override"><code>writer.writerow({
    'sim_id': issueMainId,
    'data': json.dumps(data)
})
</code></pre>
<p>Note that in case of conflict this will overwrite the hard-coded data with the comprehension's. You can alternatively update the comprehension's result:</p>
<pre class="lang-py prettyprint-override"><code>data = {
    a: flat_attr(getattr(issue, a)) for a in dir(issue) if a in attr_list
}
data['folderName'] = folderText
data['labelName'] = labelText
</code></pre>
<p>A third alternative would be to use <a href="https://docs.python.org/3/whatsnew/3.5.html#whatsnew-pep-448" rel="nofollow noreferrer">dictionary unpacking</a>, but that does not seem like an improvement in this specific case:</p>
<pre class="lang-py prettyprint-override"><code>writer.writerow({
    'sim_id': issueMainId,
    'data': json.dumps({
        **{ a: flat_attr(getattr(issue, a)) for a in dir(issue) if a in attr_list },
        'folderName': folderText,
        'labelName': labelText
    })
})
</code></pre>
</div>
<span class="comment-copy">Can you please provide input JSON file, expected output and tell us what is <code>results</code>?</span>
<span class="comment-copy">results is an object which contains multiple issue-objects. Each issue has a id, creation_date, status, and other such attributes from attr_list. Inputfile (thisFile) is an empty csv file, in which I want to write  two columns: first is the 'sim_id' and second is 'data'. data has many attributes in form of a json file like: {"main_id": "someMainIDhere", "description": "some description here", "title": "some title here"',  "assigned_folder": "someFolderIDhere} and I want to add two attributes to that data which are saved above in variables, which "labelText" and "folderText"</span>
<span class="comment-copy">exactly what I needed and perfect answer! Thank you!</span>
