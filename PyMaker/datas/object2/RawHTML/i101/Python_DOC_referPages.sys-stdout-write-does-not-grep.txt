<div class="post-text" itemprop="text">
<p>I have a python script that writes to a screen as a startup script. I want to monitor the progress of the server so I go into a loop checking the status. I don't want to write down the screen. Therefore I'm using sys.stdout.write. The issue is that the program I'm using (wlst Weblogic) prints all this logging which I don't want to display. I get around this by using grep and only printing lines that start with a space.</p>
<p>I have this function</p>
<pre><code>def printRoll():
   print ' Is my Print working'
   myTest = ' Hello'
   myTest1 = 'test 123'
   sys.stdout.write("\r %s " % myTest)
   sys.stdout.flush()
   systime.sleep(10)
   sys.stdout.write("\r  %s " % myTest1)
   sys.stdout.flush()
   systime.sleep(10)
</code></pre>
<p>What I want to display is:</p>
<pre><code> Is my Print working
 Hello
</code></pre>
<p>then after 10 seconds Hello is over written with</p>
<pre><code> test 123
</code></pre>
<p>if I run the grep command</p>
<pre><code>python 'printRoll()' | grep '^[[:space:]]\{1\}[A-Za-z0-9]' --line-buffered 
</code></pre>
<p>it only prints the first line</p>
<pre><code>Is my Print working
</code></pre>
<p>It wont print any of the sys.stdout.write lines. I think it is an issue with the buffering but I can't find an example for my issue.</p>
<p>The python script works as expected but it also includes lots of other info I don't want to print to screen.</p>
<p>Any help appreciated.</p>
<p>I believe it is an old version of Python, i.e. 2.7</p>
<p>cheers
James</p>
</div>
<div class="post-text" itemprop="text">
<p>The thing is the other lines aren't new <em>lines</em> as far as <code>grep</code> is concerned, as you are not outputting a <code>\n</code> newline character.</p>
<p>What grep sees is – this output is via <code>xxd</code> for a hex dump so we can see all the characters – the following. <code>0a</code> (on the second line in the dump) is the newline character. You can see that there are no more newline characters (<code>0a</code>s) after that, so there's nothing more for <code>grep</code> to slice the input to lines on.</p>
<pre><code>00000000: 2049 7320 6d79 2050 7269 6e74 2077 6f72   Is my Print wor
00000010: 6b69 6e67 0a0d 2020 4865 6c6c 6f20 0d20  king..  Hello . 
00000020: 2074 6573 7420 3132 3320                  test 123 
</code></pre>
</div>
<span class="comment-copy">With <code>\r</code> you are printing carriage return characters which is not a newline on UNIX. You should use <code>\n</code> to print a newline. However, if you want to do logging, and in particular log some messages to stdout and others to a file, you should look into using the standard <a href="https://docs.python.org/3/library/logging.html" rel="nofollow noreferrer">logging</a> module in Python.</span>
<span class="comment-copy">I don't want a new line I want to replace the line. I assume this means grep will not work, any ideas how I can get this functionality?  I just tried this code as a test and the stdout still did not print      def printRoll():    print ' Is my Print working'    myTest = ' Hello'    myTest1 = 'test 123'    sys.stdout.write("\n %s " % myTest)    #sys.stdout.flush()    systime.sleep(10)    sys.stdout.write("\n  %s " % myTest1)</span>
<span class="comment-copy">Commands like grep are line-oriented. In fact <code>--line-buffered</code> in particular means it won't output anything until it sees a newline. If you want to clear and rewrite messages in place but only want to display certain messages I would recommend using an option to set a verbosity level.</span>
