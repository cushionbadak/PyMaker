<div class="post-text" itemprop="text">
<p>I'm trying to run a Python script in PowerShell. While using <code>sys</code> module I stumble upon a problem of getting the return value of a PowerShell function. The function in question is <code>Date -f 'dd\/MM\/yyyy'</code> that returns <code>14/03/2019</code> and I'd like that value to be used as an argument in the Python script. I've been able so far to get the literal arguments from the command line, e.g. <code>text</code>. </p>
</div>
<div class="post-text" itemprop="text">
<p>This Python script (see <a href="https://docs.python.org/3/library/sys.html#sys.argv" rel="nofollow noreferrer"><code>sys.argv</code> docs</a>):</p>
<pre><code>import sys
print(sys.argv)
</code></pre>
<p>called like this in Powershell:</p>
<pre><code>python .\test.py -date $(Date -f "dd\/MM\/yyyy")
</code></pre>
<p>outputs:</p>
<pre><code>['.\\test.py', '-date', '14/03/2019']
</code></pre>
<p>On a general note, I recommend using better date formats than <code>dd/MM/yyyy</code> - ISO 8061 <code>yyyy-MM-dd</code> would be a good one.</p>
</div>
<div class="post-text" itemprop="text">
<p>If I understand correctly, you want to have the output of the command <code>Date -f 'dd\/MM\/yyyy'</code> to be fed into your python script (<code>script.py</code>).</p>
<p>What you are looking for are so called "pipes" or output redirects. Looking at the officical documentation (<a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-output?view=powershell-6" rel="nofollow noreferrer">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/write-output?view=powershell-6</a>) the following might work:</p>
<pre><code>$DATE=Date -f 'dd/\MM\/yyyy'
Write-Output $DATE | python script.py
</code></pre>
</div>
