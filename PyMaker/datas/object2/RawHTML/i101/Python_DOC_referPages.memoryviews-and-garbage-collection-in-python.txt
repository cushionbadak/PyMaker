<div class="post-text" itemprop="text">
<p>Basically: </p>
<p>If I declare a bytearray somewhere:</p>
<p><code>arr = bytearray(somestr)</code></p>
<p>Then create a memoryview of it:</p>
<p><code>view = memoryview(arr)</code></p>
<p>Can I be sure that for as long as I have a reference to the view object somewhere, that the bytearray will remain?</p>
<p>i.e:</p>
<pre><code>def foo():
    arr = bytearray("hello world")
    return memoryview(arr)

view = foo()
</code></pre>
<p>Will garbage collection ever remove the original bytearray? Or does this count as a reference?</p>
</div>
<div class="post-text" itemprop="text">
<p>It counts as a reference. <em>However</em> you can call <a href="https://docs.python.org/3/library/stdtypes.html#memoryview.release" rel="nofollow noreferrer"><code>release()</code></a> on the view to remove that reference:</p>
<pre><code>&gt;&gt;&gt; class A(bytes):
...     def __del__(self):print('called')
... 
&gt;&gt;&gt; a =A()
&gt;&gt;&gt; m = memoryview(a)
&gt;&gt;&gt; del a
&gt;&gt;&gt; m
&lt;memory at 0x7fddcb00a288&gt;
&gt;&gt;&gt; len(m)
0
&gt;&gt;&gt; m.release()
called
</code></pre>
<p>Note that you can access the underlying object from the view using the <a href="https://docs.python.org/3/library/stdtypes.html#memoryview.obj" rel="nofollow noreferrer"><code>obj</code> attribute</a>.</p>
<p>In generaly, anything that is not described explicitly as a <a href="https://docs.python.org/3/library/weakref.html#module-weakref" rel="nofollow noreferrer">weak reference</a> holds an actual reference. In memory-managed languages that's the default.</p>
</div>
<span class="comment-copy">Thank you so much!</span>
