<div class="post-text" itemprop="text">
<p>I am new to Python. I am running following simple web server:</p>
<pre><code>from wsgiref.simple_server import make_server
from io import BytesIO

def message_wall_app(environ, start_response):
    output = BytesIO()
    status = '200 OK' # HTTP Status
    headers = [('Content-type', 'text/html; charset=utf-8')]
    start_response(status, headers)
    print(b"&lt;h1&gt;Message Wall&lt;/h1&gt;",file=output)
##    if environ['REQUEST_METHOD'] == 'POST': 
##        size = int(environ['CONTENT_LENGTH'])
##        post_str = environ['wsgi.input'].read(size)
##        print(post_str,"&lt;p&gt;", file=output)
##    print('&lt;form method="POST"&gt;User: &lt;input type="text" '
##          'name="user"&gt;Message: &lt;input type="text" '
##          'name="message"&gt;&lt;input type="submit" value="Send"&gt;&lt;/form&gt;', 
##           file=output)         
    # The returned object is going to be printed
    return [output.getvalue()]     

httpd = make_server('', 8000, message_wall_app)
print("Serving on port 8000...")

# Serve until process is killed
httpd.serve_forever()
</code></pre>
<p>Unfortunately i get following error:</p>
<pre><code>Traceback (most recent call last):
  File "C:\Users\xxx\Python36\lib\wsgiref\handlers.py", line 137, in run
    self.result = application(self.environ, self.start_response)
  File "C:/xxx/Python/message_wall02.py", line 9, in message_wall_app
    print("&lt;h1&gt;Message Wall&lt;/h1&gt;".encode('ascii'),file=output)
TypeError: a bytes-like object is required, not 'str'....
</code></pre>
<p>Please suggest what i am doing wrong. thanks.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can't use <code>print()</code> to write to binary files. <code>print()</code> <em>converts arguments to <code>str()</code></em> before writing to a text file object.</p>
<p>From the <a href="https://docs.python.org/3/library/functions.html#print" rel="nofollow noreferrer"><code>print()</code> function documentation</a>:</p>
<blockquote>
<p>Print objects to the <strong>text stream</strong> <em>file</em>, separated by <em>sep</em> and followed by <em>end</em>. [...]</p>
<p><strong>All non-keyword arguments are converted to strings like <code>str()</code> does</strong> and written to the stream, separated by <em>sep</em> and followed by <em>end</em>.</p>
</blockquote>
<p><em>Bold emphasis mine</em>. Note that the file object <em>must</em> be a text stream, not a binary stream.</p>
<p>Either write to a <a href="https://docs.python.org/3/library/io.html#io.TextIOWrapper" rel="nofollow noreferrer"><code>TextIOWrapper()</code> object</a> wrapping your <code>BytesIO()</code> object, call <code>.write()</code> on the <code>BytesIO()</code> object to write <code>bytes</code> objects directly, or write to a <a href="https://docs.python.org/3/library/io.html#io.StringIO" rel="nofollow noreferrer"><code>StringIO()</code> object</a> and encode the resulting string value at the end.</p>
</div>
