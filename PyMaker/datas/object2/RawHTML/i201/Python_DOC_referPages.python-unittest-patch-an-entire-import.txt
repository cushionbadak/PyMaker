<div class="post-text" itemprop="text">
<p>Our product imports the library <code>winreg</code>.</p>
<p>I am writing a test which I would like to mock the entire library.</p>
<p>I do not want to mock specific functions, nor enumerate through all of the functions and mock them. I would like to mock the entire library, such that any instance of the library being imported or used instead uses the mock.</p>
<p>Is this possible?</p>
</div>
<div class="post-text" itemprop="text">
<p>Have you tried <a href="https://docs.python.org/3/library/unittest.mock.html#unittest.mock.patch" rel="nofollow noreferrer">patch</a>?</p>
<p>It is not necessarily intuitive to setup though, <a href="https://docs.python.org/3/library/unittest.mock-examples.html#applying-the-same-patch-to-every-test-method" rel="nofollow noreferrer">Python doc</a> example:
</p>
<pre><code> @patch('mymodule.SomeClass')
 class MyTest(TestCase):
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This is a tricky problem.  I think you're best bet is to have your real library "winreg" in one folder location and your mock library in another location and do some sneaky PYTHONPATH manipulation when you run the unit tests.   </p>
<p>Folder structure and assuming winreg is a python module but could still work if a folder.</p>
<pre><code>real/winreg.py
mock/winreg.py
</code></pre>
<p>When you execute your unit tests if on a Linux system:</p>
<pre><code> PYTHONPATH=&lt;directory to mock&gt;/mock:$PYTHONPATH &lt;command to run unittests&gt;
</code></pre>
<p>When you run the normal code flip the PYTHONPATH back to the "real" library.  You'll just have to make sure that the real library isn't picked up in your PYTHONPATH when running the unit tests which could be tricky depending on your set up.</p>
</div>
<span class="comment-copy">I need to patch an entire imported library. Not some class.</span>
<span class="comment-copy"><code>winreg</code> is a built-in python library, so I cannot do this.</span>
