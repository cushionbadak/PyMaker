<div class="post-text" itemprop="text">
<p>I have a folder full of mp4 clips (over 200). I want to take all those clips, extract their frames and send them to another folder to store all the frames in. This is what I have so far (part of the code) but it's only working when I have one mp4 file in the same folder:</p>
<pre><code>import cv2     # for capturing videos
import math   # for mathematical operations
import matplotlib.pyplot as plt    # for plotting the images
import pandas as pd
from keras.preprocessing import image   # for preprocessing the images
import numpy as np    # for mathematical operations
from keras.utils import np_utils
from skimage.transform import resize   # for resizing images


count = 0
videoFile = "sample_vid.mp4"
cap = cv2.VideoCapture(videoFile)   # capturing the video from the given path
frameRate = cap.get(5) #frame rate
x=1
while(cap.isOpened()):
    frameId = cap.get(1) #current frame number
    ret, frame = cap.read()
    if (ret != True):
        break
    if (frameId % math.floor(frameRate) == 0):
        filename ="frame%d.jpg" % count;count+=1
        cv2.imwrite(filename, frame)
cap.release()
print ("Done!")
</code></pre>
<p>Again, i'm having some trouble dealing with the file directories in python and looping it so that it goes through all the files in another folder and send the frames extracted into another folder.</p>
</div>
<div class="post-text" itemprop="text">
<p>Use <code>glob</code> lib to find all <code>mp4</code> files in your folder. Then run <code>video2frames</code> method against all videos.</p>
<pre><code>import cv2
import math
import glob

def video2frames(video_file_path):
    count = 0
    cap = cv2.VideoCapture(video_file_path)
    frame_rate = cap.get(5)
    while cap.isOpened():
        frame_id = cap.get(1)
        ret, frame = cap.read()
        if not ret:
            break
        if frame_id % math.floor(frame_rate) == 0:
            filename = '{}_frame_{}.jpg'.format(video_file_path, count)
            count += 1
            cv2.imwrite(filename, frame)
    cap.release()

videos = glob.glob('/home/adam/*.mp4')
for i, video in enumerate(videos):
    print('{}/{} - {}'.format(i+1, len(videos), video))
    video2frames(video)
</code></pre>
<p>Tested on two videos. Here is what I've got:</p>
<p><a href="https://i.stack.imgur.com/KfO1B.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/KfO1B.png"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>You can <a href="https://docs.python.org/3/library/os.html#os.walk" rel="nofollow noreferrer">use <code>os.walk</code> to fetch all mp4 names</a> and iterate over them. There are other ways detailed in <a href="https://stackoverflow.com/questions/3964681/find-all-files-in-a-directory-with-extension-txt-in-python">Find all files in a directory with extension .txt in Python</a> (replace txt with mp4).</p>
<p>Create some files to find:</p>
<pre><code>import os

with open("tata.mp4","w") as f: f.write(" ")
with open("tata1.mp4","w") as f: f.write(" ")
with open("tata2.mp4","w") as f: f.write(" ")

os.makedirs("./1/2/3")
with open("./1/subtata.mp4","w") as f: f.write(" ")
with open("./1/2/subtata1.mp4","w") as f: f.write(" ")
with open("./1/2/3/subtata2.mp4","w") as f: f.write(" ")
</code></pre>
<p>Find files:    </p>
<pre><code>startdir = "./"
all_files = []
for root,dirs,files in os.walk(startdir):
    for file in files:
        if file.endswith(".mp4"):
            all_files.append(os.path.join(root,file))

print(all_files) 

for f in all_files:
    # do your thing
</code></pre>
<p>Output:</p>
<pre><code>['./tata2.mp4', './tata1.mp4', './tata.mp4', 
 './1/subtata.mp4', 
 './1/2/subtata1.mp4', 
 './1/2/3/subtata2.mp4']
</code></pre>
</div>
<span class="comment-copy">What error do you have?</span>
<span class="comment-copy">I don't know how to work with the different directories in my code. The functionality is solid for a single file in the same directory, i'm just trying to get it so it goes through all the files and transfers them to a folder.</span>
<span class="comment-copy">So you need to iterate through all your folders</span>
<span class="comment-copy">No, just one folder with all of the mp4 files. I need to extract the frames from that folder of mp4 files and send them to another folder</span>
<span class="comment-copy">where is the video directory in video2frames(video)? Is that referring to where the frames are going? And is that just 'user/doc/folder'?     print('{}/{} - {}'.format(i+1, len(videos), video)) what's the difference between videos and video, I can see that videos is the path for the folder with the mp4s but what is video?</span>
<span class="comment-copy"><code>videos</code> is a list of all videos. <code>video</code> is a path to a single video. so you're pass <code>video</code> to <code>video2frames</code> method, e.g.: <code>video2frames(c:/videos/video.mp4)</code></span>
<span class="comment-copy">OK but where are the frames being sent?</span>
<span class="comment-copy">To the same folder as videos</span>
<span class="comment-copy">it doesn't do anything in the folder when I run it.</span>
