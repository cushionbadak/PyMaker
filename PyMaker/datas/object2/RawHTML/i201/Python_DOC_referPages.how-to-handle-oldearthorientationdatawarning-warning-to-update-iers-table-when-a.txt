<div class="post-text" itemprop="text">
<p>With one of the modules I'm currently using (<a href="https://astroplan.readthedocs.io/en/latest/" rel="nofollow noreferrer">astroplan</a>) it has to download a IERS table in order for the timings in it's Observer objects to be accurate. (I'm using it to workout sunrise/sunset times etc). Problem is after 14 days or so, the table becomes out-of-date and a new one needs to be downloaded. Once the table is out-of-date an <a href="https://astroplan.readthedocs.io/en/latest/api/astroplan.OldEarthOrientationDataWarning.html#astroplan.OldEarthOrientationDataWarning" rel="nofollow noreferrer">OldEarthOrientationDataWarning</a> warning is raised when the module is imported. </p>
<p>What I'd like to do, is detect if the warning is raised, and update the table if there is a warning.</p>
<p>Normally the module is imported using:</p>
<pre><code>&gt;&gt;&gt; from astroplan import Observer
</code></pre>
<p>I know how to update the table manually using:</p>
<pre><code>&gt;&gt;&gt; from astroplan import download_IERS_A
&gt;&gt;&gt; download_IERS_A()
&gt;&gt;&gt; from astroplan import Observer
</code></pre>
<p>I also know that Python has a <a href="https://docs.python.org/3/library/warnings.html" rel="nofollow noreferrer">warnings</a> module, from which I think the catch_warnings function is what I need to be using. There are quite a few examples on how to get code to ignore deprecation warnings, but I don't want to hide the warning. I just can't seem to get my head around how to lay it out to get it to do what I want. </p>
<p>I'm using Python 3, and need the code to work on UNIX machines. </p>
<p>Any help would be appreciated, thanks.</p>
</div>
<div class="post-text" itemprop="text">
<p>I think I've sorted it myself. I'll post the code below in case someone else ever wants to do the same thing.</p>
<pre><code>import warnings

# Set up the thing to catch the warning (and potentially others)
with warnings.catch_warnings(record=True) as w:
    # import the modules
    from astroplan import Observer
    from astroplan import OldEarthOrientationDataWarning
    #One want to know aout the first time a warning is thrown
    warnings.simplefilter("once")

#Look through all the warnings to see if one is OldEarthOrientationDataWarning,
# update the table if it is.
for i in w:
    if i.category == OldEarthOrientationDataWarning:
        # This new_mess statement isn't really needed I just didn't want to print
        #  all the information that is produce in the warning.
        new_mess = '.'.join(str(i.message).split('.')[:3])
        print('WARNING:',new_mess)
        print('Updating IERS bulletin table...')
        from astroplan import download_IERS_A
        download_IERS_A()
</code></pre>
</div>
