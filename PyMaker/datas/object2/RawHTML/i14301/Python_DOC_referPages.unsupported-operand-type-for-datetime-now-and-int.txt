<div class="post-text" itemprop="text">
<p>I want to compute elapsed time from <code>request.session['SESSION_START_TIME']</code> to <code>datetime.datetime.now()</code>. The way I store datetime in <code>request.session['SESSION_START_TIME']</code> is:</p>
<pre><code>request.session['SESSION_START_TIME'] = datetime.datetime.now()
</code></pre>
<p>The way I want to compute elapsed time is:</p>
<pre><code>diff = datetime.datetime.now() - request.session['SESSION_START_TIME']
</code></pre>
<p>But as a result I get this error message <code>unsupported operand type for -: datetime.now and int</code>. I guess the solution is to somehow convert values stored in session, but I do not know how.</p>
</div>
<div class="post-text" itemprop="text">
<p>It appears that your session stores datetime objects as seconds since the UNIX epoch; probably because <code>datetime</code> objects themselves are not serialisable.</p>
<p>Convert back to a <code>datetime</code> object first:</p>
<pre><code>start_time = datetime.datetime.fromtimestamp(request.session['SESSION_START_TIME'])
diff = datetime.datetime.now() - start_time
</code></pre>
<p>You may want to look into <a href="https://docs.djangoproject.com/en/stable/topics/http/sessions/#session-serialization" rel="nofollow noreferrer"><em>Session serialisation</em></a> in the Django documentation if you want to handle <code>datetime</code> objects transparently.</p>
</div>
<span class="comment-copy">Please, do not ask me why I do not use Django models/views, but instead use my own session routines.</span>
<span class="comment-copy">You can use <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime.timestamp" rel="nofollow noreferrer"><code>datetime.timestamp</code></a> and <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime.fromtimestamp" rel="nofollow noreferrer"><code>datetime.fromtimestamp</code></a>.</span>
