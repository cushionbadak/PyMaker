<div class="post-text" itemprop="text">
<p>I am new to Python and would like to write a script to change Windows proxy settings based on the network I am connected to. Is there any existing python module I can use? Appreciate your help.</p>
<p>Thanks,
Sethu</p>
</div>
<div class="post-text" itemprop="text">
<p>I would use <a href="http://docs.python.org/library/_winreg.html" rel="nofollow"><code>winreg</code></a> and query the settings directly from <a href="http://support.microsoft.com/kb/819961" rel="nofollow">the registry</a>. </p>
<pre><code> [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet
 Settings] "MigrateProxy"=dword:00000001 
 "ProxyEnable"=dword:00000001
 "ProxyHttp1.1"=dword:00000000
 "ProxyServer"="http://ProxyServername:80" 
 "ProxyOverride"="&lt;local&gt;"
</code></pre>
<p>For example, something like:</p>
<pre><code>import _winreg

def getProxy():
    proxy = _winreg.OpenKey(_winreg.HKEY_CURRENT_USER, "Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings")
    server, type = _winreg.QueryValueEx(proxy, "ProxyServer")
    enabled, type = _winreg.QueryValueEx(proxy, "ProxyEnable")
    if enabled:
        return server
    return None
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Cannot you set the HTTP_PROXY environment variable in Windows (either manually or within your program) for your application before sending the request? That should take care that any request you send it via urllib2 goes via Proxy. </p>
</div>
<div class="post-text" itemprop="text">
<p>I'm having similar question too. At the moment, I just use <code>os</code> module and using Windows <code>reg</code> command to get the proxy setting from registry. Hope this helps.</p>
<pre><code>&gt;&gt;&gt; import os
&gt;&gt;&gt; os.system('reg query "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings" | findstr "ProxyServer AutoConfigURL"')
    ProxyServer    REG_SZ    http=127.0.0.1:8080;https=127.0.0.1:8080
    AutoConfigURL    REG_SZ    http://proxy/wpad.dat
&gt;&gt;&gt;
</code></pre>
</div>
<span class="comment-copy"><code>404 Not Found</code> <a href="https://docs.python.org/3/library/_winreg.html" rel="nofollow noreferrer">docs.python.org/3/library/_winreg.html</a></span>
