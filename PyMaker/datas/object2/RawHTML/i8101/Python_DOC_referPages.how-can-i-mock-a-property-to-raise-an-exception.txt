<div class="post-text" itemprop="text">
<p>I'm using MagicMock with Python 2.7 to mock objects. One of the classes that I'm mocking has properties, one of which can raise a <code>TypeError</code> in some cases.</p>
<p>I would like to mock that behavior, but I can't figure out how:</p>
<ul>
<li><code>del my_mock.my_property</code> will cause an <code>AttributeError</code> if <code>my_property</code> is accessed, but I need a <code>TypeError</code>.</li>
<li><code>my_mock.my_property = MagicMock(side_effect=TypeError)</code> causes a <code>TypeError</code> when <code>my_property</code> is <em>called</em>, but not when it's merely accessed.</li>
</ul>
<p>How would I do that?</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <code>PropertyMock</code> for this purpose:</p>
<pre><code>import mock

class A(object):

    @property
    def prop(self):
        pass

a = A()
type(a).prop = mock.PropertyMock(side_effect=TypeError)
</code></pre>
<p>If you now access <code>a.prop</code> it'll raise a <code>TypeError</code>.</p>
</div>
<span class="comment-copy">Just an idea: 2nd option + <code>my_mock.my_property = property(my_mock.my_property)</code></span>
<span class="comment-copy">Maybe make the property a class that defines a <a href="https://docs.python.org/3/reference/datamodel.html#object.__delattr__" rel="nofollow noreferrer"><code>__delattr__</code></a> method which changes its behavior when deleted.</span>
<span class="comment-copy">Our maybe it's more accurate to say, define a <code>__delattr__</code> method for the mock object that will change the behavior of the property when it is deleted.</span>
<span class="comment-copy">Our make the property a <a href="https://docs.python.org/3/howto/descriptor.html" rel="nofollow noreferrer">descriptor</a> that does something similar when deleted.</span>
<span class="comment-copy">That looks like what I need, I'll check on Monday. Can I set that on a MagicMock instance as well?</span>
