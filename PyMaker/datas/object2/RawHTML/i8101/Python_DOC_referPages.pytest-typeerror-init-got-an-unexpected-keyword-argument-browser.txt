<div class="post-text" itemprop="text">
<p>I try to add <code>pytest_addoption(parser)</code> in my <code>confest.py</code>. <a href="https://docs.pytest.org/en/latest/example/simple.html" rel="nofollow noreferrer">Here are the official  Pytest docs</a></p>
<p>But if I try to start test I see</p>
<pre><code>TypeError: __init__() got an unexpected keyword argument 'browser'
</code></pre>
<p><code>Confest.py</code></p>
<pre><code>import pytest
from fixture.application import Application
__author__ = 'Max'

fixture = None

@pytest.fixture
def app(request):
    global fixture
    browser = request.config.getoption("--browser")
    if fixture is None:
        fixture = Application(browser=browser)
    else:
        if not fixture.is_valid:
            fixture = Application(browser=browser)
    fixture.session.ensure_login(username="somename", password="somepassword")
    return fixture

def pytest_addoption(parser):
    # hooks for browsers
    parser.addoption("--browser", action="store", default="chrome")
</code></pre>
<p><code>fixture/application.py</code></p>
<pre><code>from selenium import webdriver

class Application:

    def __init__(self,browser):
        if browser == "chrome":
            self.wd = webdriver.Chrome()
        elif browser == "firefox":
            self.wd = webdriver.Firefox()
        else:
            raise ValueError("Unrecognized browser %s" % browser)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<h1>Solution</h1>
<p>You should use <code>Application(browser)</code> (at Confest.py).</p>
<p>Another similar problem: <a href="https://stackoverflow.com/questions/19986089/init-got-an-unexpected-keyword-argument-user">__init__() got an unexpected keyword argument 'user'</a></p>
<h1>Explanation</h1>
<p>When you make <code>Application(browser=browser)</code>, you are trying to use <a href="https://docs.python.org/3/faq/programming.html?highlight=keyword%20parameters#how-can-i-pass-optional-or-keyword-parameters-from-one-function-to-another" rel="nofollow noreferrer">keyword parameters</a>.</p>
<h1>Example with keyword parameter</h1>
<pre><code>from selenium import webdriver


class Application:
    def __init__(self, *args, **kwargs):
        if kwargs['browser'] == "chrome":
            self.wd = webdriver.Chrome()
        elif kwargs['browser'] == "firefox":
            self.wd = webdriver.Firefox()
        else:
            raise ValueError("Unrecognized browser %s" % kwargs['browser'])
</code></pre>
</div>
<span class="comment-copy">Please review the indentation; it's important in Python.</span>
<span class="comment-copy">Thank! Works! Problem solved.</span>
