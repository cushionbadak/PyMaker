<div class="post-text" itemprop="text">
<p>I'm trying to load a .dll from Python. I am using Python 3.0.17114.1 with Visual Studio 2017 Preview. I get an error saying "NameError: name LoadLibrary is not defined". </p>
<p>Here is a code snip (note that theDll comes out perfect):</p>
<pre><code>import ctypes
from ctypes.util import find_library
from ctypes import LibraryLoader
from ctypes.util import find_library    
theDll = find_library('DsiLibrary_dll')
dsi_lib  = LoadLibrary(theDll)
</code></pre>
<p>So I read up on LoadLibrary and there are a few different ways to do it. I tried all I could find:</p>
<pre><code>cdll.LoadLibrary(theDll)
CDLL.LoadLibrary(theDll)
ctypes.CDLL.LoadLibrary(theDll)
ctypes.LoadLibrary(theDll)
</code></pre>
<p>I'm very new at Python so I may have made some silly mistake. Can someone please make a suggestion?</p>
</div>
<div class="post-text" itemprop="text">
<p>You can access <code>LoadLibrary</code> like this:</p>
<pre><code>import ctypes
from ctypes import cdll 
from ctypes.util import find_library    
theDll = find_library('DsiLibrary_dll')
lib = cdll.LoadLibrary(theDll)
# do stuff with lib
</code></pre>
<p><a href="https://docs.python.org/3/library/ctypes.html" rel="nofollow noreferrer">Ctypes documentation</a>:</p>
<blockquote>
<p>On Linux, it is required to specify the filename including the
  extension to load a library, so attribute access can not be used to
  load libraries. Either the LoadLibrary() method of the dll loaders
  should be used, or you should load the library by creating an instance
  of CDLL by calling the constructor:</p>
<pre><code>&gt;&gt;&gt; from ctypes import *
&gt;&gt;&gt; cdll.LoadLibrary("libc.so.6") 
&lt;CDLL 'libc.so.6', handle ... at ...&gt;
&gt;&gt;&gt; libc = CDLL("libc.so.6")       
&gt;&gt;&gt; libc
&lt;CDLL 'libc.so.6', handle ... at ...&gt;
&gt;&gt;&gt;
</code></pre>
</blockquote>
</div>
<span class="comment-copy">I used your Windows method but that gives the same not defined error.</span>
<span class="comment-copy">No error for me, what did you do?</span>
<span class="comment-copy">I did a cut and paste from your post. import ctypes from ctypes import cdll  from ctypes.util import find_library theDll = find_library('DsiLibrary_dll') dsi_lib  = cdll.LoadLibrary(theDll)</span>
<span class="comment-copy">I did too, see it online: <a href="https://repl.it/Hx0h" rel="nofollow noreferrer">repl.it/Hx0h</a></span>
<span class="comment-copy">I'm not sure what you mean by "see it online". Are you talking about the snip you gave me? Maybe this is a bug in VS 2017 Preview Python. What Python are you using?</span>
