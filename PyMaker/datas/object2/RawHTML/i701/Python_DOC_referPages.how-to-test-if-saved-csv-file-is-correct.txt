<div class="post-text" itemprop="text">
<p>I have a small function which returns nothing but creates csv file instead.
I would like to unittest it if given output csv file contains proper data.
How can I achieve that?</p>
<p>function</p>
<pre><code>def create_csv(input, output)
    df = pd.read_csv(input, names=['number1', 'number2'])
    df.number1 *= 2
    df.number2 *= 5
    df.to_csv(output, index=False, header=False)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><code>.to_csv</code> and <code>.read_csv</code> take buffers as well as string paths. <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io-tools-text-csv-hdf5" rel="nofollow noreferrer">The docs for those methods</a> suggest using io.StringIO as an alternative to an open file or file path.</p>
<p>In the unit test,  use <a href="https://docs.python.org/3/library/io.html#io.StringIO" rel="nofollow noreferrer">io.StringIO</a> objects to pass to the function during the test.  Something like this for a simple test of the function</p>
<pre><code>import unittest, io
class TestOne(unittest.TestCase):
    def setUp(self):
        s = '''3,4\n2,1\n5,6'''
        self.fakecsv = io.StringIO(s)
        self.fakefile = io.StringIO()
        self.result = '''6,20\n4,5\n10,30\n'''

    def test_create(self):
        create_csv(self.fakecsv, self.fakefile)
        self.fakefile.seek(0)
        self.assertEqual(self.fakefile.read(), self.result)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Test the data frame just before you persist it to a CSV file. The <a href="https://stackoverflow.com/questions/41852686/how-do-you-unit-test-python-dataframes">NumPy test scripts</a> and <a href="https://pandas.pydata.org/pandas-docs/stable/reference/general_utility_functions.html#testing-functions" rel="nofollow noreferrer">Pandas test functions</a> can be helpful. If you feel you need to test the CSV file itself, you are actually distrusting pandas' <code>to_csv()</code> function. The best course of action then is to <a href="https://github.com/pandas-dev/pandas/wiki/Testing" rel="nofollow noreferrer">review the unit tests of pandas</a>, and if you feel it is lacking do a pull request to amend it with the tests you feel are missing.</p>
</div>
<span class="comment-copy">Print it before saving</span>
<span class="comment-copy">I do not want to print it</span>
<span class="comment-copy">What are you passing to the <code>input</code> and <code>output</code> parameters?</span>
<span class="comment-copy">paths of the input and output file</span>
