<div class="post-text" itemprop="text">
<p>So I have a problem about how to save model instance with foreign key relation,</p>
<p><strong>models.py</strong></p>
<pre><code>class Connect(models.Model):
    username = models.CharField(max_length=255)
    password = models.CharField(max_length=255,null=True, blank=True)
    conft = models.TextField(null=True, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __unicode__(self):
        return unicode(self.username)


class Ip(models.Model):
    class Meta:
        db_table = 'autonet_ip'

    connect_id = models.ForeignKey(Connect, on_delete=models.CASCADE)
    ipaddr = models.CharField(max_length=255)

    def __str__ (self):
        return self.ipaddr
</code></pre>
<p><strong>forms.py</strong></p>
<pre><code>class NacmForm(ModelForm):
    password = forms.CharField(widget=forms.PasswordInput,required = False)
    class Meta:
        model = Connect
        fields = ['username', 'password','conft']

    labels = {'conft':_('Config'),}

class IpForm(ModelForm):

    class Meta:
        model = Ip
        fields = ['ipaddr']
    labels = {'ipaddr':_('IP address'),}


IpFormset = formset_factory(IpForm,  extra=1)
</code></pre>
<p><strong>views.py</strong></p>
<pre><code>def konfig(request):
    ip_list = []
    status = ''
    value_bak = 1

    if request.method == 'POST':
        formm = NacmForm(request.POST or None)
        ipform = IpFormset(request.POST)
        upform = UploadForm(request.POST,request.FILES)
        userValue = formm['username'].value()
        passValue = formm['password'].value()
        confValue = formm['conft'].value()
        usernamef = get_object_or_404(Connect, pk=id)
        if ipform.is_valid():
            for form in ipform:
                ipaddr = form.cleaned_data.get('ipaddr')

                //.... some code ...//

                simpanIp = form.save(commit=False)
                simpanIp.connect_id = usernamef
                simpanIp.save()

            simpanForm.save()

        return HttpResponseRedirect('/konfig')
    else:
        formm = NacmForm()
        ipform = IpFormset()
        return render(request, 'konfig.html', {'form': formm, 'logins': Connect.objects.all(), 'ipform': ipform, 'status': status })
</code></pre>
<p>Then, when I input all data and click submit to collect form data and on <code>simpanIp.save()</code>, I've got an error: <code>id() takes exactly one argument (0 given).</code></p>
<p>I just want to know how to save the instance of <code>Connect</code> model to database with foreign key, thanks before</p>
<hr/>
<p>so i edit my models.py like this</p>
<pre><code>class Connect(models.Model):
......
        def get_usernameinf(self):
            return ', '.join(self.usernameinf.all().values_list('username', flat=True))
</code></pre>
<p>and views.py like this</p>
<pre><code>if request.method == 'POST':
.....some code.....

if ipform.is_valid() and formm.is_valid():
    simpanForm = formm.save()

    for form in ipform:
    simpanIp = form.save(commit=False)
    ...... some code ..
        simpanIp.connect_id = simpanForm
        simpanIp.save()
</code></pre>
<p>and its work, now the result is my "connect_id" got value from "Connect id"</p>
</div>
<div class="post-text" itemprop="text">
<p><code>id</code> is a Python builtin that gives a unique ID for an object. I would guess that you did not intend to pass it <code>get_object_or_404</code> on this line:</p>
<pre><code>get_object_or_404(Connect, pk=id)
</code></pre>
<p>The calling convention for this functions seems to be that it is meant to be an integer for the primary key in a database table. Figure out where you should be getting your primary key from and set it correctly.</p>
<p>Pro-tip: avoid using names that are predefined by Python (see <a href="https://docs.python.org/3/library/functions.html" rel="nofollow noreferrer">here</a> for a full list). It can lead to headaches like the one you just had.</p>
</div>
<span class="comment-copy">Post the full traceback. But what is the id you are passing to get_object_or_404?</span>
<span class="comment-copy">thank for the answer, im not using get_object_or_404(Connect, pk=id) again, i already edit the post and it's work</span>
