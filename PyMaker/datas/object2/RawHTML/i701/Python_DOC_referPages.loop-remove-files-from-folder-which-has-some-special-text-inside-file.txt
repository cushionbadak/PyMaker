<div class="post-text" itemprop="text">
<p>I have folder with many .txt files. I want to remove files from this folder which have words 'Best Regards' inside file.
I wrote simple loop but I still have problem <code>I/O operation on closed file</code>.</p>
<p>Here is my code. </p>
<pre><code>import os, os.path
path = 'H:/UsersData/...'

for f in os.listdir(path):
    with open(os.path.join(path, f), encoding = 'utf-8') as input_data:
        for line in input_data:
            if 'Best Regards' in line:
                input_data.close()
                os.remove(os.path.join(path, f))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use a check flag.</p>
<p><strong>EX:</strong></p>
<pre><code>import os, os.path
path = 'H:/UsersData/...'

deleteFile = False
for f in os.listdir(path):
    with open(os.path.join(path, f), encoding = 'utf-8') as input_data:
        for line in input_data:
            if 'Best Regards' in line:
                deleteFile = True
                break
    if deleteFile:
        os.remove(os.path.join(path, f))
        deleteFile = False
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You need to break the for loop when you find the line containing 'Best Regards'. As you are using a context manager, there is no need to explicitly close the file. The file will be closed when the context manager exits. Then you can delete the file</p>
<pre><code>import os, os.path
path = 'H:/UsersData/...'

for f in os.listdir(path):
    delete_file = False
    with open(os.path.join(path, f), encoding = 'utf-8') as input_data:
        for line in input_data:
            if 'Best Regards' in line:
                delete_file = True
                break
     if delete_file:
         os.remove(os.path.join(path, f))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Get used to using pathlib.  Also you want to make sure you want to delete the files,  you do that by building up a list of files you want to delete first (reviewing them to make sure the logic of the statement is correct) then axing them.  <a href="https://docs.python.org/3/library/pathlib.html" rel="nofollow noreferrer">Documentation</a></p>
<pre><code>from pathlib import Path

path = Path('H:/UsersData/...')
files_to_delete = [f for f in path.iterdir() if f.is_file() and 'Best Regards' in f.read_text()]
for f in files_to_delete:
    f.unlink()
</code></pre>
</div>
<span class="comment-copy">I added continue to the end of if, but it only removed one file, and the error still exits</span>
<span class="comment-copy">My bad, its <code>break</code> not <code>continue</code></span>
<span class="comment-copy">thanks a lot    :)</span>
<span class="comment-copy">You are welcome :)</span>
<span class="comment-copy">And what will happens if the expression not found? your are still delete the file anyway...</span>
<span class="comment-copy">Good point.  Edited for correction</span>
<span class="comment-copy">And now your answer is pretty much like @Rakesh</span>
<span class="comment-copy">Now It works, thanks!</span>
