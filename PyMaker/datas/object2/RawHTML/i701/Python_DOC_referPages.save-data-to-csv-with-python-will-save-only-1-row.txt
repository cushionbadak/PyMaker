<div class="post-text" itemprop="text">
<p>I have simple Python script to save data to CSV file</p>
<pre><code>import csv
import MySQLdb

db = MySQLdb.connect('localhost', db="", user='', passwd='')

cursor = db.cursor()
sql = "SELECT col1, col2, col3, col4, col5 FROM table"

try:
    cursor.execute(sql)

    with open('MyFile.csv', mode='w') as csv_file:
        fieldnames = ['Col1_Name', 'Col2_Name', 'Col3_Name', 'Combined_Col']
        writer = csv.DictWriter(csv_file, fieldnames=fieldnames)

        writer.writeheader()

        results = cursor.fetchall()
        for row in results:
           col1 = row[0]
           col2 = row[1]
           col3 = row[2]
           col4 = row[3]
           col5 = row[4]

           combinedColumns = "%s (count: %s)" % (col4, col5)

           writer.writerow({'Col1_Name': col1, 'Col2_Name' : col2, 'Col3_Name': col3, 'Combined_Col': combinedColumns})

except:
    print("Error: unable to fetch data")

db.close()

print("DONE!")
</code></pre>
<p>but it will save only one row.</p>
<p>What I have missed?</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>import csv
import MySQLdb

db = MySQLdb.connect('localhost', db="", user='', passwd='')

cursor = db.cursor()
sql = "SELECT col1, col2, col3, col4, col5 FROM table"

try:
    cursor.execute(sql)

    with open('MyFile.csv', mode='w', newlines='') as csv_file:
        fieldnames = ['Col1_Name', 'Col2_Name', 'Col3_Name', 'Combined_Col']
        writer = csv.writer(csv_file)

        writer.writerow(fieldnames)

        results = cursor.fetchall()
        for row in results:
           col1 = row[0]
           col2 = row[1]
           col3 = row[2]
           col4 = row[3]
           col5 = row[4]

           combinedColumns = "%s (count: %s)" % (col4, col5)

           writer.writerow(row)

except:
    print("Error: unable to fetch data")

db.close()

print("DONE!")
</code></pre>
</div>
<span class="comment-copy">please share the error log</span>
<span class="comment-copy">try importing sys</span>
<span class="comment-copy">@ShrikantShete I have updated OP. Got data saved but only 1 row</span>
<span class="comment-copy">Don't use a generic try/except; It hides your error, making it harder to debug the code. Remove the try/except and you will see the real error</span>
<span class="comment-copy">@JackTheKnife my point still stands, if you have a generic try/except you're getting a generic "unable to fetch data" instead of the real error. Never do a generic try/except.</span>
<span class="comment-copy">It will fail on that line now.</span>
<span class="comment-copy">my bad, i miss the paramerts</span>
<span class="comment-copy">seeing the log, you try write a dict.... try my code</span>
<span class="comment-copy">Kind of works but saving only 1 row of data</span>
<span class="comment-copy">According to the <a href="https://docs.python.org/3/library/csv.html#csv.writer" rel="nofollow noreferrer"><code>csv</code> module documentation</a>, you must open the file with <code>newlines=''</code> in order for it to add new lines properly:  <code>with open('MyFile.csv', mode='w', newlines='') as csv_file:</code></span>
