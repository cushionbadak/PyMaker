<div class="post-text" itemprop="text">
<p>In python, I am using os.fork() within a for condition. I am doing something like this:</p>
<pre><code>for i in range(1,4):
    try:
         pid = os.fork()
    except OSError:
         print ("Error forking process")
         continue
    if pid == 0:
         print "In child process"
         os._exit(0)
    print "In parent process"
</code></pre>
<p>How do I simulate a failure of os.fork() so that I can be sure that "In parent process" is not printed? How to simulate OSError for os.fork() function? </p>
</div>
<div class="post-text" itemprop="text">
<p>You can just replace <code>os.fork()</code> with your own implementation:</p>
<pre><code>import os

def _fork():
   raise OSError()
os.fork = _fork

for i in range(1,4):
    try:
         pid = os.fork()
    except OSError:
         print ("Error forking process")
         continue
    if pid == 0:
         print "In child process"
         os._exit(0)
    print "In parent process"
</code></pre>
<p>If this is part of a test, have a look at the <a href="https://docs.python.org/3/library/unittest.mock.html" rel="nofollow noreferrer">unittest.mock</a> module.</p>
</div>
<span class="comment-copy">... why do you need to do that? Are you trying to write a test? In that case you want to <i>mock</i> the <code>os.fork</code> function. Try checking <code>unittest.mock</code>. Otherwise I don't see any reason to do what you are asking</span>
<span class="comment-copy">Thanks! This is a nice way to override.</span>
