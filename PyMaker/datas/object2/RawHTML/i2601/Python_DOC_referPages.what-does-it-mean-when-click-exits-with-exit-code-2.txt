<div class="post-text" itemprop="text">
<p>I am currently <a href="http://click.pocoo.org/5/testing/" rel="nofollow noreferrer">testing a Click CLI application</a> and get <code>result.exit_code == 2</code>. Why does that happen?</p>
</div>
<div class="post-text" itemprop="text">
<p>This appears to indicate a <a href="https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/click/exceptions.py#L43" rel="nofollow noreferrer">usage error</a>:</p>
<blockquote>
<p>An internal exception that signals a usage error. This typically aborts any further handling.</p>
</blockquote>
<p>This is consistent with Click's own tests, e.g.</p>
<ul>
<li><a href="https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_arguments.py#L82" rel="nofollow noreferrer">https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_arguments.py#L82</a></li>
<li><a href="https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_arguments.py#L190" rel="nofollow noreferrer">https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_arguments.py#L190</a></li>
<li><a href="https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_arguments.py#L201" rel="nofollow noreferrer">https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_arguments.py#L201</a></li>
<li><a href="https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_formatting.py#L157" rel="nofollow noreferrer">https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_formatting.py#L157</a></li>
<li><a href="https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_formatting.py#L177" rel="nofollow noreferrer">https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_formatting.py#L177</a></li>
<li><a href="https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_formatting.py#L193" rel="nofollow noreferrer">https://github.com/pallets/click/blob/123dd717439d8620d8d6be5574d2c9f007952326/tests/test_formatting.py#L193</a></li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>I ran</p>
<pre><code>result = runner.invoke(cli, ['sync'])
</code></pre>
<p>instead of</p>
<pre><code>result = runner.invoke(cli, ['--debug', 'sync'])
</code></pre>
<p>So you need to specify the flag as entered via CLI, not only pass the parameters consumed by the function if you use <code>@click.option</code>.</p>
<p>Additionally, the I made a typo for one of the flags.</p>
<h2>How to debug</h2>
<ol>
<li>Look at the parameters you pass to <code>runner.invoke</code> (simplest: print it)</li>
<li>Execute it via CLI (e.g. <code>cli(['--debug', 'sync'])</code>)</li>
</ol>
<p>In my case this gave me the message</p>
<pre><code>Error: no such option: --sync  Did you mean --syncs?
</code></pre>
</div>
<span class="comment-copy">Where are you getting that error? It's probably almost same as any other exit code 2.  Usually means bad input data.</span>
<span class="comment-copy">What's your code, and what are the arguments you passed to the script?</span>
<span class="comment-copy"><a href="https://docs.python.org/3/library/os.html#os.EX_DATAERR" rel="nofollow noreferrer">Related</a>.  From your deleted answer, it seems that you <i>realize</i> you're passing the input data incorrectly, so I'm a bit unsure of what you're asking.</span>
<span class="comment-copy">You don't have to (and shouldn't) share all of the code. You should post a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a>.</span>
<span class="comment-copy">Then why have you not provided one?</span>
