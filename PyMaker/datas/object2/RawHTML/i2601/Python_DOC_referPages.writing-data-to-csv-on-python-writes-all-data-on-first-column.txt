<div class="post-text" itemprop="text">
<p>I'm trying to write a CSV on Python3 and after read the <a href="https://docs.python.org/3/library/csv.html#csv.DictWriter" rel="nofollow noreferrer">documentation</a> I don't understand why all the column names and all the values are writting on the first column 'A' of the excel, instead of each value on a separate column.</p>
<p>My function is:</p>
<pre><code>def write_data_to_csv(family_type, brand_name, items):
    family_path = get_path_and_create_if_not_exists(family_type)
    brand_file = family_path / (brand_name + '.csv')
    columns_headers = ['Product name', 'Normal price', 'Reduced price', 'Discount', 'Date']
    with open(brand_file, mode='a', buffering=1, encoding='utf-8', errors='strict', newline='\r', closefd=True) as file:
        writer = csv.DictWriter(file, fieldnames=columns_headers, dialect='excel')
        writer.writeheader()
        for item in items:
            product_name = item.get('name')
            normal_price = item.get('price')
            reduced_price = item.get('reduced_price')
            discount = item.get('discount')
            if reduced_price is None and discount is None:
                reduced_price = ''
                discount = ''
            actual_date = strftime("%A, %d %B %Y %H:%M:%S UTC %z", localtime())
            writer.writerow({'Product name': product_name, 'Normal price': normal_price, 'Reduced price': reduced_price,
                             'Discount': discount, 'Date': actual_date})
</code></pre>
<p>This creates a file and all values of each row are in the fist column like a,b,c,d,e,f,g instead one value per column a | b | c | d | e | f | g</p>
<p>Here is a picture:</p>
<p><a href="https://i.stack.imgur.com/x1xkT.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/x1xkT.png"/></a></p>
<p>I'm trying to achieve this. The column headers should be:</p>
<pre><code>Product Name -&gt; Column A
Normal Price -&gt; Column B
Reduced Price -&gt; Colum C
Discount -&gt; Column D
Date -&gt; Column E
</code></pre>
<p>And the same with the respective values on each row.</p>
<p>What I'm missing?</p>
<p>Regards!</p>
</div>
<div class="post-text" itemprop="text">
<p>Try this:</p>
<pre><code>def write_data_to_csv(family_type, brand_name, items):
    family_path = get_path_and_create_if_not_exists(family_type)
    brand_file = family_path / (brand_name + '.csv')
    columns_headers = ['Product name', 'Normal price', 'Reduced price', 'Discount', 'Date']
    with open(brand_file, 'w',newline='') as file:
        writer = csv.writer(file, delimiter=',')
        col_names=[row[0] for row in column_headers] 
        writer.writerow(col_names)

        for item in items:
            product_name = item.get('name')
            normal_price = item.get('price')
            reduced_price = item.get('reduced_price')
            discount = item.get('discount')
            if reduced_price is None and discount is None:
                reduced_price = ''
                discount = ''
            actual_date = strftime("%A, %d %B %Y %H:%M:%S UTC %z", localtime())
            writer.writerow({'Product name': product_name, 'Normal price': normal_price, 'Reduced price': reduced_price,
                             'Discount': discount, 'Date': actual_date})
</code></pre>
</div>
<span class="comment-copy">in csv, the default sep is <code>,</code> thus <code>a,b,c,d,e,f,g </code> is correctly defined as being 7 columns</span>
<span class="comment-copy">Yes, but when I open the csv file with excel, all data it's stored on the first A column instead of each value on different columns. I'm trying to get each header and value on a different column.</span>
<span class="comment-copy">you need to loop over the rows. It seems its collapsing all the dictionary values into one row value</span>
<span class="comment-copy">Ups, I didn't explained it very well. I'm going to update the description. Sorry!</span>
<span class="comment-copy">Hi, but unfortunately this code does not works.</span>
