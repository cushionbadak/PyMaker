<div class="post-text" itemprop="text">
<p>The requirement is to pass the parameters in a list to the sql query present in python code  </p>
<pre><code>parmlist.py   
sale_call = [12,88]
yr_range = [2015,2016,2017,2018]     


Codefile.py

     conn = &lt;connecting to MySQL&gt;     
     cursor = conn.cursor()

cursor.execute(‘Insert into sales_repo select distinct a.yr_sll from cust_data a join proc_data b 
On a.prd_key = b.prd_key where b.range1=?,b.range2=?,b.range3=? and b.yr in ?’)
</code></pre>
<p>I did the following:  </p>
<pre><code>cursor.execute(‘Insert into sales_repo select distinct a.yr_sll from cust_data a join proc_data b 
On a.prd_key = b.prd_key where b.range1=?,b.range2=?,b.range3=? and b.yr in ?’ ,parmist.sale_call[0],parmist.sale_call[1],parmist.yr_range[3])      
</code></pre>
<p>But it seems that the <code>parmist.yr_range[3]</code> is just taking 2018. 
Instead of taking whole list of <code>yr_range = [2015,2016,2017,2018]</code></p>
<p>It's just taking the last value i.e. 2018  </p>
<p>How can I pass the whole list as a variable in the query?</p>
<p>Update_1:</p>
<p>I tried the following:</p>
<pre><code>sale_call = [12,88]
yr_range = [2015,2016,2017,2018]

cursor.execute(‘Insert into sales_repo select distinct a.yr_sll from cust_data a join proc_data b 
On a.prd_key = b.prd_key where b.range1=?,b.range2=?,b.range3=? and b.yr in (' + ','.join(map(str, yr_range))’)
</code></pre>
<p>The above is not working when I tried to execute it through the python code. But executing when using pandas as:</p>
<pre><code>pd.read_sql_query(‘Insert into sales_repo select distinct a.yr_sll from cust_data a join proc_data b 
    On a.prd_key = b.prd_key where b.range1=?,b.range2=?,b.range3=? and b.yr in (' + ','.join(map(str, yr_range))’,conn)
</code></pre>
<p>Any hint why it's not working?</p>
</div>
<div class="post-text" itemprop="text">
<p>I think the error is just somewhere in how you were formatting your query string. It seems wrong in both cases but maybe the pandas query is handling it. This makes the query a bit easier to follow.  </p>
<p>And you need to specify what the parameters are if you use the <code>?</code> for the <code>b.range</code> values in the <code>WHERE</code> clause. I took them out because I am not sure how you were intending to use them. The <code>.format()</code> function replaces what is <code>{}</code> in the string to be the years as a comma separated string value.</p>
<pre><code>years = ','.join(map(str, yr_range))
cursor.execute("INSERT INTO sales_repo SELECT DISTINCT a.yr_sll FROM cust_data a "
               "JOIN proc_data b ON a.prd_key = b.prd_key " 
               "WHERE b.yr IN ({});".format(years))
</code></pre>
</div>
<span class="comment-copy">In <code>parmist.yr_range[3]</code> the <code>[3]</code> specifies the fourth item.  Try <code>parmist.yr_range</code>. - <a href="https://docs.python.org/3/tutorial/introduction.html#lists" rel="nofollow noreferrer">docs.python.org/3/tutorial/introduction.html#lists</a></span>
<span class="comment-copy">@wwii I have updated my question with the latest trials made.</span>
<span class="comment-copy">Is the year range always between a lower and upper year bounds? Ex: <code>2015 &lt;= b.range &lt;= 2018</code> Because if so then you don't need to look for every matching value, only those greater then the smallest year and less then the largest year.</span>
<span class="comment-copy">@Karl Doesn't seems that year range is the issue here. The issue is that the same query is getting executed using Pandas but not using Cursor via Python code. If possible, please help me to understand the reason for this.</span>
<span class="comment-copy">Well one problem I notice is you are using 3 <code>?</code>'s seeming like you want to pass in parameters to the query, but you never actually specify what those paremeters are supposed to be.</span>
