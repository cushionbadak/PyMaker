<div class="post-text" itemprop="text">
<p>I have telemetric (latitude, longitude, time, mileage) from a large number of vehicles. Each pandas dataframe has one vehicle's travel over time and I would like to identify when the vehicle stops.</p>
<p>I have used pandas groupby to identify if the vehicle is moving between rows (accounting for some drift).</p>
<p><code>df['Stopped'] = (df.groupby('DAY')['LAT'].diff() &lt;= 0.0001) &amp; (df.groupby('DAY')['LNG'].diff() &lt;= 0.0001)
</code>
This is not flagging the stops accurately though. Here is a bit where the vehicle is clearly moving (sorry its in HTML code - I don't know how to get it to format as a table otherwise).</p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-html lang-html prettyprint-override"><code>       Stopped      LAT       LNG         DAY
401218     True  22.6874  113.9487  2018-10-15
401219     True  22.6874  113.9487  2018-10-15
401220     True  22.6874  113.9487  2018-10-15
401221     True  22.6873  113.9487  2018-10-15
401222     True  22.6869  113.9483  2018-10-15
401223     True  22.6863  113.9479  2018-10-15
401224     True  22.6859  113.9476  2018-10-15
401225     True  22.6854  113.9471  2018-10-15
401226     True  22.6849  113.9468  2018-10-15
401227     True  22.6844  113.9463  2018-10-15
401228     True  22.6841  113.9457  2018-10-15
401229     True  22.6839  113.9449  2018-10-15
401230     True  22.6838  113.9438  2018-10-15
401231     True  22.6837  113.9428  2018-10-15
401232     True  22.6837  113.9417  2018-10-15
401233     True  22.6836  113.9409  2018-10-15
401234     True  22.6835  113.9400  2018-10-15
401235     True  22.6833  113.9392  2018-10-15
401236     True  22.6832  113.9387  2018-10-15
401237     True  22.6832  113.9384  2018-10-15</code></pre>
</div>
</div>
</p>
</div>
<div class="post-text" itemprop="text">
<p>Look at the output of <code>df.groupby('DAY')['LAT'].diff()</code>. Many values are negative, so you need to take the absolute value before you check if they are less than your cutoff value:</p>
<pre><code>df['Stopped2'] = (df.groupby('DAY')['LAT'].diff().abs() &lt;= 0.0001) &amp; (df.groupby('DAY')['LNG'].diff().abs() &lt;= 0.0001)
print(df)
</code></pre>
<pre><code>        Stopped      LAT       LNG       DAY  Stopped2
401218     True  22.6874  113.9487  10/15/18     False
401219     True  22.6874  113.9487  10/15/18      True
401220     True  22.6874  113.9487  10/15/18      True
401221     True  22.6873  113.9487  10/15/18      True
401222     True  22.6869  113.9483  10/15/18     False
401223     True  22.6863  113.9479  10/15/18     False
401224     True  22.6859  113.9476  10/15/18     False
401225     True  22.6854  113.9471  10/15/18     False
401226     True  22.6849  113.9468  10/15/18     False
401227     True  22.6844  113.9463  10/15/18     False
401228     True  22.6841  113.9457  10/15/18     False
401229     True  22.6839  113.9449  10/15/18     False
401230     True  22.6838  113.9438  10/15/18     False
401231     True  22.6837  113.9428  10/15/18     False
401232     True  22.6837  113.9417  10/15/18     False
401233     True  22.6836  113.9409  10/15/18     False
401234     True  22.6835  113.9400  10/15/18     False
401235     True  22.6833  113.9392  10/15/18     False
401236     True  22.6832  113.9387  10/15/18     False
401237     True  22.6832  113.9384  10/15/18     False
</code></pre>
</div>
