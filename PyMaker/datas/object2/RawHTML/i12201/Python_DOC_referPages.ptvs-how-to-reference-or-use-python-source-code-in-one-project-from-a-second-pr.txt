<div class="post-text" itemprop="text">
<p>In Visual Studio with PTVS I have <strong>two separate</strong> Python projects, one contains a Python source file named <code>lib.py</code> for use as a library of functions and the other is a main that uses the functions in the library. I am using an <code>import</code> statement in the main to reference the functions in the library project but get the following error:</p>
<blockquote>
<p>No module named lib</p>
</blockquote>
<p>I primarily program in F# using Visual Studio so my mindset is adding references to other .NET projects.  </p>
<p>How do I think in the Pythonic way to accomplish this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Python does not use references like .NET does but uses a path which is searched. The search path needs to be modified to include the directory containing the source file. See: <a href="https://docs.python.org/3/tutorial/modules.html#the-module-search-path" rel="nofollow noreferrer">The Module Search Path</a></p>
<p>Looking at the project in Visual Studio with <code>Solution Explorer</code> shows <code>Search Paths</code> for each project.</p>
<p><a href="https://i.stack.imgur.com/6Qj4I.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/6Qj4I.png"/></a></p>
<p>To modify the search path:  </p>
<p>Get the directory for the Python file containing the source code to import.</p>
<p>e.g. <code>lib.py</code></p>
<p>In Solution Explorer right click on <code>lib.py</code> and select <code>Copy Path</code></p>
<p><a href="https://i.stack.imgur.com/lOUSV.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/lOUSV.png"/></a></p>
<p>Now for the project that will import the module<br/>
e.g. <code>ConsoleDriver_Python</code></p>
<p>Right click <code>Search Paths</code> and select <code>Add Folder to Search Path...</code></p>
<p><a href="https://i.stack.imgur.com/VwTof.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/VwTof.png"/></a></p>
<p>which displays a select folder dialog</p>
<p><a href="https://i.stack.imgur.com/9CDhr.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/9CDhr.png"/></a></p>
<p>Right click and paste in the path from the clipboard. Also change it to a directory by removing the file name.</p>
<p><a href="https://i.stack.imgur.com/dbXGI.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/dbXGI.png"/></a></p>
<p>Click <code>Select Folder</code></p>
<p>Now check the project to make sure <code>Search Path</code> was updated.</p>
<p><a href="https://i.stack.imgur.com/JqFwz.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/JqFwz.png"/></a></p>
<p>The import error should now be cleared.</p>
</div>
<div class="post-text" itemprop="text">
<p>I just wanted to add the below in addition to the verified answer, for a very specific scenario.</p>
<p>I was recently asked to fix the same problem that the OP was experiencing for a work machine, which had recently had the user accounts migrated over to a new domain.</p>
<p>Setup:
Visual Studio 2013
PTVS 2.2.30718
Anaconda 3.5</p>
<p>Basically, Anaconda was installed for localmachine/UserA.</p>
<p>Once the users were migrated over to the new domain (newdomain/UserA), the Python environment had to be updated from within VS2013, by clicking View &gt; Other Windows &gt; Python Environments.</p>
<p>Once that was setup, the python scripts would run as expected, although none of the Search Folder references would work. They were then removed and re-added but to no avail.</p>
<p>Various other things were tried, including setting up totally fresh projects, and linking them using the Search Paths, but to no avail.</p>
<p>The only thing that fixed the problem was to reinstall the Python Environment (in my case Anaconda3) outside of a user account (by clicking the "for all users, using administrator privileges" option during the install).</p>
<p>Then I restarted, removed and re-added the search folders, and the python worked as expected, including all the search paths.</p>
<p>I hope that helps someone, as I just wasted hours solving it...</p>
<p>D :)</p>
</div>
<div class="post-text" itemprop="text">
<p>Or you can do this in code with the following:</p>
<pre><code>sys.path.append("search path")
</code></pre>
<p>So that the code can be run outside the IDE.</p>
</div>
<span class="comment-copy">This is an outstanding answer! Good work!</span>
<span class="comment-copy">Of interest: <a href="https://github.com/Microsoft/PTVS/wiki/Projects#search-paths" rel="nofollow noreferrer">PTVS - Projects - Search Path</a> Official documentation on PTVS search paths.</span>
<span class="comment-copy">The link in the comment above is now dead and redirects to <a href="https://docs.microsoft.com/en-us/visualstudio/python/python-projects" rel="nofollow noreferrer">Python Projects</a>. After glancing over the new page there may be a different way to accomplish this as PTVS is evolving. When I get time I plan to revise the answer but right now am neck deep in Prolog.</span>
<span class="comment-copy">Is this the same as doing a sys.path.append() in code or adding to the PYTHONPATH if running from the command line?</span>
<span class="comment-copy">@Doodah You should ask that as a new question.</span>
<span class="comment-copy">Nice to know. Thanks.</span>
<span class="comment-copy">Good find. Final pointer on this issue - after reinstalling Anaconda with admin privileges, you still need to reboot the machine for Windows to sort it all out and for VS to correctly adjust the search path.</span>
<span class="comment-copy">Normally I automatically upvote any reasonable answer to a question. While I see your answer as a valid option, I am hesitant to up vote it being correct as <code>sys.path.insert()</code> might be better, but even more so, I see the information you give as already being present at SO and that this should be a comment with a link. I do understand that it is a good option for others to know about so I won't down vote it.</span>
