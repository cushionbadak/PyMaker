<div class="post-text" itemprop="text">
<p>I am trying to run via a timer task a script that runs nightly to get on various servers to get all files if they exist. It works just fine as long as there are files on the server. That is where my issue is at.</p>
<pre><code>filenames = ftp.nlst() # get filenames within the directory
print filenames

for filename in filenames:
   local_filename = os.path.join('C:\\test\\', filename)
   file = open(local_filename, 'wb')
   ftp.retrbinary('RETR '+ filename, file.write)

file.close()
ftp.quit() 
</code></pre>
<p>When I run the script on a server where there are no files I get the following error:</p>
<pre><code>Traceback (most recent call last):
File "ftptest.py", line 85, in &lt;module&gt;
main()
File "ftptest.py", line 60, in main
filenames = ftp.nlst()
File "/usr/lib/python2.7/ftplib.py", line 506, in nlst
self.retrlines(cmd, files.append)
File "/usr/lib/python2.7/ftplib.py", line 429, in retrlines
conn = self.transfercmd(cmd)
File "/usr/lib/python2.7/ftplib.py", line 368, in transfercmd
return self.ntransfercmd(cmd, rest)[0]
File "/usr/lib/python2.7/ftplib.py", line 331, in ntransfercmd
resp = self.sendcmd(cmd)
File "/usr/lib/python2.7/ftplib.py", line 244, in sendcmd
return self.getresp()
File "/usr/lib/python2.7/ftplib.py", line 219, in getresp
raise error_perm, resp
ftplib.error_perm: 550 No files found
</code></pre>
<p>There is going to be days where there are no files. What can i add to the script that instead erroring out it might either skip or print no files today.. and move on.</p>
</div>
<div class="post-text" itemprop="text">
<p>As stated in you error message the exception is raised in this line at the very beginning of your code:</p>
<pre><code>filenames = ftp.nlst()
</code></pre>
<p>The error message is telling</p>
<pre><code>raise error_perm, resp
ftplib.error_perm: 550 No files found
</code></pre>
<p>which gives us a hint about the raised exception. A look at the <a href="https://docs.python.org/3/library/ftplib.html#ftplib.error_perm" rel="nofollow">docs</a> gives more details about this type of exception.</p>
<p>However, we can use <code>try-except</code>-blocks in order to catch any exception or a specific one if we want to.</p>
<p>I am not able to test this approach on my system, but I suggest something like the following:</p>
<pre><code>try:
    filenames = ftp.nlst()
except ftplib.error_perm:
    pass
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Thank you for all the help. I was able to get the script to work using the following. </p>
<pre><code>try:  
    filenames = ftp.nlst()  
except ftplib.error_perm:  
    print "No files at this time"  
    sys.exit(0)  
</code></pre>
</div>
<span class="comment-copy">I added the suggested changes to catch the exceptions and now I am getting                                                                                                                  Traceback (most recent call last):   File "ftptest.py", line 62, in &lt;module&gt;     filenames = ftp.nlst() NameError: name 'ftp' is not defined</span>
<span class="comment-copy">If so, how could the snippet given in your question work? You need to create <code>ftp</code> as an instance of <code>FTP</code> as shown in the <a href="https://docs.python.org/3/library/ftplib.html" rel="nofollow noreferrer">docs</a>.</span>
