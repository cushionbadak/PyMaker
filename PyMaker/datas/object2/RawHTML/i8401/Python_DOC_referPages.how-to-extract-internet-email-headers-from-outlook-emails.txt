<div class="post-text" itemprop="text">
<p>i am actually trying to extract the following details from outlook emails.
1. From
2. To
3. Reply - To
4. Return Path<br/>
5. X-Agari Original Sender
6. X-Agari Original Receiver
7. X-Originating IP
I have tried Python with exchangelib, win32com.client but could not extract the details.
Can some one help me please?</p>
</div>
<div class="post-text" itemprop="text">
<p>Try using the HeaderParser module. This allows you to parse through html in python to find headlines and headers and such.</p>
<p><a href="https://docs.python.org/3/library/email.parser.html" rel="nofollow noreferrer">https://docs.python.org/3/library/email.parser.html</a></p>
</div>
<div class="post-text" itemprop="text">
<p>If you are using the Outlook Object Model,  you need to read the <code>PR_TRANSPORT_MESSAGE_HEADERS</code> MAPI property (take a look at it in <a href="http://www.dimastr.com/outspy" rel="nofollow noreferrer">OutlookSpy</a> - click IMessage button) using <code>MailItem.PropetyAccessor.GetProperty</code>.</p>
<p><code>PR_TRANSPORT_MESSAGE_HEADERS</code> DASL property name is <code>http://schemas.microsoft.com/mapi/proptag/0x007D001F</code></p>
</div>
<span class="comment-copy">Using what API? Outlook Object Model through COM?</span>
<span class="comment-copy">Anything is fine for me. I have tried with COM but i could not get the details. Below is the code which i wrote using exchangelib.  The below code is actually iterating over all the items in  a mail box but i want this to run only when an email arrives into inbox.  from exchangelib import * config = Configuration(server='XXXXXXX', credentials=Credentials(username='XXXXX', password='XXXXXX'), auth_type=NTLM  ) account = Account(primary_smtp_address='XXXXXX', config=config,access_type=DELEGATE) print(account.inbox.all()) for item in account.inbox.all():         print(item)</span>
<span class="comment-copy">@DmitryStreblechenko any update?</span>
<span class="comment-copy">That is not the Outlook Object Model. Is Outlook installed on the machine where your code is running?</span>
<span class="comment-copy">Yes Outlook is installed. So far, for COM objects, i have achieved this. import win32com.client import pythoncom class Handler_Class(object):     def OnNewMailEx(self, receivedItemsIDs):         for ID in receivedItemsIDs.split(","):              mailItem = outlook.Session.GetItemFromID(ID)             print("Subj: " + mailItem.Subject)             print("To: "+mailItem.To)             print("From :"+str(mailItem.Sender)) outlook = win32com.client.DispatchWithEvents("Outlook.Application", Handler_Class) pythoncom.PumpMessages()</span>
<span class="comment-copy"><a href="http://schemas.microsoft.com/mapi/proptag/0x007D001F" rel="nofollow noreferrer">schemas.microsoft.com/mapi/proptag/0x007D001F</a> is not available now. Could you please re-check that</span>
<span class="comment-copy">It is not a link. It is the actual string (DASL name) that you need to pass to GetProperty.</span>
