<div class="post-text" itemprop="text">
<p>I am using Celery's periodic function to do batch updates of my database. The data to be inserted is stored in a global list by some other function of the same script. The problem is, whenever the Periodic function executes, it see the list as an empty one.</p>
<p>Following is the code snippet for the same:</p>
<pre><code>client    = MongoClient('localhost:27017')
db        = client.module_data
batchData = []


@periodic_task(run_every=(crontab(minute='*/1')), name='Batch_Update')
def batchUpdate():
    global batchData
    print batchData
    if len(batchData)&gt;0:
        db.logs.insert_many([_data for _data in batchData])

def writeLog(event='', method='', execution_time=0.0):

    global batchData

    if event=='' or method=='' or execution_time==0.0:
        return

    _date = datetime.now()
    _data = {'event':event, 'method':method, 'execution_time':execution_time, 'date':_date}

    #db.logs.insert(_data)
    batchData.append(_data)
    print batchData
</code></pre>
<p>Can someone help me with this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Use your backend. As I can see it's mongo. Store data to the mongodb when you are doing <code>writeLog</code> and read it in your <code>batchUpdate</code>.
Please pay attention to nature of the data you want to store. It likely should be serializeable as <a href="https://docs.python.org/3/library/pickle.html?highlight=pickle#module-pickle" rel="nofollow noreferrer">pickle</a> or json.</p>
</div>
