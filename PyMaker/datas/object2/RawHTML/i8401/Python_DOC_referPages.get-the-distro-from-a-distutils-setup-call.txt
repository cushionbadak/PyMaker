<div class="post-text" itemprop="text">
<p>I want to unit test some Python extensions. To achieve this I'm running <code>setup()</code> in a script: </p>
<pre><code>from distutils.core import setup, Extension
import os

DIR = os.path.dirname(__file__)

def call_setup():
    module1 = Extension('callbacks',
        sources = [os.path.join(DIR, 'callbacks.c')])

    setup(
        script_name = 'setup.py',
        script_args = ['build'],
        name = 'PackageName',
        ext_modules = [module1])
</code></pre>
<p>To avoid leaving junk in the test directory I want to cleanup the build after the tests run. I'd like to run <code>distutils.command.clean.clean()</code> in the unittest <code>tearDown()</code>. How do I get the <code>dist</code> object for the distro that must be passed as an argument to <code>clean()</code>?</p>
<p>Thanks</p>
</div>
<div class="post-text" itemprop="text">
<p>It looks like your call to <code>setup()</code> should <a href="https://docs.python.org/3/distutils/apiref.html#distutils.core.Distribution" rel="nofollow noreferrer">return a <code>Distribution</code> instance.</a></p>
<blockquote>
<p>See the <code>setup()</code> function for a list of keyword arguments accepted by the <code>Distribution</code> constructor. <code>setup()</code> creates a Distribution instance.</p>
</blockquote>
</div>
<span class="comment-copy">Thanks, your answer is right. Alas, <code>clean.run()</code> doesn't <a href="https://github.com/python-git/python/blob/py3k/Lib/distutils/command/clean.py" rel="nofollow noreferrer">do anything</a>, so I'll just remove (or ignore) the directory myself.</span>
