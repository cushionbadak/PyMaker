<div class="post-text" itemprop="text">
<p>I have simple application written in django with one form that uploads <code>CSV</code>file.</p>
<p>My CSV file has a lot of columns with <strong>cyrillic letters</strong>. Just for testing I made my view handle html form like this:</p>
<pre><code>@login_required()
@require_http_methods(["POST"])
def upload_csv(request):

    uploaded_file = request.FILES['csv'].read(200)
    data = csv.reader(uploaded_file)
    for row in data:
        print(row)

    return redirect('moderator:upload_view')
</code></pre>
<p>When I try to upload my CSV, I get this error:</p>
<pre><code>Traceback (most recent call last):
 File "D:\Python27\lib\site-packages\django\core\handlers\base.py", line 149, in get_response
response = self.process_exception_by_middleware(e, request)
 File "D:\Python27\lib\site-packages\django\core\handlers\base.py", line 147, in get_response
response = wrapped_callback(request, *callback_args, **callback_kwargs)
 File "D:\Python27\lib\site-packages\django\contrib\auth\decorators.py", line 23, in _wrapped_view
return view_func(request, *args, **kwargs)
 File "D:\Python27\lib\site-packages\django\views\decorators\http.py", line 42, in inner
return func(request, *args, **kwargs)
 File "D:\myapp\moderator\views\upload.py", line 32, in upload_csv
for row in data:
Error: line contains NULL byte
[08/Apr/2017 13:53:41] "POST /moderator/upload_csv/ HTTP/1.1" 500 87052
</code></pre>
<p>First I thought that my CSV is corrupted. Then why other CSV readers and Excel can open it?</p>
</div>
<div class="post-text" itemprop="text">
<p>You may want to take a look at this answer <a href="https://stackoverflow.com/questions/7894856/line-contains-null-byte-in-csv-reader-python?answertab=votes#tab-top">"Line contains NULL byte" in CSV reader (Python)</a></p>
<p>which utilizes the <a href="https://docs.python.org/3/library/codecs.html" rel="nofollow noreferrer">codecs library</a>:</p>
<blockquote>
<pre><code>import codecs
csvReader = csv.reader(codecs.open('file.csv', 'rU', 'utf-16'))
</code></pre>
</blockquote>
<p>to open the file with different encodings (ex: utf-16)</p>
<p>Good luck :)</p>
</div>
<span class="comment-copy">I have made like this: <code>csvReader = csv.reader(codecs.open(uploaded_file, 'rU', 'utf-16'))</code> which throws me <code>TypeError: file() argument 1 must be encoded string without null bytes, not str</code></span>
<span class="comment-copy">In the linked answer, there is the second most voted answer, which gives another solution (manipulating your CSV). You may want to try it as well!</span>
