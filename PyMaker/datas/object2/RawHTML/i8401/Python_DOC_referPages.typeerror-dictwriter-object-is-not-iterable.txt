<div class="post-text" itemprop="text">
<p>I'm working on creating a short simple program for a nonprofit fundraiser to validate ticket numbers as guests check in to make sure no duplicate tickets are redeemed.  I'm running Python 3.4.3 on a Windows 10 machine.  Once the program is finalized it will be used on a Raspberry Pi with touchscreen at the fundraiser.  </p>
<p>I've tried a couple different methods to build the list, save it, and search for duplicates.  Ideally the list will be stored in a CSV file, but a plain text or other format is ok too.</p>
<p>Can you help me with the traceback error (TypeError: 'DictWriter' object is not iterable) due to the looping function to check ticket #'s against a list stored in a file to make sure no duplicate tickets are redeemed?  </p>
<p>Thank you in advance for your help!</p>
<pre><code>version = "v1.4"
fname="tickets.csv"
import csv
import datetime
import os.path
print("\nWelcome to TicketCheck", version)
extant = os.path.isfile(fname)
with open(fname, 'a', newline='') as csvfile:
    fieldnames = ['ticketid', 'timestamp']
    ticketwriter = csv.DictWriter(csvfile, fieldnames=fieldnames)
    if extant == False:
        ticketwriter.writeheader()
    while True:
        ticket = ""
        print("Please enter a ticket # to continue or type exit to exit:")
        ticket = str(input())
        if ticket == "":
            continue
        if ticket == "exit":
            break
        print("You entered ticket # %s." % (ticket))
        print("Validating ticket...")
        for row in ticketwriter:
            if row[0] == ticket:
                print("\n\n\n===== ERROR!!! TICKET # %s ALREADY CHECKED IN =====\n\n\n" % (ticket))
                continue
        time = datetime.datetime.now()
        print("Thank you for checking in ticket # %s at %s \n\n\n" % (ticket, time))
        print("Ticket is now validated.")
        ticketwriter.writerow({'ticketid': ticket, 'timestamp': time})
        csvfile.flush()
        continue
csvfile.close()
print("All your work has been saved in %s.\n Thank you for using TicketCheck %s \n" % (fname, version))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Hmm, I think you might be over-complicating this a bit! For something like that there's really no need to go to all that trouble. This is a great spot to use a dictionary, and for something with only two inputs, the id and the check-in time, you can easily just make a .txt log. I get the feeling this might be more of what you are looking for.</p>
<pre><code>import time
go = True
while go:
    the_guestlist = {}
    the_ticket = input().strip()
    file = open('somefile.txt', 'r')
    for line in file:
        my_items = line.split(',')
        the_guestlist[my_items[0]] = my_items[1]
    file.close()
    if the_ticket in the_guestlist.keys():
        print("Sorry, that ticket has been entered at {}".format(the_guestlist[the_ticket]))
    elif the_ticket == 'exit':
        go = False
        print('Exiting...')
    else:
        the_guestlist[the_ticket] = '{}'.format(time.asctime())
        file = open('somefile.txt', 'a')
        file.write(the_ticket +','+the_guestlist[the_ticket]+'\n')
        file.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Objects of the <a href="https://docs.python.org/3/library/csv.html#csv.DictWriter" rel="nofollow noreferrer"><code>csv.DictWriter</code></a> class are not iterable, <em>i.e.</em> you cannot iterate over them like you would a dictionary, list, or even string, hence your error message. It does not store the data you have previously written to file, only the file you wrote to stores that data.</p>
<p>To achieve your goal, you could do two things: either open your CSV file every time a new ticket needs to be validated, and check if the ticket number is present, or - since you are using relatively small amounts of data - store a dictionary in memory, and only write it out at the end of use, checking from that if the ticket is valid. </p>
</div>
