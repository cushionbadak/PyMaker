<div class="post-text" itemprop="text">
<p>I'm trying to find out whether a specific column exists in my DataFrame columns or not, but I have some problems.</p>
<p>What I do: Using boolean operation "not in" (I've tried any(), all(), "in") to find the specific column header and it seems it's not working properly!</p>
<p>let's say my DataFrame column headers are:</p>
<pre><code>df.columns = ['El-array', 'a', 'b', 'm', 'n', 'Rho', 'dev', 'ip', 'sp', 'vp', 'i',
   'M1', 'M2', 'M3', 'M4', 'M5', 'M6', 'M7', 'M8', 'M9', 'M10', 'M11',
   'M12', 'M13', 'M14', 'M15', 'M16', 'M17', 'M18', 'M19', 'M20', 'TM1',
   'TM2', 'resist', 'DC_slope']
</code></pre>
<p>and I'm trying to see if all of 'M1', 'M2', ... 'M20' and 'TM1' are there. If one or more is missing code will not work.</p>
<p>So I say:</p>
<pre><code>    if any(['M1','M2','M3','M4','M5','M6','M7','M8','M9','M10','M11',
        'M12','M13','M14','M15','M16','M17','M18','M19','M20', 'TM1']) not in df.columns: 
        print('Incomplete dataset')
</code></pre>
<p>Now, let's say df has all the asked columns headers, the if statement still shows the "Incomplete dataset' message!! I have tried "all() not in" too but same result!! I also have tried: </p>
<pre><code>if 'M1' and 'M2' and ... and 'M20' and 'TM1' in df.columns:
    "Do this"
elif:
    print('Incomplete dataset')
</code></pre>
<p>or</p>
<pre><code>if 'M1' or 'M2' or ... or 'M20' and 'TM1' not in df.columns:
    print('Incomplete dataset')
elif:
    "Do this"
</code></pre>
<p>Still prints incomplete dataset!!</p>
<hr/>
<p>Now for a truly incomplete dataset I get the same results too!!</p>
</div>
<div class="post-text" itemprop="text">
<p>You have a fundamental misunderstanding of how <a href="https://docs.python.org/3/library/functions.html#any" rel="nofollow noreferrer"><code>any</code></a> and <a href="https://docs.python.org/3/reference/expressions.html#or" rel="nofollow noreferrer"><code>or</code></a> work. I suggest going back and having a look at the documentation I've linked to on those.</p>
<p>You want:</p>
<pre><code>names = ['M1','M2','M3','M4','M5','M6','M7','M8','M9','M10','M11',
        'M12','M13','M14','M15','M16','M17','M18','M19','M20', 'TM1']
if any(name not in df.columns for name in names):
    ...
else:
    print('incompatable dataset')
</code></pre>
<hr/>
<p>Alternatively (and this is really just for minimal performance gain), you can use the <a href="https://docs.python.org/3/library/stdtypes.html#frozenset.difference" rel="nofollow noreferrer">set difference</a> (returns all values than are in <code>names</code> but not in <code>df.columns</code>):</p>
<pre><code>if not set(names) - set(df.columns):
   ...
</code></pre>
</div>
<span class="comment-copy">Just some advice on how python is working: <code>if any(['M1','M2',...'M19','M20', 'TM1']) not in df.columns</code> is really doing <code>if True not in df.columns</code> because <code>any(['M1','M2',...'M19','M20', 'TM1']) == True</code></span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/10149747/and-or-in-python">AND/OR in Python?</a></span>
<span class="comment-copy">Thanks! This worked.</span>
