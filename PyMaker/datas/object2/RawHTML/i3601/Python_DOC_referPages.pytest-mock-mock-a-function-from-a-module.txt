<div class="post-text" itemprop="text">
<p>I have an util in my module <code>engine.py</code>, which is imported from another file:</p>
<pre><code>from main.utils.string import get_random_string

def generate_random_string():
    return get_random_string()
</code></pre>
<p>In my test file:</p>
<pre><code>def test_generate_random_string(mocker):
    mocker.patch('main.utils.string.get_random_string', return_value='123456')
</code></pre>
<p>However, it's still trying to use the real implementation of <code>string.get_random_string</code> instead of the mock that I've created, unless I change my <code>engine.py</code> to:</p>
<pre><code>from main.utils import string

def generate_random_string():
    return string.get_random_string()
</code></pre>
<p>How can I achieve the mocking part without importing the whole <code>string</code> module to <code>engine.py</code>?</p>
</div>
<div class="post-text" itemprop="text">
<p>I have successfully achieved it by changing <code>mocker.patch('main.utils.string.get_random_string', return_value='123456')</code> to <code>mocker.patch('engine.get_random_string', return_value='123456')</code>.</p>
<p>Details can be found <a href="https://docs.python.org/3/library/unittest.mock.html#where-to-patch" rel="nofollow noreferrer">here</a>.</p>
</div>
<span class="comment-copy">The upper part should also work. What error exactly are you getting when running test file?</span>
<span class="comment-copy">It's trying to use the real code of <code>string.get_random_string</code>, instead of the mock that I've created</span>
<span class="comment-copy">You should mock the function where you use it, not where it is declared. Try <code>mocker.patch('engine.get_random_string', return_value='123456')</code> instead. See <a href="https://docs.python.org/3/library/unittest.mock.html#where-to-patch" rel="nofollow noreferrer">Where to patch</a> for more details.</span>
<span class="comment-copy">argh i did that, but I thought it wasn't the correct way to do it! Thank you so much!</span>
<span class="comment-copy">Either post an answer or close this question. Don't "(SOLVED)" it.</span>
