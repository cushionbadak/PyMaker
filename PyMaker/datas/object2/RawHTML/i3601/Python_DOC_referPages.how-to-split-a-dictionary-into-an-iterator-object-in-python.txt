<div class="post-text" itemprop="text">
<p>I'm scraping some info from the Yahoo Finance API. I'm currently getting all dividends from a time period for a certain company. I created the following class to model a company:</p>
<pre><code>class Company:
    def __init__(self, symbol, dividends):
        self.symbol = symbol
        self.dividends = dividends
    def __iter__(self):
        return iter([self.symbol, self.dividends])
</code></pre>
<p>Dividends is always a dictionary of the following form:</p>
<pre><code>{'2016-08-04': '0.57', '2018-05-11': '0.73', '2017-08-10': '0.63', '2018-02-09': '0.63', '2017-05-11': '0.63', '2017-11-10': '0.63', '2017-02-09': '0.57', '2016-11-03': '0.57'}
</code></pre>
<p>I'd like to create a csv file from this in which each row looks like this:
<a href="https://i.stack.imgur.com/0w1bA.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/0w1bA.png"/></a></p>
<p>But instead I'm getting this from running the script:
<a href="https://i.stack.imgur.com/xMe59.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/xMe59.png"/></a></p>
<p>This is the code I use to write into the csv file:</p>
<pre><code>def write_into_csv_file(company):
    with open('/Users/rodrigopeniche/Documents/workspace/WebScraping/yahoo_historical.csv', 'a') as csv_file:
        wr = csv.writer(csv_file, delimiter=',')
        wr.writerow(list(company))
</code></pre>
<p>What can I do to achieve the previously stated?</p>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="https://docs.python.org/3/library/itertools.html#itertools.chain.from_iterable" rel="nofollow noreferrer"><code>itertools.chain.from_iterable</code></a> to flatten your dict items into a regular iterator, then use that to build an iterator that includes the symbol</p>
<pre><code>from itertools import chain

class Company:
    def __init__(self, symbol, dividends):
        self.symbol = symbol
        self.dividends = dividends
    def __iter__(self):
        return chain((self.symbol,), chain.from_iterable(self.dividends.items()))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Dictionaries have method <code>values()</code> that return its values as an iterator, so you can do <code>wr.writerow(list(company.dividends.values()))</code>. However, that very likely will not line up dividends from the same date in the same column in your csv. I recommend using pandas. You can create a dataframe, then fill it with each row being dividends from a company.</p>
<pre><code>import pandas as pd
dividends_by_company = 
   pd.DataFrame([company.dividends for company in company_list],
       index = company_list] 
dividends_by_company.to_csv(
    '/Users/rodrigopeniche/Documents/workspace/WebScraping/yahoo_historical.csv')
</code></pre>
</div>
<span class="comment-copy">This is the answer I was going to write.</span>
<span class="comment-copy">@g.d.d.c +1, I've spent too much time thinking about <code>datetime</code> sorting (whether OP needs it or not).</span>
