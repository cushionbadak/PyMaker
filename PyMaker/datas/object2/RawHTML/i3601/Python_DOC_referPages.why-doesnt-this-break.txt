<div class="post-text" itemprop="text">
<p>I wrote some code I have to submit to an online programming class. The code is intended to: </p>
<ul>
<li>Import and open a file</li>
<li>Append data to said file</li>
<li>Read from said file to display each city name and month average high temperature in Celsius.</li>
</ul>
<p>The output is supposed to look like this:</p>
<pre><code>City of Beijing month ave: highest high is 30.9 Celsius  
City of Cairo month ave: highest high is 34.7 Celsius  
City of London month ave: highest high is 23.5 Celsius  
City of Nairobi month ave: highest high is 26.3 Celsius  
City of New York City month ave: highest high is 28.9 Celsius  
City of Sydney month ave: highest high is 26.5 Celsius  
City of Tokyo month ave: highest high is 30.8 Celsius  
City of Rio De Janeiro month ave: highest high is 30.0 Celsius  
</code></pre>
<p>When the code is run it goes into an infinity loop and I don't understand why. I thought that when the file pointer got to the end of the file, the code would break because the read would equal ""(empty string) and that is Falsey so it would stop.</p>
<p>I know that it would be better to write the code without keyword "while" but in my class that keyword is required to be in the code. I got the code to work perfectly with a for/in keyword.</p>
<p>Any help is greatly appreciated.</p>
<p>The code:</p>
<pre><code>!curl https://raw.githubusercontent.com/MicrosoftLearning/intropython/master/world_temp_mean.csv -o mean_temp.txt

mean_temp_file = open("mean_temp.txt","a+")
mean_temp_file.write("Rio de Janeiro,Brazil,30.0,18.0\n")


mean_temp_file.seek(0)

headings = mean_temp_file.readline()

headings_list = headings.split(",")

city_temp = mean_temp_file.readlines()

while city_temp: 
    for each_line in city_temp:
        each_line_list = each_line.split(",")
        print(headings_list[0].title(),"of",each_line_list[0].title(),headings_list[2],"is",each_line_list[2],"Celsius.")

mean_temp_file.close()
</code></pre>
<p>In case it helps, I wrote the code in Microsoft Azure Notebooks.</p>
</div>
<div class="post-text" itemprop="text">
<p>You've created <code>city_temp</code> as a list of all of the lines (but the first) in the file:</p>
<pre><code>city_temp = mean_temp_file.readlines()
</code></pre>
<p>You never modify that list anywhere inside the loop. So if it's non-empty (and therefore truthy) the first time, it'll be non-empty over and over again, forever.</p>
<p>It's not clear what you actually wanted to do with that loop. You already have an inner loop that goes through every line in the file:</p>
<pre><code>for each_line in city_temp:
</code></pre>
<p>… which seems to be the only loop you need. So, just get rid of the outer <code>while</code> loop.:</p>
<pre><code>city_temp = mean_temp_file.readlines()

for each_line in city_temp:
    each_line_list = each_line.split(",")
    print(headings_list[0].title(),"of",each_line_list[0].title(),headings_list[2],"is",each_line_list[2],"Celsius.")
</code></pre>
<hr/>
<p>While we're at it, you don't need <code>readlines()</code> here. That reads all of the remaining lines into a list so you can loop over it—but the file itself is an iterator over the same lines, so you can loop over that just as well, and without wasting time, memory, and a line of code making a list:</p>
<pre><code>for each_line in mean_temp_file:
    each_line_list = each_line.split(",")
    print(headings_list[0].title(),"of",each_line_list[0].title(),headings_list[2],"is",each_line_list[2],"Celsius.")
</code></pre>
<hr/>
<p>Finally, this might be easier with the <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer"><code>csv</code></a> module:</p>
<pre><code>import csv
mean_temp_file = open("mean_temp.txt","a+")
mean_temp_file.write("Rio de Janeiro,Brazil,30.0,18.0\n")
mean_temp_file.seek(0)
for row in csv.DictReader(mean_temp_file):
    # here row is a dict, where the keys are the header names, 
    # and the values are this row's values
</code></pre>
</div>
<span class="comment-copy"><code>while city_temp:</code> keeps looping until <code>city_temp</code> is empty. Since <code>city_temp</code> is a list, and you never modify that list anywhere, if it's not empty at the start, it won't ever become empty, so you'll loop forever. To fix this, just get rid of the <code>while city_temp:</code> loop. You're already looping over all the lines with <code>for each_line in city_temp:</code>, which is all you need.</span>
<span class="comment-copy">And, while we're at it, you don't need <code>readlines()</code>. A file is already an iterator of lines, so you can get rid of that line of code and do <code>for each_line in mean_temp_file:</code>.</span>
<span class="comment-copy">One last thing: while <code>split(",")</code> will work as long as none of your strings can ever include a comma or quote or any other special character, you might want to look into the <code>csv</code> module, which can parse CSV files for you (including handling the header, and even turning each row into a dict with the header names as keys).</span>
<span class="comment-copy">Thanks! I didn't think of it that way. You helped. I added city_temp.pop(0). And it works great.</span>
