<div class="post-text" itemprop="text">
<p>I have 500 excel files, from each file I have to skip starting 4 rows and select few columns. 
Either I can create new excel file for each file with particular columns, or i can push the data in SQL Server. </p>
<p>I need to create one function that can read all files and do the required process and give me output either in excel or SQL.</p>
</div>
<div class="post-text" itemprop="text">
<p>It's convenient to use <a href="https://docs.python.org/3/library/os.html" rel="nofollow noreferrer"><code>os</code></a> library for working with the file system.<br/>
The function <code>clean_one</code> is from your code with minor changes. The function <code>clean_all</code> applies <code>clean_one</code> to all file in the <code>root</code> directory (which is in my code <a href="https://docs.python.org/3/library/os.html#os.getcwd" rel="nofollow noreferrer">'os.getcwd`</a> [current working directory]):</p>
<pre><code>import os
import pandas as pd

def clean_one(path, n):
    df = pd.read_excel(path, skiprows = 4)
    col_list = ['Emp Code', 'Emp Name', 'Net Salary', 'Gross Earnings', 'Provident Fund',
                'Provident Fund_A', 'Profession Tax', 'ESIC Deduction', 'ESIC Deduction_A',
                'Gross Deductions', 'Net Salary','Salary Bank', 'Salary Account No',
                'IFSC Code', 'PAN', 'Location', 'PF_Membership_No', 'State For PT']
    df.to_excel('File_%d.xlsx' % n, columns = col_list)

def clean_all(root):
    for n, filepath in enumerate(os.listdir(root)):
        path = os.path.join(root, filepath)
        clean_one(path, n)

if __name__ == "__main__":
    root = os.getcwd() # Replace it with necessary directory
    clean_all(root)
</code></pre>
</div>
<span class="comment-copy">I have processed one single file with the following code: file = 'OD_SALARY REGISTER_NOV_2016.xlsx'  df = pd.read_excel(file, skiprows = 4) col_list = ['Emp Code',  'Emp Name',  'Net Salary',  'Gross Earnings',  'Provident Fund',  'Provident Fund_A',  'Profession Tax',  'ESIC Deduction',  'ESIC Deduction_A',  'Gross Deductions',  'Net Salary','Salary Bank',  'Salary Account No',  'IFSC Code',  'PAN',  'Location',  'PF_Membership_No',  'State For PT'] df.to_excel('File_1.xlsx', columns = col_list)</span>
<span class="comment-copy">I don't get why this is a pandas question?</span>
<span class="comment-copy">Thanks, this is what I was looking for</span>
