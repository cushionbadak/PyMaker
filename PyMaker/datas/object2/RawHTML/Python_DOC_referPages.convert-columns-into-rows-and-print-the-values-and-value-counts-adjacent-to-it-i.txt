<div class="post-text" itemprop="text">
<p>I have imported a csv into my python code which looks like this:</p>
<pre><code>df = pd.DataFrame({
         50001:[np.nan,5,np.nan,5,5,np.nan],
         50002:[np.nan,np.nan,9,np.nan,np.nan,3],
         50003:[np.nan,3,5,np.nan,1,np.nan],

})
</code></pre>
<p>I want my data to look like this:</p>
<p><a href="https://i.stack.imgur.com/1pRch.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/1pRch.png"/></a></p>
<p>I have written a code for this but I am only getting the score and the value counts. I am not able to get the rule_id column. This is the code I am using:</p>
<pre><code>for i in dframe:
    dframe1 = dframe.loc[: , i].value_counts()
    print(dframe1)
</code></pre>
<p>which gives me a result like:</p>
<p><a href="https://i.stack.imgur.com/O3SCF.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/O3SCF.png"/></a></p>
<p>If you could help me crack this problem , I would greatly appreciate it.</p>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.melt.html" rel="nofollow noreferrer"><code>DataFrame.melt</code></a> with <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.SeriesGroupBy.value_counts.html" rel="nofollow noreferrer"><code>SeriesGroupBy.value_counts</code></a> or <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.size.html" rel="nofollow noreferrer"><code>GroupBy.size</code></a>:</p>
<pre><code>df = (df.melt(var_name='Rule_ID', value_name='Score')
        .groupby('Rule_ID')['Score']
        .value_counts()
        .reset_index(name='Value_Count'))
print (df)
   Rule_ID  Score  Value_Count
0    50001    5.0            3
1    50002    3.0            1
2    50002    9.0            1
3    50003    1.0            1
4    50003    3.0            1
5    50003    5.0            1
</code></pre>
<p>Or:</p>
<pre><code>df = (df.melt(var_name='Rule_ID', value_name='Score')
        .groupby(['Rule_ID', 'Score'])
        .size()
        .reset_index(name='Value_Count'))
</code></pre>
</div>
