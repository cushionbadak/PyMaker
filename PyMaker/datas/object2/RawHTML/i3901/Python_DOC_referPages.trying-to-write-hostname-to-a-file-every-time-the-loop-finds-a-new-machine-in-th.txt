<div class="post-text" itemprop="text">
<p>I am trying to look for all the Windows computers on a network. Every time the program finds a computer in the network that is up and running, it will open a new file for that computer. In the file, I want to see the name of the machine, and its IP address.</p>
<p>Once I'm done with that, I would like to log the installed apps on a particular computer onto that machine's file, which is why I have a new file for every computer that the program finds.</p>
<p>However, when I run it, the machine has the same name every time. I have tried using import socket, but whenever I use any method that comes with it, I get an error saying that the socket has no attribute. I need from socket import * for my is_up method to work.</p>
<p>Here is my code:</p>
<pre><code>from socket import *

ipa = '192.168.1.'

def is_up(adr):
    s = socket(AF_INET, SOCK_STREAM)
    s.settimeout(0.01)
    if not s.connect_ex((adr, 135)):
        s.close()
        return 1
    else:
        s.close()

def main():
    for i in range(1, 256):
        adr = ipa + str(i)
        if is_up(adr):
            f = open("Machine " + str(i) + ".txt", "w+")
            f.write('%s \t- %s \n' % ("Name: " + gethostname(), adr))

        if is_up(adr):
            print(gethostbyaddr(adr))

main()
</code></pre>
<p><strong>Edit</strong>: I have put the new code here to reflect the use of <code>gethostbyaddr(adr)</code>. I am still getting the following error:</p>
<blockquote>
<p>[Errno 11004] host not found</p>
</blockquote>
<pre><code>def main():
    for i in range(1, 256):
        adr = ipa + str(i)
        if is_up(adr):
            print(gethostbyaddr(adr))
</code></pre>
<p><strong>Traceback</strong> :</p>
<pre><code>Traceback (most recent call last):
  File "C:/Users/eread/PycharmProjects/SoftwareScanner/SoftwareScanner", line 30, in &lt;module&gt;
    main()
  File "C:/Users/eread/PycharmProjects/SoftwareScanner/SoftwareScanner", line 20, in main
    print(gethostbyaddr(adr))
socket.herror: [Errno 11004] host not found
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The issue here is the function used to get the hostname, <a href="https://docs.python.org/3/library/socket.html#socket.gethostname" rel="nofollow noreferrer"><code>gethostname()</code></a> returns the name of the machine where you're executing the script.</p>
<p>If you want the name of the distant machine you're inspecting, you need another function like <a href="https://docs.python.org/3/library/socket.html#socket.gethostbyaddr" rel="nofollow noreferrer"><code>gethostbyaddr</code></a>, which returns a tuple of 3 members : name, list of aliases and list of IPs </p>
<pre><code>if is_up(adr):
    print(gethostbyaddr(adr))

#&gt;&gt;&gt; ('machine_name', [], ['192.168.1.14'])
</code></pre>
<p>The other advantage of using such a function, as you get all details in one object, i think you have no need to use a file to store those, at least before using them in the second part of your script.</p>
<p>You can unpack the values returned by <code>gethostbyaddr</code> to declare the variables you need in the next part :</p>
<pre><code>host_name, _, adresses = gethostbyaddr(adr)
print(host_name)
print(adresses[0]) #this member is a list, use index to access the first

#&gt;&gt;&gt; result :
#machine_name
#192.168.1.14
</code></pre>
</div>
<span class="comment-copy">I tried using gethostbyaddr(adr), but I get an error that says: socket.herror: [Errno 11004] host not found</span>
<span class="comment-copy">it's weird that the function <code>is_up</code> could return 1 if the host is not found, where did you add <code>gethostbyaddr(adr)</code> in your code ?</span>
<span class="comment-copy">I used it to replace gethostname().</span>
<span class="comment-copy">Oh, I just realized you put gethostbyaddr(adr) in the main function, and printed it. My bad. I am trying that right now.</span>
<span class="comment-copy">Getting the same error</span>
