<div class="post-text" itemprop="text">
<p>So, I'm working on a project with a proprietary communication protocol. I need to send data in given format and Up, Down, Left &amp; Right co-ordinates to particular IP address. Communication happens over TCP and I need to program TCP client in python to send data in following format:</p>
<p>IP address/Handshake address: 192.166.166.166</p>
<p>This is the <a href="https://i.stack.imgur.com/TYNVq.png" rel="nofollow noreferrer">Data format</a>.</p>
<p>Data type is unsigned char 0-255 (8-bit binary) and data length is 6-64 bit. </p>
<p>Data length of each frame is 10-64 bit. </p>
<p>So, If I want to move object at 1.0.0.1 to (23, 45, 67, 89), this is the given instruction: </p>
<p>Send 255 255 10 3 1 0 0 1 23 45 67 89 to specified IP address. I imagine specified IP address is 192.166.166.166. You can refer to data format to understand this data that I'm supposed to send. It's quite simple. </p>
<p>The question is, how am I supposed to send this series of unsigned chars over TCP in python? </p>
<p>I've tried following: </p>
<pre><code>import socket
host = '192.166.166.166'
port = 80                   # 80 Because TCP

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((host, port))

data = '255 255 10 3 1 0 0 1 23 45 67 89'
s.sendall(data)
result = s.recv(1024)
s.close()
print('Received', repr(result))
</code></pre>
<p>Obviously this is not working. I've not specified unsigned char and I'm just sending raw data and spaces. </p>
<p>This is what I get in return from server:</p>
<pre><code>('Received', '\'HTTP/1.0 400 Bad Request\\r\\nServer: Mini-IoT-314\\r\\nDate: , 31  1969 23:59:59 GMT\\r\\nPragma: no-
cache\\r\\nCache-Control: no-cache\\r\\nContent-Type: 
text/html\\r\\nConnection: close\\r\\n\\r\\n&lt;HTML&gt;&lt;HEAD&gt;&lt;TITLE&gt;400 Bad 
Request&lt;/TITLE&gt;&lt;/HEAD&gt;\\n&lt;BODY BGCOLOR="#cc9999"&gt;&lt;H4&gt;400 Bad 
Request&lt;/H4&gt;\\nCan\\\'t parse request.\\n&lt;/BODY&gt;&lt;/HTML&gt;\\n\'')
</code></pre>
<p>Now, I'm not sure what to do and how to send this data so server can process this data appropriately. I would really appreciate a help here. </p>
</div>
<div class="post-text" itemprop="text">
<p>Not really my area of expertise, just an idea:
You might need to send the data as a Structure.</p>
<p>Have a look at python's ctypes: <a href="https://docs.python.org/3/library/ctypes.html#structured-data-types" rel="nofollow noreferrer">https://docs.python.org/3/library/ctypes.html#structured-data-types</a></p>
<pre><code>from ctypes import *

class payload(Structure):
    _fields_ = [("data_sign1", c_ubyte),
                  ...]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>1) I tested your code in python 3.5 with slight modifications rather than sending string,i sent bytes by converting string into bytes</p>
<pre><code>bytes(data,'utf-8')
</code></pre>
<p>2) Do not use Port 80,might be your http server is running on that port,
 Try to use some other port. it will work</p>
</div>
<span class="comment-copy">Thanks for the answer. I tried this. But It's not working. Server is not able to parse the request.</span>
<span class="comment-copy">Thanks for the answer. I tried this but It's not working. Got the same error message.   I scanned with arp and nmap. And only one host is active which is 192.166.166.166 and only two ports are open, 80 &amp; 50000. And IBM DB2 is hosted on 50000.</span>
