<div class="post-text" itemprop="text">
<p>When I try to run my batch file for python script I get the error </p>
<pre><code>D:\Sandbox\Python\Python Scripts&gt;AQACompareBooks.py "D:/Sandbox/AQA/OrderAnalysis/Customer 1 OrderAnalysis -1 2018-05-08.xlsx"
[]
Traceback (most recent call last):
  File "D:\Sandbox\Python\Python Scripts\AQACompareBooks.py", line 33, in &lt;module&gt;
    xls = pd.ExcelFile(file)
  File "D:\Dev\Sandbox\Python\lib\site-packages\pandas\io\excel.py", line 260, in __init__
    self.book = xlrd.open_workbook(io)
  File "D:\Dev\Sandbox\Python\lib\site-packages\xlrd\__init__.py", line 116, in open_workbook
    with open(filename, "rb") as f:
FileNotFoundError: [Errno 2] No such file or directory: '[]'
</code></pre>
<p>Batch File </p>
<pre><code>AQACompareBooks.py "D:\Sandbox\AQA\OrderAnalysis\Customer1 OrderAnalysis -1 2018-05-08.xlsx"
</code></pre>
<p>Python Code</p>
<pre><code>import pandas as pd 
import numpy as np  
import os
import sys


print(sys.argv[1:])
file = format(sys.argv[1:])
xls = pd.ExcelFile(file)
</code></pre>
<p>If I set the path manually in the code I everything works fine.</p>
<p>i.e.</p>
<pre><code>file = 'D:\Sandbox\AQA\OrderAnalysis\Customer1 OrderAnalysis -1 2018-05-08.xlsx'
</code></pre>
<p>Has anyone experienced this issue before?</p>
<p>Batch file and script are in the same folder. 
The files I want to load is not</p>
</div>
<div class="post-text" itemprop="text">
<p>This looks a lot like it's a Windows issue with the extension association for <code>.py</code> files. In one Windows installation I checked where a test Python script did receive arguments, the registry key <code>HKEY_CLASSES_ROOT\Python.File\Shell\open\command</code> is set to <code>"C:\WINDOWS\py.exe" "%L" %*</code> (including those quotes). The trailing <code>%*</code> is what passes the arguments that Python then stores in <code>sys.argv</code>. </p>
<p>Second is the part with <code>format(sys.argv[1:])</code>; that slice will always produce a list, whereas the filename you wanted is stored in the single element <code>sys.argv[1]</code>. Simply use that instead.</p>
<p>With thanks to tdelaney for pointing them out, the associations can be checked (and, if administrator, set) using the <code>assoc</code> and <code>ftype</code> commands:</p>
<pre><code>C:\Users\yann&gt;assoc .py
.py=Python.File

C:\Users\yann&gt;ftype Python.File
Python.File="C:\WINDOWS\py.exe" "%L" %*
</code></pre>
</div>
<span class="comment-copy">Does the print show anything? What line has the fail?</span>
<span class="comment-copy">The code you show doesn't produce that error. We need to see the part that is broken to offer suggestions.</span>
<span class="comment-copy">The print doesn't show anything.</span>
<span class="comment-copy">To my knowledge that code has to produce the error. If remove the argument in the batch file, and set the path manually in the script. i.e. file = 'path' everything works ok.</span>
<span class="comment-copy">You should use the <a href="https://docs.python.org/3/reference/lexical_analysis.html#grammar-token-stringprefix" rel="nofollow noreferrer">raw string prefix <code>r</code></a> if you're going to have unescaped backslashes in your string literals. I also don't know why you seem to have lost the argument, but <code>argv[1:]</code> is still a list (slice with 0 or more elements), so those <code>[]</code> characters may come from the <code>format</code> call. The exception you showed comes from code we don't know.</span>
<span class="comment-copy">Hi Yann, thanks for the answer. How would I check this. Also with the computer that I am using, python is installed on the D drive and not the C where the OS is installed.</span>
<span class="comment-copy">Try the registry editor <code>regedit</code> (note that the registry holds a lot of other things, including more critical settings, so don't edit it carelessly).</span>
<span class="comment-copy">On the command line <code>ftype Python.File</code> should show the file association.</span>
<span class="comment-copy">The command ftype Python.File returned file type not found</span>
<span class="comment-copy">Then check <code>assoc .py</code> to find what the association you do have is called. It appears your Python installation wasn't made by the usual installer and may be missing the feature that lets it pass arguments.</span>
