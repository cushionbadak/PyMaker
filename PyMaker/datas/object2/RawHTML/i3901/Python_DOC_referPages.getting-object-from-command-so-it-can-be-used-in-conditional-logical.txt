<div class="post-text" itemprop="text">
<p>Pretty basic question and concept that I don't know the answer to. I am playing with <a href="https://pypi.org/project/clamd/" rel="nofollow noreferrer">Clamd 1.0.2</a> and in the example it shows the following when using the CLI:</p>
<pre><code>&gt;&gt;&gt; import clamd
&gt;&gt;&gt; cd = clamd.ClamdUnixSocket()
&gt;&gt;&gt; cd.ping()
'PONG'
&gt;&gt;&gt; cd.version()                             # doctest: +ELLIPSIS
'ClamAV ...
&gt;&gt;&gt; cd.reload()
'RELOADING'
&gt;&gt;&gt; open('/tmp/EICAR','wb').write(clamd.EICAR)
&gt;&gt;&gt; cd.scan('/tmp/EICAR')
{'/tmp/EICAR': ('FOUND', 'Eicar-Test-Signature')}
</code></pre>
<p>I want to be able to take the object <code>cd.scan('/tmp/EICAR')</code> creates and use it in a conditional. Something like: <code>if FOUND then send email to administrator and notify the user</code>. </p>
<p>I'm just not understanding how to access the object that is created. How do you access it? Using Python 3.6.5.</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>&gt;&gt;&gt; cd.scan('/tmp/EICAR')
{'/tmp/EICAR': ('FOUND', 'Eicar-Test-Signature')}
</code></pre>
<p><code>cd.scan('/tmp/EICAR')</code> returns a <a href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries" rel="nofollow noreferrer">dictionary</a>. You can access values in dictionaries by their keys. In this case, the key is <code>/tmp/EICAR</code>. The value for that key is a <a href="https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences" rel="nofollow noreferrer">tuple</a>. To access a member of a tuple, you can do so just like you would with an array - <code>tuplename[index]</code>.</p>
<pre><code>result = cd.scan('/tmp/EICAR')
if (result['tmp/EICAR'][0] == 'FOUND'):
    print("Send email")
</code></pre>
<p>Similarly, the value <code>'Eicar-Test-Signature'</code> in this case can be accessed via <code>result['tmp/EICAR'][0]</code>. I don't know what the side effects of the <code>cd.scan</code> function are, but you could bypass the variable <code>result</code> entirely and just use <code>cd.scan('/tmp/EICAR')['/tmp/EICAR'][1]</code> to access <code>'Eicar-Test-Signature'</code>.</p>
<p>Keep in mind if the <code>cd.scan</code> function fails or returns something other than what you expect, the key <code>/tmp/EICAR</code> may not be in the dictionary (I don't how the <code>clamd</code> library works or what it does). In that case, you can check whether a key exists in a dictionary like this:</p>
<pre><code>if '/tmp/EICAR' in result:
    print('key is present')
</code></pre>
</div>
<span class="comment-copy">How does the result look if nothing or something else has been found?</span>
