<div class="post-text" itemprop="text">
<p>So I'm trying to read a list of IP addresses from a .txt into a subprocess (Nmap) in Python.  It's also worth asking if the problem could be the use of quotes or not.  Here's the code:</p>
<pre><code>addressFile = raw_input("Input the name of the IP address list file.  File must be in current directory." )
fileObj = open(addressFile, 'r')


for line in fileObj:
    strLine = str(line)
    command = raw_input("Please enter your Nmap scan." )
    formatCom = shlex.split(command)
    subprocess.check_output([formatCom, strLine])
</code></pre>
<p>Trusty error message:</p>
<pre><code>Traceback (most recent call last):
  File "mod2hw7.py", line 15, in &lt;module&gt;
    subprocess.check_output([formatCom, strLine])
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 566, in check_output
    process = Popen(stdout=PIPE, *popenargs, **kwargs)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 709, in __init__
    errread, errwrite)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 1326, in _execute_child
    raise child_exception
AttributeError: 'list' object has no attribute 'rfind'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/shlex.html#shlex.split" rel="nofollow"><code>shlex.split</code></a> returns a list; you should catenate this list with 1 element list containing <code>strline</code> when building command line arguments:</p>
<pre><code>formatCom = shlex.split(command)
subprocess.check_output(formatCom + [strLine])
</code></pre>
<hr/>
<p>The error occurs because instead of </p>
<pre><code>subprocess.check_output([ 'nmap', '-sT', '8.8.8.8' ])
</code></pre>
<p>you are executing something like</p>
<pre><code>subprocess.check_output([ ['nmap', '-sT'], '8.8.8.8' ])
</code></pre>
<p>and <code>subprocess</code> expects to be given a list of strings, not nested lists.</p>
</div>
<span class="comment-copy">By the way, <code>strLine = str(line)</code> is unnecessary. <code>line</code> is already a string. Also, you should open the file with a context manager: <code>with open(addressFile) as input_file:</code> Then on the next line: <code>for line in input_file:</code></span>
<span class="comment-copy">Lots of problems can be sorted out simply by printing out the parameters of the failing command. Try <code>print ([formatCom, strLine])</code> and see if it looks right.</span>
<span class="comment-copy">unrelated: <code>nmap</code> can read ips from a file itself, use <code>-iL &lt;file&gt;</code> option: <code>subprocess.check_call(formatCom + ['-iL', addressFile])</code></span>
<span class="comment-copy">Thanks a lot guys, the printing the failing command tip was helpful.</span>
<span class="comment-copy">The line also needs to have its new-line stripped (and casting it to string is unnecessary) so... <code>[line.strip()]</code> works better.</span>
<span class="comment-copy">Thanks for the solution, that was exactly what I was hoping for!</span>
