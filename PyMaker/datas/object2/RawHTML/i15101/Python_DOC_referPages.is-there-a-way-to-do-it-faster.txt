<div class="post-text" itemprop="text">
<p>ladder have around 15000 elements, this code snippet performed in 5-8sec, is there any way to do it faster? I try do it without checking for duplicate and without creating accs list and time was down to 2-3sec, but I don't need duplicate in csv file.<br/>
I work in python 2.7.9</p>
<pre class="lang-py prettyprint-override"><code>accs =[]
with codecs.open('test.csv','w', encoding="UTF-8") as out:
        row = ''
        for element in ladder:
                if element['account']['name'] not in accs:
                        accs.append(element['account']['name'])
                        row += element['account']['name']
                        if 'twitch' in element['account']:
                                row +=  "," + element['account']['twitch']['name'] + ","
                        else:
                                row += ",,"
                        row += str(element['account']['challenges']['total']) + "\n"
        out.write(row)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>seen    = set()
results = []

for user in ladder:
    acc  = user['account']
    name = acc['name']
    if name not in seen:
        seen.add(name)
        twitch_name = acc['twitch']['name'] if "twitch" in acc else ''
        challenges  = acc['challenges']['total']
        results.append("%s,%s,%d" % (name, twitch_name, challenges))

with codecs.open('test.csv','w', encoding="UTF-8") as out:
    out.write("\n".join(results))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You canâ€™t do much about the loop, since you need to go through every element in <code>ladder</code> after all. However, you can improve this membership test:</p>
<pre><code>if element['account']['name'] not in accs:
</code></pre>
<p>Since <code>accs</code> is a list, this will essentially loop through all items of <code>accs</code> and check if the name is in there. And you loop for every element in <code>ladder</code>, so this can easily become very inefficient.</p>
<p>Instead, use a <em>set</em> instead of a list for <code>accs</code> as this will give you a constant membership lookup. So you reduce your algorithm from a quadratic complexity to a linear complexity. For that, just use <code>accs = set()</code> and change your code to use <code>accs.add()</code> instead of <code>append</code>.</p>
<p>Another issue is that you are doing string concatenation. Every time you do <code>someString + "something"</code> you are throwing away that string object and create a new one. This can become inefficient for a high number of operations too. Instead, use a list here to collect all the elements you want to write, and then join them:</p>
<pre><code>row = []
row.append(element['account']['name'])
if 'twitch' in element['account']:
    row.append(element['account']['twitch']['name'])
else:
    row.append('')
row.append(str(element['account']['challenges']['total']))

out.write(','.join(row))
out.write('\n')
</code></pre>
<p>Alternatively, since you are writing to a file anyway, you could just call <code>out.write</code> multiple times with each string part.</p>
<p>Finally, you could also look into the <a href="https://docs.python.org/3/library/csv.html" rel="nofollow"><code>csv</code></a> module if you are interested in writing out CSV data.</p>
</div>
<span class="comment-copy">Instead of list, try using dictionary. That should make it faster. Membership check will be done in about O(1).</span>
<span class="comment-copy">If the items are hashable (eg strings) then <code>accs = set()</code> and then <code>accs.add</code> instead of <code>accs.append</code> should help</span>
<span class="comment-copy">It's need little change because ladder['account']['twitch'] is optional and not always set, but after that is the fastest solution. Now it takes below 0.2sec :OOOO Thanks You! Even in my dreams I did't think that it is possible to do this so fast</span>
<span class="comment-copy">@XnIcRaM: that's what <code>if twitch in acc else ''</code> is for ;-)</span>
<span class="comment-copy">with this form I get error. I change it to <code>if 'twitch' in acc:                         twitch_name = acc['twitch']['name']                 else:                         twitch_name = ''</code> and now it's ok</span>
<span class="comment-copy">D'oh! <code>twitch</code> should have been <code>"twitch"</code> (fixed now). With this change, the inline <code>if</code> works fine.</span>
<span class="comment-copy">It's works and I get time from 0.11 - 0.13 Amazing! Once again Thanks You so much!</span>
<span class="comment-copy">Big thanks, It's work great, now it take below 0.5sec, simple change, amazing effect :D  I first try csv module but I have problem with utf8 and then I leave it</span>
