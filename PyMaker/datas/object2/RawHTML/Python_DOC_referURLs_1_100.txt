<div class="post-text" itemprop="text">
<p>I am trying to run this command in Python3.  Each part separately works correctly, but I cannot get them to work together.</p>
<pre class="lang-py prettyprint-override"><code>os.system('ssh -t user@computer \'cd /MatLabFolder; /Applications/MATLAB_R2017a.app/bin/matlab -r \"cd /Test; try, run(\'/Test/TF03_MatLabCommands_and_results.m\'); end; quit\"; bash -l\'')
</code></pre>
<p>For now <code>TF03_MatLabCommands_and_results.m</code> just has the following in it</p>
<pre class="lang-matlab prettyprint-override"><code>in_dir_list={'/Volumes/promiseraid9/workspace/colleen/NewResiduals/Test/58514_TF03_default','/Volumes/promiseraid9/workspace/colleen/NewResiduals/Test/58514_TF03_mask10'};
out_dir_list={'/Volumes/promiseraid9/workspace/colleen/NewResiduals/Test/58514_TF03_default','/Volumes/promiseraid9/workspace/colleen/NewResiduals/Test/58514_TF03_mask10'};
in_dir_list
</code></pre>
<p>Basically I'm just having it print out what <code>in_dir_list</code> is, just so that I can see it is working.</p>
<p>Now if I am already <code>ssh</code>'d onto the computer I want to process on, and run</p>
<pre class="lang-sh prettyprint-override"><code>/Applications/MATLAB_R2017a.app/bin/matlab -r "cd /Test; try, run('/Test/TF03_MatLabCommands_and_results.m'); end; quit"
</code></pre>
<p>it runs as it should.  So I know the UNIX command is correct. 
But if I run the first command, MATLAB is not recognizing the <code>"  \'  "</code> like Python does, and is just eliminating the <code>'</code> all together so the command that gets run in MATLAB ends up being</p>
<pre class="lang-none prettyprint-override"><code>cd /Test; try, run(/Test/TF03_MatLabCommands_and_results.m); end; quit
                    |
Error: Unexpected MATLAB operator.
</code></pre>
<p>Notice no <code>'</code> before and after the M-file and path.</p>
<p>I also know the ssh command is also correct, because running it up until the point of running a command in MATLAB also works (meaning I can ssh to the computer, and open up MATLAB). And it attempts to run the command at least, but because of the <code>"  '\  "</code> confusion, it doesn't see the needed <code>'</code>.  </p>
<p>How do I properly escape the quotes?</p>
</div>
<div class="post-text" itemprop="text">
<p>Escaping quotes through multiple shells is a nightmare. In principle you should escape both the <code>\</code> and the <code>'</code> characters, leading to <code>\\\'</code>:</p>
<pre class="lang-none prettyprint-override"><code>run(\\\'/Test/TF03_MatLabCommands_and_results.m\\\')
</code></pre>
<p>But it depends on which shells are used, and how these parse the strings, what the exact combination of escape characters and quotes you end up with.</p>
<p>A simpler solution is to avoid the quotes altogether. In MATLAB,</p>
<pre class="lang-matlab prettyprint-override"><code>run('/Test/TF03_MatLabCommands_and_results.m')
</code></pre>
<p>is the same as</p>
<pre class="lang-matlab prettyprint-override"><code>run Test/TF03_MatLabCommands_and_results.m
</code></pre>
<p>The latter doesn't require quotes, as long as there are no spaces in the file name.</p>
</div>
<span class="comment-copy">Excellent, that worked run Test/TF03_MatLabCommands_and_results.m Thank you so very much!!</span>
<div class="post-text" itemprop="text">
<p>I have a dask DataFrame like below.</p>
<pre class="lang-py prettyprint-override"><code>&gt; print(df_user_preferences)
       user_id  food_id
int64  int64    int64
...
</code></pre>
<p>This dataframe represents the Many-to-Many relation between <code>user</code> and <code>food</code>.
There are also two dataframes, <code>df_users</code> and <code>df_foods</code>, and these are master data of users and foods. </p>
<p>And now, I want to gain dataframe like below.</p>
<pre class="lang-py prettyprint-override"><code># index is user_id.
&gt; print(df_spread_user_preferences)
       food_1   food_2   food_3   food_4  ...
int64  boolean  boolean  boolean  boolean ...
...
</code></pre>
<p>These columns with the prefix <code>food_</code> ends with <code>food_id</code> and values of them represent the relation between <code>user</code> and <code>food</code>.</p>
<p>I tried below code, but this is too slow.
How can I improve this code to perform more effectively?</p>
<pre class="lang-py prettyprint-override"><code>df_spread_user_preferences = df_users.assign(**{
    f"food_{food_id}": lambda df, food_id: df.apply(
      lambda row, food_id: len(df_user_preferences[(
          df_user_preferences.food_id == food_id
      ) &amp; (
          df_user_preferences.user_id == row.name
      )]) &gt; 0,
      axis=1,
      meta='boolean',
      food_id=food_id
    ) for _, food_id in df_foods.index.to_series().iteritems()
}).drop(df_users.columns)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>df_users = pd.DataFrame({'user_id': [1,2]})
df_foods = pd.DataFrame({'food_id': [11,22,33,44]})
df_user_preferences = pd.DataFrame({'user_id' : [1,1], 'food_id' : [11,22]})

# Create a dataframe with columns user_ids and all food_ids.
# All food_ids of all the users are assigned False
df_spread_user_preferences = pd.DataFrame({
        **{'user_id': df_users['user_id']}, 
        **{"food_{0}".format(i):False for i in df_foods['food_id']}})
# Find the food preference of the users and create a list 
foods = df_user_preferences.groupby(['user_id'])['food_id'].apply(list).apply(
    lambda x: ["food_{0}".format(i) for i in x]).reset_index()
# For each user get the preference list and reset them to True 
for _, r in foods.iterrows():
     df_spread_user_preferences.loc[
df_spread_user_preferences['user_id'] == r['user_id'], r['food_id']] = True

print (df_spread_user_preferences)
</code></pre>
<p><code>
    food_11     food_22     food_33     food_44     user_id
0   True        True        False       False       1
1   False       False       False       False       2</code></p>
<p>You can set the index to user_id using <code>df_spread_user_preferences.set_index('user_id')</code></p>
</div>
<div class="post-text" itemprop="text">
<p>I want to run the command 
<code>generate_tfrecord.py --csv_input=data/train_labels.csv  --output_path=train.record</code> in windows 10 with ANACONDA COMMAND PROMPT. For the python code <a href="https://github.com/datitran/raccoon_dataset/blob/master/generate_tfrecord.py" rel="nofollow noreferrer">generate_tfrecord.py</a>.I have installed tensorflow object detection API successfully. And converted the dataset to CSV file. I want to convert the CSV file to tfrecord file. </p>
<pre><code>"""
Usage:
# From tensorflow/models/
# Create train data:

  python generate_tfrecord.py --csv_input=data/train_labels.csv  --output_path=train.record
  # Create test data:
  python generate_tfrecord.py --csv_input=data/test_labels.csv  --output_path=test.record
"""
from __future__ import division
from __future__ import print_function
from __future__ import absolute_import

import os
import io
import pandas as pd
import tensorflow as tf

from PIL import Image
from object_detection.utils import dataset_util
from collections import namedtuple, OrderedDict

flags = tf.app.flags
flags.DEFINE_string('csv_input', '', 'Path to the CSV input')
flags.DEFINE_string('output_path', '', 'Path to output TFRecord')
flags.DEFINE_string('image_dir', '', 'Path to images')
FLAGS = flags.FLAGS


# TO-DO replace this with label map
def class_text_to_int(row_label):
    if row_label == 'hand':
        return 1
    else:
        None


def split(df, group):
    data = namedtuple('data', ['filename', 'object'])
    gb = df.groupby(group)
    return [data(filename, gb.get_group(x)) for filename, x in zip(gb.groups.keys(), gb.groups)]


def create_tf_example(group, path):
    with tf.gfile.GFile(os.path.join(path, '{}'.format(group.filename)), 'rb') as fid:
        encoded_jpg = fid.read()
    encoded_jpg_io = io.BytesIO(encoded_jpg)
    image = Image.open(encoded_jpg_io)
    width, height = image.size

    filename = group.filename.encode('utf8')
    image_format = b'jpg'
    xmins = []
    xmaxs = []
    ymins = []
    ymaxs = []
    classes_text = []
    classes = []

    for index, row in group.object.iterrows():
        xmins.append(row['xmin'] / width)
        xmaxs.append(row['xmax'] / width)
        ymins.append(row['ymin'] / height)
        ymaxs.append(row['ymax'] / height)
        classes_text.append(row['class'].encode('utf8'))
        classes.append(class_text_to_int(row['class']))

    tf_example = tf.train.Example(features=tf.train.Features(feature={
        'image/height': dataset_util.int64_feature(height),
        'image/width': dataset_util.int64_feature(width),
        'image/filename': dataset_util.bytes_feature(filename),
        'image/source_id': dataset_util.bytes_feature(filename),
        'image/encoded': dataset_util.bytes_feature(encoded_jpg),
        'image/format': dataset_util.bytes_feature(image_format),
        'image/object/bbox/xmin': dataset_util.float_list_feature(xmins),
        'image/object/bbox/xmax': dataset_util.float_list_feature(xmaxs),
        'image/object/bbox/ymin': dataset_util.float_list_feature(ymins),
        'image/object/bbox/ymax': dataset_util.float_list_feature(ymaxs),
        'image/object/class/text': dataset_util.bytes_list_feature(classes_text),
        'image/object/class/label': dataset_util.int64_list_feature(classes),
    }))
    return tf_example


def main(_):
    writer = tf.python_io.TFRecordWriter(FLAGS.output_path)
    path = os.path.join(FLAGS.image_dir)
    examples = pd.read_csv(FLAGS.csv_input)
    grouped = split(examples, 'filename')
    for group in grouped:
        tf_example = create_tf_example(group, path)
        writer.write(tf_example.SerializeToString())

    writer.close()
    output_path = os.path.join(os.getcwd(), FLAGS.output_path)
    print('Successfully created the TFRecords: {}'.format(output_path))


if __name__ == '__main__':
    tf.app.run()
</code></pre>
<p>Please help me to execute the file. 
Thanks in advance.</p>
</div>
<span class="comment-copy">Why almost all of your code is commented-out??</span>
<span class="comment-copy">Sorry. Now, I have edited the code. And I have successfully executed the code with Anaconda command prompt by providing the actual path of the CSV and Image file.</span>
<div class="post-text" itemprop="text">
<p>I'm using Django and Python 3.7.  I have created a YAML file with seed data for my db ...</p>
<pre><code>./myapp/fixtures/seed_data.yaml
</code></pre>
<p>How do I run this without generating a new migration for it, as is specified here -- <a href="https://stackoverflow.com/questions/25960850/loading-initial-data-with-django-1-7-and-data-migrations">Loading initial data with Django 1.7 and data migrations</a> ?  I think theoretically there may be times when I add data to the file and my need to re-run it so it would be a little cumbersome to generate a new migration every time.</p>
</div>
<div class="post-text" itemprop="text">
<p>Migrations will only run once, as you already correctly noticed :)  </p>
<p>However, you can always manually run a <code>./manage.py loaddata &lt;fixture&gt;</code>. Don't know if that's what you're looking for.</p>
</div>
<span class="comment-copy">Ah yes that "loaddata" was what I was missing!  Thx</span>
<span class="comment-copy">You're welcome. But you still might've a problem when you're loading the same data twice. Django doesn't have any "magic" to prevent this (of course).</span>
<span class="comment-copy">Maybe its because I have "pk"s in my yaml file, but running this multiple times doens't seem to result in any errors so I think I might be good.</span>
<div class="post-text" itemprop="text">
<p>I am importing stock data in python from yahoo. </p>
<pre><code>import pandas as pd
import numpy as np
from pandas_datareader import data
from datetime import date
from datetime import timedelta

def Get_Historic_SP(ticker):
    end_date = date.today()
    start_end = end_date - timedelta(weeks=260)
    df = data.DataReader(ticker, data_source='yahoo',start=start_date, end=end_date)
    df.index = pd.to_datetime(df.index)
    df.reset_index().rename(columns={df.index.name:'Date'})
    return df['Close']
</code></pre>
<p>This works well. I would like to do this for multiple codes and create one dataframe with the companies in columns. Also each column to have ticker (comps) as the title. </p>
<p>I am using:</p>
<pre><code>    comps = ['AVON.L', 'BYG.L']
</code></pre>
<p>example</p>
<pre><code>    Date         AVON.L    BYG.L
    20/03/2019   193       980
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Fixing your code as follows:</p>
<pre><code>import pandas as pd
import numpy as np
from pandas_datareader import data
from datetime import date
from datetime import timedelta

def Get_Historic_SP(ticker, start_date):
    end_date = date.today()
    start_end = end_date - timedelta(weeks=260)
    df = data.DataReader(ticker, data_source='yahoo',start=start_date, end=end_date)
    df.index = pd.to_datetime(df.index)
    df.reset_index().rename(columns={df.index.name:'Date'})
    return df['Close']
</code></pre>
<p>You can use the following code that first creates a dictionary and then converts it to a DataFrame:</p>
<pre><code>tickers = ['googl', 'aapl']

ticker_dict = {}
for ticker in tickers:
    ticker_dict[ticker] = Get_Historic_SP(ticker, date(2019,3,1))

df = pd.DataFrame(ticker_dict)
</code></pre>
</div>
<span class="comment-copy">What is <i>this</i>? Could you explain what you are trying to do.</span>
<span class="comment-copy">I can get historical stock price data from yahoo easier enough (the first set of code). But struggling to put multiple calls of the function - Get_Historic_SP - into a pandas dataframe</span>
<span class="comment-copy">You code example cant execute, you are missing a timedelta import from datetime, and your function does not take start_date as an input.</span>
<div class="post-text" itemprop="text">
<p>I use <strong>Flask</strong> and more precisely <strong>abort</strong> with <strong>an error handler</strong>. I can <strong>custom</strong> the <strong>message</strong> sent with my error by using <strong>make_response</strong>. I also use <strong>Blueprints</strong> to register the error handler.</p>
<p>Before today, everything were fine. But things go bad today and it is impossible to custom my message anymore.</p>
<p>For my example, I take the 401 error and I try to send the message "custom message"</p>
<p>My handler for error 401</p>
<pre><code>@errors.app_errorhandler(401)
def access_denied(error):
    # if the description have the message attribute
    if 'message' in error.description:
        return make_response(jsonify(
            {
                'error': error.description['message']
            }
        ), 401)
    else:
        return make_response(jsonify(
            {
                'error': 'Access Denied'
            }
        ), 401)
</code></pre>
<p>My blueprint registration in <strong>__init__.py</strong></p>
<pre><code>from app.errors.ErrorHandler import errors
app.register_blueprint(errors)
</code></pre>
<p>My abort call</p>
<pre><code>from flask import abort
abort(
      401,
      {
           'message': 'custom message'
      }
)
</code></pre>
<p>The error 401 is handled by my handler but the message sent is the default message 'Access Denied'.</p>
<p>I insist : Everything worked yesterday ! (19 March 2019 - 6pm)
Maybe it is a bug or an improvement not documented at all</p>
<p>Thank you for your help and if you need more information, feel free to ask</p>
<p>Louis</p>
</div>
<div class="post-text" itemprop="text">
<p>The problem was from the werkzeug module : <a href="https://github.com/pallets/werkzeug/issues/1483" rel="nofollow noreferrer">https://github.com/pallets/werkzeug/issues/1483</a></p>
<p>It is fixed now</p>
</div>
<div class="post-text" itemprop="text">
<p>I'm creating a new view to user create a record of a object inside a module, so I've created the <code>&lt;record&gt;</code> on <code>.xml</code> and a class python on <code>.py</code> file to bind the fields' <code>&lt;record&gt;</code> with python variables. Problem is that when I run the erros occurs:</p>
<pre><code>Model not found: new.activity.type

Error context:
View `New Activity Type`
[view_id: 771, xml_id: vz_custom_activities.custom_activities_new_activity_type, model: new.activity.type, parent_id: n/a]
None" while parsing /Users/augustosansoncadini/odoo_dev/git/addons/vz_custom_activities/views/views.xml:35, near
&lt;record id="custom_activities_new_activity_type" model="ir.ui.view"&gt;
      &lt;field name="name"&gt;New Activity Type&lt;/field&gt;
      &lt;field name="model"&gt;new.activity.type&lt;/field&gt;
      &lt;field name="arch" type="xml"&gt;
        &lt;form&gt;
          &lt;group&gt;
            &lt;field name="name"/&gt;
          &lt;/group&gt;
        &lt;/form&gt;
      &lt;/field&gt;
    &lt;/record&gt;
</code></pre>
<p><strong><em>views.xml</em></strong></p>
<pre><code>&lt;record id="custom_activities_new_activity_type" model="ir.ui.view"&gt;
  &lt;field name="name"&gt;New Activity Type&lt;/field&gt;
  &lt;field name="model"&gt;new.activity.type&lt;/field&gt;
  &lt;field name="arch" type="xml"&gt;
    &lt;form&gt;
      &lt;group&gt;
        &lt;field name="name"/&gt;
      &lt;/group&gt;
    &lt;/form&gt;
  &lt;/field&gt;
&lt;/record&gt;
</code></pre>
<p><strong><em>new_activity_type.py</em></strong></p>
<pre><code>from odoo import models, fields, api

class new_activity_type(models.Model):
    _name = 'new.activity.type'

    name = fields.Text('Name')
</code></pre>
<p><strong><em>__init__.py</em></strong></p>
<pre><code># -*- coding: utf-8 -*-

from . import controllers
from . import models
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You have imported your <code>models</code> directory with relative path, which is okay, but you also need to remember python modules (<code>.py</code> files) inside your <code>models</code> have to be imported in the models directory <code>__init__.py</code> file using relative path. That way, whenever your module is installed in odoo, odoo will import the modules root directory <code>__init__.py</code>, all of the <code>models</code> definition in the <code>.py</code> files will get imported.</p>
<p>This is not just for models directory but any other directories also, you have to import <code>.py</code> to get those python codes working. For example, <code>controllers</code>, <code>wizards</code>, <code>reports</code> directory <code>.py</code> files also, if there are any. This works in following way: whenever a package in Python gets imported, <code>__init.py__</code> files get executed automatically, so the execution goes like following: </p>
<blockquote>
<p>addons root dir <code>__init__.py</code> &gt;&gt; models dir <code>__init__.py</code> &gt;&gt; all <code>.py</code>
  files that are imported in that file.</p>
</blockquote>
<p>In your <code>models</code> directory, create <code>__init__.py</code> file, if not already exists.</p>
<p><strong><em>models/__init__.py</em></strong></p>
<pre><code>from . import new_activity_type
</code></pre>
</div>
<span class="comment-copy">What I must do to solve my problem?</span>
<span class="comment-copy">Check updated answer, i added the instructions</span>
<span class="comment-copy">I did it, but the fields showed on the view aren't same that declared on <code>new_activity_type.py</code> instead show fields declared on <code>models.py</code></span>
<span class="comment-copy">can you share your <code>__init__.py</code> file code and your view screenshot?</span>
<span class="comment-copy">view: <a href="https://imgur.com/a/c2fXay5" rel="nofollow noreferrer">imgur.com/a/c2fXay5</a>, init.py: <a href="https://imgur.com/a/hJ6ySdf" rel="nofollow noreferrer">imgur.com/a/hJ6ySdf</a></span>
<div class="post-text" itemprop="text">
<p>Following is the Dataframe I am starting from:</p>
<pre><code>import pandas as pd
import numpy as np

d= {'PX_LAST':[1,2,3,3,3,1,2,1,1,1,3,3],'ma':[2,2,2,2,2,2,2,2,2,2,2,2],'action':[0,0,1,0,0,-1,0,1,0,0,-1,0]}
df_zinc = pd.DataFrame(data=d)

df_zinc
</code></pre>
<h3>Now, I need to add a column called 'buy_sell', which:</h3>
<ul>
<li>when 'action'==1, populates with 1 if 'PX_LAST' &gt;'ma', and with -1 if 'PX_LAST'&lt;'ma'</li>
<li>when 'action'==-1, populates with the opposite of the previous non-zero value that was populated</li>
</ul>
<p>FYI: in my data, the row that needs to be filled with the opposite of the previous non-zero item is always at the same distance from the previous non-zero item (i.e., 2 in the current example). This should facilitate making the code.</p>
<h3>the code that I made so far is the following. It seems right to me. Do you have any fixes to propose?</h3>
<pre><code> while index &lt; df_zinc.shape[0]:
    if df_zinc['action'][index] == 1:
        if df_zinc['PX_LAST'][index]&lt;df_zinc['ma'][index]:
            df_zinc.loc[index,'buy_sell'] = -1
        else:
            df_zinc.loc[index,'buy_sell'] = 1
    elif df_zinc['action'][index] == -1:
            df_zinc['buy_sell'][index] = df_zinc['buy_sell'][index-3]*-1 
    index=index+1
df_zinc
</code></pre>
<h3>the resulting dataframe would look like this:</h3>
<pre><code>    df_zinc['buy_sell'] = [0,0,1,0,0,-1,0,-1,0,0,1,0]

    df_zinc
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>So, this would be my suggestion according to the example output (and assuming I understood the question properly:</p>
<pre><code>def buy_sell(row):
   if row['action'] == 0:
      return 0
   if row['PX_LAST'] &gt; row['ma']:
      return 1 * (-1 if row['action'] == 0 else 1)
   else:
      return -1 * (-1 if row['action'] == 0 else 1)
   return 0

df_zinc = df_zinc.assign(buy_sell=df_zinc.apply(buy_sell, axis=1))      
df_zinc
</code></pre>
<p>This should behave as expected by the rules. It does not take into account the possibility of 'PX_LAST' being equal to 'ma', returning 0 by default, as it was not clear what rule to follow in that scenario.</p>
<p><strong>EDIT</strong></p>
<p>Ok, after the new logic explained, I think this should do the trick:</p>
<pre><code>def assign_buysell(df):
    last_nonzero = None
    def buy_sell(row):
        nonlocal last_nonzero
        if row['action'] == 0:
            return 0
        if row['action'] == 1:
            if row['PX_LAST'] &lt; row['ma']:
                last_nonzero = -1
            elif row['PX_LAST'] &gt; row['ma']:
                last_nonzero = 1
        elif row['action'] == -1:
            last_nonzero = last_nonzero * -1
        return last_nonzero
    return df.assign(buy_sell=df.apply(buy_sell, axis=1))
df_zinc = assign_buysell(df_zinc)
</code></pre>
<p>This solution is independent of how long ago the nonzero value was seen, it simply remembers the last nonzero value and pipes the opposite wen action is -1.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.select.html" rel="nofollow noreferrer"><code>np.select</code></a>, and use <code>np.nan</code> as a label for the rows that satisfy the third condition:</p>
<pre><code>c1 = df_zinc.action.eq(1) &amp; df_zinc.PX_LAST.gt(df_zinc.ma)
c2 = df_zinc.action.eq(1) &amp; df_zinc.PX_LAST.lt(df_zinc.ma)
c3 = df_zinc.action.eq(-1)

df_zinc['buy_sell'] = np.select([c1,c2, c3], [1, -1, np.nan])
</code></pre>
<p>Now in order to fill <code>NaNs</code> with the value from <code>n</code> rows above (in this case <code>3</code>), you can <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.fillna.html" rel="nofollow noreferrer"><code>fillna</code></a> with a shifted version of the dataframe:</p>
<pre><code>df_zinc['buy_sell'] = df_zinc.buy_sell.fillna(df_zinc.buy_sell.shift(3)*-1)
</code></pre>
<p><b> Output </b></p>
<pre><code>   PX_LAST  ma  action  buy_sell
0         1   2       0       0.0
1         2   2       0       0.0
2         3   2       1       1.0
3         3   2       0       0.0
4         3   2       0       0.0
5         1   2      -1      -1.0
6         2   2       0       0.0
7         1   2       1      -1.0
8         1   2       0       0.0
9         1   2       0       0.0
10        3   2      -1       1.0
11        3   2       0       0.0
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I would use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.select.html" rel="nofollow noreferrer"><code>np.select</code></a> for this, since you have multiple conditions:</p>
<pre><code>conditions = [
    (df_zinc['action'] == 1) &amp; (df_zinc['PX_LAST'] &gt; df_zinc['ma']),
    (df_zinc['action'] == 1) &amp; (df_zinc['PX_LAST'] &lt; df_zinc['ma']),
    (df_zinc['action'] == -1) &amp; (df_zinc['PX_LAST'] &gt; df_zinc['ma']),
    (df_zinc['action'] == -1) &amp; (df_zinc['PX_LAST'] &lt; df_zinc['ma'])
]

choices = [1, -1, 1, -1]

df_zinc['buy_sell'] = np.select(conditions, choices, default=0)
</code></pre>
<p><strong>result</strong></p>
<pre><code>print(df_zinc)
    PX_LAST  ma  action  buy_sell
0         1   2       0         0
1         2   2       0         0
2         3   2       1         1
3         3   2       0         0
4         3   2       0         0
5         1   2      -1        -1
6         2   2       0         0
7         1   2       1        -1
8         1   2       0         0
9         1   2       0         0
10        3   2      -1         1
11        3   2       0         0
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>here my solution using the function shift() to trap the data of 3th up row:</p>
<pre><code>df_zinc['buy_sell'] = 0
df_zinc.loc[(df_zinc['action'] == 1) &amp; (df_zinc['PX_LAST'] &lt; df_zinc['ma']), 'buy_sell'] = -1
df_zinc.loc[(df_zinc['action'] == 1) &amp; (df_zinc['PX_LAST'] &gt; df_zinc['ma']), 'buy_sell'] = 1
df_zinc.loc[df_zinc['action'] == -1, 'buy_sell'] = -df_zinc['buy_sell'].shift(3)
df_zinc['buy_sell'] = df_zinc['buy_sell'].astype(int)

print(df_zinc)
</code></pre>
<p>output:</p>
<pre><code>    PX_LAST  ma  action  buy_sell 
0         1   2       0          0
1         2   2       0          0
2         3   2       1          1
3         3   2       0          0
4         3   2       0          0
5         1   2      -1         -1
6         2   2       0          0
7         1   2       1         -1
8         1   2       0          0
9         1   2       0          0
10        3   2      -1          1
11        3   2       0          0
</code></pre>
</div>
<span class="comment-copy">Please include an example of the output you expect. It is hard for me to follow your logic here.</span>
<span class="comment-copy">sure. here it is</span>
<span class="comment-copy">shouldn't the line after <code>elif df_zinc['action'][index] == -1:</code> be <code>df_zinc.loc[index,'buy_sell'] = = df_zinc['PX_LAST'][index-3]*-1</code>? Otherwise you are overwriting PX_LAST instead of adding a new value to the 'buy_sell' column.</span>
<span class="comment-copy">good spot! I changed it (check the new question), and now it seems to work actually. Do you spot any mistakes?</span>
<span class="comment-copy">Your goal is to update the 'PX_LAST', 'buy_sell' or both?</span>
<span class="comment-copy">thanks a lot for the help. This does not respect my logic unfortunately, though. I added my code on the question to clarify what I am trying to do. Do you know how I can fix it?</span>
<span class="comment-copy">thanks a lot for the help. This does not respect my logic unfortunately, though. I added my code on the question to clarify what I am trying to do. Do you know how I can fix it?</span>
<span class="comment-copy">Updated @gianluca , that makes it much simpler :-)</span>
<span class="comment-copy">thanks a lot for the help. This does not respect my logic unfortunately, though. I added my code on the question to clarify what I am trying to do. Do you know how I can fix it?</span>
<span class="comment-copy">Could you clarify where it differs, since im getting the same output.</span>
<span class="comment-copy">'buy_sell' should be zero by default. That said, when it is in the same row where action=1, it should = 1 if PX_LAST&gt;ma, and it should =-1 if PX_LAST&lt;ma. When instead it is in the same row where action=-1, it should have the same value it had 3 rows before. In your code, the cases in which action=-1 do no link to buy_sell's previous value (the one 3 rows before).   In my opinion, you can only execute this logic through a loop. Which is what I am trying to do (check my question - I edited it to include my current code).</span>
<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/9764930/capturing-repeating-subpatterns-in-python-regex">Capturing repeating subpatterns in Python regex</a>
<span class="question-originals-answer-count">
                    4 answers
                </span>
</li>
</ul>
</div>
<p>I want to capture repeated groups in Python as a separate list:</p>
<pre><code>match = re.match(r'!((?:abc|123)+)!', '!abc123abc!').groups()
print(match)
print(len(match))
</code></pre>
<p>This gives back a tuple with a single element:</p>
<pre><code>('abc123abc',)
1
</code></pre>
<p>How can I get the following output?</p>
<pre><code>('abc', '123', 'abc',)
3
</code></pre>
<p>Following <a href="https://www.regular-expressions.info/captureall.html" rel="nofollow noreferrer">this helpful article on capturing repeated groups</a> I now understand the earlier problem I had, trying to repeat a capturing group instead of capturing a repeated group. But still I don't understand how or if it is possible to capture <strong>different groups</strong> for better post-processing.</p>
<p>Please note that I cannot do without the pre-/suffix, because this also contains multiple capturing groups. My actual use case differs a little bit from this MWE, but should be clear enough.</p>
</div>
<div class="post-text" itemprop="text">
<p>This resembles the correct answer by @WiktorStribiżew while staying more easily comparable to my original question</p>
<pre><code>import regex as re
match = re.match(r'!(abc|123)+!', '!abc123abc!').captures(1)
print(match)
print(len(match))
</code></pre>
<p>Which correctly outputs</p>
<pre><code>['abc', '123', 'abc']
3
</code></pre>
<p>This works, because the <code>regex</code> module (not to be confused with Python's internal <code>re</code> module) handles groups differently when using the <code>capture()</code> method, i.e. not overwriting them (as outlined in the article in my original question), but rather append them, not overwriting the index. This can be followed in the section <em>Notes on named capture groups</em> in the <a href="https://pypi.org/project/regex/" rel="nofollow noreferrer"><code>regex</code> package's official documentation</a>.</p>
</div>
<span class="comment-copy">Try <code>&gt;&gt;&gt; re.findall(r'abc|123', x)</code> <code>['abc', '123', 'abc']</code>.</span>
<span class="comment-copy">This would work, but in the case I want to use it, I cannot do without the pre-/suffix, which also contains several capturing groups.</span>
<span class="comment-copy"><code>re.findall</code> returns a <code>list</code>. You cannot use <code>groups()</code> on <code>re.findall</code>. Are you talking about <code>re.search</code> ? Note, <code>re.match</code> will match from <code>start</code></span>
<span class="comment-copy">Use PyPi regex model and grab <code>.captures(1)</code> with <code>r'!(abc|123)+!'</code></span>
<span class="comment-copy">No way, <code>regex.match(r'!(abc|123)+!', '!abc123abc!').captures(1)</code> <a href="https://rextester.com/RFXH47168" rel="nofollow noreferrer">yields expected output</a>, <code>['abc', '123', 'abc']</code></span>
<div class="post-text" itemprop="text">
<p>Can someone help me with executing python function from azure data factory.
I have stored python function in blob and i'm trying to trigger the same.
However i'm not able to do it. Please assist.</p>
<p>Second, Can i parameterize python function call from ADF?</p>
</div>
<div class="post-text" itemprop="text">
<p>You could get an idea of <a href="https://docs.microsoft.com/en-us/azure/data-factory/control-flow-azure-function-activity" rel="nofollow noreferrer">Azure Function Activity</a> in ADF which allows you to run Azure Functions in a Data Factory pipeline.</p>
<p>And you could duplicate your python function into <a href="https://docs.microsoft.com/en-us/azure/azure-functions/functions-create-first-function-python" rel="nofollow noreferrer">Python Azure Function</a>.</p>
<p>Also,it want to pass parameters into python function,you could set them into body properties.</p>
<p><a href="https://i.stack.imgur.com/QasUP.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/QasUP.png"/></a></p>
<p>The Azure Function Activity supports routing. For example, if your app uses the following routing - <code>https://functionAPP.azurewebsites.net/api/functionName/{value}?code=&lt;secret&gt;</code> - then the functionName is <code>functionName/{value}</code>, which you can parameterize to provide the desired <code>functionName</code> at runtime.</p>
</div>
<span class="comment-copy">Thanks for the reply @JayGong. I'm not working on web api, my requirement is to pass parameter from adf and call the python function stored in blob. Is this possible ? or is there any alternative?</span>
<div class="post-text" itemprop="text">
<p>I have a file which has bunch of numbers(35463) in it. I want to find the sum of all the numbers, but all the numbers are defined as strings.
I know that strings can be turned into an number by float() but as it has 35463 strings, it will be so much work to turn all the strings to numbers, each by each.
I wrote this so far:</p>
<pre><code>def main():
    with open ("file", "r") as myfile:
        data = myfile.read().splitlines()

main()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If your file just has a number on each line, e.g. </p>
<pre><code>0.7506097252963208
0.9176088653062778
0.6762574457637649
0.9782545470065891
...
</code></pre>
<p>You can loop through the lines of the file by looping over the open file object.  Here I use <code>map</code> to apply <code>float</code> to every line of the file</p>
<pre><code>with open('filename') as f:
    result = sum(map(float, f))
</code></pre>
<p>I tried with 350000 entries and it took about 145 milliseconds (on a not very good computer).</p>
</div>
<div class="post-text" itemprop="text">
<p>Let's say you have create a file of numbers like this:</p>
<pre class="lang-sh prettyprint-override"><code>echo "1234\n2545353\n123245\n3254657687\n8976857463\n" &gt;&gt; numbers.txt
</code></pre>
<p>looks like this:</p>
<pre class="lang-sh prettyprint-override"><code>cat numbers.txt                                                                             
1234
2545353
123245
3254657687
8976857463
</code></pre>
<p>one possible solution:</p>
<pre class="lang-py prettyprint-override"><code># read the lines and trim them
lines = list(map(str.strip, open('numbers.txt').readlines()))
# ['1234', '2545353', '123245', '3254657687', '8976857463', '']

# remove line ending, empty lines
lines = list(filter(lambda item: len(item), nums))
# ['1234', '2545353', '123245', '3254657687', '8976857463']

# convert to numbers
nums = list(map(float, lines))
# [1234.0, 2545353.0, 123245.0, 3254657687.0, 8976857463.0]

# and now we simply sum 'em
total = sum(nums)
# 12234184982.0
</code></pre>
</div>
<span class="comment-copy">You cant add strings like numbers, you have to convert them or write your own custom string adding function</span>
<span class="comment-copy"><i>"it will be so much work to turn all the strings to numbers"</i> I assure you the computer will finish it in a flash.</span>
<span class="comment-copy">yes. Is there any way I can convert all the strings in one function and then sum all of them?</span>
<span class="comment-copy">Are your files in a DataFrame format?</span>
<span class="comment-copy">I meant, if i tried to convert all the strings to numbers by writing single codes like a = float(file[0]), b = float(file[1])... it would be a hard work to do, because there are so many strings. And I wanted to know if there was any code that could do all the work</span>
<span class="comment-copy">Oh yes that is what I was trying to say. And it worked, thank you so much.</span>
<span class="comment-copy">It works thank you so much</span>
<div class="post-text" itemprop="text">
<p>This question concerns how to de-center and "restore" the data in a lower dimension after performing PCA.</p>
<p>I'm doing a simple <a href="https://scikit-learn.org/dev/modules/generated/sklearn.decomposition.PCA.html" rel="nofollow noreferrer">principal component analysis</a> with sklearn. As I understand it, the implementation should take care of (1) centering the data when creating components and (2) de-centering the data after transformation. However, after transforming the data it is still centered. How can I project the data to a lower dimensional space while preserving the characteristics of the original data? Given that I would do dimensionality reduction on high dimensional data, I wouldn't have the appropriate mean for each principal component, how can that be derived?</p>
<p>Reducing 3 dimensions to 2 dimensions:</p>
<pre><code>import numpy as np
import matplotlib.pyplot as plt
from sklearn.decomposition import PCA

X = np.array([[-1, -1, -1], [-2, -1, -1], [-3, -2, -3], [1, 1, 1], [2, 1, 2], [3, 2, 3]]) + 3
X.shape
</code></pre>
<blockquote>
<p>(6, 3)</p>
</blockquote>
<pre><code>fig = plt.figure(figsize=(10, 8), dpi= 80, facecolor='w', edgecolor='k')
ax = fig.add_subplot(111, projection='3d')
ax.scatter(X[:,0], X[:,1],X[:,2], '*')
plt.title('original')
plt.show()
</code></pre>
<p><a href="https://i.stack.imgur.com/JNpkp.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/JNpkp.png"/></a></p>
<p>PCA with 2 components:</p>
<pre><code>pca = PCA(n_components=2)
pca.fit(X)
X_trans =pca.transform(X)
X_trans.shape
</code></pre>
<blockquote>
<p>(6, 2)</p>
</blockquote>
<pre><code>plt.plot(X_trans[:,0], X_trans[:,1], '*')
plt.show()
</code></pre>
<p><a href="https://i.stack.imgur.com/DAQp2.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/DAQp2.png"/></a></p>
<p>What I would like to do at this stage is to "restore" my data in this lower dimension, such that the value of the data points correspond to the original data. It should still only have 2 dimensions, but not be centered around the mean. </p>
<p>Performing inverse transform, as suggested below, actually brings me back to 3 dimensions</p>
<pre><code>X_approx = pca.inverse_transform(X_trans) 
X_approx.shape
</code></pre>
<blockquote>
<p>(6, 3)</p>
</blockquote>
<p>I want to remain in 2 dimensions but still have my data as resemble it's original form as closely as possible and not be centered around the mean. </p>
</div>
<div class="post-text" itemprop="text">
<p>You are just fitting the data and plotting the transformed data. To get the original data back in a lower dimension, you need to use
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html#sklearn.decomposition.PCA.inverse_transform" rel="nofollow noreferrer"><code>inverse_transform</code></a> which gives you the original data back as I show below in the plot. From the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.decomposition.PCA.html#sklearn.decomposition.PCA.inverse_transform" rel="nofollow noreferrer">docs</a>:</p>
<blockquote>
<p><strong>inverse_transform(X)</strong></p>
<p>Transform data back to its original space.</p>
</blockquote>
<pre><code>pca = PCA(n_components=2)
pca.fit(X)

X_trans =pca.transform(X)
X_original = pca.inverse_transform(X_trans)
plt.plot(X_original[:,0], X_original[:,1], 'r*')
</code></pre>
<p><a href="https://i.stack.imgur.com/q7dz2.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/q7dz2.png"/></a></p>
</div>
<span class="comment-copy">I agree with the answer, but I think your actual goal is not to "restore" data but to somehow project the means into the lower dimensional space. Is that correct?</span>
<span class="comment-copy">@kazemakase: That's what is being done here I guess. The new restored data is the same data <b>but</b> projected in a 2-dimensional space because <code>n_components=2</code> during fit.</span>
<span class="comment-copy">changed my wording to "de-centering"</span>
<span class="comment-copy">@Mountain_sheep: I see the problem now. Read my comment and my edited answer</span>
<span class="comment-copy">Thanks, but the data is still centered around the y-axis...?</span>
<span class="comment-copy">@Mountain_sheep: The original data is just a relationship between the one independent variable with one dependent variable</span>
<span class="comment-copy">@Mountain_sheep: I see the problem now. You were just fitting using <code>pca.fit(X)</code> but then you have to apply the <code>pca</code> to the original data to transform it to <code>X_trans</code> using <code>transform</code>. Once you have transformed, you can transform back to original data using <code>inverse_transform</code></span>
<span class="comment-copy">Like I describe in the new edit this method gets me back to my original dimension, I want to stay in lower dimension but de-center my data.</span>
<div class="post-text" itemprop="text">
<p>I try to compile documents using <code>subprocess</code> with the following python script. I get no compilation, just this prompt waiting:</p>
<pre><code>This is LuaTeX, Version 1.07.0 (TeX Live 2019/dev/Debian) 
restricted system commands enabled.
**
</code></pre>
<p>What's going wrong with this script?</p>
<pre><code>import subprocess

tex_file = r"processImage_equation.tex"

commande_lualatex = r"lualatex"
option1_lualatex = r"--interaction=nonstopmode"
option2_lualatex = r"--shell-escape"

subprocess.call([commande_lualatex,
                 option1_lualatex,
                 option2_lualatex,
                 tex_file], shell=True)
</code></pre>
</div>
<span class="comment-copy">Finally, I got it working using <code>Popen</code> instead of <code>call</code></span>
<div class="post-text" itemprop="text">
<p>I'm trying to graph a large csv file in Ironpython using Zedgraph, but I got memmory error since the file is too large.</p>
<p>I searched few answers suggest that I should process the data while loading, but I think the ZedGraph plotting method needs an array that contains X and Y values.</p>
<p>Here is my code for loading csv data </p>
<pre><code>def readData(self, end = -1):
    counter = 0
    sampleArray = []
    tempReader =  csv.reader(self.file, delimiter = ',')

    for row in tempReader:            
        sampleArray.append(row)
        if counter == end:   #Break the reading loop until the 'desired count' value is reached (provided by user; 'None' by default)
            break
        counter += 1        
    return sampleArray
</code></pre>
<p>Here is my code to graph the data after calling the above method </p>
<pre><code>    for i in xrange(len(sample_array)):
        self.y_values.Add(float(sample_array[i].pop()))
        self.x_values.Add(float(sample_array[i].pop()))
        self.x_array = Array[float](self.x_values)

    self.y_array = Array[float](self.y_values)        
    self.point_list = FilteredPointList(self.x_array, self.y_array)
    my_curve = self.my_pane.AddCurve("Curve", self.point_list, Color.Yellow, SymbolType.None)
</code></pre>
<p>So, My question is, is there a way to graph large csv data using ZedGraph wihout loading X and Y value? </p>
<p>Or, is there an alternative way of storing the data as an array that reduces memory usage?
Since I'm using Ironpython , I can't use libs like Numpy or Pandas.</p>
<p><strong>Update: 
I use bin file to store and read the data, and it seems much smaller than reading and storing csv file, but it still does not solve the problem..
when bin file is large, the zedgraph will still gets memory error..</strong></p>
</div>
<span class="comment-copy">You could try Dask in order to handle large csv files: <a href="http://docs.dask.org/en/latest/why.html" rel="nofollow noreferrer">docs.dask.org/en/latest/why.html</a></span>
<div class="post-text" itemprop="text">
<p><strong>a</strong> is a 2x2 matrix</p>
<p><strong>b</strong> is a 2x1 matrix</p>
<p><strong>c</strong> is a 1x2 matrix</p>
<p>But ... what kind of matrices <strong>d</strong> is?</p>
<pre><code>import numpy as np
a= np.array([[1,2],[3,4]])
b= np.array([[1],[2]])
c= np.array([[1,2]])
d= np.array([1,2])
</code></pre>
<p><a href="https://i.stack.imgur.com/09HZD.png" rel="nofollow noreferrer">Variable explorer </a></p>
</div>
<div class="post-text" itemprop="text">
<p>The variable <code>d</code> is not a matrix but a row vector. </p>
<pre><code>import numpy as np
a= np.array([[1,2],[3,4]])
b= np.array([[1],[2]])
c= np.array([[1,2]])
d= np.array([1,2])

print(a.shape, b.shape, c.shape, d.shape)
print(a.ndim, b.ndim, c.ndim, d.ndim)
</code></pre>
<p>outputs shapes:</p>
<pre><code>(2, 2) (2, 1) (1, 2) (2,)
</code></pre>
<p>and dimensions:</p>
<pre><code>2 2 2 1
</code></pre>
<p>The number of brackets indicate the number of dimensions, for example:</p>
<pre><code>e = np.array([[[1,2]]])
</code></pre>
<p>outputs <code>shape</code> <code>(1, 1, 2)</code> and <code>ndim</code> <code>3</code> (so 3 dimensional).</p>
</div>
<div class="post-text" itemprop="text">
<p>It's a 1-dimensional array with 2 elements in it.</p>
<p>Check the output in the <a href="https://codidate.com/code/sandbox?s=p3c97wdavw" rel="nofollow noreferrer">sandbox</a>.</p>
</div>
<span class="comment-copy">A 1 dimensional matrix with two elements in it, you can simply check the shape of an array with <code>d.shape</code>, which gives <code>(2,)</code>. This its telling you that it has <code>2</code> elements in its first and only axis</span>
<span class="comment-copy">Its an array or if you want to keep with the nomenclature a row vector</span>
<span class="comment-copy">Did my answer below resolve the question you had?</span>
<span class="comment-copy">In this case, what is the difference between c and d, I think c is also a row vector?   (a row vector or row matrix is a 1 × m matrix)</span>
<span class="comment-copy">The number of brackets indicate the dimensions. See my edit.</span>
<div class="post-text" itemprop="text">
<p>I have a tensor with shape (1,4,4,1) and I want to repeat the value of each it's pixel and increases the shape to (1,28,28,1). I want to repeat it in each dimension. for example, if the first pixel of it is 0 then produce a new tensor with shape (28,28,1) with value 0 and so on. how can do I this? I appreciate your help. I need sth like the below code to choose the value of wtm in index i,j and then produce a new tensor with this value and shape (1,28,28,1).
suppose wtm is :</p>
<pre><code>0 1 1 0
0 0 0 1
1 0 1 0 
1 1 0 1
</code></pre>
<p>now I need to know what is wtm (i,j) and then produce a new tensor with this value. if wtm(i,j)=1
new tensor is:</p>
<pre><code>1 1 1 ... 1
1 1 1 ... 1
.    ...  1
.    ...  1
1 1 1 ... 1

wtm=Input((28,28,1))
image = Input((28, 28, 1))
conv1 = Conv2D(64, (5, 5), activation='relu', padding='same', name='convl1e',dilation_rate=(2,2))(image)
conv2 = Conv2D(64, (5, 5), activation='relu', padding='same', name='convl2e',dilation_rate=(2,2))(conv1)
conv3 = Conv2D(64, (5, 5), activation='relu', padding='same', name='convl3e',dilation_rate=(2,2))(conv2)
BN=BatchNormalization()(conv3)
encoded =  Conv2D(1, (5, 5), activation='relu', padding='same',name='encoded_I',dilation_rate=(2,2))(BN)

#-----------------------adding w---------------------------------------   

wfill=Kr.layers.Lambda(lambda x:tf.fill([28,28],x))
wtm_Fill=wfill(wtm(i,j))
add_const = Kr.layers.Lambda(lambda x: x[0] + x[1])
encoded_merged = add_const([encoded,wtm_Fill])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Maybe <code>tf.tile</code> will suit. It simply copies specified dimension of a tensor defined number of times. </p>
<pre><code>array = np.random.random_integers(0,1, (1, 4, 4, 1))
tensor = tf.convert_to_tensor(array)
expanded_array = tf.tile(tensor, [1,7,7,1])
</code></pre>
<p>So if one dimension of input array was <code>[1,1,0,0]</code>, then after padding with <code>tf.tile</code> it will look like <code>[1,1,0,0,1,1,0,0...]</code> with length of 28</p>
<p>Edit:
TensorFlow supports tensor indexing the same way numpy does. So you can just slice tensor  </p>
<pre><code>slice = tensor[0,:,:]
</code></pre>
<p>to get the shape <code>[4,4,1]</code> 
If you need to select only one particular value, you can then use <code>tf.fill</code> instead of <code>tile</code></p>
<p>To get specific value from array you need to provide n indexes where n is number of dimensions. To get first element in array with 3 dimensions, like (28,28,1), you need <code>array[0][0][0]</code>.</p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/tile" rel="nofollow noreferrer">https://www.tensorflow.org/api_docs/python/tf/tile</a></p>
</div>
<span class="comment-copy">Could you provide more concrete example of desired output?  I have one solution in mind but not sure about what you need</span>
<span class="comment-copy">I put the code here and I need sth like this in the code to select the specific index of wtm and then produce a new tensor with shape (1,28,28,1) with this value. but I do not know how can I do this with tensors:((</span>
<span class="comment-copy">this tile the input but I need sth like the mentioned example. could you please consider the example I put here.</span>
<span class="comment-copy">sorry, I am a beginner. for example, if I need wtm (0,0) I can use wtm[0,0,0]?</span>
<span class="comment-copy">for example, when I use this wfill=Kr.layers.Lambda(lambda x:tf.fill([28,28],x)) wtm_Fill=wfill(wtm[:,0,0,:]). it produces this error Shape must be rank 0 but is rank 2 for 'lambda_16/Fill' (op: 'Fill') with input shapes: [2], [?,1].</span>
<span class="comment-copy">Updated answer, also please take a look <a href="https://docs.scipy.org/doc/numpy-1.13.0/reference/arrays.indexing.html" rel="nofollow noreferrer">docs.scipy.org/doc/numpy-1.13.0/reference/arrays.indexing.html</a> It's the same in TensorFlow</span>
<span class="comment-copy">I could not understand:( I used this wtm[0,0,:] but it produces the same error. how do you write if you want to do the code I put here?</span>
<div class="post-text" itemprop="text">
<p>I have a flask app on pythonanywhere where I am displaying the contents of a .db file on an html coded page. What is happening is that the column that i have the href on puts it on every row instead of just one row in that column. In short I want each column to take me to a different link. My question is probably not very clear so I will provide a link to the site below as well as the code.
<a href="http://ethankbdca.pythonanywhere.com/forums" rel="nofollow noreferrer">flask_app</a></p>
<p>This is the flask route:</p>
<pre><code>@app.route('/forums')
def forums():
    conn = sqlite3.connect("/home/Ethankbdca/mysite/forum.db")
    c = conn.cursor()
    sql = "SELECT Forums, Description, blank FROM Home Order By Forums"
    c.execute(sql)
    allforums = []
    for row in c.fetchall():
        tup = (row[0],row[1],row[2])
        allforums.append(tup)
conn.close()
return render_template('forumhome.html', allforums=allforums)
</code></pre>
<p>This is the html code:</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;link rel="stylesheet" 
href="https://www.w3schools.com/w3css/4/w3.css"/&gt;
&lt;script src="script.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h1 align="center"&gt;Share Your Code&lt;/h1&gt;
&lt;table width="90%"&gt;
   {% for x in allforums:  %}
   &lt;tr&gt;
        &lt;td width=5%&gt;&lt;a href='/python_forum' &gt;{{ x[0] }}&lt;/a&gt;&lt;/td&gt;
        &lt;td width=50%&gt; {{ x[1] }} &lt;/td&gt;
   &lt;/tr&gt;
   {% endfor %}
&lt;/table&gt;&lt;br/&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I am not sure if I understand the question. Use the id of the database entry to retrieve the entry in another route.</p>
<pre><code>@app.route('/forum/')
def forum_index():
    conn = sqlite3.connect("/home/Ethankbdca/mysite/forum.db")
    c = conn.cursor()
    sql = "SELECT id, forums, description, blank FROM home ORDER BY forums"
    c.execute(sql)
    records = [(row[0],row[1],row[2]) for row in c.fetchall()]
    conn.close()
    return render_template('forum_index.html', items=records)

@app.route('/forum/&lt;int:item_id&gt;')
def forum_show(item_id):
    conn = sqlite3.connect("/home/Ethankbdca/mysite/forum.db")
    c = conn.cursor()
    c.execute("SELECT * FROM home WHERE id == " + str(item_id))
    record = tuple(c.fetchone())
    conn.close()
    return render_template('forum_show.html', item=record)
</code></pre>
<p>layout.html</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;meta charset="UTF-8" /&gt;
    &lt;link rel="stylesheet" href="{{ url_for('static', 'main.css') }}" /&gt;
  &lt;/head&gt;
  &lt;body&gt;
  {% block content %}{% endblock %}
  &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>forum_index.html</p>
<pre><code>{% extends 'layout.html' %}
{% block content %}
&lt;h1 align="center"&gt;Share Your Code&lt;/h1&gt;
&lt;table width="90%"&gt;
    {% for item in items:  %}
    &lt;tr&gt;
        &lt;td width=5%&gt;&lt;a href="{{ url_for('forum_show', item_id=item[0]) }}" &gt;{{ item[1] }}&lt;/a&gt;&lt;/td&gt;
        &lt;td width=50%&gt;{{ item[2] }}&lt;/td&gt;
    &lt;/tr&gt;
    {% endfor %}
&lt;/table&gt;
{% endblock %}
</code></pre>
<p>forum_show.html</p>
<pre><code>{% extends 'layout.html' %}
{% block content %}
    &lt;h1 align="center"&gt;Is This Your Code?&lt;/h1&gt;
    &lt;div&gt;
        &lt;h4&gt;{{ item[1] }}&lt;/h4&gt;
        &lt;code&gt;&lt;pre&gt;{{ item[2] }}&lt;/pre&gt;&lt;/code&gt;
    &lt;/div&gt;
{% endblock %}
</code></pre>
<p>Familiarize yourself with the CRUD concept, it will help you with the order within your application.</p>
<p>It would help you if you use an ORM like <a href="http://flask-sqlalchemy.pocoo.org/2.3/" rel="nofollow noreferrer">"flask_sqlalchemy"</a>, otherwise look <a href="http://flask.pocoo.org/docs/1.0/patterns/sqlite3/" rel="nofollow noreferrer">here</a>.</p>
<p><a href="http://flask.pocoo.org/docs/1.0/blueprints/" rel="nofollow noreferrer">"flask-blueprint"</a> structures your application into different individual modules. Very helpful.</p>
<p>You found your mistake <a href="https://stackoverflow.com/questions/55360672/i-am-making-a-flask-app-using-pythonanywhere-and-i-am-getting-an-error-when-subm/55363930">here</a>?
Have fun!</p>
</div>
<span class="comment-copy"><b>TYPO</b> alert: it's a <b>column</b> - not a "collum" ....</span>
<span class="comment-copy">Oh sorry. I just saw your code. I guess a facebook account works if you are still open to that.</span>
<div class="post-text" itemprop="text">
<p>The following code that I pulled from <a href="https://towardsdatascience.com/how-to-build-your-own-neural-network-from-scratch-in-python-68998a08e4f6" rel="nofollow noreferrer">here</a> in an effort to better understand how Machine Learning and Neural Networks work, isn't working. It keeps producing an "invalid syntax" error at line 31:</p>
<pre><code>self.weights1 += d_weights1
</code></pre>
<p>Here is the function that fails:         </p>
<pre><code>    def backprop(self):
        # application of the chain rule to find derivative of the loss function with respect to weights2 and weights1
        d_weights2 = np.dot(self.layer1.T, (2*(self.y - self.output) * sigmoid_derivative(self.output)))
        d_weights1 = np.dot(self.input.T, (np.dot(2*(self.y - self.output) * sigmoid_derivative(self.output), self.weights2.T) * sigmoid_derivative(self.layer1))

        # update the weights with the derivative (slope) of the loss function        
        self.weights1 += d_weights1
        self.weights2 += d_weights2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You have forgotten to put a brackets at the end of line 4</p>
<pre><code>d_weights1 = np.dot(self.input.T, (np.dot(2*(self.y - self.output) * sigmoid_derivative(self.output), self.weights2.T) * sigmoid_derivative(self.layer1))
</code></pre>
<p>Here is the correction:</p>
<pre><code>d_weights1 = np.dot(self.input.T, (np.dot(2*(self.y - self.output) * sigmoid_derivative(self.output), self.weights2.T) * sigmoid_derivative(self.layer1)))
</code></pre>
</div>
<span class="comment-copy">It would be very helpful if you could add the complete error, or at least highlight which line is line 31.</span>
<span class="comment-copy">Other than that, you are missing a closing bracket in the line before. You did not copy it correctly, because it is there in the link you provided</span>
<span class="comment-copy">Please provide a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a> in the future.Generating one in this case would have easily shown you the problem with your code. And please add only relvant tags and a meaningfull title. The problem is clearly a syntactic one and is not in any way related to machine-learning or neural networks.</span>
<span class="comment-copy">When you get an "Invalid Syntax" error, it means that the problem comes from how you wrote the code, independently from the data behind it. Usually it means an extra or missing bracket, a missing comma, etc.</span>
<span class="comment-copy">If I or you would have created a minimal example this questions would not exist in the first place.</span>
<div class="post-text" itemprop="text">
<p>Data.columns:</p>
<pre><code>MultiIndex(levels=[['PDARS1M', 'PDARS1Y', 'PDKRW1M'], ['EB', 'EO', 'ER']],
       labels=[[2, 0, 1, 2, 0, 1, 2, 0, 1], [0, 0, 0, 2, 2, 2, 1, 1, 1]],
       names=['Instrument', 'Field'])
</code></pre>
<p>Data:</p>
<pre><code>PDKRW1M PDARS1M PDARS1Y PDKRW1M PDARS1M PDARS1Y PDKRW1M PDARS1M PDARS1Y
EB  EB  EB  ER  ER  ER  EO  EO  EO
1125    40  53  1126    40  53  1127    40  54
1125    41  54  1126    41  54  1127    41  55
1126    41  54  1127    41  54  1128    41  55
</code></pre>
<p>I want to merge <strong>Data.columns.levels[0]</strong> and <strong>Data.columns.levels[1]</strong> and update as Data.columns</p>
<p>I used below script but got errors </p>
<pre><code>Data.columns = Data.columns.levels[0] + '|' + Data.columns.levels[1]

"ValueError: Length mismatch: Expected axis has 9 elements, new values have 3 elements"
</code></pre>
<p>Expected Data Column Name:</p>
<pre><code>PDKRW1M|EB, PDARS1M|EB, PDARS1Y|EB, PDKRW1M|ER, PDARS1M|ER, PDARS1Y|ER, PDKRW1M|EO, PDARS1M|EO, PDARS1Y|EO
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use <code>map</code> with <code>join</code>:</p>
<pre><code>Data.columns = Data.columns.map('|'.join)
</code></pre>
<p>Or list comprehension:</p>
<pre><code>Data.columns = [f'{a}{b}' for a, b in Data.columns]
</code></pre>
</div>
<span class="comment-copy">First one, Nice one, thanks a lot.</span>
<div class="post-text" itemprop="text">
<p>I have a simple webserver based on BaseHTTPRequestHandler, and it's displaying a simple file (todopage.php). But it only displays HTML code. Any PHP code in the file gets commented out in the browser. Here the python code: </p>
<pre><code>class SimpleHTTPRequestHandler(BaseHTTPRequestHandler):

def do_GET(self):
    try:
        if self.path.endswith("/todolist"):
            if os.name == 'nt':
                f = open('todopage.php', 'rb')
            else:
                f = open('/home/pi/TaskList/todopage.php', 'rb')
            self.send_response(200)
            self.send_header('Content-Type', 'text/html')
            self.end_headers()
            self.wfile.write(f.read())
            f.close()
            #print(output)
            return

    except IOError:
        self.send_error(404, "File not found %s" % self.path)

def do_POST(self):
    try:
        self.send_response(301)
        self.send_header('Content-Type', 'text/html')
        self.end_headers()
        ctype, pdict = cgi.parse_header(self.headers.get('Content-Type'))
        pdict['boundary'] = bytes(pdict['boundary'], "utf-8")
        if ctype == 'multipart/form-data':
            fields = cgi.parse_multipart(self.rfile, pdict)
            messagecontent = fields.get('message')
        print(messagecontent[0].decode("utf-8"))
        insert_task(messagecontent[0].decode("utf-8"))
        if os.name == 'nt':
            f = open('todopage.php', 'rb')
        else:
            f = open('/home/pi/TaskList/todopage.php', 'rb')
        self.wfile.write(f.read())
        f.close()
    except:
        self.send_error(404, "{}".format(sys.exc_info()[0]))
        print(sys.exc_info())
</code></pre>
<p>And yes. I have been looking through a lot of questions and couldn't find the answer.</p>
</div>
<span class="comment-copy">Pretty sure that is not going to work like you think. Why don't you just use Python to do what you want the PHP to do?</span>
<span class="comment-copy">It's possible like that, but then all the html code has to be in python. I just want a seperate file where I can edit and "change" the page that is displayed</span>
<span class="comment-copy">i think you have to pick one or the other. i don't think you can (or need to) use both together</span>
<span class="comment-copy">@E.J.Kok You could use the Python to serve whatever data your trying to compute with the PHP file and then use JavaScript to take that data and work it into your HTML.</span>
<span class="comment-copy">Is there any other way to simply display the POST data with this current solution? That's basically what I'm trying to achieve with the php file</span>
<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/240178/list-of-lists-changes-reflected-across-sublists-unexpectedly">List of lists changes reflected across sublists unexpectedly</a>
<span class="question-originals-answer-count">
                    12 answers
                </span>
</li>
</ul>
</div>
<p>When creating a new nested list the following way:</p>
<pre><code>test_list = [[""]]*5
</code></pre>
<p>unexpected behavior happens, appending to an index the following modifications happens:</p>
<pre><code>test_list[1].append(2)
[['', 2], ['', 2], ['', 2], ['', 2], ['', 2]]
</code></pre>
<p>when doing the following it works as I would expect:</p>
<pre><code>test_list[1] = test_list[1] + [0]
[[''], ['', 0], [''], [''], ['']]
</code></pre>
<p>but when using the += operator the same odd thing happens</p>
<pre><code>test_list[1] += [0]
[['', 0], ['', 0], ['', 0], ['', 0], ['', 0]]
</code></pre>
<p>when the list is defined as following: <code>[[""] for i in range(len(5))]</code> all the examples return the expected output. </p>
<p>What is going on? Is it some reference thing I am not understanding?</p>
</div>
<div class="post-text" itemprop="text">
<p>You are creating a list that has five elements which point to the same list.</p>
<p>When you call <code>test_list[1].append(2)</code>, it appends number 2 to the list, which appends it to all lists.</p>
<p>When you call <code>test_list[1] = test_list[1] + [0]</code>, a new instance of a list is created, and is assigned to <code>test_list[1]</code>. Now in index 1 you have a different list than all other 4.</p>
<p>Here, <code>test_list[1] += [0]</code>, <code>+=</code> is translated to <code>test_list[1].append(0)</code>, which appends zero to all of the lists.</p>
<p>An example to understand <code>test_list[1] = test_list[1] + [0]</code>:</p>
<pre><code>lst = [0]
print(lst) 
# output: [0]

lst += [1]
print(lst) 
# output: [0, 1]

lst.append(2)
print(lst) 
# output: [0, 1, 2]

lst2 = lst + [3]
print(lst) 
# output: [0, 1, 2]
# the lst did not change!

print(lst2) 
# output: [0, 1, 2, 3]
# a new instance of a list which is not lst
</code></pre>
<p>Now, let's see the object ids of the elements: </p>
<pre><code>test_list = [[""]]*5
print(test_list)
# output: [[''], [''], [''], [''], ['']]

for i in range(5):
    object_id = id(test_list[i])
    print(object_id)
# output: 4405988168
# output: 4405988168
# output: 4405988168
# output: 4405988168
# output: 4405988168

test_list[1] = test_list[1] + [0]
print(test_list)
# output: [[''], ['', 0], [''], [''], ['']]

for i in range(5):
    object_id = id(test_list[i])
    print(object_id)
# output: 4405988168
# output: 4417503368     !!!!
# output: 4405988168
# output: 4405988168
# output: 4405988168
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>By using <code>test_list = [[""]] * 5</code> you are creating 5 references to the same list. This means there is <strong>ONLY ONE ROW</strong> in the memory. </p>
<p>When you modify a row, if affects the row in memory, and since all other "rows" refer to it, they will simply use the list in memory which is up-to-date.</p>
<p><strong>This however creats a list of 5 lists in memory:</strong></p>
<pre><code>test_list = [[""] for i in range(len(5))]
</code></pre>
<p>===========================================================================</p>
<p>You could find an <a href="https://github.com/satwikkansal/wtfpython#-a-tic-tac-toe-where-x-wins-in-the-first-attempt" rel="nofollow noreferrer">example and explanation in wtfpython</a>:</p>
<pre><code># Let's initialize a row
row = [""]*3 #row i['', '', '']
# Let's make a board
board = [row]*3
</code></pre>
<p>Output:</p>
<pre><code>&gt;&gt;&gt; board
[['', '', ''], ['', '', ''], ['', '', '']]
&gt;&gt;&gt; board[0]
['', '', '']
&gt;&gt;&gt; board[0][0]
''
&gt;&gt;&gt; board[0][0] = "X"
&gt;&gt;&gt; board
[['X', '', ''], ['X', '', ''], ['X', '', '']]
</code></pre>
<p><strong>Explanation:</strong></p>
<p>When we initialize <code>row</code> variable, this visualization explains what happens in the memory.</p>
<p><a href="https://i.stack.imgur.com/p0mv1.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/p0mv1.png"/></a></p>
<p>And when the <code>board</code> is initialized by multiplying the <code>row</code>, this is what happens inside the memory (each of the elements <code>board[0]</code>, <code>board[1]</code> and <code>board[2]</code> is a reference to the same list referred by <code>row</code>)</p>
<p><a href="https://i.stack.imgur.com/DNs8D.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/DNs8D.png"/></a></p>
<p>We can avoid this scenario here by not using <code>row</code> variable to generate <code>board</code>. (Asked in <a href="https://github.com/satwikkansal/wtfpython/issues/68" rel="nofollow noreferrer">this</a> issue).</p>
<pre><code>&gt;&gt;&gt; board = [['']*3 for _ in range(3)]
&gt;&gt;&gt; board[0][0] = "X"
&gt;&gt;&gt; board
[['X', '', ''], ['', '', ''], ['', '', '']]
</code></pre>
</div>
<span class="comment-copy">That's what I don't like most in languages like Java, Python, etc - They're using references implicitly. Of course, once you know that, you can handle it. But C++ makes it obvious - which I first didn't like, but now really appreciate.</span>
<span class="comment-copy">Be careful of this <i>gotcha</i> too: <a href="https://stackoverflow.com/questions/1132941/least-astonishment-and-the-mutable-default-argument">“Least Astonishment” and the Mutable Default Argument</a></span>
<div class="post-text" itemprop="text">
<p>I'm a newbie and I've been stuck on this for days. I want to use extract in Python to normal sentences without URLs.<br/>
For instance:  </p>
<pre><code>1st text: '(some normal sentences...) https://www.(...)'  
2nd text: '(some normal sentences...) '
</code></pre>
<p>When I use <code>r'([\w+\.\s\W\@w]+)(?:https)'</code>  it will catch sentences in 1st text only.  </p>
<p>When I use <code>r'([\w+\.\s\W\@w]+)(?:https)?'</code> it will catch sentences in 2nd text and all text of 1st text.  </p>
<p>Can someone please help with my Regex?</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <code>non greedy</code> regex like,</p>
<pre><code>&gt;&gt;&gt; import re
&gt;&gt;&gt; x
"1st text: '(some normal sentences...) https://www.(...)\n2nd text: '(some normal sentences...)"
&gt;&gt;&gt; print(x)
1st text: '(some normal sentences...) https://www.(...)
2nd text: '(some normal sentences...)
&gt;&gt;&gt; re.findall(r'\(\w.+?\)', x)
['(some normal sentences...)', '(some normal sentences...)']
&gt;&gt;&gt; re.findall(r'\((\w.+?)\)', x)
['some normal sentences...', 'some normal sentences...']
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I have some code that creates a generator with <code>read_sql()</code> and loops through the generator to print each chunk:</p>
<p><strong>execute.py</strong></p>
<pre><code>import pandas as pd
from sqlalchemy import event, create_engine

engine = create_engine('path-to-driver')

def getDistance(chunk):
    print(chunk)
    print(type(chunk))

df_chunks = pd.read_sql("select top 2 * from SCHEMA.table_name", engine, chunksize=1)

for chunk in df_chunks:
    result = getDistance(chunk)
</code></pre>
<p>It works, and each chunk is printed as as DataFrame. When I attempt to do the same thing with multiprocessing like this...</p>
<p><strong>outside_function.py</strong></p>
<pre><code>def getDistance(chunk):
    print(chunk)
    print(type(chunk))
    df = chunk
    return df
</code></pre>
<p><strong>execute.py</strong></p>
<pre><code>import pandas as pd
from sqlalchemy import event, create_engine

engine = create_engine('path-to-driver')

df_chunks = pd.read_sql("select top 2 * from SCHEMA.table_name", engine, chunksize=1)

if __name__ == '__main__':
    global result
    p = Pool(20)
    for chunk in df_chunks:
        print(chunk)
        result = p.map(getDistance, chunk)
    p.terminate()
    p.join()
</code></pre>
<p>...the chunks print as column names in the console with the type 'str'. Printing out <code>result</code> reveals this <code>['column_name']</code>. </p>
<p>Why are the chunks turning into strings that are just the column names when multiprocessing is applied?</p>
</div>
<div class="post-text" itemprop="text">
<p>This is because <code>p.map</code> expects a function and an iterable. Iterating over a dataframe (in this case your <code>chunk</code>) will yield the column names. </p>
<p>You need to pass in a collection of dataframes to the map method. I.e.:</p>
<pre><code>    global result
    p = Pool(20)
    result = p.map(getDistance, df_chunks)
    p.terminate()
    p.join()
</code></pre>
</div>
<span class="comment-copy">You are not properly looping over the data_frame. The chunk will be a string regardless of using multiprocessing or not. If you want to loop over the values or rows you should use <code>df.itertuples()</code> or <code>df.iterrows()</code>. What exactly are you trying to do?</span>
<span class="comment-copy">I guess I'm saying you should not be surprised here. If all you did was <code>for a in df:</code> that is a string. So no matter what you do with it after that, <code>a</code> is a string. Doesn't matter if you're using multiprocessing or not.</span>
<span class="comment-copy">In my experience with multiprocessing, you want to avoid terminating processes how you are doing. Check <a href="https://stackoverflow.com/questions/32053618/how-to-to-terminate-process-using-pythons-multiprocessing">this answer</a> for a pretty in-depth explanation on "gracefully" exiting processes.</span>
<div class="post-text" itemprop="text">
<p>I have data like this given to me in an excel file, and I imported it into my program using pandas: 
<a href="https://i.stack.imgur.com/jqr3x.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/jqr3x.png"/></a>
I need to iterate over every single data of every row in the column 'IPC' and count them by their first 4 characters(Ex. A61K038/51 =&gt; A61K). But most rows contain more than a single data and they are separated by semicolon.</p>
<p>My thought is to first iterate on the rows, and then iterate again on the row's data. I know how to do these things in other data type, but I'm new to pandas and pandas dataframe make things so much more complicated! Please help! Any guidance on the best way to do this would be much appreciated.</p>
<p>Edit: The first 20 rows</p>
<pre><code>                  Company Name                        ...                                                                        IPC
0   Phoenix Pharmacologics Inc                        ...                          A61K038/51;A61K038/21;A61K031/7076;A61K031/707...
1   Phoenix Pharmacologics Inc                        ...                                                      A61K038/46;C12N009/80
2   Phoenix Pharmacologics Inc                        ...                                                                 A61K038/43
3   Phoenix Pharmacologics Inc                        ...                                           A61K038/50;A61K045/06;A61K047/48
4   Phoenix Pharmacologics Inc                        ...                                                      A61K038/44;C12N009/06
5   Phoenix Pharmacologics Inc                        ...                                          C07K014/525;C12N009/78;C12N015/81
6   Phoenix Pharmacologics Inc                        ...                                                      A61K038/00;C12N009/06
7   Phoenix Pharmacologics Inc                        ...                                                                 C12Q001/68
8   Phoenix Pharmacologics Inc                        ...                                                      A61K038/50;C12N009/78
9   Phoenix Pharmacologics Inc                        ...                                C12N011/06;C12N009/96;C12N009/06;A61K038/44
10  Phoenix Pharmacologics Inc                        ...                                                                 C12N009/14
11  Phoenix Pharmacologics Inc                        ...                                C12N011/06;C12N009/06;C12N009/96;C12N011/08
12  Phoenix Pharmacologics Inc                        ...                                A61K038/00;A61K047/48;C12N009/78;C12N009/96
13  Phoenix Pharmacologics Inc                        ...                                                     A61K038/00;C07K014/525
14           Phytoceutica, Inc                        ...                          A61K036/539;A61P035/00;A61K036/484;A61K036/725...
15           Phytoceutica, Inc                        ...                                                                 A01N065/00
16           Phytoceutica, Inc                        ...                                                                 A61K036/00
17           Phytoceutica, Inc                        ...                                                      G01N033/48;G06F017/00
18           Phytoceutica, Inc                        ...                                C12Q001/68;C12Q001/68;G06F019/00;G06F019/00
19           Phytoceutica, Inc                        ...                                                                 G06F019/00
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you would like to count elements based on the first 4 characters, you could define a function to do that and then apply it to the dataframe like this:</p>
<pre><code>import numpy as np

df = pd.DataFrame({'IPC': ['A61K038/52;A61K038/21', 'A61K038/46;C12N009/80']})

def count_ipc(ipc):
    items = ipc.split(';')
    items = [val[:4] for val in items]  # extract first 4 elements
    values = np.unique(items)  # count unique elements with numpy
    return len(items)

df['cnt'] = df.apply(lambda row: count_ipc(row['IPC']), axis=1)
</code></pre>
<p>The result is:</p>
<pre><code>                 IPC  cnt
0  A61K038/52;A61K038/21    1
1  A61K038/46;C12N009/80    2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use pandas <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html" rel="nofollow noreferrer"><code>pandas.Series.str.split</code></a> and chain <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.len.html" rel="nofollow noreferrer"><code>pandas.Series.str.len</code></a> to it to get your result:</p>
<p><strong>Example data</strong></p>
<pre><code># Example dataframe
df = pd.DataFrame({'IPC':['A61K038/51;A61K038/21;A61k031', 'A80934;A758392']})
print(df)
                             IPC
0  A61K038/51;A61K038/21;A61k031
1                 A80934;A758392
</code></pre>
<p><strong>Apply split and len</strong></p>
<pre><code>df['count'] = df.IPC.str.split(';').str.len()
print(df)
                             IPC  count
0  A61K038/51;A61K038/21;A61k031      3
1                 A80934;A758392      2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>One with lambda</p>
<pre><code>df = pd.DataFrame({'IPC': ['A61K038/52;A61K038/21;A61K038', 'A61K038/46;C12N009/80']})

def counter(ipc):
    temp = ipc.split(';')
    first_4 = temp[0][:4]
    return sum(1 for i in temp if i.startswith(first_4) )

df['cnt']= df['IPC'].apply(counter)
</code></pre>
<p>Output</p>
<pre><code>                             IPC  cnt
0  A61K038/52;A61K038/21;A61K038    3
1          A61K038/46;C12N009/80    1
</code></pre>
</div>
<span class="comment-copy">Hi, thanks for your imminent reply! I'm sorry, I forgot to state that I need to count them by their first 4 characters. For example, A61K038/51;A61K038/21;A61K031/7076; all become A61K and I have to count the number of A61K.</span>
<span class="comment-copy">It doesn't work for me :(</span>
<span class="comment-copy">The code can run in my program but it does not count the IPC correctly.</span>
<span class="comment-copy">Hi, thanks for your reply! I'm sorry, I forgot to state that I need to count them by their first 4 characters. For example, A61K038/51;A61K038/21;C01K031/7076; become A61K and C01K and I have to count the number of A61K and C01K respectively.</span>
<span class="comment-copy">Per row? Or through the whole column?</span>
<span class="comment-copy">I need to count how many type of IPC is in the whole column (Ex. type = A61K, C01K, etc...), and count how many IPC per type a company has (Ex. Company A has 4 A61K, 2C01K).</span>
<span class="comment-copy">Could you add the top 20 rows in your question? Use: <code>print(df.head(20))</code>. You can copy and paste the output into your question by editting it.</span>
<span class="comment-copy">I added the top 20 rows.</span>
<span class="comment-copy">Hi, thanks for your reply! From what I saw, your code only count the A61K?</span>
<span class="comment-copy">@Alex I have already edited</span>
<div class="post-text" itemprop="text">
<p>I have an issue that I can't seem to resolve.</p>
<p>I am building in a numpy array of shape (100, 30) from lines of a file (100 lines of 30 values each), and I need to make this array into a shape (100, ) with as values the mean of the <em>n</em> last values from each line of the original array.</p>
<p>I have as a goal to do this in one line, so I tried nested list comprehensions but I feel totally lost in there and I'm not sure of what I am doing. </p>
<p>This is what I got so far, this gives me a correctly shape array but with (I believe) the wrong values.</p>
<pre><code>def perf_n_last(n):
    a = np.array([np.mean([i for j in range(len(i)-1, len(i)-(n+1), -1)]) for i in np.loadtxt('myfile.txt')])
    print(a.shape) #outputs (100, )
</code></pre>
<p>The input and output should look like:</p>
<pre><code>input_f = [[1. 2. 3. 4. 5.]
           [2. 3. 4. 5. 6.]
           [3. 4. 5. 6. 7.]]
#We assume n = 2
output_f = [4.5 5.5 6.5]
</code></pre>
<p>I am also open to suggestions about list slices. Thank you for the help!</p>
</div>
<div class="post-text" itemprop="text">
<p>If I'm understanding your question correctly, this can actually be done very quickly with numpy, assuming each row in the 2d array is the same length:</p>
<pre><code>def perf_n_last(n):
    return np.loadtxt("myfile.txt")[:,-n:].mean(1)
</code></pre>
<p>which loads the file, slices to include all rows but only the <code>n</code> last columns, and takes the mean of each resulting row.</p>
</div>
<span class="comment-copy">Could you share a smaller sized data sample and an expected output so it can be reproduced?</span>
<span class="comment-copy">Why would you demand this to only use up one line? What you have is much less easily legible than it would be if you were to unwrap it.</span>
<span class="comment-copy">Why not just make the (100,30) array from the file then take its mean ?</span>
<span class="comment-copy">@acdr you are totally right, it was a challenge from a classmate and not a good idea.</span>
<span class="comment-copy">Thank you very much, I got carried away by list comprehensions and didn't see this solution</span>
<span class="comment-copy">Can't you just write <code>np.mean(np.loadtxt("myfile.txt")[:,-n:])</code>?</span>
<span class="comment-copy">@Bazingaa, that will take the overall mean of the array rather than the mean of each row.</span>
<span class="comment-copy">@mackenziedg: You can pass <code>axis=1</code> I think for the row wise mean</span>
<div class="post-text" itemprop="text">
<p>Under normal circumstance, external python modules such as scipy and numpy are compiled into shared objects when being installed (The part written in C). When python calls import scipy, it will dynamically load these shared objects.
Now I am working on a platform which does not support any dynamic loading function. As a result, I have to link those modules statically with python.
My current approach is to compile all source code of scipy/numpy with python, and call the module initialization function when python initializes. </p>
<pre><code>Py_initializeEx(){
    ...
    //init scipy modules statically
    //below are scipy modules init functions
    init_comb();
    init_cython_special();
    ...
} 
</code></pre>
<p>However, this brings me another problem. I found in many python module initialization functions, especially when they are auto generated from cython, they contain codes to import its parent packages. For example, the cython_special() calls import scipy, but when it is being called, the scipy initialization is not completed yet.</p>
<p>My question is, is there an easy way I can linked these modules statically? What is your suggestions to solve this problem?
Thanks.</p>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/c-api/import.html#c.PyImport_AppendInittab" rel="nofollow noreferrer"><code>PyImport_AppendInittab</code></a> - this tells Python in advance of a module initialization function associated with a specific name. You'd identify all the modules you need to use that are compiled, link them statically, and then before <code>Py_Initialize</code> you add them to the <code>Inittab</code>.</p>
<p>Nothing happens until the module is imported at runtime when the correct initialization function is run.</p>
</div>
<div class="post-text" itemprop="text">
<p>If I got you right, what you could do is add a path to a dir where the modules will be located at.</p>
<pre><code>import sys
sys.path.insert(0,'/path/to/modules')
from module1 import *
from module2 import * 
</code></pre>
<p>etc.</p>
</div>
<span class="comment-copy">Hi RanAB. Thanks for your reply. But I am afraid this approach can not solve my problem. I think this solution only specifies the path of the module. When python calls from module 1 import *, it will still try to find .so or .dll files under the given path to dynamically load it.</span>
<div class="post-text" itemprop="text">
<p>I have a problem sending a request for resetting my password in flask.
This is the code in <strong>init</strong>.py for setting the email environment</p>
<pre><code>from flask import Flask, render_template,url_for,flash,redirect
from flask_sqlalchemy import SQLAlchemy
from flask_bcrypt import Bcrypt
from flask_login import LoginManager
from flask_mail import Mail
import os

app=Flask(__name__) #the name of the application package

app.config['SECRET_KEY']='88fe5c0981ba01f5b81bcdb8c12dad29'
app.config['SQLALCHEMY_DATABASE_URI']='sqlite:///site.db' #creates database  in the pc location
db=SQLAlchemy(app)
bcrypt=Bcrypt(app)
login_manager=LoginManager(app)
login_manager.login_view='login'
login_manager.login_message_category='info'
app.config['MAIL_SERVER']='smtp.gmail.com'


app.config['MAIL_PORT']=587
app.config['MAIL_USE_TLS']=True
app.config['MAIL_USERNAME']=os.environ.get('NotifyEmail')
app.config['MAIL_PASSWORD']=os.environ.get('EMAIL_PASS')
mail=Mail(app)

from flaskdrip import routes
</code></pre>
<p>After starting the server I get this error even though I set up the environment variables for NotifyEmail and EMAIL_PASS</p>
<pre><code>    Internal Server Error
The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.
</code></pre>
</div>
<span class="comment-copy">Could you provide complete traceback? From what you posted it's not obvious where the error could come from.</span>
<span class="comment-copy">Run Flask in debug mode to see the full error.</span>
<span class="comment-copy">@DanielRoseman I debugged but there was no traceback.  It shows only this:   FSADeprecationWarning: SQLALCHEMY_TRACK_MODIFICATIONS adds significant overhead and will be disabled by default in the future.  Set it to True or False to suppress this warning.   'SQLALCHEMY_TRACK_MODIFICATIONS adds significant overhead and '  * Debugger is active!  * Debugger PIN: 429-769-432  * Running on <a href="http://127.0.0.1:5000/" rel="nofollow noreferrer">127.0.0.1:5000</a> (Press CTRL+C to quit)</span>
<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/42196337/dataframe-set-index-not-setting">Dataframe set_index not setting</a>
<span class="question-originals-answer-count">
                    1 answer
                </span>
</li>
<li>
<a dir="ltr" href="/questions/17328655/pandas-set-index-does-not-set-the-index">Pandas set_index does not set the index</a>
<span class="question-originals-answer-count">
                    1 answer
                </span>
</li>
</ul>
</div>
<p>I have tried to choose a column to be an index of a data frame. The examples I've seen so far suggests to use the method set_index(), but it doesn't work in my case. I use python 3.7.0</p>
<pre><code>import pandas as pd

df = pd.DataFrame({'Fruit' : ['Apples','Oranges'],
                   'Amount': [ 1, 17 ]})

df.set_index('Fruit')


print(df1)
</code></pre>
<p>The output that I get is</p>
<pre><code>       Fruit  Amount
0   'Apples'       1
1  'Oranges'      17
</code></pre>
<p>The output I want would be something like</p>
<pre><code>              Amount
     Fruit  
    'Apples'       1
   'Oranges'      17
</code></pre>
</div>
<span class="comment-copy"><code>df = df.set_index('Fruit')</code></span>
<span class="comment-copy">or <code>df.set_index('Fruit', inplace=True)</code></span>
<span class="comment-copy">{inplace=True} makes the difference! Thank you!</span>
<div class="post-text" itemprop="text">
<p>I'm using <a href="https://github.com/Bouke/django-user-sessions/blob/master/user_sessions/views.py" rel="nofollow noreferrer">this library</a> to add a sessions tab on my django project. I'm calling the module's template from my project using this line:</p>
<pre><code>&lt;li&gt;&lt;a href="{% url 'user_sessions:session_list' %}"&gt;Sessions&lt;/a&gt;&lt;/li&gt;
</code></pre>
<p>It works, but now I'd like to style the page, and to do that I need to override the module's template with my own template. So, as the module says <a href="https://github.com/Bouke/django-user-sessions/blob/master/user_sessions/views.py" rel="nofollow noreferrer">here</a>, I inherited the module's <code>SessionListView</code> on my own <code>views.py</code> to overrode the template:</p>
<pre><code>from user_sessions.views import SessionListView

class MySessionList(SessionListView):
    template_name = 'user_sessions/session_list.html'
</code></pre>
<p>Then I added the url to my <code>urls.py</code></p>
<pre><code>    url(
        regex=r'^account/sessions/$',
        view=MySessionList.as_view(),
        name='sessions',
        ),
</code></pre>
<p>And then I created my template on my own project which is located like this:
<code>templates/user_sessions/session_list</code>.</p>
<p>But for some reason, I still can't see <strong>MY</strong> template appearing, the module's template keeps appearing instead. Can anyone help me finding what I'm doing wrong?</p>
</div>
<div class="post-text" itemprop="text">
<p>The <code>SessionListView</code> already uses <code>user_sessions/session_list.html</code> by default, so your custom view isn't required.</p>
<p>It sounds like Django is finding the <code>user_sessions/session_list.html</code> template in the <code>user_sessions</code> app before your template. If your template is in an app's <code>templates</code> directory, then you can fix this by moving your app above <code>user_sessions</code> in your <code>INSTALLED_APPS</code> setting.</p>
<p>Alternatively, if you move your template to a directory in the <code>'DIRS'</code> list in the <code>TEMPLATES</code> setting, then Django will find your template before it checks the app templates directories. This is cleaner if your overridden template doesn't really belong to any of your apps, and another advantage is that you don't have to re-order the <code>INSTALLED_APPS</code> list.</p>
<p>See the docs on <a href="https://docs.djangoproject.com/en/2.1/howto/overriding-templates/" rel="nofollow noreferrer">overriding templates</a> for more information.</p>
</div>
<span class="comment-copy">The code doesn't at all say to provide your own view. It says to provide your own template. Where is your <code>templates</code> directory in relation to the rest of your project? And please show your TEMPLATES setting.</span>
<span class="comment-copy">Read <a href="https://docs.djangoproject.com/en/2.1/howto/overriding-templates/" rel="nofollow noreferrer">this</a> to understand how to override templates.</span>
<span class="comment-copy">Looks like the issue was on my Settings.py file, i had to move my import some lines below. Thanks for your help! Yes, i need to learn a bit more about overriding templates in django :)</span>
<span class="comment-copy">Incredible, i have been looking for the issue everywhere, but i only had to literally move a single line on my settings file to solve this, i did not think about that. This is awesome, thank you!</span>
<span class="comment-copy">the more appropriate way is to have <code>'APP_DIRS': True</code> in your <code>TEMPLATES</code> settings, so you don't have to re-order the apps. Or to create a directory at top-level  where you override the templates and set it using the <code>'DIRS': &lt;path&gt;</code> directive. I don't really like having 3rd party apps after my apps in <code>INSTALLED_APPS</code>, that doesn't always work for certain types of apps.</span>
<span class="comment-copy">I did not know about this, thank you @dirkgroten!</span>
<span class="comment-copy">@dirkgroten I'm not sure what you mean by <i>the more appropriate way is to have <code>'APP_DIRS': True</code></i> - my suggestion to re-order the apps will only work if it's already <code>True</code> (unless the app directories loader is manually enabled in <code>TEMPLATES</code>). I agree that creating a project's templates directory and setting <code>DIRS</code> might be better. Nice link to the docs on how to override templates, I've never seen that page before.</span>
<span class="comment-copy">@dirkgroten setting <code>'APP_DIRS': True</code> (the default for a new project) enables the <code>app_directories</code> loader. The docs for <a href="https://docs.djangoproject.com/en/2.2/ref/templates/api/#django.template.loaders.app_directories.Loader" rel="nofollow noreferrer">the app directories loader</a> says that the the order of <code>INSTALLED_APPS</code> is significant and gives examples. For the app directories loader It doesn't matter whether it's a <code>django.contrib</code> app, a third party app installed using <code>pip</code>, or an app in the project directory.</span>
<div class="post-text" itemprop="text">
<p>So I am trying to solve this problem; The image contains some sample output.</p>
<p><img alt="Problem to solve" src="https://i.stack.imgur.com/tbHPx.png"/></p>
<p>This is the code I have so far and I'm not sure where I am going wrong. Problem is it is not displaying the correct figures in the sample run.</p>
<pre><code>investmentAmount=0
intr=0

   monthlyInterestRate=0

def futureInvestmentValue(investmentAmount, monthlyInterestRate, years):

    futureInvestmentValue=investmentAmount*(1+monthlyInterestRate)**years
    return futureInvestmentValue

def main():

  investmentAmount=int(input("The amount invested: "))
  intr=int(input("Annual interest rate: "))
  monthlyInterestRate=intr/1200

  print("Years Future Value")
     for yrs in range(1,31):

    FIV=futureInvestmentValue(investmentAmount,monthlyInterestRate,yrs)
      print(yrs, format(FIV, ".2f"))
 main()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You are confusing months and year. In your code, you are actually calculating increments in months despite having named the variable <code>years</code>.  And you probably want to convert the interest rate to a <code>float</code> rather than an <code>int</code> to allow a wider range.</p>
<p>Here is the corrected code (I did not change the formula):</p>
<pre><code>def future_investment_value(investment_amount, monthly_interest_rate, months):
    return investment_amount * (1 + monthly_interest_rate)**months

def main():
    investment_amount = int(input("The amount invested: "))
    yearly_interest_rate = float(input("Annual interest rate: "))
    monthly_interest_rate = yearly_interest_rate / 1200

    print("Months future value")
    for months in range(1, 30*12 + 1):
        fut_val = future_investment_value(
            investment_amount, monthly_interest_rate, months)

        if months % 12 == 0:
            print('{:3d} months | {:5.1f} years ==&gt; {:15.2f}'.format(
                months, months / 12, fut_val))

if __name__ == '__main__':
    main()
</code></pre>
<p>As you can see in the output, at 60 months (5 years), the output is what you expected:</p>
<pre><code>The amount invested: 10000
Annual interest rate: 5
Months future value
 12 months |   1.0 years ==&gt;        10511.62
 24 months |   2.0 years ==&gt;        11049.41
 36 months |   3.0 years ==&gt;        11614.72
 48 months |   4.0 years ==&gt;        12208.95
 60 months |   5.0 years ==&gt;        12833.59
 72 months |   6.0 years ==&gt;        13490.18
...
336 months |  28.0 years ==&gt;        40434.22
348 months |  29.0 years ==&gt;        42502.91
360 months |  30.0 years ==&gt;        44677.44
</code></pre>
</div>
<span class="comment-copy">What's wrong with this code ?</span>
<span class="comment-copy">Can you edit your post to include some input/output/expected output examples? Tell us <i>why</i> and <i>how</i> it's not working and we can help you fix it.</span>
<span class="comment-copy">@GreenCloakGuy I have edited the post</span>
<span class="comment-copy">Are your equations correct?</span>
<span class="comment-copy">You are mixing monthly and yearly interest rates. Your <code>futureInvestmentValue</code> should calculate the value per month and not per year.</span>
<span class="comment-copy">Thanks @Ralf It worked.</span>
<div class="post-text" itemprop="text">
<p>I am trying to get the model (which ran successfully before it was converted to.tflite) to classify test images.</p>
<pre><code>img = Image.open( input_path )
img.load()
input_data = np.array(img, dtype=np.int32)
interpreter.set_tensor(input_details[0]['index'], input_data)
interpreter.invoke()
</code></pre>
<p>But I get an error <em>ValueError: Cannot set tensor: Got tensor of type 2 but expected type 1 for input 13</em></p>
<p>This refers to the dtype, and I believe int32 is the correct format, I've tried nearly every other but I still get the error, which isn't very descriptive.</p>
<p>As I have the dtype correct, I presume that I must be converting the image incorrectly. Is there a better way I should be converting this image to submit to the model?</p>
</div>
<div class="post-text" itemprop="text">
<p>Try this:</p>
<pre><code>input_data = np.array(img, dtype=np.float32)
</code></pre>
<p>You can always check with</p>
<pre><code>print(interpreter.get_input_details())
</code></pre>
<p>which dtype is required</p>
</div>
<div class="post-text" itemprop="text">
<p>I prepared the data set. 
My data set info:</p>
<pre><code>200x200 px RGB images
Jpg files
Class num 4
</code></pre>
<p>How do I load and train the my data set? How do I augment, separate, etc, just like cifar100 data?</p>
</div>
<div class="post-text" itemprop="text">
<p>Did you try loading it to your google drive, and then mounting google drive on colab? </p>
<p>Upload your data onto your google drive.
To mount your drive on colab, run the following in your colab notebook:</p>
<pre><code>from google.colab import drive
drive.mount("/content/gdrive", force_remount=True)
</code></pre>
<p>Then you can use the data as you would use it in your local machine. the path to data would look like: <code>/content/gdrive/My\ Drive/...</code></p>
</div>
<span class="comment-copy">Can you give some more information about the dataset? How much is its size and what are the number of images?</span>
<span class="comment-copy">200x200 px images, number 2000</span>
<span class="comment-copy">Yes ı did. But I couldn't convert it to the proper shape for the cnn.</span>
<span class="comment-copy">Your question is unclear. I don't see any relation between reshaping the data and google colab. You can write the code that you want in a python file as you do for your own computer. For file read and write, use path from google drive. Then, upload that python code to your google drive. then mount drive on google colab. run your file using : <code>!python /content/gdrive/My\ Drive/..../code.py</code> (path to your file) from the google google colab notebook.</span>
<div class="post-text" itemprop="text">
<p>I'm currently expanding the functionality of an existing program.
My addition is supposed to stop the main function of the program when an error is found to enable the user to fix the error and then continue the main function.</p>
<p>The problem I do have now is that I do not know how I can implement a "wait function" to stop the main function until a user input through tkinter is given.
Additionally I want to ask if there is an alternative to mainloop(), for example to only refresh the ui once every main function loop</p>
<p>I'm an engineer and no programmer so sorry for messy code and the lack of proper terminology.</p>
<p>My implementation so far:</p>
<p>In the main function:</p>
<pre><code>if Total_Errors != 0:

  os.startfile(root)
  Error_Window(root)
</code></pre>
<p>Outside of main function:</p>
<pre><code>def Error_Window(root):

  import tkinter

  ErrorWindow = tkinter.Tk()
  ErrorWindow.title("Error found")
  ErrorWindow.resizable(0,0)
  tkinter.Label(ErrorWindow, text="Error fount at:").pack(padx=10, pady=0)
  tkinter.Label(ErrorWindow, text=root,).pack(padx=10, pady=0)
  tkinter.Button(ErrorWindow, text="Ignore", command=PlaceHolder).pack(padx=10, pady=10)
  tkinter.Button(ErrorWindow, text="Continue", command=PlaceHolder).pack(padx=10, pady=10) 
  ErrorWindow.mainloop()
</code></pre>
<p>Please do give constructive criticism on how my question can be improved.</p>
</div>
<div class="post-text" itemprop="text">
<p>With the method of .wait_window using <a href="http://effbot.org/tkinterbook/tkinter-dialog-windows.htm" rel="nofollow noreferrer">Dialog Windows</a> suggested by @stovfl I was able to solve my problem:</p>
<p>I implemented the whole "ErrorWindow" into the main function for loop with the code snippet looking like this:</p>
<pre><code>if Total_Errors != 0:

    ErrorWindow = tkinter.Toplevel(Window)
    ErrorWindow.title("Error")
    ErrorWindow.minsize(width=250, height=250)
    ErrorWindow.resizable(0,0)

    tkinter.Label(ErrorWindow, text="Error found at:").pack()
    tkinter.Label(ErrorWindow, text=root).pack()

    tkinter.Button(ErrorWindow,text="Continue", command=ErrorWindow.destroy).pack()

    os.startfile(root)
    Window.wait_window(ErrorWindow)
</code></pre>
</div>
<span class="comment-copy">When is <code>Total_Errors</code> calculated?</span>
<span class="comment-copy"><i>"to stop the <code>main function</code> until a user input through tkinter is given"</i>: Read about <code>.wait_window(...)</code> using <a href="http://effbot.org/tkinterbook/tkinter-dialog-windows.htm" rel="nofollow noreferrer">Dialog Windows</a></span>
<span class="comment-copy">@Guimoute  Total_Errors is calculated as a result of multiple functions which get executed in a linear style in one long for loop. My code is at the end (still inside) of the for loop to check if user input is required because an error is occurred during one iteration of a loop.</span>
<span class="comment-copy">@stovfl the .wait_window function did exactly solve my problems thank you a lot! If you want to post it as an answer I will mark it as the right answer.</span>
<span class="comment-copy">@GittingGud: Go ahead and write the answer with the code part of your solution. Include the reference to <a href="http://effbot.org/tkinterbook/tkinter-dialog-windows.htm" rel="nofollow noreferrer">Dialog Windows</a>.</span>
<div class="post-text" itemprop="text">
<p>I'm trying out a small Python program to encrypt and decrypt a zip file using 7 zip and here is the script:</p>
<pre><code>import zipfile
import os
import subprocess

os.environ['ZIP_ENCRYPT_PASS'] = 'test'
password = os.environ['ZIP_ENCRYPT_PASS']

# Step 1: Encrypt the file using AES256
rc = subprocess.call(['7z', 'a', '-mem=AES256', password, '-y', 'myarchive.zip'] + 
                     ['/Users/joe/Projects/Sandbox/python-projects/test.txt', '/Users/joe/Projects/Sandbox/python-projects/some.txt'])


# Step 2: Decrypt the archive
f = zipfile.ZipFile('myarchive.zip').extractall(pwd=password)
</code></pre>
<p>When I tried to run this script, I get an error message as below:</p>
<pre><code>Joes-MacBook-Pro:python-projects joe$ python ./test.py
Traceback (most recent call last):
  File "./test.py", line 10, in &lt;module&gt;
    ['/Users/joe/Projects/Sandbox/python-projects/test.txt', '/Users/joe/Projects/Sandbox/python-projects/some.txt'])
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 522, in call
    return Popen(*popenargs, **kwargs).wait()
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 710, in __init__
    errread, errwrite)
  File "/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/subprocess.py", line 1335, in _execute_child
    raise child_exception
OSError: [Errno 2] No such file or directory
</code></pre>
<p>I tried to run this script like:</p>
<pre><code>python test.py

python ./test.py
</code></pre>
<p>Both the approaches landed me with the same error message! Both the files that I'm trying to zip exists and I have even given full permissions on those files!</p>
<p>Is there anything that I'm missing and how to get rid of this annoying error?</p>
</div>
<span class="comment-copy">Could you try giving the abspath of <code>7z</code> to subprocess <code>call</code> ? <code>/usr/bin/7z</code> ?</span>
<span class="comment-copy">How can I add that as a dependency in Python?</span>
<span class="comment-copy">How can you add <code>what</code> as a <code>dependency</code> ?</span>
<span class="comment-copy">I don't want to use 7z from the underlying OS, but rather I want that as a library that I can run anywhere!</span>
<span class="comment-copy">Unless the program is in the default <code>PATH</code>, it won't be able to find it</span>
<div class="post-text" itemprop="text">
<p>I have seen a couple of questions asking how to force a screen redraw in tkinter (which can be done using <code>update_idletasks</code>. I would like to do the opposite: suspend Tkinter's automatic screen redrawing until I have completed some major surgery to the application window - insert, delete, reposition a large number of widgets on a canvas, and then activate automatic screen redrawing after I'm done. Is that possible? I can't find any documented way of doing this. I'm using Tkinter with Python 3. </p>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p>I would like to do the opposite: suspend Tkinter's automatic screen redrawing until I have completed some major surgery to the application window - insert, delete, reposition a large number of widgets on a canvas, and then activate automatic screen redrawing after I'm done. Is that possible?</p>
</blockquote>
<p>Yes, it's possible. That's precisely how tkinter works by default. </p>
<p>Tkinter runs in a single thread. While any of your code is running, tkinter has no ability to update the screen unless you explicitly call <code>update</code> or <code>update_idletasks</code> for it to be updated. </p>
</div>
<span class="comment-copy">That's the way it works by default.  If the mainloop isn't running, and you're not calling <code>.update()</code> or <code>.update_idletasks()</code>, none of your canvas changes get drawn.</span>
<span class="comment-copy">@jasonharper - but the mainloop <i>is</i> running. Is there a way to suspend it?</span>
<span class="comment-copy">How are you managing to let the mainloop have any CPU time while you're doing your canvas updates?  You'd have to go out of your way to allow that.</span>
<span class="comment-copy">@jasonharper - isn't the mainloop running in a separate thread? I was under the impression that it is.</span>
<span class="comment-copy">With your <code>mainloop</code>-issue: You can break the <code>mainloop</code>by instantiating <code>.quit()</code>. After that you can just simply start the <code>mainloop</code>again if you want. But keep in mind that the window will be closed if you run it over the console and you don't give the program any tasks after <code>.quit()</code>.</span>
<span class="comment-copy">Thanks for the explanation.</span>
<div class="post-text" itemprop="text">
<p>I've been recently exercising CDC (consumer driven contracts) and have come across the following issue.</p>
<p>I have a consumer test:</p>
<pre><code>@pytest.fixture()
def consumer(session, pact):
    return Service(session, pact.uri)

def test_get_user_code(pact, consumer):
    expected = {"device_code": "xxxxx",
                "user_code": "12345",
                }
    (pact
     .given('everything is ideal')
     .upon_receiving('a request for device and user codes')
     .with_request(
         method='POST',
         path="/some_path/path/authorization",
         headers={'Content-Type': 'application/x-www-form-urlencoded'},
         query={"client_id": ["test1"],
                "secret": ["test1-secret-key"],
                "scope": ['openid', 'profile', 'phone', 'offline_access']
                }
     )
     .will_respond_with(200, body=Like(expected)))

     with pact:
        r = consumer.get_device_n_user_codes('test1', 'test1-secret-key',
                                         'openid profile phone offline_access',
                                          imposter=pact.uri + '/')
</code></pre>
<p>The request in Fiddler/Burp looks like this:</p>
<pre><code>POST /some_path/path/authorization HTTP/1.1
Host: some_url.com
User-Agent: python-requests/2.18.4
Accept-Encoding: gzip, deflate
Accept: */*
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 104

client_id=test1&amp;secret=test1-secret- 
key&amp;scope=openid+profile+phone+offline_access
</code></pre>
<p>And it works ok against real provider(I get expected response).
However, when I'm using Pact/Pactman mock server I get the following error:</p>
<pre><code>&gt;                                                imposter=pact.uri + '/')

test_get_usercodes_n_access_token.py:49: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
..\..\..\model\authorization.py:78: in get_device_n_user_codes
imposter=imposter)
..\..\..\model\http.py:71: in parametrized_post
verify=False)
..\..\..\venv\lib\site-packages\requests\api.py:112: in post
return request('post', url, data=data, json=json, **kwargs)
..\..\..\venv\lib\site-packages\requests\api.py:58: in request
return session.request(method=method, url=url, **kwargs)
..\..\..\venv\lib\site-packages\requests\sessions.py:508: in request
resp = self.send(prep, **send_kwargs)
..\..\..\venv\lib\site-packages\requests\sessions.py:618: in send
r = adapter.send(request, **kwargs)
..\..\..\venv\lib\site-packages\requests\adapters.py:440: in send
timeout=timeout
..\..\..\venv\lib\site-packages\pactman\mock\mock_urlopen.py:32: in urlopen
return self.mocks[self.port](method, url, body=body, data=data, 
headers=headers)
..\..\..\venv\lib\site-packages\pactman\mock\mock_urlopen.py:82: in __call__
return self.validate_request(method)
..\..\..\venv\lib\site-packages\pactman\mock\pact_request_handler.py:51: in 
validate_request
body = json.loads(self.body)
C:\Users\user\AppData\Local\Programs\Python\Python36- 
32\lib\json\__init__.py:354: in loads
return _default_decoder.decode(s)
C:\Users\user\AppData\Local\Programs\Python\Python36- 
32\lib\json\decoder.py:339: in decode
obj, end = self.raw_decode(s, idx=_w(s, 0).end())
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = &lt;json.decoder.JSONDecoder object at 0x0421E0D0&gt;
s = 'client_id=test1&amp;secret=test1-secret-key&amp;scope=openid+profile+phone+offline_access'
idx = 0

   def raw_decode(self, s, idx=0):
       """Decode a JSON document from ``s`` (a ``str`` beginning with
        a JSON document) and return a 2-tuple of the Python
        representation and the index in ``s`` where the document ended.

        This can be used to decode a JSON document from a string that may
        have extraneous data at the end.

        """
       try:
           obj, end = self.scan_once(s, idx)
       except StopIteration as err:
 &gt;          raise JSONDecodeError("Expecting value", s, err.value) from None
 E          json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
 C:\Users\user\AppData\Local\Programs\Python\Python36-32\lib\json\decoder.py:357: JSONDecodeError
 ---------------------------- Captured stdout setup ----------------------------
</code></pre>
</div>
<span class="comment-copy">Hi Mikhail,  I believe this is a bug in the code since it always expects a JSON object.  You should create an issue here with this exact same example: <a href="https://github.com/pact-foundation/pact-python/issues" rel="nofollow noreferrer">github.com/pact-foundation/pact-python/issues</a> Cheers.</span>
<span class="comment-copy"><a href="https://github.com/pact-foundation/pact-python/issues/102#issuecomment-476011534" rel="nofollow noreferrer">This has been fixed here</a></span>
<div class="post-text" itemprop="text">
<p>I defined these global variables:</p>
<pre><code>value1 = ""
value = ""
</code></pre>
<p>Both variables are being used in two different functions:</p>
<pre><code>def function1():
  ...
  value1 = widget.get(selection1[0])

def function2():
  ...
  value = widget.get(selection0[0])
</code></pre>
<p>However when i try to use these variables in a third function:</p>
<pre><code>def function1():
  if value1 != "":
    if value != "":
      print(value1 + " | " + value
  else:
      print("Bar")
</code></pre>
<p>I only get a <code>|</code> instead of the variables, which should be filled instead.</p>
</div>
<div class="post-text" itemprop="text">
<p>As jasonharper's comment mentions, you need to use the <code>global</code> keyword to reference the global variable, otherwise you make a new scoped variable.</p>
<h2>Without global:</h2>
<pre><code>x = 3

def setToFour():
    x = 4
    print(x)

print(x)
setToFour()
print(x)
</code></pre>
<p>Output:</p>
<pre><code>&gt;&gt; 3
&gt;&gt; 4
&gt;&gt; 3
</code></pre>
<p>The function makes its own <code>x</code>, sets it to 4, and prints it. The global <code>x</code> is left unchanged.</p>
<h2>With global:</h2>
<pre><code>x = 3

def setToFour():
    global x
    x = 4
    print(x)

print(x)
setToFour()
print(x)
</code></pre>
<p>Output:</p>
<pre><code>&gt;&gt; 3
&gt;&gt; 4
&gt;&gt; 4
</code></pre>
<p>The function is told to use the global <code>x</code> rather than making its own <code>x</code>, sets it to 4, then prints it. The global <code>x</code> was directly modified, and maintains its new value.</p>
</div>
<div class="post-text" itemprop="text">
<p>premising that I believe you are using tkinter, you don't need any global assignment.</p>
<p>You need a object oriented approach and the right tool, such as as StringVar(), or IntVar() depends on nature of your variable.</p>
<p>see below, def callback(self), is your function1</p>
<pre><code>import tkinter as tk

class App(tk.Frame):

    def __init__(self,):

        super().__init__()

        self.master.title("Hello World")

        self.value = tk.StringVar()
        self.value1 = tk.StringVar()

        self.init_ui()

    def init_ui(self):

        self.pack(fill=tk.BOTH, expand=1,)

        f = tk.Frame()

        tk.Label(f, text = "Value").pack()
        tk.Entry(f, bg='white', textvariable=self.value).pack()

        tk.Label(f, text = "Value1").pack()
        tk.Entry(f, bg='white', textvariable=self.value1).pack()

        w = tk.Frame()

        tk.Button(w, text="Print", command=self.callback).pack()
        tk.Button(w, text="Reset", command=self.on_reset).pack()
        tk.Button(w, text="Close", command=self.on_close).pack()

        f.pack(side=tk.LEFT, fill=tk.BOTH, expand=0)
        w.pack(side=tk.RIGHT, fill=tk.BOTH, expand=0)


    def callback(self):

        if self.value1.get():
            if self.value.get():
                print(self.value1.get() + " | " + self.value.get())
        else:
            print("Foo")

    def on_reset(self):
        self.value1.set('')
        self.value.set('')

    def on_close(self):
        self.master.destroy()

if __name__ == '__main__':
app = App()
app.mainloop()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>With assignment operator the variable is created locally in python function.
One need to declare a variable global explicitly.
eg.</p>
<pre><code>value1 = "Hello"
value = "World"
def function1():
    global value1
    global value
    print(value1, value1)
</code></pre>
</div>
<span class="comment-copy">If a function contains an assignment to a variable, that variable is local by default.  You need an explicit <code>global</code> statement in the function to change that.</span>
<span class="comment-copy"><code>def function1(): global value1; global value</code></span>
<span class="comment-copy">note: you don't need to use global if all you're doing is reading the value of a variable. global is only needed when modifying a global variable. The use of <code>global</code> in your example is unnecessary.</span>
<div class="post-text" itemprop="text">
<p>Apologies as I'm sure this problem has come up before but none of the examples seem to apply.</p>
<p>I'm trying to create a 2D list (4 by 100) which assigns random values in different ranges in each row.</p>
<pre><code>import random
size_of_meadow = 100
no_of_flowers = 100
no_of_flower_types = 3

flower = [[0] * 5] * no_of_flowers

for row in range(no_of_flowers):
    flower[row][0] = random.randint(0, size_of_meadow - 1)  # x coord
    flower[row][1] = random.randint(0, size_of_meadow - 1)  # y coord
    flower[row][2] = random.randint(1, no_of_flower_types)
if random.randint(0, 100) &lt; 5:
    flower[row][3] = 1
else:
    flower[row][3] = 0

print(flower[0][0])
print(flower[0][1])
print(flower[0][2])
print(flower[0][3])
print(" ")
print(flower[1][0])
print(flower[1][1])
print(flower[1][2])
print(flower[1][3])
# Sorry the above isn't in a for loop
</code></pre>
<p>The outputs just show the same set of numbers for each row of the 2D list...</p>
<p>Output:</p>
<pre><code>29
21
2
0

29
21
2
0
</code></pre>
<p>I'm new to python and I know I must be missing something fundamental, but after a lot of umming and ahhing I haven't figured it out, any help is appreciated.</p>
<p>Thanks</p>
</div>
<div class="post-text" itemprop="text">
<p>You have one list that contains 100 times the same list</p>
<pre><code>a=[0,0,0]
flower=[a,a,a,a,...]
</code></pre>
<p>Better solution will be</p>
<pre><code>import random

size_of_meadow = 100
no_of_flowers = 100
no_of_flower_types = 3

flower = []

for row in range(no_of_flowers):
  flower.append([random.randint(0, size_of_meadow-1),
      random.randint(0, size_of_meadow-1),
      random.randint(1, no_of_flower_types),
      1 if random.randint(0, 100) &lt; 5 else 0])

print(flower[0][0])
print(flower[0][1])
print(flower[0][2])
print(flower[0][3])
print(" ")
print(flower[1][0])
print(flower[1][1])
print(flower[1][2])
print(flower[1][3])
# Sorry the above isn't in a for loop
</code></pre>
<p>However flower generator would be even better</p>
</div>
<div class="post-text" itemprop="text">
<p>By using <code>[[0] * 5] * no_of_flowers</code> you are creating 100 references to the same list. This means there is <strong>ONLY ONE ROW</strong> in the memory. </p>
<p>When you modify a row, if affects the row in memory, and since all other "rows" refer to it, they will simply use the list in memory which is up-to-date.</p>
<p><strong>To avoid this scenario, you could use:</strong></p>
<pre><code>flower = [[0 for _ in range(5)] for _ in range(no_of_flowers)]
</code></pre>
<p>===========================================================================</p>
<p>You could find an <a href="https://github.com/satwikkansal/wtfpython#-a-tic-tac-toe-where-x-wins-in-the-first-attempt" rel="nofollow noreferrer">example and explanation in wtfpython</a>:</p>
<pre><code># Let's initialize a row
row = [""]*3 #row i['', '', '']
# Let's make a board
board = [row]*3
</code></pre>
<p>Output:</p>
<pre><code>&gt;&gt;&gt; board
[['', '', ''], ['', '', ''], ['', '', '']]
&gt;&gt;&gt; board[0]
['', '', '']
&gt;&gt;&gt; board[0][0]
''
&gt;&gt;&gt; board[0][0] = "X"
&gt;&gt;&gt; board
[['X', '', ''], ['X', '', ''], ['X', '', '']]
</code></pre>
<p><strong>Explanation:</strong></p>
<p>When we initialize <code>row</code> variable, this visualization explains what happens in the memory.</p>
<p><a href="https://i.stack.imgur.com/p0mv1.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/p0mv1.png"/></a></p>
<p>And when the <code>board</code> is initialized by multiplying the <code>row</code>, this is what happens inside the memory (each of the elements <code>board[0]</code>, <code>board[1]</code> and <code>board[2]</code> is a reference to the same list referred by <code>row</code>)</p>
<p><a href="https://i.stack.imgur.com/DNs8D.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/DNs8D.png"/></a></p>
<p>We can avoid this scenario here by not using <code>row</code> variable to generate <code>board</code>. (Asked in <a href="https://github.com/satwikkansal/wtfpython/issues/68" rel="nofollow noreferrer">this</a> issue).</p>
<pre><code>&gt;&gt;&gt; board = [['']*3 for _ in range(3)]
&gt;&gt;&gt; board[0][0] = "X"
&gt;&gt;&gt; board
[['X', '', ''], ['', '', ''], ['', '', '']]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Hey @Lee has it correct but let me elaborate</p>
<pre><code>&gt;&gt;&gt; flower = [[0] * 5] * 100
&gt;&gt;&gt; flower[0]
[0, 0, 0, 0, 0]
&gt;&gt;&gt; flower[1]
[0, 0, 0, 0, 0]
&gt;&gt;&gt; id(flower[0])
4354853640
&gt;&gt;&gt; id(flower[1])
4354853640
</code></pre>
<p>Here you can see that each sub list will point to the same location in memory</p>
<p>I would use this method:</p>
<pre><code>flower = [[None for _ in range(5)] for _ in range(no_of_flowers)] 

&gt;&gt;&gt; id(flower[0])
4354853832
&gt;&gt;&gt; id(flower[1])
4354854600
</code></pre>
</div>
<span class="comment-copy"><code>print('\n'.join([''.join(['{} '.format(item) for item in row]) for row in flower]))</code> this might also be helpful</span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/240178/list-of-lists-changes-reflected-across-sublists-unexpectedly">List of lists changes reflected across sublists unexpectedly</a></span>
<span class="comment-copy">This is great and produced the results I wanted. I'm still don't entirely understand the mistake I was making but will move forward using this method in future.</span>
<span class="comment-copy">That's what I was thinking, but why are all of them pointing to the same position? I actually expected [[0] * 5] * 100 to run the same way as your code.</span>
<span class="comment-copy">This answer produced the output I wanted from just changing the one line of code which is great.</span>
<span class="comment-copy">@epsilonmajorquezero when you run <code>[0] * 5</code> it creates one list <code>[0, 0, 0, 0, 0]</code> and then the <code>* 100</code> makes a list that has the sub list point to each 100 positions. The list comp actually re-runs in each iteration creating new elements</span>
<span class="comment-copy">@bison that made the problem really clear, thanks for the explanation</span>
<span class="comment-copy">Yeah, I see that's what it must be doing according to behaviour but then the behaviour is not really consistent: first [0] * 5 which creates a list of 5 zeroes (which are not the same location in memory) but then this list multiplied again does point to the same position.</span>
<div class="post-text" itemprop="text">
<p>I am using python library <code>tinydb</code> to store data.</p>
<p>According to <code>tinydb</code> documentation, the proper syntax for an example query is:</p>
<pre><code>User = Query()
db.search(User.birthday.year == 1990)
</code></pre>
<p>Why don't we need:</p>
<pre><code>User = Query()
db.search(lambda User: User.birthday.year == 1990)
</code></pre>
<p><code>db.search</code> is a function that is only called <strong>once</strong>. This means that the function is receiving a fixed value (the result of a comparison) as an input, not a function to serve as a comparator?</p>
<p>How does the <code>tinydb</code> library achieve this weird syntax?</p>
</div>
<div class="post-text" itemprop="text">
<p><code>User.birthday.year</code> isn't really an <code>int</code>; it's an object that represents a <em>query</em> to retrieve an <code>int</code>. The type of this object likewise defines <code>__eq__</code> to return not a Boolean value, but a <em>function</em> that will return the result of comparing the fetched <code>int</code> to 1990.</p>
<hr/>
<p>Digging into the code confirms this.</p>
<p><code>Query.__getattr__</code> <a href="https://github.com/msiemens/tinydb/blob/master/tinydb/queries.py#L122" rel="nofollow noreferrer">returns a new <code>Query</code> object</a>, so <code>User.birthday.year</code> is <em>also</em> a <code>Query</code>.</p>
<p>The definitions of <a href="https://github.com/msiemens/tinydb/blob/master/tinydb/queries.py#L157" rel="nofollow noreferrer"><code>Query.__eq__</code></a> and <a href="https://github.com/msiemens/tinydb/blob/master/tinydb/queries.py#L144" rel="nofollow noreferrer"><code>Query._generate_test</code></a> confirm that <code>==</code> also builds a new query.</p>
</div>
<span class="comment-copy">So are you saying that the way it achieves this is by using __eq__ dunder magic to (essentially) override/overload the "==" operator?</span>
<span class="comment-copy">Not just essentially; <code>__eq__</code> <i>defines</i> what <code>==</code> means for all types. If you don't override it, you inherit its definition from a parent class, which often means going back to <code>object.__eq__</code>, which simply checks for object identity.</span>
<div class="post-text" itemprop="text">
<p>I have a bank of parse tree with invalid format where the words wrapped in parentheses.</p>
<pre><code>string = (NP  (NN  (Police)) (SBAR  (SC (for)) (S  (NP-SBJ  (*)) (VP  (VB (secure)) (NP  (NN      (olympic games)))))))
</code></pre>
<p>I have tried to remove the parentheses without the word inside it turns out I remove all of them.</p>
<pre><code>re.sub(r'[\(\)]','',string)
</code></pre>
<p>and this doesn't work too.</p>
<pre><code>re.sub(r'\s\(.*\)\))
</code></pre>
<p>Because I think the pattern based on the second closed parentheses like </p>
<pre><code>(Police)) (for)) (*)) (secure)) (olympic games))
</code></pre>
<p>I want to remove the parentheses which flanked the word without the word removed like this. Any help?</p>
<pre><code>result = (NP  (NN Police) (SBAR  (SC for) (S  (NP-SBJ  *) (VP  (VB secure) (NP  (NN  olympic games))))))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You may use</p>
<pre><code>re.sub(r'\(([^()]*)\)', r'\1', s)
</code></pre>
<p>See the <a href="https://regex101.com/r/B0VT04/2" rel="nofollow noreferrer">regex demo</a>.</p>
<p><strong>Details</strong></p>
<ul>
<li><code>\(</code> - a <code>(</code> char</li>
<li><code>([^()]*)</code> - Group 1 (<code>\1</code> refers to this group value from the replacement pattern): 0 or more chars other than parentheses</li>
<li><code>\)</code> - </li>
</ul>
<p>See the <a href="https://ideone.com/lY1eKq" rel="nofollow noreferrer">Python demo</a>:</p>
<pre><code>import re
s = "(NP  (NN  (Police)) (SBAR  (SC (for)) (S  (NP-SBJ  (*)) (VP  (VB (secure)) (NP  (NN      (olympic games)))))))"
print(re.sub(r'\(([^()]*)\)', r'\1', s))
# =&gt; (NP  (NN  Police) (SBAR  (SC for) (S  (NP-SBJ  *) (VP  (VB secure) (NP  (NN      olympic games))))))
</code></pre>
</div>
<span class="comment-copy">Try <code>re.sub(r'\(([^()\s]*)\)', r'\1', s)</code>, see <a href="https://ideone.com/pD0I9j" rel="nofollow noreferrer">ideone.com/pD0I9j</a></span>
<span class="comment-copy">It works!! Thanks!! @WiktorStribiżew</span>
<span class="comment-copy">It should be re.sub(r'(([^()]*))', r'\1', s) to give the desired answer.</span>
<span class="comment-copy">@Dave <a href="https://stackoverflow.com/questions/55262830/remove-only-parentheses-in-nested-parentheses/55263700?noredirect=1#comment97258621_55262830">OP confirms</a> that <code>re.sub(r'\(([^()\s]*)\)', r'\1', s)</code> works as expected. If <code>\s</code> is removed, <code>(abc def)</code> like substrings will also get deleted</span>
<span class="comment-copy">The output of your answer doesn't match the OP's desired output; see 'olympic games'</span>
<span class="comment-copy">@Dave Well, I don't understand OP then :) Edited the answer.</span>
<div class="post-text" itemprop="text">
<p>I have problem with it. 
I need to get 2 items in JSON Items is "some_number" and "some_number_2"
Items "sample1" and "sample2" in every request various. 
I'm new person in Python. Thank you so much</p>
<pre><code>"data":{
   "sample1":{
      "some_number":"8410000110275080",
      "some_number_2":"0070050001010011",
      "name":"0000405533003537",
      },
   "sample2":{
      "some_number":"8410000110275080",
      "some_number_2":"0070050001010011",
      "name":"0000405533003537",
      }
</code></pre>
<p>In my code I just can earn 'sample1' and 'sample2'. In next request this values is various.</p>
</div>
<div class="post-text" itemprop="text">
<p>You need to load the Json in a dictionnary:</p>
<pre><code>with open("your file path", 'r') as f:
    data = json.load(f)
</code></pre>
<p>Then, if you want to iterate over both keys and values of the dictionnary, do this:</p>
<pre><code>for key, value in data.items():
    print key, value
</code></pre>
<p>You can then nest <code>for</code> loop to get the desired <code>key, value</code> pairs.</p>
<p>Best</p>
</div>
<div class="post-text" itemprop="text">
<p>Assuming that your json file looks like:</p>
<pre><code>{"data":{
   "sample1":{
      "some_number":"8410000110275080",
      "some_number_2":"0070050001010011",
      "name":"0000405533003537",
      },
   "sample2":{
      "some_number":"8410000110275080",
      "some_number_2":"0070050001010011",
      "name":"0000405533003537",
      }
}
</code></pre>
<p>You can parse it using something like the json module:</p>
<pre class="lang-py prettyprint-override"><code>import json

# open the file using with
with open('myfile.json') as fh:
    my_json = json.load(fh)

# Now my_json is a dictionary
# We can iterate over values of a dictionary
inner_dict = my_json['data']

some_number, some_number_2 = [], []

# Iterate over each value
for val in inner_dict.values():
    some_number.append(val['some_number'])
    some_number_2.append(val['some_number_2'])



</code></pre>
</div>
<span class="comment-copy">This isn't valid json. Are there outer braces wrapping <code>data</code>?</span>
<span class="comment-copy">There's a bultin <code>json</code> module you can use. <code>data = json.load(fd); [(d['some_number'], d['some_number_2']) for _,d in data['data'].items()]</code> ?  Don't use one liners though :)</span>
<span class="comment-copy">How are you trying to store your values for <code>some_number</code> and <code>some_number_2</code>?</span>
<span class="comment-copy">Well, there are many things to note here. Your code will NOT work with JSON data posted above. Secondly, if we believe the input data is in correct format then are you sure this answer is not a dupe?</span>
<span class="comment-copy">The Json posted above has <code>,</code> that have nothing to do here but this code works with a well-formatted json. Then, I'm just giving an hint on how to solve the problem. He/her will better lean how to manipulate Json if he/her has to think on how to get values.</span>
<div class="post-text" itemprop="text">
<p>I have the following result from  InfluxDB when using it with <code>influxdb-python</code>:</p>
<pre><code>results = {'series': [{'columns': ['time', 'v'],
             'name': 'wind-angle',
             'values': [['2018-12-12T10:25:57.890567522Z', 2.9],
                        ['2018-12-12T10:25:57.918715188Z', 285],
                        ['2018-12-12T10:25:57.935111522Z', 3.7],
                        ['2018-12-12T10:25:57.957419855Z', 288.7],
                        ['2018-12-12T10:25:57.973892188Z', 6.3]]},
            {'columns': ['time', 'v'],
             'name': 'wind-spd',
             'values': [['2018-12-12T10:25:57.888505188Z', 1.44],
                        ['2018-12-12T10:25:57.916779855Z', 1.44],
                        ['2018-12-12T10:25:57.932662855Z', 1.44],
                        ['2018-12-12T10:25:57.955199188Z', 1.49],
                        ['2018-12-12T10:25:57.971157855Z', 1.54]]}],
 'statement_id': 0}
</code></pre>
<p>My aim is to <em>merge</em>  the two values under the same timestamp of the measurements as follows:</p>
<pre><code>{
   't': 2018-12-12T10:25:57.890567522Z,
   'd': [
      {
        't': 2018-12-12T10:25:57.890567522Z
        'd': {
         'wind-angle': 2.9,
         'wind-spd': 1.44
      },
      {
        't': 2018-12-12T10:25:57.918715188Z,
         'd': {
           'wind-angle': 285,
           'wind-spd': 1.44
         }
      }
   ]
}
</code></pre>
<p>Desired JSON Structure:</p>
<pre><code>{
  't': 1st timestamp from wind-angle,
   'd': [
      {
       't': timestamp from wind-angle,
       'd': {
           'wind-angle': value_wind-angle,
           'wind-spd': value_wind-spd
       }
   ]
}
</code></pre>
<p>The problem I see is that when I use a <code>for</code> loop there are 5 data points and only two <code>names</code>. Hence for example, the following loop logic:</p>
<pre><code>main = {'t': 0, 'd':[]}
_d = {}
for each_dataset_time, each_dataset_val in results.raw['series'][0]['values']:
    for each_series in results.raw['series']:
        _d[each_series['name']] = each_dataset_val
        _d['t'] = each_dataset_time
    main['d'].append(_d)
</code></pre>
<p>I will keep getting the same value and timestamp even if the JSON Structure is satisfied.</p>
<p>How do I loop over the inner <code>values</code> loop distinctly and make sure that the dict takes the <code>names</code> as keys for the desired structure within the same loop?</p>
</div>
<div class="post-text" itemprop="text">
<p>Using <code>zip</code> to generate <code>d</code> sounds good.<br/></p>
<pre><code>wind_angle  = results.raw['series'][0]['values']
wind_spd     = results.raw['series'][1]['values']

d = []
for wangle, wspd in zip(wind_angle, wind_spd):
    inner  = {}
    inner['t'] = wangle[0]
    inner['d'] = {'wind-angle': wangle[1], 'wind-spd': wspd[1]}
    d.append(inner) 
</code></pre>
</div>
<span class="comment-copy">IMO opinion, the real problem is that there are no identical timestamp between your two datasets. Is rounding the timestamp acceptable?</span>
<span class="comment-copy">Yes. That is what i have in mind</span>
<span class="comment-copy">On the example, he only wants the first timestamp to be used as a key, then he only want the value that is at the same index.</span>
<span class="comment-copy">It is okay. The timestamp resolutions arent very crucial at this points.</span>
<div class="post-text" itemprop="text">
<p>so I have this list of badWords:</p>
<pre><code>badWords = ["nu", "să", "o", "și", "de", "i", "pe", "cu", "ce", "mai", "la", "în", "un", "se", "mi", "eu", "ca",
                "că"]
</code></pre>
<p>And I have this double list in this format:</p>
<pre><code>word_list = [(673, 'de'), (606, 'și'), (518, 'o'), (486, 'să'), (484, 'nu'), (469, 'i'), (348, 'pe'), (309, 'răzvan'), (308, 'cu'), (304, 'ce'), (302, 'mai')]
</code></pre>
<p>I have tried to do this, in order to delete an entry which match my list of bad words</p>
<pre><code>for x in range(len(word_list)):
    for y in range(len(word_list[x])):
        for word in badWords:
            if(word_list[x][y] == word):
                word_list.remove(x)
</code></pre>
<p>But I get this:</p>
<blockquote>
<p>Error: list.remove(x): x not in list</p>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>You're better off creating a new list with a <a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions" rel="nofollow noreferrer">list comprehension</a>, and keeping only those tuples with a second item not present in <code>badWords</code>:</p>
<pre><code>[i for i in word_list if i[1] not in badWords]
# [(309, 'răzvan')]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You'd better not remove items while iterating.
You can do like this:</p>
<pre class="lang-py prettyprint-override"><code>for word in word_list[:]:
    if word[1] in badWords:
        word_list.remove(word)

print(word_list)
# [(309, 'răzvan')]
</code></pre>
<p>You can read <a href="https://github.com/satwikkansal/wtfpython#-deleting-a-list-item-while-iterating" rel="nofollow noreferrer">wtfpython</a>, it may help you.</p>
</div>
<div class="post-text" itemprop="text">
<p>The operator <code>in</code> works much faster with sets than with lists:</p>
<pre><code>s = set(badWords)
list(filter(lambda x: x[1] not in s, word_list))
# [(309, 'răzvan')]
</code></pre>
</div>
<span class="comment-copy">This is probably a duplicate of multiple things.  TL/DR: A) generally using remove inside a for loop is a bad idea.  B) You probably just want to do cleaned_word_list = [x for x in word_list if x[1] not in badWords]</span>
<span class="comment-copy"><code>remove</code> takes an element of a list, not an index.<code>x</code> is an index in your case.</span>
<span class="comment-copy">That was working. Thank you so much!</span>
<div class="post-text" itemprop="text">
<p>Here is my code. I cannot seem to pick a different color for each branch. It just chooses randomly from the list that I presented. </p>
<pre class="lang-python prettyprint-override"><code># Multi-color Snowflake Turtle

import turtle

# Assign a name to your turtle
snow = turtle.Turtle()
snow.shape("turtle")

colors = ["blue", "red", "yellow", "green"]

# Declare the function, snowflake
def snowflake(size, pensize, x, y):
    # turtle.pen(pensize=10)
    snow.penup()
    snow.goto(x, y)
    snow.forward(10*size)
    snow.left(45)
    snow.pendown()
    for color in colors:
        snow.color(color)

    for i in range(8):
        branch(size)
        snow.left(45)

# Create the branches
def branch(size):
    for i in range(3):
        for i in range(3):
            snow.forward(10.0*size/3)
            snow.backward(10.0*size/3)
            snow.right(45)
        snow.left(90)
        snow.backward(10.0*size/3)
        snow.left(45)
    snow.right(90)
    snow.forward(10.0*size)


snowflake(8, 6, 0, 0)
</code></pre>
<p>I'm still unfamiliar with all the different things you can do with Python. I don't know if there's maybe a way to do multi-color. I would do each branch separately but the whole goal is to use a function. I just can't seem to figure out how to incorporate multiple colors into a function.</p>
</div>
<div class="post-text" itemprop="text">
<p>Your current code always draws your snowflakes in green because your loop setting colors runs before the loop drawing the branches of the snowflake. If you want to be selecting a color as you draw, you need to merge the two loops into one.</p>
<p>Here's on simple way, which will give each branch a separate color, repeating when they've all been used:</p>
<pre><code>for i in range(8):
    snow.color(colors[i%4])
    branch(size)
    snow.left(45)
</code></pre>
<p>That's rather deterministic though, it will always go through the color list in the order you wrote it in. You could mix things up by shuffling the list for each snowflake, using <code>random.shuffle</code> (you'll need to <code>import random</code> first). Or there are lots of other options, depending on the effect you want. You could use <code>random.choice</code> to pick a random color for each branch, for example.</p>
</div>
<div class="post-text" itemprop="text">
<p>Following up on @Blckknght's excellent introduction (+1) to this issue, this is more complicated than one might expect.  If we use the modulus (%) approach, even if we shuffle colors, we get repeated patterns, e.g. the first and fifth branch are always the same color, whatever that color may be, etc.</p>
<p>The number of colors is less than the number of branches, we truly want random, and we don't want adjacent branches the same color.  That last criteria seems easy until we realize we don't want the final branch the same color as the first one as we come back around!  So, we might try something like:</p>
<pre><code>first_color = random.choice(colors)
snow.pencolor(first_color)

for flag in range(-6, 2):

    branch(distance)
    snow.left(45)

    new_color = old_color = snow.pencolor()

    while new_color == old_color or (not flag and new_color == first_color):
        new_color = random.choice(colors)

    snow.pencolor(new_color)
</code></pre>
<p>The weird <code>range(-6, 2)</code> looping construct is to allow <code>flag</code> to go <code>False</code> (0) only the one iteration where we need to make sure the first and last branches don't match color-wise.  The complete code:</p>
<pre><code># Multi-color Snowflake Turtle

from turtle import Screen, Turtle
from random import choice

COLORS = ["blue", "red", "yellow", "green"]

# Declare the function, snowflake
def snowflake(size, pensize, x, y):
    snow.width(pensize)

    distance = 10 * size

    snow.penup()
    snow.goto(x, y)
    snow.forward(distance)
    snow.left(45)
    snow.pendown()

    first_color = choice(COLORS)
    snow.pencolor(first_color)

    for flag in range(-6, 2):

        branch(distance)
        snow.left(45)

        new_color = old_color = snow.pencolor()

        while new_color == old_color or (not flag and new_color == first_color):
            new_color = choice(COLORS)

        snow.pencolor(new_color)

    snow.hideturtle()

# Create the branches
def branch(distance):

    for _ in range(3):
        for _ in range(3):
            snow.forward(distance / 3)
            snow.backward(distance / 3)
            snow.right(45)
        snow.left(90)
        snow.backward(distance / 3)
        snow.left(45)

    snow.right(90)
    snow.penup()
    snow.forward(distance)
    snow.pendown()

# Assign a name to your turtle
snow = Turtle("turtle")

screen = Screen()

snowflake(8, 6, 0, 0)

screen.exitonclick()
</code></pre>
<p><a href="https://i.stack.imgur.com/bN1NY.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/bN1NY.png"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>I have a C++ class hierarchy that I am exposing to Python via SWIG. The classes being exposed are wrapped by <code>std::shared_ptr</code>.</p>
<p>The problem I have is Python doesn't expose methods on derived objects returned as a base <code>std::shared_ptr</code>. This is surprising because the runtime seems able to infer that the object is of type derived <code>std::shared_ptr</code>. </p>
<p>I can see derived methods when a derived <code>std::shared_ptr</code> is returned explicitly.</p>
<p>The question <a href="https://stackoverflow.com/questions/27392602/swig-downcasting-from-base-to-derived">here</a> shows that what I am trying to do can be achieved using raw pointers with a typemap declaration.</p>
<p>MyProg.h:</p>
<pre><code>#pragma once

#include &lt;memory&gt;
#include &lt;vector&gt;
#include &lt;exception&gt;

namespace MyProg
{
    enum SubTypes
    {
        BaseType,
        DerivedAType,
        DerivedBType
    };

    class Base
    {
    public:
        virtual SubTypes SubType()
        {
            return BaseType;
        }

        virtual ~Base() {}

    protected:
        Base() {}
    };

    class DerivedA : public Base
    {
    public:
        friend class MyProg;

        int CallDerivedA()
        {
            return 1;
        }

        SubTypes SubType()
        {
            return DerivedAType;
        }

    private:
        DerivedA() : Base() {}
    };

    class DerivedB : public Base
    {
    public:

        friend class MyProg;

        int CallDerivedB()
        {
            return 2;
        }

        SubTypes SubType()
        {
            return DerivedBType;
        }

    private:
        DerivedB() : Base()
        {}
    };

    typedef std::shared_ptr&lt;Base&gt; BasePtr;
    typedef std::shared_ptr&lt;DerivedA&gt; DerivedAPtr;
    typedef std::shared_ptr&lt;DerivedB&gt; DerivedBPtr;

    class MyProg
    {
    public:

        MyProg()
        {
            // Create instances
            m_derivedA = std::shared_ptr&lt;Base&gt;(new DerivedA());
            m_derivedB = std::shared_ptr&lt;Base&gt;(new DerivedB());
        }

        DerivedAPtr GetDerivedA()
        {
            return std::dynamic_pointer_cast&lt;DerivedA&gt;(m_derivedA);
        }

        DerivedBPtr GetDerivedB()
        {
            return std::dynamic_pointer_cast&lt;DerivedB&gt;(m_derivedB);
        }

        BasePtr GetDerived(const SubTypes subType)
        {
            if (subType == DerivedAType)
            {
                return m_derivedA;
            }
            else if (subType == DerivedBType)
            {
                return m_derivedB;
            }
            throw std::exception("Unsupported type requested");
        }

    private:
        BasePtr m_derivedB;
        BasePtr m_derivedA;
    };
}
</code></pre>
<p>The SWIG interface:</p>
<pre><code>%module MyProg_Python

%include "typemaps.i"
%include &lt;cpointer.i&gt;
%include &lt;std_shared_ptr.i&gt;

%shared_ptr(MyProg::Base);
%shared_ptr(MyProg::DerivedA);
%shared_ptr(MyProg::DerivedB);

// I created this typemap based on the code generated for the GetDerivedA and GetDerivedB functions
%typemap(out) MyProg::Base {

    if (($1)-&gt;SubType() == MyProg::DerivedAType)
    {
        std::shared_ptr&lt; MyProg::DerivedA &gt; myptr = std::dynamic_pointer_cast&lt; MyProg::DerivedA &gt;(result);
        std::shared_ptr&lt; MyProg::DerivedA &gt; *smartresult = result ? &amp;myptr : 0;
        $result = SWIG_NewPointerObj(SWIG_as_voidptr(smartresult), SWIGTYPE_p_std__shared_ptrT_MyProg__DerivedA_t, SWIG_POINTER_OWN);
    }
    else if (($1)-&gt;SubType() == MyProg::DerivedBType)
    {
        std::shared_ptr&lt; MyProg::DerivedB &gt; myptr = std::dynamic_pointer_cast&lt; MyProg::DerivedB &gt;(result);
        std::shared_ptr&lt; MyProg::DerivedB &gt; *smartresult = result ? &amp;myptr : 0;
        $result = SWIG_NewPointerObj(SWIG_as_voidptr(smartresult), SWIGTYPE_p_std__shared_ptrT_MyProg__DerivedB_t, SWIG_POINTER_OWN);
    }
    else
    {
      // error
    }
}

%{
#include "MyProg.h"

using namespace std;
using namespace MyProg;
%}

%include "..\MyProg\MyProg.h"

namespace MyProg
{
    typedef std::shared_ptr&lt;Base&gt; BasePtr;
    typedef std::shared_ptr&lt;DerivedA&gt; DerivedAPtr;
    typedef std::shared_ptr&lt;DerivedB&gt; DerivedBPtr;
}
</code></pre>
<p>Python client:</p>
<pre><code>from MyProg_Python import *
prog = MyProg()
a = prog.GetDerivedA()
result = a.CallDerivedA() # returns 1
b = prog.GetDerivedB()
result = b.CallDerivedB() # returns 2
afrombase = prog.GetDerived(DerivedAType)

# The following line doesn't resolve, even though runtime indicates afrombase  is of type MyProg_Python.DerivedA (proxy of &lt;Swig Object of type 'std::shared_ptr&lt;MyProg::DerivedA&gt; * ' at 0x...&gt;)
afrombase.CallDerivedA()
</code></pre>
<p>Is this a restriction with shared_ptr - do I need to use raw pointers? Or is there a typemap declaration that allows me to expose polymorphic behaviour in Python?</p>
</div>
<span class="comment-copy">You need to have <code>%shared_ptr(MyProg::Base);</code> placed after your regular <code>#include "MyProg.h". How would </code>SWIG` know what e.g. <code>MyProg::Base</code> is</span>
<div class="post-text" itemprop="text">
<p>I am attempting to segment a LiDAR point cloud after the ground has been classified. I am using numpy to create an "image" of the the point cloud (pc) and am looping through the numpy array.  I would like to speed up the loop or avoid it all together.  I am going to use image segmentation techniques, but first I need to run this code to create an "image" and this is the part that is taking a while.  Is there a way to increase the speed of this loop or a way to avoid it?   </p>
<pre class="lang-py prettyprint-override"><code>
import numpy as np
from math import ceil, floor


'''In this case:
pc = point cloud (X,Y,Z values)'''

# point cloud is in the numpy array, pc
minx,maxx,miny,maxy = floor(np.min(pc[:,0]-1)),ceil(np.max(pc[:,0]+1)),floor(np.min(pc[:,1]-1)),ceil(np.max(pc[:,1]+1))# x,y bounding box

# grid x and y direction (resolution: 0.2 meters)
gridx = np.linspace(minx,maxx,int((maxx - minx+0.2)*5),endpoint=True) 
gridy = np.linspace(miny,maxy,int((maxy - miny +0.2)*5),endpoint=True)

#shape of the new image with 0.2 meter resolution.
imgx,imgy = int((maxx-minx+0.2)*5),int((maxy - miny +0.2)*5)

# this is what will be created at the end.  It will be a binary image.
img = np.zeros((imgx,imgy))

#loop through array to generate image (this is the part that takes a while)
for x,i in enumerate(gridx):
    for y,j in enumerate(gridy):

# Test if there any points in this "grid"
        input_point = pc[np.where(((pc[:,0]&gt;i) &amp; (pc[:,0]&lt;i+1))&amp; ((pc[:,1]&gt;j) &amp; (pc[:,1]&lt;j+1)))]
# if there are points, give pixel value 1.
        if input_point.shape[0]!=0:
            img[x,y]=1

print('Image made')


</code></pre>
<p>Thank you.  </p>
</div>
<div class="post-text" itemprop="text">
<p>Here is a vectorized version that produces the same output on a random test set:</p>
<pre><code>import numpy as np
from math import ceil, floor
import time

width = 0.2

t = [time.time()]

pc = np.random.uniform(-10, 10, (100, 3))

# point cloud is in the numpy array, pc
minx,maxx,miny,maxy = floor(np.min(pc[:,0]-1)),ceil(np.max(pc[:,0]+1)),floor(np.min(pc[:,1]-1)),ceil(np.max(pc[:,1]+1))# x,y bounding box

# grid x and y direction (resolution: 0.2 meters)
gridx = np.linspace(minx,maxx,int((maxx - minx+0.2)*5),endpoint=True) 
gridy = np.linspace(miny,maxy,int((maxy - miny +0.2)*5),endpoint=True)

#shape of the new image with 0.2 meter resolution.
imgx,imgy = int((maxx-minx+0.2)*5),int((maxy - miny +0.2)*5)

print('Shared ops done')
t.append(time.time())

# this is what will be created at the end.  It will be a binary image.
img = np.zeros((imgx,imgy))

#loop through array to generate image (this is the part that takes a while)
for x,i in enumerate(gridx):
    for y,j in enumerate(gridy):

# Test if there any points in this "grid"
        input_point = pc[np.where(((pc[:,0]&gt;i) &amp; (pc[:,0]&lt;i+width))&amp; ((pc[:,1]&gt;j) &amp; (pc[:,1]&lt;j+width)))]
# if there are points, give pixel value 1.
        if input_point.shape[0]!=0:
            img[x,y]=1

t.append(time.time())            
print('Image made')

if width == 0.2:
    img2 = np.zeros((imgx, imgy), 'u1')
    x2, y2 = (((pc[:, :2] - (minx, miny)) * (5, 5))).astype(int).T
    img2[x2, y2] = 1

elif width == 1:
    img2 = np.zeros((imgx+4, imgy+4), 'u1')
    x2, y2 = (((pc[:, :2] - (minx, miny)) * (5, 5))).astype(int).T

    np.lib.stride_tricks.as_strided(img2, (imgx, imgy, 5, 5), 2 * img2.strides)[x2, y2] = 1
    img2 = img2[4:, 4:]

t.append(time.time())
print('Image remade')

print('took', np.diff(t), 'secs respectively')
assert((img2==img).all())
print('results equal')
</code></pre>
<p>Your code produces 5x5 pixels. Is that intentional? I had to be a bit tricksy to reproduce that.</p>
<p><strong>UPDATE</strong>: added a version that makes ordinary pixels instead.</p>
<p>Sample run:</p>
<pre><code>Shared ops done
Image made
Image remade
took [2.29120255e-04 1.54510736e-01 1.44481659e-04] secs respectively
results equal
</code></pre>
</div>
<span class="comment-copy">Thank you!  I was trying to get pixels that were 0.2 meters by taking the max and min y values and splitting them up by 0.2 meters.  Is this not true?  Sorry I'm trying to wrap my head around what you mean.</span>
<span class="comment-copy">@Steven But the intervals you check are <code>i</code> to <code>i+1</code> and <code>j</code> to <code>j+1</code> which span 5 grid units in each direction.</span>
<span class="comment-copy">I wasn't trying to span 5 grid units.  What I was trying to do was check based on the 0.2 interval.  for example, if <code>i = 300.0</code> and <code>j = 400.0</code>, it would check if there are points from <code>300.0 - 300.2</code> in the <code>x</code> and <code>400.0 - 400.2</code> in the <code>y</code>.  Does it not do this?</span>
<span class="comment-copy">oh duh!!  That's not what it does.  shoot...I guess I would have to change that.  I meant the next number in the interval and I guess I'm just adding 1 which would make it 5 pixels since each is 0.2 meters.  Thank you for catching that.</span>
<span class="comment-copy">@Steven That makes things simpler, actually. I've updated the answer.</span>
<div class="post-text" itemprop="text">
<p>I know that this is a rather silly question and there are similar ones already answered, but they don't quite fit, so...
How can I perform the same operation on multiple variables in an efficient way, while "keeping" the individual variables?
example:</p>
<pre><code>a = 3
b = 4
c = 5
a,b,c *= 2  #(obviously this does not work)
print(a,b,c) 
</code></pre>
<p>What I want as the output in this scenario is 6, 8, 10. It is rather important that I can still use changed variables. </p>
<p>Thank you very much for your answers!</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use numpy or python lambda function combined with map to do the same.</p>
<p><strong>Using numpy:</strong></p>
<pre class="lang-py prettyprint-override"><code>In [17]: import numpy as np

In [18]: a = 3
    ...: b = 4
    ...: c = 5
    ...:

In [19]: a,b,c = np.multiply([a, b, c], 2)

In [20]: a
Out[20]: 6

In [21]: b
Out[21]: 8

In [22]: c
Out[22]: 10
</code></pre>
<p><strong>Using lambda:</strong></p>
<pre class="lang-py prettyprint-override"><code>In [23]: a, b, c = list(map(lambda x: x*2, [a, b, c]))

In [24]: a
Out[24]: 12

In [25]: b
Out[25]: 16

In [26]: c
Out[26]: 20

</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You may want to look into Python's map function. The following link may be helpful:<a href="https://www.w3schools.com/python/ref_func_map.asp" rel="nofollow noreferrer">https://www.w3schools.com/python/ref_func_map.asp</a></p>
</div>
<div class="post-text" itemprop="text">
<p>Map is your friend here, but you also need to use 'implicit tuple unpacking':</p>
<pre><code>&gt;&gt;&gt; a = 3
&gt;&gt;&gt; b = 4
&gt;&gt;&gt; c = 5
&gt;&gt;&gt; d, e, f = map(lambda x: x * 2, [a, b, c])
&gt;&gt;&gt; d
6
&gt;&gt;&gt; e
8
&gt;&gt;&gt; f
10
</code></pre>
<p>This way you can get the changed values back without modifying the original values</p>
</div>
<div class="post-text" itemprop="text">
<p>You can store them in a container, and then use <code>map</code> to apply one function on every element of the container<br/>
For example with a list:<br/></p>
<pre><code>def function_to_apply(element):
    return element*2

# Define variables and store them in a container
a,b,c = 1,2,3
container = (a,b,c)

# Apply the function on every element with map
container = tuple(map(function_to_apply, container))
a,b,c = container
</code></pre>
<p><br/>
This can also be done with <strong>lambda functions</strong> to avoid defining a new function every time<br/></p>
<pre><code># Define variables and store them in a container
a,b,c = 1,2,3
container = (a,b,c)

# Apply the function on every element with map
container = tuple(map(lambda x: x*2, container))
a,b,c = container
</code></pre>
<p>If you have a really large set of variables and you want to retrieve them automatically without having to type each one of them like in <code>a,b,c = container</code>,  you can use <em>dict</em> to store them with names or <em>exec</em> function to assign them dynamically.<br/>
<br/>
<em><code>map</code> documentation: <a href="https://docs.python.org/3/library/functions.html#map" rel="nofollow noreferrer">https://docs.python.org/3/library/functions.html#map</a><br/>
<code>lambda</code> documentation: <a href="https://docs.python.org/3/reference/expressions.html#grammar-token-lambda-expr_" rel="nofollow noreferrer">https://docs.python.org/3/reference/expressions.html#grammar-token-lambda-expr</a></em></p></div>
<div class="post-text" itemprop="text">
<p>You can use the following generator expression:</p>
<pre><code>a, b, c = 3, 4, 5
a, b, c = (2 * i for i in (a, b, c))
print(a, b, c)
# 6 8 10
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use map to apply a function to every element of a list with a lambda function to perform your operation. Then use list unpacking to overwrite values in orginal variables.</p>
<pre><code>a = 1
b = 2
c = 3

a,b,c = list(map(lambda x: x*2, [a,b,c]))

print(a,b,c)

# prints: (2, 4, 6)
</code></pre>
<p>map returns a generator, that's why we need to explicit create the list to unpack.</p>
</div>
<span class="comment-copy">Any particular reason why you can't do it manually? i.e. <code>a *= 2</code>, etc</span>
<span class="comment-copy">because in a file that is already over 3000 lines long it gets quite messy writing the same command ten times. And also quite inefficient.</span>
<span class="comment-copy">a little bit of explanation of the code would help your answer stand out!</span>
<div class="post-text" itemprop="text">
<p>I've found a method for driver to requests with driver.get_cookies(). But now I have to know how can I load requests cookies to selenium webdriver? Thanks.</p>
</div>
<span class="comment-copy">It is available in documentation, <code>driver.add_cookie()</code></span>
<div class="post-text" itemprop="text">
<p>Consider following floating point number:</p>
<pre><code>number = 2.695274829864502
</code></pre>
<p>When I print it I get:</p>
<pre><code>print(number) # 2.695274829864502
</code></pre>
<p>When I convert it to <code>float32</code> I get truncated number:</p>
<pre><code>import numpy as np
number32 = np.float32(number)
print(number32) # 2.6952748
</code></pre>
<p>Same is when I call <code>__repr__()</code> or <code>__str__()</code>:</p>
<pre><code>print(number32.__str__()) # 2.6952748
print(number32.__repr__()) # 2.6952748
</code></pre>
<p>However, when use I <code>format()</code> function I get the original number:</p>
<pre><code>print("{}".format(number32)) # 2.695274829864502
</code></pre>
<p>It happens in both <code>Python3.5</code> and in <code>Python3.6</code>. <code>Python2.7</code> has similar behavior except that for a longer version of the <code>number</code> it truncates 4 trailing digits.</p>
<p>What is the explanation for this?</p>
</div>
<div class="post-text" itemprop="text">
<p>This is probably just a difference in display, meaning, the class <code>float32</code> probably specifies a different number of digits to display after the decimal point.</p>
<p>Some code to highlight the differences:</p>
<pre><code>n1 = 2.695274829864502
print()
print('n1 type     ', type(n1))
print('n1          ', n1)
print('n1.__str__  ', n1.__str__())
print('n1.__repr__ ', n1.__repr__())
print('n1 {}       ', '{}'.format(n1))
print('n1 {:.30f}  ', '{:.30f}'.format(n1))

n2 = np.float32(n1)
print()
print('n2 type     ', type(n2))
print('n2          ', n2)
print('n2.__str__  ', n2.__str__())
print('n2.__repr__ ', n2.__repr__())
print('n2 {}       ', '{}'.format(n2))
print('n2 {:.30f}  ', '{:.30f}'.format(n2))

n3 = np.float64(n1)
print()
print('n3 type     ', type(n3))
print('n3          ', n3)
print('n3.__str__  ', n3.__str__())
print('n3.__repr__ ', n3.__repr__())
print('n3 {}       ', '{}'.format(n3))
print('n3 {:.30f}  ', '{:.30f}'.format(n3))
</code></pre>
<p>The results (using <code>Python 3.6</code>):</p>
<pre><code>n1 type      &lt;class 'float'&gt;
n1           2.695274829864502
n1.__str__   2.695274829864502
n1.__repr__  2.695274829864502
n1 {}        2.695274829864502
n1 {:.30f}   2.695274829864501953125000000000

n2 type      &lt;class 'numpy.float32'&gt;
n2           2.6952748
n2.__str__   2.6952748
n2.__repr__  2.6952748
n2 {}        2.695274829864502
n2 {:.30f}   2.695274829864501953125000000000

n3 type      &lt;class 'numpy.float64'&gt;
n3           2.695274829864502
n3.__str__   2.695274829864502
n3.__repr__  2.695274829864502
n3 {}        2.695274829864502
n3 {:.30f}   2.695274829864501953125000000000
</code></pre>
<p>As you can see, internally all digits are still there, they just are not shown when using some display methods.</p>
<p>I don't think that this is a bug or that it would affect the calculation results with these variables; this seems to be normal (and expected) behaviour.</p>
</div>
<span class="comment-copy">It probably has to do with default numbers of digits to show when printing.</span>
<span class="comment-copy">What is it exactly that you are worried about? The internal representation is the same, this is simply affecting how things are printed out. If you want full control of how to format the printing, then use the format-specification minilanguage.</span>
<span class="comment-copy">@juanpa.arrivillaga, you're probably right. Thank you.</span>
<span class="comment-copy">@Vlad probably right about what? I was asking a question ...</span>
<span class="comment-copy">@juanpa.arrivillaga Right about "nothing to worry about". In any case, I weren't able to find explanation for this in documentation, therefore asking.</span>
<span class="comment-copy">Thank you for your answer. If you don't mind, I will keep this question open for a while. Maybe someone will point out to the documentation or source code location that defines this behavior.</span>
<div class="post-text" itemprop="text">
<p>I'm trying to call multiple (more than 10 urls) at a time and save all those 10 url's data, which will be in json format and trying to save in my location</p>
<p>here is the below code I have tried, using this I can only achieve to get only last URL's data saved in my json file. How to get all URL's data and stored in a single json file? </p>
<pre><code>import json
import requests

URLs = ['http://httpbin.org/ip',
'http://httpbin.org/user-agent',
'http://httpbin.org/headers']

json_list = []
for url in URLs:
    data = requests.get(url)
    resolvedwo = data.json()
    with open('resolvedworesolution.json', 'w') as f:
         json.dump(resolvedwo, f)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Your problem is that you are overwriting the file, each time in the loop. Instead, store the loop results in a list and write it to the file only once</p>
<pre><code>import requests
import json

URLs = ['http://httpbin.org/ip',
        'http://httpbin.org/user-agent',
        'http://httpbin.org/headers']

json_list = []

for url in URLs:
    data = requests.get(url)
    resolvedwo = data.json()
    json_list.append(resolvedwo)

with open('resolvedworesolution.json', 'w+') as f:
    json.dump(json_list, f, sort_keys=True, indent=4)
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>[
    {
        "origin": "137.221.143.66, 137.221.143.66"
    },
    {
        "user-agent": "python-requests/2.21.0"
    },
    {
        "headers": {
            "Accept": "*/*",
            "Accept-Encoding": "gzip, deflate",
            "Host": "httpbin.org",
            "User-Agent": "python-requests/2.21.0"
        }
    }
]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>When writing to files, opening a file in <code>w</code> mode will erase/truncate the contents before writing to it. </p>
<pre class="lang-py prettyprint-override"><code>with open('resolvedworesolution.json', 'a') as f:
</code></pre>
<p>That should solve your problem</p>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="https://docs.python.org/2/library/functions.html#open" rel="nofollow noreferrer">append mode</a> while writing to the file in order to "retain" the existing data:</p>
<pre><code>import json
import requests
URLs = ['http://httpbin.org/ip',
'http://httpbin.org/user-agent',
'http://httpbin.org/headers']

json_list = []
for url in URLs:
    data = requests.get(url)
    resolvedwo = data.json()
    with open('resolvedworesolution.json', 'a') as f:   # Using the append mode
        json.dump(resolvedwo, f)
        f.write("\n")                                   # new line for readability
</code></pre>
<p><strong>OUTPUT</strong>:</p>
<pre><code>{"origin": "159.122.207.241, 159.122.207.241"}
{"user-agent": "python-requests/2.21.0"}
{"headers": {"Accept": "*/*", "Accept-Encoding": "gzip, deflate", "Host": "httpbin.org", "User-Agent": "python-requests/2.21.0"}}
</code></pre>
<p><strong>EDIT</strong>:</p>
<p>You could write the response to the file in one-go:</p>
<pre><code>with open('resolvedworesolution.json', 'a') as f:
    f.write(str(resolvedwo))
    f.write("\n")
</code></pre>
<p><strong>OR</strong></p>
<pre><code>for url in URLs:
    data = requests.get(url)
    with open('resolvedworesolution.json', 'a') as f:
        f.write(data.text)
        f.write("\n")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can store the info in an object that can be serialized as a whole:</p>
<pre><code>import json
import requests

URLs = ['http://httpbin.org/ip',
'http://httpbin.org/user-agent',
'http://httpbin.org/headers']

json_list = []
for url in URLs:
    data = requests.get(url)
    resolvedwo = data.json()
    json_list.append(resolvedwo)

with open('resolvedworesolution.json', 'w+') as f:
    json.dump(json_list, f)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Instead of:</p>
<pre><code>resolvedwo = data.json()
</code></pre>
<p>You probably want:</p>
<pre><code>resolvedwo += data.json()
</code></pre>
</div>
<span class="comment-copy">Bad indentation.</span>
<span class="comment-copy">@DirtyBit, copy paste issue. It is not that problem as of now</span>
<span class="comment-copy">@MDI then fix the copy-paste, please</span>
<span class="comment-copy">@C.Nivs, done..</span>
<span class="comment-copy">Hint: Use append mode <code>a</code> for writing.</span>
<span class="comment-copy">Ok... What does indent =4 means?</span>
<span class="comment-copy">indent=4 implies that each line needs to be indended by 4 spaces; It just makes the json file to look pretty</span>
<span class="comment-copy">throws error:    <code>json.decoder.JSONDecodeError: Extra data: line 1 column 605744 (char 605743)</code></span>
<span class="comment-copy">It's very possible that the <code>json</code> from the website content is not valid</span>
<span class="comment-copy">@MDI <code>JSONDecode</code> is a <code>json.loads</code> error, so where is that error actually coming from?</span>
<span class="comment-copy">Here,  Actually the error line was not in the question section, below is the code where I try to load and open   <code>with open('C:\\Users\\ibmha\\PycharmProjects\\Projects\\Resolved_without_Resolution\\resolvedworesolution.json', encoding='utf-8-sig') as f:   data = json.load(f)</code></span>
<span class="comment-copy">throws error:   <code>json.decoder.JSONDecodeError: Extra data: line 1 column 605744 (char 605743)</code></span>
<span class="comment-copy">@MDI before going here: <a href="https://stackoverflow.com/questions/21058935/python-json-loads-shows-valueerror-extra-data" title="python json loads shows valueerror extra data">stackoverflow.com/questions/21058935/…</a> Could you make sure the file is empty before running this?</span>
<span class="comment-copy">Yes, I cleared the file and then ran the code and it throws the same error</span>
<span class="comment-copy">Actually the error line was not in the question section, below is the code where I try to load and open  <code>with open('C:\\Users\\ibmha\\PycharmProjects\\Projects\\Resolved_without_Resolution\\resolvedworesolution.json', encoding='utf-8-sig') as f:     data = json.load(f)</code></span>
<span class="comment-copy">@MDI try <code>with open('resolvedworesolution.json', 'a', encoding="ISO-8859-1")</code> as f:</span>
<span class="comment-copy">throws error:    <code>json.decoder.JSONDecodeError: Extra data: line 1 column 605744 (char 605743)</code></span>
<span class="comment-copy">try now. You can store the content in a dict or list and write everything at the end of the for loop</span>
<span class="comment-copy">this throws:  <code>io.UnsupportedOperation: not readable</code></span>
<span class="comment-copy">For me it works nicely. I changed <code>'w'</code> to <code>'w+'</code> because I didn't have the file, so it creates it and then writes the json data... Make sure that you don't have already a file with that name or change the filename...</span>
<span class="comment-copy">Nope. that would throw an error, guess which one?</span>
<span class="comment-copy">yes, it throws error. not helpful buddy</span>
<div class="post-text" itemprop="text">
<p>This is my dataframe:</p>
<pre><code>df = pd.DataFrame({'a':list('xxxyyzz'), 'b':[10,20,30,5,3,1,2]})
</code></pre>
<p>I group them:</p>
<pre><code>groups = df.groupby('a')
</code></pre>
<p>I want to print the groups that has at least one <code>b</code> above 20. In this case I want to print <code>x</code>.
This is my desired outcome:</p>
<pre><code>x
   a   b
0  x  10
1  x  20
2  x  30
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Compare values by <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.gt.html" rel="nofollow noreferrer"><code>Series.gt</code></a>, grouping by <code>a</code> column like <code>Series</code> - <code>df['a']</code> and use <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.transform.html" rel="nofollow noreferrer"><code>GroupBy.transform</code></a> with <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.any.html" rel="nofollow noreferrer"><code>GroupBy.any</code></a> for test at least one <code>True</code> per groups:</p>
<pre><code>df1 = df[df['b'].gt(20).groupby(df['a']).transform('any')]
print (df1)
   a   b
0  x  10
1  x  20
2  x  30
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could check which values are above <code>20</code>, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.groupby.html" rel="nofollow noreferrer"><code>GroupBy</code></a> column <code>a</code> and <code>transform</code> with <a href="https://pandas.pydata.org/pandas-docs/version/0.23.4/generated/pandas.core.groupby.GroupBy.any.html" rel="nofollow noreferrer"><code>any</code></a> to select only those groups with at least one row satisfying the condition:</p>
<pre><code>df[df.b.gt(20).groupby(df.a).transform('any')]

   a   b
0  x  10
1  x  20
2  x  30
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>No need <code>groupby</code> , just do <code>isin</code> </p>
<pre><code>df[df.a.isin(df.loc[df.b&gt;20,'a'])]
Out[996]: 
   a   b
0  x  10
1  x  20
2  x  30
</code></pre>
</div>
<span class="comment-copy">When I saw you post I know I need find some other way to achieve it :-)</span>
<div class="post-text" itemprop="text">
<p>How do I save selected variables in tensorflow 2.0 shown below in a file and load them into some defined variables in another code?</p>
<pre><code>class manyVariables:
    def __init__(self):
        self.initList = [None]*100
        for i in range(100):
            self.initList[i] = tf.Variable(tf.random.normal([5,5]))
        self.makeSomeMoreVariables()

    def makeSomeMoreVariables(self):
        self.moreList = [None]*10
        for i in range(10):
            self.moreList[i] = tf.Variable(tf.random.normal([3,3]))

    def saveVariables(self):
        # how to save self.initList's 3,55 and 60th elements and self.moreList's 4th element
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>In the following code I save an array called variables to a .txt file with a name of your choosing. This file will be in the same folder as your python file. The 'wb' in the open function means write with truncation(so removing everything that was previously in the file) and uses byte format. I use pickle to handle saving/parsing the list.</p>
<pre><code>import pickle

    def saveVariables(self, variables): #where 'variables' is a list of variables
        with open("nameOfYourFile.txt", 'wb+') as file:
           pickle.dump(variables, file)

    def retrieveVariables(self, filename):
        variables = []
        with open(str(filename), 'rb') as file:
            variables = pickle.load(file)
        return variables
</code></pre>
<p>To save specific stuff to your file just add it as the variables argument in saveVariables like so:</p>
<pre><code>myVariables = [initList[2], initList[54], initList[59], moreList[3]]
saveVariables(myVariables)
</code></pre>
<p>To retrieve variables from text file with a certain name:</p>
<pre><code>myVariables = retrieveVariables("theNameOfYourFile.txt")
thirdEl = myVariables[0]
fiftyFifthEl = myVariables[1]
SixtiethEl = myVariables[2]
fourthEl = myVariables[3]
</code></pre>
<p>You could add these functions anywhere in the class. </p>
<p><em>To be able to access the initList/moreList in your example however, you should either return them from their functions(like I do with the <code>variables</code> list) or make them global.</em> </p>
</div>
<span class="comment-copy">Straightaway, got an error that variables must be a str in file.write(). Was able to save with str(variables) as file.write argument but couldn't load and convert back to tensor. There must be a better method with tf.train.Checkpoint().</span>
<span class="comment-copy">oops you are right there, I forgot to double check that. You could make it work using pickle which allows you to save many formats as byte. I will update the answer. Tensorflow might indeed have an automatic function for this, I have never worked with it so I am not sure.</span>
<span class="comment-copy">That did the job. Thank you very much. Although there should be some tensorflow specific way too so I'll wait a bit more for another answer with tf.train.Checkpoint if possible..</span>
<div class="post-text" itemprop="text">
<p>This is a generalization of the "string contains substring" problem to (more) arbitrary types.</p>
<p>Given an sequence (such as a list or tuple), what's the best way of determining whether another sequence is inside it?   As a bonus, it should return the index of the element where the subsequence starts:</p>
<p>Example usage (Sequence in Sequence):</p>
<pre><code>&gt;&gt;&gt; seq_in_seq([5,6],  [4,'a',3,5,6])
3
&gt;&gt;&gt; seq_in_seq([5,7],  [4,'a',3,5,6])
-1 # or None, or whatever
</code></pre>
<p>So far, I just rely on brute force and it seems slow, ugly, and clumsy.</p>
</div>
<div class="post-text" itemprop="text">
<p>I second the Knuth-Morris-Pratt algorithm. By the way, your problem (and the KMP solution) is exactly recipe 5.13 in <a href="https://rads.stackoverflow.com/amzn/click/com/0596007973" rel="nofollow noreferrer">Python Cookbook</a> 2nd edition. You can find the related code at <a href="http://code.activestate.com/recipes/117214/" rel="noreferrer">http://code.activestate.com/recipes/117214/</a></p>
<p>It finds <em>all</em> the correct subsequences in a given sequence, and should be used as an iterator:</p>
<pre><code>&gt;&gt;&gt; for s in KnuthMorrisPratt([4,'a',3,5,6], [5,6]): print s
3
&gt;&gt;&gt; for s in KnuthMorrisPratt([4,'a',3,5,6], [5,7]): print s
(nothing)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Here's a brute-force approach <code>O(n*m)</code> (similar to <a href="https://stackoverflow.com/questions/425604/best-way-to-determine-if-a-sequence-is-in-another-sequence-in-python#425764">@mcella's answer</a>). It might be faster than the Knuth-Morris-Pratt algorithm implementation in pure Python <code>O(n+m)</code> (see <a href="https://stackoverflow.com/questions/425604/best-way-to-determine-if-a-sequence-is-in-another-sequence-in-python#425838">@Gregg Lind answer</a>) for <em>small</em> input sequences.</p>
<pre><code>#!/usr/bin/env python
def index(subseq, seq):
    """Return an index of `subseq`uence in the `seq`uence.

    Or `-1` if `subseq` is not a subsequence of the `seq`.

    The time complexity of the algorithm is O(n*m), where

        n, m = len(seq), len(subseq)

    &gt;&gt;&gt; index([1,2], range(5))
    1
    &gt;&gt;&gt; index(range(1, 6), range(5))
    -1
    &gt;&gt;&gt; index(range(5), range(5))
    0
    &gt;&gt;&gt; index([1,2], [0, 1, 0, 1, 2])
    3
    """
    i, n, m = -1, len(seq), len(subseq)
    try:
        while True:
            i = seq.index(subseq[0], i + 1, n - m + 1)
            if subseq == seq[i:i + m]:
               return i
    except ValueError:
        return -1

if __name__ == '__main__':
    import doctest; doctest.testmod()
</code></pre>
<p>I wonder how large is the <em>small</em> in this case?</p>
</div>
<div class="post-text" itemprop="text">
<p>Same thing as string matching sir...<a href="http://www.ics.uci.edu/~eppstein/161/960227.html" rel="nofollow noreferrer">Knuth-Morris-Pratt string matching</a></p>
</div>
<div class="post-text" itemprop="text">
<p>A simple approach: Convert to strings and rely on string matching.</p>
<p>Example using lists of strings:</p>
<pre><code> &gt;&gt;&gt; f = ["foo", "bar", "baz"]
 &gt;&gt;&gt; g = ["foo", "bar"]
 &gt;&gt;&gt; ff = str(f).strip("[]")
 &gt;&gt;&gt; gg = str(g).strip("[]")
 &gt;&gt;&gt; gg in ff
 True
</code></pre>
<p>Example using tuples of strings:</p>
<pre><code>&gt;&gt;&gt; x = ("foo", "bar", "baz")
&gt;&gt;&gt; y = ("bar", "baz")
&gt;&gt;&gt; xx = str(x).strip("()")
&gt;&gt;&gt; yy = str(y).strip("()")
&gt;&gt;&gt; yy in xx
True
</code></pre>
<p>Example using lists of numbers:</p>
<pre><code>&gt;&gt;&gt; f = [1 , 2, 3, 4, 5, 6, 7]
&gt;&gt;&gt; g = [4, 5, 6]
&gt;&gt;&gt; ff = str(f).strip("[]")
&gt;&gt;&gt; gg = str(g).strip("[]")
&gt;&gt;&gt; gg in ff
True
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>&gt;&gt;&gt; def seq_in_seq(subseq, seq):
...     while subseq[0] in seq:
...         index = seq.index(subseq[0])
...         if subseq == seq[index:index + len(subseq)]:
...             return index
...         else:
...             seq = seq[index + 1:]
...     else:
...         return -1
... 
&gt;&gt;&gt; seq_in_seq([5,6], [4,'a',3,5,6])
3
&gt;&gt;&gt; seq_in_seq([5,7], [4,'a',3,5,6])
-1
</code></pre>
<p>Sorry I'm not an algorithm expert, it's just the fastest thing my mind can think about at the moment, at least I think it looks nice (to me) and I had fun coding it. ;-)</p>
<p>Most probably it's the same thing your brute force approach is doing.</p>
</div>
<div class="post-text" itemprop="text">
<p>Brute force may be fine for small patterns.</p>
<p>For larger ones, look at the <a href="http://en.wikipedia.org/wiki/Aho-Corasick_algorithm" rel="nofollow noreferrer">Aho-Corasick algorithm</a>.</p>
</div>
<div class="post-text" itemprop="text">
<p>Here is another KMP implementation:</p>
<pre><code>from itertools import tee

def seq_in_seq(seq1,seq2):
    '''
    Return the index where seq1 appears in seq2, or -1 if 
    seq1 is not in seq2, using the Knuth-Morris-Pratt algorithm

    based heavily on code by Neale Pickett &lt;neale@woozle.org&gt;
    found at:  woozle.org/~neale/src/python/kmp.py

    &gt;&gt;&gt; seq_in_seq(range(3),range(5))
    0
    &gt;&gt;&gt; seq_in_seq(range(3)[-1:],range(5))
    2
    &gt;&gt;&gt;seq_in_seq(range(6),range(5))
    -1
    '''
    def compute_prefix_function(p):
        m = len(p)
        pi = [0] * m
        k = 0
        for q in xrange(1, m):
            while k &gt; 0 and p[k] != p[q]:
                k = pi[k - 1]
            if p[k] == p[q]:
                k = k + 1
            pi[q] = k
        return pi

    t,p = list(tee(seq2)[0]), list(tee(seq1)[0])
    m,n = len(p),len(t)
    pi = compute_prefix_function(p)
    q = 0
    for i in range(n):
        while q &gt; 0 and p[q] != t[i]:
            q = pi[q - 1]
        if p[q] == t[i]:
            q = q + 1
        if q == m:
            return i - m + 1
    return -1
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I'm a bit late to the party, but here's something simple using strings:</p>
<pre><code>&gt;&gt;&gt; def seq_in_seq(sub, full):
...     f = ''.join([repr(d) for d in full]).replace("'", "")
...     s = ''.join([repr(d) for d in sub]).replace("'", "")
...     #return f.find(s) #&lt;-- not reliable for finding indices in all cases
...     return s in f
...
&gt;&gt;&gt; seq_in_seq([5,6], [4,'a',3,5,6])
True
&gt;&gt;&gt; seq_in_seq([5,7], [4,'a',3,5,6])
False
&gt;&gt;&gt; seq_in_seq([4,'abc',33], [4,'abc',33,5,6])
True
</code></pre>
<p><br/>
As noted by <strong>Ilya V. Schurov</strong>, the <strong>find</strong> method in this case will not return the correct indices with multi-character strings or multi-digit numbers.</p>
</div>
<div class="post-text" itemprop="text">
<p>Another approach, using sets:</p>
<pre><code>set([5,6])== set([5,6])&amp;set([4,'a',3,5,6])
True
</code></pre>
</div>
<span class="comment-copy">Note that the KMP implementation given on code.activestate was demostrably slower by 30-500 times for some (perhaps unrepresentative input). Benchmarking to see if dumb built-in methods outperform seems to be a good idea!</span>
<span class="comment-copy">KMP is known to be about twice as slow as the naive algorithm in practice. Hence, for most purposes it’s <i>completely</i> inappropriate, despite its good asymptotic worst-case runtime.</span>
<span class="comment-copy">I like it! For quick &amp; dirty stuff, anyway. Generally:  <code>def is_in(seq1, seq2):     return str(list(seq1))[1:-1] in str(list(seq2))[1:-1]</code>  Not a good way to find the index of the match, I guess.</span>
<span class="comment-copy">It is nice an clean, but brute-forcy --&gt;  O(mn)</span>
<span class="comment-copy">Aho-Corasick would be great.  I'm specifically looking for python, or pythonish solutions... so if there were an implementation, that would be great.  I'll poke around.</span>
<span class="comment-copy">The <code>tee</code> calls don't seem to be good for anything since the other element in tee's output 2-tuple is ignored. <code>seq1</code> and <code>seq2</code> are each copied to two new generators, one of which gets instantiated into a list, and the other of which gets ignored.</span>
<span class="comment-copy">This solution is not reliable in case elements of sequences have non-unique lenghs: it become not obvious how to translate index returned to index in initial sequences. Note also that backtick for <code>`d`</code> syntax is deprecated as for Python 3 and discouraged.</span>
<span class="comment-copy">example of non reliability even with all same sizes : sub='ab', full='aa','bb'</span>
<span class="comment-copy">Merely finds out whether the set is a subset of the sequence. Not whether it's actually in that order in the sequence. <code>set([5,6])== set([5,6])&amp;set([4,'a',5,4,6])</code> returns <code>True</code></span>
<span class="comment-copy">that could be a first, fast test however : check that all elements are in the full list.</span>
<div class="post-text" itemprop="text">
<p>I have my own exception classes inheriting from <code>Exception</code> class. I could check if type is <code>in {..my exceptions list..}</code>, but that seems problematic in my case. Is there any other way of checking if the exception is user-defined or Python's built-in exception. Thank you!</p>
<p>EDIT: The problem is that others can write their own exceptions or rename existing exceptions in their files, which I can't possibly keep track of. I  need to log built-in exceptions, and ignore exceptions thrown because of user's fault. I need the checking in except block</p>
<pre><code>try:
    # something
except Exception as god_knows_what_ex:
    # check if built-in
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could create your own custom exception class that inherits from Exception, and have your current exception classes inherit from that one.</p>
<p>So basically:</p>
<pre><code>Exception
 - MyExceptionClass
    - MyExceptionClass1
    - MyExceptionClass2
 - Built-in exceptions
</code></pre>
<p>That way, you can check if an exception is an instance of your <code>MyExceptionClass</code>.</p>
<p>Then, you could do the following if you just want to know that thrown exception is user-defined:</p>
<pre class="lang-py prettyprint-override"><code>try:
    method_that_can_throw_an_exception()
except MyExceptionClass:
    print('User-defined exception thrown')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I suspect that this question is due to the fact that your code has the following anti-pattern:</p>
<pre><code>try:
    # bad code
except Exception as e:
    # catch all exceptions in the world, and try to
    # understand the type of e in superfluous ways
</code></pre>
<p>You should not (usually) check the <code>type</code> of the exception, instead you should use <code>except</code> with the minimal subset of relevant exception types:</p>
<p><br/></p>
<pre><code>try:
    # bad code
except (CustomException1, CustomException2):
    # handle exception
</code></pre>
<p>Or, if each exception type requires a different handling:</p>
<pre><code>try:
    # bad code
except CustomException1:
    # handle CustomException1
except CustomException2:
    # handle CustomException2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>A good design for this case is to define a base exception for your class. If someone wants to extend your module, make it crystal clear in your documentation that they have to use your exception type or extend it. Use the base class to create <code>UserException</code>. In the logging code, ignore <code>UserException</code> and log everything else.</p>
<p>Document this behavior.</p>
<p>Your approach probably won't work. You could start with this:</p>
<pre><code>ex.__class__.__module__
</code></pre>
<p>which will return <code>__builtin__</code> for predefined exceptions but not for those which are defined in the standard Python modules (*.py files in the library).</p>
<p>Also, how do you plan to support exceptions defined by other modules which users of your code have installed with <code>pip</code>?</p>
</div>
<div class="post-text" itemprop="text">
<p>Although the reasons of this question are questionable, here's an alternative that:</p>
<ul>
<li><strong>Doesn't work</strong> in <em>Python</em> terminal</li>
<li>Filters out everything that's not <strong>built-in</strong> (<a href="https://docs.python.org/3/library/exceptions.html" rel="nofollow noreferrer">[Python 3]: Built-in Exceptions</a>)</li>
</ul>
<p><em>code.py</em>:</p>
<pre class="lang-py prettyprint-override"><code>#!/usr/bin/env python3

import sys
import json


class UserError:
    pass


class UserException(BaseException):
    pass


def builtin_exc(exc_inst):
    return getattr(getattr(exc_inst, "__class__", None), "__module__", None) == "builtins"


def main():
    user_err = UserError()
    user_exc = UserException()
    base_exc = BaseException()
    exc = Exception()
    ni_err = NotImplementedError()
    jsdec_err = json.JSONDecodeError("", "", 0)
    for item in [user_err, user_exc, base_exc, exc, ni_err, jsdec_err]:
        print("'{:s}' is builtin: {:}".format(item.__class__.__name__, builtin_exc(item)))


if __name__ == "__main__":
    print("Python {:s} on {:s}\n".format(sys.version, sys.platform))
    main()
</code></pre>
<p><strong>Output</strong>:</p>
<blockquote>
<pre><code>[cfati@CFATI-5510-0:e:\Work\Dev\StackOverflow\q055262562]&gt; "e:\Work\Dev\VEnvs\py_064_03.06.08_test0\Scripts\python.exe" code.py
Python 3.6.8 (tags/v3.6.8:3c6b436a57, Dec 24 2018, 00:16:47) [MSC v.1916 64 bit (AMD64)] on win32

'UserError' is builtin: False
'UserException' is builtin: False
'BaseException' is builtin: True
'Exception' is builtin: True
'NotImplementedError' is builtin: True
'JSONDecodeError' is builtin: False
</code></pre>
</blockquote>
</div>
<span class="comment-copy">What's problematic about checking if it's in your exceptions list? I'd imagine that list can't be too long</span>
<span class="comment-copy">Unless your <code>userdefined exception</code> has some attributes that one can check, i'm not sure</span>
<span class="comment-copy">Alternatively, you can check that exception is built-in via <code>exc in {.. built-in exceptions list ..}</code></span>
<span class="comment-copy">@Sanyash Which is probably longer than the custom defined exceptions...</span>
<span class="comment-copy">Sounds like an XY problem. Why do you care whether the exception is built-in?</span>
<span class="comment-copy">Why would it beat the purpose DeepSpace?</span>
<span class="comment-copy">Does this offer a solution?</span>
<span class="comment-copy">@SargsyanGrigor Yes. Do not check the <code>type</code> of the exception ("<code>if type is in {..my exceptions list..}</code>". It makes no sense and exceptions are not meant to be used this way. Instead, only use the relevant exceptions in the <code>except</code> clause like my answer suggests</span>
<span class="comment-copy">@SargsyanGrigor See my updated answer</span>
<span class="comment-copy">@DeepSpace: Curious to know why that's considered an anti-pattern</span>
<span class="comment-copy">@fountainhead Because it catches all exceptions, which means this <code>except</code> clause will hide exceptions that you would like to know about. Besides, why reinvent a mechanism that exists out of the box? Further reading: <a href="https://realpython.com/the-most-diabolical-python-antipattern/" rel="nofollow noreferrer">realpython.com/the-most-diabolical-python-antipattern</a></span>
<span class="comment-copy">Doesn't work for exceptions defined in standard Python modules like <code>HTTPException</code> in httplib.</span>
<span class="comment-copy">@AaronDigulla: Is that a built in exception? (Hmm, I think the topic is "a bit" more complex than meets the eye).</span>
<span class="comment-copy">He said he wanted to filter out "ignore exceptions thrown because of user's fault". I think that means "everything but a small set". He probably wants to log ZIP and various IO exceptions that are derived from <code>Exception</code> but are defined in Python modules, not in C code.</span>
<div class="post-text" itemprop="text">
<p>I have an undirected network of nodes connected to each other in a mesh fashion (i.e degree of each node is &gt;= 2). I am trying to find a way to find the minimum number of nodes that connect to the other nodes in the network. </p>
<p>For example, if I have 10 nodes in my graph, and one of the nodes is connected to all of the other nodes, then I can directly say that node is the one connects all my graph and the minimum number of nodes to cover the connectivity of graph is 1. </p>
<p>But usually that's not the case as I need to find the other nodes manually. I am thinking that I can use the highest degree node (x for example) as the source to find the shortest paths to the other nodes using <code>nx.shortest_path(G, x)</code>. Then I can iterate over the shortest paths to find the other nodes. But this method is tedious and I am wondering if anyone got any other suggestion using the tools available in networkx to solve this optimally. </p>
</div>
<div class="post-text" itemprop="text">
<p>As it is mentioned here: <a href="https://networkx.github.io/documentation/stable/reference/algorithms/dominating.html" rel="nofollow noreferrer">https://networkx.github.io/documentation/stable/reference/algorithms/dominating.html</a> </p>
<blockquote>
<p>A dominating set for a graph with node set V is a subset D of V such that every node not in D is adjacent to at least one member of D </p>
</blockquote>
<pre><code> D= nx.dominating_set(G, x) # the node source here is optional
 print(D)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I am using pandas and trying to do an assignment using a nested loops. I iterate over a dataframe and then run a distance function if it meets a certain criteria. I am faced with two problems:</p>
<ol>
<li><p>SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame</p></li>
<li><p>Memory Error. It doesn't work on large datasets. I end up having to terminate the process. </p></li>
</ol>
<p>How should I change my solution to ensure it can scale with a larger dataset of 60,000 rows? </p>
<pre><code>for i, row in df.iterrows():
    listy = 0
    school = []
    if row['LS_Type'] == 'Primary (1-4)':
        a = row['Northing']
        b = row['Easting']
        LS_ID = row['LS_ID']
        for j, row2 in df.iterrows():
            if row2['LS_Type'] == 'Primary (1-8)':
                dist_km = distance(a,b, df.Northing[j], df.Easting[j])
                if (listy == 0):
                    listy = dist_km
                    school.append([df.LS_Name[j], df.LS_ID[j]])
                else:
                    if dist_km &lt; listy:
                        listy = dist_km
                        school[0] = [df.LS_Name[j], int(df.LS_ID[j])]
        df['dist_up_prim'][i] = listy
        df["closest_up_prim"][i] = school[0]

    else:
        df['dist_up_prim'][i] = 0
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The double for loop is what's killing you here. See if you can break it up into two separate apply steps.</p>
<p>Here is a toy example of using <code>df.apply()</code> and <code>partial</code> to do a nested for loop:</p>
<pre><code>import math
import pandas as pd
from functools import partial

df = pd.DataFrame.from_dict({'A': [1, 2, 3, 4, 5, 6, 7, 8],
                             'B': [1, 2, 3, 4, 5, 6, 7, 8]})

def myOtherFunc(row):
    if row['A'] &lt;= 4:

        return row['B']*row['A']

def myFunc(the_df, row):
    if row['A'] &lt;= 2:
        other_B = the_df.apply(myOtherFunc, axis=1)
        return other_B.mean()
    return pd.np.NaN

apply_myFunc_on_df = partial(myFunc, df)

df.apply(apply_myFunc_on_df, axis=1)
</code></pre>
<p>You can rewrite your code in this form, which will be much faster.</p>
</div>
<span class="comment-copy">You should use the df.apply function</span>
<span class="comment-copy">In general, if you use iterrows... stop, do something else.</span>
<span class="comment-copy">Did my answer below help you solve this problem?</span>
<div class="post-text" itemprop="text">
<p>So I'm trying to match a regular expression to a paragraph in order to do sentiment analysis, but tqdm is saying this could take about 300 hours. I was wondering if anyone has a critique on what I could do to improve the way my RE functions</p>
<p>I'm trying to match stem endings to negative words for this analysis. Here is a small snippet of the expression for the match. I'm only showing a small snippet because the entire expression contains about 2800 terms, and is set up entirely the same all the way through, hence the ellipses.</p>
<p><code>regex_neg = ((a lie)|(abandon)|(abas)|(abattoir)|(abdicat)|(aberra)|(abhor)|(abject)|(abnormal)|(abolish)|(abominab)|(abominat)|(abrasiv)|(absent)|(abstrus)|(absurd)|(abus)|(accident)|(accost)|(accursed)|(accusation)|(accuse)|(accusing)|(acerbi)|(ache)|(aching)|(achy)|(acomia)|(acrimon)|(adactylism)|(addict)|(admonish)|(admonition)|(adulterat)|(adultery)|(advers)|(affectation)|(affected)|(affected manner)|(afflict)|(affright)...)</code></p>
<p>Here is the function that I'm using to match the stems in the paragraphs</p>
<pre><code>def neg_stems(paragraph):
    stem_list = []
    i = " ".join(paragraph)
    for n in re.finditer(regex_neg, i):
        if n.group():
            stem_list.append(n.group())
    return json.dumps(stem_list)
</code></pre>
<p>And finally, here is just the general output that I'm getting</p>
<pre><code>neg_stems(["the king abdicated the throne in an argument where he was angry, but his son was pretty happy about it","I hate cats but love hedgehogs"])

&gt; ["abdicat", "argument", "anger", "hate"]
</code></pre>
<p>I'm just trying to count the number of negative words as defined by the semantic dictionary in <code>regex_neg</code>, but ~300 hours is just way too long, and even then, that's simply an estimate. </p>
<p>Does anyone have a suggestion on what I could do to try and speed this process up?</p>
<p>Thank you in advance!</p>
</div>
<span class="comment-copy">I can't post this as an answer, because the answer itself would be too broad, but one option to consider here would be to load your text(s) into a database which supports full text search.  Then, use FTS to find the stems in the text.  Python perhaps is not as well suited for this type of operation as a database.</span>
<span class="comment-copy">Looks like a plain-text search to me, are you sure you need a regex?</span>
<span class="comment-copy">I'm not sure regex is well-suited to this problem. Regex is <i>great</i> as a tokenizer, but as far as matching stems, a dictionary of values (or a <code>set</code>) might be the best bet here</span>
<span class="comment-copy"><a href="https://stackoverflow.com/questions/42742810/speed-up-millions-of-regex-replacements-in-python-3">This thread</a> is likely the answer. See <a href="https://stackoverflow.com/a/42789508/3832970">this post</a>.</span>
<span class="comment-copy">Ok, thank you for the input guys! I really don't need to use it as a regex, so I'll go about with plain text matching a see how that progresses instead!</span>
<div class="post-text" itemprop="text">
<p>I am playing a little with PrettyTable in Python and I noticed completely different behavior in Python2 and Python 3. Can somebody exactly explain me the difference in output? Nothing in docs gave me satisfied answer for that. But let's start with little code. Let's start with creating <em>my_table</em></p>
<pre><code>from prettytable import PrettyTable
my_table = PrettyTable()
my_table.field_name = ['A','B']
</code></pre>
<p>It creates two column table with column A and column B. Let's add on row to it, but assume that value in cell can have multi lines, separated by Python new line '\n' , as the example some properties of parameter from column A.</p>
<pre><code>row = ['parameter1', 'component: my_component\nname:somename\nmode: magic\ndate: None']
my_table.add_row(row)
</code></pre>
<p>Generally the information in row can be anything, it's just a string retrieved from other function. As you can see, it has '\n' inside. The thing that I don't completely understand is the output of print function. </p>
<p>I have in Python2</p>
<pre><code>print(my_table.get_string().encode('utf-8'))
</code></pre>
<p>Which have me output like this:</p>
<pre><code>+------------+-------------------------+
|  Field 1   |         Field 2         |
+------------+-------------------------+
| parameter1 | component: my_component |
|            |      name:somename      |
|            |       mode: magic       |
|            |        date: None       |
+------------+-------------------------+
</code></pre>
<p>But in Python3 I have:</p>
<p>+------------+-------------------------+
|  Field 1   |         Field 2         |
+------------+-------------------------+
| parameter1 | component: my_component |
|            |      name:somename      |
|            |       mode: magic       |
|            |        date: None       |
+------------+-------------------------+</p>
<p>If I completely removes the encode part, it seems that output looks ok on both version of Python.</p>
<p>So when I have</p>
<pre><code>print(my_table.get_string())
</code></pre>
<p>It works on Python3 and Python2. Should I remove the encode part from code? It is save to assume it is not necessary? Where is the problem exactly?</p>
</div>
<span class="comment-copy">Generally, it isn't useful to encode a string before passing it to <code>print()</code> in Python 3, because the resulting byte string is formatted using <code>repr</code>, ie. including quotes and escape sequences. This is different for Python 2, where <code>print</code> simply forwards byte strings literally.</span>
<span class="comment-copy">If your terminal is set up properly, you don't need to <code>.encode()</code> Unicode strings when printing in Python 2 either.</span>
<span class="comment-copy">@MarkTolonen what if not? How can I handle both versions in one way?</span>
<span class="comment-copy">Ok I will use 'six' library to handle both cases. Thanks for  comments</span>
<div class="post-text" itemprop="text">
<p>I did not find any solution to this problem yet.</p>
<p>I have a lot of Ethernet-Frames from an Device. In the Payload for example the Voltage measured. I can decode the Value easily with a lua dissector. But then i have to watch every Frame manually.</p>
<p>In Wireshark you can find an I/O Graph, but this only displayes the amount of incoming Frames. Is there any possibility to write an Python Script, that can add an graph with the Voltage Level over all Frames. Or anything else?</p>
<p>Thanks! </p>
</div>
<span class="comment-copy">Check the module <code>scapy</code> with some graph plotter ?</span>
<span class="comment-copy">I already use scapy, but if you have a pcap with a lot of packets, you can't load them in scapy.</span>
<div class="post-text" itemprop="text">
<p>So this code was originally one function and with help I have broken it into two separate functions but I am still struggling to get it to work.  Any guidance would be appreciated  </p>
<pre><code># -------------------------------------------
# Checks to see if listed folders exists and then deletes
# -------------------------------------------


def check_directory(path):
    # returns true if path is an existing directory
    return os.path.exists(path) and os.path.isdir(path)


dirs_to_delete = [
    'C:\Folder Here',
    'C:\Folder Here1',
    'C:\Folder Here2',
    'C:\Folder Here3'

 ]


def remove_directory(pathlist):
    for path in pathlist:
        if check_directory(path):
            shutil.rmtree(path)
            print(colored('Found ' + path + ' removing', 'green'))
</code></pre>
<p>I am calling this function with </p>
<pre><code>remove_directory()     #Checks and Removes directories listed above
</code></pre>
<p>I am getting the following error when ran </p>
<pre><code>remove_directory()  #Checks and Removes directories listed above
TypeError: remove_directory() missing 1 required positional argument: 'pathlist'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You need to pass <code>dirs_to_delete</code> to the function:</p>
<p><code>remove_directory(dirs_to_delete)</code></p>
</div>
<div class="post-text" itemprop="text">
<p>You have defined <code>remove_directory</code> to take a single positional arg, <code>pathlist</code>, however, that does <em>not</em> take a value of the variable <code>pathlist</code> in global scope:</p>
<pre class="lang-py prettyprint-override"><code>s = 100

def print_val(s):
    print(s)

# I have not given it a positional arg, so s isn't defined
print_val()
# raises TypeError because the scope inside the function
# doesn't know what s is

# Now i give it that value
print_val(s)
# 100
</code></pre>
<p>So for your problem, you need to pass that arg</p>
<pre class="lang-py prettyprint-override"><code># This is how you call the function in your script
remove_directory(pathlist)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><strong>Debugging</strong>:</p>
<pre><code>TypeError: remove_directory() missing 1 required positional argument: 
</code></pre>
<p><strong>Because</strong>:</p>
<p>The function <code>remove_directory()</code> expects a param in this case perhaps the <code>dirs_to_delete</code> </p>
<p><strong>Hence</strong>:</p>
<pre><code>def check_directory(path):
    # returns true if path is an existing directory
    return os.path.exists(path) and os.path.isdir(path)


dirs_to_delete = [
    'C:\Folder Here',
    'C:\Folder Here1',
    'C:\Folder Here2',
    'C:\Folder Here3'

 ]

def remove_directory(pathlist):
    for path in pathlist:
        if check_directory(path):
            shutil.rmtree(path)
            print(colored('Found ' + path + ' removing', 'green'))

remove_directory(dirs_to_delete)   # pass the list to the function here
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>In your post it appears that you are calling <code>remove_directory</code> without passing your list as desired,<br/>
Change your call to <code>remove_directory()</code> to <code>remove_directory(dirs_to_delete)</code></p>
</div>
<div class="post-text" itemprop="text">
<p>The remove_directory function expects the parameter <code>pathlist</code></p>
<p>Since you did not add a default value for <code>pathlist</code>, calling <code>remove_directory()</code> fails.</p>
<p>Try:</p>
<pre class="lang-py prettyprint-override"><code>def remove_directory(pathlist=[]):
    for path in pathlist:
        if check_directory(path):
            shutil.rmtree(path)
            print(colored('Found ' + path + ' removing', 'green'))
</code></pre>
<p>or supply a list when calling the function:</p>
<pre class="lang-py prettyprint-override"><code>remove_directory([])
</code></pre>
</div>
<span class="comment-copy">you need to pass <code>dirs_to_delete</code> to <code>remove_directory()</code></span>
<span class="comment-copy">You need to pass an argument to the function <code>remove_directory()</code></span>
<span class="comment-copy">Try: <code>remove_directory(dirs_to_delete)</code></span>
<div class="post-text" itemprop="text">
<p>I want to programatically mirror AWS IAM Roles to my SAML federation, using a lambda, with lambda <a href="https://github.com/b-b3rn4rd/aws-saml-azuread" rel="nofollow noreferrer">like this developer</a> </p>
<p>I want to verify what the least privilege access the credentials for the automation software need to have in Azure, so i tried a simple python script to mimic this (see below).</p>
<p>I am able to update the value and retrieve the updated value, but when I go into the Azure portal and look at the manifest file, it has not changed.</p>
<p>Now I am wondering why this is the case: Is there caching going on in the Python CLI for Azure? Am I not catching some underlying errors in the right way?</p>
<pre><code>from azure.graphrbac import GraphRbacManagementClient
from azure.common.credentials import UserPassCredentials
from azure.graphrbac.models.app_role import AppRole

credentials = UserPassCredentials(
            username='my-user@company',
            password='my-ad-password',
            resource="https://graph.windows.net"
    )

tenant_id = "guid-of-my-company-tenant-from-ad-admins"
graphrbac_client = GraphRbacManagementClient(
    credentials,
    tenant_id
)
oid = "guid-of-object-id"
principal = graphrbac_client.service_principals.get(object_id=oid)
print('display_name: {}'.format(principal.display_name))
try:
    for role in principal.app_roles:
        if( role.display_name == 'AWSRoleInManifestFile'):
            print("is_enabled: ", role.is_enabled)

    # Verify update works by changing one role to isEnabled = false
    for role in principal.app_roles:
        if( role.display_name == 'AWSRoleInManifestFile'):
            role.is_enabled = False

    # Update using the api.
    retval = graphrbac_client.service_principals.update(oid, principal)
except Exception as e:
    print("Exception occured.", e)

# retrieve the values again to see if the change is done.
principal = graphrbac_client.service_principals.get(object_id=oid)

for role in principal.app_roles:
    if( role.display_name == 'AWSRoleInManifestFile'):
        print("role.is_enabled: ", role.is_enabled)
print("done.")
</code></pre>
<p>Using the raw parameter for the update call, I can see that it is a PATCH request that is sent, and the response is 204. </p>
<pre><code>retval = graphrbac_client.service_principals.update(object_id=oid, parameters=principal, custom_headers=None, raw=True)
</code></pre>
</div>
<span class="comment-copy">This is not an issue of Python, but instead something within the Azure portal. I was able to verify this occurs with the REST api provider by the <a href="https://graphexplorer.azurewebsites.net/" rel="nofollow noreferrer">graphexplorer.azurewebsites.net</a> using GET and PATCH respectively on <a href="https://graph.windows.net/MY_TENTANT_ID/servicePrincipals/MY_APP_ID" rel="nofollow noreferrer">graph.windows.net/MY_TENTANT_ID/servicePrincipals/MY_APP_ID</a></span>
<div class="post-text" itemprop="text">
<p>My understanding is that <em>MagicMock</em> is a superset of <em>Mock</em> that automatically does "magic methods" thus seamlessly providing support for lists, iterations and so on... Then what is the reason for plain <em>Mock</em> existing? Isn't that just a stripped down version of <em>MagicMock</em> that can be practically ignored? Does <em>Mock</em> class know any tricks that are not available in <em>MagicMock</em>?</p>
</div>
<div class="post-text" itemprop="text">
<h3>What is the reason for plain <em>Mock</em> existing?</h3>
<p>Mock's author, Michael Foord, addressed <a href="http://pyvideo.org/video/392/pycon-2011--testing-with-mock">a very similar question at Pycon 2011 (31:00)</a>:</p>
<blockquote>
<p><strong>Q:</strong> Why was MagicMock made a separate thing rather than just folding the ability into the default mock object?</p>
<p><strong>A:</strong> One reasonable answer is that the way MagicMock works is that it preconfigures all these protocol methods by creating new Mocks and
  setting them, so if every new mock created a bunch of new mocks and
  set those as protocol methods and then all of those protocol methods
  created a bunch more mocks and set them on their protocol methods,
  you've got infinite recursion...</p>
<p>What if you want accessing your mock as a container object to be an
  error -- you don't want that to work? If every mock has automatically
  got every protocol method, then it becomes much more difficult to do
  that. And also, MagicMock does some of this preconfiguring for you,
  setting return values that might not be appropriate, so I thought it
  would be better to have this convenience one that has everything
  preconfigured and available for you, but you can also take a ordinary
  mock object and just configure the magic methods you want to exist...</p>
<p>The simple answer is: just use MagicMock everywhere if that's the
  behavior you want.</p>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>With Mock you <em>can</em> mock magic methods but you have to define them. MagicMock has <a href="https://docs.python.org/3/library/unittest.mock.html#unittest.mock.MagicMock" rel="nofollow noreferrer">"default implementations of most of the magic methods."</a>.</p>
<p>If you don't need to test any magic methods, Mock is adequate and doesn't bring a lot of extraneous things into your tests. If you need to test a lot of magic methods MagicMock will save you some time.</p>
</div>
<div class="post-text" itemprop="text">
<p>To begin with, <code>MagicMock</code> is a subclass of <code>Mock</code>.</p>
<pre><code>class MagicMock(MagicMixin, Mock)
</code></pre>
<p>As a result, MagicMock provides everything that Mock provides and more.  Rather than thinking of Mock as being a stripped down version of MagicMock, think of MagicMock as an extended version of Mock.  This should address your questions about why Mock exists and what does Mock provide on top of MagicMock.</p>
<p>Secondly, MagicMock provides default implementations of many/most magic methods, whereas Mock doesn't.  See <a href="http://www.voidspace.org.uk/python/mock/magicmock.html#mock.MagicMock" rel="noreferrer">here</a> for more information on the magic methods provided.</p>
<p>Some examples of provided magic methods:</p>
<pre><code>&gt;&gt;&gt; int(Mock())
TypeError: int() argument must be a string or a number, not 'Mock'
&gt;&gt;&gt; int(MagicMock())
1
&gt;&gt;&gt; len(Mock())
TypeError: object of type 'Mock' has no len()
&gt;&gt;&gt; len(MagicMock())
0
</code></pre>
<p>And these which may not be as intuitive (at least not intuitive to me):</p>
<pre><code>&gt;&gt;&gt; with MagicMock():
...     print 'hello world'
...
hello world
&gt;&gt;&gt; MagicMock()[1]
&lt;MagicMock name='mock.__getitem__()' id='4385349968'&gt;
</code></pre>
<p>You can "see" the methods added to MagicMock as those methods are invoked for the first time:</p>
<pre><code>&gt;&gt;&gt; magic1 = MagicMock()
&gt;&gt;&gt; dir(magic1)
['assert_any_call', 'assert_called_once_with', ...]
&gt;&gt;&gt; int(magic1)
1
&gt;&gt;&gt; dir(magic1)
['__int__', 'assert_any_call', 'assert_called_once_with', ...]
&gt;&gt;&gt; len(magic1)
0
&gt;&gt;&gt; dir(magic1)
['__int__', '__len__', 'assert_any_call', 'assert_called_once_with', ...]
</code></pre>
<p>So, why not use MagicMock all the time?</p>
<p>The question back to you is: Are you okay with the default magic method implementations?  For example, is it okay for <code>mocked_object[1]</code> to not error?  Are you okay with any unintended consequences due to the magic method implementations being already there?</p>
<p>If the answer to these questions is a yes, then go ahead and use MagicMock.  Otherwise, stick to Mock.</p>
</div>
<div class="post-text" itemprop="text">
<p>This is what <a href="http://docs.python.org/dev/library/unittest.mock-examples.html" rel="noreferrer">python's official documentation</a>
says:</p>
<blockquote>
<p>In most of these examples the Mock and MagicMock classes are interchangeable. As the MagicMock is the more capable class it makes a sensible one to use by default.</p>
</blockquote>
</div>
<span class="comment-copy">I think a better answer is: Use MagicMock if you know what you're doing, otherwise use Mock.</span>
<span class="comment-copy">Sure enough I've already read the documentation. That doesn't answer my question - why bother with plain Mock if MagicMock does exactly the same plus much more? I don't see any extraneous things things in my tests - just use the different name and that's it. So where is the catch?</span>
<span class="comment-copy">Tests should be minimal and mock objects should be minimally functional so that you are sure exactly what you're testing. If you use MagicMock just because is does more but you're not explicitly testing all that "more" you run the risk of a test failing because of a default MagicMock behavior. This failure might reflect something about MagicMock's defaults more than the the thing it's supposed to mock. Even worse, you run the risk of a test <i>succeeding</i> when it should have failed. The risk is small but if this happens it will waste a lot of your time.</span>
<span class="comment-copy">I think of it like using plain JS vs Jquery. Sure, you <i>could</i> use Jquery to do all your JS, but in some cases, you just want to use the very minimum tool required to get the job done. I find those cases are usually either the extremely simple or the extremely complex.</span>
<div class="post-text" itemprop="text">
<p>I have a data.json file, which looks like this:</p>
<pre><code>["{\"Day\":\"Today\",\"Event\":\"1\", \"Date\":\"2019-03-20\"}"]
</code></pre>
<p>I am trying to get "Event" from this file using python and miserably failing at this.</p>
<pre><code>with open('data.json', 'r') as json_file:
    data = json.load(json_file)
    print (data['Event'])
</code></pre>
<p>I get the following error:</p>
<p><strong>TypeError: list indices must be integers or slices, not str</strong></p>
<p>And even when I try </p>
<pre><code>print (data[0]['Event'])
</code></pre>
<p>then I get this error:</p>
<p><strong>TypeError: string indices must be integers</strong></p>
<p>One more thing:</p>
<pre><code>print(type(data))
</code></pre>
<p>gives me "list"</p>
<p>I have searched all over and have not found a solution to this. I would really appreciate your suggestions.</p>
</div>
<div class="post-text" itemprop="text">
<p>You could use the <code>ast</code> module for this:</p>
<pre class="lang-py prettyprint-override"><code>import ast

mydata = ["{\"Day\":\"Today\",\"Event\":\"1\", \"Date\":\"2019-03-20\"}"]
data = ast.literal_eval(mydata[0])
data
{'Day': 'Today', 'Event': '1', 'Date': '2019-03-20'}

data['Event']
'1'
</code></pre>
<h2>Edit</h2>
<p>Your original code <em>does</em> load the data into a list structure, but only contains a single string entry inside that list, despite proper json syntax. <code>ast</code>, like <code>json</code>, will parse that string entry into a python data structure, <code>dict</code>. </p>
<p>As it sits, when you try to index that list, it's not the same as calling a key in a dict, hence the <code>slices cannot be str</code>:</p>
<pre class="lang-py prettyprint-override"><code>alist = [{'a':1, 'b':2, 'c':3}]
alist['a']
TypeError

# need to grab the dict entry from the list
adict = alist[0]
adict['a']
1
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You need to convert the elements in data to dict using json module.</p>
<p><strong>Ex:</strong></p>
<pre><code>import json

with open(filename) as infile:
    data = json.load(infile)
for d in data:
    print(json.loads(d)['Event'])
</code></pre>
<hr/>
<p><strong>Or:</strong></p>
<pre><code>data = list(map(json.loads, data))
print(data[0]["Event"])
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>1
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Your problem is that you are parsing it as a list that consists of a single element that is a string. </p>
<pre class="lang-py prettyprint-override"><code>["{\"Day\":\"Today\",\"Event\":\"1\", \"Date\":\"2019-03-20\"}"]
</code></pre>
<p>See how the entire content of the list is surrounded by <code>"</code> on either side and every other <code>"</code> is preceded by a <code>\</code>? The slash generally means to ignore the special meaning the following character might have, but interpret it as purely a string. </p>
<p>If you have control over the file's contents, the easiest solution would be to adjust it. You will want it to be in a format like this:</p>
<pre class="lang-py prettyprint-override"><code>[{"Day":"Today", "Event": "1", "Date": "2019-03-20"}]
</code></pre>
<p>Edit: As others have suggested, you can also parse it in its current state. Granted, cleaning the data is tedious, but oftentimes worth the effort. Though this may not be one of those cases. I'm leaving this answer up anyway because it may help with explaining why OPs initial attempt did not work, and why he received the error messages he got.</p>
</div>
<span class="comment-copy">with open('data.json', 'r') as json_file:     data = eval(json.load(json_file))     print (data['Event'])</span>
<span class="comment-copy">@PrasPJ You didn't <code>import json</code>, you really shouldn't use <code>eval</code> on something trivial like this, and it won't even work because you're not holding a string but a list with a string in it.</span>
<span class="comment-copy">It's worth explaining that the reason the original code doesn't work is that the value inside the list is just a string, even if it does contain Python/JSON syntax.</span>
<span class="comment-copy">@PeterWestlake added the explanation in newest edit</span>
<div class="post-text" itemprop="text">
<p>maybe this tiltle cannot explain my questions, here has an example.</p>
<p>There are three python files, <code>demo.py</code>、<code>fun.py</code>、<code>config.py</code>.</p>
<p>in the <code>config.py</code> file:</p>
<pre><code>from easydict import EasyDict as edict

__C = edict()
cfg = __C
__C.TRAIN = edict()
__C.TRAIN.LEARNING_RATE = 0.001
</code></pre>
<p>in the <code>fun.py</code>:</p>
<pre><code>from config import cfg
def function():
    print(cfg.TRAIN.LEARNING_RATE)
    cfg.TRAIN.LEARNING_RATE = 1
    pass
</code></pre>
<p>in the <code>demo.py</code>:</p>
<pre><code>from config import cfg
from fun import function

cfg.TRAIN.LEARNING_RATE = 0.1

function()

print(cfg.TRAIN.LEARNING_RATE)
</code></pre>
<p>run the <code>demo.py</code>,results in :</p>
<pre><code>0.1
1
</code></pre>
<p>I am curious about why <code>fun.py</code> can change the values in the <code>demo.py</code> although they import a same config file.</p>
</div>
<div class="post-text" itemprop="text">
<p>Well, you answered your own question: they import the same config file.</p>
<p>Keep in mind you're not changing a value in <code>demo.py</code> or <code>fun.py</code>. Instead, when you do <code>cfg.TRAIN.LEARNING_RATE = 0.1</code> you're changing the variable in memory <code>cfg</code>, which is tied to <code>config.py</code>. </p>
<p>Since both <code>demo.py</code> and <code>fun.py</code> import the same <code>config.py</code>, the interpreter loads the whole thing into memory once and gives those other two files access to the <code>cfg</code> variable stored in memory. In other words, they're both manipulating the same variable, which they accessed independently.</p>
<p>(The reason the program never outputs <code>0.001</code> is that, while <code>cfg.TRAIN.LEARNING_RATE</code> is initialized to that value as soon as you load <code>config.py</code> into memory for the first time, you never actually print it before reassigning it to <code>0.1</code>.)</p>
</div>
<span class="comment-copy">It is not as obvious as you suggest it, if I change the files to : <code>config.py</code> file:      var = 0.001  <code>fun.py</code>:      from config import var     def function():         print(var)         var = 1  <code>demo.py</code>:      from config import var     from fun import function      var = 0.1      function()      print(var)  I get :     UnboundLocalError: local variable 'var' referenced before assignment Adding a <code>global var</code> to <code>fun.py</code> give the expected result.</span>
<div class="post-text" itemprop="text">
<p>I'm trying to figure out how to create unit tests for a function, which behavior is based on a third party service.</p>
<p>Suppose a function like this:</p>
<pre><code>def sync_check():
    delta_secs = 90
    now = datetime.datetime.now().utcnow()
    res = requests.get('&lt;url&gt;')
    alert = SlackAlert()
    last_value = res[-1]['date'] # Last element of the array is the most recent
    secs = (now - last_value).seconds

    if secs &gt;= delta_secs:
        alert.notify("out of sync. Delay: {} seconds".format(secs))
    else:
        alert.notify('in sync')
</code></pre>
<p>What's best practice to write unit test for this function? I need to test both if and else branches, but this depends on the third party service.</p>
<p>The first thing that come to my mind is to create a fake webserver and point to that one (changing url) but this way the codebase would include testing logic, like:</p>
<pre><code>if test:
    url = &lt;mock_web_server_url&gt;
else:
    url = &lt;third_party_service_url&gt;
</code></pre>
<p>Moreover, unit testing would trigger slack alerts, which doesn't have to happen.</p>
<p>So there I shoulde change again the codebase like:</p>
<pre><code>if secs &gt;= delta_secs:
    if test:
        logging.debug("out of sync alert sent - testing mode")
    else:
        alert.notify("out of sync. Delay: {} seconds".format(secs))
else:
    if test:
        logging.debug("in sync alert sent - testing mode")
    else:
        alert.notify('in sync')
</code></pre>
<p>Which I don't really like.</p>
<p>Am I missing any design to solve this problem?</p>
</div>
<div class="post-text" itemprop="text">
<p>Check out <a href="https://stackoverflow.com/questions/130794/what-is-dependency-injection">Dependency Injection</a> to test code that depends on third party services, without having to check whether you're running in test mode, like in your example. The basic idea is to have the slack alert service be an argument of your function, so for unit testing you can use a fake service that acts the way you want it to for each test. </p>
<p>Your code would end up looking something like this:</p>
<pre><code>def sync_check(alert):
    delta_secs = 90
    now = datetime.datetime.now().utcnow()
    res = requests.get('&lt;url&gt;')
    last_value = res[-1]['date'] # Last element of the array is the most recent
    secs = (now - last_value).seconds

    if secs &gt;= delta_secs:
        alert.notify("out of sync. Delay: {} seconds".format(secs))
    else:
        alert.notify('in sync')
</code></pre>
<p>and in a test case, you could have your alert object be something as simple as:</p>
<pre><code>class TestAlert:
    def __init__(self):
        self.message = None

    def notify(self, message):
        self.message = message
</code></pre>
<p>You could then test your function by passing on an instance of your TestAlert class, and check the logged output if you want to, by accessing the <code>message</code> attribute. This code would not access any third party services.</p>
<pre><code>def test_sync_check():
    alert = TestAlert()
    sync_check(alert)
    assert alert.message == 'in sync'
</code></pre>
</div>
<span class="comment-copy">If you're unit testing, you can mock out <code>SlackAlert</code> entirely, using e.g. <a href="https://docs.python.org/3/library/unittest.mock.html" rel="nofollow noreferrer"><code>unittest.mock</code></a>. You could also consider injecting the alert handler, rather than instantiating it inside that method, to reduce coupling. For a more integration-based test, look into something like <a href="https://github.com/getsentry/responses" rel="nofollow noreferrer"><code>responses</code></a>, depending on what client that library uses, for mocking out the network layer. You certainly <b>should not</b> have <code>if test:</code> logic inside your production code.</span>
<div class="post-text" itemprop="text">
<p>I want that when I have changed a line-edit another function gets called, and in that function there is an if-else with <code>Qt.Checked</code>. When I edit the line-edit and then check the checkbox, the text from the line-edit gets written to a variable. But then when I change the line-edit again, it just runs the <code>else</code> in the change function, even if the checkbox is checked. I don't understand why.</p>
<p>Checkbox: </p>
<pre><code>self.filenamecheck.stateChanged.connect(self.changeFileName)
</code></pre>
<p>LineEdit:</p>
<pre><code>self.nameLine.textEdited.connect(self.onChangeNameLine)
</code></pre>
<p>Functions:</p>
<pre><code>def onChangeNameLine(self,state):
    self.changeFileName(self)
    print("Filename changed")

def changeFileName(self, state):
    name = self.nameLine.text()
    print("Called change function")
    if state == Qt.Checked:
        self.filenameLine.setText(name)
        print("called change if")
    else:
        self.filenameLine.setText('')
        print("called change else")
</code></pre>
<p>Thank's for your help!</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>def onChangeNameLine(self):
    self.changeFileName()
    print("Filename changed")

def changeFileName(self):
    name = self.nameLine.text()
    print("Called change function")
    if self.filenamecheck.isChecked():
        self.filenameLine.setText(name)
        print("called change if")
    else:
        self.filenameLine.setText('')
        print("called change else")
</code></pre>
</div>
<span class="comment-copy">change <code>self.filenameLine.setText('')</code> to <code>self.filenameLine.clear()</code>, is more readable</span>
<div class="post-text" itemprop="text">
<p>When running the following code, I get the error <code>"Python TypeError: unsupported operand type(s) for -: 'int' and 'function'"</code> . Even after researching similar questions, I cannot solve this problem, so I would greatly appreciate any help! Here is the section of code I'm having trouble with:</p>
<pre><code> r = 1
    def simpson_2var(a,b,f,N,z2):         
        h = (b-a) / (N)
        s = f(a, z2) + f(b, z2)
        for i in range(1,N):
            if(i%2 ==0):
                s += 2*(f(a + i*h, z2))
            else:
                s += 4*(f(a + i*h, z2))
        s *= (h/3.0) 
        return s
    z2 = np.linspace(-10,10,1000,0)


 def f(R,z2):
    return (R * z2) / ( ( z2**2 + R**2) ** (3/2))
E2 = simpson_2var(0,1,f,1000,z2)
    r = 1

    z3 = np.linspace(-4*r, 4*r, 1000, 0)

    w = simpson_2var(f,0, r, 1000, z3)

    plt.plot(w, z3, label = "R=1", color = "cyan")

    plt.legend()

    plt.xlabel("Electric Field")

    plt.ylabel("distance to zz axis'")

    plt.grid()

    plt.show()
</code></pre>
<p>This is the error I get (here I left the comments for line numbering reasons):</p>
<pre><code>---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
&lt;ipython-input-48-3bfacd988809&gt; in &lt;module&gt;
      1 r = 1
      2 z3 = np.linspace(-4*r, 4*r, 1000, 0)
----&gt; 3 w = simpson_2var(f,0, r, 1000, z3)
      4 plt.plot(w, z3, label = "R=1", color = "cyan")
      5 plt.legend()

&lt;ipython-input-42-7c0c9c6d708d&gt; in simpson_2var(a, b, f, N, z2)
      4                                     # de 1. Usamos esta função logo neste exercício, para função com
      5                                     # variáveis R e z2
----&gt; 6     h = (b-a) / (N)
      7     s = f(a, z2) + f(b, z2)
      8     for i in range(1,N):

TypeError: unsupported operand type(s) for -: 'int' and 'function'
</code></pre>
<p>Once more, I'd really appreciate any help provided. Thank you.</p>
</div>
<div class="post-text" itemprop="text">
<p>Your arguments do not seem to correspond between <code>w = simpson_2var(f,0, r, 1000, z3)</code> and <code>def simpson_2var(a,b,f,N,z2)</code>.</p>
<p>Try using named arguments when calling functions:</p>
<p><code>w = simpson_2var(a=0, b=r, f=f, N=1000, z2=z3)</code></p>
</div>
<div class="post-text" itemprop="text">
<p>You error comes from the line <code>h = (b-a) / (N)</code>, where <code>b=0</code> but <code>a</code> is a function, not a value. So, fix the function call in </p>
<pre><code>w = simpson_2var(f,0, r, 1000, z3)
</code></pre>
</div>
<span class="comment-copy">you've defined <code>f</code> to be a function somewhere or assigned <code>f</code> to a function, check your code</span>
<span class="comment-copy"><code>a</code> is a function. You can't the function <code>a</code> from integer <code>b</code>. <code>a</code> here is the first argument to <code>simpson_2var()</code>, so <code>f</code>, which you didn't share.</span>
<span class="comment-copy">I have edited the code section to include the f function. I didn't include it at first because I didn't think it would be relevant, sorry!</span>
<span class="comment-copy">Wow, that worked, thank you so much!</span>
<span class="comment-copy">Please mark this answer as the solution if you're satisfied with it :)</span>
<div class="post-text" itemprop="text">
<p>I'm working with the .xlsx file and it has a tab with a workhsheet table where lots of conditional formatting are used. From time to time I need to append this table with new rows. 
My plan is to use python openpyxl (or other package) to append this table. 
so far I could identify this table as </p>
<pre><code>from openpyxl import load_workbook
wb=load_workbood(myfile)
ws=wb['mytab']
tab = wb.ws._tables[0]
</code></pre>
<p>Can I use something like .append() method or change data of this table to add more rows to it? 
My goal is to keep the formatting.</p>
<p>I've already tried this approach - 
<a href="https://stackoverflow.com/questions/48657867/manipulate-existing-excel-table-using-openpyxl">Manipulate existing excel table using openpyxl</a> and it doesn't' work for me</p>
<p>I'm using openpyxl 2.6.1</p>
<p>Regards,
Pavel</p>
</div>
<span class="comment-copy">You just need to change the <code>ref</code> on the table.</span>
<span class="comment-copy">I tried it. How to deal with style then? I need to keep the formatting.</span>
<div class="post-text" itemprop="text">
<p>I want to use TensorFlow to calculate hashcode‘s mAP （mean average precision）， but I don‘t know how to use tensor calculations directly.</p>
<h2>The code which using NumPy is the following:</h2>
<pre><code>import numpy as np
import time
import os
# read train and test binarayCode
CURRENT_DIR = os.getcwd()



def getCode(train_codes,train_groudTruth,test_codes,test_groudTruth):

    line_number = 0
    with open(CURRENT_DIR+'/result.txt','r') as f:
        for line in f:
            temp = line.strip().split('\t')
            if line_number &lt; 10000:
                test_codes.append([i if i==1 else -1  for i in map(int, list(temp[0]))])
                list2 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                list2[int(temp[1])] = 1
                test_groudTruth.append(list2) # get test ground truth(0-9)
            else:
                train_codes.append([i if i==1 else -1  for i in map(int, list(temp[0]))]) # change to -1, 1
                list2 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
                list2[int(temp[1])] = 1
                train_groudTruth.append(list2) # get test ground truth(0-9)

            line_number += 1
    print 'read data finish'

def getHammingDist(code_a,code_b):
    dist = 0
    for i in range(len(code_a)):
         if code_a[i]!=code_b[i]:
             dist += 1
    return dist 


if __name__ =='__main__':
    print getNowTime(),'start!'

    train_codes = []
    train_groudTruth =[]

    test_codes = []
    test_groudTruth = []
    # get g.t. and binary code
    getCode(train_codes,train_groudTruth,test_codes,test_groudTruth)
    train_codes = np.array(train_codes)
    train_groudTruth = np.array(train_groudTruth)
    test_codes = np.array(test_codes)
    test_groudTruth = np.array(test_groudTruth)
    numOfTest = 10000

    # generate hanmming martix, g.t. martix  10000*50000
    gt_martix = np.dot(test_groudTruth, np.transpose(train_groudTruth))
    print getNowTime(),'gt_martix finish!'
    ham_martix = np.dot(test_codes, np.transpose(train_codes)) # hanmming distance map to dot value 
    print 'ham_martix finish!'

    # sort hanmming martix,Returns the indices that would sort an array.
    sorted_ham_martix_index = np.argsort(ham_martix,axis=1)

    # calculate mAP
    print 'sort ham_matrix finished,start calculate mAP'

    apall = np.zeros((numOfTest,1),np.float64)
    for i in range(numOfTest):
        x = 0.0
        p = 0
        test_oneLine = sorted_ham_martix_index[i,:]
        length = test_oneLine.shape[0]
        num_return_NN = 5000 # top 1000
        for j in range(num_return_NN):
             if gt_martix[i][test_oneLine[length-j-1]] == 1: # reverse
                 x += 1
                 p += x/(j+1)
        if p == 0:
            apall[i]=0
        else:
            apall[i]=p/x

    mAP = np.mean(apall)
    print 'mAP:',mAP
</code></pre>
<hr/>
<p>I want to re-write the code above using tensor operations (like <code>tf.equal()</code>、<code>tf.reduce_sum()</code> so on).</p>
<p>for example</p>
<h2>I want to calculate valid accuracy of images</h2>
<pre><code>logits = self._model(x_valid)
valid_preds = tf.argmax(logits, axis=1)
valid_preds = tf.to_int32(valid_preds)
self.valid_acc = tf.equal(valid_preds, y_valid)
self.valid_acc = tf.to_int32(self.valid_acc)
self.valid_acc = tf.to_float(tf.reduce_sum(self.valid_acc))/tf.to_float(self.batch_size)
</code></pre>
<hr/>
<p>I want to use TensorFlow to calculate hashcode‘s mAP （mean average precision）  this way（like tf.XX opreation）</p>
<p>How could I do？ Thanks！</p>
</div>
<div class="post-text" itemprop="text">
<p>If you just want to calculate average precision based on the validation set predictions, you can use the vector of predicted probabilities and the vector of true labels in <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.average_precision_score.html" rel="nofollow noreferrer">this scikit-learn function</a>. </p>
<p>If you really want to use a tensorflow function, there's a tensorflow function <a href="https://www.tensorflow.org/api_docs/python/tf/metrics/average_precision_at_k" rel="nofollow noreferrer">average_precision_at_k</a>.</p>
<p>For more info about average precision you can see <a href="https://glassboxmedicine.com/2019/03/02/measuring-performance-auprc/" rel="nofollow noreferrer">this article</a>.</p>
</div>
<span class="comment-copy">What have you tried so far?</span>
<span class="comment-copy">I tried to modify the method of calculating mAP values from the above code to calculate mAP values using tensor operations, but numpy's matrix operations seem to be different from tensorflow's.</span>
<span class="comment-copy">yes the are different in some way. please make your question more specific</span>
<span class="comment-copy">Thank you for your answer, but what I need is to use hash codes as predictors to calculate mAP (as shown in the code I posted), so I may not be able to use these functions.</span>
<div class="post-text" itemprop="text">
<p>I have a stream of user events. I've mapped them into KV{ userId, event }, and assigned timestamps.</p>
<p>This is to run in streaming mode. I would like to have be able to create the following input-output result:</p>
<p>session window gap=1</p>
<ul>
<li>input: <code>user=1, timestamp=1, event=a</code></li>
<li>input: <code>user=2, timestamp=2, event=a</code></li>
<li>input: <code>user=2, timestamp=3, event=a</code></li>
<li>input: <code>user=1, timestamp=2, event=b</code></li>
<li>time: <code>lwm=3</code></li>
<li>output: <code>user=1, [ { event=a, timestamp=1 }, { event=b, timestamp=2 } ]</code></li>
<li>time: <code>lwm=4</code></li>
<li>output: <code>user=2, [ { event=a, timestamp=2 }, { event=a, timestamp=3 } ]</code></li>
</ul>
<p>So that I can write my function to reduce thee list of events in the session window for the user as well as the start and end time of the session window.</p>
<p>How do I write this? (If you answer; "look at the examples", it's not a valid answer, because they never feed the list of events into the reducer with the window as a parameter)</p>
</div>
<div class="post-text" itemprop="text">
<p>If I understand this correctly, this would be a follow-up to this <a href="https://stackoverflow.com/questions/55219481/apache-beam-per-user-session-windows-are-unmerged/">question</a> and naturally accomplished by adding the Group By Key step as I propose in my solution there.</p>
<p>So, referring to my previous explanation and focusing here on the changes only, if we have a pipeline like this:</p>
<pre class="lang-py prettyprint-override"><code>events = (p
  | 'Create Events' &gt;&gt; beam.Create(user1_data + user2_data) \
  | 'Add Timestamps' &gt;&gt; beam.Map(lambda x: beam.window.TimestampedValue(x, x['timestamp'])) \
  | 'keyed_on_user_id'      &gt;&gt; beam.Map(lambda x: (x['user_id'], x))
  | 'user_session_window'   &gt;&gt; beam.WindowInto(window.Sessions(session_gap),
                                             timestamp_combiner=window.TimestampCombiner.OUTPUT_AT_EOW) \
  | 'Group' &gt;&gt; beam.GroupByKey() \
  | 'analyze_session'         &gt;&gt; beam.ParDo(AnalyzeSession()))
</code></pre>
<p>Now the elements are arranged as you describe in the question description so we can simply log them in <code>AnalyzeSession</code>:</p>
<pre class="lang-py prettyprint-override"><code>class AnalyzeSession(beam.DoFn):
  """Prints per session information"""
  def process(self, element, window=beam.DoFn.WindowParam):
    logging.info(element)
    yield element
</code></pre>
<p>to obtain the desired results: </p>
<pre class="lang-py prettyprint-override"><code>INFO:root:('Groot', [{'timestamp': 1554203778.904401, 'user_id': 'Groot', 'value': 'event_0'}, {'timestamp': 1554203780.904401, 'user_id': 'Groot', 'value': 'event_1'}])
INFO:root:('Groot', [{'timestamp': 1554203786.904402, 'user_id': 'Groot', 'value': 'event_2'}])
INFO:root:('Thanos', [{'timestamp': 1554203792.904399, 'user_id': 'Thanos', 'value': 'event_4'}])
INFO:root:('Thanos', [{'timestamp': 1554203784.904398, 'user_id': 'Thanos', 'value': 'event_3'}, {'timestamp': 1554203777.904395, 'user_id': 'Thanos', 'value': 'event_0'}, {'timestamp': 1554203778.904397, 'user_id': 'Thanos', 'value': 'event_1'}, {'timestamp': 1554203780.904398, 'user_id': 'Thanos', 'value': 'event_2'}])
</code></pre>
<p>If you want to avoid redundant information such as having the <code>user_id</code> and <code>timestamp</code> as part of the values they can be removed in the <code>Map</code> step. 
As per the complete use case (i.e. reducing the aggregated events on a per-session level) we can do stuff like counting the number of events or session duration with something like this:</p>
<pre class="lang-py prettyprint-override"><code>class AnalyzeSession(beam.DoFn):
  """Prints per session information"""
  def process(self, element, window=beam.DoFn.WindowParam):
    user = element[0]
    num_events = str(len(element[1]))
    window_end = window.end.to_utc_datetime()
    window_start = window.start.to_utc_datetime()
    session_duration = window_end - window_start

    logging.info("&gt;&gt;&gt; User %s had %s event(s) in %s session", user, num_events, session_duration)

    yield element
</code></pre>
<p>which, for my example, will output the following:</p>
<pre class="lang-py prettyprint-override"><code>INFO:root:&gt;&gt;&gt; User Groot had 2 event(s) in 0:00:07 session
INFO:root:&gt;&gt;&gt; User Groot had 1 event(s) in 0:00:05 session
INFO:root:&gt;&gt;&gt; User Thanos had 4 event(s) in 0:00:12 session
INFO:root:&gt;&gt;&gt; User Thanos had 1 event(s) in 0:00:05 session
</code></pre>
<p>Full code <a href="https://gist.github.com/gxercavins/522a7f71f7bd86916c6db80abb8e2a0b" rel="nofollow noreferrer">here</a></p>
</div>
<div class="post-text" itemprop="text">
<p>I am labeling transactional data with fiscal year ranges. For example, 2018-2019 fiscal has a date range of 7/1/2018 - 6/30/2019. For some reason, when I run the following code, any transaction that happened 7/1/2018 (first day of fiscal) it gets labeled 2017 - 2018 fiscal. Sample data provided as well. </p>
<pre><code>data = [['Start 17-18 Fiscal', '7/1/2017'], ['End 17-18 Fiscal', '6/30/2018'], ['Start 18-19 Fiscal', '7/1/2018'], 
        ['End 18-19 Fiscal', '6/30/2019'], ['Start 19-20 Fiscal', '7/1/2019'], ['End 19-20 Fiscal', '6/30/2020']]
df = pd.DataFrame(data, columns=['Correct Fiscal', 'Date'])

df['Date'] = pd.to_datetime(df['Date'])
y_max = df['Date'].dt.year.max() + 1
y_min = df['Date'].dt.year.min() - 1
labels = [str(x) + ' - ' + str(x+1) for x in np.arange(y_min, y_max, 1)]
df['pay_period'] = pd.cut(df.Date, pd.date_range(str(y_min), str(y_max+1), freq='BAS-JUL'), right=False, labels=labels)
</code></pre>
<p>Also, if you look at sample data for 2019 - 2020 fiscal both are labeled as expected. Below is the output.</p>
<pre><code>       Correct Fiscal       Date   pay_period
0  Start 17-18 Fiscal 2017-07-01  2016 - 2017
1    End 17-18 Fiscal 2018-06-30  2017 - 2018
2  Start 18-19 Fiscal 2018-07-01  2017 - 2018
3    End 18-19 Fiscal 2019-06-30  2018 - 2019
4  Start 19-20 Fiscal 2019-07-01  2019 - 2020
5    End 19-20 Fiscal 2020-06-30  2019 - 2020
</code></pre>
<p><strong>Updated Solution</strong></p>
<p>So, I was able to fix this and reduce the code to just these two lines:</p>
<pre><code>period_end = pd.to_datetime(df.Date).apply(pd.Period, freq='A-JUN')
df['fiscal_p'] = (period_end - 1).astype(str) + ' - ' + period_end.astype(str)
</code></pre>
<p>Thanks to Dan for providing the function answer as well. I can confirm that his answer works as well.</p>
</div>
<div class="post-text" itemprop="text">
<p>I think the problem is with your "labels" line, not the date range frequency. The labels list is ensuring that the first row is labelled as '2016 -2017', which is incorrect according to your inputs.</p>
<p>Here's an alternative way to get your desired output, using a simple function:</p>
<pre><code>data = [['Start 17-18 Fiscal', '7/1/2017'], ['End 17-18 Fiscal', '6/30/2018'], ['Start 18-19 Fiscal', '7/1/2018'], 
        ['End 18-19 Fiscal', '6/30/2019'], ['Start 19-20 Fiscal', '7/1/2019'], ['End 19-20 Fiscal', '6/30/2020']]
df = pd.DataFrame(data, columns=['Correct Fiscal', 'Date'])

df['Date'] = pd.to_datetime(df['Date'])

def find_pay_period(date):
    if date.month == 7:
        end_year = date.year + 1
    elif date.month == 6:
        end_year = date.year
    else:
        return 'undefined'

    return f'{end_year - 1} - {end_year}'

df['pay_period'] = df['Date'].apply(find_pay_period)
</code></pre>
<p>Which gives the following output:</p>
<pre><code>       Correct Fiscal       Date   pay_period
0  Start 17-18 Fiscal 2017-07-01  2017 - 2018
1    End 17-18 Fiscal 2018-06-30  2017 - 2018
2  Start 18-19 Fiscal 2018-07-01  2018 - 2019
3    End 18-19 Fiscal 2019-06-30  2018 - 2019
4  Start 19-20 Fiscal 2019-07-01  2019 - 2020
5    End 19-20 Fiscal 2020-06-30  2019 - 2020
</code></pre>
</div>
<span class="comment-copy">Thanks, your code works. While you were writing your answer I was actually able to fix it as well by scrapping the old code and replacing it with two new lines. See the last part of my questions.</span>
<div class="post-text" itemprop="text">
<p>The following code creates the dataframe that is my starting point:</p>
<pre><code>import pandas as pd
import numpy as np


d= {'PX_LAST':[1,2,3,3,3,1,2,2,1,1,3,3],'ma':[2,2,2,2,2,2,2,2,2,2,2,2],'action':[0,0,1,0,0,1,0,0,1,0,1,0]}
df_zinc = pd.DataFrame(data=d)

#add column buy_sell
mask1 = df_zinc['action'] != 0
mask2 = df_zinc['PX_LAST'] &lt; df_zinc['ma']
mask3 = df_zinc['PX_LAST'] &gt; df_zinc['ma']

df_zinc['buy_sell'] = np.select([mask1 &amp; mask2, mask1 &amp; mask3], [-1,1], 0)
df_zinc
</code></pre>
<p>What I am trying to do in the below is to add a column in which each row is the result of the sum between the value in the previous row, the current value of column 'operational_col', and the current value of column 'buy_sell'.</p>
<pre><code>#empty operational column and weight column
df_zinc['operational_col']=0
df_zinc['weight']=0

#weight column
while index &lt; df_zinc.shape[0]:                      
df_zinc['weight'][index] = df_zinc['weight'][index-1] + df_zinc['operational_col'][index] + df_zinc['buy_sell'][index]
index = index + 1
</code></pre>
<p>This yields a column with only zeros, instead of the values I am looking for. Can anybody help, please?</p>
</div>
<div class="post-text" itemprop="text">
<p>In your example <code>index</code> is not defined before it is accessed in the <code>while</code> loop, so it creates a Name Error. Here is your loop rewritten using a <code>for</code> loop, and <code>loc</code> to select the values in the columns:</p>
<pre><code>for index in range(1, len(df_zinc)):                     
    df_zinc.loc[index, 'weight'] = df_zinc.loc[index-1, 'weight'] + \
    df_zinc.loc[index, 'operational_col'] + df_zinc.loc[index, 'buy_sell']
</code></pre>
</div>
<span class="comment-copy">same issue actually. The question has been edited - now the code is as it is in my sheet. To summarize, the problem is that I get only zeros on column weight</span>
<span class="comment-copy">The code I suggested produces some non-zero values for me on the example data you gave - 1 in row 2, -1 in row 5 etc.</span>
<span class="comment-copy">It does not to me. I copied and pasted your version for 'df_zinc['weight'] = df_zinc['weight'].shift(1) + df_zinc['operational_col'] + df_zinc['buy_sell']' and it does not work</span>
<span class="comment-copy">Ok see updated answer, this is an update on your loop using <code>.loc</code> and a <code>for</code> instead of <code>while</code></span>
<div class="post-text" itemprop="text">
<p>I want to update an object through a form in Django but before doing <code>form.save()</code> in the view I want to do some conditions about the data.</p>
<p>For example:</p>
<pre class="lang-py prettyprint-override"><code>ire = get_object_or_404(Ire, id_IRE=pk)
if request.method == 'POST':
    form = IreForm(request.POST or None, instance=ire)
    if form.is_valid():
        if ire.get_att1()==form.cleaned_data.get('att1') and ire.get_att2()==form.cleaned_data.get('att2'):
           form.save(update_fields=['type']) #just update the field type
        else:
           form.save() #create a new object
</code></pre>
<p>When I did this in my view just the first condition works but when I change the att1 or att2 in the form it does not do any changes.</p>
<p>Please help me how can I do conditions before saving!!!</p>
</div>
<div class="post-text" itemprop="text">
<p>thank you i found the solution which is storing the values of the object that i want to update befor doing the update operation :</p>
<pre><code>ire = get_object_or_404(Ire, id_IRE=pk)
**ire_att1=ire.get_att1()**
**ire_att2=ire.get_att2()**
**ire_type=ire.get_type()**

if request.method == 'POST':
  form = IreForm(request.POST or None, instance=ire)
  if form.is_valid():
    if **ire_att1**==form.cleaned_data.get('att1') and **ire_att2**==form.cleaned_data.get('att2'):
          Ire.objects.filter(id_IRE=pk).update(type=form.cleaned_data.get('type'))
    else:
          form.save()
</code></pre>
<p>this is how i solve the probleme because i found that after calling the form model the values of the object change simultaneously with what i enter even before i call form.save</p>
</div>
<span class="comment-copy">Can you please paste your code properly. Just use three backticks before the code block, and three more after the code block?</span>
<span class="comment-copy">why can you pass <code>update_fields</code> to your form's save method? Have you changed the form's <code>save()</code> method? And why do think <code>form.save()</code> creates a new object?</span>
<span class="comment-copy">When you say that when you "change att1 or att2", what are you doing? <code>form.cleaned_data['att1'] = foo</code>?</span>
<span class="comment-copy">MonoHearted it is an update form so when i click the button update it triggers the form filled with values of the object that i want to update .i have three fields in the form att1 and att2 and type  i have two divise my code to two conditions the fi</span>
<span class="comment-copy">MonoHearted it is an update form so when i click the button update it triggers the form filled with values of the object that i want to update .i have three fields in the form att1 and att2 and type so   i have two divise my code to two conditions if i change the type i have just update the type but if i change the att1 or attr2 i have to save the form so that it changes all the fields</span>
<div class="post-text" itemprop="text">
<p>I have a python script which takes the order number as input and the output would be cost of the item, tax &amp; total. Also the address where item has been shipped.
In this program, I have the following piece of code to take the input</p>
<pre><code>Oname = '1'  #something that doesn't validate
while True:
    Oname = input("Please enter the Order number: ").upper() #ask for order number
    if not re.match(r"\b[A-Z]{2}[-][0-9]{6}\b", Oname): #check if the Order number is in the right format
        print ("Error! Please enter Order in format 'RS-XXXXXX'") #if the Order number is not in the right format, keep asking
    else:
        break
</code></pre>
<p>This is working perfectly. However, I want to do this with a pop-up input box (with pyQT4) instead of a command line (I share this with others &amp; they prefer a pup-up box than a command line).
Also, I need a cancel button on the pup-up window &amp; if the user clicks it (the user may have changed his mind &amp; not want to run the program), the python script should stop.</p>
<p>The above two items are absolutely necessary.
Another item on the wish list is, there should be a check box next to entry field called "is this a gift item". If the user checks this box, only the message saying "the item has been shipped to xxxxx address" should be printed. The part of the code where the price is calculated need not be run.</p>
</div>
<div class="post-text" itemprop="text">
<p>Sorry, I have PyQt5.
Try it:</p>
<pre><code>import sys 
#from PyQt4.QtCore    import *
#from PyQt4.QtGui     import *
from PyQt5.QtWidgets import *
from PyQt5.QtCore    import *
from PyQt5.QtGui     import *

class Demo(QMainWindow):
    def __init__(self, parent=None):
        super().__init__(parent)
        centralWidget = QWidget()
        self.setCentralWidget(centralWidget)

        self.label = QLabel("Please enter Order in format `RS-XXXXXX`:", alignment=Qt.AlignCenter)
        self.chBox = QCheckBox("&lt;-is this a gift item")

        self.lineEdit= QLineEdit()

        # a cancel button
        self.lineEdit.setClearButtonEnabled(True)

        self.lineEdit.setToolTip("press RETURN to check")
        self.lineEdit.setStyleSheet(""" QLineEdit {border: None;
                                                   font-size: 14px;} """)
        # lineEdit with validation                                              
        self.lineEdit.setInputMask('AA-999999')    
        self.lineEdit.returnPressed.connect(lambda : self.findText(self.lineEdit.text()))

        self.textBrowser = QTextBrowser()
        self.button = QPushButton("click me to check")
        self.button.clicked.connect(lambda : self.findText(self.lineEdit.text()))

        self.grid = QGridLayout(centralWidget)
        self.grid.addWidget(self.label,       0, 0, 1, 2)  
        self.grid.addWidget(self.chBox,       1, 0)
        self.grid.addWidget(self.lineEdit,    1, 1)
        self.grid.addWidget(self.textBrowser, 2, 0, 1, 2)   
        self.grid.addWidget(self.button,      3, 0, 1, 2)

    def findText(self, text=None):
        if self.lineEdit.hasAcceptableInput():
            self.textBrowser.append(text)      
            if self.chBox.isChecked():  
                self.textBrowser.insertPlainText("; chBox -&gt; True. Is this a gift item.")        


if __name__ == '__main__':
    app = QApplication(sys.argv)
    mw = Demo()
    mw.show()
    sys.exit(app.exec_())
</code></pre>
<p><a href="https://i.stack.imgur.com/WXecy.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/WXecy.png"/></a></p>
</div>
<span class="comment-copy">The pop-up window gets created. However, it pops-up in the background (behind the current window). It has to pop up in front so that the user know it has popped up. Also, the cursor should be on the input field so that the user can paste the order number (that is what the users will mostly do in my case, they will not type the number, they will just paste the copied number). Also, after they enter the number, &amp; check whether it is a gift item or not, there should be only OK &amp; Cancel button. Once they give the numebr according to format &amp; click OK, the pup-up window should go away.</span>
<div class="post-text" itemprop="text">
<p>I have developed the following MWE with data that spreads into two very different scales. I would like to make a contourplot which allows nicely visualising the data.</p>
<pre><code>from matplotlib import ticker
import numpy as np               
import matplotlib.pyplot as plt 
data = np.random.rand(25,25)
data2 = np.random.rand(25,25)*1e-32
data = np.hstack([data,data2])
xGrid, yGrid = np.meshgrid(np.linspace(0,1,data.shape[1]),np.linspace(0,1,data.shape[0]))

levels=np.logspace(np.log10(1e-6),np.log10(2),100)
locator = ticker.LogLocator(base=10)
cs = plt.contourf(xGrid, yGrid, data, levels, vmin = 1e-6, vmax = 2, locator=locator)
plt.colorbar(cs, ticks=locator)
</code></pre>
<p>With the above code, I get : <a href="https://i.stack.imgur.com/JkDyw.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/JkDyw.png"/></a></p>
<p>I don't get why half the values are blank</p>
</div>
<div class="post-text" itemprop="text">
<p>Ok I found out what is the issue thanks to another <a href="https://stackoverflow.com/questions/47616034/python-setting-the-zero-value-color-in-a-contourf-plot-where-log-scale-colorba">post</a>. One needs to use the option extend = "both". Unfortunately, this option does not work with logarithm scales.</p>
<p>The solution is to manually rescale the data range. An example is provided below :</p>
<pre><code>from matplotlib import ticker
import numpy as np               
import matplotlib.pyplot as plt 
data = np.random.rand(25,25)
data2 = np.random.rand(25,25)*1e-32
data = np.hstack([data,data2])
xGrid, yGrid = np.meshgrid(np.linspace(0,1,data.shape[1]),np.linspace(0,1,data.shape[0]))

levels=np.logspace(np.log10(1e-16),np.log10(2),100)
locator = ticker.LogLocator(base=10)

#mask data
dataMasked = np.where(data &lt; 1e-16, 1e-16, data)

cs = plt.contourf(xGrid, yGrid, dataMasked, levels, vmin = 1e-16, vmax = 2, extend="both", locator=locator)
plt.colorbar(cs, ticks=locator)
</code></pre>
</div>
<span class="comment-copy">what's ticker? How did you import it?</span>
<div class="post-text" itemprop="text">
<p>simplekml module makes multiple polygons instead of a single one. Is there any way to merge the polygons into a single polygon, rather than multiple ones??</p>
<pre><code>import simplekml, pandas as pd
tuples=tuple([(72.852333, 29.807333), (73.131333, 29.6055), (72.84733299999999, 29.587667), (73.568833, 30.1625), (72.8633, 29.2014), (73.1385, 29.614), (72.863667, 29.206667), (73.7015, 30.246667), (72.87169, 29.803279999999997), (72.8665, 29.794666999999997), (72.85826999999999, 29.79843), (72.847, 29.596166999999998), (73.0363238, 29.9029902), (73.035667, 29.466167), (72.8405, 29.587833000000003), (73.258333, 30.007167), (72.85779000000001, 29.79529), (73.022667, 29.478167), (72.84916700000001, 29.4135), (72.9155, 29.269000000000002), (72.840333, 29.620833), (73.2535, 29.992666999999997), (73.2535, 29.992666999999997), (72.86291999999999, 29.79293), (73.253, 29.997667), (73.25366700000001, 29.982667), (72.86233299999999, 29.798167), (73.253, 29.998666999999998), (72.939167, 29.331333), (73.04566700000001, 29.475), (72.84899999999999, 29.791999999999998), (73.131333, 29.6055), (73.565833, 30.164167), (73.14183299999999, 29.606167), (72.946833, 29.500333), (73.13766700000001, 29.615333000000003), (72.922, 29.418667), (72.830667, 29.683000000000003), (73.559774, 30.163674), (73.572, 30.165667), (73.258333, 30.006999999999998), (72.401833, 29.222833), (73.5695, 30.159000000000002), (72.859, 29.197333), (72.839833, 29.596333), (72.9516, 29.5113), (73.25365699999999, 29.992668), (72.866333, 29.803167), (72.9469, 29.6002), (73.2535, 29.992666999999997), (73.252167, 30.003833), (73.0400358, 29.4768821), (73.241233, 29.753483000000003), (73.24731700000001, 29.753967), (72.93329920000001, 29.276225), (72.8875, 29.413333), (72.8565, 29.195166999999998), (73.142333, 29.6125), (73.258333, 29.994166999999997), (72.97783299999999, 29.5), (72.901167, 29.414833), (72.9615, 29.3285), (72.852333, 29.807333), (73.135333, 29.606333000000003), (73.26016700000001, 30.002833000000003), (72.85883299999999, 29.197333), (72.859833, 29.193666999999998), (72.840333, 29.600666999999998), (73.131333, 29.6055), (73.738667, 30.157667), (72.41816700000001, 29.225167), (72.85448000000001, 29.79598), (72.85249, 29.803440000000002), (72.70944399999999, 29.735556), (72.857833, 29.199833), (73.0722, 29.5486), (73.14844000000001, 29.602040000000002), (73.260333, 29.996833000000002), (73.266667, 30.006666999999997), (73.039333, 29.4745), (73.252167, 30.003667), (72.836, 29.784333), (72.88833299999999, 29.203833000000003), (72.4266, 29.2262), (73.697333, 30.245833), (73.0158, 29.8002), (73.036833, 29.9015), (73.241167, 29.974), (73.266667, 30.006666999999997), (73.24255, 29.753517), (73.0365, 29.469666999999998), (73.259833, 30.002667), (73.25783299999999, 29.995833), (73.241167, 29.974), (73.13600000000001, 29.610333), (73.25483299999999, 29.999333), (73.135333, 29.606333000000003), (73.18933299999999, 29.531333), (72.958833, 29.330667), (72.8615, 29.1965), (72.8545, 29.596333), (73.7336, 30.1558), (73.25366700000001, 29.982667), (72.668667, 29.254), (73.25374000000001, 29.98262), (72.7566, 29.6736), (73.03, 29.457333000000002), (72.8581, 29.7985), (72.8602, 29.797690000000003), (72.83716700000001, 29.669666999999997), (72.8615, 29.1965), (73.257667, 29.995833), (73.26083299999999, 30.000833), (73.2535, 29.992666999999997), (73.125833, 29.6025), (72.66883299999999, 29.2475), (73.258333, 29.994166999999997), (73.14015, 29.619529999999997), (73.1386584, 29.613507399999996), (72.86265, 29.78945), (73.561167, 30.163833), (72.86129, 29.795740000000002), (73.2391, 29.7552), (72.841833, 29.598167)])
kml = simplekml.Kml()
pol = kml.newpolygon(name="Atrium Garden",
outerboundaryis=tuples)         
pol.style.polystyle.color = simplekml.Color.red
pol.style.polystyle.outline = 1
pol.style.polystyle.fill = 1
kml.save(r"C:\Users\user\Desktop\PolyStyle.kml")
</code></pre>
</div>
<span class="comment-copy">Can you provide some code and a reproducible example? It's hard to answer your question without some kind of starting point as to where you are and what you're doing.</span>
<span class="comment-copy">I want all polygons to form a single image. I'm getting the following image which contains voids. <a href="https://i.stack.imgur.com/OSOY5.png" rel="nofollow noreferrer">link</a></span>
<span class="comment-copy">I've added the code as well :) !</span>
<span class="comment-copy">I'm not familiar with simplekml, so not sure exactly what it's doing, but it appears to be making a polygon with a single linestring, where the vertices are not in the correct order.  If you share your output KML, we could confirm this.  I'm not sure if simplekml supports it, but you might be able to get what you want by combining the polygons into a KML "multigeometry", or a single Polygon with multiple outerBoundary sections.</span>
<span class="comment-copy">The file is available here Christiaan. Thank you for the support : <a href="https://drive.google.com/open?id=11Ds3oZmOWNHt9GPKnZhRlmu4gERjGZtM" rel="nofollow noreferrer">drive.google.com/open?id=11Ds3oZmOWNHt9GPKnZhRlmu4gERjGZtM</a></span>
<div class="post-text" itemprop="text">
<p>I want to calculate the bias between two curves but I have values of the first curve that are not in the second curve. So, I try to eliminate the values of the first curve that are not defined by the second curve. How will I proceed? Thank you for answering me.</p>
</div>
<div class="post-text" itemprop="text">
<p>Assuming you have your values in 2 lists:</p>
<pre><code>new_values = [val for val in list1 if val not in list2]
</code></pre>
</div>
<span class="comment-copy">Show us the code you're working with.</span>
<span class="comment-copy">these are two curves that represent a physical parameter as a function of time. and this is one of the time series that I want to edit.</span>
<div class="post-text" itemprop="text">
<p>I am trying to run <code>python3.6.8</code> in <code>cygwin</code>.</p>
<p>Typing <code>python -v</code> just results in the terminal window hanging. I have to escape out of it to make it respond further.</p>
<p>Typing <code>python36 -v</code> results in the error <code>python36 command not found</code>. I definitely installed this module while installing <code>Cygwin</code>.</p>
<p>I notice in /cygdrive/c, only python27 seems to be present. Running python -i also shows me that 2.7 is installed.</p>
<p>I want to run 3.6.8, have tried reinstalling multiple times, same issue.</p>
<p>Running "which python" shows only</p>
<pre><code>/cygdrive/c/Python27/python
</code></pre>
<p>Can anyone help me troubleshoot this please?</p>
<p>Thanks a lot.</p>
</div>
<div class="post-text" itemprop="text">
<p>Generally all the python versions with 3 can be accessed using python3 as binary. In windows often the path variable doesn't hold the python3 binary path so the binary is not called.</p>
<p>do </p>
<pre><code>echo $PATH | grep python
</code></pre>
<p>Check for the version of the python if python36 is present then do </p>
<pre><code>python3 --version
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Look in <code>/usr/bin</code> for all python exe's. Use <code>ls -l /usr/bin/python*.*</code>. I suspect you will not find <code>python3.6m.exe</code>.</p>
<p>Run cygwin setup again and select the <code>python3.6</code> package. You can also install a version of 3.7, 3.8 or some older ones if you wish. You can only get the latest release of the e.g. 3.6 series.</p>
</div>
<span class="comment-copy">You should use <code>python -V</code> to see the version info. Try also <code>python3 -V</code>. However ... It looks like you do not have the cygwin python 2.7 installed, because <code>/cygdrive/c/Python27/python</code> is the windows version of python. You need to run cygwin setup again to install the python package you want.</span>
<span class="comment-copy">Hmm, the first command has no results. The second says "python3 : command not found". Very odd behaviour. Thanks for your response.</span>
<span class="comment-copy">@SimonKiely the issue is with the path variable and not the installation. In cygwin this happens. May I suggest you to use Mobaxterm community edition -- this is far better than cygwin and you won't face such issues. Install mobaxterm and then install using apt. Mobaxterm supports apt.</span>
<div class="post-text" itemprop="text">
<p>Is there a way to find the top 10 long paths in a Digraph (with self-loops removed) made using NetworkX?</p>
<p>What I have tried so far, (<em>cone</em> is the Digraph with self-loops)</p>
<pre><code>cone.remove_edges_from(cone.selfloop_edges())    
print nx.dag_longest_path(cone)
</code></pre>
<p>Note: In the terminology I have used, <em>longest path</em> means the path which passes through maximum number of nodes (unlike the standard definition where we consider the edge weight)</p>
</div>
<span class="comment-copy">Finding the longest path (which passes through each node exactly once) is an NP-hard problem. What are your expectations (complexity, ...) and how large a graph are you considering?</span>
<span class="comment-copy">@AnthonyLabarre The final objective is to divide (approximately) the longest 10 paths in the graph into three sections and get the signals in those nodes. The final graph will have more than 100 nodes (but can expect upto 1000 nodes at least later).</span>
<span class="comment-copy">@AnthonyLabarre Is it still an NP-hard problem even if we remove the cycles by topologically sorting the nodes?</span>
<span class="comment-copy">No, if you have a DAG (directed acyclic graph) then the problem becomes polynomial. Is this your case (your code snippet which uses <code>dag_longest_path</code> seems to suggest so)? Note that you cannot sort vertices topologically if the graph has a cycle, so I'm not sure how you intend to remove cycles (meaning it's possible but there are several ways to do that).</span>
<span class="comment-copy">I will be using DAG and will explore the ways to eliminate the cycles. (I convert HDL descriptions in Verilog to graphs. Will consider that also in short-listing the ways to eliminate the cycles). Thanks Prof. @AnthonyLabarre</span>
<div class="post-text" itemprop="text">
<p>I want to understand how to <code>@patch</code> a function from an imported module.</p>
<p>This is where I am so far.</p>
<p><strong>app/mocking.py:</strong></p>
<pre><code>from app.my_module import get_user_name

def test_method():
  return get_user_name()

if __name__ == "__main__":
  print "Starting Program..."
  test_method()
</code></pre>
<p><strong>app/my_module/__init__.py:</strong></p>
<pre><code>def get_user_name():
  return "Unmocked User"
</code></pre>
<p><strong>test/mock-test.py:</strong></p>
<pre><code>import unittest
from app.mocking import test_method 

def mock_get_user():
  return "Mocked This Silly"

@patch('app.my_module.get_user_name')
class MockingTestTestCase(unittest.TestCase):

  def test_mock_stubs(self, mock_method):
    mock_method.return_value = 'Mocked This Silly')
    ret = test_method()
    self.assertEqual(ret, 'Mocked This Silly')

if __name__ == '__main__':
  unittest.main()
</code></pre>
<p>This does <strong>not</strong> work as I would expect. The "patched" module simply returns the unmocked value of <code>get_user_name</code>. How do I mock methods from other packages that I am importing into a namespace under test?</p>
</div>
<div class="post-text" itemprop="text">
<p>When you are using the <code>patch</code> decorator from the <code>unittest.mock</code> package you are <strong>not</strong> patching the namespace the module is imported from (in this case <code>app.my_module.get_user_name</code>) you are patching it in the namespace under test <code>app.mocking.get_user_name</code>.</p>
<p>To do the above with <code>Mock</code> try something like the below: </p>
<pre><code>from mock import patch
from app.mocking import test_method 

class MockingTestTestCase(unittest.TestCase):

    @patch('app.mocking.get_user_name')
    def test_mock_stubs(self, test_patch):
        test_patch.return_value = 'Mocked This Silly'
        ret = test_method()
        self.assertEqual(ret, 'Mocked This Silly')
</code></pre>
<p>The standard library documentation includes a useful <a href="https://docs.python.org/3/library/unittest.mock.html#where-to-patch" rel="noreferrer">section</a> describing this.</p>
</div>
<div class="post-text" itemprop="text">
<p>While Matti John's answer solves your issue (and helped me too, thanks!), I would, however, suggest localizing the replacement of the original 'get_user_name' function with the mocked one. This will allow you to control when the function is replaced and when it isn't. Also, this will allow you to make several replacements in the same test. In order to do so, use the 'with' statment in a pretty simillar manner:</p>
<pre><code>from mock import patch

class MockingTestTestCase(unittest.TestCase):

    def test_mock_stubs(self):
        with patch('app.mocking.get_user_name', return_value = 'Mocked This Silly'):
            ret = test_method()
            self.assertEqual(ret, 'Mocked This Silly')
</code></pre>
</div>
<span class="comment-copy">The question is about "mocking best practices" or whether or not what you are doing makes sense? Regarding the first I'd say to use a mocking library such as <a href="http://www.voidspace.org.uk/python/mock/" rel="nofollow noreferrer"><code>Mock</code></a>, which is included in python3.3+ as <a href="http://docs.python.org/dev/library/unittest.mock" rel="nofollow noreferrer"><code>unittest.mock</code></a>.</span>
<span class="comment-copy">I am asking if I am going about this right. I looked at Mock, but I don't see a way to solve this particular problem. Is there a way to recreate what I did above in Mock?</span>
<span class="comment-copy">this gets to my problem. <code>get_user_name</code> is in a different module than <code>test_method</code>. Is there a way to mock something in a sub_module? I fixed it in an ugly way below.</span>
<span class="comment-copy">It doesn't matter that <code>get_user_name</code> is in a different module than <code>test_method</code> since you are importing the function into <code>app.mocking</code> they are in the same namespace.</span>
<span class="comment-copy">got ya. Yeah that works thanks!</span>
<span class="comment-copy">Where did test_patch come from, what is it exactly?</span>
<span class="comment-copy">test_patch is passed in by the patch decorator and is the mocked get_user_name object (i.e. an instance of the MagicMock class). It might be clearer if it was named something like <code>get_user_name_patch</code>.</span>
<span class="comment-copy">This is sort of immaterial to the posed question. Whether you use <code>patch</code> as a decorator or context manager is specific to the use case.  For instance you can use <code>patch</code> as a decorator to mock a value for all tests in an <code>xunit</code> or <code>pytest</code> class while in other cases its useful to have the fine grained control afforded by the context manager.</span>
<div class="post-text" itemprop="text">
<p>I have few csv files that all of the has the following information:</p>
<p><a href="https://i.stack.imgur.com/YBCji.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/YBCji.png"/></a></p>
<p>I need to take each row from every CSV files and add as a row in each different Label separately to be able to take the mean of all measures among all CSV files. I wrote the following lines, but I do not know how to write in an efficient and clean way. defining 6 different <code>numpy</code> arrays and then adding each row of <code>csv</code> to them separately does not seem a smart way of writing code. what do you suggest? Thanks</p>
<pre><code>for filename in csv_files:
     print 'reading CSV file '+ filename
     file_path=join(csv_dir, filename)
     csv = np.genfromtxt (file_path, delimiter=",")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>As in the comment:
Read each file into a numpy.ndarray and store them into a list. Afterwards stack them together, e.g with np.hstack(arraylist).</p>
</div>
<span class="comment-copy">I'd prefer your data not to be displayed as an image. What you MIGHT want to do is read all files and add each numpy array to a list. Then stack the arrays from the list (e.g. np.hstack) and do operations on the big array.</span>
<span class="comment-copy">@jochen thanks a lot it works for me, really appreciate it</span>
<div class="post-text" itemprop="text">
<p>I'm on a tight schedule to come up with a python regex to match company names in many possible different copyright statements, for instance:</p>
<pre><code>Copyright © 2019 Apple Inc. All rights reserved.  
© 2019 Quid, Inc. All Rights Reserved.  
© 2009 Database Designs  
© 2019 Rediker Software, All Rights Reserved  
©2019 EVOSUS, INC. ALL RIGHTS RESERVED  
© 2019 Walmart. All Rights Reserved.  
© Copyright 2003-2019 Exxon Mobil Corporation. All Rights Reserved.  
Copyright © 1978-2019 Berkshire Hathaway Inc.  
© 2019 McKesson Corporation  
© 2019 UnitedHealth Group. All rights reserved.  
© Copyright 1999 - 2019 CVS Health  
Copyright 2019 General Motors. All Rights Reserved.  
© 2019 Ford Motor Company  
©2019 AT&amp;T Intellectual Property. All rights reserved.  
© 2019 GENERAL ELECTRIC  
Copyright ©2019 AmerisourceBergen Corporation. All Rights Reserved.  
© 2019 Verizon  
© 2019 Fannie Mae  
Copyright © 2018 Jonas Construction Software Inc. All rights reserved.  
All Comments © Copyright 2017 Kroger | The Kroger Co. All Rights Reserved  
© 2019 Express Scripts Holding Company. All Rights Reserved. 1 Express Way, St. Louis, MO 63121  
© 2019 JPMorgan Chase &amp; Co.  
Copyright © 1995 - 2018 Boeing. All Rights Reserved.  
© 2019 Bank of America Corporation. All rights reserved.  
© 1999 - 2019 Wells Fargo. All rights reserved. NMLSR ID 399801  
©2019 Cardinal Health. All rights reserved.  
</code></pre>
<p>What I know of regex is only very basic stuff and at the moment not enough to come up with a good solution fast.</p>
<p>From what it seems to me, at least for these examples, the requirements to correctly capture the company name are the following:</p>
<pre><code>If there's a '©' or 'Copyright' in the sentence:
    After '©' or 'Copyright' - look for a year, e.g. '2019', or a year range, e.g. '1995 - 2018' or '2003-2019' (spaces are to catch as well]):
        If there's a dot somewhere after this year/year range, capture  the text until the dot. E.g. in 'Copyright © 1978-2019 Berkshire Hathaway Inc.' capture 'Berkshire Hathaway Inc'
        If there's no dot but there's the sentence 'All rights reserved', capture from the year/year range until there and also ignore any possible non-alphanumeric characters that precede it, such as spaces and commas. E.g. from '© 2019 Rediker Software, All Rights Reserved' capture 'Rediker Software'
        If there's no dot nor the sentence 'All rights reserved', capture from the year/year range until the end. E.g. from '© 2019 Verizon' Capture 'Verizon'
</code></pre>
<p>Any advice on a good regex for this? </p>
</div>
<div class="post-text" itemprop="text">
<p>You may consider a regex like</p>
<pre><code>(?i)(?:©(?:\s*Copyright)?|Copyright(?:\s*©)?)\s*\d+(?:\s*-\s*\d+)?\s*(.*?(?=\W*All\s+rights\s+reserved)|[^.]*(?=\.)|.*)
</code></pre>
<p>See the <a href="https://regex101.com/r/maBHY5/7" rel="nofollow noreferrer">regex demo</a>. Use a case insensitive modifier, <code>re.I</code> with it.</p>
<p><strong>Details</strong></p>
<ul>
<li><code>(?:©(?:\s*Copyright)?|Copyright(?:\s*©)?)</code> - either

<ul>
<li><code>©(?:\s*Copyright)?</code> -  <code>©</code> char followed with an optional substring of  0+ whitespaces  and then <code>Copyright</code> </li>
<li><code>|</code> - or</li>
<li><code>Copyright(?:\s*©)?</code> - <code>Copyright</code> followed with an optional substring of 0+ whitespaces and <code>©</code> char</li>
</ul></li>
<li><code>\s*</code> - 0+ whitespaces</li>
<li><code>\d+</code> - 1+ digits (use <code>\d{4}</code> if the years always contain 4 digits)</li>
<li><code>(?:\s*-\s*\d+)?</code> - an optional sequence of a <code>-</code> enclosed with 0+ whitespaces and then 1+ digits (use <code>\d{4}</code> if the years always contain 4 digits)</li>
<li><code>\s*</code> - 0+ whitespaces</li>
<li><code>(.*?(?=\W*All\s+rights\s+reserved)|[^.]*(?=\.)|.*)</code> - <strong>Capturing group 1</strong>: any of the alternatives:

<ul>
<li><code>.*?(?=\W*All\s+rights\s+reserved)</code> - any 0+ chars other than line break chars, s few as possible, up to the 0+ non-word chars followed with <code>All rights reserved</code> string</li>
<li><code>[^.]*(?=\.)</code> - any 0+ chars other than <code>.</code> as many as possible up to <code>.</code> not including <code>.</code></li>
<li><code>.*</code> - the rest of the line</li>
</ul></li>
</ul>
<p><a href="https://ideone.com/PLNsOR" rel="nofollow noreferrer">Python demo</a>:</p>
<pre><code>import re
s = "Copyright © 2019 Apple Inc. All rights reserved.\r\n© 2019 Quid, Inc. All Rights Reserved.\r\n© 2009 Database Designs \r\n© 2019 Rediker Software, All Rights Reserved\r\n©2019 EVOSUS, INC. ALL RIGHTS RESERVED\r\n© 2019 Walmart. All Rights Reserved.\r\n© Copyright 2003-2019 Exxon Mobil Corporation. All Rights Reserved.\r\nCopyright © 1978-2019 Berkshire Hathaway Inc.\r\n© 2019 McKesson Corporation\r\n© 2019 UnitedHealth Group. All rights reserved.\r\n© Copyright 1999 - 2019 CVS Health\r\nCopyright 2019 General Motors. All Rights Reserved.\r\n© 2019 Ford Motor Company\r\n©2019 AT&amp;T Intellectual Property. All rights reserved.\r\n© 2019 GENERAL ELECTRIC\r\nCopyright ©2019 AmerisourceBergen Corporation. All Rights Reserved.\r\n© 2019 Verizon\r\n© 2019 Fannie Mae\r\nCopyright © 2018 Jonas Construction Software Inc. All rights reserved.\r\nAll Comments © Copyright 2017 Kroger | The Kroger Co. All Rights Reserved\r\n© 2019 Express Scripts Holding Company. All Rights Reserved. 1 Express Way, St. Louis, MO 63121\r\n© 2019 JPMorgan Chase &amp; Co.\r\nCopyright © 1995 - 2018 Boeing. All Rights Reserved.\r\n© 2019 Bank of America Corporation. All rights reserved.\r\n© 1999 - 2019 Wells Fargo. All rights reserved. NMLSR ID 399801\r\n©2019 Cardinal Health. All rights reserved.\r\n© 2019 Quid, Inc All Rights Reserved."
rx = r"(?:©(?:\s*Copyright)?|Copyright(?:\s*©)?)\s*\d+(?:\s*-\s*\d+)?\s*(.*?(?=\W*All\s+rights\s+reserved)|[^.\n]*(?=\.)|.*)"
for m in re.findall(rx, s, re.I):
    print(m)
</code></pre>
<p>Output:</p>
<pre><code>Apple Inc
Quid, Inc
Database Designs 
Rediker Software
EVOSUS, INC
Walmart
Exxon Mobil Corporation
Berkshire Hathaway Inc
McKesson Corporation
UnitedHealth Group
CVS Health
General Motors
Ford Motor Company
AT&amp;T Intellectual Property
GENERAL ELECTRIC
AmerisourceBergen Corporation
Verizon
Fannie Mae
Jonas Construction Software Inc
Kroger | The Kroger Co
Express Scripts Holding Company
JPMorgan Chase &amp; Co
Boeing
Bank of America Corporation
Wells Fargo
Cardinal Health
Quid, Inc
</code></pre>
</div>
<span class="comment-copy">@TimBiegeleisen: OP asking for it</span>
<span class="comment-copy">Thanks a lot! Maybe I wasn't clear enough in my question but I only want to keep the company name from the sentence, and remove everything else. For example in "Copyright © 2019 Apple Inc" I only want to keep "Apple Inc" and in "© 2019 Quid, Inc" I only want to keep "Quid, Inc". How would I change it to achieve that?</span>
<span class="comment-copy">@FilipeAleixo Wrap what you need with capturing parentheses, see my updated answer.</span>
<span class="comment-copy">@FilipeAleixo I think something can be still improved. Let me think</span>
<span class="comment-copy">Ah yeah. In Rediker Software it's still getting ", All rights reserved"</span>
<div class="post-text" itemprop="text">
<p>I am using Jython to write a code(Hyperion FDMEE/Essbase) wherein external libraries are getting imported explicitly in a function</p>
<pre><code>#FN_RETRIEVE
import os
import sys
sys.path.append("D:\\EssbaseJavaAPI\\11.1.2.0\\lib\\ess_japi.jar")
def RETRIEVE(fdmAPI, fdmContext, grid_typ):
        ## Import libraries
        from com.essbase.api.session import *
        from com.essbase.api.domain import *
        from java.lang.Object import *
        from com.essbase.api.base import *
        from com.essbase.api.datasource import *
        from com.essbase.api.dataquery import *
        from com.essbase.api.metadata import *
        from com.essbase.api.domain import *
        from com.essbase.api.session.IEssbase import *
        from com.essbase.api.domain.IEssDomain import *
        from array import *


        config = ConfigParser.ConfigParser()
        config.read("D:/somepath/config.ini")


        # Create JAPI instance.
        ess = IEssbase.Home.create(IEssbase.JAPI_VERSION) …….
</code></pre>
<p>Now, I am trying to call this function in a different script as follows</p>
<pre><code>import FN_RETRIEVE
reload(FN_RETRIEVE)

retr1 = FN_RETRIEVE.RETRIEVE(fdmAPI, fdmContext, "another param")
</code></pre>
<p>But I am getting the following error,</p>
<pre><code>ess = IEssbase.Home.create(IEssbase.JAPI_VERSION) NameError: global name 'IEssbase' is not defined
</code></pre>
<p>It probably has to do something with the scope, but need help here what I may be missing.</p>
<p>Thanks,
Dev</p>
</div>
<span class="comment-copy">Why are you using <code>reload</code>? Also, why are you putting all your import statements in the function, where (hint, hint) the modules are bound to <i>local</i> variables, not global variables?</span>
<span class="comment-copy">kept all the imports outside the function and that resolved the issue .. a silly miss from my side ..Thanks Chepner :)</span>
<div class="post-text" itemprop="text">
<p>Hello I want to make a get request and have a URL that contains </p>
<pre><code>url = "http://example.com/tags/feature%252Fexample/site/"
</code></pre>
<p>however if I do a get it changes the URL to a slash and yields an error.</p>
<pre><code>requests.get(url)
equests.exceptions.HTTPError: 400 Client Error: Bad Request for url:
http://example.com/tags/feature/example/site/
</code></pre>
<p>Is there a way to keep the url how it is without the <code>/</code> ?
I found this question but it is the other way around..
<a href="https://stackoverflow.com/questions/23496750/how-to-prevent-python-requests-from-percent-encoding-my-urls">How to prevent python requests from percent encoding my URLs?</a> and was not able to find an option in the documentation.</p>
<p>Thank you.</p>
</div>
<span class="comment-copy">Just to be sure. You mean <code>feature%2Fexample</code> without the extra <code>25</code>, right?</span>
<span class="comment-copy">I tested on my web server, and <code>requests</code> is doing the correct request to the server. It just display the "unescaped" URL. I think you are double escape (so the %25).</span>
<span class="comment-copy">The string should stay exactly as given with <code>feature%252Fexample</code></span>
<span class="comment-copy">I tried also that with my webserver, and <code>requests</code> will request the right url (so still with %252F in the URL). On Python3. What <code>requests</code> print (the "URL") is not what it was really requested.</span>
<div class="post-text" itemprop="text">
<p>I'm studying dlib model in python, and now translating C++ dnn_mmod_dog_hipsterizer code into python code, for comport to using other python module.</p>
<p>In C++ code, the given hipsterizer data is deserialized to net(network), sp(shape predictor), glasses, and mustache. But I can't find out that there is any function that deserializes customly. Only get_frontal_face_detector(), shape_detector(), etc.</p>
<pre><code>net_type net;
shape_predictor sp;
matrix&lt;rgb_alpha_pixel&gt; glasses, mustache;
deserialize(argv[1]) &gt;&gt; net &gt;&gt; sp &gt;&gt; glasses &gt;&gt; mustaches;
</code></pre>
<p>Could you suggest how to use this data in Python?</p>
</div>
<span class="comment-copy">What do you mean by <i>"deserializes customly"</i>?</span>
<span class="comment-copy">Not 100% of DLib's C++ API is available in Python, too. What is available can be found <a href="http://dlib.net/python/index.html" rel="nofollow noreferrer">here</a>. Just as an example <code>train_shape_predictor(...)</code> can be serialized with the overload parameter <code>predictor_output_filename</code> for serialization.</span>
<div class="post-text" itemprop="text">
<p>I'm new to using Pyglet in python and have some problems with my code. First of all, I don't know why setting the resolution doesn't work. Second of all, when I try to move the "snake" it doesn't do anything. Any help is appreciated.</p>
<pre><code>import pyglet
import random

pyglet.resource.path = ["resources"]
pyglet.resource.reindex()


class Snake_Window(pyglet.window.Window):

    def __init__(self):
        super(Snake_Window, self).__init__()

        self.width = 1280
        self.height = 720
        # sets the resolution of window

        self.key_handler = pyglet.window.key.KeyStateHandler()
        self.push_handlers(self.key_handler)
        # sets keys

        self.set_caption("Wild Snake")
        # gives it a name

        self.background_image = pyglet.resource.image("background.png")
        self.food_image = pyglet.resource.image("food.png")
        self.snake_head_image = pyglet.resource.image("snake_head.png")
        self.snake_body_image = pyglet.resource.image("snake_body.png")
        # makes images usable

        self.center_image(self.food_image)
        self.center_image(self.snake_head_image)
        self.center_image(self.snake_body_image)
        # centers the images using center_image

        self.snake_head = pyglet.sprite.Sprite(img=self.snake_head_image, x=200, y=200)
        self.snake_head.scale = 0.5
        self.snake_head.rotation = 180

        self.snake_body = pyglet.sprite.Sprite(img=self.snake_body_image, x=400, y=200)
        self.snake_body.scale = 0.5
        self.snake_body.rotation = 180

        self.snake_head.draw()
        self.snake_body.draw()

        self.food = []

        self.c = self.snake_head.x
        self.a = self.snake_head.x
        self.b = self.snake_head.y

        pyglet.clock.schedule_interval(self.game_tick, 1)

    def center_image(self, image):
        # sets the center of the image to the actual center
        image.anchor_x = image.width / 2
        image.anchor_y = image.height / 2

    def update_snake_head(self):
        if self.key_handler[pyglet.window.key.RIGHT]:
            self.c = self.a
            self.c += 200
        elif self.key_handler[pyglet.window.key.LEFT]:
            self.c = self.a
            self.c -= 200
        elif self.key_handler[pyglet.window.key.UP]:
            self.c = self.b
            self.c += 200
        elif self.key_handler[pyglet.window.key.DOWN]:
            self.c = self.b
            self.c -= 200
        else:
            print("čau")

    def update_snake_body(self):
        if self.key_handler[pyglet.window.key.RIGHT]:
            self.c = self.a
            self.c += 200
        elif self.key_handler[pyglet.window.key.LEFT]:
            self.c = self.a
            self.c -= 200
        elif self.key_handler[pyglet.window.key.UP]:
            self.c = self.b
            self.c += 200
        elif self.key_handler[pyglet.window.key.DOWN]:
            self.c = self.b
            self.c -= 200
        else:
            print("čau")

    def game_tick(self, dt):
        self.update_snake_head()
        self.update_snake_body()
        self.draw_elements()

    def draw_elements(self):
        self.clear()
        self.snake_head.draw()
        self.snake_body.draw()

game_window = Snake_Window()

pyglet.app.run()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>import pyglet
import random

pyglet.resource.path = ["resources"]
pyglet.resource.reindex()

class Snake_Window(pyglet.window.Window):

    def __init__(self):
        super(Snake_Window, self).__init__(width=1280, height=720)

        # sets the resolution of window

        self.key_handler = pyglet.window.key.KeyStateHandler()
        self.push_handlers(self.key_handler)
        # sets keys

        self.set_caption("Wild Snake")
        # gives it a name

        self.background_image = pyglet.resource.image("background.png")
        self.food_image = pyglet.resource.image("food.png")
        self.snake_head_image = pyglet.resource.image("snake_head.png")
        self.snake_body_image = pyglet.resource.image("snake_body.png")

        # makes images usable

        self.center_image(self.food_image)
        self.center_image(self.snake_head_image)
        self.center_image(self.snake_body_image)
        # centers the images using center_image

        self.snake_head = pyglet.sprite.Sprite(img=self.snake_head_image, x=200, y=200)
        self.snake_head.scale = 0.5
        self.snake_head.rotation = 180

        self.snake_body = pyglet.sprite.Sprite(img=self.snake_body_image, x=400, y=200)
        self.snake_body.scale = 0.5
        self.snake_body.rotation = 180

        self.snake_head.draw()
        self.snake_body.draw()

        self.food = []

        self.snake_head.x = self.snake_head.x
        self.snake_head.y = self.snake_head.y

        pyglet.clock.schedule_interval(self.game_tick, 1)

    def center_image(self, image):
        # sets the center of the image to the actual center
        image.anchor_x = image.width / 2
        image.anchor_y = image.height / 2

    def update_snake_head(self):
        if self.key_handler[pyglet.window.key.RIGHT]:
            self.snake_head.x = self.snake_head.x
            self.snake_head.x += 200
        elif self.key_handler[pyglet.window.key.LEFT]:
            self.snake_head.x = self.snake_head.x
            self.snake_head.x -= 200
        elif self.key_handler[pyglet.window.key.UP]:
            self.snake_head.x = self.snake_head.y
            self.snake_head.x += 200
        elif self.key_handler[pyglet.window.key.DOWN]:
            self.snake_head.x = self.snake_head.y
            self.snake_head.x -= 200
        else:
            print("čau")

    def update_snake_body(self):
        if self.key_handler[pyglet.window.key.RIGHT]:
            self.snake_head.x = self.snake_head.x
            self.snake_head.x += 200
        elif self.key_handler[pyglet.window.key.LEFT]:
            self.snake_head.x = self.snake_head.x
            self.snake_head.x -= 200
        elif self.key_handler[pyglet.window.key.UP]:
            self.snake_head.x = self.snake_head.y
            self.snake_head.x += 200
        elif self.key_handler[pyglet.window.key.DOWN]:
            self.snake_head.x = self.snake_head.y
            self.snake_head.x -= 200
        else:
            print("čau")

    def game_tick(self, dt):
        self.update_snake_head()
        self.update_snake_body()
        self.draw_elements()

    def draw_elements(self):
        self.clear()
        self.snake_head.draw()
        self.snake_body.draw()

game_window = Snake_Window()

pyglet.app.run()
</code></pre>
<p>Here's how you can get both issues working.<br/>
The first issue is that the width and height are defined upon creating the window (there's probably some way of changing it afterwards as well that I haven't bothered learning yet).</p>
<p>The second issue is that you update <code>self.c</code> for instance, a copy of <code>self.snake_head.x</code>. So when you think you're updating <code>.x</code> of <code>self.snake_head</code> you're actually updating the copy and nothing more.</p>
<p>The above code works around this. It's not perfect tho, for instance - the key-presses won't trigger/update until the given interval. But these are things you're probably working on after this issue.</p>
</div>
<span class="comment-copy">Welcome to stackoverflow. Please have a look at <a href="https://stackoverflow.com/help/how-to-ask">How do I ask a good question?</a> and edit your question to include a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete and Verifiable</a> example. You should ask questions to a specific problem or a specific error message instead of "Why is this code not working?".</span>
<span class="comment-copy">Because the height and width are defined as this: <code>super(Snake_Window, self).__init__(width=800, height=600)</code> and not defined after the window is created (the <b>init</b> creates the window)</span>
<span class="comment-copy">The second problem being you updating <code>self.c</code> and not <code>self.snake_head.x</code>. Those values are not bound to each other. I'm assuming you thought you created a "shortcut" for the different elements - but you didn't. You've created copies of the integer representing the position of the snake upon start. But you're not actually updating the snake, you're updating the copy :)</span>
<span class="comment-copy">Thanks, guys the resolution is working fine.</span>
<span class="comment-copy">Thanks. I figured it out in the end but still have some problems. If you would be so kind and look here about other issues I have.<a href="https://stackoverflow.com/questions/55264615/having-problem-with-the-movement-of-a-snakes-body-in-pyglet" title="having problem with the movement of a snakes body in pyglet">stackoverflow.com/questions/55264615/…</a></span>
<div class="post-text" itemprop="text">
<p>I'm am setting up to start learning Machine Learning next week. But every time I try to upload any type of machine learning files into Pycharm, it always comes up as an error and it either says the files can't be installed or else if it does install, the file cant be imported in a project.
I have tried this with both Tensorflow and Theano.
I have also uploaded Anaconda several times to my laptop to try aid with this but every time I upload Anaconda it wont import any of the files, in Spyder, Pycharm, etc.
My laptop does have all the correct specs to run machine learning.
Any advice would be welcome. Thanks</p>
</div>
<span class="comment-copy">first advice: Give us the error, the code you run, what you have tried, and any other details that might help us. For now your question is too broad and can't be answered.(thus the downvotes)</span>
<span class="comment-copy">Thanks Alexis.   When trying to install Theano it says - WARNING (theano.configdefaults): g++ not available, if using conda: <code>conda install m2w64-toolchain</code>   UserWarning: DeprecationWarning: there is no c++ compiler.This is deprecated and with Theano 0.11 a c++ compiler will be mandatory   warnings.warn("DeprecationWarning: there is no c++ compiler." WARNING (theano.tensor.blas): Using NumPy C-API based implementation for BLAS functions</span>
<span class="comment-copy">Please <i>do not</i> post such kind of additional info (code &amp; error messages) in the comments space! This should already be part of your original post - so <b>edit &amp; update</b> it accordingly...</span>
<div class="post-text" itemprop="text">
<p>We have jirapython integration library.  We create issue through python script.like create_issue. But same as i want remove issue function. I referred many docs,blogs and official site. But i did not get this solution. Can anyone pls help me this issue.</p>
</div>
<div class="post-text" itemprop="text">
<p>This is pretty trivial. If you want to delete an issue, you need the issue object. One way to obtain the object is via <code>jira.create_issue()</code> function that you mentioned in which case you can delete it as follows:</p>
<pre><code>issue = jira.create_issue(...)
...
issue.delete()
</code></pre>
<p>Alternatively if you happen to know the ID of the issue you want to delete you could delete it like so:</p>
<pre><code>issue = jira.issue("EXAMPLE-244")
issue.delete()
</code></pre>
<p>If you don't know the IDs of the issues you want to delete, you might first have to find the issues via the <code>jira.search_issues()</code> function. This would look like:</p>
<pre><code>issues = jira.search_issues('project="%s" AND summary~"%s"' % ("project_key", "issue title"), maxResults=100)

for issue in issues:
    issue.delete()
</code></pre>
</div>
<span class="comment-copy"><a href="https://jira.readthedocs.io/en/master/api.html" rel="nofollow noreferrer">jira.readthedocs.io/en/master/api.html</a> They have a delete() method there, not sure what else you need</span>
<div class="post-text" itemprop="text">
<p>I'm trying to extract certain text fields from this website but new to angular. I am using selenium to build this web scrapper. I noticed that the exact text value is not stored in the html code. Can someone help or provide some tips to go about this. I tried using:</p>
<pre><code>find_element_by_id
find_element_by_name
find_element_by_xpath
find_element_by_link_text
find_element_by_partial_link_text
find_element_by_tag_name
find_element_by_class_name
find_element_by_css_selector
</code></pre>
<p>But got no progress. Thank you :) </p>
<p>This is one way I tried to extract the text: </p>
<pre class="lang-python prettyprint-override"><code>def csc():
    alpah_list = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P"]
    indexOfAlpha = 0
    indexOfSheet = 2
    for x in range(2,4):
        y = x + 2
        driver.implicitly_wait(20)
        ranSleep()
        driver.find_element_by_xpath('/html/body/div[1]/div[2]/div/div/div[1]/div[1]/div[2]/div/div/div/div[2]/div[2]/div/div['+ str(x) +']/div/div/div[6]/a').click()
        driver.implicitly_wait(20)
        worksheet.write(alpah_list[indexOfAlpha] + str(indexOfSheet), str(driver.find_element(By.CSS_SELECTOR("input[class = 'edited_field ng-pristine ng-untouched ng-valid ng-not-empty'][ng-model = 'tab.content.site.name']"))))
        ranSleep()
        driver.find_element_by_xpath('/html/body/div[1]/div[2]/div/div/ul/li[2]/a/span').click()
        ranSleep()
        indexOfSheet += 1
</code></pre>
<p>But i get this error on terminal </p>
<pre class="lang-terminal prettyprint-override"><code>Traceback (most recent call last):
  File "selTest.py", line 88, in &lt;module&gt;
    csc()
  File "selTest.py", line 44, in csc
    worksheet.write(alpah_list[indexOfAlpha] + str(indexOfSheet), driver.find_element(By.cssSelector("input[class = 'edited_field ng-pristine ng-untouched ng-valid ng-not-empty'][ng-model = 'tab.content.site.name']")))
AttributeError: type object 'By' has no attribute 'cssSelector'
Shahans-MacBook-Pro:WebScraping Shahan$ python3 selTest.py 
Traceback (most recent call last):
  File "selTest.py", line 88, in &lt;module&gt;
    csc()
  File "selTest.py", line 44, in csc
    worksheet.write(alpah_list[indexOfAlpha] + str(indexOfSheet), driver.find_element(By.CSS_SELECTOR("input[class = 'edited_field ng-pristine ng-untouched ng-valid ng-not-empty'][ng-model = 'tab.content.site.name']")))
TypeError: 'str' object is not callable
Shahans-MacBook-Pro:WebScraping Shahan$ python3 selTest.py 
Traceback (most recent call last):
  File "selTest.py", line 88, in &lt;module&gt;
    csc()
  File "selTest.py", line 44, in csc
    worksheet.write(alpah_list[indexOfAlpha] + str(indexOfSheet), str(driver.find_element(By.CSS_SELECTOR("input[class = 'edited_field ng-pristine ng-untouched ng-valid ng-not-empty'][ng-model = 'tab.content.site.name']"))))
TypeError: 'str' object is not callable
</code></pre>
<p>P.S I'm sorry I will not be able to share the website since it requires a private login. </p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;input class="edited_field ng-pristine ng-untouched ng-valid ng-not-empty" type="text" ng-model="tab.content.site.name" ng-disabled="!tab.content.updateBtnPermission" disabled="disabled"&gt;</code></pre>
</div>
</div>
</p>
<p><a href="https://i.stack.imgur.com/8tMdY.png" rel="nofollow noreferrer">Snippet of the text I want to extract with the html and angular code</a></p>
<p>The error for Qharr</p>
<p>This is the code i wrote based on Qharr comment</p>
<pre class="lang-python prettyprint-override"><code>def csc():
    alpah_list = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P"]
    indexOfAlpha = 0
    indexOfSheet = 2
    for x in range(2,4):
        y = x + 2
        driver.implicitly_wait(20)
        ranSleep()
        driver.find_element_by_xpath('/html/body/div[1]/div[2]/div/div/div[1]/div[1]/div[2]/div/div/div/div[2]/div[2]/div/div['+ str(x) +']/div/div/div[6]/a').click()
        driver.implicitly_wait(20)
        worksheet.write(alpah_list[indexOfAlpha] + str(indexOfSheet), driver.find_element_by_css_selector('input.edited_field.ng-pristine.ng-untouched.ng-valid.ng-not-empty'))
        ranSleep()
        driver.find_element_by_xpath('/html/body/div[1]/div[2]/div/div/ul/li[2]/a/span').click()
        ranSleep()
        indexOfSheet += 1
</code></pre>
<pre class="lang-Terminal prettyprint-override"><code>Traceback (most recent call last):
  File "selTest.py", line 88, in &lt;module&gt;
    csc()
  File "selTest.py", line 44, in csc
    worksheet.write(alpah_list[indexOfAlpha] + str(indexOfSheet), str(driver.find_element(By.CSS_SELECTOR("input[class = 'edited_field ng-pristine ng-untouched ng-valid ng-not-empty'][ng-model = 'tab.content.site.name']"))))
TypeError: 'str' object is not callable
Shahans-MacBook-Pro:WebScraping Shahan$ python3 selTest.py 
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/xlsxwriter/worksheet.py", line 469, in _write
    f = float(token)
TypeError: float() argument must be a string or a number, not 'WebElement'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "selTest.py", line 88, in &lt;module&gt;
    csc()
  File "selTest.py", line 44, in csc
    worksheet.write(alpah_list[indexOfAlpha] + str(indexOfSheet), driver.find_element_by_css_selector('input.edited_field.ng-pristine.ng-untouched.ng-valid.ng-not-empty'))
  File "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/xlsxwriter/worksheet.py", line 67, in cell_wrapper
    return method(self, *args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/xlsxwriter/worksheet.py", line 408, in write
    return self._write(row, col, *args)
  File "/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/xlsxwriter/worksheet.py", line 474, in _write
    raise TypeError("Unsupported type %s in write()" % type(token))
TypeError: Unsupported type &lt;class 'selenium.webdriver.remote.webelement.WebElement'&gt; in write()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Current error complains about compound class names. Try</p>
<pre><code>driver.find_element_by_css_selector('input.edited_field.ng-pristine.ng-untouched.ng-valid.ng-not-empty'))
</code></pre>
<p>You may need a wait condition as well and possibly can shorten the selector to use less classes.</p>
</div>
<span class="comment-copy">Did you try <code>driver.execute_script("arguments[0].value", element)</code>?</span>
<span class="comment-copy">How would i use that</span>
<span class="comment-copy">Please read why a <a href="https://meta.stackoverflow.com/questions/303812/discourage-screenshots-of-code-and-or-errors">screenshot of HTML or code or error is a bad idea</a>. Consider updating the Question with formatted text based relevant HTML, code trials and error stack trace.</span>
<span class="comment-copy"><i>How</i> you used the methods is more important than <i>which</i> methods you used. Post the complete code fragment that didn't work as well as the error message.</span>
<span class="comment-copy">Thank will update now :0</span>
<span class="comment-copy">This doesn't work even after I added driver.implicityly_wait(10)</span>
<span class="comment-copy">You'll need to be more descriptive than <i>doesn't work</i></span>
<span class="comment-copy">This is the error I get on terminal   selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"css selector","selector":"input.edited_field.ng-pristine.ng-untouched.ng-valid ng-not-empty"}</span>
<span class="comment-copy">Please edit the relevant html into your question. Use the snippet tool to insert (not an image)</span>
<span class="comment-copy">Just updated it</span>
<div class="post-text" itemprop="text">
<pre><code>app = Flask(__name__)
firebase = pyrebase.initialize_app(config)
auth = firebase.auth()
db = firebase.database()

@app.route('/login', methods=["POST", "GET"])
    def login():
        message = ""
        if request.method == "POST":
            email = request.form["login_email"]
            password = request.form["login_password"]
            try:
                user = auth.sign_in_with_email_and_password(email, password)
                user = auth.refresh(user['refreshToken'])
                user_id = user['idToken']
                return redirect(url_for('admin'))
            except:
                message = "Incorrect Password!"
        return render_template("login.html", message=message)

@app.route('/admin')
def admin():
    return render_template("admin.html")

if __name__ == '__main__':
    app.run()
</code></pre>
<p>How can I only load <code>/admin</code> page when the user is logged in? I know it has something to do with the user token, but I'm still not sure about how I could use the token to identify whether the user is logged in or not. Also, the <code>user</code> and <code>user_id</code> are not defined in <code>admin()</code>and only in <code>login()</code> since they're in a function. </p>
<p>So what do I need to change in my code in order to only load the <code>/admin</code> page when the user is logged in?</p>
</div>
<div class="post-text" itemprop="text">
<p>use flask session to store your key,if key exist then user is logged,</p>
<p>also you can access all session variables globally for individual session</p>
<pre><code>from flask import Flask, session, request
import requests
import os

app = Flask(__name__)
app.secret_key = os.urandom(24)
firebase = pyrebase.initialize_app(config)
auth = firebase.auth()
db = firebase.database()

@app.route('/login', methods=["POST", "GET"])
def login():
    message = ""
    try:
        print(session['usr'])
        return redirect(url_for('admin'))
    except KeyError:
        if request.method == "POST":
            email = request.form["login_email"]
            password = request.form["login_password"]
            try:
                user = auth.sign_in_with_email_and_password(email, password)
                user = auth.refresh(user['refreshToken'])
                user_id = user['idToken']
                session['usr'] = user_id
                return redirect(url_for('admin'))
            except:
                message = "Incorrect Password!"
        return render_template("login.html", message=message)

@app.route('/admin')
def admin():
    try:
        print(session['usr'])
        return render_template("admin.html")
    except KeyError:
        return redirect(url_for('login'))


if __name__ == '__main__':
    app.run()
</code></pre>
<p>if <code>session['usr']</code> is not assigned then it will give key error which means that usr in not logged in. but note that in the process of logout you need to delete the session for that usr.</p>
</div>
<span class="comment-copy">Thank you for replying. I am wondering how I could use flask session to know whether the user is logged in or not in <code>admin()</code>.  Should I use <code>if session['usr'] == "":</code> or something else? The token would expire too, so I'm not sure what to do in <code>admin()</code> yet. Thank you!</span>
<span class="comment-copy">i posted a code for that,</span>
<span class="comment-copy">Sorry, but how about in <code>admin()</code>?</span>
<span class="comment-copy">updated my answer</span>
<span class="comment-copy">Thank you for helping, @Nihal, I finally figured it out.</span>
<div class="post-text" itemprop="text">
<p>I'm looking to do some numeric integration on a function where I only have samples from the function, and can't generate arbitrary new samples. I understand that over in the python universe this is can be achieved via scipy.integrate.simps(), but my workflow is currently in R. Any suggestions on R functions/packages to achieve this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Assuming you have a vector of x-values and a vector of y-values, you can apply Simpson's rule fairly easily.</p>
<pre class="lang-r prettyprint-override"><code>simpson &lt;- function(x, y)
{
    if(length(x) &lt; 5)
        stop("Must have at least 5 values")
    if(length(x) %% 2 == 0)
        stop("Number of values must be odd")
    ord &lt;- order(x)
    x &lt;- x[ord]
    y &lt;- y[ord]
    diffs &lt;- diff(x)
    delta &lt;- mean(diffs)
    if((max(diffs) - min(diffs))/delta &gt; 1e-6)
        stop("X-values must be equally spaced")
    coefs &lt;- c(1, 4, rep(c(2, 4), (length(x) - 3)/2), 1)
    sum(coefs*y)*delta/3
}

simpson(1:7, (1:7)^2
# [1] 114
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I am a beginner in Flask. Instead of static data delivery (due to size) I would like to make database calls based on the interactions (queries) of the end-user in the frontend. 
I can't find any example on the net about how to proceed. I have been thinking about something like:</p>
<pre><code>@app.route("/")
def index():
    return render_template('index.html')


@app.before_first_request
def initialize_database():
    pass

@app.route('api/data')
def get_data_by_selecting_bounding_box():
    pass 
</code></pre>
<p>data are tweets and the user shall be able to select an area (bounding-box) on a map and get back a response retrieved from the Mongodb database of data included in the area. </p>
</div>
<div class="post-text" itemprop="text">
<p>So you have a few problems to solve:</p>
<ol>
<li>Manage the db connection.</li>
<li>Query the DB</li>
<li>Return the result</li>
</ol>
<p>Let's start with the mongo connection:</p>
<pre><code>from pymongo import MongoClient
client = MongoClient(URI_STRING)
</code></pre>
<p>Here you establish the mongodb client with pymongo. Now you can access your db on the mongodb service as:</p>
<pre><code>db = client["my-DB-name"]
</code></pre>
<p>From here, you can access collections like your collection of locations, which I will assume is called <code>locations</code>. You can access it like <code>db.locations.find(...)</code></p>
<p>Now you need to query the db. Your API needs to accept <code>lat1, lat2, long1, long2</code> to represent the bounds of the bounding box. Here I'm going to assume they are <code>.args</code> as described in the <a href="http://flask.pocoo.org/docs/0.12/quickstart/#the-request-object" rel="nofollow noreferrer">docs</a></p>
<pre><code>@app.route('api/data')
def get_data_by_selecting_bounding_box():
    cursor = db.locations.find(
    "$and":[
    {"lat": {"$gt": requests.args.get("lat1", 0)}},
    {"lat": {"$lt": requests.args.get("lat2", 0)}},
    {"long": {"$gt": requests.args.get("long1", 0)}},
    {"long": {"$lt": requests.args.get("long2", 0)}}
    ])
</code></pre>
<p>Now you can <code>return</code> the cursor at the end of this route handler, in whatever manner your <code>html</code> template calls for. It could be as simple as:</p>
<pre><code>    return [doc for docs in cursor]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I have several <a href="http://en.wikipedia.org/wiki/Comma-separated_values" rel="noreferrer">CSV</a> files that look like this:</p>
<pre class="lang-none prettyprint-override"><code>Input
Name        Code
blackberry  1
wineberry   2
rasberry    1
blueberry   1
mulberry    2
</code></pre>
<p>I would like to add a new column to all CSV files so that it would look like this:</p>
<pre class="lang-none prettyprint-override"><code>Output
Name        Code    Berry
blackberry  1   blackberry
wineberry   2   wineberry
rasberry    1   rasberry
blueberry   1   blueberry
mulberry    2   mulberry
</code></pre>
<p>The script I have so far is this:</p>
<pre><code>import csv
with open(input.csv,'r') as csvinput:
    with open(output.csv, 'w') as csvoutput:
        writer = csv.writer(csvoutput)
        for row in csv.reader(csvinput):
            writer.writerow(row+['Berry'])
</code></pre>
<p>(Python 3.2)</p>
<p>But in the output, the script skips every line and the new column has only Berry in it:</p>
<pre class="lang-none prettyprint-override"><code>Output
Name        Code    Berry
blackberry  1   Berry

wineberry   2   Berry

rasberry    1   Berry

blueberry   1   Berry

mulberry    2   Berry
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This should give you an idea of what to do:</p>
<pre><code>&gt;&gt;&gt; v = open('C:/test/test.csv')
&gt;&gt;&gt; r = csv.reader(v)
&gt;&gt;&gt; row0 = r.next()
&gt;&gt;&gt; row0.append('berry')
&gt;&gt;&gt; print row0
['Name', 'Code', 'berry']
&gt;&gt;&gt; for item in r:
...     item.append(item[0])
...     print item
...     
['blackberry', '1', 'blackberry']
['wineberry', '2', 'wineberry']
['rasberry', '1', 'rasberry']
['blueberry', '1', 'blueberry']
['mulberry', '2', 'mulberry']
&gt;&gt;&gt; 
</code></pre>
<p>Edit, note in py3k you must use <code>next(r)</code></p>
<p>Thanks for accepting the answer. Here you have a bonus (your working script):</p>
<pre><code>import csv

with open('C:/test/test.csv','r') as csvinput:
    with open('C:/test/output.csv', 'w') as csvoutput:
        writer = csv.writer(csvoutput, lineterminator='\n')
        reader = csv.reader(csvinput)

        all = []
        row = next(reader)
        row.append('Berry')
        all.append(row)

        for row in reader:
            row.append(row[0])
            all.append(row)

        writer.writerows(all)
</code></pre>
<p>Please note </p>
<ol>
<li>the <code>lineterminator</code> parameter in <code>csv.writer</code>. By default it is
set to <code>'\r\n'</code> and this is why you have double spacing.</li>
<li>the use of a list to append all the lines and to write them in
one shot with <code>writerows</code>. If your file is very, very big this
probably is not a good idea (RAM) but for normal files I think it is
faster because there is less I/O.</li>
<li><p>As indicated in the comments to this post, note that instead of
nesting the two <code>with</code> statements, you can do it in the same line:</p>
<p>with open('C:/test/test.csv','r') as csvinput, open('C:/test/output.csv', 'w') as csvoutput:</p></li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p>I'm surprised no one suggested Pandas. Although using a set of dependencies like Pandas might seem more heavy-handed than is necessary for such an easy task, it produces a very short script and Pandas is a great library for doing all sorts of CSV (and really all data types) data manipulation. Can't argue with 4 lines of code:</p>
<pre><code>import pandas as pd
csv_input = pd.read_csv('input.csv')
csv_input['Berries'] = csv_input['Name']
csv_input.to_csv('output.csv', index=False)
</code></pre>
<p>Check out <a href="http://pandas.pydata.org/" rel="noreferrer">Pandas Website</a> for more information!</p>
<p>Contents of <code>output.csv</code>:</p>
<pre><code>Name,Code,Berries
blackberry,1,blackberry
wineberry,2,wineberry
rasberry,1,rasberry
blueberry,1,blueberry
mulberry,2,mulberry
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>import csv
with open('input.csv','r') as csvinput:
    with open('output.csv', 'w') as csvoutput:
        writer = csv.writer(csvoutput)

        for row in csv.reader(csvinput):
            if row[0] == "Name":
                writer.writerow(row+["Berry"])
            else:
                writer.writerow(row+[row[0]])
</code></pre>
<p>Maybe something like that is what you intended?</p>
<p>Also, csv stands for comma separated values.  So, you kind of need commas to separate your values like this I think:</p>
<pre><code>Name,Code
blackberry,1
wineberry,2
rasberry,1
blueberry,1
mulberry,2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I used pandas and it worked well...
While I was using it, I had to open a file and add some random columns to it and then save back to same file only.</p>
<p>This code adds multiple column entries, you may edit as much you need.</p>
<pre><code>import pandas as pd

csv_input = pd.read_csv('testcase.csv')         #reading my csv file
csv_input['Phone1'] = csv_input['Name']         #this would also copy the cell value 
csv_input['Phone2'] = csv_input['Name']
csv_input['Phone3'] = csv_input['Name']
csv_input['Phone4'] = csv_input['Name']
csv_input['Phone5'] = csv_input['Name']
csv_input['Country'] = csv_input['Name']
csv_input['Website'] = csv_input['Name']
csv_input.to_csv('testcase.csv', index=False)   #this writes back to your file
</code></pre>
<p>If you want that cell value doesn't gets copy, so first of all create a empty Column in your csv file manually, like you named it as <strong><em>Hours</em></strong>
then,  Now for this you can add this line in above code,</p>
<pre><code>csv_input['New Value'] = csv_input['Hours']
</code></pre>
<p>or simply we can, without adding the manual column, we can</p>
<pre><code>csv_input['New Value'] = ''    #simple and easy
</code></pre>
<p><strong>I Hope it helps.</strong></p>
</div>
<div class="post-text" itemprop="text">
<p>I don't see where you're adding the new column, but try this:</p>
<pre><code>    import csv
    i = 0
    Berry = open("newcolumn.csv","r").readlines()
    with open(input.csv,'r') as csvinput:
        with open(output.csv, 'w') as csvoutput:
            writer = csv.writer(csvoutput)
            for row in csv.reader(csvinput):
                writer.writerow(row+","+Berry[i])
                i++
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This code will suffice your request and I have tested on the sample code. </p>
<pre><code>import csv

with open(in_path, 'r') as f_in, open(out_path, 'w') as f_out:
    csv_reader = csv.reader(f_in, delimiter=';')
    writer = csv.writer(f_out)

    for row in csv_reader:
    writer.writerow(row + [row[0]]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Yes Its a old question but it might help some</p>
<pre><code>import csv
import uuid

# read and write csv files
with open('in_file','r') as r_csvfile:
    with open('out_file','w',newline='') as w_csvfile:

        dict_reader = csv.DictReader(r_csvfile,delimiter='|')
        #add new column with existing
        fieldnames = dict_reader.fieldnames + ['ADDITIONAL_COLUMN']
        writer_csv = csv.DictWriter(w_csvfile,fieldnames,delimiter='|')
        writer_csv.writeheader()


        for row in dict_reader:
            row['ADDITIONAL_COLUMN'] = str(uuid.uuid4().int &gt;&gt; 64) [0:6]
            writer_csv.writerow(row)
</code></pre>
</div>
<span class="comment-copy">possible duplicate of <a href="http://stackoverflow.com/questions/11063707/copy-one-column-to-another-but-with-different-header">Copy one column to another but with different header</a></span>
<span class="comment-copy">is it possible you only have 'Berry' in your last column because you are only writing 'Berry' to the file? (row+['Berry'])  What did you expect to write?</span>
<span class="comment-copy">@Dhara: I would like to have Berry as a header and Name column value as row value for the Berry. See above.</span>
<span class="comment-copy">you also use pandas data frame as  suggested in this <a href="https://stackoverflow.com/questions/33139513/python-pandas-insert-column">page</a></span>
<span class="comment-copy">thanks for the note. I tried and it gives me attribute error: '_csv.reader' object has no attribute 'next'. Do you have any idea?</span>
<span class="comment-copy">I see you are in py3k. then you must use next(r) instead of r.next()</span>
<span class="comment-copy">it works now. Thank you so much for your help!!</span>
<span class="comment-copy">＠joaquin: OMG. Thanks for the bonus!!</span>
<span class="comment-copy">Note: instead of nesting <code>with</code> statements, you can do it at the same line separating them with a comma e.g.: <code>with open(input_filename) as input_file, open(output_filename, 'w') as output_file</code></span>
<span class="comment-copy">Thanks @Jough Dempsey!</span>
<span class="comment-copy">wow. amazing suggestion!</span>
<span class="comment-copy">does this work ?</span>
<span class="comment-copy">I fixed it, so it does, but his input.csv is wrong too.</span>
<span class="comment-copy">@jgritty: thanks for your help.</span>
<span class="comment-copy">Create a new question on stack overflow.</span>
<span class="comment-copy">again, does this work ?</span>
<div class="post-text" itemprop="text">
<p>I am trying to make a car dodging game in pygame, I just learnt python and learning pygame .</p>
<p>I have made a function things which a called a times with different parameters of x axis to draw to rectangles as I want player to dodge 2 rects .But i cant figure out to delay the second one so that they doesnt not come at the same time.</p>
<p>I want the second to be drawn after some delay, basically some difference in their y axis. attaching a image here and code </p>
<p><a href="https://i.stack.imgur.com/fCYuB.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/fCYuB.png"/></a> </p>
<pre><code>import pygame
import time
import random

pygame.init()

display_width=600
display_height=800

black=(0,0,0)
white=(255,255,255)
red=(255,0,0)
green=(0,255,0)
blue=(0,0,255)
brown=(165,42,42)

car_width=60

gameDisplay=pygame.display.set_mode((display_width,display_height))

pygame.display.set_caption("Lets Race")

bg = pygame.image.load("road.png")

clock=pygame.time.Clock()

CarImg=pygame.image.load("Image.png")

pygame.mouse.set_visible(1)



def things_dodged(count):
    font=pygame.font.SysFont(None,40)
    text=font.render("Score "+str(count),True,black)
    gameDisplay.blit(text,(20,20))

def car(x,y):
    gameDisplay.blit(CarImg,(x,y))

def things(thingx,thingy,thingw,thingh,color):
    color=brown

    pygame.draw.rect(gameDisplay,color,[thingx,thingy,thingw,thingh])

def text_objects(text,font):
    textSurface=font.render(text, True, white)
    return textSurface, textSurface.get_rect()

def message_display(text):
    largeText=pygame.font.Font('freesansbold.ttf',80)
    TextSurf, TextRect=text_objects(text, largeText)
    TextRect.center=((display_width/2),(display_height/2))
    gameDisplay.blit(TextSurf, TextRect)

    pygame.display.update()

    time.sleep(2)

    game_loop()

def crash():
    message_display('Game Over')

def game_loop():
    x=(display_width*0.48)
    y=(display_height*0.79)

    x_change=0

    thing_startx=random.randrange(0,display_width-100)
    thing_startx2=random.randrange(0,display_width-100)
    thing_starty=-600
    thing_speed=9
    thing_width=100
    thing_height=100

    dodged=0

    gameExit=False

    while not gameExit:

        for event in pygame.event.get():
            if event.type==pygame.QUIT:
                pygame.quit()
                quit()

            if event.type==pygame.KEYDOWN:
                if event.key==pygame.K_LEFT:
                    x_change=-15
                elif event.key==pygame.K_RIGHT:
                    x_change=15

            if event.type==pygame.KEYUP:
                if event.key==pygame.K_LEFT or event.key==pygame.K_RIGHT:
                    x_change=0

        x+=x_change

        #gameDisplay.fill(white)
        gameDisplay.blit(bg, (0, 0))

        #things(thingx,thingy,thingw,thingh,color)
        things(thing_startx,thing_starty,thing_width,thing_height,black)
        things(thing_startx2,thing_starty,thing_width,thing_height,black)


        thing_starty+=thing_speed
        car(x,y)
        things_dodged(dodged)

        if x&gt;display_width-car_width or x&lt;0:
            crash()
        if thing_starty&gt;display_height:
            thing_starty=0-thing_height
            thing_startx=random.randrange(0,display_width-100)
            dodged+=1
            if thing_speed&lt;15:
                thing_speed+=0.15

        if y&lt;thing_starty+thing_height:
            pass

            if x&gt;thing_startx and x&lt;thing_startx+thing_width or x+car_width&gt;thing_startx and x+car_width&lt;thing_startx+thing_width:
                crash()

        pygame.display.update()
        clock.tick(100)

game_loop()
pygame.quit()
quit()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The 2 rectangles have 2 different x coordinates (<code>thing_startx</code> , <code>thing_startx2</code>). They've to have 2 different y coordinates, too.  </p>
<p>Create a list of "things", which is basically a list of positions (x and y coordinates):</p>
<pre class="lang-py prettyprint-override"><code>thing_list = [
    [random.randrange(0,display_width-100), -600],
    [random.randrange(0,display_width-100), -300]]
thing_speed=9
thing_width=100
thing_height=100
</code></pre>
<p>Operate on the list of things in the main loop.<br/>
Further I recommend to use <a href="https://www.pygame.org/docs/ref/rect.html#pygame.Rect.colliderect" rel="nofollow noreferrer"><code>pygame.Rect.colliderect()</code></a> to chek for collisions.</p>
<pre class="lang-py prettyprint-override"><code>while not gameExit:

    # [...]

    for thing in thing_list:
        things(*thing, thing_width, thing_height, black)
        thing[1] += thing_speed

    car(x,y)
    things_dodged(dodged)

    if x&gt;display_width-car_width or x&lt;0:
        crash()

    carRect = pygame.Rect(x, y, car_width, 1)
    for thing in thing_list:
        if thing[1] &gt; display_height:
            thing[0] = random.randrange(0,display_width-100)
            thing[1] = 0-thing_height;
            dodged += 1
            thing_speed = min(thing_speed+0.15, 15)
        if carRect.colliderect(pygame.Rect(*thing, thing_width, thing_height)):
            crash()

    pygame.display.update()
    clock.tick(100)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I have the following import in my python code:</p>
<pre><code>from apps.balance.models import BLOCKED, CREDIT, TRIAL, TrialAlert
</code></pre>
<p>But PEP8/flake8 tells my that <code>TrialAlert</code> is not used. In the code itself, it really isn't used, but I do use it in MyPy annotations, so I've trying to add a "noqa" <strong>just for it</strong>, without success. If I change the line to </p>
<pre><code>from apps.balance.models import BLOCKED, CREDIT, TRIAL, TrialAlert   # noqa # pylint: disable=unused-import
</code></pre>
<p>It works! But then I believe it will ignore the other imports, which are used. I also tried</p>
<pre><code>from apps.balance.models import (                                                                                       
    BLOCKED,                                                                                                            
    CREDIT,                                                                                                             
    TRIAL,                                                                                                              
    TrialAlert   # noqa # pylint: disable=unused-import                                                                 
)
</code></pre>
<p>But it also didn't worked. Can anybody tell me how to ignore <strong>just</strong> that last import?</p>
</div>
<span class="comment-copy">I do not think it's possible due to the way the interpreter/grammar works. Your best bet would probably be to split it to 2 different imports: <code>from apps.balance.models import BLOCKED, CREDIT, TRIAL ; from apps.balance.models import TrialAlert   # noqa # pylint: disable=unused-import </code>, unfortunately violating DYI.</span>
<span class="comment-copy">Side note: PEP8 changed its name to <a href="https://github.com/PyCQA/pycodestyle" rel="nofollow noreferrer">pycodestyle</a> by <a href="https://github.com/PyCQA/pycodestyle/issues/466" rel="nofollow noreferrer">request of Guido Van Rossum</a> about three ago.</span>
<span class="comment-copy">I meant "unfortunately violating <i>DRY</i>", of course....</span>
<span class="comment-copy">You should never import individual symbols from a module. Instead <code>from apps.balance import models</code> then use <code>models. BLOCKED</code>, etc.</span>
<span class="comment-copy">@KurtisRader Can you please supply more details on why we should never import individual constants, methods or class, and instead just import the whole file?</span>
<div class="post-text" itemprop="text">
<p>I’m currently in the process of porting software from Python 2.7 to Python 3.7, and I’m seeing something that I have no idea how to address. When I type “python –m project.main” to run the software, about 50% of the time nothing happens and a fresh command prompt line prints after a few seconds with no error message or traceback whatsoever. The other half of the time, the program runs perfectly. There doesn’t appear to be any discernable pattern of success vs failure</p>
<p>To try and gather further information, I tried out Python 3’s “faulthandler” package, but most of the time I still see no error message. Once in a while, it does print a cryptic “Windows fatal exception: access violation” with accompanying traceback (but no further details), but again there seems to be no pattern as to when the message prints among the failed runs.</p>
<p>As background, the software builds a QApplication (PyQt5), and we’re running on Windows 10 with Anacdona 3.7. As I mentioned, we recently upgraded from Python 2.7, and never saw anything like this. Most of the migration has gone relatively smoothly – like I said, when the program does run, it works fine.</p>
<p>Has anyone else encountered anything like this? The apparent randomness of the failures is driving me crazy.</p>
</div>
<span class="comment-copy">Have you tried doing the same thing with a minimal project containing nothing but a shell QApplication and a QMainWindow? Run it a few times. This will immediately give you a hint as to whether it's your application or your installation at fault.</span>
<span class="comment-copy">@replete Good idea. A skeletal QApplication (I copied the sample from <a href="https://doc.qt.io/qtforpython/tutorials/basictutorial/dialog.html" rel="nofollow noreferrer">here</a>) seems to run reliably, so it looks like it's related to the code itself.</span>
<div class="post-text" itemprop="text">
<p>It appears as if root.mainloop() blocks any attempt to update a textbox with text. I am trying to create a kind of status text area that will display strings of messages as I am running a python program. </p>
<pre><code>top.mainloop()

chat.insert(tkinter.END, "Hello")
</code></pre>
<p>the insert never gets called. I know that the mainloop is blocking the call, so my question is, how does one get around this block to update the textbox with messages? The second line is a line I would like to have throughout my code (obviously with a different line of text other than Hello). </p>
</div>
<span class="comment-copy">Yes, <code>mainloop</code> blocks afaik. You'd have to do any additions on a separate thread if you want them to happen once you've started the app.</span>
<span class="comment-copy"><code>mainloop</code> is, as the name suggests, a loop. You stay in this loop until the tkinter window is closed. In this loop, tkinter checks for events that have happened since the last loop iteration and handles these events. The main thing you need to answer is: when do you want to update the text? When the program starts? When a user interacts with the GUI? Or after a certain amount of time? You need to understand that everything that happens in tkinter is based on events.</span>
<span class="comment-copy">According to my needs, I need it to happen when certain function calls are made. The window is a status window letting me know what is going on as the program is running. So I'm thinking after a certain amount of time. So running a timer that has a callback function might do it?</span>
<span class="comment-copy">@DaveK: First you have to understand <a href="https://stackoverflow.com/a/9343402/7414759">Event-driven programming</a></span>
<div class="post-text" itemprop="text">
<p>Here is the TensorBoard graph for TotalLoss of a custom model I'am trying to build but still can't achieve the desired output.
On the basis of graph to how much steps should I continue this process to achieve a usable model if my <strong>batchsize = 12?</strong>
<a href="https://i.stack.imgur.com/dGr6y.jpg" rel="nofollow noreferrer">https://i.stack.imgur.com/dGr6y.jpg</a></p>
</div>
<span class="comment-copy">Welcome to StackOverflow. Please read <a href="https://stackoverflow.com/help/how-to-ask">stackoverflow.com/help/how-to-ask</a></span>
<div class="post-text" itemprop="text">
<p>I have DF loaded by pd.read_csv(). 500mb, 4 columns, 50xxx rows. I need to delete all rows with <code>0</code> or <code>-</code> (gap) in 3th (Allele1 - AB) or 4th (Allele2 - AB) columns.</p>
<p>My code:
<em>Read CSV</em></p>
<pre><code>data_skipped = pd.read_csv(cwd + file_list[i], sep='\t', skiprows = row_skipped_value, header = 0, index_col = False, dtype=object, low_memory = True)
</code></pre>
<p><em>Deleting gaps</em></p>
<pre><code>fixed_data = fixed_data.loc[fixed_data['Allele1 - AB' or 'Allele2 - AB'] != gap].dropna()
</code></pre>
<p>After deleting gaps line i got error: </p>
<pre><code>KeyError: MemoryError()
</code></pre>
<p>If I delete that line, all it's fine and next steps works fine (but in result I have files with gaps). 14GB free RAM.</p>
<p>Any advise or solution?</p>
</div>
<div class="post-text" itemprop="text">
<p>Your code does not do what you want.</p>
<p><strong>Pandas does not use <code>and</code>, <code>or</code> etc. as boolean operator.</strong> See <a href="http://pandas.pydata.org/pandas-docs/version/0.24.2/user_guide/indexing.html#boolean-indexing" rel="nofollow noreferrer">Pandas documentation</a>:</p>
<blockquote>
<p>Another common operation is the use of boolean vectors to filter the data. The operators are: | for or, &amp; for and, and ~ for not. These <strong>must</strong> be grouped by using parentheses</p>
</blockquote>
<p>So you should filter data in this way. Instead of:</p>
<pre><code>fixed_data = fixed_data.loc[fixed_data['Allele1 - AB' or 'Allele2 - AB'] != gap].dropna()
</code></pre>
<p>Do:</p>
<pre><code>fixed_data.loc[(fixed_data['Allele1 - AB'] != gap) | (fixed_data['Allele2 - AB'] != gap)].dropna()
</code></pre>
<p>And this does not require additional import of other packages.</p>
</div>
<div class="post-text" itemprop="text">
<p>You should try using </p>
<pre><code>fixed_data.loc[fixed_data['Allele1 - AB' or 'Allele2 - AB'] != gap].dropna(inplace=True)
</code></pre>
<p>, and not reassigning it (it will return <code>None</code>).
In that case no copy of the array will be created, see <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dropna.html" rel="nofollow noreferrer">here</a>.</p>
<p>Update:
I think your code does not make that much sense in the first place. <code>'Allele1 - AB' or 'Allele2 - AB'</code> will always evaluate to <code>'Allele1 - AB'</code>.
I am guessing you want to drop all rows containing <code>NaN</code> and only keep rows where column <code>Allele1 - AB</code> is not equal to <code>gap</code> and <code>Allele2 - AB</code> is not equal to <code>gap</code>.</p>
<p>In that case use:</p>
<pre><code>import numpy as np
fixed_data = fixed_data[np.logical_or(fixed_data["Allele1 - AB"] != gap, fixed_data["Allele2 - AB"] != gap)].dropna()
</code></pre>
</div>
<span class="comment-copy">Are you sure <code>fixed_data.loc[fixed_data['Allele1 - AB' or 'Allele2 - AB'] != gap]</code> will work? Shouldn't it be <code>fixed_data.loc[(fixed_data['Allele1 - AB'] != gap) | (fixed_data['Allele2 - AB'] != gap)]</code>?</span>
<span class="comment-copy">I have a different file formats, and when I try it on smaller files, everything is fine. Gaps are deleting. But in this example yours code work. Thank u very much ! In this case, I will change that part of the code in scripts for others files :)</span>
<span class="comment-copy">Are you still getting <code>MemoryError</code>?</span>
<span class="comment-copy">No, ur code repair everything :D thank u very much. All works.</span>
<span class="comment-copy">Thank u for advice, I will learn about it more. :) But code it's still not working. I got the same error in the same line :/ What else can cause it?</span>
<span class="comment-copy">See update. Your code does not do what you want I think</span>
<div class="post-text" itemprop="text">
<p>I've a really big json object that I want to dump into a pickle file. Is there a way to display a progress bar while using <code>pickle.dump</code>?</p>
</div>
<div class="post-text" itemprop="text">
<p>The only way that I know of is to define getstate/setstate methods to return "sub objects" which can refresh the GUI when the get pickled/unpickled. For example, if your object is a list, you could use something like this: </p>
<pre><code>import pickle

class SubList:
    on_pickling = None

    def __init__(self, sublist):
        print('SubList', sublist)
        self.data = sublist

    def __getstate__(self):
        if SubList.on_pickling is not None:
            print('SubList pickle state fetch: calling sub callback')
            SubList.on_pickling()
        return self.data

    def __setstate__(self, obj):
        if SubList.on_pickling is not None:
            print('SubList pickle state restore: calling sub callback')
            SubList.on_pickling()
        self.data = obj


class ListSubPickler:
    def __init__(self, data: list):
        self.data = data

    def __getstate__(self):
        print('creating SubLists for pickling long list')
        num_chunks = 10
        span = int(len(self.data) / num_chunks)
        SubLists = [SubList(self.data[i:(i + span)]) for i in range(0, len(self.data), span)]
        return SubLists

    def __setstate__(self, subpickles):
        self.data = []
        print('restoring Pickleable(list)')
        for subpickle in subpickles:
            self.data.extend(subpickle.data)
        print('final', self.data)


def refresh():
    # do something: refresh GUI (for example, qApp.processEvents() for Qt), show progress, etc
    print('refreshed')
</code></pre>
<p>If you run the following in that script,</p>
<pre><code>data = list(range(100))  # your large data object
list_pickler = ListSubPickler(data)
SubList.on_pickling = refresh

print('\ndumping pickle of', list_pickler)
pickled = pickle.dumps(list_pickler)

print('\nloading from pickle')
new_list_pickler = pickle.loads(pickled)
assert new_list_pickler.data == data

print('\nloading from pickle, without on_pickling')
SubList.on_pickling = None
new_list_pickler = pickle.loads(pickled)
assert new_list_pickler.data == data
</code></pre>
<p>You will see that the refresh callback gets called 10 times. So if you have 2GB list to dump, and it takes 1 minute to dump, so you'd want roughly 60*10 = 600 GUI refreshes, you would then set your number of chunks to be 600. </p>
<p>Code is easily modified for a dict, numpy array, etc. </p>
</div>
<span class="comment-copy">It's almost instantaneous, Why would you like to have a progress bar ? is your file size exceeding 10MB ?</span>
<span class="comment-copy">Well, the size of the json that I'm trying to dump could be arbitrary.</span>
<span class="comment-copy">maybe you can use the len of the json string to, kind of, sort of, determine the size of the pickle and deduce the current progress.</span>
<span class="comment-copy">Thanks for the suggestions, but somehow, it feels like a hack. The original intent of the question was to expose any hidden functionality in the <code>cPickle</code> library.</span>
<span class="comment-copy"><a href="http://stackoverflow.com/users/834066/sid">stackoverflow.com/users/834066/sid</a> Did you find any solution ? I am looking for a progress while doing pickle.load()</span>
<div class="post-text" itemprop="text">
<p>I am trying to train a neural network on a subset of the GPU's that I have access to.
The problem is that I want to use only two GPU's so I wrote the following command in the .bashrc:</p>
<p><code>export CUDA_VISIBLE_DEVICES=6,7</code></p>
<p>However, when I watch the gpus, I find that my program is mainly using other GPU's (4,5) with 100% memory utilization and using only the visible gpus with very low memory utilization (9% maximum).</p>
<p>I have already closed and reopened all the terminals to restart the ~/.bashrc but the problem still persists!</p>
<p>Any help is appreciated!</p>
<p>P.S: I already successfully ran the same program before on only two GPUs but on a different server, so the memory is not a constraint here.</p>
</div>
<span class="comment-copy">Did you check from the terminal in which you run your script that the <code>CUDA_VISIBLE_DEVICES</code> is set correctly?</span>
<span class="comment-copy">Also maybe the ordering on the machine is different than in CUDA. I need to set CUDA_DEVICE_ORDER to PCI_BUS_ID to get the correct GPUs.</span>
<span class="comment-copy">@FlyingTeller yes I already did that and it showed (6,7)  edit: ok may bad! I was checking the <code>CUDA_VISIBLE_DEVICES</code> from the terminal and not from the tmux session. I closed all the terminals but I forgot the tmux session!</span>
<div class="post-text" itemprop="text">
<p>Apologies, as I am new to the Programming world for asking novice question.</p>
<p>When I try to run the below code first time it is running fine, I can perform all the 3 operations perfectly, but when I try to run the same code again, I am getting an error as "list index out of range". </p>
<p>Any help and suggestions would be highly appreciated.</p>
<pre><code># To create a new file

ob=open(r'C:\Python27\avi_file_handling\cred_assgn.txt','w')
ob.write("Number" + "-" + "Username" + ":" + "Password" + '\n')
i=0
for x in range(5):
    uid=raw_input("Please enter your username to login\n")
    pswd=raw_input("Please enter your password {} to login\n".format(uid))
    ob.write(str(i) + "     " "-" " " + uid + " : " + pswd + '\n')
    i=i+1   
ob.close()
</code></pre>
<p>After creating the new file from the above code ,I ran the below code to call these operations.</p>
<pre><code>import re

# function to validate the userId and password for the customers present in a text file
def validate_user():  
    T=0
    global uid,pswd,T,c1,f1
    f1=open(r'C:\Python27\avi_file_handling\cred_assgn.txt','r+')
    f1.seek(0)
    print f1.tell()
    uid=raw_input("Please enter your username to validate\n")
    print f1.tell()
    pswd=raw_input("Please enter your password {} to validate\n".format(uid))
    print f1.tell()
    for line in f1:

        c1=re.split(r'(-|:+|)',line.replace(' ','').strip())
        if((uid==c1[2]) and (pswd==c1[4])):
            print("welcome sir ",uid,"you are a valid user\n")
            print f1.tell()
            T+=1
            return

    else:
        print("Sir",uid, "Please enter the correct Username and Password")

#Function to add a new user            
def AddNew_User():
    with open(r'C:\Python27\avi_file_handling\cred_assgn.txt','r+') as ob1:
        uid=raw_input("Please enter username to Register\n")
        ob1.seek(0,0)
        z=0
        print ob1.tell()
        for line in ob1:
            z=z+1
            x=z

            #z=sum(1 for _ in ob1)
            c1=re.split(r'(-|:+|)',line.replace(' ','').strip()) 

            if uid==c1[2]:    
                print "Sorry sir {},you are already registered, we cannot register you again".format(uid)
                break
        else:
            pswd=raw_input("Please enter your password for userid {} to register\n".format(uid))
            print ob1.tell()
            if uid==pswd:
                print "Sorry {} sir you cannot have same username and password".format(uid)
                return
            pswd2=raw_input("Please confirm your password once again for userid {} to register\n".format(uid))
            print ob1.tell()
            if pswd!=pswd2:
                print "You have entered incorrect confrim password"
                return

            print ob1.tell()
            print  "Hello {} you have successful registered to us".format(uid)
            print ob1.tell()
            ob1.write(str(x) + "     " "-" " " + uid + " : " + pswd + '\n')
            print ob1.tell()

            ob1.close()

#Function to update the password of an Existing user
def Update_password():

    #print "up" ,f1.tell()
    #global f1

    validate_user()
    #print "up" ,f1.tell()
    print "previous one",c1

    if T&gt;0:

        #print "up" ,f1.tell()
        pswd3=raw_input("Hello {} Please entrer your new password")
        #print "-up" ,f1.tell()
        pswd4=raw_input("Hello {} once agin password")
        print "1--up" ,f1.tell()
        print pswd,pswd4,pswd3,uid
        if  pswd==pswd3:
            print "Please enter the new password and do not repeat"
        elif pswd3==pswd4:
            #print "---up" ,f1.tell()
            print c1[4]
        print "11--up" ,f1.tell()
        f1.seek(0)
        ch=f1.read().replace(c1[4],pswd4)
        print "2----up" ,f1.tell()
        print ch
        print "3----wup" ,f1.tell()
        #ob.seek(2)
        print "4----qup" ,f1.tell()
        f1.seek(2)
        f1.write(ch)
        print "5----qup" ,f1.tell()
        #contents = f.read().replace('Total: __00__', total)
        #print "up" ,f1.tell()
        print "poassower matcg"
        #ob.seek(0,0)    
        f1.close()

#Main function calling  
while(True):
    Inputs=input("Please select the operation you would like to perform sir\n 1) Valudate user\n 2) Add new user \n 3) Update password \n5)Exit from the program")
    if Inputs==1:
        validate_user()
    elif Inputs==2:
        AddNew_User()
    elif Inputs==3:
        Update_password()
    elif Inputs==5:   
        break
</code></pre>
</div>
<span class="comment-copy">Post the full error with trace, and try to reduce this code down to a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a>.</span>
<span class="comment-copy">when i go for Validate_user function, I am getting below error</span>
<span class="comment-copy">Traceback (most recent call last):   File "C:/Python27/Always_temp.py", line 120, in &lt;module&gt;     validate_user()   File "C:/Python27/Always_temp.py", line 30, in validate_user     if((uid==c1[2]) and (pswd==c1[4])): IndexError: list index out of range</span>
<span class="comment-copy">Hi All, can anyone please help me with this problem, It will be very grateful.</span>
<span class="comment-copy">Double check what <code>c1</code> is. Evidently it doesn't have 5 elements like your think.</span>
<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/22102276/how-to-let-the-user-reuse-a-result-from-the-previous-computation-in-a-python-cal">How to let the user reuse a result from the previous computation in a python calculator</a>
<span class="question-originals-answer-count">
                    3 answers
                </span>
</li>
</ul>
</div>
<p>So in python we have the interpreter spitting out evaluations
of the last expression.</p>
<pre><code>&gt;&gt;&gt; 1 + 2
3
</code></pre>
<p>So my question is "Is the output (3) kept in a variable, and if yes, how do I access it?"</p>
</div>
<div class="post-text" itemprop="text">
<p>Yes, you can access it like this:</p>
<pre><code>&gt;&gt;&gt; 1 + 2
3
&gt;&gt;&gt; _
3
&gt;&gt;&gt;
</code></pre>
<p><code>_</code> will keep result of last expression.</p>
</div>
<span class="comment-copy">Try <code>_</code> and enter.</span>
<span class="comment-copy">why not just assign the expression to a variable to begin with?</span>
<span class="comment-copy">If you put it as an answer i will accept it, thank you @pistol2myhead</span>
<span class="comment-copy">_ returns only the last value. Why wouldn't you assign a variable name to it?</span>
<span class="comment-copy">Well, it's to use for my calculator script, I was getting tired of writing down the output of the last expression / pressing up and editing. Pressing up works but it ends up being a very long formula sometimes.</span>
<span class="comment-copy">..until reassigned</span>
<div class="post-text" itemprop="text">
<p>Since Keras is using tensorflow as backend, in theory we can use tensorflow operations such as <code>tf.logical_not</code>, <code>tf.eye</code>, <code>tf.diag_part</code> in keras, aren't we?</p>
<p>I saw a triplet online mining implementation in tensorflow <a href="https://omoindrot.github.io/triplet-loss" rel="nofollow noreferrer">here</a>, and I would like to use it with keras instead. So I just copy the loss function written in tensorflow to keras loss function as shown below:</p>
<pre><code>def batch_hard_triplet_loss(margin=1, squared=False):
    """Build the triplet loss over a batch of embeddings.

    For each anchor, we get the hardest positive and hardest negative to form a triplet.

    Args:
        labels: labels of the batch, of size (batch_size,)
        embeddings: tensor of shape (batch_size, embed_dim)
        margin: margin for triplet loss
        squared: Boolean. If true, output is the pairwise squared euclidean distance matrix.
                 If false, output is the pairwise euclidean distance matrix.

    Returns:
        triplet_loss: scalar tensor containing the triplet loss
    """
    def loss(labels, embeddings):
        # Get the pairwise distance matrix
        pairwise_dist = _pairwise_distances(embeddings, squared=squared)

        # For each anchor, get the hardest positive
        # First, we need to get a mask for every valid positive (they should have same label)
        mask_anchor_positive = _get_anchor_positive_triplet_mask(labels)
        mask_anchor_positive = tf.to_float(mask_anchor_positive)

        # We put to 0 any element where (a, p) is not valid (valid if a != p and label(a) == label(p))
        anchor_positive_dist = tf.multiply(mask_anchor_positive, pairwise_dist)

        # shape (batch_size, 1)
        hardest_positive_dist = tf.reduce_max(anchor_positive_dist, axis=1, keepdims=True)
        tf.summary.scalar("hardest_positive_dist", tf.reduce_mean(hardest_positive_dist))

        # For each anchor, get the hardest negative
        # First, we need to get a mask for every valid negative (they should have different labels)
        mask_anchor_negative = _get_anchor_negative_triplet_mask(labels)
        mask_anchor_negative = tf.to_float(mask_anchor_negative)

        # We add the maximum value in each row to the invalid negatives (label(a) == label(n))
        max_anchor_negative_dist = tf.reduce_max(pairwise_dist, axis=1, keepdims=True)
        anchor_negative_dist = pairwise_dist + max_anchor_negative_dist * (1.0 - mask_anchor_negative)

        # shape (batch_size,)
        hardest_negative_dist = tf.reduce_min(anchor_negative_dist, axis=1, keepdims=True)
        tf.summary.scalar("hardest_negative_dist", tf.reduce_mean(hardest_negative_dist))

        # Combine biggest d(a, p) and smallest d(a, n) into final triplet loss
        triplet_loss = tf.maximum(hardest_positive_dist - hardest_negative_dist + margin, 0.0)

        # Get final mean triplet loss
        triplet_loss = tf.reduce_mean(triplet_loss)

        return triplet_loss
    return loss
</code></pre>
<p>Then I compile my Keras model like this</p>
<pre><code>model.compile(loss=batch_hard_triplet_loss(margin=1, squared=False), optimizer=adam_optim)
</code></pre>
<p>The model underwent training successfully, but cluster is wrong.
<a href="https://i.stack.imgur.com/JVMDJ.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/JVMDJ.png"/></a></p>
<p>Now, if I train with the original tensorflow code, I get the following cluster instead, which is correct:
<a href="https://i.stack.imgur.com/DpII2.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/DpII2.png"/></a></p>
<p>There's essentially no difference between the two model, but how do they give a different result? The only thing I am not sure is whether mixing tensorflow operations such as <code>tf.matmal</code>  with keras will cause any problem. Other than this, I cannot think of any cause to the difference.</p>
<h2>My full Keras code:</h2>
<pre><code>import numpy as np
from sklearn.metrics import roc_curve
from sklearn.neighbors import KNeighborsClassifier
from sklearn.preprocessing import MinMaxScaler
import random
import matplotlib.patheffects as PathEffects
from keras.layers import Input, Conv2D, Lambda, Dense, Flatten,MaxPooling2D, concatenate
from keras.models import Model, Sequential
from keras.regularizers import l2
from keras import backend as K
from keras.optimizers import SGD,Adam
from keras.losses import binary_crossentropy
import os
import pickle
import matplotlib.pyplot as plt
import tensorflow as tf
from itertools import permutations
import seaborn as sns
from keras.datasets import mnist
from sklearn.manifold import TSNE
from sklearn.svm import SVC
from keras.backend.tensorflow_backend import set_session

(x_train, y_train), (x_test, y_test) = mnist.load_data()
def scatter(x, labels, subtitle=None):
    num_class = len(set(labels))

    # We choose a color palette with seaborn.
    palette = np.array(sns.color_palette("hls", 10))

    # We create a scatter plot.
    f = plt.figure(figsize=(8, 8))
    ax = plt.subplot(aspect='equal')
    sc = ax.scatter(x[:,0], x[:,1], lw=0, s=40,
                    c=palette[labels.astype(np.int)])
    plt.xlim(-25, 25)
    plt.ylim(-25, 25)
    ax.axis('off')
    ax.axis('tight')

    # We add the labels for each digit.
    txts = []
    for i in range(num_class):
        # Position of each label.
        xtext, ytext = np.median(x[labels == i, :], axis=0)
        txt = ax.text(xtext, ytext, str(i), fontsize=24)
        txt.set_path_effects([
            PathEffects.Stroke(linewidth=5, foreground="w"),
            PathEffects.Normal()])
        txts.append(txt)

    if subtitle != None:
        plt.suptitle(subtitle)

#     plt.savefig(subtitle)


# In[9]:


x_train_flat = x_train.reshape(-1,784)
x_test_flat = x_test.reshape(-1,784)


# In[10]:


tsne = TSNE()
train_tsne_embeds = tsne.fit_transform(x_train_flat[:512])
scatter(train_tsne_embeds, y_train[:512], "Samples from Training Data")

eval_tsne_embeds = tsne.fit_transform(x_test_flat[:512])
scatter(eval_tsne_embeds, y_test[:512], "Samples from Validation Data")

def _get_triplet_mask(labels):
    """Return a 3D mask where mask[a, p, n] is True iff the triplet (a, p, n) is valid.

    A triplet (i, j, k) is valid if:
        - i, j, k are distinct
        - labels[i] == labels[j] and labels[i] != labels[k]

    Args:
        labels: tf.int32 `Tensor` with shape [batch_size]
    """
    # Check that i, j and k are distinct
    indices_equal = tf.cast(tf.eye(tf.shape(labels)[0]), tf.bool)
    indices_not_equal = tf.logical_not(indices_equal)
    i_not_equal_j = tf.expand_dims(indices_not_equal, 2)
    i_not_equal_k = tf.expand_dims(indices_not_equal, 1)
    j_not_equal_k = tf.expand_dims(indices_not_equal, 0)

    distinct_indices = tf.logical_and(tf.logical_and(i_not_equal_j, i_not_equal_k), j_not_equal_k)


    # Check if labels[i] == labels[j] and labels[i] != labels[k]
    label_equal = tf.equal(tf.expand_dims(labels, 0), tf.expand_dims(labels, 1))
    i_equal_j = tf.expand_dims(label_equal, 2)
    i_equal_k = tf.expand_dims(label_equal, 1)

    valid_labels = tf.logical_and(i_equal_j, tf.logical_not(i_equal_k))

    # Combine the two masks
    mask = tf.logical_and(distinct_indices, valid_labels)

    return mask


def _get_anchor_positive_triplet_mask(labels):
    """Return a 2D mask where mask[a, p] is True iff a and p are distinct and have same label.

    Args:
        labels: tf.int32 `Tensor` with shape [batch_size]

    Returns:
        mask: tf.bool `Tensor` with shape [batch_size, batch_size]
    """
    # Check that i and j are distinct
    indices_equal = tf.cast(tf.eye(tf.shape(labels)[0]), tf.bool)
    indices_not_equal = tf.logical_not(indices_equal)

    # Check if labels[i] == labels[j]
    # Uses broadcasting where the 1st argument has shape (1, batch_size) and the 2nd (batch_size, 1)
    labels_equal = tf.equal(tf.expand_dims(labels, 0), tf.expand_dims(labels, 1))

    # Combine the two masks
    mask = tf.logical_and(indices_not_equal, labels_equal)

    return mask


def _get_anchor_negative_triplet_mask(labels):
    """Return a 2D mask where mask[a, n] is True iff a and n have distinct labels.

    Args:
        labels: tf.int32 `Tensor` with shape [batch_size]

    Returns:
        mask: tf.bool `Tensor` with shape [batch_size, batch_size]
    """
    # Check if labels[i] != labels[k]
    # Uses broadcasting where the 1st argument has shape (1, batch_size) and the 2nd (batch_size, 1)
    labels_equal = tf.equal(tf.expand_dims(labels, 0), tf.expand_dims(labels, 1))

    mask = tf.logical_not(labels_equal)

    return mask


def _pairwise_distances(embeddings, squared=False):
    """Compute the 2D matrix of distances between all the embeddings.

    Args:
        embeddings: tensor of shape (batch_size, embed_dim)
        squared: Boolean. If true, output is the pairwise squared euclidean distance matrix.
                 If false, output is the pairwise euclidean distance matrix.

    Returns:
        pairwise_distances: tensor of shape (batch_size, batch_size)
    """
    # Get the dot product between all embeddings
    # shape (batch_size, batch_size)
    dot_product = tf.matmul(embeddings, tf.transpose(embeddings))

    # Get squared L2 norm for each embedding. We can just take the diagonal of `dot_product`.
    # This also provides more numerical stability (the diagonal of the result will be exactly 0).
    # shape (batch_size,)
    square_norm = tf.diag_part(dot_product)

    # Compute the pairwise distance matrix as we have:
    # ||a - b||^2 = ||a||^2  - 2 &lt;a, b&gt; + ||b||^2
    # shape (batch_size, batch_size)
    distances = tf.expand_dims(square_norm, 1) - 2.0 * dot_product + tf.expand_dims(square_norm, 0)

    # Because of computation errors, some distances might be negative so we put everything &gt;= 0.0
    distances = tf.maximum(distances, 0.0)

    if not squared:
        # Because the gradient of sqrt is infinite when distances == 0.0 (ex: on the diagonal)
        # we need to add a small epsilon where distances == 0.0
        mask = tf.to_float(tf.equal(distances, 0.0))
        distances = distances + mask * 1e-16

        distances = tf.sqrt(distances)

        # Correct the epsilon added: set the distances on the mask to be exactly 0.0
        distances = distances * (1.0 - mask)

    return distances

def batch_hard_triplet_loss(margin=1, squared=False):
    """Build the triplet loss over a batch of embeddings.

    For each anchor, we get the hardest positive and hardest negative to form a triplet.

    Args:
        labels: labels of the batch, of size (batch_size,)
        embeddings: tensor of shape (batch_size, embed_dim)
        margin: margin for triplet loss
        squared: Boolean. If true, output is the pairwise squared euclidean distance matrix.
                 If false, output is the pairwise euclidean distance matrix.

    Returns:
        triplet_loss: scalar tensor containing the triplet loss
    """
    def loss(labels, embeddings):
        # Get the pairwise distance matrix
        pairwise_dist = _pairwise_distances(embeddings, squared=squared)

        # For each anchor, get the hardest positive
        # First, we need to get a mask for every valid positive (they should have same label)
        mask_anchor_positive = _get_anchor_positive_triplet_mask(labels)
        mask_anchor_positive = tf.to_float(mask_anchor_positive)

        # We put to 0 any element where (a, p) is not valid (valid if a != p and label(a) == label(p))
        anchor_positive_dist = tf.multiply(mask_anchor_positive, pairwise_dist)

        # shape (batch_size, 1)
        hardest_positive_dist = tf.reduce_max(anchor_positive_dist, axis=1, keepdims=True)
        tf.summary.scalar("hardest_positive_dist", tf.reduce_mean(hardest_positive_dist))

        # For each anchor, get the hardest negative
        # First, we need to get a mask for every valid negative (they should have different labels)
        mask_anchor_negative = _get_anchor_negative_triplet_mask(labels)
        mask_anchor_negative = tf.to_float(mask_anchor_negative)

        # We add the maximum value in each row to the invalid negatives (label(a) == label(n))
        max_anchor_negative_dist = tf.reduce_max(pairwise_dist, axis=1, keepdims=True)
        anchor_negative_dist = pairwise_dist + max_anchor_negative_dist * (1.0 - mask_anchor_negative)

        # shape (batch_size,)
        hardest_negative_dist = tf.reduce_min(anchor_negative_dist, axis=1, keepdims=True)
        tf.summary.scalar("hardest_negative_dist", tf.reduce_mean(hardest_negative_dist))

        # Combine biggest d(a, p) and smallest d(a, n) into final triplet loss
        triplet_loss = tf.maximum(hardest_positive_dist - hardest_negative_dist + margin, 0.0)

        # Get final mean triplet loss
        triplet_loss = tf.reduce_mean(triplet_loss)

        return triplet_loss
    return loss

def create_base_network(in_dims):
    """
    Base network to be shared.
    """
    model = Sequential()
    model.add(Conv2D(128,(7,7),padding='same',input_shape=(in_dims[0],in_dims[1],in_dims[2],),activation='relu',name='conv1'))
    model.add(MaxPooling2D((2,2),(2,2),padding='same',name='pool1'))
    model.add(Conv2D(256,(5,5),padding='same',activation='relu',name='conv2'))
    model.add(MaxPooling2D((2,2),(2,2),padding='same',name='pool2'))
    model.add(Flatten(name='flatten'))
    model.add(Dense(4,name='embeddings'))
    # model.add(Dense(600))

    return model

adam_optim = Adam(lr=0.0001, beta_1=0.9, beta_2=0.999)


# In[14]:


input_layer = Input((28,28,1, ), name='input')

# Shared embedding layer for positive and negative items
Shared_DNN = create_base_network([28,28,1,])

embeddings = Shared_DNN(input_layer)

model = Model(inputs=input_layer, outputs=embeddings)
model.compile(loss=batch_hard_triplet_loss(margin=1, squared=False), optimizer=adam_optim)

model.fit(np.expand_dims(x_train,-1),y=y_train, batch_size=128, epochs=2)

tsne = TSNE()
X_train_trm = model.predict(x_train.reshape(-1,28,28,1))
X_test_trm = model.predict(x_test.reshape(-1,28,28,1))
train_tsne_embeds = tsne.fit_transform(X_train_trm[:512])
eval_tsne_embeds = tsne.fit_transform(X_test_trm[:512])
# train_tsne_embeds = X_train_trm[:512]
# eval_tsne_embeds = X_test_trm[:512]

# In[22]:


scatter(train_tsne_embeds, y_train[:512], "Training Data After TNN")
</code></pre>
<h2>My full tensorflow code:</h2>
<pre><code>import tensorflow as tf
import numpy as np
import os
from sklearn.manifold import TSNE
import matplotlib.pyplot as plt
import seaborn as sns
import matplotlib.patheffects as PathEffects

tf.logging.set_verbosity(tf.logging.INFO)

def scatter(x, labels, subtitle=None):
    num_class = len(set(labels))

    # We choose a color palette with seaborn.
    palette = np.array(sns.color_palette("hls", 10))

    # We create a scatter plot.
    f = plt.figure(figsize=(8, 8))
    ax = plt.subplot(aspect='equal')
    sc = ax.scatter(x[:,0], x[:,1], lw=0, s=40,
                    c=palette[labels.astype(np.int)])
    plt.xlim(-25, 25)
    plt.ylim(-25, 25)
    ax.axis('off')
    ax.axis('tight')

    # We add the labels for each digit.
    txts = []
    for i in range(num_class):
        # Position of each label.
        xtext, ytext = np.median(x[labels == i, :], axis=0)
        txt = ax.text(xtext, ytext, str(i), fontsize=24)
        txt.set_path_effects([
            PathEffects.Stroke(linewidth=5, foreground="w"),
            PathEffects.Normal()])
        txts.append(txt)

    if subtitle != None:
        plt.suptitle(subtitle)

    plt.savefig(subtitle)

"""Define functions to create the triplet loss with online triplet mining."""
def _pairwise_distances(embeddings, squared=False):
    """Compute the 2D matrix of distances between all the embeddings.
    Args:
        embeddings: tensor of shape (batch_size, embed_dim)
        squared: Boolean. If true, output is the pairwise squared euclidean distance matrix.
                 If false, output is the pairwise euclidean distance matrix.
    Returns:
        pairwise_distances: tensor of shape (batch_size, batch_size)
    """
    # Get the dot product between all embeddings
    # shape (batch_size, batch_size)
    dot_product = tf.matmul(embeddings, tf.transpose(embeddings))

    # Get squared L2 norm for each embedding. We can just take the diagonal of `dot_product`.
    # This also provides more numerical stability (the diagonal of the result will be exactly 0).
    # shape (batch_size,)
    square_norm = tf.diag_part(dot_product)

    # Compute the pairwise distance matrix as we have:
    # ||a - b||^2 = ||a||^2  - 2 &lt;a, b&gt; + ||b||^2
    # shape (batch_size, batch_size)
    distances = tf.expand_dims(square_norm, 1) - 2.0 * dot_product + tf.expand_dims(square_norm, 0)

    # Because of computation errors, some distances might be negative so we put everything &gt;= 0.0
    distances = tf.maximum(distances, 0.0)

    if not squared:
        # Because the gradient of sqrt is infinite when distances == 0.0 (ex: on the diagonal)
        # we need to add a small epsilon where distances == 0.0
        mask = tf.to_float(tf.equal(distances, 0.0))
        distances = distances + mask * 1e-16

        distances = tf.sqrt(distances)

        # Correct the epsilon added: set the distances on the mask to be exactly 0.0
        distances = distances * (1.0 - mask)

    return distances


def _get_anchor_positive_triplet_mask(labels):
    """Return a 2D mask where mask[a, p] is True iff a and p are distinct and have same label.
    Args:
        labels: tf.int32 `Tensor` with shape [batch_size]
    Returns:
        mask: tf.bool `Tensor` with shape [batch_size, batch_size]
    """
    # Check that i and j are distinct
    indices_equal = tf.cast(tf.eye(tf.shape(labels)[0]), tf.bool)
    indices_not_equal = tf.logical_not(indices_equal)

    # Check if labels[i] == labels[j]
    # Uses broadcasting where the 1st argument has shape (1, batch_size) and the 2nd (batch_size, 1)
    labels_equal = tf.equal(tf.expand_dims(labels, 0), tf.expand_dims(labels, 1))

    # Combine the two masks
    mask = tf.logical_and(indices_not_equal, labels_equal)

    return mask


def _get_anchor_negative_triplet_mask(labels):
    """Return a 2D mask where mask[a, n] is True iff a and n have distinct labels.
    Args:
        labels: tf.int32 `Tensor` with shape [batch_size]
    Returns:
        mask: tf.bool `Tensor` with shape [batch_size, batch_size]
    """
    # Check if labels[i] != labels[k]
    # Uses broadcasting where the 1st argument has shape (1, batch_size) and the 2nd (batch_size, 1)
    labels_equal = tf.equal(tf.expand_dims(labels, 0), tf.expand_dims(labels, 1))

    mask = tf.logical_not(labels_equal)

    return mask


def _get_triplet_mask(labels):
    """Return a 3D mask where mask[a, p, n] is True iff the triplet (a, p, n) is valid.
    A triplet (i, j, k) is valid if:
        - i, j, k are distinct
        - labels[i] == labels[j] and labels[i] != labels[k]
    Args:
        labels: tf.int32 `Tensor` with shape [batch_size]
    """
    # Check that i, j and k are distinct
    indices_equal = tf.cast(tf.eye(tf.shape(labels)[0]), tf.bool)
    indices_not_equal = tf.logical_not(indices_equal)
    i_not_equal_j = tf.expand_dims(indices_not_equal, 2)
    i_not_equal_k = tf.expand_dims(indices_not_equal, 1)
    j_not_equal_k = tf.expand_dims(indices_not_equal, 0)

    distinct_indices = tf.logical_and(tf.logical_and(i_not_equal_j, i_not_equal_k), j_not_equal_k)


    # Check if labels[i] == labels[j] and labels[i] != labels[k]
    label_equal = tf.equal(tf.expand_dims(labels, 0), tf.expand_dims(labels, 1))
    i_equal_j = tf.expand_dims(label_equal, 2)
    i_equal_k = tf.expand_dims(label_equal, 1)

    valid_labels = tf.logical_and(i_equal_j, tf.logical_not(i_equal_k))

    # Combine the two masks
    mask = tf.logical_and(distinct_indices, valid_labels)

    return mask

def batch_hard_triplet_loss(labels, embeddings, margin, squared=False):
    """Build the triplet loss over a batch of embeddings.
    For each anchor, we get the hardest positive and hardest negative to form a triplet.
    Args:
        labels: labels of the batch, of size (batch_size,)
        embeddings: tensor of shape (batch_size, embed_dim)
        margin: margin for triplet loss
        squared: Boolean. If true, output is the pairwise squared euclidean distance matrix.
                 If false, output is the pairwise euclidean distance matrix.
    Returns:
        triplet_loss: scalar tensor containing the triplet loss
    """
    # Get the pairwise distance matrix
    pairwise_dist = _pairwise_distances(embeddings, squared=squared)

    # For each anchor, get the hardest positive
    # First, we need to get a mask for every valid positive (they should have same label)
    mask_anchor_positive = _get_anchor_positive_triplet_mask(labels)
    mask_anchor_positive = tf.to_float(mask_anchor_positive)

    # We put to 0 any element where (a, p) is not valid (valid if a != p and label(a) == label(p))
    anchor_positive_dist = tf.multiply(mask_anchor_positive, pairwise_dist)

    # shape (batch_size, 1)
    hardest_positive_dist = tf.reduce_max(anchor_positive_dist, axis=1, keepdims=True)
    tf.summary.scalar("hardest_positive_dist", tf.reduce_mean(hardest_positive_dist))

    # For each anchor, get the hardest negative
    # First, we need to get a mask for every valid negative (they should have different labels)
    mask_anchor_negative = _get_anchor_negative_triplet_mask(labels)
    mask_anchor_negative = tf.to_float(mask_anchor_negative)

    # We add the maximum value in each row to the invalid negatives (label(a) == label(n))
    max_anchor_negative_dist = tf.reduce_max(pairwise_dist, axis=1, keepdims=True)
    anchor_negative_dist = pairwise_dist + max_anchor_negative_dist * (1.0 - mask_anchor_negative)

    # shape (batch_size,)
    hardest_negative_dist = tf.reduce_min(anchor_negative_dist, axis=1, keepdims=True)
    tf.summary.scalar("hardest_negative_dist", tf.reduce_mean(hardest_negative_dist))

    # Combine biggest d(a, p) and smallest d(a, n) into final triplet loss
    triplet_loss = tf.maximum(hardest_positive_dist - hardest_negative_dist + margin, 0.0)

    # Get final mean triplet loss
    triplet_loss = tf.reduce_mean(triplet_loss)

    return triplet_loss

def cnn_model_fn(features, labels, mode):
    """Model function for CNN."""
    # Input Layer
    input_layer = tf.reshape(features["x"], [-1, 28, 28, 1])

    # Convolutional Layer #1
    conv1 = tf.layers.conv2d(
      inputs=input_layer,
      filters=128,
      kernel_size=[7, 7],
      padding="same",
      activation=tf.nn.relu)

    # Pooling Layer #1
    pool1 = tf.layers.max_pooling2d(inputs=conv1, pool_size=[2, 2], strides=2)

    # Convolutional Layer #2 and Pooling Layer #2
    conv2 = tf.layers.conv2d(
      inputs=pool1,
      filters=256,
      kernel_size=[5, 5],
      padding="same",
      activation=tf.nn.relu)
    pool2 = tf.layers.max_pooling2d(inputs=conv2, pool_size=[2, 2], strides=2)



    # Dense Layer
    pool2_flat = tf.reshape(pool2, [-1, 7 * 7 * 256])
    embeddings = tf.layers.dense(inputs=pool2_flat, units=4, activation=None)


    predictions = {'embeddings' :pool2_flat}

#     dense = tf.layers.dense(inputs=pool2_flat, units=1024, activation=tf.nn.relu)
#     dropout = tf.layers.dropout(
#       inputs=dense, rate=0.4, training=mode == tf.estimator.ModeKeys.TRAIN)

#     # Logits Layer
#     logits = tf.layers.dense(inputs=dropout, units=10)

#     predictions = {
#       # Generate predictions (for PREDICT and EVAL mode)
#       "classes": tf.argmax(input=logits, axis=1),
#       # Add `softmax_tensor` to the graph. It is used for PREDICT and by the
#       # `logging_hook`.
#       "probabilities": tf.nn.softmax(logits, name="softmax_tensor")
#     }

    if mode == tf.estimator.ModeKeys.PREDICT:
        return tf.estimator.EstimatorSpec(mode=mode, predictions=predictions)

    # Calculate Loss (for both TRAIN and EVAL modes)
    loss = batch_hard_triplet_loss(labels, embeddings, margin=1,squared=False)

    # Configure the Training Op (for TRAIN mode)
    if mode == tf.estimator.ModeKeys.TRAIN:
        optimizer = tf.train.AdamOptimizer(learning_rate=1e-4)
        train_op = optimizer.minimize(
            loss=loss,
            global_step=tf.train.get_global_step())
        return tf.estimator.EstimatorSpec(mode=mode, loss=loss, train_op=train_op)

    return tf.estimator.EstimatorSpec(
      mode=mode, loss=loss, eval_metric_ops=eval_metric_ops)

((x_train, y_train),
 (x_test, y_test)) = tf.keras.datasets.mnist.load_data()

x_train = x_train/np.float32(255)
y_train = y_train.astype(np.int32)  # not required

x_test = x_test/np.float32(255)
y_test = y_test.astype(np.int32)

mnist_classifier = tf.estimator.Estimator(
    model_fn=cnn_model_fn, model_dir='./hardmine/')

tensors_to_log = {}

logging_hook = tf.train.LoggingTensorHook(
    tensors=tensors_to_log, every_n_iter=50)

# Define data loader
train_input_fn = tf.estimator.inputs.numpy_input_fn(
    x={"x": x_train},
    y=y_train,
    batch_size=128,
    num_epochs=None,
    shuffle=True)

# train one step and display the probabilties
mnist_classifier.train(
    input_fn=train_input_fn,
    steps=900,
    hooks=[logging_hook])

train_input_fn_512 = tf.estimator.inputs.numpy_input_fn(
    x={"x": x_train[:512]},
    num_epochs=1,
    shuffle=False)

train_embedding = mnist_classifier.predict(input_fn=train_input_fn_512)

predict = []
for i in train_embedding:
    predict.append(i['embeddings'])
predict = np.array(predict)

tsne = TSNE()

train_tsne_embeds = tsne.fit_transform(predict[:512])
# eval_tsne_embeds = tsne.fit_transform(X_test_trm[:512])
# train_tsne_embeds = X_train_trm[:512]
# eval_tsne_embeds = X_test_trm[:512]

# In[22]:

scatter(train_tsne_embeds, y_train[:512], "Training Data After TNN")
</code></pre>
</div>
<span class="comment-copy">I think this is not very likely to be the issue, but one minor difference is that the <code>epsilon</code> parameter to the Adam optimizer, left as default in both cases, appears to be <code>1e-7</code> for Keras and <code>1e-8</code> for TensorFlow.</span>
<span class="comment-copy">I have changed the keras epsilon to <code>1e-8</code> by using the command <code>K.set_epsilon(1e-8)</code>, and ran a quick test. The cluster learned by keras is still wrong. So epsilon is not the issue.</span>
<div class="post-text" itemprop="text">
<p>Hi So i have this set of columns which are translated eventually to a one-hot-encoding table. (all categorical for now).</p>
<p>i need to find the multipliers that transform an initial bid to the final bid.</p>
<p>so initially i want to set my initial bid as a benchmark to set a default value before adding multipliers to each feature of the table.</p>
<p>how can i do it?</p>
<p>Let's say my initial bid is 10 ,
and y_train for example are values between (20,30)
and these are some of the columns for prediction.</p>
<p>What's the best way to get the weight of each feature?</p>
<p><a href="https://i.stack.imgur.com/dmIKq.png" rel="nofollow noreferrer"><img alt="data example" src="https://i.stack.imgur.com/dmIKq.png"/></a></p>
</div>
<span class="comment-copy">Please do take some time to read <a href="https://stackoverflow.com/help/how-to-ask">How to Ask</a> and <a href="https://stackoverflow.com/help/on-topic">What topics can I ask about here?</a>.</span>
<span class="comment-copy">sorry for the question. will do</span>
<div class="post-text" itemprop="text">
<p>I'm trying to find a django method that is equivalent to Flask's url_for.</p>
<p>I'm not looking for the jinja equivalent (as shown <a href="http://%20https://stackoverflow.com/questions/40313374/how-to-change-a-html-page-from-flask-to-django" rel="nofollow noreferrer">here</a>) -- I'm talking about on the python side of the house</p>
<p>in my flask app I send an HTML string as follows:</p>
<pre><code>my_picture = '&lt;img src="{}"&gt;'.format(url_for('static', filename=r'images/myPic.jpg'))
</code></pre>
<p>I know I could do this in the html as <code>&lt;img src={{ my_picture }}&gt;</code> but that's not my goal.</p>
<p>What I've been doing is </p>
<pre><code>from my_project.settings import STATIC_URL
my_picture = '&lt;img src="{}"&gt;'.format(os.path.join('static', 'images/myPic.jpg'))
</code></pre>
<p>but there has to be a better way</p>
<p>Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>It depends what you're looking for. </p>
<h1>Static Files</h1>
<p>If you want to get the URL for a <a href="https://docs.djangoproject.com/en/2.1/ref/contrib/staticfiles/" rel="nofollow noreferrer">static file</a>, you can use the following bit:</p>
<pre><code>from django.templatetags.static import static

url = static('images/myPic.jpg')
</code></pre>
<h1>URL config</h1>
<p>If you want to get the URL path of a named URL in your URL config, you can use the the <code>reverse</code> <a href="https://docs.djangoproject.com/en/2.1/ref/urlresolvers/#django.urls.reverse" rel="nofollow noreferrer">URL resolver</a>. Let's say your URL config looks like this:</p>
<p>If your URL config would look like this:</p>
<pre><code>from example import views

path('my/fancy/example/', views.example, name='my-example-view')
</code></pre>
<p>Then you can get the URL with this:</p>
<pre><code>from django.urls import reverse

url = reverse('my-example-view') # will return "my/fancy/example/"
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I use the template tag in my python files as well when I need that:</p>
<pre><code>from django.contrib.staticfiles.templatetags.staticfiles import static

url = static('images/myPic.jpg')
</code></pre>
</div>
<span class="comment-copy">I was using jinja in flask -- I'm explicitly not asking about the template language or any enriched HTML element. I'm looking for the python method @Daniel_Roseman</span>
<span class="comment-copy">For completeness, the equivalent of the <code>{% url %}</code> templatetag in python code is <code>django.core.urlresolvers.reverse</code>.</span>
<span class="comment-copy">how could this be generalized like the url_for method? So that it could be used w/ static, index, ... and all other pages?</span>
<span class="comment-copy">It can’t. Static files and media files have nothing to do with your app urls because in a normal production environment they aren’t served by Django.</span>
<span class="comment-copy">Please note <code>django.contrib.staticfiles.templatetags.staticfiles.static</code> is deprecated in favor of <code>django.templatetags.static.static</code></span>
<div class="post-text" itemprop="text">
<p>Does anyone know why the output of the bellow calculations returns different results, as it should be the same. </p>
<pre><code>(-0.99)**(-0.99)
</code></pre>
<p>returns <code>(-1.0095011228760993-0.03172485085856595j)</code></p>
<p>and </p>
<pre><code>-0.99**-0.99
</code></pre>
<p>returns <code>-1.0099994966583417</code></p>
</div>
<div class="post-text" itemprop="text">
<p>Ok, so let's assemble the partial answers that are elsewhere, and also provide more complete context.</p>
<p>First of all, the premise that these should be equivalent expressions is incorrect.  <code>-x**y</code> is <em>not</em> <code>(-x)**y</code> but rather is <code>-(x**y)</code>.</p>
<p>Admittedly this is odd.  If you write <code>-2</code> on paper, you likely think of the <code>-</code> as part of the number, rather than as an operator whose precedence could be questioned.  And yet if you write -2<sup>2</sup> it is standard to say this is -4, while (-2)<sup>2</sup> is of course 4.</p>
<p>Here is an article on the subject: <a href="http://mathforum.org/library/drmath/view/61633.html" rel="nofollow noreferrer">http://mathforum.org/library/drmath/view/61633.html</a></p>
<p>Anyway, that's the short answer as to why they're not the same expression.  Given that, it's just a matter of understanding each expression.</p>
<pre><code>-.99**-.99
</code></pre>
<p>could be written</p>
<pre><code>-1 * (.99**-.99)
-1 / (.99**.99)
</code></pre>
<p>The denominator can then be read "the hundredth root of .99 to the 99th power", and then it's just a matter of running through a pain-in-the-arse calculation.</p>
<p>On the other hand,</p>
<pre><code>(-0.99)**(-0.99)
</code></pre>
<p>can also be simplified, but eventually we're going to take an even root of a negative number; so the answer must be a complex number.</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>
(-0.99)**(-0.99) yields a complex number, while -0.99**-0.99 yields a float.

</code></pre>
</div>
<span class="comment-copy">Due to the order of operations, the exponentiation is done before the first minus sign. Therefore the second calculation has an implied parenthesis in a different place (around everything except the first minus sign) than the explicit parenthesis of the first calculation (around  <code>-0.99</code>). This particular order of operations is the mathematical standard and is used in Python.</span>
<span class="comment-copy">For more details on Python's order of operations (also called operator precedence), <a href="https://docs.python.org/3/reference/expressions.html#operator-precedence" rel="nofollow noreferrer">see here</a>. Note that exponentiation is lower in the table than "negative," so exponentiation is done before negation.</span>
<span class="comment-copy">You only restated that the two results are different. The questioner already knows that. The question is <i>why</i> those results are different.</span>
<span class="comment-copy">For that I would point to your comment to the original question. :) Just wanted to add that the output types are different, too.</span>
<div class="post-text" itemprop="text">
<p>I'm creating an agent based model simulation where I want a series of actions to take place every '30 seconds' within a given time frame. To be clear - I mean, 30 seconds within the simulation and not in real time. </p>
<p>For example - for every 30 seconds time interval between 00:00:00 and 00:10:00, check whether the interval is in list [00:01:00, 00:02:30, 00:05:00].</p>
<p>I've tried to google for an answer to this but haven't found what I need. </p>
<p>Thanks</p>
</div>
<span class="comment-copy">Did you write any code yourself?</span>
<span class="comment-copy">If '30 seconds' are not referred to real time then I assume you will have to show us example of the simulation</span>
<span class="comment-copy">I'm not sure my wider code would help anyone answer this question.</span>
<span class="comment-copy">I thought that my example is very clear:</span>
<span class="comment-copy">Your list looks like a set of points in time, not intervals. What does an interval look like in your system? In other words, what would <code>x</code> look like to make <code>x in ["00:01:00", "00:02:30", "00:05:00"]</code> work, or what does <code>x</code> look like to make the preceding example trivially false for any <code>x</code>?</span>
<div class="post-text" itemprop="text">
<p>I've tried </p>
<pre><code>py_install("recordlinkage")
</code></pre>
<p>It returns this error : </p>
<blockquote>
<p>py_install("recordlinkage")
  Collecting package metadata: ...working... done
  Solving environment: ...working... failed</p>
<p>PackagesNotFoundError: The following packages are not available from current channels:</p>
<ul>
<li>recordlinkage</li>
</ul>
<p>Current channels:</p>
<ul>
<li><a href="https://conda.anaconda.org/conda-forge/win-64" rel="nofollow noreferrer">https://conda.anaconda.org/conda-forge/win-64</a></li>
<li><a href="https://conda.anaconda.org/conda-forge/noarch" rel="nofollow noreferrer">https://conda.anaconda.org/conda-forge/noarch</a></li>
<li><a href="https://repo.anaconda.com/pkgs/main/win-64" rel="nofollow noreferrer">https://repo.anaconda.com/pkgs/main/win-64</a></li>
<li><a href="https://repo.anaconda.com/pkgs/main/noarch" rel="nofollow noreferrer">https://repo.anaconda.com/pkgs/main/noarch</a></li>
<li><a href="https://repo.anaconda.com/pkgs/free/win-64" rel="nofollow noreferrer">https://repo.anaconda.com/pkgs/free/win-64</a></li>
<li><a href="https://repo.anaconda.com/pkgs/free/noarch" rel="nofollow noreferrer">https://repo.anaconda.com/pkgs/free/noarch</a></li>
<li><a href="https://repo.anaconda.com/pkgs/r/win-64" rel="nofollow noreferrer">https://repo.anaconda.com/pkgs/r/win-64</a></li>
<li><a href="https://repo.anaconda.com/pkgs/r/noarch" rel="nofollow noreferrer">https://repo.anaconda.com/pkgs/r/noarch</a></li>
<li><a href="https://repo.anaconda.com/pkgs/msys2/win-64" rel="nofollow noreferrer">https://repo.anaconda.com/pkgs/msys2/win-64</a></li>
<li><a href="https://repo.anaconda.com/pkgs/msys2/noarch" rel="nofollow noreferrer">https://repo.anaconda.com/pkgs/msys2/noarch</a></li>
</ul>
<p>To search for alternate channels that may provide the conda package you're
  looking for, navigate to</p>
<pre><code>https://anaconda.org
</code></pre>
<p>and use the search bar at the top of the page.</p>
</blockquote>
<p>So I went to <a href="https://anaconda.org" rel="nofollow noreferrer">https://anaconda.org</a> and searched <strong>recordlinkage</strong> and it returned <strong>r-recordlinkage</strong></p>
<p>Then I did py_install("r-recordlinkage"), it installed it beautifully.
When I do </p>
<pre><code>import r-recordlinkage 
</code></pre>
<p>in the .py script it says </p>
<blockquote>
<p>SyntaxError: invalid syntax (, line 1)</p>
</blockquote>
<p>what am I missing here? :/ </p>
</div>
<span class="comment-copy">According to Anaconda, <a href="https://anaconda.org/conda-forge/r-recordlinkage" rel="nofollow noreferrer">r-recordlinkage</a> is an R package not Python module. But a different module by different authors is available in <a href="https://recordlinkage.readthedocs.io/en/latest/about.html" rel="nofollow noreferrer">Python</a>. Simply remove <code>r-</code> in name as hyphens are never used in Python and R names (Anaconda likely uses this to differentiate the version and only for their install caller).</span>
<span class="comment-copy">removing the hiphen import recordlinkage gives ModuleNotFoundError: No module named 'recordlinkage'</span>
<span class="comment-copy">Did you install it before importing: <code>py_install("recordlinkage")</code> or <code>pip install recordlinkage</code>?</span>
<span class="comment-copy">py_install("recordlinkage") is giving the error that i described in the question. and pip install recordlinkage says Requirement already satisfied on multiple lines</span>
<span class="comment-copy">and conda install recordlinkage gives the same error as py_install("recordlinkage")</span>
<div class="post-text" itemprop="text">
<p>I have installed Tensorflow using <code>conda install tensorflow-gpu</code>. This also installed <code>cudatoolkit</code> and <code>cudnn</code>.</p>
<p>I can confirm that the files <code>libcudnn.so</code>, <code>libcudnn.so.7</code>, <code>libcudart.so</code> and <code>libcudart.so.9.0</code> are in my <code>anaconda3/envs/tf-env/lib/</code> folder.</p>
<p>However, <code>libcuda.so.1</code> is missing and when I try to import Tensorflow I get the following error:</p>
<pre><code>&gt;&gt;&gt; import tensorflow
Traceback (most recent call last):
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py", line 58, in &lt;module&gt;
    from tensorflow.python.pywrap_tensorflow_internal import *
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 28, in &lt;module&gt;
    _pywrap_tensorflow_internal = swig_import_helper()
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 24, in swig_import_helper
    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/imp.py", line 243, in load_module
    return load_dynamic(name, filename, file)
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/imp.py", line 343, in load_dynamic
    return _load(spec)
ImportError: libcuda.so.1: cannot open shared object file: No such file or directory

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/site-packages/tensorflow/__init__.py", line 24, in &lt;module&gt;
    from tensorflow.python import pywrap_tensorflow  # pylint: disable=unused-import
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/site-packages/tensorflow/python/__init__.py", line 49, in &lt;module&gt;
    from tensorflow.python import pywrap_tensorflow
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py", line 74, in &lt;module&gt;
    raise ImportError(msg)
ImportError: Traceback (most recent call last):
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow.py", line 58, in &lt;module&gt;
    from tensorflow.python.pywrap_tensorflow_internal import *
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 28, in &lt;module&gt;
    _pywrap_tensorflow_internal = swig_import_helper()
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/site-packages/tensorflow/python/pywrap_tensorflow_internal.py", line 24, in swig_import_helper
    _mod = imp.load_module('_pywrap_tensorflow_internal', fp, pathname, description)
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/imp.py", line 243, in load_module
    return load_dynamic(name, filename, file)
  File "/home/joao/anaconda3/envs/virtualnations/lib/python3.6/imp.py", line 343, in load_dynamic
    return _load(spec)
ImportError: libcuda.so.1: cannot open shared object file: No such file or directory


Failed to load the native TensorFlow runtime.

See https://www.tensorflow.org/install/errors

for some common reasons and solutions.  Include the entire stack trace
above this error message when asking for help.
</code></pre>
</div>
<span class="comment-copy">Do you have current drivers/cuda version installed for your Nvidia card?</span>
<span class="comment-copy">@FlyingTeller I had not. Solved the problem with <code>sudo apt get install nvidia-367-dev</code></span>
<div class="post-text" itemprop="text">
<p>I am using Jupyter notebook for a project, I have been writing in vs code but recently switched to Jupyter. The code was working in vs code but, already installed the modules with pip, but I am getting import error in Jupyter notebook. For;</p>
<pre><code>import reverse_geocoder
from geopy.distance import geodesic
</code></pre>
<p>I am getting the </p>
<pre><code>No module named 'reverse_geocoder'
No module named 'geopy'
</code></pre>
<p>errors. How I can install these to Jupyter?</p>
</div>
<div class="post-text" itemprop="text">
<p>Google is your friend.</p>
<p>You can find a pretty detailed solution <a href="https://jakevdp.github.io/blog/2017/12/05/installing-python-packages-from-jupyter/" rel="nofollow noreferrer">here</a> (I strongly suggest you to have a look at it).</p>
<p>Anyway, to sum up. I am assuming you wish to install directly from the Jupyter notebook. This probably means that you don't have Anaconda (otherwise I'd suggest to install through the Anaconda prompt) but I'll write down the solution also for that case.</p>
<p>If you do not have Anaconda then you can simply install it using pip</p>
<pre><code># Install a pip package in the current Jupyter kernel
import sys
!{sys.executable} -m pip install reverse_geocoder
</code></pre>
<p>If you have Anaconda:</p>
<pre><code># Install a conda package in the current Jupyter kernel
import sys
!conda install --yes --prefix {sys.prefix} reverse_geocoder
</code></pre>
<p>However, if you do have Anaconda installed you should simply open the Anaconda prompt and install the package using:</p>
<pre><code>pip install reverse_geocoder
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>First, I have to say that I'm a noobie posting at this site. </p>
<p>I have written this post because I'm trying to detect signals in the 2.4GHz band. For that, I'm using GNU Radio Companion with this result that worked for me:</p>
<p><img alt="IMG: Simple program that detect the 2.4GHz frequency band" src="https://i.stack.imgur.com/2mGQu.png"/></p>
<p>But I want to get the information to a python script to work with it. </p>
<p>I was looking for something that can help me to make that possible and I found this tutorial: <a href="http://recolog.blogspot.com/2015/08/processing-data-out-of-gnuradio.html" rel="nofollow noreferrer">http://recolog.blogspot.com/2015/08/processing-data-out-of-gnuradio.html</a></p>
<p>I tried to replicated it but I have this problem:</p>
<p><img alt="IMG: Tutorial Flow graph with error" src="https://i.stack.imgur.com/gtnaK.png"/></p>
<p><img alt="IMG: Error description" src="https://i.stack.imgur.com/PxaCg.png"/></p>
<p>I have been searching for hours and I found this problem is caused by the version of the GNU Radio (in my case, 3.7.11), but I can't install a previous version because it cause troubles between other packages that I need. </p>
<p>So the question is, How can I replicate the tutorial in my current version?</p>
</div>
<div class="post-text" itemprop="text">
<p><strong>the red tipped arrow indicate that the data format on either ends (output of a block to input of a block) are incompatible for connection.</strong></p>
<p><strong><em>Possible solution</em></strong></p>
<p>The easiest method is to use a <kbd>file sink </kbd> block in gnuradio-companion</p>
<p>The <kbd>file sink </kbd> block allows you to write into any format.</p>
<p>You can later take this file and analyse for detecting</p>
</div>
<span class="comment-copy">That pad is a pad for a hierarchical block; I'm not sure what you intended the Pad Sink to do?</span>
<span class="comment-copy">In the tutorial is used to get the data and use them in a python script to work with, do you know another way to extract the data and use them in a python script?</span>
<span class="comment-copy">can you link to that tutorial? Sounds wrong.</span>
<span class="comment-copy">This is the tutorial: <a href="http://recolog.blogspot.com/2015/08/processing-data-out-of-gnuradio.html" rel="nofollow noreferrer">recolog.blogspot.com/2015/08/…</a></span>
<span class="comment-copy">I don't know what they're doing, but a pad sink there doesn't make any sense. So, use the <a href="https://tutorials.gnuradio.org" rel="nofollow noreferrer">official GNU Radio tutorials</a>. Also don't use WX GUI but QT GUI – we've deprecated WX <i>a long time ago</i>, and we've removed it completely from the upcoming release.</span>
<span class="comment-copy">I will try this solution later. I will say how it has gone.</span>
<div class="post-text" itemprop="text">
<p>I have a dataframe like I am trying to keep rows that have more than 5 characters. Here is what I tried, but it removes 'of', 'U.', 'and','Arts',...etc. I just need to remove characters in a row that have len less than 5. </p>
<pre><code>id schools
1  University of Hawaii
2  Dept in Colorado U.
3  Dept
4  College of Arts and Science
5  Dept
6  Bldg
</code></pre>
<p>wrong output from my code: </p>
<pre><code>0    University Hawaii
1             Colorado
2                     
3      College Science
4                     
5   
</code></pre>
<p>Looking for output like this: </p>
<pre><code>id schools
1  University of Hawaii
2  Dept in Colorado U.
4  College of Arts and Science
</code></pre>
<p>Code: </p>
<pre><code>l = [1,2,3,4,5,6]
s = ['University of Hawaii', 'Dept in Colorado U.','Dept','College of Arts and Science','Dept','Bldg']
df1 = pd.DataFrame({'id':l, 'schools':s})
df1 = df1['schools'].str.findall('\w{5,}').str.join(' ') # not working
df1
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Using a regex is a huge (and slow) overkill for this task. You can use simple pandas indexing:</p>
<pre><code>filtrered_df = df1[df1['schools'].str.len() &gt; 5]  # or &gt;= depending on the required logic
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>There is a simpler filter for your data.</p>
<pre><code> mask = df1['schools'].str.len() &gt; 5
</code></pre>
<p>Then create a new data frame from the filter</p>
<pre><code>df2 = df1[mask].copy()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>import pandas as pd
name = ['University of Hawaii','Dept in Colorado U.','Dept','College of Arts and Science','Dept','Bldg']

labels =['schools']
df =pd.DataFrame.from_records([[i] for i in name],columns=labels)
df[df['schools'].str.len() &gt;5 ]
</code></pre>
</div>
<span class="comment-copy"><code>df2</code> will contain all rows where <code>schools</code> length is &lt;= 5 which is the opposite of what OP is trying to achieve.</span>
<span class="comment-copy">Right you are. I incorrectly added the ~ operator. I went ahead and fixed it.</span>
<span class="comment-copy">Negative vote reasons</span>
<div class="post-text" itemprop="text">
<p>I am newbie in Python and maybe my problem is very simple.</p>
<p>I have created a list of 250 zeros called <em>x</em>, <code>x = np.zeros(250)</code>, and I have a loop where I perform some calculations, at each iteration I produce two x's for example in the first iteration the x[0] and x[1] and so on in a list called temp_x. i.e., the first temp_x has the x[0] and x[1]</p>
<p>I want to save the output at the end of each iteration to the corresponding positions of the x. For example at the end of the first iteration temp_x has two values I want to assign them to the first positions of x.</p>
<p>What I am doing wrong?</p>
<pre><code>x[i, i+1] = x_temp
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This should work just fine
<code>x[i] = x[i+1] = x_temp</code></p>
</div>
<div class="post-text" itemprop="text">
<p>As mentioned in @IAmVisco's answer, chained assignment will work.</p>
<p>However, to go into the reason your code doesn't:</p>
<p>When you type something like <code>x[i, i+1]</code>, Python understands the value in the square brackets as a <code>tuple</code>, and therefore actually attempts to execute <code>x[(i, i + 1)]</code>, which accesses the element at row <code>i</code> and column <code>i + 1</code>. Since there is no such element (<code>x</code> is a 1D array), it fails with the error "too many indices for array".</p>
<p>If you actually want to access two (or more) elements in that way, your indices should be in a form of a <code>np.ndarray</code> (a <code>list</code> would work too):</p>
<pre><code>&gt;&gt;&gt; x = np.ones(10)
&gt;&gt;&gt; x[np.array([0, 1])] = 2
&gt;&gt;&gt; x
array([2., 2., 1., 1., 1., 1., 1., 1., 1., 1.])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I'm not sure IAmVisco's answer will do what is required, it will instead set both of the elements of x to the list x_temp.</p>
<p>What I think you need instead is:</p>
<pre><code>x[i], x[i+1] = x_temp
</code></pre>
<p>This unpacks each element of <code>x_temp</code> into each element of <code>x</code></p>
</div>
<span class="comment-copy">ValueError: setting an array element with a sequence.</span>
<span class="comment-copy">Apparently numpy creates not a list but a <code>numpy.ndarray</code> object with <code>np.zeros()</code> call, I haven't worked with it much but it still worked for me in REPL</span>
<span class="comment-copy">It does not even have to be a numpy array, just a list. <code>x[[0, 1]] = 2</code> will work as well.</span>
<div class="post-text" itemprop="text">
<p>I'm trying to add gaussian noise to some images using the following code </p>
<pre><code>import numpy as np
import cv2
import glob 
mean = 0
var = 10
sigma = var ** 0.5
gaussian = np.random.normal(mean, sigma, (224, 224)) 



for image in glob.glob('/home/aub/myflower/flower_photos/dandelion/*.jpg'):
    img = cv2.imread(image)
    noisy_image = np.zeros(img.shape, np.float32)

    if len(img.shape) == 2:
        noisy_image = img + gaussian
    else:
        noisy_image[:, :, 0] = img[:, :, 0] + gaussian
        noisy_image[:, :, 1] = img[:, :, 1] + gaussian
        noisy_image[:, :, 2] = img[:, :, 2] + gaussian

        cv2.normalize(noisy_image, noisy_image, 0, 255, cv2.NORM_MINMAX, dtype=-1)
noisy_image = noisy_image.astype(np.uint8)

       cv2.imshow("img", img)
       cv2.imshow("gaussian", gaussian)
       cv2.imshow("noisy", noisy_image)
cv2.waitKey(0)
</code></pre>
<p>but it doesn't work and it gives me the following error </p>
<blockquote>
<p>noisy_image[:, :, 0] = img[:, :, 0] + gaussian ValueError: operands
  could not be broadcast together with shapes (315,500) (224,224)</p>
</blockquote>
<p>Kindly review and give feedback.</p>
</div>
<div class="post-text" itemprop="text">
<p>It looks like your image shape is <code>(315,500)</code>, while the shape of <code>gaussian</code> is <code>(224,224)</code>. Try changing your gaussian initialization to</p>
<pre><code>gaussian = np.random.normal(mean, sigma, (img.shape[0],img.shape[1])) 
</code></pre>
<p>By the way:
You can replace these lines</p>
<pre><code>noisy_image[:, :, 0] = img[:, :, 0] + gaussian
noisy_image[:, :, 1] = img[:, :, 1] + gaussian
noisy_image[:, :, 2] = img[:, :, 2] + gaussian
</code></pre>
<p>with</p>
<pre><code>noisy_image = img + gaussian
</code></pre>
<p>which will have the same effect: adding <code>gaussian</code> to each channel.</p>
</div>
<span class="comment-copy">thank you so much for your feedback, i changed the lines and the also changed the shape to (img.shape[0],img.shape[1]) and it works now, thank you</span>
<span class="comment-copy">You are welcome and you are right, using <code>(img.shape[0],img.shape[1])</code> is far better, I will add that to my answer.</span>
<div class="post-text" itemprop="text">
<p>I have the following dataset</p>
<pre><code>lst=[
 ['a','2019-03-02 23:20:28',0],
 ['a','2019-03-02 23:21:29',0],
 ['a','2019-03-02 23:22:30',1],
 ['a','2019-03-02 23:30:31',0.5],
 ['a','2019-03-02 23:38:32',0.5],
 ['a','2019-03-02 23:50:32',0.5],  
 ['a','2019-03-02 23:50:32',0], 
 ['b','2019-03-02 23:10:32',0],  
 ['b','2019-03-02 23:12:32',0],  
 ['b','2019-03-02 23:20:32',1],  
 ['b','2019-03-02 23:30:32',0.5],  
 ['b','2019-03-02 23:50:32',1],  
 ['b','2019-03-02 23:55:32',1],  
 ['b','2019-03-02 23:56:32',0],
 ['a','2019-03-02 22:20:28',0],
 ['a','2019-03-02 22:21:29',0],
 ['a','2019-03-02 22:22:30',1],
 ['a','2019-03-02 22:30:31',0.5],  
 ['a','2019-03-02 22:30:32',0], 
  ]

df = pd.DataFrame(lst,columns=['ID','ts','signal'])
df['ts']=pd.to_datetime(df['ts'])
</code></pre>
<p>I would like to get all those rows per ID that the total elapsed time between 0s in signal column is greater than 15 minutes.</p>
<p>i.e. for a only:</p>
<p><a href="https://i.stack.imgur.com/BETXv.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/BETXv.png"/></a></p>
<p>and for b only:</p>
<p><a href="https://i.stack.imgur.com/n6tjZ.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/n6tjZ.png"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>Use:</p>
<pre><code>#filter out rows with 0
df1 = df[df['signal'].ne(0)]
#create Series from original column for unique consecutive groups for non 0 rows
a = df['signal'].eq(0).cumsum()

thr = pd.Timedelta(15, unit='min')

#get difference between first and last value per group and filtering by thresh
df2 = df1[df1['ts'].groupby(a).transform(lambda x: x.iat[-1] - x.iat[0]) &gt; thr]
print (df2)
   ID                  ts  signal
2   a 2019-03-02 23:22:30     1.0
3   a 2019-03-02 23:30:31     0.5
4   a 2019-03-02 23:38:32     0.5
5   a 2019-03-02 23:50:32     0.5
9   b 2019-03-02 23:20:32     1.0
10  b 2019-03-02 23:30:32     0.5
11  b 2019-03-02 23:50:32     1.0
12  b 2019-03-02 23:55:32     1.0
</code></pre>
</div>
<span class="comment-copy">apologies but that was typo. it should be clear now</span>
<span class="comment-copy">Great, only the <code>pd.Timedelta(15, unit='min')</code> only works with <code>pd.Timedelta(15)</code> for me.</span>
<div class="post-text" itemprop="text">
<p>I think i'm failing to understand what i'm doing wrong. I have connected to the Google Drive API and now I would like to read a few documents on my Google drive with the objective of analysing the data contained in these csv files.</p>
<p>This is the code I have:</p>
<pre><code>from __future__ import print_function
import pickle
import os.path
from httplib2 import Http
from googleapiclient.discovery import build
from google_auth_oauthlib.flow import InstalledAppFlow
from google.auth.transport.requests import Request
os.environ["GOOGLE_APPLICATION_CREDENTIALS"] = "/Users/emmanuelsibanda/credentials.json"
# If modifying these scopes, delete the file token.pickle.
SCOPES = ['https://www.googleapis.com/auth/drive.metadata.readonly']
creds = None
if os.path.exists('token.pickle'):
  with open('token.pickle', 'rb') as token:
    creds = pickle.load(token)
    # If there are no (valid) credentials available, let the user log in.
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            creds.refresh(Request())
        else:
            flow = InstalledAppFlow.from_client_secrets_file(
                'credentials.json', SCOPES)
            creds = flow.run_local_server()
        # Save the credentials for the next run
        with open('token.pickle', 'wb') as token:
            pickle.dump(creds, token)

    service = build('drive', 'v3', credentials=creds)

def gdrive_download(file_id):
  request = service.files().get(fileId=file_id)
  return request.execute()
a = gdrive_download('19sPsANUblhXkb3nZVy4PMrfUyOSoF_uQ')
</code></pre>
<p>Just to reiterate I would like to download a few csv files  and then proceed to read the files.</p>
</div>
<div class="post-text" itemprop="text">
<p>In Drive, a File's metadata is separate from its content. You have asked for <code>metadata.readonly</code> scope, which unsurprisingly only allows access to the metadata. Your call to <code>files().get</code> then gets the metadata.</p>
<p>To get the content, you will firstly need to choose a more permissive scope. Then you will fetch the content. How you do this depends on whether the file is a binary file, or a Google document (eg. a spreadsheet).</p>
<p>A binary file can be downloaded by adding <code>alt=media</code> to the URL. </p>
<p>A Google file can be exported by adding <code>/export?mimeType=text/csv</code> to the URL.</p>
<p>See <a href="https://developers.google.com/drive/api/v3/manage-downloads" rel="nofollow noreferrer">https://developers.google.com/drive/api/v3/manage-downloads</a> for details and code samples.</p>
</div>
<span class="comment-copy">Show your error</span>
<span class="comment-copy">What is not working with the code you have now?</span>
<span class="comment-copy">I guess the confusion on my part is reading the data in the the file. From what I see I only have the file's ID, file name etc but not the actual contents of the file</span>
<div class="post-text" itemprop="text">
<p>I read <a href="https://docs.python.org/3/library/logging.html" rel="nofollow noreferrer">logging — Logging facility for Python — Python 3.7.3rc1 documentation</a> and find there are 6 kinds of log level are defined</p>
<pre><code>| Level      | Numeric value |
| ---------- | ------------- |
| `CRITICAL` | 50            |
| `ERROR`    | 40            |
| `WARNING`  | 30            |
| `INFO`     | 20            |
| `DEBUG`    | 10            |
| `NOTSET`   | 0             |
</code></pre>
<p>Upon referring to linux <code>syslog</code> ,8 kinds are definded</p>
<p><a href="http://man7.org/linux/man-pages/man2/syslog.2.html" rel="nofollow noreferrer">syslog(2) - Linux manual page</a></p>
<pre><code>The log level
       Every printk() message has its own log level.  If the log level is
       not explicitly specified as part of the message, it defaults to
       default_message_loglevel.  The conventional meaning of the log level
       is as follows:

       Kernel constant   Level value   Meaning
       KERN_EMERG                       0        System is unusable
       KERN_ALERT                        1        Action must be taken immediately
       KERN_CRIT                           2        Critical conditions
       KERN_ERR                             3        Error conditions
       KERN_WARNING                 4        Warning conditions
       KERN_NOTICE                      5        Normal but significant condition
       KERN_INFO                           6        Informational
       KERN_DEBUG                      7        Debug-level messages

       The kernel printk() routine will print a message on the console only
       if it has a log level less than the value of console_loglevel.
</code></pre>
<p>Additionally, SSH defined 8 kinds as well</p>
<p>SSH LogLevel </p>
<p><a href="https://www.freebsd.org/cgi/man.cgi?sshd_config(5)" rel="nofollow noreferrer">sshd_config(5)</a></p>
<pre><code>  LogLevel
         Gives the verbosity level that is used when logging messages from
         sshd(8).  The possible values are: 
         QUIET,
         FATAL, 
         ERROR, 
         INFO,
         VERBOSE,
         DEBUG, 
         DEBUG1, 
         DEBUG2, 
         and DEBUG3.  The default is INFO.
         DEBUG and DEBUG1 are equivalent.  DEBUG2 and DEBUG3 each specify
         higher levels of debugging output.  Logging with a DEBUG level
         violates the privacy of users and is not recommended.
</code></pre>
<p>Where does the definitions of the five kinds logging level originate?</p>
</div>
<div class="post-text" itemprop="text">
<p>You'll notice that the <code>logging</code> module lets you define additional levels if you need to, and that the missing ones are rather specific to the domains of the tools whose documentation you are referring to.</p>
<p>"Quiet" is identical to disabling <code>logging</code> entirely and a "fatal" error would presumably be one where your Python program has to terminate. If you want additional debugging levels in a particular application of yours, go ahead and define them - though a better approach might be to just use <code>logging.DEBUG</code> for everything, and instead selectively enable or disable debug-level <code>logging</code> for individual submodules in your system.</p>
</div>
<div class="post-text" itemprop="text">
<p>I have looked at many similar sources to this question but can't seem to find an answer that solves my problem. </p>
<p>I am using python3.7.1 and sqlite3 to essentially create quizzes. I have an array of questions which I have inserted into a table, with a 'Class_name' and 'quizNumber' using this code example:</p>
<pre><code>quizQuestion = ['1 + 1 =', '2 + 2 =', '3 + 3 =',...]
quizNumber = (1)
quizClass = ('6D')

for question in quizQuestions:
    cursor.execute( "INSERT INTO set_questionsTbl (QuizNumber, Class_name, Question) VALUES (?,?,?)", (quizNumber,quizClass,question))
</code></pre>
<p>This code works fine and the table(set_questionsTbl) looks like this:</p>
<pre><code>QuizNumber | Class_name | Question | Answer 
-------------------------------------------
1          | 6D         | 1 + 1 =  | 
1          | 6D         | 2 + 2 =  |
1          | 6D         | 3 + 3 =  |

etc..
</code></pre>
<p>I also have an array of answers:</p>
<pre><code>quizAnswers = [2,4,6,...]
</code></pre>
<p>The problem that occurs is when trying to update the table with the answers so it looks like this:</p>
<pre><code>QuizNumber | Class_name | Question | Answer 
-------------------------------------------
1          | 6D         | 1 + 1 =  | 2
1          | 6D         | 2 + 2 =  | 4
1          | 6D         | 3 + 3 =  | 6
etc...
</code></pre>
<p>The code I tried was this:</p>
<pre><code>for answer in quizAnswers:
    cursor.execute("UPDATE set_questionsTbl SET Answer = (?) ", (answer,))
</code></pre>
<p>This didn't work as with every loop the previous inputted answer got overwritten leaving me with this:</p>
<pre><code>QuizNumber | Class_name | Question | Answer 
-------------------------------------------
1          | 6D         | 1 + 1 =  | 6
1          | 6D         | 2 + 2 =  | 6
1          | 6D         | 3 + 3 =  | 6
etc...
</code></pre>
<p>I have also tried joining the loops together but that doesn't work, table looks like:</p>
<pre><code>QuizNumber | Class_name | Question | Answer 
-------------------------------------------
1          | 6D         | 1 + 1 =  | 2
1          | 6D         | 2 + 2 =  | 2
1          | 6D         | 3 + 3 =  | 2
1          | 6D         | 1 + 1 =  | 4
1          | 6D         | 2 + 2 =  | 4
1          | 6D         | 3 + 3 =  | 4
1          | 6D         | 1 + 1 =  | 6
1          | 6D         | 2 + 2 =  | 6
1          | 6D         | 3 + 3 =  | 6
</code></pre>
<p>I have tried to correct this many times and searched many different examples but couldn't seem to find a solution. So how do I loop through each question and update the answer with each answer in quizAnswers?</p>
<p>I am new to stack overflow so I may have missed a question similar to this, if so please link it. </p>
</div>
<div class="post-text" itemprop="text">
<p>The point you are missing is, that you instruct your database to update <em>all</em> records with the answer in the current iteration of the loop.<br/>Your example:</p>
<pre><code>quizAnswers = [2,4,6]
for answer in quizAnswers:
    cursor.execute("UPDATE set_questionsTbl SET Answer = (?) ", (answer,))
</code></pre>
<p>basically does:<br/></p>
<pre><code>set Answer for *all* records to 2
set Answer for *all* records to 4
set Answer for *all* records to 6
</code></pre>
<p>Your database does not understand the meaning of the data you put into the tables. For the DB, the questions you inserted into the <code>Question</code> column of your <code>set_questionsTbl</code> are just sequences of characters. It has no means of evaluating the equation in <code>Question</code> in order to set a value in <code>Answer</code> only if that value is the result of the equation.</p>
<p>You need to tell your DB which answer to set for which question(s).
You need to give your query criteria, that a record must meet for the update operation to be applied to it. That's what <a href="https://en.wikipedia.org/wiki/Where_(SQL)" rel="nofollow noreferrer">WHERE clauses</a> are for.</p>
<p>Following your example, you'll want to create a correlation between questions and their respective answers. The below is <em>one</em> way to do that.</p>
<p>First, create a list of tuples. Each tuple contains an answer in the first element, the second element holds the corresponding question (this needs to be the exact value you inserted into the <code>Question</code> column).</p>
<pre><code>quiz_question_answers = [(2, '1 + 1 ='), (4, '2 + 2 ='), (6, '3 + 3 =')] 
</code></pre>
<p>Then you can iterate over that list of tuples to execute the UPDATE query in your cursor:</p>
<pre><code>for q_a in quiz_question_answers:
    cursor.execute("UPDATE set_questionsTbl SET Answer = ? WHERE Question = ?", (q_a[0], q_a[1]))
</code></pre>
<p>This will update the answer in <em>all</em> records that have the specific equation in <code>Question</code>. Records with different <code>Class_name</code> and/or <code>QuizNumber</code> - a record like this for example:</p>
<pre><code>QuizNumber | Class_name | Question | Answer 
-------------------------------------------
4          | 5A         | 1 + 1 =  | 
</code></pre>
<p>- will be updated as well, because the only criteria, the <code>Question</code> equaling <code>1 + 1 =</code>, is met for this record also.</p>
<p>If you want the answers to be set only for questions of quiz number 1 for class 6D, you'll have to add more restrictive criteria to your query, e.g.:</p>
<pre><code>quiz_question_answers = [(2, '1 + 1 =', 1, '6D'), (4, '2 + 2 =', 1, '6D'), (6, '3 + 3 =', 1, '6D')]
for q_a in quiz_question_answers:
    cursor.execute("UPDATE set_questionsTbl "
                   "SET Answer = ? "
                   "WHERE Question = ? "
                   "AND QuizNumber = ? "
                   "AND Class_name = ?",
                   (q_a[0], q_a[1], q_a[2], q_a[3]))
</code></pre>
<p>With this particular solution (using a list of tuples with the query parameters in the correct order) you can also use <a href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Cursor.executemany" rel="nofollow noreferrer"><code>executemany</code></a> to let the cursor do the loop over the list of parameter tuples for you:</p>
<pre><code>quiz_question_answers = [(2, '1 + 1 ='), (4, '2 + 2 ='), (6, '3 + 3 =')]
cursor.executemany("UPDATE set_questionsTbl SET Answer = ? WHERE Question = ?", quiz_question_answers)
</code></pre>
<p><a href="http://www.sqlitetutorial.net/sqlite-where/" rel="nofollow noreferrer">Here</a>'s some further reading on WHERE clauses specifically for SQLite.</p>
</div>
<div class="post-text" itemprop="text">
<p>You should have a unique ID for at least one of the fields in your table. That way when you execute the answer update, you could add a WHERE clause, e.g:</p>
<pre><code>    cursor.execute( "UPDATE set_questionsTbl SET answer=? WHERE unique_id=?", (answer,uniqueId))
</code></pre>
<p>and that way not all of your records will be updated.</p>
</div>
<span class="comment-copy">Please have a look at <a href="https://en.wikipedia.org/wiki/Where_(SQL)" rel="nofollow noreferrer">WHERE clauses</a>. You don't necessarily need a unique ID as the answer suggests, as long as you can come up with a set of criteria that can individually or collectively identify the record(s) you want your statement to affect. In your case, the combination of <code>QuizNumber</code>, <code>Class_name</code> and <code>Question</code> could serve as such a set.</span>
<span class="comment-copy">Surely this would create the same problem? To update the table for each question I'd have to loop through each uniqueId. However, I'm already looping through each answer in the array of answers so a similar problem would occur to the last section of code in the question?</span>
<div class="post-text" itemprop="text">
<p>I have a function in python which returns a tuple of a given key for the Natural-Sort/Human algorithm.</p>
<p>See <a href="https://stackoverflow.com/a/5254534/6622587">fake _human_key</a>.</p>
<p>But I need this to change this to replace German umlauts by their standard alphabetical characters.</p>
<p>Long story short, I want to get rid of <code>Ä, Ö, Ü, ß</code> for the sorting.</p>
<p>Also, the case should <strong>not</strong> be considered. A small <code>d</code> should have the same priority as a capital <code>D</code>...</p>
<p>For the umlauts I am utilizing the replace-function which seems a pretty awkward way to do it... :-/ I have no better idea... Any suggestions?</p>
<p>Also I am not able to rewrite this to get rid of the case sensitiveness...</p>
<p>So far I have:</p>
<pre><code>def _human_key(key):
    key = key.replace("Ä", "A").replace("Ö", "O").replace("Ü", "U")\
          .replace("ä", "a").replace("ö", "o").replace("ü", "u")\
          .replace("ß", "s")
    parts = re.split(r'(\d*\.\d+|\d+)', key)   
    return tuple((e.swapcase() if i % 2 == 0 else float(e))
            for i, e in enumerate(parts))
    return parts
</code></pre>
<p>Examples: I have the values</p>
<pre><code> Zabel
 Schneider
 anabel
 Arachno
 Öztürk
 de 'Hahn
</code></pre>
<p>which I want to sort; currently this puts:</p>
<pre><code>anabel
de 'Hahn
Arachno
Öztürk
Schneider
Zabel
</code></pre>
<p>because the small characters a treated with priority...</p>
<p>Expectation:</p>
<pre><code>anabel
Arachno
de 'Hahn   ( &lt;-- because "d" comes after "a")
Öztürk
Schneider
</code></pre>
<p>I feel the replace is not the right way to achieve the problem with the umlauts, but can't find a better solution.</p>
<p>Update/Background information:</p>
<p>I am calling this from outside, from the class "QSortFilterProxyModel",
I need this for sorting rows according to their clicked columns.
I have a QTreeView whichs displays a result set from the database, and one column contains german family names, that's the background.</p>
<pre><code>class HumanProxyModel(QtCore.QSortFilterProxyModel):
    def lessThan(self, source_left, source_right):
        data_left = source_left.data()
        data_right = source_right.data()
        if type(data_left) == type(data_right) == str:            
            return _human_key(data_left) &lt; _human_key(data_right)            
        return super(HumanProxyModel, self).lessThan(source_left, source_right)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you don't mind using third-party modules, you can use <a href="https://github.com/SethMMorton/natsort" rel="nofollow noreferrer"><code>natsort</code></a> (full disclosure, I am the author).  For the data you give, it returns what you want out-of-the-box.</p>
<pre><code>&gt;&gt;&gt; from natsort import natsorted, ns
&gt;&gt;&gt; data = ['Zabel', 'Schneider', 'anabel', 'Arachno', 'Öztürk', 'de Hahn']
&gt;&gt;&gt; natsorted(data, alg=ns.LOCALE)  # ns.LOCALE turns on locale-aware handling
['anabel', 'Arachno', 'de Hahn', 'Öztürk', 'Schneider', 'Zabel']
&gt;&gt;&gt; from natsort import humansorted
&gt;&gt;&gt; humansorted(data)  # shortcut for using LOCALE
['anabel', 'Arachno', 'de Hahn', 'Öztürk', 'Schneider', 'Zabel']
</code></pre>
<p>If you need a sorting key, you can use <code>natsort</code>'s key-generator:</p>
<pre><code>&gt;&gt;&gt; from natsort import natsort_keygen, ns
&gt;&gt;&gt; humansort_key = natsort_keygen(alg=ns.LOCALE)
&gt;&gt;&gt; humansort_key(this) &lt; humansort_key(that)
</code></pre>
<hr/>
<p>Note, you don't necessarily need to use locale... you just need to properly normalize the unicode, which <code>natsort</code> automatically does under the hood. In your case, it looks like you want both capital and lower case letters grouped together with the lowercase first, so you could use this instead</p>
<pre><code>&gt;&gt;&gt; natsorted(data, alg=ns.GROUPLETTERS | ns.LOWERCASEFIRST)  # or ns.G | ns.LF
['anabel', 'Arachno', 'de Hahn', 'Öztürk', 'Schneider', 'Zabel']
</code></pre>
<p>I suggest this because trying to deal with locale is a nightmare, and if it is not needed then you are much better off.</p>
</div>
<div class="post-text" itemprop="text">
<p>does that help ?</p>
<pre><code>import locale
locale.setlocale(locale.LC_ALL, "")

lst = ['Zabel', 'Schneider', 'anabel', 'Arachno', 'Öztürk', 'de Hahn']

print(sorted(lst, key=locale.strxfrm))
</code></pre>
<p>gave me :</p>
<pre><code>['anabel', 'Arachno', 'de Hahn', 'Öztürk', 'Schneider', 'Zabel']
</code></pre>
<p>To go further I've been on : <a href="http://code.activestate.com/recipes/576507-sort-strings-containing-german-umlauts-in-correct-/" rel="nofollow noreferrer">http://code.activestate.com/recipes/576507-sort-strings-containing-german-umlauts-in-correct-/</a></p>
<p><strong>UPDATE</strong></p>
<p>Ok so if you want to keep your method and get rid of umlauts you can do something like this, there are tons of better way to do it, but that's a start:</p>
<pre><code>import locale
locale.setlocale(locale.LC_ALL, "")

lst = ['Zabel', 'Schneider', 'anabel', 'Arachno', 'Öztürk', 'de Hahn']

def _human_key(your_list):
    your_list.sort(key=locale.strxfrm)
    res = []
    for item in your_list:
        word = item.replace("Ä", "A").replace("Ö", "O").replace("Ü", "U")\
              .replace("ä", "a").replace("ö", "o").replace("ü", "u")\
              .replace("ß", "s")
        res.append(word)
    return res

print(_human_key(lst))
</code></pre>
<p>gave me :</p>
<p><code>['anabel', 'Arachno', 'de Hahn', 'Ozturk', 'Schneider', 'Zabel']</code></p>
<p>Nothing mean, but using Regex doesn't seem to be an appropriate tag and/or approach on your problem if you could not implement the previous code in your method.
Hope it helped</p>
</div>
<span class="comment-copy">Why not go with something like <a href="https://stackoverflow.com/a/25057291/3820185">stackoverflow.com/a/25057291/3820185</a></span>
<span class="comment-copy">Why do you want to replace unicode characters? They are characters after all.</span>
<span class="comment-copy">There is a difference between upper and lower case. You could avoid this by converting all keys to one case within the function.</span>
<span class="comment-copy">Are you sure what you doing is right? You replace 'ä' by 'a' while it should be 'ae', you replace 'ö' by 'o' while it should be 'oe'. See "<a href="https://en.wikipedia.org/wiki/Diaeresis_(diacritic)" rel="nofollow noreferrer">en.wikipedia.org/wiki/Diaeresis_(diacritic)</a>", "Printing conventions in German".</span>
<span class="comment-copy">You should use "custom sort" to define your sort logic</span>
<span class="comment-copy">thank you, this seems to do the job how I want it to:  from natsort import natsort_keygen, ns humansort_key = natsort_keygen(alg=ns.LOCALE)          class HumanProxyModel(QtCore.QSortFilterProxyModel):             def lessThan(self, source_left, source_right):             data_left = source_left.data()             data_right = source_right.data()             if type(data_left) == type(data_right) == str:                             return humansort_key(data_left) &lt; humansort_key(data_right)             return super(HumanProxyModel, self).lessThan(source_left, source_right)</span>
<span class="comment-copy">looks good, but how to work this into the _human_key() function? I have no idea... :-/</span>
<span class="comment-copy">@ProfP30 You do not need the function <code>_human_key</code> anymore. You can use <code>lst.sort(key=locale.strxfrm)</code>... @Nqsir When I use this solution "Öztürk" comes before "de Hahn"</span>
<span class="comment-copy">@ProfP30, check my update</span>
<span class="comment-copy">@Sven Krüger, which version of python do you have ? I have 3.7.2</span>
<span class="comment-copy">I have 3.7.1 but I am afraid with the solution <code>locale.setlocale(locale.LC_ALL, "")</code> the clients local settings comes into affect, so you could get different results, depending on the machine... which is what I would like to avoid...  With the <code>key=locale.strxfrm</code> solution I also get undesired results.</span>
<div class="post-text" itemprop="text">
<p>I understand what does normalizing an image mean. Normalizing an image would project the image data into a predefined range [0,1]. To normalize an image using <code>OpenCV</code>, I did as follows:</p>
<pre><code>img = cv2.imread("./images/model.jpg")
normalized = cv2.normalize(img, None)
</code></pre>
<p>And that normalizes as expected.</p>
<p>But does it make any sense to normalize the image and then store the normalized image? Because it would just be a complete black image. I was going through some pseudo code, where the following steps were being performed:</p>
<ul>
<li>Read all images in the directory</li>
<li>Flatten the images read <code>(np.flatten)</code> and store in some array <code>A</code></li>
<li>Compute the mean of all columns inside <code>A</code>. <code>(One column would correspond to one feature for all the images)</code></li>
<li>Organize the contents in mean array to a 2D array.</li>
<li>Normalize the image</li>
<li>Store the normalized image</li>
</ul>
<p>I could not understand, why would anyone store the normalized image. Does it make any sense? Is there something I am missing with OpenCV (may be a different way to normalize)?</p>
</div>
<span class="comment-copy">Storing a normalized image could make sense, it depends on your goal. Maybe you can provide some images you are working with, so it would be easier to spot what you are missing or why it might not make sense in your case.</span>
<span class="comment-copy">"Because it would just be a complete black image." Huh? If you ended up with a completely black image, then you either started with it in the first place, or you "normalized" it into range <code>[0,0]</code> (which I kinda doubt you can even do, since it doesn't make any sense -- just assign zeros to the whole array and be done with it, if you want it black). The point of normalizing is to have the image use the whole dynamic range available. You'd store it when you need to use the resulting image frequently and don't want to waste time doing the processing every time you need it.</span>
<div class="post-text" itemprop="text">
<p>I am trying to create a stacked bar chart using DataFrame 'Gender' which currently outputs:</p>
<pre><code>Loan_Status    N    Y
Gender               
Female        37   75
Male         150  339
</code></pre>
<p>I have the following code but I am getting the error: 'No Axis Named 1 for Object Type '</p>
<pre><code>Gender=pd.crosstab(train['Gender'],train['Loan_Status'])
Gender.div(Gender.sum(1).astype(float), axis=0).plot(kind="bar", stacked=True, figsize=(4,4))

ValueError: No axis named 1 for object type &lt;class 'pandas.core.frame.DataFrame'&gt;
</code></pre>
<p>Hoping someone can help me out :)</p>
</div>
<span class="comment-copy">Code seems fine, what version of pandas are you using? <code>print(pd.__version__)</code></span>
<span class="comment-copy">using 0.23.4 pandas, to add on to this i'm running it on a jupyter notebook in case that changes anything</span>
<span class="comment-copy">I've ran your code in jupyter notebook with pandas 0.24.2 and it worked fine</span>
<span class="comment-copy">I tried the code with collab and it seems to work fine, must have been an issue with the jupyter notebook pandas I was using</span>
<div class="post-text" itemprop="text">
<pre><code>import discord
from discord import Embed, Color


def ex(args, message, client, invoke):
    if (message.mentions.__len__() &gt; 0):
        for member in message.mentions:
            server = message.server.name
            role = discord.utils.get(server.roles, name="MMDev")
            yield from client.add_roles(member, role)
</code></pre>
<p>This is my code. I have tried to add the mentioned user the role "MMDev". 
This is the error: </p>
<pre><code>Traceback (most recent call last):
  File "venv\lib\site-packages\discord\client.py", line 307, in _run_event
    yield from getattr(self, event)(*args, **kwargs)
  File "main.py", line 91, in on_message
    yield from commands.get(invoke).ex(args, message, client, invoke)
  File "cmdmute.py", line 9, in ex
    role = discord.utils.get(server.roles, name="MMDev")
AttributeError: 'str' object has no attribute 'roles'
</code></pre>
<p>It´s Python 3.5</p>
</div>
<div class="post-text" itemprop="text">
<p><code>message.server.name</code> is the name of the server, you instead want the <code>Server</code> object itself.  </p>
<pre><code>def ex(args, message, client, invoke):
    if (message.mentions.__len__() &gt; 0):
        for member in message.mentions:
            role = discord.utils.get(message.server.roles, name="MMDev")
            if role:
                yield from client.add_roles(member, role)
</code></pre>
</div>
<span class="comment-copy">@Jakob.B please add your inputs also.</span>
<span class="comment-copy">your <code>server</code> variable is a string, containing the name of the server, not a server object; you cannot just do <code>server.roles</code>; you can get the role by: <code>role = message.server.roles</code></span>
<div class="post-text" itemprop="text">
<p>I have a string. The end is different, such as <code>index.php?test=1&amp;list=UL</code> or <code>index.php?list=UL&amp;more=1</code>. The one thing I'm looking for is <code>&amp;list=</code>.</p>
<p>How can I match it, whether it's in the middle of the string or it's at the end? So far I've got <code>[&amp;|\?]list=.*?([&amp;|$])</code>, but the <code>([&amp;|$])</code> part doesn't actually work; I'm trying to use that to match either <code>&amp;</code> or the end of the string, but the end of the string part doesn't work, so this pattern matches the second example but not the first.</p>
</div>
<div class="post-text" itemprop="text">
<p>Use:</p>
<pre><code>/(&amp;|\?)list=.*?(&amp;|$)/
</code></pre>
<p>Note that when you use a bracket expression, every character within it (with <a href="http://en.wikipedia.org/wiki/Regular_expression#POSIX_Basic_Regular_Expressions" rel="noreferrer">some</a> exceptions) is going to be interpreted literally. In other words, <code>[&amp;|$]</code> matches the <strong>characters</strong> <code>&amp;</code>, <code>|</code>, and <code>$</code>.</p>
</div>
<div class="post-text" itemprop="text">
<h1>In short</h1>
<p>Any zero-width assertions inside <code>[...]</code> lose there meaning of a zero-width assertion. <code>[\b]</code> does not match a word boundary (it matches a backspace, or, in POSIX, <code>\</code> or <code>b</code>), <code>[$]</code> matches a literal <code>$</code> char, <code>[^]</code> is either an error or, as in ECMAScript regex flavor, any char. Same with <code>\z</code>, <code>\Z</code>, <code>\A</code> anchors.</p>
<p>You may solve the problem using any of the below patterns:</p>
<pre><code>[&amp;?]list=([^&amp;]*)
[&amp;?]list=(.*?)(?=&amp;|$)
[&amp;?]list=(.*?)(?![^&amp;])
</code></pre>
<h1>Matching between a char sequence and a single char or end of string (current scenario)</h1>
<p>The <code>.*?([YOUR_SINGLE_CHAR_DELIMITER(S)]|$)</code> pattern (<a href="https://stackoverflow.com/a/12083343/3832970">suggested by João Silva</a>) is rather inefficient since the regex engine checks for the patterns that appear to the right  of the lazy dot pattern first, and only if they do not match does it "expand" the lazy dot pattern.</p>
<p>In these cases it is recommended to use <a href="https://www.regular-expressions.info/charclass.html#negated" rel="nofollow noreferrer"><em>negated character class</em></a> (or <em>bracket expression</em> in the POSIX talk):</p>
<pre><code>[&amp;?]list=([^&amp;]*)
</code></pre>
<p><a href="https://regex101.com/r/ZQb63I/1" rel="nofollow noreferrer">See demo</a>. <strong>Details</strong></p>
<ul>
<li><code>[&amp;?]</code> - a positive character class matching either <code>&amp;</code> or <code>?</code> (note the relationships between chars/char ranges in a character class are OR relationships)</li>
<li><code>list=</code> - a substring, char sequence</li>
<li><code>([^&amp;]*)</code> - Capturing group #1: zero or more (<code>*</code>) chars other than <code>&amp;</code> (<code>[^&amp;]</code>), as many as possible</li>
</ul>
<h1>Checking for the trailing single char delimiter presence without returning it  or end of string</h1>
<p>Most regex flavors (including JavaScript beginning with ECMAScript 2018) support lookarounds, constructs that only return true or false if there patterns match or not. They are crucial in case consecutive matches that may start and end with the same char are expected (see the original pattern, it may match a string starting and ending with <code>&amp;</code>). Although it is not expected in a query string, it is a common scenario.</p>
<p>In that case, you can use two approaches:</p>
<ul>
<li>A positive lookahead with an alternation containing positive character class: <code>(?=[SINGLE_CHAR_DELIMITER(S)]|$)</code></li>
<li>A negative lookahead with just a negative character class: <code>(?![^SINGLE_CHAR_DELIMITER(S)])</code></li>
</ul>
<p>The negative lookahead solution is a bit more efficient because it does not contain an alternation group that adds complexity to matching procedure. The OP solution would look like</p>
<pre><code>[&amp;?]list=(.*?)(?=&amp;|$)
</code></pre>
<p>or</p>
<pre><code>[&amp;?]list=(.*?)(?![^&amp;])
</code></pre>
<p>See <a href="https://regex101.com/r/ZQb63I/2" rel="nofollow noreferrer">this regex demo</a> and <a href="https://regex101.com/r/ZQb63I/3" rel="nofollow noreferrer">another one here</a>.</p>
<p>Certainly, in case the trailing delimiters are multichar sequences, only a positive lookahead solution will work since <code>[^yes]</code> does not negate a sequence of chars, but the chars inside the class (i.e. <code>[^yes]</code> matches any char but <code>y</code>, <code>e</code> and <code>s</code>).</p>
</div>
<span class="comment-copy">Thanks; the "interpreted literally" part I was not aware of for square brackets. Very useful! So in order to use <code>|</code> to separate two or more characters, is <code>()</code> required?</span>
<span class="comment-copy">Yes, indeed, you need to group (<code>()</code>) the alternatives.</span>
<span class="comment-copy"><a href="https://jsfiddle.net/jmqffocL/" rel="nofollow noreferrer">Not working for me.</a></span>
<span class="comment-copy">@DrazenBjelovuk You probably meant <a href="https://jsfiddle.net/jmqffocL/3/" rel="nofollow noreferrer"><code>'SomeText/blahblah'.match(/Some([^\/]*)/)[1]</code></a> (with <code>Text</code> as output). See <a href="https://stackoverflow.com/a/51134786/3832970">my answer</a>, each of the solution contains a <i>capturing group</i> that captures the required submatch that you usually get as the first group after a match is returned.</span>
<span class="comment-copy">@WiktorStribiżew In Hindsight, seems what I meant was <code>string.match(/Some.*?(\/|$)/)[0];</code>. No idea what for at this point though lol.</span>
<div class="post-text" itemprop="text">
<p>I plot boxplots using <code>sns.boxplot</code> and <code>pandas.DataFrame.boxplot</code> in python 3.x. </p>
<p>And I want to ask is it possible to adjust the spacing between boxes in boxplot, so the box of Group_b is farther right to the box of Group_a than in the output figures. Thanks</p>
<p>Codes:</p>
<pre><code>import pandas as pd
import matplotlib.pyplot as plt
%matplotlib inline
import seaborn as sns

dict_a = {'value':[1,2,3,7,8,9],'name':['Group_a']*3+['Group_b']*3}
dataframe = pd.DataFrame(dict_a)
sns.boxplot( y="value" , x="name" , data=dataframe )   
</code></pre>
<p>Output figure:</p>
<p><a href="https://i.stack.imgur.com/96A5J.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/96A5J.png"/></a></p>
<pre><code>dataframe.boxplot("value" ,by = "name" )
</code></pre>
<p>Output figure 2:</p>
<p><a href="https://i.stack.imgur.com/CgjNj.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/CgjNj.png"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>The distance between the two boxes is determined by the x axis limits. For a constant distance in data units between the boxes, what makes them spaced more or less appart is the fraction of this data unit distance compared to the overall data space shown on the axis. 
For example, in the seaborn case, the first box sits at x=0, the second at x=1. The difference is 1 unit. The maximal distance between the two boxplots is hence achieved by setting the x axis limits to those exact limits, </p>
<pre><code>ax.set_xlim(0, 1)
</code></pre>
<p>Of course this will cut half of each box. </p>
<p><a href="https://i.stack.imgur.com/HiNJr.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/HiNJr.png"/></a></p>
<p>So a more useful value would be <code>ax.set_xlim(0-val, 1+val)</code> with <code>val</code> being somewhere in the range of the width of the boxes.</p>
<p>One needs to mention that pandas uses different units. The first box is at x=1, the second at x=2. Hence one would need something like <code>ax.set_xlim(1-val, 2+val)</code>.</p>
<p>The following would add a slider to the plot to see the effect of different values.</p>
<pre><code>import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

dict_a = {'value':[1,2,3,7,8,9],'name':['Group_a']*3+['Group_b']*3}
dataframe = pd.DataFrame(dict_a)

fig, (ax, ax2, ax3) = plt.subplots(nrows=3,
                                   gridspec_kw=dict(height_ratios=[4,4,1], hspace=1))

sns.boxplot( y="value" , x="name" , data=dataframe, width=0.1, ax=ax)   
dataframe.boxplot("value", by = "name", ax=ax2)


from matplotlib.widgets import Slider
slider = Slider(ax3, "", valmin=0, valmax=3)

def update(val):
    ax.set_xlim(-val, 1+val)
    ax2.set_xlim(1-val, 2+val)

slider.on_changed(update)


plt.show()
</code></pre>
<p><a href="https://i.stack.imgur.com/ecANW.gif" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/ecANW.gif"/></a></p>
</div>
<span class="comment-copy">The spacing between boxplots is one data unit. The axes is roughly two data units wide. If you limit the axes to something like 1.3 units, the relative spacing between the boxes will be larger and they will appear further away from each other on screen. Not sure it this is what you're after. Probably a clear description of the desired outcome would be helpful here.</span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/35090425/seaborn-boxplots-at-desired-distances-along-the-x-axis">seaborn boxplots at desired distances along the x axis</a></span>
<span class="comment-copy">Closing it as a dupe. Use <code>dataframe.boxplot("value", by = "name", positions=[1,10])</code> to have a wide spacing between the two boxes. Choose the number depending on how far you want them from each other</span>
<span class="comment-copy">Another relevant answer <a href="https://stackoverflow.com/questions/28712123/matplotlib-shift-boxplots-along-x-axis">here</a></span>
<span class="comment-copy">@Echan: Check the first answer on the marked dupe. Once can insert a column of x-values in DataFrame and then use that as the x-argument. Later, one can replace the x-ticklabels with your strings. Check the second link too which I posted</span>
<div class="post-text" itemprop="text">
<p>new to python and trying to use plotly and I somehow broke something...</p>
<p>did pip install plotly, that worked.
was able to do "import plotly" in CLI, ok all good</p>
<p>then wrote a script and named it plotly.py 
ran that and it can't find the module plotly </p>
<p>thinking the naming is causing a problem, I renamed my script to ptest.py, still can't find the module</p>
<p>read up here a bit... printing sys.path shows the directory plotly is in
checked the dir and made sure it is readable by all (it wasn't)</p>
<p>Still can't find the module</p>
<p>Added this to the script:</p>
<pre><code>import sys
sys.path.append("path to module") 
</code></pre>
<p>still can't find the module... </p>
<p>uninstall and reinstalled the module, no go. </p>
</div>
<span class="comment-copy">Don't name your script <code>plotly.py</code>. Is the name of the module, this is likely creating a conflict and hiding the module.</span>
<span class="comment-copy">I hope you have not set the path explicitly at OS level. Suggest you close that terminal or command window, open another one and try <b>import plotly</b> again and give a different name to your script.</span>
<span class="comment-copy">I renamed the file, closed the terminal and opened a fresh one, same issue.. it looks like it's trying to find it in my home directory /Users/name/plotly.py...</span>
<div class="post-text" itemprop="text">
<p>Ive been trying to create a profile page for a project, where the user can upload a profile pic and some basic personal information using Django as framework.</p>
<p>The text based information I pass in my code seem to work, but I cant get the user to upload a profile pic from the profile page. But if I go to django-admin page, I can upload and display the profile pic from there. So to models.py file seem to work, and the issue seem to be in forms.py file... Ive search the net for some time and various turtorials, but nothing seem to work. Please help :)</p>
<p>models.py file</p>
<pre><code>class Profile(models.Model):
user = models.OneToOneField(User, on_delete=models.CASCADE)
bio = models.TextField(max_length=500, blank=True)
location = models.CharField(max_length=30, blank=True)
birth_date = models.DateField(null=True, blank=True)
email_confirmed = models.BooleanField(default=False)
image= models.ImageField(upload_to='profile_image', blank=True)

def __str__(self):
    return self.user.username
</code></pre>
<p>forms.py file </p>
<pre><code>class ProfileUpdateForm(forms.ModelForm):
YEARS= [x for x in range(1900,2021)]
birth_date = forms.DateField( initial="21-06-1995", widget=forms.SelectDateWidget(years=YEARS))
image = models.ImageField(upload_to='profile_image',blank=True)
class Meta:
    model = Profile
    fields = ('bio','birth_date','location','image')
</code></pre>
<p>views.py file </p>
<pre><code>@login_required
def profile_edit(request):
form = ProfileUpdateForm(request.POST)

if request.method == 'POST':

    if form.is_valid():
        user = request.user
        user.profile.bio = form.cleaned_data.get("bio")
        user.profile.birth_date = form.cleaned_data.get("birth_date")
        user.profile.location = form.cleaned_data.get("location")
        user.save()
        return redirect('profile')
    else:
        form = ProfileUpdateForm()

context = {
    'form' : form

}
return render(request, 'webside/profile_edit.html', context)
</code></pre>
<p>Static root/url and Media root/url has been implemented in settings and Ive added the static url to the urls.py file. Any help would be greatly appreciated :)</p>
</div>
<div class="post-text" itemprop="text">
<p>You're only passing the data to the form, not the files:</p>
<pre><code>form = ProfileUpdateForm(request.POST)
</code></pre>
<p>Change to:</p>
<pre><code>form = ProfileUpdateForm(data=request.POST, files=request.FILES)
</code></pre>
<p>And save your form instead of assigning the data to a <code>user</code> object. You're not saving the <code>user.profile</code> when you do <code>user.save()</code>:</p>
<pre><code>profile = form.save(commit=False)
profile.user = request.user
profile.save()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You did not save your image in view after posting from your form object. You save it like this if form is valid</p>
<pre><code>if 'image' in request.FILES:

            user.profile.image = request.FILES['image']
</code></pre>
</div>
<span class="comment-copy">Read <a href="https://docs.djangoproject.com/en/2.1/topics/http/file-uploads/" rel="nofollow noreferrer">this</a>. You'll learn how to pass the files to your form and how to save your form.</span>
<span class="comment-copy">But equally as bad, OP is not using the form.save().</span>
<span class="comment-copy">Thanks for the help! :D</span>
<span class="comment-copy">Wow! Thank you so much!! That fixed it :DDD</span>
<div class="post-text" itemprop="text">
<p>Newbie to Python here. I am trying to find the longest length of a value within a series of nested lists. Here is an example list type:</p>
<pre><code>tableData = [['apples', 'oranges', 'cherries', 'banana'],
             ['Alice', 'Bob', 'Carol', 'David'],
             ['dogs', 'cats', 'moose', 'goose']]
</code></pre>
<p>The answer that I want here is <code>8</code>, but this could change if the list is updated.</p>
<p>When I use <code>print(len(tableData))</code> I get 3, the number of nested lists. I cannot get a loop working that solves this either.</p>
<p>Sorry for this being a really simple question, but I am at a loss. </p>
<p>Thanks in advance for the help. </p>
</div>
<div class="post-text" itemprop="text">
<p>As you note, <code>len(tableData)</code> gives the number of elements of <code>tableData</code>. What you want is the max of the lengths of the elements <em>of the elements</em> of <code>tableData</code>:</p>
<pre><code>l = max(len(x) for sublist in tableData for x in sublist)
</code></pre>
<p></p>
<pre><code>&gt;&gt;&gt; print(l)
8
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Iterate over each element and get its <code>len()</code> for comparison.</p>
<pre><code>tableData = [['apples', 'oranges', 'cherries', 'banana'],
             ['Alice', 'Bob', 'Carol', 'David'],
             ['dogs', 'cats', 'moose', 'goose']]

maxCount = 0
for lst in tableData:
    for elem in lst:
        maxCount = max(maxCount, len(elem))

print(maxCount)
</code></pre>
<p><strong>OUTPUT</strong>:</p>
<pre><code>8
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>from itertools import chain

chain.from_iterable(tableData)
</code></pre>
<p>This now behaves as if you had one long list of single values, instead of a list of lists of values. Now it's trivial to find the longest item in that flattened list:</p>
<pre><code>max(chain.from_iterable(tableData), key=len)
</code></pre>
<p>This returns <code>'cherries'</code>.</p>
<pre><code>max(map(len, chain.from_iterable(tableData)))
</code></pre>
<p>This returns <code>8</code>.</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; data=np.array([['apples', 'oranges', 'cherries', 'banana'],
             ['Alice', 'Bob', 'Carol', 'David'],
             ['dogs', 'cats', 'moose', 'goose']]).reshape(-1)
&gt;&gt;&gt; max(data,key=len)
'cherries'
&gt;&gt;&gt; len(max(data,key=len))
8
</code></pre>
<p>Contributing my part to this answer.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can try with loop...</p>
<pre><code>l = 0 
for row in tableData: 
     for col in row: 
         l = len(col) if l &lt; len(col) else l 
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>maxLength = 0
for row in tableData:
    maxRowElementLength = len(max(row, key=len))
    if maxLength &lt; maxRowElementLength:
        maxLength = maxRowElementLength

print(maxLength)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Perhaps this will work for you:</p>
<pre><code>new_list = []
for sub_list in tableData:
    for item in sub_list:
        new_list.append(item)

max_element = max(new_list, key=len)

print(max_element) # this actually prints the item
print(len(max_element)) # this will give you the length
</code></pre>
</div>
<span class="comment-copy">If I may say so, this here is the fastest way to do it from all the versions on offer. It's about twice as fast as a double generator expression, and about three times as fast as two <code>for</code> loops. Not that it matters much for lists this size, but just saying…</span>
<span class="comment-copy">Please edit your question so as to explain your code (you might also consider <a href="https://meta.stackexchange.com/questions/114762/explaining-entirely-code-based-answers">this post</a> explaining why it's useful to go beyond a code-only answer)</span>
<span class="comment-copy">Thanks for the edit, ukemi</span>
<div class="post-text" itemprop="text">
<p>I would like to create a counter for a Panda DataFrame to save only until a certain Value in a  specific column.
f.e  save only until df['cycle'] == 2. </p>
<p>For what I gathered from the answers below is that df[df['cycle']&lt;=2] will solve my Problem.  </p>
<p>Edit: If I am correct python pandas always read the whole file, only if us nrows than you say f.e go to index x but want if I don't want to use Index but a specific value from a column.  How can I do that?</p>
<p>See my code below: </p>
<pre><code>import pandas as pd
import numpy as np

l = list(np.linspace(0,10,12))
data = [
        ('time',l),
         ('A',[0,5,0.6,-4.8,-0.3,4.9,0.2,-4.7,0.5,5,0.1,-4.6]),
         ('B',[ 0,300,20,-280,-25,290,30,-270,40,300,-10,-260]),
         ]
df = pd.DataFrame.from_dict(dict(data))
df['cycle'] = [df.index.get_loc(i) // 4 + 1 for i in  df.index]
df[df['cycle']&lt;=2]
df.to_csv(path_or_buf='test.out', index=True, sep='\t', columns=['time','A','B','cycle'], decimal='.')
</code></pre>
<p>So I modified the answer according to the suggestion from the users.</p>
<p>I am glad for every help that I can get. </p>
</div>
<span class="comment-copy">What is expected output ? Do you need filter by <code>df[df['cycle'] == 2]</code> ?</span>
<span class="comment-copy">@jezrael I think he want <code>df[df['cycle'] &lt;= 2]</code></span>
<span class="comment-copy">@Akhilesh - Not sure, but if it is some kind combination with reseting counter, not idea, so commnet</span>
<span class="comment-copy">You probably want <code>df[df['cycle']&lt;=2].to_csv(path_or_buf='test.out', index=True, sep='\t', columns=['time','A','B','cycle'], decimal='.')</code>. Only posting as a comment because I could not understand what you mean at <i>Can I do it without reading the whole data frame, to save me some time and memory?</i></span>
<span class="comment-copy">If you are loading the file from a csv, you can use <code>nrows</code> as in <code>read_csv('mydata.csv', nrows = cycle * 4)</code> . I assume each cycle is 4 rows, and if you want to load 2 cycles, you would need to load 8 rows. Also <code>df['cycle'] = (df.index.values // 4 + 1).tolist()</code> is slightly shorter.</span>
<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/32037893/numpy-fix-array-with-rows-of-different-lengths-by-filling-the-empty-elements-wi">Numpy: Fix array with rows of different lengths by filling the empty elements with zeros</a>
<span class="question-originals-answer-count">
                    4 answers
                </span>
</li>
</ul>
</div>
<p>I have a Numpy array of arrays and each array inside the main array has a different size. I need to pad the end with 0s at each array so that all arrays that are inside the main array are of equal length but I do not know the max length. I want it to be done in a cleaner way instead of finding the max length and assigning 0's at the end as and when required. a below is already a Numpy aray</p>
<pre><code>a=[
   [1,2,3,4],
   [3,56],
   [8,4,8,4,9,33,55]
  ] .
   In this case maxlength is 7(the length of third array) . 
   I want final array to look like follows 
a=[
   [1,2,3,4,0,0,0],
   [3,56,0,0,0,0,0],
   [8,4,8,4,9,33,55]
  ]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>For numpy.pad solution I think we need to ensure your input is exactly as you have it so we can get a proper solution. Then it will just be: </p>
<pre><code>a=[
      np.asarray([1,2,3,4]),
      np.asarray([3,56]),
      np.asarray([8,4,8,4,9,33,55])
 ]


max_len = max([len(x) for x in a])

output = [np.pad(x, (0, max_len - len(x)), 'constant') for x in a]

print(output)

&gt;&gt;&gt; [
     array([1, 2, 3, 4, 0, 0, 0]), 
     array([ 3, 56,  0,  0,  0,  0,  0]), 
     array([ 8,  4,  8,  4,  9, 33, 55])
    ]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Quick and dirty:</p>
<pre><code>a=[
   [1,2,3,4],
   [3,56],
   [8,4,8,4,9,33,55]
  ]

n = len(a)
m = max([len(x) for x in a])

A = np.zeros((n,m))
for i in range(n):
    A[i,:len(a[i])] = a[i]
print A
</code></pre>
<p>As I saw in your comment on @Scott Skiles solution, that  you want to use np.pad for this, wou can change the line within the for loop by:</p>
<pre><code>A[i] = np.pad(a[i],(0,m-len(a[i])),'constant', constant_values=0)
</code></pre>
</div>
<span class="comment-copy">i want to use np.pad ... not sure if I can use. I wanted a cleaner way and my array is Numpy array , i will need that to be numpy for future also</span>
<span class="comment-copy">Your input array cannot be a numpy array. Is it a list of numpy arrays?</span>
<span class="comment-copy">yes list of numpy array [Numpy array,Numpy array, Numpy array]</span>
<span class="comment-copy">ok working on it</span>
<span class="comment-copy">this works. Thanks !!</span>
<span class="comment-copy">can i use np.pad and automatically do it instead of m=max([len(x) for x in a]) and for loop?</span>
<span class="comment-copy">I donot think so, as np.pad needs a numpy array (or alike) as input. Your input is not alike. If you need it more often, just make a function</span>
<span class="comment-copy">it works , but I see that in the process a becomes list of list at the end</span>
<span class="comment-copy">print type(A) gives &lt;type 'numpy.ndarray'&gt; for me. I am not sure if I understood your expected output correctly. I thought you wanted a numpy array in the end. If you want a list of np.arrays just stick to Scott's solution</span>
<div class="post-text" itemprop="text">
<p>I am trying to input the 5 numbers in defined length set and try to print out those numbers but it's giving "TypeError: 'int' object is not iterable" this error.</p>
<pre><code>print("enter 5 numbers")
a=set(5)
for i in range(0,5):
    a.append(int(input("enter a number")))
for i in range(0,5):
    print("numbers in array are",a[i])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I think there is some confusion on what <code>set</code> actually does. I assume you want to make a predefined set of length 5. When doing:</p>
<pre><code>set(5)
</code></pre>
<p>you get:</p>
<pre><code> TypeError: 'int' object is not iterable
</code></pre>
<p>because you're trying to make a set containing only the integer 5. If you want to make a <code>set</code> from that, you would have to include an iterable, maybe like so:</p>
<pre><code>set((5,))

Out: {5}
</code></pre>
<p>But what I would recommend you to do is declare</p>
<pre><code>a = []  # create an empty list
</code></pre>
<p>and then run your code. At the end then, I would make a <code>set</code> by typing</p>
<pre><code>a = set(a)
</code></pre>
<p>Hopefully that was helpful for you! Have fun coding! :)</p>
</div>
<div class="post-text" itemprop="text">
<p>You cannot fix the size of set while creating. </p>
<p><code>a = set(5)</code> is the source of your error. </p>
<p>Also, sets do not have <code>append</code> method. You should use <code>a.add("data")</code> for adding elements to the set. </p>
<p>To ensure that the size of set does not exceed a particular length, you can try something like this</p>
<pre><code>fixed_length = 3
a=set()
for i in range(0,5):
    if len(a) == fixed_length:
        break
    else:
        a.add(int(input("enter a number")))

for index, element in enumerate(a):
    print("numbers in array are", element)
</code></pre>
</div>
<span class="comment-copy">sets are not arrays! Your code would fail because 5 is not iterable. Also set has add and not append to add elements. Getting element by index from set will also not work.</span>
<span class="comment-copy">also, <code>set</code> does not have a method <code>.append()</code>; maybe you want to use <code>.add()</code> instead.</span>
<span class="comment-copy"><code>{5}</code> instead of <code>set((5,))</code></span>
<span class="comment-copy">it is shorter, yes. but i was trying to highlight the difference to the code before here</span>
<span class="comment-copy">So how can I store 5 numbers given by a user and then print them?</span>
<span class="comment-copy">@AaquibAhmedDiaz I have updated the answer to include the same.</span>
<div class="post-text" itemprop="text">
<p>I have loaded the dataset using pandas and printed the first 5 rows </p>
<pre><code>df = pd.read_csv(r'filename')print(df.shape)
print(df.shape)
</code></pre>
<p>prints out the number of rows and columns in the dataset</p>
<blockquote>
<p>(15997, 8)</p>
</blockquote>
<pre><code>print(df.head(5))
</code></pre>
<p><a href="https://i.stack.imgur.com/AqyzK.png" rel="nofollow noreferrer">Just to show what the results look like</a></p>
<p>Then if if I split the dataset</p>
<pre><code>X = df.iloc[1:].values
y = df.iloc[0].values

from sklearn.model_selection import train_test_split
X_train,X_test,y_train,y_test = train_test_split(X,y,test_size=0.4,random_state=42, stratify=y)
</code></pre>
<p>I get this error</p>
<blockquote>
<p>ValueError: Found input variables with inconsistent numbers of samples: [15996, 8]</p>
</blockquote>
<p>I need the X value to exclude the first row from the dataset and y value to only include the first row </p>
</div>
<div class="post-text" itemprop="text">
<p>for <strong>df.iloc</strong> first index works as key, so you are splitting on rows. Second index is for columns. Try this:-</p>
<pre><code>X = data.iloc[:,1:]
Y = data.iloc[:,0]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Try. </p>
<pre><code>X = data.iloc[:,1:]
y = data.iloc[:,0]
</code></pre>
<p>Since your dataframe has two dimensions, you have to slice in both dimensions in order to create a subframe.</p>
</div>
<span class="comment-copy">y is supposed to be the first row of the dataset not column and X is the whole dataset excluding the first row. The code above takes out the first column from the dataset for X and y takes the first column.</span>
<div class="post-text" itemprop="text">
<p>It seems to me as if python print can't print German umlauts in lists, dictionary and tuples. How can I change this?</p>
<pre><code># -*- coding: cp1252 -*-
print 'ÄÖÜ' #'ÄÖÜ'

x = 'ÄÖÜ'
print x #'ÄÖÜ'

x = ['ÄÖÜ',]
print x #['\xc4\xd6\xdc']
print x[0] #'ÄÖÜ'

x = [u'ÄÖÜ',]
print x #['\xc4\xd6\xdc']
print x[0] #'ÄÖÜ'

x = {'Ä': 'Ü'}
print x #{'\xc4': '\xdc'}
print x['Ä'] #'Ü'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Change your coding to this:</p>
<pre><code># -*- coding: cp852 -*-
</code></pre>
</div>
<span class="comment-copy">Switch to python 3!! ;)</span>
<span class="comment-copy">I can't in this moment, no way in 2.7?</span>
<span class="comment-copy">try using unicode ? <a href="https://stackoverflow.com/questions/22745876/python-print-unicode-list" title="python print unicode list">stackoverflow.com/questions/22745876/python-print-unicode-list</a></span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/2180929/why-do-i-get-the-uxyz-format-when-i-print-a-list-of-unicode-strings-in-python">Why do I get the u"xyz" format when I print a list of unicode strings in Python?</a></span>
<span class="comment-copy">This won't help. The <code>coding</code> hint tells the Python interpreter what encoding your source code file (*.py) is saved as, it will not do anything about the output. And the fact that it displays <code>'ÄÖÜ'</code> when printing a string means that the source code encoding already is correct.</span>
<div class="post-text" itemprop="text">
<p>i have .sql files in certain location. So i just want to write one python script which is first count the total .sql files on given location and run one by one .sql files.</p>
<p>**</p>
<pre><code>Extract Survey Data.sql
tb_exec_ns_call_actvty.sql
tb_exec_ns_call_keymsg.sql
</code></pre>
<p>**</p>
<p>i also want to save query result into .CSV file one by one.</p>
<p>Please let me teach how to do that?</p>
<p>i tried to count the number of sql file in the given folder-</p>
<pre><code>path = "D:/Users/SPate233/Downloads/NS dashboard/sql_query"
num_files = len([f for f in os.listdir(path)if os.path.isfile(os.path.join(path, f))])
print(num_files)
</code></pre>
<p>now i want to iterate over every sql file one by one and print output.</p>
</div>
<span class="comment-copy">I'm voting to close this question as off-topic because SO is not a tutorial service. Please show your efforts</span>
<div class="post-text" itemprop="text">
<p>I created a function to create entry boxes (tkinter) but I want to be able to access the data in the entry boxes after. Therefore, I can't call all the boxes the same name e.g. Entry1=Entry(Solo) - I have to have Entry1, Entry2 etc...</p>
<p>I thought that I might be able to store the Entry Names in an array but it doesn't work. I can't just store the data in a list because when creating the entry boxes there is no data to store yet.</p>
<p>[Update] I tried to store an entry box in an list but it's not supported. 
<code>TypeError: 'set' object does not support item assignment</code></p>
<p>This is a snippet of code from my program (the code works without the lines with inputlist[i] on it):        </p>
<pre><code>    StudentsArray1 = c.fetchall()
    c.execute('SELECT Count(*) from students WHERE solo = 1;')
    x = c.fetchone()[0]
    a = 0
    rownum = 1

    inputlist = []

    for i in range(0, x):
        label1 = Label(Solo, text=StudentsArray1[a][0], font=font4, bg="white")
        label1.grid(row=rownum, column=1)
        label2 = Label(Solo, text=StudentsArray1[a][1], font=font4, bg="white")
        label2.grid(row=rownum, column=2)
        inputlist[i] = Entry(Solo)
        inputlist[i].grid(row=rownum, column=2)
        rownum = rownum + 1
        a = a + 1
</code></pre>
</div>
<span class="comment-copy">You can store them in a list or a dict.</span>
<span class="comment-copy"><i>"I tried ... an array"</i>: <b>This is not an array</b> =&gt; <code>inputarray = {}</code>  Read <a href="https://www.pythonforbeginners.com/lists/python-lists-cheat-sheet" rel="nofollow noreferrer">how to use lists in Python</a>. -  <a href="https://stackoverflow.com/posts/55260426/edit">Edit</a> your Question and show the output of <code>print(x)</code>.</span>
<div class="post-text" itemprop="text">
<p>I created a CRON Job to run a Python script at 11.45 everyday. However, when I tested , I see that python script is not getting executed:</p>
<pre><code>45 11 * * * /usr/bin/python2.7 /home/user/Documents/Example/main.py
</code></pre>
<p>I think that the problem is with python installation directory since I have multiple python installations and I am not sure which is correct one:</p>
<p>To check python installation, I used following command:</p>
<pre><code>whereis python
</code></pre>
<p>Output:</p>
<pre><code>python: /usr/bin/python3.6m /usr/bin/python2.7-config /usr/bin/python
/usr/bin/python3.6 /usr/bin/python2.7 /usr/lib/python3.7 
/usr/lib/python3.6 /usr/lib/python2.7 /etc/python /etc/python3.6 
/etc/python2.7 /usr/local/lib/python3.6 /usr/local/lib/python2.7 
/usr/include/python3.6m /usr/include/python2.7 /usr/share/python 
/usr/share/man/man1/python.1.gz
</code></pre>
<p>I have added executable permissions to the Python script and its parent directory:</p>
<pre><code>chmod a+x /home/user/Documents/Example/main.py
</code></pre>
<p>Note: I want to use python 2.7 for execution of the script. Is there anything that I am doing wrong</p>
</div>
<span class="comment-copy">can you post the result of <code>grep CRON /var/log/syslog</code> ? Obviously remove private information, if any.</span>
<span class="comment-copy">Have you tried running the command you added to cron i.e. does this execute <code>/usr/bin/python2.7 /home/user/Documents/Example/main.py</code> when you run it in your command line? Also to find full path of shell command use <code>which</code>, <code>whereis</code> is used to <code>locate the binary, source, and manual page files for a command</code></span>
<span class="comment-copy">I think the correct path for python 2.7 is <b>/etc/python2.7</b>. Try executing the script before iinserting it on crontab. <code>/etc/python2.7 /home/user/Documents/Example/main.py</code>  or even <code>/usr/bin/python2.7 /home/user/Documents/Example/main.py</code> and post the output.</span>
<span class="comment-copy">What is your script trying to do?, and how do you know that it is not executing?</span>
<span class="comment-copy">No MTA installed, discarding output: This is the rror I get when it tries to execute the job @Miles Davis</span>
<div class="post-text" itemprop="text">
<p>I have a string in a merged cell in an excel sheet. I want to extract the date at the end of the string using python. Please help on how we achieve this.</p>
<p>following  is the string which span across cells <code>A2:L2</code></p>
<pre><code>(BMC- sales/inventory for (Asia) for week (10-Mar-2019)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>After you extracted the string with python library openpyxl you can further process it with e.g. </p>
<pre><code>.split(" ")
</code></pre>
<p>to split at space.
This results can be put into a list and element [-1] will equal "(10-Mar-2019)".</p>
<p>This can be converted with .strip("(").strip(")") to get 10-Mar-2019</p>
</div>
<span class="comment-copy">You can use python library openpyxl and get the string from the cell.</span>
<span class="comment-copy">What do you need exactly? Extract from excel or parsing the string? Or both?</span>
<span class="comment-copy">Hi Davis, i need to extract the date form the string.</span>
<div class="post-text" itemprop="text">
<p>Is there any way to detect seasonality in a time series data in python without plotting it.
I tried all the visual methods such as, plot the series,run sequence plot,seasonal subseries plot, box plot and auto correlation plot.</p>
</div>
<div class="post-text" itemprop="text">
<p>Yes, there are numerous methods. Search for "testing for seasonality", e.g. <a href="https://digitalcommons.wayne.edu/cgi/viewcontent.cgi?article=2030&amp;context=jmasm" rel="nofollow noreferrer">https://digitalcommons.wayne.edu/cgi/viewcontent.cgi?article=2030&amp;context=jmasm</a> </p>
</div>
<div class="post-text" itemprop="text">
<p>I am making a program that makes AI's that play blackjack. One of the features of the program is allowing the user to play blackjack against an AI. I have already made a text based program of this, which I want to implement into an existing Tkinter GUI.The user interacts with a simple input(). How do I create a interactive terminal upon a button press, so that the user can play the game?</p>
</div>
<span class="comment-copy">What have you tried so far?</span>
<span class="comment-copy">I tried using the following stack post: <a href="https://stackoverflow.com/questions/7253448/how-to-embed-a-terminal-in-a-tkinter-application" title="how to embed a terminal in a tkinter application">stackoverflow.com/questions/7253448/…</a> . It embeds a terminal into the GUI but doesnt run my program when i try insert it into the code. im not sure if this is error on my part, or if it does not work</span>
<div class="post-text" itemprop="text">
<p>I have text which look like that </p>
<blockquote>
<p>{"@context":"<a href="http://schema.org" rel="nofollow noreferrer">http://schema.org</a>","@type":"Recipe","name":"Tartelette aux fraises et rhubarb'curd","recipeCategory":"tarte aux fraises","image":"<a href="https://assets.afcdn.com/recipe/20160527/8530_w1024h768c1cx1941cy2911.jpg" rel="nofollow noreferrer">https://assets.afcdn.com/recipe/20160527/8530_w1024h768c1cx1941cy2911.jpg</a>","datePublished":"2012-10-10T08:48:00+02:00","prepTime":"PT90M","cookTime":"PT15M","totalTime":"PT105M","recipeYield":"4 personnes","recipeIngredient":["250 g de fraises","150 g de farine","45 g de beurre","40 g de sucre","1  oeuf","1 pinc\u00e9e de sel","20 cl de rhubarbe (r\u00e9cup\u00e9r\u00e9 de ma conception de compote)","3  oeufs","75 g de sucre","1 cuill\u00e8re \u00e0 soupe de ma\u00efzena"],"recipeInstructions":[{"@type":"HowToStep","text":"Pour 4 tartelettes ( ou une grande tarte mais je pr\u00e9f\u00e8re les tartelettes, la p\u00e2te sabl\u00e9e \u00e9tant difficile \u00e0 couper :)) "},{"@type":"HowToStep","text":"Pr\u00e9parer la p\u00e2te sabl\u00e9e : "},{"@type":"HowToStep","text":"Couper le beurre en petits morceaux."},{"@type":"HowToStep","text":"Mettre tous les ingr\u00e9dients dans un saladier et tout m\u00e9langer \u00e0 la main ( ou au robot) jusqu'\u00e0 former une boule homog\u00e8ne. La r\u00e9server au frais au moins 1h pour pouvoir mieux l'\u00e9taler."},{"@type":"HowToStep","text":"Pendant que la p\u00e2te sabl\u00e9es pose, pr\u00e9parer le rhubarb'curd : "},{"@type":"HowToStep","text":"M\u00e9langer le sucre avec le jus de rhubarbe sur feu doux, jusqu\u2019\u00e0 ce que le sucre soit fondu. "},{"@type":"HowToStep","text":"A part, dans un bol (qui pourra aller au bain marie dans l'\u00e9tape suivante), battre la ma\u00efzena avec 1 oeuf. Lorsqu\u2019elle est bien dissoute, incorporer les 2 autres oeufs, toujours en fouettant."},{"@type":"HowToStep","text":"Incorporer ensuite le jus de rhubarbe chaud en fouettant bien, le m\u00e9lange commence \u00e0 \u00e9paissir. Placer le bol au bain marie et faire \u00e9paissir sur feu doux tout en fouettant tr\u00e8s r\u00e9guli\u00e8rement."},{"@type":"HowToStep","text":"Une fois qu\u2019elle est bien \u00e9paisse, transf\u00e9rer dans un autre bol ou saladier pour la refroidir. "},{"@type":"HowToStep","text":"Pendant que le curd refroidit, cuire la p\u00e2te sabl\u00e9e \u00e0 blanc. Etaler la p\u00e2te sabl\u00e9e et la r\u00e9partir dans les 4 moules \u00e0 tartelette (ou dans un grand moule \u00e0 tarte). Puis enfourner entre 10 et 15 min (en fonction de votre four) \u00e0 200\u00b0C (thermostat 6-7)."},{"@type":"HowToStep","text":"Laisser refroidir les fonds une bonne demi heure."},{"@type":"HowToStep","text":"Monter les tartelettes : "},{"@type":"HowToStep","text":"- mettre une couche de rhubarb' curd dans les fonds de tarte"},{"@type":"HowToStep","text":"- laver et \u00e9queuter les fraises"},{"@type":"HowToStep","text":"- les couper en 2 et les disposer sur le rhubarb'curd."},{"@type":"HowToStep","text":"- conserver au frais avant de servir"}],</p>
</blockquote>
<p>In the field RecipeInstructions I need to get everything write after "text": . I never used regular expression and I'm a little bit lost.</p>
</div>
<div class="post-text" itemprop="text">
<p>This looks like a json object but doesn't have [] around it to make it an actual list. You should be able to convert it into a Python native list of dictionaries and navigate it:</p>
<pre><code>import json

recipe = json.loads('[' + your_text + ']')
steps = [obj["text"] for obj in recipe if obj.get("@type") == "HowToStep"] 
</code></pre>
<p>What worries me though is that unless you truncated your text to post here, this may not be a well formed json. In which case you cannot use the above code and instead use regular expressions like this:</p>
<pre><code>import re

regex = r"\"text\":\"([^\"]*)\""
matches = re.findall(regex, your_text) 
</code></pre>
<p>'matches' should now be a list of all the text elements.</p>
<p>Curious about how this regex works? <a href="https://regex101.com/r/jTGua9/1" rel="nofollow noreferrer">Here's a simulator</a></p>
</div>
<span class="comment-copy">Looks like you need the <code>json</code> module</span>
<span class="comment-copy">I get those informations from an HTML page. I can use it even if it's write with HTML tag? @Rakesh</span>
<span class="comment-copy">Than use xml.etree</span>
<div class="post-text" itemprop="text">
<p>I've found how to remove column with zeros for all the rows using the command <code>df.loc[:, (df != 0).any(axis=0)]</code>, and I need to do the same but given the row number.</p>
<p>For example, for the folowing df</p>
<pre><code>In [75]: df = pd.DataFrame([[1,1,0,0], [1,0,1,0]], columns=['a','b','c','d'])

In [76]: df                                                                                                                                                                            
Out[76]: 
   a  b  c  d
0  1  1  0  0
1  1  0  1  0
</code></pre>
<p>Give me the columns with non-zeros for the row 0 and I would expect the result:</p>
<pre><code>   a  b
0  1  1
</code></pre>
<p>And for the row 1 get:</p>
<pre><code>   a  c
1  1  1
</code></pre>
<p>I tried a lot of combinations of commands but I couldn't find a solution.</p>
<p><strong>UPDATE:</strong></p>
<p>I have a 300x300 matrix, I need to better visualize its result.</p>
<p>Below a pseudo-code trying to show what I need</p>
<pre><code>for i in range(len(df[rows])):
  _df = df.iloc[i]
  _df = _df.filter(remove_zeros_columns)
  print('Row: ', i)
  print(_df)
</code></pre>
<p>Result:</p>
<pre><code>Row: 0
   a  b
0  1  1

Row: 1
   a  c  f
1  1  5  10

Row: 2
   e
2  20
</code></pre>
<p>Best Regards.
Kleyson Rios.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can change data structure:</p>
<pre><code>df = df.reset_index().melt('index', var_name='columns').query('value != 0')
print (df)
   index columns  value
0      0       a      1
1      1       a      1
2      0       b      1
5      1       c      1
</code></pre>
<p>If need new column by values joined by <code>,</code> compare values for not equal by <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.ne.html" rel="nofollow noreferrer"><code>DataFrame.ne</code></a> and use matrix multiplication by <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.dot.html" rel="nofollow noreferrer"><code>DataFrame.dot</code></a>:</p>
<pre><code>df['new'] = df.ne(0).dot(df.columns + ', ').str.rstrip(', ')
print (df)
   a  b  c  d   new
0  1  1  0  0  a, b
1  1  0  1  0  a, c
</code></pre>
<p>EDIT:</p>
<pre><code>for i in df.index:
    row = df.loc[[i]]

    a = row.loc[:, (row != 0).any()]
    print ('Row {}'.format(i))
    print (a)
</code></pre>
<p>Or:</p>
<pre><code>def f(x):
    print ('Row {}'.format(x.name))
    print (x[x!=0].to_frame().T)

df.apply(f, axis=1)

Row 0
   a  b
0  1  1
Row 1
   a  c
1  1  1
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>df = pd.DataFrame([[1, 1, 0, 0], [1, 0, 1, 0]], columns=['a', 'b', 'c', 'd'])


def get(row):

    return list(df.columns[row.ne(0)])


df['non zero column'] = df.apply(lambda x: get(x), axis=1)
print(df)
</code></pre>
<hr/>
<p>also if you want single liner use this</p>
<pre><code>df['non zero column'] = [list(df.columns[i]) for i in df.ne(0).values]
</code></pre>
<p>output</p>
<pre><code>   a  b  c  d non zero column
0  1  1  0  0          [a, b]
1  1  0  1  0          [a, c]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I think this answers your question more strictly.
Just change the value of given_row as needed.</p>
<pre><code>given_row = 1
mask_all_rows = df.apply(lambda x: x!=0, axis=0)
mask_row = mask_all_rows.loc[given_row]
cols_to_keep = mask_row.index[mask_row == True].tolist()
df_filtered = df[cols_to_keep]

# And if you only want to keep the given row
df_filtered = df_filtered[df_filtered.index == given_row]
</code></pre>
</div>
<span class="comment-copy">So how looks final DataFrame? Both rows together? What are new columns names?</span>
<span class="comment-copy">@jezrael I have a very large dense matrix with a lot of zeros, I need to find a way to better see the values. I would like to loop the rows of the dataframe and write/append to a txt file the ith row with only the columns with values &gt; 0. So, I need to slice the df by each row keeping the column names for non-zeros values.</span>
<span class="comment-copy">To split this for one row you could use: (df.iloc[i] != 0), this might help you to iterate over all rows</span>
<span class="comment-copy">@KleysonRios  when you see the first and second row of the example you have posted, the columns are a,c and a,d so how do you want the final df like? what are the column names there? can you post  sample expected output too?</span>
<span class="comment-copy">@Nihal not possible to have a final dataframe for the whole df. That's why I need a loop to select individual rows, filter the zeros columns and save this df* to a file, and then move to the next row. For each row I will have different columns, so not possible to put all together.</span>
<span class="comment-copy">I dont need to see the original matrix. Is a matrix of 300x300. As just need to see the selected row with the non-zeros columns.</span>
<span class="comment-copy">@KleysonRios - yes, so how should looks final output?</span>
<span class="comment-copy">@KleysonRios - check you check edited answer?</span>
<span class="comment-copy">Great @jezreal thanks.</span>
<span class="comment-copy">Interesting but this solution is not a good solution for my case. I have almost 300 column. The visualization is not good and easy yet. Please see, my last comment in the question.</span>
<span class="comment-copy">Very good as well. Thanks @Reimar.</span>
<div class="post-text" itemprop="text">
<p>Most of the tutorials and books about Django or Flask import specific classes from files instead of importing the whole file.<br/>
For example, importing <code>DataRequiered</code> validator from <code>wrtforms.validators</code> is done via <code>from wtforms import validators</code> instead of importing it via <code>import wtforms.validators as valids</code> and then accessing <code>DataRequiered</code> with <code>valids.DataRequiered</code>.<br/>
<br/>
<strong>My question is:</strong> Is there an reason for this ?<br/>
<br/>
I thought to something like avoiding the loading a whole module for computation/memory optimization (is it really relevant?) ? Or is it simply to make the code more readable ?<br/></p>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p>My question is: Is there an reason for this ?</p>
</blockquote>
<p><code>from module_or_package import something</code> is the canonical pythonic idiom (when you only want to import <code>something</code> in your current namespace of course). </p>
<p>Also, <code>import module_or_package.something</code> only works if <code>module_or_package</code> is a package and <code>something</code> a submodule, it raises an <code>ImportError(No module named something)</code> if <code>something</code> is a function, class or whatever object defined in <code>module_or_package</code>, as can be seen in the stdlib with <code>os.path</code> (which is a submodule of the <code>os.package</code>) vs <code>datetime.date</code> (which is a class defined in the <code>datetime</code> module):</p>
<pre><code>&gt;&gt;&gt; import os.path as p
&gt;&gt;&gt; p
&lt;module 'posixpath' from '/home/bruno/.virtualenvs/blook/lib/python2.7/posixpath.pyc'&gt;
</code></pre>
<p>vs</p>
<pre><code>&gt;&gt;&gt;import datetime.date as d
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
ImportError: No module named date
</code></pre>
<blockquote>
<p>thought to something like avoiding the loading a whole module for computation/memory optimization (is it really relevant?) </p>
</blockquote>
<p>Totally irrelevant - importing a given name from a module requires importing the whole module. Actually, this:</p>
<pre><code>from module_or_package import something
</code></pre>
<p>is only syntactic sugar for</p>
<pre><code>import module_or_package
something = module_or_package.something
del module_or_package
</code></pre>
<p>EDIT: You mention in a comment that</p>
<blockquote>
<p>Right, but importing the whole module means loading it to the memory, which can be a reason for importing only a submodule/class</p>
</blockquote>
<p>so it seems I failed to make the point clear: in Python, you <strong>can not</strong> "import only a submodule/class", period. </p>
<p>In Python, <code>import</code>, <code>class</code> and <code>def</code> are all executable statements (and actually just syntactic sugar for operation you can do 'manually' with functions and classes). Importing a module actually consists in executing all the code at the module's top-level (which will instanciate <code>function</code> and <code>class</code> objects) and create a <code>module</code> object (instance of <code>module</code> type) which attributes will be all names defined at the top-level via <code>import</code>, <code>def</code> and <code>class</code> statements or via explicit assignment. It's only when all this has been done that you can access any name defined in the module, and this is why, as I stated above,</p>
<pre><code>from module import obj
</code></pre>
<p>is only syntactic sugar for</p>
<pre><code>import module
obj = module.obj
del module
</code></pre>
<p>But (unless you do something stupid like defining a terabyte-huge dict or list in your module) this doesn't actually take that much time nor eat much ram, and a module is only effectively <em>executed</em> once per process the first time it's imported - then it's cached in <code>sys.modules</code> so subsequent imports only fetch it from cache. </p>
<p>Also, unless you actively prevents it, Python will cache the compiled version of the module (the .pyc files) and only recompile it if the .pyc is missing or older than the source .py file.</p>
<p>wrt/ packages and submodules, importing a submodule will also execute the package's <code>__init__.py</code> and build a <code>module</code> instance from it (IOW, at runtime, a package is also a <code>module</code>). Package initializer are canonically rather short, and actually quite often empty FWIW...</p>
</div>
<div class="post-text" itemprop="text">
<p>It depends, in the tutorial that was probably done for readability</p>
<p>Usually if you use most of the classes in a file, you import the file. If the files contains many classes but you only need a few, just import those. 
It's both a matter of readability and optimization.</p>
</div>
<span class="comment-copy"><a href="//stackoverflow.com/q/2386714">Why is "import *" bad?</a></span>
<span class="comment-copy">@VaibhavVishal I wholefully agree that star imports are bad, but I fail to see how this relates the question...</span>
<span class="comment-copy">Right, but importing the whole module means loading it to the memory, which can be a reason for importing only a submodule/class.</span>
<span class="comment-copy">@Alakazam as mentioned, "importing a given name from a module requires importing the whole module" - cf my edited answer for more details...</span>
<span class="comment-copy">I understand, but you're deleting the rest of the module after it. Loading a lot of modules can bring memory problems (even if I don't think loading modules can oversize memory, in theory it can).</span>
<span class="comment-copy">@Alakazam I'm not "deleting the rest of the module" - the <code>del</code> statement only removes the binding between the name (variable) and the object, it doesn't by itself "delete" the (previously) bound object. An object will only be collected once it's refcount is null, and since imported modules are cached in <code>sys.modules</code>, the refcount will remain positive after this statement.  You may want to read this about names and bindings in python: <a href="https://nedbatchelder.com/text/names.html" rel="nofollow noreferrer">nedbatchelder.com/text/names.html</a></span>
<span class="comment-copy">Thanks for those explanation, if <code>del</code> only removes the binding then for sure there is no reason to import only one class.</span>
<span class="comment-copy">I see this on a lot of django and flask projects, I just find that unreadable, so I wanted to make sure.</span>
<span class="comment-copy">Usually you want to import only what you need to avoid problems. But then, if you're importing 9 out of 10 classes from a module it gets kinda ugly and unreadable:</span>
<span class="comment-copy">My question is: What problem can happen ?</span>
<span class="comment-copy">That you override classes namespaces. Imagine you're importing a lot of Views from two different views.py files: you want to use "ExampleView" from the 1st import, but in the 2nd import you also have an "ExampleView" that works in a different way (but you don't know that, because you're importing everything blindly). What would happen is that the 2nd import "ExampleView" overrides the first one and you could lose a lot of time before you figure out why it's not working as you'd expect. This is especially true when you work in a team on the same files.</span>
<span class="comment-copy">What you're basically saying is the opposite.. Those problems can occur when you import a specific class from a module, I think that this is useless, and that we should import the whole module and then access it with <code>module.class</code>.</span>
<div class="post-text" itemprop="text">
<p>I need to check if all the keys declared in a schema file are present in a dictionary and if they are not, I need to fill them with a default value, of a given type. I need to do this dynamically because the structure can be even more complicated than the one below.</p>
<pre><code> {
  "type": "object",
  "properties": {
    "vid": {
      "type": ["null", "integer"]
    },
    "merged-vids": {
      "type": ["null", "array"],
      "items": {
        "type": ["null", "integer"]
      }
    },
    "portal-id": {
      "type": ["null", "integer"]
    },
    "is-contact": {
      "type": ["null", "boolean"]
    }
    "form-submissions": {
      "type": ["null", "array"],
      "items": {
        "type": ["null", "object"],
        "properties": {
          "conversion-id": {
            "type": ["null", "string"]
          },
          "timestamp": {
            "type": ["null", "string"],
            "format": "date-time"
          },
          "form-id": {
            "type": ["null", "string"]
          },
          "portal-id": {
            "type": ["null", "integer"]
          },
          "page-url": {
            "type": ["null", "string"]
          },
          "title": {
            "type": ["null", "string"]
          }
        }
      }
    }
  }
}
</code></pre>
<p>This is an example of dictionary:</p>
<pre><code>{
  "vid": 1000, 
  "portal-id": 2512,
  "is-contact": true,
  "profile-token": "dummy_profile_token",
  "profile-url": "dummy_profile_url",
  "form-submissions": [
    {
      "conversion-id": "127-798",
      "timestamp": 1484080167266,
      "form-id": "70fd-4b98-14796-777",
      "page-url": "https://example.com/landing-page-url",
      "title": "A new test form",
      "meta-data": []
    }
  ]
}
</code></pre>
<p>I am also new to python and this is a bit too much.
This is what I tried, but I cannot figure out what to do.</p>
<pre><code>def get_default(type_object):
    if type_object == 'object':
        new_dict = {}
    elif type_object == 'array':
        return []
    else:
        return ''    
def fill_fields_with_empty_str(record, schema):
if isinstance(schema['type'], list):
    type_obj = schema['type'][len(schema['type'])-1]
elif isinstance(schema['type'], str):
    type_obj = schema['type']

if type_obj == 'object':
    new_dict = {}
    for key in schema['properties'].keys():
        if not record.get(key):    
            record[key] = get_default(schema['properties'][key]['type'])
        new_dict[key] = fill_fields_with_empty_str(record[key], schema['properties'][key])
    return new_dict

elif type_obj == 'array':
    new_list = []
    type_obj = schema["items"]['type']
    if len(record) == 0:
        record = get_default(type_obj)
    for element in schema["items"]:
        new_list.append(fill_fields_with_empty_str(record, schema['items']))
    return new_list
else:
    return ''
</code></pre>
</div>
<span class="comment-copy">You might want to try <a href="https://stackoverflow.com/questions/54491156/validate-json-data-using-python"><code>json_schema</code></a>.</span>
<span class="comment-copy">@meowgoesthedog The schema for the dictionary is actually a json file, I only posted a part of it, but I need to add the missing keys, not to say if the dictonary is valid or not.</span>
<div class="post-text" itemprop="text">
<p>I need to find if a message has a word from my dictionary, and if so, I need to know which word it is, so I can print the value, I have:</p>
<pre><code>if any(word in message for word in diccionary):
</code></pre>
<p>So I want to do <code>print(diccionary[thatword])</code>.</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>for word, value in dictionary.items():
    if word in message:
        print(value)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Is this what you're looking for?</p>
<pre><code>for key, value in dictionary.items():
    if key in message:
        print(value)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>A quick alternative:</p>
<pre><code>next(word for word in dictionary if word in message)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could iterate over the <code>dict</code> in order to check if any of its <code>value</code> is in the <code>message list</code>:</p>
<pre><code>message = ['Hey There', 'Just a List', 'Passing by', 'Randomly']    
dict_ = {1: 'Randomly', 2: 'Hello', 3: 'World'}

for key, value in dict_.items():
    if value in message:
        print(dict_[key])
</code></pre>
<p><strong>OUTPUT</strong>:</p>
<pre><code>Randomly
</code></pre>
<p>Using <code>list-comprehension</code>:</p>
<pre><code>print([v for k,v in dict_.items() if v in message])   # ['Randomly']
</code></pre>
<p><strong>EDIT</strong>:</p>
<p>Considering a situation where an element from the list could be a <code>key</code> in the dict, using <code>dict-comprehension</code>:</p>
<pre><code>message = ['Hey There', 'Just a List', 'Passing by', 'random', 2]
print({elem : dict_[elem] for elem in message if elem in dict_})
</code></pre>
<p><strong>OUTPUT</strong>:</p>
<pre><code>{2: 'Hello'}
</code></pre>
</div>
<span class="comment-copy">Have you tried a for-loop? What are you stuck on?</span>
<span class="comment-copy">Is word in your dictionary a value?</span>
<div class="post-text" itemprop="text">
<p>Consider this script in Python :</p>
<pre><code>&gt;&gt;&gt; import math
&gt;&gt;&gt; raw_data = [56.2, float('NaN'), 51.7, 55.3, 52.5, float('NaN'), 47.8]
&gt;&gt;&gt; for i in range(len(raw_data)):
...     print(i, raw_data[i])
...     if math.isnan(raw_data[i]):
...         del raw_data[i]
</code></pre>
<p>As you can see we will get index out of range error, so I conclude that Python does not check the condition after each iteration because otherwise if it does, when <code>i</code> becomes <code>5</code> the length of list is <code>5</code> too so it should not enter the loop body at the first place since <code>5</code> is not lesser than <code>5</code>. </p>
<p>So I conclude that Python saves <code>len(raw_data) = 7</code> at first iteration and it checks whether <code>i &lt; 7</code> after each iteration and does not call the <code>len()</code> function each time. Am I right ?</p>
</div>
<div class="post-text" itemprop="text">
<p>range() is a generator function that is evaluated once at the beginning of the for loop giving an iterable: <code>[0, 1, 2, 3, 4, 5, 6]</code> The for loop then runs once for each item in the iterable. To achieve what you are trying to do it would be better to use <code>enumerate()</code> ie.</p>
<pre><code>for index, datum in enumerate(raw_data):
    if math.isnan(datum):
        del raw_data[index]
</code></pre>
<p>This will work (in python 2 and 3), however, it is generally considered to be bad practice to edit a list that you are iterating over - you might get some strange behaviour if you try to do other operations by index in the same loop so you might also consider storing the indexes of items you wish to delete and then doing the deletions all at once afterwards to make your code more robust. ie.</p>
<pre><code>indexes_to_delete = []
for index, datum in enumerate(raw_data):
    if math.isnan(datum):
        indexes_to_delete.append(index)
# go through the indexes in reverse, to make sure the deletions don't affect earlier indices
for index in sorted(indexes_to_delete, reverse=True):
    del raw_data[index]
</code></pre>
</div>
<span class="comment-copy"><a href="https://docs.python.org/3/reference/compound_stmts.html#the-for-statement" rel="nofollow noreferrer">"The expression list is evaluated once"</a></span>
<span class="comment-copy">But you would never write code like this in Python anyway. Always iterate over the thing itself, not a range of the len of the thing. Not to mention, don't modify a list you're iterating over.</span>
<span class="comment-copy">@JETM thanks a lot .</span>
<span class="comment-copy">@DanielRoseman yeah I know that , I was just trying to understand what is happening behind the scenes .</span>
<div class="post-text" itemprop="text">
<p>I want to train a convolutional neural network to recognise between two types of classes.<br/>
I also want to use the first, convolutional, layers of an already trained model like InceptionV3.<br/>
However the training processes goes really slow. Do you have any suggestions what can I improve? I will not mention my CPU, RAM, all I care here is where are the bottlenecks and what can I improve to faster it (my images are already 229x299x3). </p>
<pre><code>from keras.applications import InceptionV3
from keras import layers
from keras.models import Model
from keras import optimizers
from keras.preprocessing.image import ImageDataGenerator
import numpy as np
import os


def generator(images_dir):
    datagen = ImageDataGenerator(rescale=1. / 255)
    gen = datagen.flow_from_directory(
        images_dir,
        target_size=(segment_size, segment_size),
        batch_size=batch_size,
        class_mode='categorical',
        shuffle=True)
    return gen


def num_files_in_folder(folder):
    count = 0
    for subdir, dirs, files in os.walk(folder):
        for file in files:
            if not file.startswith("."):
                count += 1
    return count


segment_size = 229
batch_size = 32
base_model = InceptionV3(weights='imagenet',
                         include_top=False,
                         input_shape=(segment_size, segment_size, 3))
x = base_model.output
x = layers.GlobalAveragePooling2D()(x)
x = layers.Dense(1024, activation='relu')(x)
predictions = layers.Dense(2, activation='softmax')(x)

model = Model(inputs=base_model.input, outputs=predictions)

for layer in base_model.layers:
    layer.trainable = False

model.compile(optimizer=optimizers.SGD(lr=0.01, nesterov=True),
              loss='categorical_crossentropy',
              metrics=['acc'])

train_dir = "/home/user/train"
validation_dir = "/home/user/val"
train_gen = generator(train_dir)
val_gen = generator(validation_dir)
steps_per_epoch = int(np.ceil(num_files_in_folder(train_dir) / batch_size))
validation_steps = int(np.ceil(num_files_in_folder(validation_dir) / batch_size))

history = model.fit_generator(
    generator=train_gen,
    steps_per_epoch=steps_per_epoch,
    epochs=10,
    validation_data=val_gen,
    validation_steps=validation_steps,
    use_multiprocessing=False,
    verbose=1)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>First of all, I offer you to convert your data into TFRecords and avoid using <code>flow_from_directory</code>. <code>ImageDataGenerator</code> can be a good option for a quick prototyping, but TFRecords and corresponding TF infrastructure for them (queues/runners/readers) are really optimized for fast reading. By using <code>tf.data</code> API and especially <code>Dataset.prefetch()</code>, you can gain a substantial speedup. </p>
<p>As in most cases the data read is the bottleneck, I could stop right here. But after that I would also try:</p>
<ul>
<li><a href="https://keras.io/utils/#multi_gpu_model" rel="nofollow noreferrer">multi_gpu</a> training</li>
<li>using <a href="https://www.kaggle.com/danmoller/keras-training-with-float16-test-kernel-2" rel="nofollow noreferrer">float16</a> can be helpful, but <a href="https://stackoverflow.com/questions/49782579/float16-slower-than-float32-in-keras">tricky</a>.</li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>I would try this with <code>tf.data.Dataset.from_tensor_slices</code>
Suppose you have path to train set <code>train_path</code>. First you create dataset object from it. Also you can pass not path but paths <code>from_tensor_slices((image_path, labels_path))</code> or lists of filenames/labels. It can be handled with parse function later.</p>
<pre><code>dataset = tf.data.Dataset.from_tensor_slices(image_path)
</code></pre>
<p>Then you can shuffle, batch, and map any parse function to this dataset. You can control how many examples will be preloaded with shuffle buffer. Repeat controls epoch count and better be left None, so it will repeat indefinitely. You can use either plain batch function or combine with </p>
<pre><code>dataset = dataset.shuffle().repeat()
dataset.apply(tf.data.experimental.map_and_batch(map_func=parse_func, batch_size,num_parallel_batches))
</code></pre>
<p>You need to define parse function to load actual data from filename</p>
<pre><code>def parse_func(filename):
    f = tf.read_file(filename)
    img = tf.image.decode_image(f)
    label = #get label from filename
    return img, l
</code></pre>
<p>After applying this to dataset object it will contain batches of pairs image/label.</p>
<p>Remember that batching goes on inside this pipeline, so you don't need to use batch in model.fit, but you need to pass number of epochs and steps per epoch. The latter can be a little tricky cause you can't do smth like len(dataset) so it should be calculated in advance.</p>
<pre><code>model.fit(dataset, epochs, steps_per_epoch)
</code></pre>
<p>You can do the same for test dataset. You can also check it's contents with </p>
<pre><code>iterator = dataset.make_one_shot_iterator()
with tf.Session() as sess:
    print(sess.run(iterator.get_next()))
</code></pre>
<p>This will output num_batches. </p>
</div>
<span class="comment-copy">Define 'goes really slow'.  Are you using CPU or GPU? If latter, what is the utilization rate?</span>
<span class="comment-copy">Hi Sharky. I compare it with another implementation I have. There I extract features from the pre-trained model via <code>incepv3.predict(generator)</code> and then save them to a pickle file. After all this finishes, I run another Python script that via another generator reads the pickle files and passes the content to fitting my final model. This impl takes about 25 mins for the feature extraction and 2 mins for training. The code I pasted here works for more than 2 hour with same CPU for the same images, same num of epochs, etc.</span>
<span class="comment-copy">As the answer suggests, you should use dataset api. I wouldn't start directly with tfrecords format, as it not always give an advantage and itself takes time to convert to. Do you have an option to use plain numpy arrays without pickle? why do  use it?</span>
<span class="comment-copy">My data does not fit in memory. I could not find a way to read all SxSx3 images from the file system, provide them to <code>inceptV3.predict</code> and pass the result to my <code>model.fit_generator</code> with the need to load everything in memory.</span>
<span class="comment-copy">How your initial data looks like? Is it one big numpy array? Or a directory of images?</span>
<span class="comment-copy">Thanks for the answer Sharky. I implemented my algorithm using the TF data API but its extremely slow (5+ hours). I compare it to another of my implementations: instead of adding the pre-trained inceptionv3 model to my model I first call inceptionv3.predict() with all the my images (takes about 26 minutes). Then the feature vectors from the prediction I pass to my new model.fit (this model has only 3 layers), this takes about a minute). Total 27 minutes &lt; 5 hours.</span>
<div class="post-text" itemprop="text">
<p>Is there a way to change the <code>tmux</code> window title from python. I am using <code>fabric</code> to automate the deployment of long-running jobs, so I can run the jobs in the detached mode in <code>tmux</code>. (it may not be <code>fabric</code> related question, but I think people who have used fabric might have come across this problem) I understand that something like below can be used to create a new session and run commands in those sessions. </p>
<pre><code>with Connection("ip") as cxn:
    cxn.run("tmux new -d -s session_name")
    cxn.run("tmux send -t session_name.0 ls ENTER")
</code></pre>
<p>Is there a way to create a new window with a specific title and call it like this:</p>
<pre><code>with Connection("ip") as cxn:
  if cxn.run("tmux has -t session_name", warn=True, hide="err").exited != 0:
     cxn.run("tmux new -d -s session_name")
  cxn.run("tmux new -d -s session_name -n windown_name")
  cxn.run("tmux send -t session_name.window_name ls ENTER")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I am not sure if this is what you want but this will create a new session named "dev" and inside that session it will create a window title "win1" and launch <code>python</code> repl in that window.</p>
<pre><code>with Connection("ip") as cxn:
    cxn.run('''tmux new-session  -s "dev" -n "win1" \; send-keys 'python'  C-m  \;''')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The way that tmux references the window names is by colon-<code>:</code> so this works now -</p>
<pre><code>with Connection("ip") as cxn:
  if cxn.run("tmux has -t session_name", warn=True, hide="err").exited != 0:
     cxn.run("tmux new -d -s session_name")
  cxn.run("tmux new-window -t session_name -n windown_name")
  cxn.run("tmux send -t session_name:window_name ls ENTER")
</code></pre>
<p>Without the complete knowledge of how <code>tmux</code> works, it is hard to workout such details. After reading the tutorial on <a href="https://leanpub.com/the-tao-of-tmux/read#scripting-tmux" rel="nofollow noreferrer">scripting tmux here</a> and digging into the code of <code>libtmux</code> <a href="https://github.com/tmux-python/libtmux/blob/master/libtmux/session.py#L230" rel="nofollow noreferrer">here</a> (python library to control <code>tmux</code>) I figured that <code>:</code> should be the thing to use and its working for me. </p>
</div>
<span class="comment-copy">It seems like tmux doesn't identify any window with the name - <code>session_name.window_name</code>. It only has the concept of window numbers. Window titles are not used for reference but for users to be able to identify windows.</span>
<div class="post-text" itemprop="text">
<p>I use <code>Tensorflow</code> to build my model, and I want to judge the training step and if the step is larger than <code>10000</code>, my loss will change. The follows is part of my code.</p>
<pre><code>self.global_step = tf.Variable(0, name="global_step", trainable=False)
change = tf.cond(tf.greater(self.step,10000), lambda: True, lambda: False)

if change:
   self.loss = 
</code></pre>
<p>But it meets error as follows:</p>
<pre><code>TypeError: Using a `tf.Tensor` as a Python `bool` is not allowed. 
Use `if t is not None:` instead of `if t:` to test if a tensor is defined, 
and use TensorFlow ops such as tf.cond to execute subgraphs conditioned 
on the value of a tensor.
</code></pre>
<p>Hopefully for help.</p>
</div>
<div class="post-text" itemprop="text">
<p>You just need to evaluate this tensor first</p>
<pre><code>step = tf.Variable(0, name="global_step", trainable=False)
change = tf.cond(tf.greater(step,10000), lambda: True, lambda: False)

with tf.Session() as sess:
    sess.run(tf.global_variables_initializer())
    if sess.run(change):   
        print('Ok')
</code></pre>
<p>If you substitute <code>if sess.run(change)</code> with <code>if change</code> you will get the error you mentioned</p>
</div>
<div class="post-text" itemprop="text">
<p>If it is tensorflow 2.0 then according to the <a href="https://www.tensorflow.org/alpha/guide/autograph" rel="nofollow noreferrer">doc.</a> the distinction is handled for us. </p>
<p>That is what it seems to do.</p>
<pre><code>@tf.function
def check(x,y):
  return tf.cond(tf.greater(x,y), lambda: True, lambda: False)


print(check(tf.constant(2),2))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I wrote a simple GUI with a button to start a batch script as following:</p>
<pre><code>from tkinter import *
import subprocess


class Application(Frame):
    def __init__(self, master):
        super().__init__(master)
        self.master = master

        self.btn = Button(self.master, text='Start program', command=self.btn_callback)
        self.btn.pack()

    @staticmethod
    def btn_callback():
        subprocess.run(r'start C:\temp\prog.bat', stdout=subprocess.PIPE, stderr=subprocess.PIPE)


root = Tk()
root.title('my app')
root.geometry("500x500")
app = Application(root)
root.mainloop()
</code></pre>
<p>The batch script again starts other processes like that:</p>
<pre><code>@echo off
start "process1"
timeout /T 5
start "process2"
timeout /T 5
start "process3"
...
</code></pre>
<p>What i want is to disable the button in GUI until the user closes all processes which were started from the batch. Is it possible?</p>
<p>I have thought of starting all processes directly in the python script, and tracing the PID of these processes, but i'm not sure how could it be done getting the PID (considering the processes as variables, not as fixed names to search in <code>tasklist</code>) as well as how should they be traced in my GUI application? Thanks!</p>
</div>
<span class="comment-copy">Read about <a href="https://stackoverflow.com/a/43276598/7414759">Is there a way to check if a subprocess is still running?</a></span>
<span class="comment-copy">this way i have to start all the processes directly in the python script. Is there any way to catch / poll them when i just start the batch in python script? Thanks anyway :-)</span>
<span class="comment-copy"><i>"any way to catch / poll ... start the batch?"</i>: Not <i>catch/poll</i> but using <a href="https://psutil.readthedocs.io/en/latest/" rel="nofollow noreferrer">psutil</a> you should be able to <b>"see"</b> the processes running.</span>
<div class="post-text" itemprop="text">
<p>here is some part of the data table </p>
<p>Df2</p>
<pre><code>   id   title   parent_id
0   11  p1          11
1   12  p1          11
2   13  p2          12
3   14  p2          12
4   15  p2          13
5   16  p2          13
6   17  p3          13
</code></pre>
<p>This df2 problem should give output like</p>
<pre><code>p1_id | no. of p1|no. of p2| no. of p3 |
11    | 1        |4        | 1         |
12    | 0        |2        | 0         |
</code></pre>
<p>given that:
1--There is no certain hierarchy. like, may be possible that p1 have another p1 under him or p3 under him. And there may be n number of branches and node possible.
2--The p1 may have child at n number of level. how to approach to this problem.</p>
<p>Edit -<a href="https://i.stack.imgur.com/wzKRZ.png" rel="nofollow noreferrer"><img alt="see this picture" src="https://i.stack.imgur.com/wzKRZ.png"/></a> to visualize the problem</p>
</div>
<div class="post-text" itemprop="text">
<p><strong>Code</strong></p>
<pre><code>import pandas as pd
import numpy as np

data=np.array([['','id','title','parent_id'],
                [0,11,'p1',11],
                [1,12,'p1',11],
                [2,13,'p2',12],
                [3,14,'p2',12],
                [4,15,'p2',13],
                [5,16,'p3',13],
                [6,17,'p3',13]])


df=pd.DataFrame(data=data[1:,1:],
                  index=data[1:,0],
                  columns=data[0,1:])

df2=df.pivot(index='id',columns='title',values='parent_id')

df2=df.groupby(['title', 'parent_id']).count()
df2=df2.reset_index(drop=False)
df3=df2.pivot(index='parent_id',columns='title',values='id')
df3=df3.fillna(0)
print(df3)
</code></pre>
<p><strong>Input</strong></p>
<pre><code>   id title parent_id
0  11    p1        11
1  12    p1        11
2  13    p2        12
3  14    p2        12
4  15    p2        13
5  16    p3        13
6  17    p3        13
</code></pre>
<p><strong>Output</strong></p>
<pre><code>title       p1   p2   p3
parent_id               
11         2.0  0.0  0.0
12         0.0  2.0  0.0
13         0.0  1.0  2.0
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use the crosstab function:</p>
<p><strong>Step 1: Create DataFrame</strong></p>
<pre><code>import pandas as pd
import numpy as np
d = {'id': [11, 12, 13, 14, 15, 16, 17], 'title': ['p1','p1','p2', 'p2', 'p2', 'p2', 'p3'],'parentid':['11','11','12', '12', '13', '13', '13']}
df = pd.DataFrame(data=d)
</code></pre>
<p><strong>Step 2: Crosstab</strong></p>
<pre><code>pd.crosstab(df['parentid'], df['title'])
</code></pre>
</div>
<span class="comment-copy">You can use pandas data frame grouping function.</span>
<span class="comment-copy">Can you explain why in the desired output p1_id: l1, no. of p1 is 1? I thought it should be 2?</span>
<span class="comment-copy">Did you check your output? Its not what OP wants..</span>
<span class="comment-copy">not getting the desire output.</span>
<span class="comment-copy">@Aamir, I changed the groupby to crosstab, is this what you were looking for?</span>
<div class="post-text" itemprop="text">
<p>I wrote a python code where it will take user input and convert it into uppercase to match my positive list and negative list. but it is not considering the negative list properly. I must be wrong on giving a conditional statement it seems. I tried two codes but not working. also, I tried to sum up how many positive feedbacks and negative feedbacks using <code>len(words)</code> but no working at all.</p>
<pre><code> - **code1:**

keyword_list = ['GOOD', 'ADMIRE', 'SUPER', 'BEST', "INCREDIBLE", 'NOT BAD', 'NOT SO BAD', 'KEEP IT UP']
print("Enter your feedback")
user_review = input().upper()
if set(keyword_list).intersection(user_review.split()):
  print ("POSTIVE FEEDBACK")
else:
  print("NEGATIVE FEEDBACK")


- **code2:**

negative_words = ['BAD', 'TERRIBLE','NOT GOOD']
positive_words = ['GOOD', 'ADMIRE', 'SUPER', 'BEST', "INCREDIBLE"]
print("Enter your honest review")
user_review = input().upper()
for review in user_review:
    # split the tweet into words:
    words = review.split()

if set(positive_words).intersection(user_review.split()):
  print ("POSTIVE REVIEW")
elif set(negative_words).intersection(user_review.split()):
  print ("NEGATIVE REVIEW")
else:
  print("MODERATE REVIEW")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Have you tried to debug this?</p>
<pre><code>set(keyword_list).intersection(['NOT', 'BAD'])
</code></pre>
<p>This is the results of your</p>
<pre><code>set(keyword_list).intersection(user_review.split())
</code></pre>
<p>with <code>NOT BAD</code> as input.</p>
<p>This returns a set with an empty list inside: <code>set([])</code></p>
<p>That's because 'NOT' and 'BAD' are not elements of the set. <code>NOT BAD</code> is. If you split the two word elements it won't work.</p>
<p>Anyway, you can achieve your objective in this way</p>
<pre><code>negative_words = ['BAD', 'TERRIBLE','NOT GOOD']
positive_words = ['GOOD', 'ADMIRE', 'SUPER', 'BEST', "INCREDIBLE"]
user_review = input("Enter your honest review").upper()
if user_review in positive_words:
    print("POSITIVE REVIEW")
elif user_review in negative_words:
    print("NEGATIVE REVIEW")
</code></pre>
</div>
<span class="comment-copy">You have complicated what could have been a very simple thing.</span>
<span class="comment-copy">What do you mean when you say that  it isn't considering negative reviews properly? What are you expecting?</span>
<span class="comment-copy">@davidlowryduda I mean when I'm trying to give user input as a negative word which is in the list, still it is giving as positive feedback</span>
<div class="post-text" itemprop="text">
<p>E.g., given a list <code>nums = [1, 2, 3, 4, 5, 6, 7, 8]</code> I want to join each pair by a semicolon and each number within that pair by a comma to receive the following string: <code>result = 1,2;3,4;5,6;7,8</code>.</p>
<p>How can I do it without <code>for</code> loop (e.g., using a <code>join</code>)?</p>
</div>
<div class="post-text" itemprop="text">
<p>Using <code>slicing</code></p>
<p><strong>Ex:</strong></p>
<pre><code>nums = [1, 2, 3, 4, 5, 6, 7, 8]
nums = [str(i) for i in nums]
print( ";".join(",".join(nums[i:i+2]) for i in range(0, len(nums), 2)) )
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>1,2;3,4;5,6;7,8
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could also <a href="https://docs.python.org/2/library/itertools.html#itertools.cycle" rel="nofollow noreferrer">cycle</a> through the separators:</p>
<pre><code>from itertools import cycle, chain

nums = [1, 2, 3, 4, 5, 6, 7, 8]
nums = [str(n) for n in nums]

''.join(chain.from_iterable(zip(nums, cycle(',;'))))[:-1]
# '1,2;3,4;5,6;7,8'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Try this :</p>
<pre><code>result = ";".join([",".join([str(i) for i in nums[k:k+2] ]) for k in range(len(nums)-2)])
</code></pre>
<p><strong>OUTPUT</strong> :</p>
<pre><code>'1,2;2,3;3,4;4,5;5,6;6,7'
</code></pre>
</div>
<span class="comment-copy">What have you tried so far?</span>
<div class="post-text" itemprop="text">
<p>This is my first time to use Ubuntu </p>
<p>I am using Spyder</p>
<p>I am following instructions I find on the ineternet</p>
<p>Now I am stuck</p>
<p>I am trying to get Python Anaconda working on Ubuntu</p>
<p>I installed it</p>
<p>trying now to test my first code</p>
<p>simple code </p>
<pre><code>import pandas as pd
import quandl

df = quandl.get("WIKI/GOOGL")

print(df.head())
</code></pre>
<p>but I get <code>ModuleNotFoundError : No Module named pandas</code></p>
<p>I have installed panadas in both ways</p>
<pre><code>conda install -c anaconda pandas
</code></pre>
<p>and </p>
<pre><code>pip3 install pandas
</code></pre>
<p>both ways installed</p>
<p>yet I am still getting same error</p>
<pre><code>ModuleNotFoundError : No Module named pandas
</code></pre>
<p><a href="https://i.stack.imgur.com/Bvddh.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/Bvddh.png"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>In this instance, it appears that all you needed to was restart the kernel. When you install a new package, if you are using ipython, jupyternotebook, or spyder you should restart the kernel. This is why <code>python -c "import pandas"</code> worked, whereas in your python session, it wasn't working.</p>
<p>A running python kernel does not search for new packages since it started running. Starting and stopping will make sure it will find the new packages. There are probably ways to find new packages without restarting the kernel, probably by using some of <code>importlab</code> functions, but not sure if this would be necessary.</p>
</div>
<span class="comment-copy">What is the outcome when you run <code>pip3 install pandas</code> ?</span>
<span class="comment-copy">Similarly, what is the outcome if you run <code>python -c "import pandas"</code></span>
<span class="comment-copy">@erncyp many thanks it works using python -c "import pandas"</span>
<span class="comment-copy">@erncyp I am having the same problem with autosklearn but does not work I am getting "no module names autosklearn" although I installed as its website mentioned</span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/50914761/jupyter-notebook-cant-find-modules-for-python-3-6">Jupyter Notebook can't find modules for python 3.6</a></span>
<span class="comment-copy">There is nothing in the question to suggest that the OP is using Jupyter. Do you have information we don't have?</span>
<span class="comment-copy">True, it might not be jupyter. perhaps @asmgx can clarify. Will delete/edit answer if updated</span>
<span class="comment-copy">@erncyp I am using Spyder</span>
<div class="post-text" itemprop="text">
<p>so I'm trying to learn python by using it, and I started to code the famous DVD_logo animation, with a background constantly changing color.
The first time I did it I used the "Pygame" library, but it works a little bit slower.
I don't know how to search for a better library for my purpose of maybe how to improve my program.
I actually modified it, handling the refreshing background with a limited surface, but it seems not to work. There's the code, just keep in mind is my first attempt, so maybe there's something strange or some commented statement (I was just trying)</p>
<pre><code>import random
import sys
import os
import pygame
import random
from PIL import Image


time_exit = 3000

pygame.init()
pygame.display.init()

win_width = 800#1440#817#980
win_height = 420#855#417#500#
logo_s_w = 134
logo_s_h = 67
logo_w = random.Random()
logo_h = random.Random()
logo_w = logo_w.uniform(0 + logo_s_w, win_width - logo_s_w)
logo_h = logo_h.uniform(0 + logo_s_h, win_height - logo_s_h)
logo_w = int(logo_w)
logo_h = int(logo_h)
back_w = logo_w
back_h = logo_h
past_h = 0
past_w = 0

moving_pixel = 3
coverage_pixel_w = logo_s_w + moving_pixel * 10
coverage_pixel_h = logo_s_h + moving_pixel * 10
mov_cov = moving_pixel * 2

red = (
    255, 0, 0)

rgb = random.Random()

rgb = [
    0, 100, 0
    ]
r = random.Random()
b = random.Random()
g = random.Random()

x_flag = bool(random.getrandbits(1))
y_flag = bool(random.getrandbits(1))

hit = False

def logo(x,y):
   win.blit(dvdImg, (x,y))

def back(x,y):
   win.blit(back_rec, (x,y))

black = (
    0, 0, 0)

#clock = pygame.time.Clock()
win = pygame.display.set_mode((win_width, win_height))
#win = pygame.Surface((win_width, win_height)).convert_alpha()

dvdImg = pygame.transform.scale(pygame.image.load('DVD_logo.gif'),[logo_s_w, logo_s_h])


pygame.display.set_caption('DVD')

background_colour = (rgb)
win.fill(background_colour)
#bg_image = pygame.Surface((logo_s_w, logo_s_h))
#win.fill(black)
bg_image = pygame.Surface((logo_s_w, logo_s_h))
logo(logo_w, logo_h)
back_rec = pygame.Surface((coverage_pixel_w, coverage_pixel_h))
pygame.display.flip()


time = 0

running = True

while True:
    for event in pygame.event.get():
        if event.type == pygame.QUIT:
            running = False

    hit = False
    #bg_image = pygame.Surface((logo_s_w, logo_s_h))
    #pygame.draw.rect(bg_image, background_colour, [logo_w, logo_h, logo_s_w, logo_s_h])
    #pygame.draw.rect(bg_image, (255,192,0), [200, 0, 200, 200])
    #win.fill(background_colour)


    back_rec.fill(rgb)
    back(back_w, back_h)
    logo(logo_w, logo_h)
    pygame.display.update()
    #clock.tick(60)
    back_w = logo_w - past_w
    back_h = logo_h + past_h

    if logo_w &lt; win_width and not x_flag:
        logo_w = logo_w + moving_pixel
        past_w = + moving_pixel + mov_cov

    if logo_w &gt; 0 and x_flag:
        logo_w = logo_w - moving_pixel
        past_w = - moving_pixel + mov_cov

    if logo_w &lt;= 0:
        x_flag = False
        hit = True

    if logo_w &gt;= (win_width - (logo_s_w)):
        x_flag = True
        hit = True

    if logo_h &lt; win_height and not y_flag:
        logo_h = logo_h + moving_pixel
        past_h = + moving_pixel - mov_cov

    if logo_h &gt; 0 and y_flag:
        logo_h = logo_h - moving_pixel
        past_h = 0 - moving_pixel - mov_cov

    if logo_h &lt;= 0:
        y_flag = False
        hit = True

    if logo_h &gt;= (win_height - (logo_s_h)):
        y_flag = True
        hit = True

    #change color
    if hit:
        rgb[0] = r.uniform(0, 255) 
        rgb[1] = g.uniform(0, 255) 
        rgb[2] = b.uniform(0, 255) 
        background_colour = tuple(rgb)
        win.fill(background_colour)
        #background_colour = background_colour(rgb)
        #rgb = list(rgb)
        hit = False

    #pygame.time.delay()
#    time = time + 1
    if time &gt; time_exit:
        sys.exit()

#running = True
#while running:
#  for event in pygame.event.get():
#    if event.type == pygame.QUIT:
#      running = False

pygame.quit()
quit()
</code></pre>
</div>
<span class="comment-copy">I guess your mainloop should be <code>while running</code>?</span>
<span class="comment-copy">yes, I didn't used a main loop, is this a problem?</span>
<span class="comment-copy">you didn't use <code>running</code> at all so I was a bit confused ... how do you exit the program? It looks like the purpose of <code>running</code> is to control the gameloop but I can't see any usage of it.</span>
<span class="comment-copy">I end it with a time control, but it's "manual", I used it only to make some try. But the main problem is the slow execution, I don't know how to solve it</span>
<div class="post-text" itemprop="text">
<p><a href="https://www.python.org/dev/peps/pep-0008/" rel="nofollow noreferrer">PEP 08</a> states:</p>
<blockquote>
<p>Imports are always put at the top of the file, just after any module
  comments and docstrings, and before module globals and constants.</p>
</blockquote>
<p>However it is a known best practice to minimize the span of variables (lines between declaration and the use), as well as to minimize their visibility. This is explained in <a href="http://aroma.vn/web/wp-content/uploads/2016/11/code-complete-2nd-edition-v413hav.pdf" rel="nofollow noreferrer">Code Complete 2. ed. by Steve McConnell</a>, p.246 for example.</p>
<p>I recognize two types of imports in much of my code. First there are imports of key libraries (e.g. <code>import numpy as np</code>) which I will be using throughout the whole file. Those indeed belong on top!
But there also are imports of specific objects, frequently from my own code, that is often only used at one place.</p>
<p>For the second type I see drawbacks to importing it at the top of the module - firstly, at the place I am using this, I don't see where the object is coming from and must look it up. Also IDE will prompt me to use it at all other locations, which I might prefer not to happen by importing it only inside the routine where I use it (clearly if I will want this routine to be performance optimized I will not do it, but in other cases readability is more important).</p>
<p>Is it time to change this convention? or am I missing some good reasons for having also these one-time-needed imports at the top?</p>
</div>
<div class="post-text" itemprop="text">
<p>Having these one-time-needed imports at the top of the file is more pythonic than having them inside functions, classes, etc. Making your code more pythonic is more important than making minimal variable span and visibility.</p>
</div>
<span class="comment-copy">imports go in the beggining not inside routines, anyone reading your first lines of code will have an idea of what you are using. The conventions make it so that numpy == np so anyone can assume you are calling numpy when saying np. whatever. I don't see the point you are trying to make here, if you can not tel, what np is don't give aliases to libraries/modules you are using</span>
<span class="comment-copy">And by the way, one thing is module globals (numpy packages etc) another is constants, and another is variables which you want to declare with the minimum span and scope, the numpy poackage should NEVER  be a variable for you unless you are doing monkey-patching which you should not be doing</span>
<span class="comment-copy">@E.Serra You have missed my point.</span>
<span class="comment-copy">But there also are imports of specific objects, frequently from my own code, that is often only used at one place. &lt;&lt; I assume you mean these ones, if you are not setting your code as packages then do so, and use objects explicitly whenever you need them, e.g. fun1 uses your_package.routine_1 , fun2 uses your_package.routine2 but you import ALL of them as as import your_package</span>
<span class="comment-copy">Right, but 'pythonic' sounds here like a religions thing. It still makes sense to look for the real reasons one option is preferred over the other.</span>
<span class="comment-copy">You can read <a href="https://stackoverflow.com/questions/25011078/what-does-pythonic-mean">here</a> what does <i>pythonic</i> mean.</span>
<span class="comment-copy">In few words, when writing Python code, PEP8 and other conventions related to Python are preferred to be used over general conventions and conventions related to other programming languages. So, PEP8 is the real reason.</span>
<div class="post-text" itemprop="text">
<p>I need to generate some similar tests according with different data. I tried </p>
<pre><code>import pytest


class BaseClass(object):
    data = [1]

    @pytest.mark.parametrize("param1", data)
    def test_something(self, param1):
        assert param1


class Test1(BaseClass):
    data = [2, 3]


class Test2(BaseClass):
    data = [0]
</code></pre>
<p>but result is </p>
<pre><code>collected 2 items

test_of_pytest.py::Test1::test_something[1] PASSED                       [ 50%]
test_of_pytest.py::Test2::test_something[1] PASSED                       [100%]
</code></pre>
<p>instead of expected something like:</p>
<pre><code>collected 3 items

test_of_pytest.py::Test1::test_something[2] PASSED                       [ 33%]
test_of_pytest.py::Test1::test_something[3] PASSED                       [ 66%]
test_of_pytest.py::Test2::test_something[0] FAIL                       [100%]
</code></pre>
<p>So <code>@pytest.mark.parametrize</code> runs only once while reading <code>BaseClass</code>.
How to deal with <code>parametrize</code>(or some other generator) to behave as i expected?</p>
</div>
<span class="comment-copy"><code>pytest</code> does not work like that, what you need is fixtures, but even more so why set <code>data</code> in the <code>BaseClass</code></span>
<span class="comment-copy">The marker is just another decorator; it will be executed once on import with <code>Base.data</code>; the new decorated function is attached to the class and there is nothing left to run in subclasses. This is not specific to <code>pytest.mark.parametrize</code> and can be reproduced with any class and any decorated method.</span>
<div class="post-text" itemprop="text">
<p>I was trying to practice python image pixel color histogram </p>
<pre><code>import cv2
import numpy as np
import matplotlib.pyplot as plt


img = cv2.imread('image.jpg')


gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)


hist = cv2.calcHist([gray], [0], None, [256], [0, 256])


plt.bar(range(1,257), hist)
plt.show()
</code></pre>
<p>and it gives an error</p>
<pre><code>Traceback (most recent call last):
  File "C:/Users/jmu/Desktop/123.py", line 15, in &lt;module&gt;
    plt.bar(range(1,257), hist)
  File "C:\Users\jmu\AppData\Local\Programs\Python\Python37-32\lib\site-packages\matplotlib\pyplot.py", line 2457, in bar
    **({"data": data} if data is not None else {}), **kwargs)
  File "C:\Users\jmu\AppData\Local\Programs\Python\Python37-32\lib\site-packages\matplotlib\__init__.py", line 1810, in inner
    return func(ax, *args, **kwargs)
  File "C:\Users\jmu\AppData\Local\Programs\Python\Python37-32\lib\site-packages\matplotlib\axes\_axes.py", line 2296, in bar
    label='_nolegend_',
  File "C:\Users\jmu\AppData\Local\Programs\Python\Python37-32\lib\site-packages\matplotlib\patches.py", line 658, in __init__
    Patch.__init__(self, **kwargs)
  File "C:\Users\jmu\AppData\Local\Programs\Python\Python37-32\lib\site-packages\matplotlib\patches.py", line 87, in __init__
    self.set_linewidth(linewidth)
  File "C:\Users\jmu\AppData\Local\Programs\Python\Python37-32\lib\site-packages\matplotlib\patches.py", line 348, in set_linewidth
    self._linewidth = float(w)
TypeError: only size-1 arrays can be converted to Python scalars
</code></pre>
<p>HOW can I fix it</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>plt.bar(range(1,257), hist.reshape(256))
</code></pre>
<p>Or if you want to avoid hard coding number</p>
<pre><code>plt.bar(range(len(hist)), hist.reshape(-1))
</code></pre>
<p>Signature of bar is </p>
<p><code>matplotlib.pyplot.bar(x, height, width=0.8, bottom=None, *, align='center', data=None, **kwargs)</code></p>
<p><code>height : scalar or sequence of scalars</code></p>
<p><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.bar.html" rel="nofollow noreferrer">https://matplotlib.org/api/_as_gen/matplotlib.pyplot.bar.html</a></p>
<p>So reshape your height to a sequence.</p>
</div>
<div class="post-text" itemprop="text">
<p>This is my class in models.py in django.</p>
<p>I used of postgresql database.</p>
<pre><code>from django.contrib import admin

class Post:
    post_content = models.TextField("Text", max_length=150)
    fkAdmin = models.ForeignKey(admin, on_delete=models.CASCADE, null=True)
</code></pre>
</div>
<span class="comment-copy">What is exactly your question?</span>
<span class="comment-copy">This code doesn't make any sense at all. The "admin" is a whole app. What would it mean to have a foreign key to it? More to the point, what are you trying to achieve?</span>
<span class="comment-copy">I want to save the name of the admin who adds or modifies the post in the database. @DanielRoseman</span>
<span class="comment-copy">Unless you have a custom user model I believe you are looking for <a href="https://docs.djangoproject.com/en/2.1/ref/contrib/auth/#django.contrib.auth.models.User" rel="nofollow noreferrer"><code>django.contrib.auth.models.User</code></a>. There is no special model for admins, just <code>User</code>s that happen to be admins.</span>
<span class="comment-copy">And if you're using Django's admin interface, you already get the history (kind of an audit log) for free. Just click on an item in the admin view and then on the <code>History</code> button on the top right corner.</span>
<div class="post-text" itemprop="text">
<p>I have two files containing timestamps and parameters. file1 has much more entries than file2. The parameters of file1 were sampled every minute, whereas parameters of file2 were sampled irregularly approx. every 5 minutes. I would like to have for every existing entry in file 2 the equivalent entries of file1. How to do that?</p>
<pre><code>`file1 = pd.read_csv('file1.csv', sep=',', header=1, parse_dates=True, na_values=['NAN'])
</code></pre>
<p><code>file2 = pd.read_csv('file2.csv', sep=',', header=1, parse_dates=True, na_values=['NAN'])</code></p>
<p>file1 looks like this:
<a href="https://i.stack.imgur.com/2nGiJ.png" rel="nofollow noreferrer">enter image description here</a></p>
<p>file2 looks like this:
<a href="https://i.stack.imgur.com/zwWt6.png" rel="nofollow noreferrer">enter image description here</a></p>
<p>To give an example, I want to have a new row which contains for the entry in file2: 2019-02-15 00:01:02 the equivalent value from file1 e.g. from the parameter BV_iDL_BOX that was taken at the same minute and date: 2019-02-15 00:01</p>
</div>
<div class="post-text" itemprop="text">
<p>I am not sure what your data looks like and your expected outome, so hopefully this will help a bit:</p>
<p><strong>Step 1: Create Dataframe</strong></p>
<pre><code>file1 = pd.date_range('2018-01-01', periods=5, freq='s')
file2 = pd.date_range('2018-01-01', periods=5, freq='5s')
file1 = pd.DataFrame(idx)
file1['column2'] = [1,2,3,4,5]
file2 = pd.DataFrame(id3)
file2['column3'] = [1,2,3,4,5]
</code></pre>
<p><strong>Step 2: Join Dataframe</strong></p>
<pre><code>file1.join(file2, how='outer')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I'm assuming you are asking <em>'how can I get the frequency of 1 minute in my file2 when I have a 5 minute frequency'</em>.</p>
<p>Instead what you could do is make a loop that discards rows from file1, so that you essentially have 5 minutes between observations in file1, making the files equal. It would go something like this (code doesn't fully work)</p>
<pre><code>rows = 0
for index, row in df.iterrows():

    if(rows &gt; 0):
        df.drop(df.index[[index])
        if(rows &gt; 4):
            rows = 0
    rows = rows + 1
</code></pre>
<p>Else what you are referring to is actually imputing the values, so that file2 gets the frequency of 1 minute between each observation. I cannot see a solution that wouldn't result in data issues with this one.</p>
<p>A third option is discarding the dataset with 5 minute frequency and slice file1 into two datasets.</p>
</div>
<span class="comment-copy">not super sure what you want, but sounds like a join may cover it, <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.join.html" rel="nofollow noreferrer">pandas.pydata.org/pandas-docs/stable/reference/api/…</a></span>
<span class="comment-copy">join would only work on predefined and regular frequencies, not if you have a sample at 05 then 07 then 12 and so on...</span>
<span class="comment-copy">why not create a column with a rounded timestamp for your join key?</span>
<span class="comment-copy">No sorry thats not what I want. There are other threads that explain how to get 1 minute values out of 5 minute values.</span>
<div class="post-text" itemprop="text">
<p>I have the following list:</p>
<pre><code>[('und', 52),
 ('die', 36),
 ('von', 33),
 ('der', 29),
 ('in', 20),
 ('das', 17),
 ('für', 17),
 ('eine', 15),
 ('des', 14),
 ('Die', 14),
 ('ODP', 14),
 ('wurde', 13),
 ('zu', 13)]
</code></pre>
<p>With the following Code I convert it to a pandas dataframe:</p>
<pre><code>df = pd.DataFrame(sorted_by_value, columns=['Wort', 'Vorkommen'])
</code></pre>
<p>Then I plot it:</p>
<pre><code>fig, ax_lst = plt.subplots(1,1)  # a figure with a 2x2 grid of Axes

df10 = df.copy()

df10 = df[:20]

df10.Vorkommen.plot(kind='barh')
plt.show()
</code></pre>
<p>How can I change the y axis from the index to the words?</p>
<p><a href="https://i.stack.imgur.com/nhteG.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/nhteG.png"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>By default <code>plot.barh</code> uses the index. You can explicitly set the x and y values like so:</p>
<pre><code>df10.plot.barh(x='Wort', y='Vorkommen')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.set_index.html" rel="nofollow noreferrer"><code>DataFrame.set_index</code></a><br/>
<code>Pandas</code> will use the index of your <code>DataFrame</code> as your labels by default.</p>
<pre><code>df10.set_index('Wort').Vorkommen.plot(kind='barh')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I have a string </p>
<pre><code>number234-456-132
abc235-456-456
bhjklsds:456-133-456
</code></pre>
<p>I want split the strings as</p>
<pre><code>number 234-456-132
abc 235-456-456
bhjklsds: 456-133-456
</code></pre>
<p>There is no pattern to the text which is joined with the number.</p>
</div>
<div class="post-text" itemprop="text">
<p>try this regex --&gt; <code>'([^0-9]*)(.*)'</code></p>
<pre><code>&gt;&gt;&gt; import re
&gt;&gt;&gt; def foo(text):
...  result = re.search('([^0-9]*)(.*)', text)
...  return " ".join(result.groups())
... 
&gt;&gt;&gt; foo("number234-456-132")
'number 234-456-132'
&gt;&gt;&gt; foo("abc235-456-456")
'abc 235-456-456'
&gt;&gt;&gt; foo("bhjklsds:456-133-456")
'bhjklsds: 456-133-456'
&gt;&gt;&gt; 
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I would try explicitly to match the three groups of digits at the end, and include anything else in the first string:</p>
<pre><code>for string in strings:
    match = re.match("(.*)(\d{3}-\d{3}-\d{3})$", string)
    print([match[1], match[2]])
</code></pre>
</div>
<span class="comment-copy">split on the occurrence of <code>digit</code> or <code>:</code></span>
<span class="comment-copy">Is this a string? a list of strings? ...</span>
<span class="comment-copy">List of strings</span>
<span class="comment-copy">Split on <code>(?&lt;=[a-z])\W*(?=\d)</code>?</span>
<div class="post-text" itemprop="text">
<p>My objective is to parallelize reading many (500+) csv-files containing measurement data. To do so I pass a list of paths (source_files) to a synchronous client. Additionally I have specified dtypes, and column names (order_list).</p>
<pre><code>df = dd.read_csv(source_files, 
                         names = order_list,
                         include_path_column = True,
                         delimiter = ';',
                         decimal = '.',
                         dtype = dtype,
                         na_values = '.',
                         assume_missing = True,
                         error_bad_lines = False
                         )

df = CLIENT.compute(df).result()
</code></pre>
<p>For a corrupt line I get the following error message:</p>
<pre><code>File "pandas\_libs\parsers.pyx", line 1164, in pandas._libs.parsers.TextReader._convert_tokens

ValueError: cannot safely convert passed user dtype of bool for float64 dtyped data in column 116
</code></pre>
<p>In rare cases the datalogger messes up writing the log files, causing a float to be where I'd expect a boolean. I am sure that the dtypes I'm passing to read_csv are correct and can be satisfied in a vast majority of the csv-files.</p>
<p>Is there a way to identify which csv-file actually caused the error? It would also be nice to know which line of the given csv-file caused the exception. </p>
<p>Thank you in advance!</p>
</div>
<div class="post-text" itemprop="text">
<p>Catch the exception:</p>
<p>Instead of</p>
<pre><code>df = dd.read_csv(source_files, 
                         names = order_list,
                         include_path_column = True,
                         delimiter = ';',
                         decimal = '.',
                         dtype = dtype,
                         na_values = '.',
                         assume_missing = True,
                         error_bad_lines = False
                         )

df = CLIENT.compute(df).result()
</code></pre>
<p>Iterate all of them and capture the exception</p>
<pre><code>for source_file in source_files:
    try:
        df = dd.read_csv(source_file, 
                             names = order_list,
                             include_path_column = True,
                             delimiter = ';',
                             decimal = '.',
                             dtype = dtype,
                             na_values = '.',
                             assume_missing = True,
                             error_bad_lines = False
                             ) df = dd.read_csv(source_files, 
                             names = order_list,
                             include_path_column = True,
                             delimiter = ';',
                             decimal = '.',
                             dtype = dtype,
                             na_values = '.',
                             assume_missing = True,
                             error_bad_lines = False
                             )
    except ValueError:
        raise Exception('Could not read {}'.format(source_file))
</code></pre>
<p>This will tell you what file failed and you can check why.
If they don't fail, then just join the dfs you get onto a big one and you are done.</p>
</div>
<span class="comment-copy">No, I don't - the list of files is submitted at once</span>
<span class="comment-copy">Have a look at <a href="https://github.com/d6t/d6tstack/blob/master/examples-dask.ipynb" rel="nofollow noreferrer">d6tstack</a> there is an open issue on <a href="https://github.com/dask/dask/issues/4105" rel="nofollow noreferrer">github</a> about this problem.</span>
<span class="comment-copy">@user32185 Thank you for the link to github. Seems like I'll have to check on the integrity before importing the files, as Mrocklin wrote:  "If so there are some performance issues. In the general case it can be pretty expensive to read the metadata for every file upfront. Historically we've asked that people handle this ahead of time before using Dask."</span>
<span class="comment-copy">This solution seems rather pragmatic as it reduces the benefits of importing csv files in parallel. Could it be that it would probably be even faster to run a pandas read_csv with a list of files, reducing the overhead to spawn processes?</span>
<span class="comment-copy">It is not meant to be efficient, but to see what file is corrupted, or bypass the bug in pandas, usually loading the data is not the bottleneck so this solution should be good enough.</span>
<div class="post-text" itemprop="text">
<p>I would like to extract e-mails of exhibitors from an exhibition website using python. the page contains a hypertext of the exhibitors. when the exhibitor name is clicked you will find the exhibitors profile that includes its e-mail.</p>
<p>You can find the website here:</p>
<p><a href="https://www.medica-tradefair.com/cgi-bin/md_medica/lib/pub/tt.cgi/Exhibitor_index_A-Z.html?oid=80398&amp;lang=2&amp;ticket=g_u_e_s_t" rel="nofollow noreferrer">https://www.medica-tradefair.com/cgi-bin/md_medica/lib/pub/tt.cgi/Exhibitor_index_A-Z.html?oid=80398&amp;lang=2&amp;ticket=g_u_e_s_t</a></p>
<p>How can I do this using python, please? 
Thank you in advance </p>
</div>
<div class="post-text" itemprop="text">
<p>You can grab all the links to the exhibitors, then iterate through those and pull the email for each of them:</p>
<pre><code>import requests
import bs4


url = 'https://www.medica-tradefair.com/cgi-bin/md_medica/lib/pub/tt.cgi/Exhibitor_index_A-Z.html?oid=80398&amp;lang=2&amp;ticket=g_u_e_s_t'

response = requests.get(url)

soup = bs4.BeautifulSoup(response.text, 'html.parser')

links = soup.find_all('a', href=True)
exhibitor_links = ['https://www.medica-tradefair.com'+link['href'] for link in links if 'vis/v1/en/exhibitors' in link['href'] ]
exhibitor_links = list(set(exhibitor_links))

for link in exhibitor_links:
    response = requests.get(link)
    soup = bs4.BeautifulSoup(response.text, 'html.parser')

    name = soup.find('h1',{'itemprop':'name'}).text
    try:
        email = soup.find('a', {'itemprop':'email'}).text
    except:
        email = 'N/A'

    print('Name: %s\tEmail: %s' %(name, email))
</code></pre>
</div>
<span class="comment-copy">Please, show us your code, so we could help.</span>
<span class="comment-copy">There are lots of projects that help you crawl the page. You can use selenium for this.</span>
<span class="comment-copy">Questions that do not include code in this context should be closed as too broad. Please add your current coding attempt and research.</span>
<div class="post-text" itemprop="text">
<p><strong>tl;dr</strong>: how do I maximize number of http requests I can send in parallel?</p>
<p>I am fetching data from multiple urls with <code>aiohttp</code> library. I'm testing its performance and I've observed that somewhere in the process there is a bottleneck, where running more urls at once just doesn't help.</p>
<p>I am using this code:</p>
<pre><code>import asyncio
import aiohttp

async def fetch(url, session):
    headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0'}
    try:
        async with session.get(
            url, headers=headers, 
            ssl = False, 
            timeout = aiohttp.ClientTimeout(
                total=None, 
                sock_connect = 10, 
                sock_read = 10
            )
        ) as response:
            content = await response.read()
            return (url, 'OK', content)
    except Exception as e:
        print(e)
        return (url, 'ERROR', str(e))

async def run(url_list):
    tasks = []
    async with aiohttp.ClientSession() as session:
        for url in url_list:
            task = asyncio.ensure_future(fetch(url, session))
            tasks.append(task)
        responses = asyncio.gather(*tasks)
        await responses
    return responses

loop = asyncio.get_event_loop()
asyncio.set_event_loop(loop)
task = asyncio.ensure_future(run(url_list))
loop.run_until_complete(task)
result = task.result().result()
</code></pre>
<p>Running this with <code>url_list</code> of varying length (tests against <em><a href="https://httpbin.org/delay/2" rel="nofollow noreferrer">https://httpbin.org/delay/2</a></em>) I see that adding more urls to be run at once helps only up to ~100 urls and then total time starts to grow proportionally to number of urls (or in other words, time per one url does not decrease). This suggests that something fails when trying to process these at once. In addition, with more urls in 'one batch' I am occasionally receiving connection timeout errors. </p>
<p><a href="https://i.stack.imgur.com/bk0UR.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/bk0UR.png"/></a></p>
<ul>
<li>Why is it happening? What exactly limits the <em>speed</em> here?</li>
<li>How can I check what is the <em>maximum</em> number of parallel requests I can send on a given computer? (I mean an exact number - not approx by 'trial and error' as above)</li>
<li>What can I do to <em>increase</em> the number of requests processed at once?</li>
</ul>
<p>I am runnig this on Windows.</p>
<p><strong>EDIT</strong> in response to comment:</p>
<p>This is the same data with limit set to <code>None</code>. Only slight improvement in the end and there are many connection timeout errors with 400 urls sent at once. I ended up using <code>limit = 200</code> on my actual data.</p>
<p><a href="https://i.stack.imgur.com/4oinp.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/4oinp.png"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>By default <code>aiohttp</code> limits number of simultaneous connections to <code>100</code>. It achieves by setting default <code>limit</code> to <code>TCPConnector</code> <a href="https://aiohttp.readthedocs.io/en/stable/client_reference.html#tcpconnector" rel="nofollow noreferrer">object</a> that is used by <code>ClientSession</code>. You can bypass it by creating and passing custom connector to session:</p>
<pre><code>connector = aiohttp.TCPConnector(limit=None)
async with aiohttp.ClientSession(connector=connector) as session:
    # ...
</code></pre>
<p>Note however that you probably don't want to set this number too high: your network capacity, CPU, RAM and target server have their own limits and try to make enormous amount of connection can lead to increasing failures.</p>
<p>Optimal number can probably be found only through experiments on concrete machine.</p>
<hr/>
<p><em>Unrelated:</em></p>
<p>You don't have to create tasks without <a href="https://stackoverflow.com/a/37345564/1113207">reason</a>. Most asyncio api accept regular coroutines. For example, your last lines of code can be altered this way:</p>
<pre><code>loop = asyncio.get_event_loop()
loop.run_until_complete(run(url_list))
</code></pre>
<p>Or even to just <code>asyncio.run(run(url_list))</code> (<a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.run" rel="nofollow noreferrer">doc</a>) if you're using Python 3.7</p>
</div>
<span class="comment-copy">It'd be really interesting to see the updated graph with the artificial limit removed. Could you perhaps edit the question to include it?</span>
<span class="comment-copy">@user4815162342 updated</span>
<span class="comment-copy">@pieca I'm not sure when aiohttp starts timeout timer, so instead of limiting connections you may want to leave it <code>=None</code> and use semaphore to limit silmuntanious requests number instead. <a href="https://stackoverflow.com/a/55270554/1113207">Here's example</a> of how it can be done. It may improve performance and reduce errors.</span>
<span class="comment-copy">@MikhailGerasimov thanks for the link, I'll try to run it that way</span>
<span class="comment-copy">Thanks! This is good to know.</span>
<div class="post-text" itemprop="text">
<p>Each time I want to update my PyPi package, I always need to change the version number in <code>setup.py</code> file, and I need to remove the old <code>dist</code> and <code>build</code> folders. There are a bunch of commands I need to type in before I can see my updated package on PyPi website. </p>
<p>What's more, sometimes I want to upload my package to Test-PyPi rather than the real PyPi index, but the commands (upload url) are slightly different. </p>
<p>Is there a command line tool to automatically setup and upload my python package to PyPi or Test-PyPi? Or at least make the procedure more convenient?</p>
</div>
<div class="post-text" itemprop="text">
<p>There actually is a command line tool on PyPi called <a href="https://pypi.org/project/auto-pypi/" rel="nofollow noreferrer"><strong>auto-pypi</strong></a>. </p>
<p>Simply run </p>
<pre><code>$ pip install autopypi
</code></pre>
<p>to get and install this tool. </p>
<p>The use is very simple, run</p>
<pre><code>autopypi your-package-root-directory 
</code></pre>
<p>or</p>
<pre><code>autopypi your-package-root-directory -r
</code></pre>
<p>will wrap up everything for you and upload your package to Test PyPi by default and the use of <code>-r</code> will upload your package to the Real PyPi index.</p>
<p>The project description is pretty clear. As it demonstrated, you might want to modify your own <strong><em>setup.py</em></strong> file a little bit for convenient version number updating: </p>
<pre><code>version_number = input("Input the new version number you are going to use: ")

setuptools.setup(
    name="auto_pypi",
    version=version_number,
    ...)
</code></pre>
<p>Below is a detailed information about the command usage: </p>
<pre><code>Usage: autopypi [OPTIONS] PKG_DIR

  Python command line tool to setup Python package automatically.
  Example:      $ autopypi your-package-root-directory -r
  Example:      $ cd your-package-root-directory
                $ autopypi . -r

Options:
  -r, --real          Use the real PyPi index (instead of test PyPi).
  --help              Show this message and exit.
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I'm writing a wrapper to Folium for plotting data I regularly work with.  My class looks like...</p>
<pre><code>"""
Plot journeys using Folium
"""
import folium  

class PlotJourney():
    """
    Plot journeys using Folium
    """

    def __init__(self, journey,
                 zoom_start=14,
                 color='blue',
                 weight=4,
                 opacity=1):
        """
        Initialise the class.

        Parameters
        ----------
        journey : Pandas df
            Pandas gps data
        zoom_start :  int
            Zoom level on map (default is 14, if this doesn't capture whole journey then reduce).
        color : int
            Colour of journey line to be plotted.
        weight : int
            Thickness of journey line to be plotted.
        opacity : int
            Opacity of journey line to be lotted.
        """
        self.journey = journey
        self.zoom_start = zoom_start
        self.color = color
        self.weight = weight
        self.opacity = opacity
        self.folium_map = None

    def map_journey(self):
        """
        Map the journey and plot data points.

        Returns
        -------

        Folium Map object (folium.folium.Map)
        """
        self._center_map()
        self._plot_journey()
        return self.folium_map

    def _center_map(self):
        """
        Instantiate a Folium map centered on the mid-point of the journey.
        """
        mid_gps_point = int(len(self.gps) / 2)
        lat = self.journey.get_gps().iloc[mid_gps_point, 1]
        lon = self.journey.get_gps().iloc[mid_gps_point, 2]

        self.folium_map = folium.Map(location=[gps.lat, gps.lon],
                                     zoom_start=self.zoom_start)

    def _plot_journey(self):
        """
        Plot the journey on a Folium map.

        Returns
        -------

        """
        points = []
        for point in self.gps.itertuples():
            points.append(tuple([getattr(point, 'lat'),
                                 getattr(point, 'lon')]))
        folium.PolyLine(points,
                        color=self.color,
                        weight=self.weight,
                        opacity=self.opacity).add_to(self.folium_map)
</code></pre>
<p>...and some sample data would be...</p>
<pre><code>&gt; gps.head(60)

time    lat lon alt accuracy    epoch   speed   bearing has_speed   has_bearing
0   3938    53.388886   -1.467034   51.868667   8.0 1548424516371   4.958602    292.80603   True    True
1   4963    53.388907   -1.467131   51.776321   6.0 1548424517371   4.958602    284.70547   True    True
2   5958    53.388908   -1.467218   51.696368   6.0 1548424518371   5.487597    278.67032   True    True
3   6991    53.388907   -1.467324   51.542282   6.0 1548424519371   6.479943    237.81479   True    True
4   7970    53.388867   -1.467443   51.297575   6.0 1548424520371   9.512295    227.80710   True    True
5   8974    53.388802   -1.467564   50.852740   6.0 1548424521371   9.512295    229.77907   True    True
6   9965    53.388728   -1.467698   50.320224   6.0 1548424522371   10.650246   228.23433   True    True
7   10980   53.388656   -1.467838   49.781136   6.0 1548424523371   12.169792   226.67421   True    True
8   11975   53.388575   -1.467977   58.991536   6.0 1548424524371   12.833956   224.14210   True    True
9   12981   53.388493   -1.468120   59.354830   8.0 1548424525371   12.833956   224.14210   True    True
10  13976   53.388403   -1.468257   59.437485   8.0 1548424526371   13.042620   220.66881   True    True
11  14979   53.388308   -1.468385   59.708062   6.0 1548424527371   13.238512   215.60231   True    True
12  15965   53.388208   -1.468515   59.296351   6.0 1548424528371   13.871293   209.57590   True    True
13  16970   53.388101   -1.468622   51.660798   6.0 1548424529371   13.625889   209.57590   True    True
14  17961   53.387991   -1.468709   52.981496   6.0 1548424530371   13.625889   202.18289   True    True
15  18962   53.387888   -1.468796   53.916590   6.0 1548424531371   12.490627   200.32661   True    True
16  19975   53.387784   -1.468875   57.255894   6.0 1548424532371   12.822588   201.84820   True    True
17  20965   53.387680   -1.468945   57.119045   6.0 1548424533371   12.490627   207.00688   True    True
18  21970   53.387587   -1.469025   57.561872   6.0 1548424534371   12.020948   212.86082   True    True
19  22970   53.387507   -1.469108   50.470560   6.0 1548424535371   9.671459    220.38089   True    True
20  23991   53.387438   -1.469202   49.985855   6.0 1548424536371   9.671459    221.17906   True    True
21  24998   53.387381   -1.469281   50.069660   6.0 1548424537371   8.676711    221.17906   True    True
22  26007   53.387338   -1.469342   50.269601   6.0 1548424538371   6.622233    221.17906   True    True
23  27004   53.387310   -1.469388   50.465225   6.0 1548424539371   3.526981    230.89244   True    True
24  28002   53.387299   -1.469420   50.622989   6.0 1548424540371   3.526981    230.89244   True    True
25  28997   53.387297   -1.469439   50.738569   6.0 1548424541371   1.123686    228.41452   True    True
26  30032   53.387295   -1.469451   50.819053   6.0 1548424542371   1.029650    223.59712   True    True
27  30996   53.387298   -1.469446   50.872083   6.0 1548424543371   0.026778    226.58867   True    True
28  32001   53.387300   -1.469447   50.905676   6.0 1548424544371   0.060990    227.13960   True    True
29  32977   53.387308   -1.469450   50.926833   8.0 1548424545371   0.053592    227.21925   True    True
30  33994   53.387312   -1.469445   50.940148   6.0 1548424546371   0.048401    227.13814   True    True
31  34983   53.387313   -1.469440   50.948531   6.0 1548424547371   0.109131    227.43109   True    True
32  36002   53.387306   -1.469422   50.952020   6.0 1548424548371   0.052090    227.56128   True    True
33  37004   53.387307   -1.469418   50.947837   6.0 1548424549372   0.041504    227.60867   True    True
34  37995   53.387308   -1.469413   50.942715   6.0 1548424550372   0.071604    227.62416   True    True
35  38985   53.387311   -1.469413   50.937452   6.0 1548424551372   0.046862    227.85240   True    True
36  39994   53.387314   -1.469416   50.933595   6.0 1548424552372   0.069447    227.83664   True    True
37  40998   53.387316   -1.469416   50.931678   6.0 1548424553372   0.052803    227.86447   True    True
38  42001   53.387309   -1.469413   50.930216   6.0 1548424554372   0.069447    230.89244   True    True
39  42999   53.387305   -1.469425   50.929122   6.0 1548424555372   1.181171    230.89244   True    True
40  43997   53.387290   -1.469460   50.933373   6.0 1548424556372   4.368997    230.89244   True    True
41  44996   53.387263   -1.469523   50.943439   6.0 1548424557372   4.368997    234.79124   True    True
42  46004   53.387234   -1.469605   50.950515   6.0 1548424558372   5.774909    236.01671   True    True
43  47005   53.387209   -1.469700   50.955048   6.0 1548424559372   7.456284    236.01671   True    True
44  47998   53.387169   -1.469818   50.957904   6.0 1548424560372   10.010792   246.38654   True    True
45  48997   53.387135   -1.469969   50.981900   6.0 1548424561372   10.010792   251.24115   True    True
46  49999   53.387109   -1.470143   51.070027   6.0 1548424562372   11.330110   257.62120   True    True
47  51003   53.387085   -1.470334   51.175718   6.0 1548424563372   13.143827   265.61157   True    True
48  52005   53.387072   -1.470541   51.310900   6.0 1548424564372   14.031583   268.02994   True    True
49  53000   53.387072   -1.470769   51.528922   6.0 1548424565372   14.031583   273.96310   True    True
50  54008   53.387085   -1.471001   51.825265   6.0 1548424566372   14.883696   276.29077   True    True
51  55127   53.387101   -1.471232   52.054645   6.0 1548424567372   15.086695   275.23720   True    True
52  56109   53.387114   -1.471459   52.265689   6.0 1548424568372   15.086695   275.63900   True    True
53  57102   53.387134   -1.471680   52.544293   6.0 1548424569372   14.997134   276.34448   True    True
54  58111   53.387151   -1.471894   52.807707   6.0 1548424570372   14.283136   276.66174   True    True
55  59106   53.387163   -1.472107   52.961442   6.0 1548424571372   14.186031   276.77936   True    True
56  60108   53.387178   -1.472321   53.084145   6.0 1548424572372   14.186031   276.85873   True    True
57  61100   53.387191   -1.472531   53.158330   6.0 1548424573372   14.126818   277.44763   True    True
58  62104   53.387203   -1.472731   53.205148   6.0 1548424574372   13.779898   278.57642   True    True
59  63113   53.387219   -1.472923   53.471567   6.0 1548424575372   12.568898   278.76767   True    True
</code></pre>
<p>When I load the class in a Jupyter Notebook, instantiate and call the <code>map_journey()</code> method (which creates a map and the plots lines)  all that is returned is the address of the object in memory, whilst I was expecting the map itself to be rendered....</p>
<pre><code>PlotJourney(gps)
&lt;__main__.PlotJourney at 0x7f35a9bc2518&gt;
</code></pre>
<p>If I pull out the key steps and run them interactively in the Notebook it renders fine...</p>
<pre><code>m = folium.Map([gps.lat[0], gps.lon[0]], zoom_start=15)
points = []
for point in gps2.itertuples():
    points.append(tuple([getattr(point, 'lat'),
                         getattr(point, 'lon')]))
folium.PolyLine(points).add_to(m)
m
</code></pre>
<p>I'd be very grateful of any points as to where I've gone wrong in my class.</p>
</div>
<div class="post-text" itemprop="text">
<p>It was a naming issue, you have<code>journey</code> vs <code>gps</code>. I changed the names in center_map and plot_journey. To call the function run <code>PlotJourney(gps).map_journey()</code></p>
<pre><code>"""
Plot journeys using Folium
"""
import folium  


class PlotJourney():
    """
    Plot journeys using Folium
    """

    def __init__(self, journey,
                 zoom_start=14,
                 color='blue',
                 weight=4,
                 opacity=1):
        """
        Initialise the class.

        Parameters
        ----------
        journey : Pandas df
            Pandas gps data
        zoom_start :  int
            Zoom level on map (default is 14, if this doesn't capture whole journey then reduce).
        color : int
            Colour of journey line to be plotted.
        weight : int
            Thickness of journey line to be plotted.
        opacity : int
            Opacity of journey line to be lotted.
        """
        self.journey = journey
        self.zoom_start = zoom_start
        self.color = color
        self.weight = weight
        self.opacity = opacity
        self.folium_map = None


    def _center_map(self):
        """
        Instantiate a Folium map centered on the mid-point of the journey.
        """
        mid_gps_point = int(len(self.journey) / 2)
        lat = self.journey.iloc[mid_gps_point, 1]
        lon = self.journey.iloc[mid_gps_point, 2]

        self.folium_map = folium.Map(location=[lat, lon],
                                     zoom_start=self.zoom_start)

    def _plot_journey(self):
        """
        Plot the journey on a Folium map.

        Returns
        -------

        """
        points = []
        for point in self.journey.itertuples():
            points.append(tuple([getattr(point, 'lat'),
                                 getattr(point, 'lon')]))
        folium.PolyLine(points,
                        color=self.color,
                        weight=self.weight,
                        opacity=self.opacity).add_to(self.folium_map)

    def map_journey(self):
        """
        Map the journey and plot data points.

        Returns
        -------

        Folium Map object (folium.folium.Map)
        """
        self._center_map()
        self._plot_journey()
        return self.folium_map
</code></pre>
</div>
<span class="comment-copy">I haven't tested it, but could it be <code>for point in self.gps.itertuples():</code>? Can you try <code>for point in self.gps.iterrows():</code>? . <code>gps</code> is a pandas dataframe, right?</span>
<span class="comment-copy">I'll give that a go, but my understanding is that <code>itterrows()</code> and <code>itertuples()</code> do very similar things, the later preserves data types and can be a bit faster.</span>
<span class="comment-copy">Thanks for your time looking at this, I must pay much closer attention to where and what I'm typing to avoid such silly mistakes in the future.</span>
<div class="post-text" itemprop="text">
<p>I want to convert a <code>.py</code> file to <code>.exe</code> file using <code>py2exe</code> specifically. But when I run my <code>setup.py</code> file (imports setup from <code>distutils</code> ) it show me this error:</p>
<blockquote>
<p>IndexError: tuple index out of range</p>
</blockquote>
</div>
<span class="comment-copy">hey, you need to add a few more details to the question. please have a look at how to make a Minimal, Complete and Verifiable example <a href="https://stackoverflow.com/help/mcve">stackoverflow.com/help/mcve</a></span>
<div class="post-text" itemprop="text">
<p>I want to delete top and bottom lines in multiple csv files in a folder at once. Then delete the second line after that. My code works well with one file but i have 1000s of files to go through and i cannot specify each file name. How can i modify this to make it work?</p>
<pre><code>#Remove top and bottom lines from all files 
lines = open('My/local/Drive/*.csv').readlines()
open('My/local/Drive/*.csv', 'w').writelines(lines[2:-4]);

#Remove 2nd line from all files
lines = []
with open('My/local/Drive/*.csv', 'r') as f:
    lines = f.readlines()
with open('My/local/Drive/*.csv', 'w') as f:
    f.writelines(lines[:1] + lines[2:]);
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><strong><em>&gt;&gt;&gt;TAKE A BACKUP OF YOUR FILES BEFORE RUNNING THIS&lt;&lt;&lt;</em></strong></p>
<p>You can use the following code, where you define path following your needs.</p>
<pre><code>import glob

path='.'
for filename in glob.iglob(path+'/*.csv'):
  with open(filename, 'r') as f:
    lines = f.read().split("\n")
    f.close()
    if len(lines) &gt;= 7:
      lines = lines[2:-5]
      lines = lines[:1] + lines[2:]
      o = open(filename, 'w')
      for line in lines:
        o.write(line+'\n')
      o.close()
</code></pre>
<p><strong>in my target folder (2 csv files):</strong></p>
<pre><code>$ ls *.csv
input1.csv  input2.csv
</code></pre>
<p><strong>file1:</strong></p>
<pre><code>to delete1
to delete2
ID;TAG;GROUP
todelete;B00;AB0
niub12617500;B01;AB4
niub16371500;B01;AB3
todelete;B00;AB0
todelete;B00;AB0
todelete;B00;AB0
todelete;B00;AB0
</code></pre>
<p><strong>file2:</strong></p>
<pre><code>to delete1
to delete2
ID;TAG;GROUP
todelete;B00;AB0
niub12677500;B00;AB2
niub16377500;B01;AB0
todelete;B00;AB0
todelete;B00;AB0
todelete;B00;AB0
</code></pre>
<p>After execution:</p>
<pre><code>$ cat input1.csv
ID;TAG;GROUP
niub12617500;B01;AB4
niub16371500;B01;AB3
$ cat input2.csv
ID;TAG;GROUP
niub12677500;B00;AB2
niub16377500;B01;AB0
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Well, you can try and list all files in a directory (having a folder with all your <em>.csv</em> files is a great option here!).
This will list you ALL files:</p>
<pre><code>import os
for filename in os.listdir(os.getcwd()):
</code></pre>
<p>Or you can just list the <em>.csv</em> files!</p>
<pre><code>import glob
for filename in glob.glob('*.txt'):
</code></pre>
<p>Having that, you can do whatever you need to delete those files! </p>
<p>Check <a href="https://stackoverflow.com/questions/18262293/how-to-open-every-file-in-a-folder">this</a> out if you need more insight on listing and operating with that! </p>
<p>Dividing your problem in small problems, everything has an easier solution: <strong>how to open every file in a folder</strong></p>
</div>
<span class="comment-copy">Are you working on a unix env?</span>
<span class="comment-copy">Windows environment</span>
<span class="comment-copy">could you specify exactly what are the lines you want to remove/keep?</span>
<span class="comment-copy">I am removing the first two lines before the header, the line after the header and the last four lines in the dataset.</span>
<span class="comment-copy">if it were linux I would have solved it in 1 command line, anyway I have answered ;-)</span>
<span class="comment-copy">This works. Thank you.</span>
<span class="comment-copy">@enufeffizy: if you are satisfied by my answer, can you vote up and accept? Thank you</span>
<span class="comment-copy">@enufeffizy  If we have answered your question, could you please accept an answer/upvote as detailed in: <a href="https://stackoverflow.com/help/someone-answers">stackoverflow.com/help/someone-answers</a></span>
<div class="post-text" itemprop="text">
<p>Let's say I want to count in a system that has variable bases across the digit positions (this might resemble the Imperial measurement system to some). So for example, I am counting with up to three digits "abc", where b is modulo x, c is modulo y and a can be unlimited, and can be any number. When the "digit" counts up to its base, it returns to zero and the digit on the left increments by one.</p>
<p>What is the convenient way to do this? Of course, this should scale to any number of "digits".
A simple way would be:</p>
<pre><code>def count_var(n, m):

    m = m[::-1] # this is inverted for ease of iteration

    l = len(m)
    result = [0] * (l+1)
    for i in range(n):
        result[0] += 1
        for j in range(l):
            if result[j] == m[j]:
                result[j] = 0
                result[j+1] += 1

    return result[::-1]

print(count_var(719, [3,6,5]))
</code></pre>
<p>Can this be optimized or automated with some built-in? The nested loops seem very slow, but I cannot compare them to anything. Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>Use divmod instead of the nested loop</p>
<pre><code>def count_var(n,m):
  r=[]
  for mi in m[::-1]:
    n,c=divmod(n,mi)
    r.insert(0,c)
  r.insert(0,n)
  return r

print(count_var(719, [3,6,5]))
</code></pre>
<p>Divmod does basically division and modulo in once</p>
</div>
<span class="comment-copy">Pretty sure there is some elegant way of doing some dynamic programming and recursion there, something like count(num, base): if already_Counted: return already elsE: count_and_store</span>
<div class="post-text" itemprop="text">
<p>I am using this <a href="https://github.com/logandk/serverless-wsgi#remote-command-execution" rel="nofollow noreferrer">node plugin</a> to run django management commands.</p>
<p>If I execute the command directly, it works:</p>
<pre><code>sls wsgi manage local -c "check --list-tags"
</code></pre>
<p>If I call a python script that calls it as a subprocess, It cannot find the command:</p>
<pre><code>import subprocess
proc = subprocess.Popen(['sls', 'wsgi', 'manage', 'local', '-c', '"check --list-tags"'])
(out, err) = proc.communicate()


"Traceback (most recent call last):\n  File \"/usr/local/lib/python3.6/site-packages/django/core/management/__init__.py\", line 102, in call_command\n    app_name = get_commands()[command_name]\nKeyError: 'check --list-tags'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"./wsgi_handl
    er.py\", line 89, in handler\n    management.call_command(*shlex.split(meta.get(\"data\", \"\")))\n  File \"/usr/local/lib/python3.6/site-packages/django/core/management/__init__.py\", line 104, in call_command\n    raise CommandError(\"Unknown command: %r\" % command_name)\ndjango.core.management.base.CommandError: Unknown command: 'check --list-tags'\n
    "
</code></pre>
<p>If I do a command that does not contain any whitespace it works, such as:</p>
<pre><code>subprocess.Popen(['sls', 'wsgi', 'manage', 'local', '-c', '"makemigrations"'])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>you can pass the full command as a string if you use shell=True, try that and refine it later </p>
<pre><code>proc = subprocess.Popen('sls wsgi manage local -c "check --list-tags"' shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)
</code></pre>
</div>
<span class="comment-copy">have you tried proc = subprocess.Popen(['sls', 'wsgi', 'manage', 'local', '-c', '"check', '--list-tags"'])</span>
<span class="comment-copy">This throws <code>ValueError: No closing quotation</code> from shlex</span>
<span class="comment-copy">you can pass the full command as a string if you use shell=True, try that and refine it later proc = subprocess.Popen('sls wsgi manage local -c "check --list-tags"' shell=True, stdout=subprocess.PIPE, stderr=subprocess.PIPE)</span>
<span class="comment-copy">That did the trick, thank you!</span>
<span class="comment-copy">will post answer and you accept it then</span>
<div class="post-text" itemprop="text">
<p>I'm pretty new to Python and only want to extract the city for these clients' addresses:</p>
<pre><code>clients = ["Peter, Calle Fantasia 15, Madrid", "Robert, Plaza de Perdas 2, 
            Sevilla", "Paul, Calle Polo, Madrid", "Francesco, Plaza de Opo I, Segovia"]
</code></pre>
<p>Can someone help? Thank you very much in advance!</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use a list comprehension, and keep the last element in each string starting from the lst <code>,</code> onwards. </p>
<p>For that use <a href="https://docs.python.org/2/library/string.html" rel="nofollow noreferrer"><code>string.split</code></a> setting <code>,</code> as a separator, which will split each string whenever there is a comma, slice the resulting lists keeping the last element, and use <a href="https://docs.python.org/2/library/string.html" rel="nofollow noreferrer"><code>string.strip</code></a> to remove leading white spaces:</p>
<pre><code>clients = ["Peter, Calle Fantasia 15, Madrid", "Robert, Plaza de Perdas 2, 
            Sevilla", "Paul, Calle Polo, Madrid", "Francesco, Plaza de Opo I, Segovia"]

[i.split(',')[-1].strip() for i in clients]
# ['Madrid', 'Sevilla', 'Madrid', 'Segovia']
</code></pre>
<hr/>
<p>For more details on the methods used above, I'd suggest you give a look at:</p>
<ul>
<li><p><a href="https://docs.python.org/2/library/string.html" rel="nofollow noreferrer">string — Common string operations</a></p></li>
<li><p><a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions" rel="nofollow noreferrer">List Comprehensions</a></p></li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>If the elements of <code>clients</code> are always of the format <code>"name, address, city"</code>, you can <a href="https://docs.python.org/3/library/stdtypes.html#str.split" rel="nofollow noreferrer">split</a> it like so:</p>
<pre><code># List comprehension, splits each element of client on commas,
# then takes the final element (stripping any whitespace)
clients = [client.split(',')[-1].strip() for client in clients]
</code></pre>
<p></p>
<pre><code>&gt;&gt;&gt; print(clients)

['Madrid', 'Sevilla', 'Madrid', 'Segovia']
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>without using list comprehension </p>
<pre><code>clients = ["Peter, Calle Fantasia 15, Madrid", "Robert, Plaza de Perdas 2, Sevilla", "Paul, Calle Polo, Madrid", "Francesco, Plaza de Opo I, Segovia"]
list_of_cities =[]
for i in clients:
    index_last_comma = 0
    for j in range(len(i)-1,0,-1):
        if i[j]==',':
            index_last_comma  = j
            break
    city = i[j+1:len(i)].strip()
    list_of_cities.append(city)

print(list_of_cities)
# output ['Madrid', 'Sevilla', 'Madrid', 'Segovia']
</code></pre>
</div>
<span class="comment-copy">Is the city always the third part of <code>&lt;name&gt;, &lt;street&gt;, &lt;city&gt;</code>. Try to <code>split</code> each string.</span>
<span class="comment-copy">Don't forget to give some feedback @Jane :-), see <a href="https://stackoverflow.com/help/someone-answers">What should I do when someone answers my question?</a></span>
<span class="comment-copy">what is the point of using <code>strip('  ') </code> over  <code>strip()</code></span>
<span class="comment-copy">None @prashantrana :)</span>
<div class="post-text" itemprop="text">
<p>I am having difficulties trying to connect to the Google Drive API with the code provided in the API documentation. I would like to read files in my Google drive.</p>
<p>This is the code I am using</p>
<pre><code>from __future__ import print_function
import pickle
import os.path
from googleapiclient.discovery import build
from google_auth_oauthlib.flow import InstalledAppFlow
from google.auth.transport.requests import Request
# If modifying these scopes, delete the file token.pickle.
SCOPES = ['https://www.googleapis.com/auth/drive.metadata.readonly']
def main():
    """Shows basic usage of the Drive v3 API.
    Prints the names and ids of the first 10 files the user has access to.
    """
    creds = None
    # The file token.pickle stores the user's access and refresh tokens, and is
    # created automatically when the authorization flow completes for the first
    # time.
    if os.path.exists('token.pickle'):
        with open('token.pickle', 'rb') as token:
            creds = pickle.load(token)
    # If there are no (valid) credentials available, let the user log in.
    if not creds or not creds.valid:
        if creds and creds.expired and creds.refresh_token:
            creds.refresh(Request())
        else:
            flow = InstalledAppFlow.from_client_secrets_file(
                'credentials.json', SCOPES)
            creds = flow.run_local_server()
        # Save the credentials for the next run
        with open('token.pickle', 'wb') as token:
            pickle.dump(creds, token)

    service = build('drive', 'v3', credentials=creds)

    # Call the Drive v3 API
    results = service.files().list(
        pageSize=10, fields="nextPageToken, files(id, name)").execute()
    items = results.get('files', [])

    if not items:
        print('No files found.')
    else:
        print('Files:')
        for item in items:
            print(u'{0} ({1})'.format(item['name'], item['id']))

if __name__ == '__main__':
    main()
</code></pre>
<p>The credentials file is in my working directory:</p>
<pre><code>import os
path = os.path.abspath('credentials.json')
path
#path#
'/Users/emmanuelmac/credentials.json'
</code></pre>
<p>Have read the Google Drive API, not sure what I am doing wrong</p>
<p>This is my traceback:</p>
<pre><code>---------------------------------------------------------------------------
FileNotFoundError                         Traceback (most recent call last)
&lt;ipython-input-26-053e36207d0e&gt; in &lt;module&gt;()
     46 
     47 if __name__ == '__main__':
---&gt; 48     main()

&lt;ipython-input-26-053e36207d0e&gt; in main()
     25         else:
     26             flow = InstalledAppFlow.from_client_secrets_file(
---&gt; 27                 'credentials.json', SCOPES)
     28             creds = flow.run_local_server()
     29         # Save the credentials for the next run

~/anaconda3/lib/python3.6/site-packages/google_auth_oauthlib/flow.py in from_client_secrets_file(cls, client_secrets_file, scopes, **kwargs)
    169             Flow: The constructed Flow instance.
    170         """
--&gt; 171         with open(client_secrets_file, 'r') as json_file:
    172             client_config = json.load(json_file)
    173 

FileNotFoundError: [Errno 2] No such file or directory: 'credentials.json'
</code></pre>
</div>
<span class="comment-copy">ok, with the traceback, it looks like the problem you have is in a different area; it looked like a duplicate of this: <a href="https://stackoverflow.com/questions/45501082/set-google-application-credentials-in-python-project-to-use-google-api" title="set google application credentials in python project to use google api">stackoverflow.com/questions/45501082/…</a>  i will remove my answer below as it is no longer relevant</span>
<div class="post-text" itemprop="text">
<p>I have a list which contains and a single and multi-word token. </p>
<pre><code>brand_list = ['ibm','microsoft','abby softwate', 'tata computer services']
</code></pre>
<p>I need to search any of these words present in a title string. I am able to find a single word. But for a multi-word token, my code fails. 
Here is my code. Please help me out. Here is my solution.</p>
<pre><code>import string
def check_firm(test_title):
    translator = str.maketrans('', '', string.punctuation)
    title = test_title.translate(translator)
    if any(one_word.lower() in title.lower().split(' ') for one_word in brand_list):

        status_code_value = 0
        print("OEM word found")
    else:
        status_code_value = 1
        print("OEM word not found")

    print("current value of status code ------------&gt;", status_code_value)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><strong>Change this</strong>:</p>
<pre><code>if any(one_word.lower() in title.lower().split(' ') for one_word in brand_list):
</code></pre>
<p><strong>to this</strong>:</p>
<pre><code>if title.lower() in brand_list:
</code></pre>
<p><strong>Hence</strong>:</p>
<pre><code>import string
brand_list = ['ibm','Microsoft','abby softwate', 'TATA computer services']
brand_list = [x.lower() for x in brand_list] # ['ibm', 'microsoft', 'abby softwate', 
                                             #  'tata computer services']

def check_firm(test_title):
    translator = str.maketrans('', '', string.punctuation)
    title = test_title.translate(translator)

    if title.lower() in brand_list:
        status_code_value = 0
        print("OEM word found")
    else:
        status_code_value = 1
        print("OEM word not found")

    print("current value of status code ------------&gt;", status_code_value)

check_firm('iBM')
check_firm('Tata Computer SERVICES')
check_firm('Khan trading Co.')
</code></pre>
<p><strong>OUTPUT</strong>:</p>
<pre><code>OEM word found
current value of status code ------------&gt; 0
OEM word found
current value of status code ------------&gt; 0
OEM word not found
current value of status code ------------&gt; 1
</code></pre>
<blockquote>
<p>Note: I converted all the elements in the list to <code>lower()</code> using:</p>
</blockquote>
<pre><code> brand_list = [x.lower() for x in brand_list]
</code></pre>
<p>This will ensure the comparison is made correctly.</p>
<p><strong>EDIT</strong>: </p>
<p><strong>OP</strong>: <em>but my input tile is title string. for example "Tata Computer SERVICES made a profit of x dollars". In that case, how can we find the string?</em> </p>
<p>In such case, I would opt for splitting the string before passing to the function:</p>
<pre><code>inp_st1 = 'iBM'
inp_st2 = 'Tata Computer SERVICES made a profit of x dollars'
inp_st3 = 'Khan trading Co.'

check_firm(inp_st1)
check_firm(" ".join(inp_st2.split()[:3])) # Tata Computer SERVICES
check_firm(inp_st3)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You will never be able to find two words because of this code:</p>
<pre><code>title.lower().split(' ')
</code></pre>
<p>Say your title is <strong>tata computer services</strong>, when you carry out that code you'll en dup with:</p>
<pre><code>["tata", "computer", "services"]
</code></pre>
<p>Then in your <strong>for loop</strong> you will only search for each singular word, essentially you've broken the title into something you can't match. </p>
<p>Writing the <strong>for loop</strong> in human words:</p>
<pre><code>any(one_word.lower() in title.lower().split(' ') for one_word in brand_list)
</code></pre>
<p><em>If any of the words in brand_list can be found in the array ["tata", "computer", "services"], then that's true.</em> </p>
<p>As you can see, no words from <strong>brand_list</strong> can match, since the word is actually composed of three words and spaces "tata computer services". </p>
<p><strong>To carry out what you are looking for:</strong></p>
<p>Change this:</p>
<pre><code>if any(one_word.lower() in title.lower().split(' ') for one_word in brand_list):
</code></pre>
<p>to:</p>
<pre><code>if any(one_word.lower() in title.lower() for one_word in brand_list):
</code></pre>
<p>That way you are looking for each word from <strong>brand_list</strong> inside the title. Your code would look like this:</p>
<pre><code>brand_list = ['ibm','microsoft','abby softwate', 'tata computer services']

 import string
def check_firm(test_title):
    translator = str.maketrans('', '', string.punctuation)
    title = test_title.translate(translator)
    if any(one_word.lower() in title.lower() for one_word in brand_list):
        status_code_value = 0
        print("OEM word found")
    else:
        status_code_value = 1
        print("OEM word not found")

    print("current value of status code ------------&gt;", status_code_value)

check_firm("ibm")
check_firm("abby software")
check_firm("abby softwate apple")  
</code></pre>
<p>With the following output:</p>
<pre><code>OEM word found
current value of status code ------------&gt; 0
OEM word not found
current value of status code ------------&gt; 1
OEM word found
current value of status code ------------&gt; 0
</code></pre>
<p><strong>EDIT</strong></p>
<p><strong>OP</strong>: <em>I tried your solution. The issue is it will also hold true for input like "tata computer servicessssssssss". Any idea to overcome this issue. Thanks</em></p>
<p>In the comments it was highlighted that this code would let pass a title like <strong>tat computer servicesss</strong>. To avoid this then I suggest regex expressions, such that:</p>
<pre><code>brand_list = ['ibm','microsoft','abby softwate', 'tata computer services']

import string
import re
def check_firm(test_title):
    translator = str.maketrans('', '', string.punctuation)
    title = test_title.translate(translator)
    if any(re.search(r'\b' + one_word.lower() + r'\b', title) for one_word in brand_list):
        status_code_value = 0
        print("OEM word found")
    else:
        status_code_value = 1
        print("OEM word not found")

    print("current value of status code ------------&gt;", status_code_value)

check_firm("tata computer services")  
check_firm("tata computer servicessssss")  
check_firm("tata computer services something else") 
</code></pre>
<p><strong>Output</strong></p>
<pre><code>OEM word found
current value of status code ------------&gt; 0
OEM word not found
current value of status code ------------&gt; 1
OEM word found
current value of status code ------------&gt; 0
</code></pre>
<p>The part that is of interest is:</p>
<pre><code>any(re.search(r'\b' + one_word.lower() + r'\b', title) for one_word in brand_list):
</code></pre>
</div>
<span class="comment-copy"><code>title.lower().split(' ')</code> looks fishyy</span>
<span class="comment-copy">It is. It tokenizes the string base on space. When I search for multi-letter word, it fails. Here is the test string - " tata computer services , not much of success"</span>
<span class="comment-copy">See if the answer posted below helps?</span>
<span class="comment-copy">Thanks for the reply but my input tile is title string. for example "Tata Computer SERVICES made a profit of x dollars". In that case, how can we find the string?</span>
<span class="comment-copy">@RohitHaritash you should split the input string before passing to the funciton. and pass only the desired string.</span>
<span class="comment-copy">I was about to comment on that, seems that should be stated in the answer so as not to confuse.</span>
<span class="comment-copy">@RohitHaritash Check the edit?</span>
<span class="comment-copy">I tried your solution. The issue is it will also hold true for input like "tata computer servicessssssssss". Any idea to overcome this issue. Thanks</span>
<div class="post-text" itemprop="text">
<p>So I'm trying to use the IB API wrapper from <a href="https://github.com/erdewit/ib_insync" rel="nofollow noreferrer">here</a> and I try running the first line   </p>
<pre><code>from ib_insync import * 
</code></pre>
<p>but am getting the following error:</p>
<p><code>Traceback (most recent call last):</code>
<code>File "/usr/local/lib/python3.7/site-packages/ib_insync/__init__.py", line 10, in &lt;module&gt;</code>
<code>import ibapi</code>
<code>ModuleNotFoundError: No module named 'ibapi'</code></p>
<p><code>During handling of the above exception, another exception occurred:</code></p>
<p><code>Traceback (most recent call last):</code>
<code>File "&lt;stdin&gt;", line 1, in &lt;module&gt;</code>
<code>File "/usr/local/lib/python3.7/site-packages/ib_insync/__init__.py", line 13, in &lt;module&gt;</code>
<code>'IB API from http://interactivebrokers.github.io is required')</code>
<code>RuntimeError: IB API from http://interactivebrokers.github.io is required</code></p>
<p>but I've downloaded the IB API from the IB <a href="http://interactivebrokers.github.io/#" rel="nofollow noreferrer">github</a> (had to use The Unarchiver to unzip) and saved it on my desktop. As far as I can tell there's no pip3 command I can use to install it so I'm not sure what else I can do to install the IB API. I've allowed ticked all the boxes for the API in TWS. I'm not sure why it's not installing properly? </p>
<p>It seems to be the same issue found <a href="https://stackoverflow.com/questions/48485442/encounter-error-ib-api-required-when-ib-api-is-installed">here</a> but mine is for macosx. I've tried running the commands from README.md and they don't work. It just says no such directory exists. </p>
</div>
<div class="post-text" itemprop="text">
<p>Installing the a python module as a wheel is optional- its also possible to just include the path to the module in the PYTHONPATH environment variable. But if you're using the commands from the READ.ME to build and install a wheel, make sure you're in the pythonclient folder and then run: </p>
<p>python3 setup.py bdist_wheel<br/>
  python3 -m pip install --user --upgrade dist/ibapi-9.75.1-py3-none-any.whl</p>
<p>Thats for the current API Latest version as of March 2019 which is 975.1</p>
</div>
<span class="comment-copy">The possible error is your install path is not in <code>sys.path</code>. Try adding it before importing</span>
<span class="comment-copy">thanks. How would I go about doing that?</span>
<div class="post-text" itemprop="text">
<p>this is my first attempt building something non-web and really touching <em>'logic-coding'</em>. So this question may come across as amateur-ish.</p>
<p>Anyways, please take a look at this god awful dictionary below:  </p>
<pre><code>  Messy_Dict=
    {
        'name': "['\\r\\n                  NASDAQ: BKEP\\r\\n          ']", 
        'underlying': "['1.12']", 
        'strike_prices_list': ["['2.50'", " '5.00'", " '7.50']"], 
        'call_bid': ["['\\r\\n0.05            '", " '\\r\\n0.00            '", " '\\r\\n0.00            ']"], 
        'put_ask': ["['\\r\\n2.10            '", " '\\r\\n4.50            '", " '\\r\\n7.00            ']"]
    }
</code></pre>
<p>Okay so what I want to do is clean up the unneccessary sub-strings within each dictionary value to get something like this:</p>
<pre><code>Clean_Dict=
    {
        'name': "BKEP", 
        'underlying': "1.12", 
        'strike_prices_list': ["2.50", "5.00", "7.50"], 
        'call_bid': ["0.05", "0.00", "0.00"], 
        'put_ask': ["2.10", "4.50", "7.00"]
    }
</code></pre>
<p>I have managed to get from <em>Messy_Dict</em> to <em>Clean_Dict</em> but I used very barbaric means to do so. I will just say that it included a for loop and multiple strip(), replace('', '') methods. And it pains me to look at that block of code in my .py file. </p>
<p>So I guess, is there a more elegant method in performing the desired task of converting Messy_Dict to Clean_Dict? I feel as if I'm missing something here in my fundamentals. Any response would be great, thanks!</p>
<p><strong>Edit:</strong></p>
<pre><code>def parse(self, response):
        strike_prices_main = response.css('.highlight , .aright .strike-col').css('::text').extract()
        if not strike_prices_main:
            pass
        else:
            name = response.css('#instrumentticker::text').extract()
            strike_prices_list = response.css('.aright .strike-col').css('::text').extract()
            call_bid = response.css('.aright td:nth-child(5)').css('::text').extract()
            put_ask = response.css('.aright td:nth-child(14)').css('::text').extract()
            underlying = response.css('.pricewrap .bgLast').css('::text').extract()
            file.write('%s|%s|%s|%s|%s\n'%(name,underlying,strike_prices_list,call_bid,put_ask))
</code></pre>
<p>Using spiders to crawl!</p>
</div>
<div class="post-text" itemprop="text">
<p>Maybe like this:</p>
<pre><code>import re
Messy_Dict= \
{
    'name': "['\\r\\n                  NASDAQ: BKEP\\r\\n          ']", 
    'underlying': "['1.12']", 
    'strike_prices_list': ["['2.50'", " '5.00'", " '7.50']"], 
    'call_bid': ["['\\r\\n0.05            '", " '\\r\\n0.00            '", " '\\r\\n0.00            ']"], 
    'put_ask': ["['\\r\\n2.10            '", " '\\r\\n4.50            '", " '\\r\\n7.00            ']"]
}
regexstr = "\\\\(r|n)|\s|\[|\]|\'|NASDAQ:"

dict_clean = {}
for k, v in Messy_Dict.items():
    if isinstance(v, list):
        list_clean = []
        for el in v:            
            el_clean = re.sub(regexstr, "", el)
            list_clean.append(el_clean)
        dict_clean[k] = list_clean
    else:
        dict_clean[k] = re.sub(regexstr, "", v)
dict_clean
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use regular expressions.</p>
<p>Example:</p>
<pre><code>import re

messy_dict = {
    'name': "['\\r\\n                  NASDAQ: BKEP\\r\\n          ']", 
    'underlying': "['1.12']", 
    'strike_prices_list': ["['2.50'", " '5.00'", " '7.50']"], 
    'call_bid': ["['\\r\\n0.05            '", " '\\r\\n0.00            '", " '\\r\\n0.00            ']"], 
    'put_ask': ["['\\r\\n2.10            '", " '\\r\\n4.50            '", " '\\r\\n7.00            ']"]
}

for key in messy_dict:
    stripfunc = lambda x: re.sub('[^\d\.]', '', str(x))
    if type(messy_dict[key]) is list:
        messy_dict[key] = [stripfunc(x) for x in messy_dict[key]]
    else:
        messy_dict[key] = stripfunc(messy_dict[key])

print(messy_dict)
</code></pre>
<p>Explanation: [^ ] matches anything that is NOT in the set. \d is for numeric values and the backslash escapes the dot. Using str(val) to make strings out of the lists.</p>
<p>Output: <code>{'name': '', 'underlying': '1.12', 'strike_prices_list': ['2.50', '5.00', '7.50'], 'call_bid': ['0.05', '0.00', '0.00'], 'put_ask': ['2.10', '4.50', '7.00']}</code></p>
<p>Edit: just noticed that you also want to keep the dot. Updated the code.</p>
</div>
<span class="comment-copy">have you tried iterating the keys, and for each value use regex to replace all offending characters?</span>
<span class="comment-copy">the right question in this case is where "messy" dict comes from. It looks very much like JSON that was abused somehow to become this...Probably json response that was not handled properly?</span>
<span class="comment-copy">How many for loops and regex statements would it take?</span>
<span class="comment-copy">@buran i was scraping Yahoo Finance to get some data! And gosh, this got printed on my cmd prmt hahaha ouch</span>
<span class="comment-copy">@LowaiisTan, So my guess is right and best approach would be to show your code that query Yahoo finance and get help with it. As it stands this is XY problem. You can get perfect formated valid JSON response from yahoo finance</span>
<span class="comment-copy">Oh wow!! haha thats 50% of my code quantity...</span>
<span class="comment-copy">take my upvote!</span>
<span class="comment-copy">Hmmmm, have u tried your code?</span>
<span class="comment-copy">Woops, I haven't. Fixed.</span>
<span class="comment-copy">Would prefer a bit more accuracy in exchange for less concision!</span>
<span class="comment-copy">Huh, it generates the result you asked for?</span>
<span class="comment-copy">Woops, didnt see the edit!</span>
<div class="post-text" itemprop="text">
<p>I have a nested r-tree like datastructure in Python (list of lists). The key is a large number (about 10 digits). On each level there are about x number of items (eg:10) in the list. Then within each list, it recurses and has x items and so on. The height of the tree is h levels (eg: 5). Each level also has an indication of what range of keys it contains (like r-tree).</p>
<p>For a given key, I need to locate the corresponding entry in the tree. This can be trivially done by scanning through each level, check if the given key lies within the range. If so, then step into that layer and recurse till it reaches the leaf.</p>
<p>This can also be done by successively dividing the key by x and taking the quotient as list index. </p>
<p>So the question is, what is more effecient : walking through list sequentially (complexity = depth * x (eg:50)) or successively dividing the large number by x to get the actual list indices (complexity = h divisions (eg: 5 divisions)). </p>
<p>(ie) 50 range checks or 5 divisions ?</p>
<p>This needs to be scalable. So if this code is being accessed in cloud by very large number of users, what is efficient ? May be division is more expensive to perform at scale than range checks  ?</p>
</div>
<div class="post-text" itemprop="text">
<p>You need to benchmark the code in somewhat realistic scenario.</p>
<p>The reason why it's so hard to say is that you are not just comparing division (by the way, modern compilers avoid divisions with a large number of tricks). On modern CPUs you have large caches so likely the list will fit into L2 or L3 which decreases the run-time dramatically. There's also the fancy vector/SIMD instructions that might be used to speed up all the checks in the linear case.</p>
<p>I would guess that going through the list sequentially will be faster, in addition the code will be simpler.</p>
<p>But don't take my word for it, take a real example and benchmark the two versions and pick based on the results. Especially if this is critical for your system's performance.</p>
</div>
<span class="comment-copy">Division would be much faster if it actually works.  But does it actually work?  Only if every internal list has <i>exactly</i> x items.</span>
<div class="post-text" itemprop="text">
<p>After writing data to form I get the pop-up menu.</p>
<p>I try to select some from it and continue with selenium, but all variants are in <code>div</code> tag</p>
<pre><code>&lt;div class="menu menu_theme_islands menu_size_m sg-datalist menu__control i-bem sg-datalist_js_inited menu_js_inited menu__control_js_inited sg-datalist_focused menu_focused menu_hovered" data-bem="{&amp;quot;menu&amp;quot;:{},&amp;quot;sg-datalist&amp;quot;:{}}" role="menu" tabindex="0" aria-activedescendant="uniq155307974964633"&gt;
    &lt;div class="menu__item menu__item_theme_islands i-bem i-bem" data-bem="{&amp;quot;menu__item&amp;quot;:{&amp;quot;val&amp;quot;:30863}}" role="menuitem" id="uniq155307974964651" aria-disabled=""&gt;Магазин детской одежды&lt;/div&gt;
    &lt;div class="menu__item menu__item_theme_islands i-bem i-bem" data-bem="{&amp;quot;menu__item&amp;quot;:{&amp;quot;val&amp;quot;:30859}}" role="menuitem" id="uniq155307974964652" aria-disabled=""&gt;Детский магазин&lt;/div&gt;
&lt;/div&gt;
</code></pre>
<p>I'm trying </p>
<pre><code>company_id = driver.find_element_by_xpath("//input[@placeholder='Начните печатать и выберите из списка']")
company_id.send_keys("Магазин детской одежды")
time.sleep(1)
driver.select.select_by_visible_text("Магазин детской одежды")
</code></pre>
<p>But it's return an</p>
<pre><code>AttributeError: 'WebDriver' object has no attribute 'select_by_visible_text'
</code></pre>
<p>How can I select smth from the pop-up?</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>from selenium.webdriver.support.select import Select
Select select=Select(driver.find_element_by_css_selector("div.menu__control_js_inited"))
select.select_by_index(1)
</code></pre>
<p>**Option 2  :**If above doesn't work try this way.</p>
<pre><code>driver.find_element_by_css_selector("div.menu__control_js_inited").click()
WebDriverWait(driver, 20).until(expected_conditions.element_to_be_clickable((By.XPATH, "(//div[@class='menu__item menu__item_theme_islands i-bem i-bem'])[1]"))).click()
</code></pre>
<p>Options 3:</p>
<pre><code>element=driver.find_element_by_css_selector("div.menu__control_js_inited")
ActionChains(driver).move_to_element(element).perform()
WebDriverWait(driver, 20).until(expected_conditions.element_to_be_clickable((By.XPATH, "(//div[@class='menu__item menu__item_theme_islands i-bem i-bem'])[1]"))).click()
</code></pre>
<p>Please make sure you need to have following imports.</p>
<pre><code>from selenium import webdriver
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions
from selenium.webdriver.support.select import Select
from selenium.webdriver import ActionChains
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This error message...</p>
<pre><code>AttributeError: 'WebDriver' object has no attribute 'select_by_visible_text'
</code></pre>
<p>...implies that you have tried to use <code>select_by_visible_text()</code> through a <em>WebDriver</em> instance which is not supported.</p>
<h2>Solution</h2>
<p>To click on the item with text as <strong>Магазин детской одежды</strong> as the desired elements are <code>&lt;div&gt;</code> elements you can use the following solution:</p>
<pre><code>WebDriverWait(driver, 20).until(EC.element_to_be_clickable((By.XPATH, "//div[@class='menu menu_theme_islands menu_size_m sg-datalist menu__control i-bem sg-datalist_js_inited menu_js_inited menu__control_js_inited sg-datalist_focused menu_focused menu_hovered' and starts-with(@aria-activedescendant, 'uniq')]"))).click()
WebDriverWait(driver, 20).until(EC.element_to_be_clickable((By.XPATH, "//div[@class='menu__item menu__item_theme_islands i-bem i-bem' and text()='Магазин детской одежды']"))).click()
</code></pre>
<p><strong>Note</strong> : You have to add the following imports :</p>
<pre><code>from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.common.by import By
from selenium.webdriver.support import expected_conditions as EC
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Not sure why you did not get:</p>
<pre><code>AttributeError: 'WebDriver' object has no attribute 'select'
</code></pre>
<p>As this is not a native attribute of the selenium driver.</p>
<p>You need to import the Select Class</p>
<pre><code>from selenium.webdriver.support.ui import Select
</code></pre>
<p>Then code should look like:</p>
<pre><code>company_id = driver.find_element_by_xpath("//input[@placeholder='Начните печатать и выберите из списка']")
company_id.send_keys("Магазин детской одежды")
select = Select(yourMenuElement)
el = select.select_by_visible_text("Магазин детской одежды")

print(el.text)
</code></pre>
<p>Edit:
From your html, there is no select tag and the above might not work.</p>
<p>You could try this:</p>
<pre><code>company_id = driver.find_element_by_xpath("//input[@placeholder='Начните печатать и выберите из списка']")
input_text = "Магазин детской одежды"
company_id.send_keys(input_text)
menu = driver.find_elements_by_css_selector('[role="menuitem"]')
select_el = None
for el in menu:
    if el.text == input_text:
        select_el = el
        break
if select_el is not None:
    "Do stuff"
else:
    print("Unable to find element with tex: {}".format(input_text))
</code></pre>
</div>
<span class="comment-copy">But how can I select it in the menu?</span>
<span class="comment-copy">@PetrPetrov : Are you sure it is dropdwon menu?can i have the url?</span>
<span class="comment-copy">@PetrPetrov : updated the answer see if it helps.Index(1) is the first element in dropdown</span>
<span class="comment-copy">I have an error <code>UnexpectedTagNameException: Message: Select only works on &lt;select&gt; elements, not on &lt;div&gt;</code></span>
<span class="comment-copy">did you try option 2 which i mentioned.If above doesn't work try this</span>
<span class="comment-copy">It doesn't work: <code>UnexpectedTagNameException: Message: Select only works on &lt;select&gt; elements, not on &lt;div&gt;</code></span>
<div class="post-text" itemprop="text">
<p>I try to understand it by reading the documentation, but I still don't understand the difference between <code>recursive=True|False</code> and why do I need to write '<code>*</code>' or '<code>**</code>' in path name. </p>
</div>
<div class="post-text" itemprop="text">
<p><code>*</code> is a wildcard for file names, you can go <code>\path\*</code> to retrieve all items in <code>path</code> or <code>\path\*.txt</code> to retrieve all text files. You can also use <code>?</code> for a single character wildcard.</p>
<p>If <code>recursive</code> is set to true, <code>**</code> acts as a recursion indicator, if you use <code>\path\**\test?.*</code> it will look for any file that starts with <code>test</code> and has a single character after (e.g. test1, test2) with any extension, inside any subfolder of <code>path</code> recursively (thanks to <code>**</code>).</p>
</div>
<div class="post-text" itemprop="text">
<p><code>**</code> has recursive-directory-matching behavior when <code>recursive=True</code>. </p>
<p><code>recursive=True</code> is needed to switch <strong>ON</strong> the pattern. Otherwise, <code>**</code> is just two separate <code>*</code>, each matching zero or more characters.</p>
<p>Until recently the <code>glob</code> module did not support recursive matching and there's a lot of code out there that may have  used <code>**</code> in patterns thus the Python core developers didn't want to break such code.</p>
</div>
<div class="post-text" itemprop="text">
<p>if the path name contains only <code>*</code>, recursive is not useful; if recursive is False, <code>**</code> is no different from <code>*</code>. 
only if the path name contains <code>**</code> and recursive is True, <code>**</code> will match any files.</p>
</div>
<span class="comment-copy">glob — Unix style pathname pattern expansion. I would say you first need to understand unix style pathname to understand glob.</span>
<div class="post-text" itemprop="text">
<p>I am actually working on a Python Project where I need to animate variations over time of a concentration, to do so I need the values of my concentration at time t-1 to calculate the concentration at time t.</p>
<p>I would like the "animate" function to use the new values of n0 and n1 when being called. Presently it only uses the same values of n0 and n1 as I declared them in my initial conditions and do not take into account the changes it makes to n0 and n1 during the first plot.</p>
<p>Here is a sample of my code (K, L and M are constant floats):</p>
<pre><code># Initial conditions

n0 = f(X)
n1 = n0.copy()

n1[1:-1] = K * (n0[0:-2] - 2 * n0[1:-1] + n0[2:]) - L * (n0[2:] - n0[:-2]) + M * n0[1:-1]
n0 = n1.copy()

# Animation


fig = plt.figure()
ax = plt.axes(xlim=(-0.5, 1.3), ylim=(min(f(X)), max(f(X))), xlabel="x", ylabel="n", title="n en fonction de x")
line, = ax.plot([], [], lw=2)
time_text = ax.text(0.02, 0.95, '', transform=ax.transAxes)

def init():
    time_text.set_text('')
    line.set_data([],[])
    return line, time_text

def animate(i,n0,n1):
    n1[1:-1] = K * (n0[0:-2] - 2 * n0[1:-1] + n0[2:]) - L * (n0[2:] - n0[:-2]) + M * n0[1:-1]
    n0 = n1.copy()
    t = i * dt
    time_text.set_text('time = %f ms' % (t * 1000))
    y = n1
    line.set_data(X, y)
    return line, time_text


ani = animation.FuncAnimation(fig, animate, init_func=init, frames=nt, blit=True, interval=1, repeat=False, fargs=(n0, n1))

plt.show()
</code></pre>
<p>Hope you can help me because I am a new user of animation.Funcanimation and I do not understand everything about it.</p>
</div>
<div class="post-text" itemprop="text">
<p>A rather crude way to achieve the desired result is to use global variable</p>
<pre><code>Fmin2 = 0
Fmin1 = 1

fig,ax = plt.subplots(figsize=(4,4))
ax.set_xlim(0,200)
ax.set_ylim(0,200)
line, = ax.plot([], [], 'ro')
time_text = ax.text(0.02, 0.95, '', transform=ax.transAxes)

def init():
    global Fmin2,Fmin1
    Fmin2 = 0
    Fmin1 = 1
    time_text.set_text('')
    line.set_data([],[])
    return line, time_text

def animate(i):
    global Fmin2,Fmin1
    Fn = Fmin1+Fmin2
    Fmin2 = Fmin1
    Fmin1 = Fn
    time_text.set_text('i={:d}'.format(i))
    line.set_data([Fmin1],[Fn])
    return line, time_text


ani = animation.FuncAnimation(fig, animate, init_func=init, frames=10, blit=True)
plt.show()
</code></pre>
<p><a href="https://i.stack.imgur.com/af6t7.gif" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/af6t7.gif"/></a></p>
<p>A cleaner way would be to integrate your animation in a class, and have n0 and n1 be members of that class that are updated in the <code>animate(self, i)</code> function.</p>
</div>
<span class="comment-copy">Thank you very much, it works as expected ! But you are right, it seems a bit crude... I will try look into creating a class as you say.</span>
<div class="post-text" itemprop="text">
<p>I'm trying to test a very simple function (as a result of multiple failed attempts at testing a more complicated function which uses the argument parser as a parameter).</p>
<blockquote>
<p><em># from ./runfile.py</em></p>
</blockquote>
<pre><code>import argparse
import os


def get_input_args():
    parser = argparse.ArgumentParser()
    parser.add_argument('--priv_raw_name', default='private_data.csv', type=str,
                    help='Set raw private/source datafile name')
    args = parser.parse_args()
    return args
</code></pre>
<blockquote>
<p><em># from ./tests/test_args.py</em></p>
</blockquote>
<pre><code>import pytest
from runfile import get_input_args

def test_parser():
    parser = get_input_args()
    assert 1
</code></pre>
<p>When I run the script <code>runfile.py</code> all works as expected, however when I call <code>pytest tests/test_args.py</code> I get the unrecognised arguments error message below.</p>
<p>I've tried setting up a <code>conftest.py</code> file and using addoption but I just seem to be encountering more errors far beyond my experience to fix. Can anyone point me in the right direction of how to run the test using the default arguments from the core script but not have <code>tests/test_args.py</code> being called as an argument for the actual test itself?</p>
<pre><code>    (Project_Cascade) ➜  Project_Cascade git:(WIP) ✗ pytest tests/test_args.py
========================================================================= test session starts =========================================================================
platform darwin -- Python 3.6.5, pytest-4.3.1, py-1.8.0, pluggy-0.9.0
rootdir: /Users/davidmellor/Code/Spend_Network/Data_Projects/Project_Cascade, inifile:
collected 1 item

tests/test_args.py F                                                                                                                                            [100%]

============================================================================== FAILURES ===============================================================================
_____________________________________________________________________________ test_parser _____________________________________________________________________________

    def test_parser():
&gt;       parser = get_input_args()

tests/test_args.py:5:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
runfile.py:50: in get_input_args
    args = parser.parse_args()
/usr/local/Cellar/python/3.6.5_1/Frameworks/Python.framework/Versions/3.6/lib/python3.6/argparse.py:1733: in parse_args
    self.error(msg % ' '.join(argv))
/usr/local/Cellar/python/3.6.5_1/Frameworks/Python.framework/Versions/3.6/lib/python3.6/argparse.py:2389: in error
    self.exit(2, _('%(prog)s: error: %(message)s\n') % args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = ArgumentParser(prog='pytest', usage=None, description=None, formatter_class=&lt;class 'argparse.HelpFormatter'&gt;, conflict_handler='error', add_help=True)
status = 2, message = 'pytest: error: unrecognized arguments: tests/test_args.py\n'

    def exit(self, status=0, message=None):
        if message:
            self._print_message(message, _sys.stderr)
&gt;       _sys.exit(status)
E       SystemExit: 2

/usr/local/Cellar/python/3.6.5_1/Frameworks/Python.framework/Versions/3.6/lib/python3.6/argparse.py:2376: SystemExit
------------------------------------------------------------------------ Captured stderr call -------------------------------------------------------------------------
usage: pytest [-h] [--priv_raw_name PRIV_RAW_NAME]
pytest: error: unrecognized arguments: tests/test_args.py
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The problem comes from the <a href="https://docs.python.org/3/library/argparse.html#the-parse-args-method" rel="nofollow noreferrer"><code>parser.parse_args</code></a> call which accepts an optional <code>args</code> argument. If this argument is not provided, args are taken from <a href="https://docs.python.org/3/library/sys.html#sys.argv" rel="nofollow noreferrer"><code>sys.argv</code></a>.</p>
<p>When you execute <code>pytest tests/test_args.py</code>, <code>sys.argv</code> contains <code>['pytest', 'tests/test_args.py']</code>. The first element of the list is the called program and the second is the first argument.</p>
<p>Thus, <code>parser.parse_args</code> called without its <code>args</code> argument considers <em>tests/test_args.py</em> as the value for the first declared argument of the parser. Fortunately, it is unable to parse it and an error occurs with the explicit message <em>unrecognized arguments: tests/test_args.py</em>.</p>
<p>To check it, you can add a breakpoint in your test before calling <code>parser.parse_args</code> and inspect <code>sys.argv</code></p>
<p>Invoking <code>pytest</code> without specifying the file to run (just <code>pytest</code>) should pass with no problem.</p>
<p>Anyway, your test should pass whatever the manner it is ran. All you have to do for this is specifying explicit <code>args</code> for your <code>parser.parse_args</code> call in your test.</p>
<p>For example, passing an empty list will work:</p>
<pre><code>parser.parse_args([])
</code></pre>
<p>But you will probably want to test it with values for the <code>priv_raw_name</code> option:</p>
<pre><code>parser:parse_args(['--priv_raw_name', 'any/test/path'])
</code></pre>
</div>
<span class="comment-copy">beautifully explained, thank you so much. I ended up amending <code>def get_input_args()</code> to take 'args=None' as a parameter, and then amending the <code>parse_args()</code> line to  <code>parse_args(args)</code>, and then in the test function passing <code>[]</code> to the call to <code>get_input_args()</code>.</span>
<div class="post-text" itemprop="text">
<p>I am trying to print the following pattern:</p>
<pre><code>3 3 3 3 3
3 2 2 2 3
3 2 1 2 3
3 2 2 2 3
3 3 3 3 3
</code></pre>
<p>My python code is:</p>
<pre><code>def pattern(n):
    d = n + (n - 1)
    l = [[0 for row in range(d)] for col in range(d)]
    for a in range(0, n):
        for i in range(a, d):
            for j in range(a, d):
                l[a][i][j].append(n)
        d -= 1
        n -= 1


print(pattern(3))
</code></pre>
<p>But I am getting the following Error:</p>
<pre><code>Traceback (most recent call last):
File "test.py", line 10, in &lt;module&gt;
  print(pattern(3))
File "test.py", line 7, in pattern
  l[a][i][j].append(n)
TypeError: 'int' object is not subscriptable
</code></pre>
<p>Can anyone guide me how to overcome this?</p>
<p>Thank you in advance.</p>
</div>
<div class="post-text" itemprop="text">
<p>Just to start from your own code even if the answer is a bit late...</p>
<p>You code tries to build an array of 0, and then writes decreasing values in sub-array. Simply you wrongly copied it. It should be:</p>
<pre><code>def pattern(n):
    d = n + (n - 1)
    l = [[0 for row in range(d)] for col in range(d)]
    for a in range(0, n):
        for i in range(a, d):
            for j in range(a, d):
                l[i][j]=n
        n -= 1
        d -= 1
    return l
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Because it's somewhat hard to understand how your code is supposed to do what it should (sorry!), here's a pretty Pythonic way to generate a matrix like this as a generator function.</p>
<pre class="lang-py prettyprint-override"><code>def pattern(n):
    size = n * 2 - 1
    n_1 = n - 1
    for y in range(size):
        yield [max(abs(x - n_1), abs(y - n_1)) + 1 for x in range(size)]
</code></pre>
<p>The idea is that we look at the "distance" of the cell we're generating from <code>n - 1</code>, which must be the center point of the grid (which is <code>n * 2 - 1</code> items wide and tall).</p>
<p>As it's a generator function, you can get a list-of-lists out of it by calling e.g. <code>list(pattern(size))</code>.</p>
<p>Here's an example program –</p>
<pre><code>for size in range(1, 6):
    print(size)
    for row in pattern(size):
        print(row)
</code></pre>
<p>– and its output:</p>
<pre><code>1
[1]
2
[2, 2, 2]
[2, 1, 2]
[2, 2, 2]
3
[3, 3, 3, 3, 3]
[3, 2, 2, 2, 3]
[3, 2, 1, 2, 3]
[3, 2, 2, 2, 3]
[3, 3, 3, 3, 3]
4
[4, 4, 4, 4, 4, 4, 4]
[4, 3, 3, 3, 3, 3, 4]
[4, 3, 2, 2, 2, 3, 4]
[4, 3, 2, 1, 2, 3, 4]
[4, 3, 2, 2, 2, 3, 4]
[4, 3, 3, 3, 3, 3, 4]
[4, 4, 4, 4, 4, 4, 4]
5
[5, 5, 5, 5, 5, 5, 5, 5, 5]
[5, 4, 4, 4, 4, 4, 4, 4, 5]
[5, 4, 3, 3, 3, 3, 3, 4, 5]
[5, 4, 3, 2, 2, 2, 3, 4, 5]
[5, 4, 3, 2, 1, 2, 3, 4, 5]
[5, 4, 3, 2, 2, 2, 3, 4, 5]
[5, 4, 3, 3, 3, 3, 3, 4, 5]
[5, 4, 4, 4, 4, 4, 4, 4, 5]
[5, 5, 5, 5, 5, 5, 5, 5, 5]
</code></pre>
<hr/>
<p>EDIT: As requested in comments, here's a simplified version which is not a generator function and doesn't use list comprehensions:</p>
<pre class="lang-py prettyprint-override"><code>def pattern_simple(n):
    size = n * 2 - 1
    n_1 = n - 1
    rows = []
    for y in range(size):
        row = []
        for x in range(size):
            row.append(max(abs(x - n_1), abs(y - n_1)) + 1)
        rows.append(row)
    return rows
</code></pre>
</div>
<span class="comment-copy">what are you expecting <code>l[a][i][j]</code> to do?</span>
<span class="comment-copy">Look at the dimensions of <code>l</code></span>
<span class="comment-copy">@Phydeaux I am appending n value to list l using the index values.</span>
<span class="comment-copy">@MohanKumarsajjamoka you aren't appending to <code>l</code>, you are trying to append to <code>l[a][i][j]</code>. But <code>l</code> is a list of lists of integers, so <code>l[a][i][j]</code> throws an exception</span>
<span class="comment-copy">@Phydeaux Thanks for your clarification.</span>
<span class="comment-copy">Thank you very much for your answer. But here my question is why you are assigning n instead of append. I though " l " is a list here right.!</span>
<span class="comment-copy">@MohanKumarsajjamoka <code>l</code> is indeed a list, as is <code>l[i]</code>. But as <code>l</code> was built with 2 dimensions, <code>l[i][j]</code> is a scalar...</span>
<span class="comment-copy">Sorry to asking you this. I dont know about the scalar in python. May be outside of python also. Will you please explain it to me ?</span>
<span class="comment-copy">@MohanKumarsajjamoka: a scalar is a raw number and not an array, list or vector</span>
<span class="comment-copy">Thanks you man.</span>
<span class="comment-copy">Thanks @AKX. Is there any simple way, I mean that list comprehension is confusing me.</span>
<span class="comment-copy">@MohanKumarsajjamoka Sure, I added a simplified version in an edit. :)</span>
<span class="comment-copy">Thanks You very much @AKX</span>
<div class="post-text" itemprop="text">
<p>I need to print the real local time in this exact string format: "<code>20190320130348</code>". (Year,Month,Day,Hour,Min,Secs).</p>
<p>I found several posts presenting how to print the real local time with the <code>time</code> library, but I don't know how to edit it accordingly so I can get this exact format.</p>
</div>
<div class="post-text" itemprop="text">
<p>Using <a href="https://docs.python.org/3.3/library/time.html?highlight=time.strftime#time.strftime" rel="nofollow noreferrer"><code>time.strftime</code></a>:</p>
<pre><code>from time import gmtime, strftime
print(strftime("%Y%m%d%H%M%S", gmtime())) 
</code></pre>
<p><strong>OUTPUT</strong>:</p>
<pre><code>20190320111020
</code></pre>
<p><strong>EDIT</strong>:</p>
<pre><code>print(strftime("%Y-%m-%d %H:%M:%S", gmtime()))  # for readability
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use <code>datetime</code>:</p>
<pre><code>from datetime import datetime
print(datetime.now().strftime('%Y%m%d%H%M%S'))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can achieve that using <code>datetime</code></p>
<pre><code>#import module
import datetime
#get current date and time as a string
now = str(datetime.datetime.now)
#replace what ever you need
now = now.replace("-","").replace(" ","").replace(":","").replace(".","")
</code></pre>
<p>e.g:</p>
<pre><code>now = str(datetime.datetime.now())
print(now)
</code></pre>
<p>prints out :
<code>2019-03-20 13:15:56.469000</code></p>
<p>after manipulation:</p>
<p><code>20190320131556469000</code></p>
</div>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/13546936/how-do-i-strtotime-in-python">How do I strtotime in python?</a></span>
<div class="post-text" itemprop="text">
<p>I just started to code in Flask swagger backend. When I tried to extract multiple paths and the argument parameters, an error occurs, says:</p>
<pre><code>TypeError: get() missing 1 required positional argument: 'q'
</code></pre>
<p>But actually, my "get()" function <strong>has</strong> the positional argument 'q'. I may ask why this error occurs? That could be weird since I use</p>
<pre><code>request.arg.get('q')
</code></pre>
<p>it works good and can returns the expected query argument.</p>
<p>The expected API paths is:</p>
<pre><code>GET 127.0.0.1:8888/book/1?q=question20
</code></pre>
<p>and my code is here:</p>
<pre><code>from flask import Flask, request
from flask_restplus import Resource, Api

app = Flask(__name__)
api = Api(app)


@api.route("/&lt;string:resource&gt;/&lt;int:rid&gt;")
@api.doc(params={'q': 'Your query here'})
class API(Resource):
    def get(self, resource, rid, q):
        return {"resource": resource,
                "id": rid,
                "query": q
                }, 200


if __name__ == "__main__":
    app.run(host='127.0.0.1', port=8888, debug=True)
</code></pre>
<p>I would appreciate if someone can help me solve this problem.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <code>api.parser()</code> to document and capture query parameters</p>
<pre><code>parser = api.parser()
parser.add_argument('q', type=str, help='Resource name', location='args')

@api.route("/&lt;string:resource&gt;/&lt;int:rid&gt;")
@api.doc(parser=parser)
class API(Resource):
    def get(self, resource, rid):

        args = parser.parse_args()
        q = args['q']

        return {"resource": resource,
                "id": rid,
                "q":q,
                }, 200
</code></pre>
<p>This method is marked as deprecated <a href="https://flask-restplus.readthedocs.io/en/stable/parsing.html" rel="nofollow noreferrer">https://flask-restplus.readthedocs.io/en/stable/parsing.html</a></p>
</div>
<span class="comment-copy">Thank you Adrian. This method works.</span>
<div class="post-text" itemprop="text">
<p>I have a pandas DataFrame that contains looks like this:</p>
<pre><code>A         A_type
"Hello"   String
15        Integer
"Hi"      String
56.78     Float
</code></pre>
<p>I want to create a third column that reports the same value as A if A has the corresponding "A_type" element named "String", print "blank" otherwise. The column would look like:</p>
<pre><code>B
"Hello"
"blank"
"Hi"
"blank"
</code></pre>
<p>I tried doing something like:</p>
<pre><code>df['B'] = df['A']
for j in df['A_type']:
    for i in df['B']:
            if j == "String":
                i = i
            else:
                i = "blank"
</code></pre>
<p>Is there any more effective approach to such problem that can help me avoid all these for loops? </p>
<p>Thanks a lot in advance</p>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.where.html" rel="nofollow noreferrer"><code>Series.where</code></a> or 
<a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.mask.html" rel="nofollow noreferrer"><code>Series.mask</code></a> with inverted condition, or <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html" rel="nofollow noreferrer"><code>numpy.where</code></a>:</p>
<pre><code>df['B'] = df['A'].where(df['A_type'] == "String", 'blank')
#df['B'] = df['A'].mask(df['A_type'] != "String", 'blank')
#alternative
#df['B'] = np.where(df['A_type'] == "String", df['A'], 'blank')
print (df)
       A   A_type      B
0  Hello   String  Hello
1     15  Integer  blank
2     Hi   String     Hi
3  56.78    Float  blank
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Also you can try:</p>
<pre><code>df['B'] = df.apply(lambda x: x['A'] if x['A_type'] == 'String' else "Blank", axis = 1)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>df['B']=df['A'].copy()
df.loc[df['A_type']!="String", 'B'] = "blank"
</code></pre>
<p>O/P:</p>
<pre><code>       A  A_type      B
0  Hello  String  Hello
1  blank   blank  blank
2     Hi  String     Hi
3  blank   blank  blank
</code></pre>
<p>explanation:</p>
<ol>
<li>Take a copy of <code>Col A</code></li>
<li>only update the value to <code>blank</code> where <code>A_Type</code> is not <code>String</code></li>
</ol>
</div>
<span class="comment-copy">Dont use apply, because loops under the hood, especially if exist vectorized alternatives.</span>
<span class="comment-copy">Because it is slow in large dataframes</span>
<span class="comment-copy">Ok, Thanks. I'll try to modify making it consistent with large df.</span>
<span class="comment-copy">@DebanjanB - Added, thanks for the comment, I would consider this in futurte :)</span>
<div class="post-text" itemprop="text">
<p>I'm trying to speed up calculations for extensive real time object detection and doing computation on it.</p>
<p>I'm using OpenCV with thread pool and producer, consumer for the video capture. But the execution speed is the same as the serial one. </p>
<p>How would I improve the speed of the execution ?</p>
<pre><code>if __name__ == "__main__":
    video_name = '2016-11-18_07-30-01.h264'

    cap = cv2.VideoCapture(video_name)

    det = detector.CarDetector()
    car_tracker = Sort_Algorithm.Sort()
    ped_tracker = Sort_Algorithm.Sort()
    df_region, df_line = load_filter()
    region = Region(df_region)
    distance = compute_max_polygon_diagonal(df_region) * 0.1
    region_buffered = region.buffer(distance)

    threadn = cv2.getNumberOfCPUs()
    pool = ThreadPool(processes = 2)
    pending = deque()
    threaded_mode = True
    lock = threading.Lock()
    while True:
        while len(pending) &gt; 0 and pending[0].ready():
            res = pending.popleft().get()
            cv2.imshow('video ', res)

        if  len(pending) &lt; threadn:
            ret, frame = cap.read()
            if threaded_mode:
                t1 = time.time()
                H = [-2.01134074616, -16.6502442427, -1314.05715739, -3.35391526592, -22.3546973012, 2683.63584335,
                     -0.00130731963137, -0.0396207582264, 1]
                matrix = np.reshape(H, (3, 3))
                dst = cv2.warpPerspective(frame.copy(), matrix, (frame.shape[1], frame.shape[0]))
                task = pool.apply_async(pipeline, (lock, frame.copy(),car_tracker, ped_tracker,df_region,region_buffered, df_line, det, dst, matrix))

                cv2.imshow('dst', dst)
            else:
                task = DummyTask(pipeline,(lock, frame.copy(),car_tracker, ped_tracker,df_region, region_buffered, df_line, det, dst, matrix))

            pending.append(task)
        ch = cv2.waitKey(1)
        if ch == ord(' '):
            threaded_mode = not threaded_mode
        if ch == 27:
            break
</code></pre>
<p>The code for pipeline:</p>
<pre><code>def pipeline(lock, img, car_tracker, ped_tracker, df_region, region_buffered, df_line, det, dst, H):
    lock.acquire()
    global point_lists
    global df_car_lists
    global frame_idx
    global counter
    global  data_peds
    global  data_cars
    global  genera_data_pd_cars
    global  genera_data_pd_peds

    car_box, ped_box = det.get_localization(img)
    car_detections = car_tracker.update(np.array(car_box))
    ped_detections = ped_tracker.update(np.array(ped_box))
    saved_region = df_region.values
    saved_region = np.delete(saved_region, 2, 1)
    frame_idx+=1
    cv2.warpPerspective(np.array(df_line, dtype=np.float32), H, (df_line.shape[1], df_line.shape[0]))

    cv2.polylines(dst, np.int32([[saved_region]]), False, color=(255, 0, 0))
    cv2.polylines(dst, np.int32([np.array(df_line, dtype=np.float32)]), False, color=(255, 0, 0))

    for trk in car_detections:
        trk = trk.astype(np.int32)
        helpers.draw_box_label(img, trk, trk[4])  # Draw the bounding boxes on the

    for other in ped_detections:
            other = other.astype(np.int32)
            helpers.draw_box_label(img, other, other[4])  # Draw the bounding boxes on the

    for trk in car_detections:
        trk = trk.astype(np.int32)
        p = np.array([[((trk[1] + trk[3]) / 2,  (trk[0] + trk[2]) / 2)]], dtype=np.float32)
        center_pt = cv2.perspectiveTransform(p, H)
        ptx = center_pt.T.item(0)
        pty = center_pt.T.item(1)
        df_cars = compute(trk[4], ptx, pty, frame_idx, df_region, region_buffered, df_line)
        genera_data_pd_cars = genera_data_pd_cars.append(df_cars)
        for other in ped_detections:
            other = other.astype(np.int32)
            p = np.array([[((other[1] + other[3]) / 2, (other[0] + other[2]) / 2)]], dtype=np.float32)
            center_pt = cv2.perspectiveTransform(p, H)
            ptx = center_pt.T.item(0)
            pty = center_pt.T.item(1)
            df_peds = compute(other[4], ptx, pty, frame_idx, df_region, region_buffered, df_line)
            genera_data_pd_peds = genera_data_pd_cars.append(df_peds)
            query = "is_in_region == True and is_in_region_now == True"
            df_peds = genera_data_pd_peds.query(query)
            query = " is_in_region == True"
            df_cars = genera_data_pd_cars.query(query)
            if len(df_cars)&gt; 1 and len(df_peds) &gt; 1:

                df_car_in_t_range_ped = select_slice(df_cars, df_peds)
                df_ped_in_t_range_car = select_slice(df_peds, df_cars)
                t_abs_crossing_car = df_cars['t_abs_at_crossing'].iloc[0]
                t_abs_crossing_ped = df_peds['t_abs_at_crossing'].iloc[0]

                dt_crossing = t_abs_crossing_car - t_abs_crossing_ped

                is_able_to_pass_before_ped = \
                    ((df_car_in_t_range_ped['t_abs_at_crossing_estimated'] -
                      t_abs_crossing_ped) &gt; 0).any()

                behavior = Behavior(  # is_passed_before_ped
                    dt_crossing &lt; 0,
                    # is_able_to_stop
                    df_car_in_t_range_ped['is_able_to_halt'].any(),
                    # is_too_fast
                    df_car_in_t_range_ped['is_too_fast'].any(),
                    # is_close_enough
                    df_car_in_t_range_ped['is_close_enough'].any(),
                    # is_able_to_pass_before_ped
                    is_able_to_pass_before_ped)

                interaction = Interaction(trk[4], other[4])
                interaction = interaction.assess_behavior(behavior)
                code, res, msg = interaction.code, interaction.res, interaction.msg
                print(msg)
                genera_data_pd_cars = genera_data_pd_cars.iloc[0:0]
                genera_data_pd_peds = genera_data_pd_peds.iloc[0:0]
    lock.release()
    return img
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Multi-threading in python for CPU bound tasks is limited by GIL and effectively makes single thread run a time.</p>
<p>Ofcourse if you launch multiple threads for CPU bound tasks the performance is going to be even degraded because there is lot of overhead for both for kernel and python interpreter to manage these threads.</p>
<p>Kernel wants to schedule these threads and python wants to restrict these threads from running simultaneous and this results lot of context switches happening which degrades the performance.</p>
<p>If you are using just <code>numpy</code> in the threads then you would be fine as <code>numpy</code> isn't impacted by <code>GIL</code> since it uses atomic operations, but I am not sure if that is true for <code>OpenCV</code> as well. </p>
<p>Threads in python arn't meant for computation tasks.</p>
<p>This is classic problem of threads with python, consider using <code>multiprocessing</code> and there are number of articles on this topic, you might want to check few of them.</p>
</div>
<div class="post-text" itemprop="text">
<p>Threads aren't executed in parallel in cpython. Try using the ProcessPoolExecutor instead.</p>
</div>
<span class="comment-copy">I have problems with picklable objects I couldn't use it</span>
<span class="comment-copy">As mentioned in the answer, you should <i>NOT</i> be using threads for computation. You are never going to get expected results.</span>
<span class="comment-copy">I mean I can't use multiprocessing, I get a lot of errors like thread lock key is not picklable</span>
<span class="comment-copy">I have problems with picklable objects I couldn't use it</span>
<span class="comment-copy">Do you know how to modify the code to work with ProcessPoolExecutor ? What needs to be changed ?</span>
<span class="comment-copy">I get this can't pickle _thread.RLock objects</span>
<span class="comment-copy">I'm not 100% sure myself, there seem to be other answers to the pickle problem <a href="https://stackoverflow.com/a/1816969/7062162">stackoverflow.com/a/1816969/7062162</a> . But you're also using a lock to access shared data, which I think is also not allowed with processes, because processes can't share data. If the processes don't work out for you, you might also consider asyncio.</span>
<span class="comment-copy">I use tensorflow so it has an issue too</span>
<div class="post-text" itemprop="text">
<p>I am trying to use pandas to read a csv file which is in a sunfolder of the current folder. I am on a Windows PC.</p>
<p>If I run:</p>
<pre><code>df=pd.read_csv("subfolder//file.csv") 
</code></pre>
<p>I get:</p>
<blockquote>
<p>UnicodeDecodeError: 'utf-8' codec can't decode byte 0xb2 in position
  16: invalid start byte</p>
</blockquote>
<p>If I run:</p>
<pre><code>df=pd.read_csv("subfolder//file.csv", engine='python')
</code></pre>
<p>It works.</p>
<ul>
<li><p>Why????</p></li>
<li><p>Isn't there a way to use c as the engine? It's meant to be faster</p></li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>This might be because read_csv is trying to read the file in "UTF-8" format while your file is clearly in a different format. To detect the encoding in Windows, you can look at this.
<a href="https://stackoverflow.com/questions/3710374/get-encoding-of-a-file-in-windows">Get encoding of a file in Windows</a></p>
<p>After you found out the file's encoding format, you can give an argument of the encoding type to the read_csv function. e.g.</p>
<pre><code>df=pd.read_csv("subfolder//file.csv", encoding="utf-8") 
</code></pre>
</div>
<span class="comment-copy">Could you csv file contain a SUPERSCRIPT TWO character U+00B2 <code>²</code>? If the answer is yes, it is probably Latin1 or cp1252 encoded...</span>
<span class="comment-copy">So this means that engine='c' causes encoding to default to 'utf-8', while engine='python' means a different encoding? I double checked <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_csv.html" rel="nofollow noreferrer">pandas.pydata.org/pandas-docs/stable/reference/api/…</a> and none of this seems to be documented explicitly - as is unfortunately all too common in the beautiful world of Python...</span>
<span class="comment-copy">@Pythonistaanonymous I don't know about the current situation explicitly, but the error you are getting is an error of encoding conflict, and I suspect this might be the case. Have you checked your file's encoding yet?</span>
<span class="comment-copy">Yes, if I set encoding='latin1' it works. Thanks for the help. PS still frustrated at the how much documentation sucks in the world of Python!</span>
<div class="post-text" itemprop="text">
<p>I have the following Spark SQL code that checks the absence of certain dates in large tables (several billion rows):</p>
<pre><code>spark = SparkSession.builder \
    .master("yarn") \
    .appName("minimal_example") \
    .config('spark.submit.deployMode', 'client') \
    .getOrCreate()

SQL = '''
select distinct
  substr(entrydate, 1, 10) as datum,
  1 as in_table
from {table}
where entrydate &gt;= '{datum}'
'''

print("RUN1")
df1 = spark.sql(SQL.format(datum='2017-01-01', table='table1'))
c1 = df1.count()
print("count1: ", c1)

print("RUN2")
df2 = spark.sql(SQL.format(datum='2017-01-01', table='table2'))
c2 = df2.count()
print("count2: ", c2)
</code></pre>
<p>Essentially, the function is simply getting the distinct dates from a table column.</p>
<p>Now the part I can't wrap my head around:</p>
<ul>
<li>Each call to <code>count()</code> on its own runs fine</li>
<li>When I run each call as a separate <code>spark-submit</code> job, it works fine</li>
<li>But if run them in succession like above, the second run produces the following error:</li>
</ul>
<pre><code>py4j.protocol.Py4JJavaError: An error occurred while calling o150.sql.
: java.util.concurrent.ExecutionException: java.io.IOException: com.google.protobuf.ServiceException: java.lang.OutOfMemoryError: GC overhead limit exceeded
</code></pre>
<p>My interpretation is that the garbage collection from the first run kicks in during the second run.</p>
<p>What I have tried:</p>
<ol>
<li>Call spark.clearCache() at the beginning of each iteration</li>
<li>Call <code>spark._jvm.SparkSession.clearDefaultSession()</code>, <code>spark._jvm.SparkSession.clearActiveSession()</code> at the beginning of each iteration</li>
<li>Look at the Spark web UI and try to get sense out of the DAG and Storage tabs (the latter one does not display anything) to no avail</li>
<li>Change the order of the two <code>count</code>s. This results in a different error: <code>java.io.IOException: Connection reset by peer</code> (see <a href="https://stackoverflow.com/questions/39347392/how-to-fix-connection-reset-by-peer-message-from-apache-spark">here</a> for a similar error)</li>
</ol>
<p>One last observation: The first call spins up &gt;100 Spark/YARN executors, maybe Spark's dynamic allocation mechanism does not like that the second call is effectively a new job that has different requirements for executors?</p>
<p>Any help is much appreciated!</p>
<p>Environment: Spark 2.3 on Cloudera CDH 6.1 cluster.</p>
<h3>Edit: Some more details</h3>
<ul>
<li>The tables are persisted as Parquet files in HDFS, stats:</li>
</ul>
<pre><code>   +--------+------------+-------+--------+--------------+
   | table  |   # rows   |# cols |# files |   raw size   |
   +--------+------------+-------+--------+--------------+
   | table1 | 5660970439 |    46 |  49167 | 228876171398 |
   | table2 | 5656000217 |    52 |  80000 | 518996700170 |
   +--------+------------+-------+--------+--------------+
</code></pre>
<ul>
<li>Memory settings: Spark on YARN with dynamic allocation, min executor memory is 1GB, max is 72 GB, total cluster memory is ~300GB.</li>
<li>The first <code>count()</code> spins up about 150 executors, fully utilizing the currently available memory resources</li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>After letting the problem sink in for a few days, I just tried increasing the <em>driver</em> memory:</p>
<p><code>spark2-submit --master yarn --deploy-mode client --driver-memory 4G minimal_example.py</code></p>
<p>Maybe the deciding factor was that my application is started in <code>client</code> mode. Apparently, the management of a large number of executors (and their removal) costs quite a lot of memory, even though the driver itself only receives the result of a simple <code>df.count()</code>.</p>
</div>
<span class="comment-copy">Could you try to persist after edates after join with dates? Also one more thing, how big can date_whitelist be?</span>
<span class="comment-copy">Hi @AlexandrosBiratsis, I reduced my question to a minimal example, where no join is needed. The <code>whitelist</code> parameter in the previous version of my question was of size 1-3, so I don't think that had any effect.</span>
<span class="comment-copy">What are the rough size of the tables you are acting on and what is the memory settings you are placing on driver and executor?</span>
<span class="comment-copy">@afeldman I've added some meta info. Memory is requested dynamically by Spark and managed by YARN.</span>
<div class="post-text" itemprop="text">
<p>I am trying to overlap a sns boxplot with a line x=y</p>
<pre><code>import seaborn as sns
import pandas

df = pandas.DataFrame(data=[[0,2,3,4],[33,12,34]],columns=['1','2','4','6'])
sns.boxplot(data=df)
sns.lineplot(x=df.columns.astype(int), y=df.columns.astype(int))
</code></pre>
<p>the result is not what I expected 
<a href="https://i.stack.imgur.com/FEqG0.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/FEqG0.png"/></a></p>
<p>as you can see the x=y line does not pass from (1,1) (2,2) (4,4) (6,6).</p>
<p>Any idea how to fix this?</p>
</div>
<div class="post-text" itemprop="text">
<p>IIUC, use:</p>
<pre><code>import seaborn as sns
import pandas
import numpy as np

df = pandas.DataFrame(data=[[0,2,3,4],[33,12,34]],columns=['1','2','4','6'])
sns.boxplot(data=df)
sns.lineplot(x=np.arange(len(df.columns)), y=df.columns.astype(int))
</code></pre>
</div>
<span class="comment-copy">The line is passing through <code>(1,1) (2,2) (4,4) (6,6)</code>... The string ticklabels <code>1 2 4 6</code> along your xaxis are actually the x coords <code>[0, 1, 2, 3]</code>. What is your desired output?</span>
<span class="comment-copy">IIUC in <code>lineplot</code> set <code>x=np.arange(len(df.columns))</code></span>
<div class="post-text" itemprop="text">
<p>I have recently switched from Chrome to Firefox and one of my programs that I use to generate a random song from a playlist has stopped working. This was the code that I used when I used Chrome (instead of firefox_path it said chrome_path). Is there something about Firefox that makes this not work or have I made a mistake in my code that I can't see?</p>
<pre><code>import webbrowser as web
import secrets
firefox_path = 'C:\Program Files (x86)\Mozilla Firefox\firefox.exe %s'
ytplaylist = [elem1, elem2, elem3]
B64Code = secrets.choice(ytplaylist)
vid = 'youtube.com/watch?v=' + B64Code
web.get(firefox_path).open(vid)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Ok, escape (the backslashes) and quote (the command with spaces inside), then it works:</p>
<pre><code>firefox_path = '"C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe" %s'
</code></pre>
<p>My complete test looks like this:</p>
<pre><code>import webbrowser as web
firefox_path = '"C:\\Program Files (x86)\\Mozilla Firefox\\firefox.exe" %s'
vid = 'youtube.com/watch?v=f4f1TT3B--Y'
web.get(firefox_path).open(vid)
</code></pre>
</div>
<span class="comment-copy">You could try it from the command line first. From the top of my head: I would check what happens if you add <code>http://</code> or <code>https://</code> in front of the URL.</span>
<span class="comment-copy">Adding https:// or http:// didn't change anything. how would I go about doing this from the command line? I need the %s or it says: raise Error("could not locate runnable browser") webbrowser.Error: could not locate runnable browser</span>
<span class="comment-copy">As the documentation says, <i>When the value of a list part contains the string %s, then it is interpreted as a literal browser command line to be used with the argument URL substituted for <code>%s</code></i>. So it is going to be end up as <code>C:\Program Files (x86)\Mozilla Firefox\firefox.exe youtube.com/watch?v=something</code>. You can try if FF would launch the video correctly when issuing this command from a <code>cmd</code> window.</span>
<div class="post-text" itemprop="text">
<p>I'm trying to filter multiple columns with 1 QLineEdit box in a QTableView. I'm using a QAbstractTableModel to do the filtering and I've subclassed QSortFilterProxyModel to handle multiple columns. The data is pulled from a xlsx file and loaded into a dataframe using pandas.</p>
<p>So my code is working, as long as the headers in the excel file are numerical (0, 1, 2..etc). In the pandas to_excel function there's a flag to prevent pandas from adding it's own 'header' and index' labels header=none and index=none respectively. So when I set the headers to none I get this error when populating the QTableView</p>
<pre><code>TypeError: 'PySide2.QtCore.QRegExp.indexIn' called with wrong argument types:
  PySide2.QtCore.QRegExp.indexIn(int)
Supported signatures:
  PySide2.QtCore.QRegExp.indexIn(str, int = 0, PySide2.QtCore.QRegExp.CaretMode = PySide2.QtCore.QRegExp.CaretMode.CaretAtZero)
</code></pre>
<p>Here's my custom 'filterAcceptsRow' function:</p>
<pre><code>def filterAcceptsRow(self, sourceRow, sourceParent):
    index0 = self.sourceModel().index(sourceRow, 0, sourceParent)
    index1 = self.sourceModel().index(sourceRow, 1, sourceParent)
    index2 = self.sourceModel().index(sourceRow, 2, sourceParent)
    # The following line causes the error
    return ((self.filterRegExp().indexIn(self.sourceModel().data(index0, self.role)) &gt;= 0
             or self.filterRegExp().indexIn(self.sourceModel().data(index1, self.role)) &gt;= 0
            or self.filterRegExp().indexIn(self.sourceModel().data(index2, self.role)) &gt;= 0))
</code></pre>
<p>Here's a working example of my code</p>
<pre><code>from pandas import DataFrame, ExcelFile, Series
from PySide2.QtWidgets import QApplication, QTabWidget, QVBoxLayout, QAbstractItemView, QSizePolicy, QAbstractScrollArea, QHeaderView, QTableView, QMainWindow, QGridLayout, QLineEdit, QWidget
from PySide2.QtCore import Qt, QAbstractTableModel, QSortFilterProxyModel, QModelIndex, QRegExp, QDate, QDateTime


class PandasModel(QAbstractTableModel):

    def __init__(self, data, parent=None):
        QAbstractTableModel.__init__(self, parent)
        self._filters = {}
        self._sortBy = []
        self._sortDirection = []
        self._dfSource = data
        self._dfDisplay = data
        self._dfDisplay = self._dfDisplay.fillna("")

    def rowCount(self, parent=QModelIndex()):
        if parent.isValid():
            return 0
        return self._dfDisplay.shape[0]

    def columnCount(self, parent=QModelIndex()):
        if parent.isValid():
            return 0
        return self._dfDisplay.shape[1]

    def data(self, index, role):
        if index.isValid() and role == Qt.DisplayRole:
            return self._dfDisplay.values[index.row()][index.column()]
        return None

    def headerData(self, col, orientation=Qt.Horizontal, role=Qt.DisplayRole):
        if orientation == Qt.Horizontal and role == Qt.DisplayRole:
            return str(self._dfDisplay.columns[col])
        return None

    def setupModel(self, header, data):
        self._dfSource = DataFrame(data, columns=header)
        self._sortBy = []
        self._sortDirection = []
        self.setFilters({})

    def setFilters(self, filters):
        self.modelAboutToBeReset.emit()
        self._filters = filters
        print(filters)
        self.updateDisplay()
        self.modelReset.emit()

    def sort(self, col, order=Qt.AscendingOrder):
        # Storing persistent indexes
        self.layoutAboutToBeChanged.emit()
        oldIndexList = self.persistentIndexList()
        oldIds = self._dfDisplay.index.copy()
        # Sorting data
        column = self._dfDisplay.columns[col]
        ascending = (order == Qt.AscendingOrder)
        if column in self._sortBy:
            i = self._sortBy.index(column)
            self._sortBy.pop(i)
            self._sortDirection.pop(i)
        self._sortBy.insert(0, column)
        self._sortDirection.insert(0, ascending)
        self.updateDisplay()
        # Updating persistent indexes
        newIds = self._dfDisplay.index
        newIndexList = []
        for index in oldIndexList:
            id = oldIds[index.row()]
            newRow = newIds.get_loc(id)
            newIndexList.append(self.index(newRow, index.column(), index.parent()))
        self.changePersistentIndexList(oldIndexList, newIndexList)
        self.layoutChanged.emit()
        self.dataChanged.emit(QModelIndex(), QModelIndex())

    def updateDisplay(self):
        dfDisplay = self._dfSource.copy()
        # Filtering
        cond = Series(True, index=dfDisplay.index)
        for column, value in self._filters.items():
            cond = cond &amp; \
                   (dfDisplay[column].str.lower().str.find(str(value).lower()) &gt;= 0)
        dfDisplay = dfDisplay[cond]
        # Sorting
        if len(self._sortBy) != 0:
            dfDisplay.sort_values(by=self._sortBy, ascending=self._sortDirection, inplace=True)
        # Updating
        self._dfDisplay = dfDisplay

class SortFilterProxyModel(QSortFilterProxyModel):
    def __init__(self, data, parent=None):
        super(SortFilterProxyModel, self).__init__(parent)
        self.role = Qt.DisplayRole
        self.minDate = QDate()
        self.maxDate = QDate()
        self.__data = data

    def setFilterMinimumDate(self, date):
        self.minDate = date
        self.invalidateFilter()

    def filterMinimumDate(self):
        return self.minDate

    def setFilterMaximumDate(self, date):
        self.maxDate = date
        self.invalidateFilter()

    def filterMaximumDate(self):
        return self.maxDate

    def filterAcceptsRow(self, sourceRow, sourceParent):
        index0 = self.sourceModel().index(sourceRow, 0, sourceParent)
        index1 = self.sourceModel().index(sourceRow, 1, sourceParent)
        index2 = self.sourceModel().index(sourceRow, 2, sourceParent)
        return ((self.filterRegExp().indexIn(self.sourceModel().data(index0, self.role)) &gt;= 0 or self.filterRegExp().indexIn(self.sourceModel().data(index1, self.role)) &gt;= 0 or self.filterRegExp().indexIn(self.sourceModel().data(index2, self.role)) &gt;= 0))

    def lessThan(self, left, right):
        leftData = self.sourceModel().data(left, self.role)
        rightData = self.sourceModel().data(right, self.role)

        if not isinstance(leftData, QDate):
            emailPattern = QRegExp("([\\w\\.]*@[\\w\\.]*)")

            if left.column() == 1 and emailPattern.indexIn(leftData) != -1:
                leftData = emailPattern.cap(1)

            if right.column() == 1 and emailPattern.indexIn(rightData) != -1:
                rightData = emailPattern.cap(1)

        return leftData &lt; rightData

    def dateInRange(self, date):
        if isinstance(date, QDateTime):
            date = date.date()

        return ((not self.minDate.isValid() or date &gt;= self.minDate)
                and (not self.maxDate.isValid() or date &lt;= self.maxDate))

class PerfSearchTest(QMainWindow):
    def __init__(self):
        super().__init__()
        self.path_to_local_spreadsheet = "output.xlsx"
        self.spreadsheet_display = {}
        self.searches = {}
        self.current_tab_layout = {}
        self.tab_widget = {}
        self.central_widget = QWidget()
        self.tabs = QTabWidget()
        self.layout_grid = QGridLayout(self)
        self.layout_grid.setSpacing(10)
        self.populate_spreadsheet_table()
        self.layout_grid.addWidget(self.tabs, 0, 0)
        self.central_widget.setLayout(self.layout_grid)
        self.setCentralWidget(self.central_widget)

    def onTextChanged(self, text):
        self.proxyModelContact.setFilterRegExp(QRegExp(text, Qt.CaseInsensitive, QRegExp.FixedString))

    def populate_spreadsheet_table(self):
        opened_excel_flie_dataframe = ExcelFile(self.path_to_local_spreadsheet)
        opened_excel_file_dataframe_worksheets = []
        for y, sheet in enumerate(opened_excel_flie_dataframe.sheet_names):
            df = opened_excel_flie_dataframe.parse(y)
            self.tab_widget[y] = QWidget()
            self.searches[y] = QLineEdit(sheet)
            self.spreadsheet_display[y] = QTableView()
            self.spreadsheet_display[y].setSortingEnabled(True)
            self.spreadsheet_display[y].setEditTriggers(QAbstractItemView.NoEditTriggers)
            self.spreadsheet_display[y].setAlternatingRowColors(True)
            self.spreadsheet_display[y].horizontalHeader().setSectionResizeMode(QHeaderView.Stretch)
            self.spreadsheet_display[y].verticalHeader().setSectionResizeMode(QHeaderView.ResizeToContents)
            self.spreadsheet_display[y].setSizeAdjustPolicy(QAbstractScrollArea.AdjustToContents)
            self.spreadsheet_display[y].setSizePolicy(QSizePolicy.Minimum, QSizePolicy.Expanding)
            self.spreadsheet_display[y].resizeColumnsToContents()
            self.current_tab_layout[y] = QVBoxLayout()
            self.current_tab_layout[y].addWidget(self.searches[y])
            self.current_tab_layout[y].addWidget(self.spreadsheet_display[y])
            self.proxyModelContact = SortFilterProxyModel(df)
            self.proxyModelContact.setSourceModel(PandasModel(df))
            self.searches[y].textChanged.connect(self.onTextChanged)
            self.spreadsheet_display[y].setModel(self.proxyModelContact)
            self.tab_widget[y].setLayout(self.current_tab_layout[y])
            opened_excel_file_dataframe_worksheets.append(df)
            self.tabs.addTab(self.tab_widget[y], sheet)


if __name__ == "__main__":
    app = QApplication()
    w = PerfSearchTest()
    w.show()
    app.exec_()
</code></pre>
<p><a href="https://docs.google.com/spreadsheets/d/1GRr4hdALdkZVjexRAy0nj5-9sQhMmSXw-R2xkkcOMz8/edit?usp=sharing" rel="nofollow noreferrer">Here's a 'broken' spreadsheet that will replicate the error</a></p>
<p><a href="https://docs.google.com/spreadsheets/d/1mR3Fn_deaybihKle8W76LbQQs-6_rp1viHAa87m2xKA/edit?usp=sharing" rel="nofollow noreferrer">Here's a 'working' spreadsheet that will not replicate the error(or it shouldn't)</a></p>
<p>I'd be happy to pass on the entire sourcecode in case it's something else, if needed. I didn't include the stuff that relies on pygsheets to download - input to pandas dataframe - then export to xslx.</p>
</div>
<div class="post-text" itemprop="text">
<p>The problem is caused because indexIng expects a string and as you point out you are passing an integer, so a possible solution is to convert it to string:</p>
<pre><code>def filterAcceptsRow(self, sourceRow, sourceParent):
    index0 = self.sourceModel().index(sourceRow, 0, sourceParent)
    index1 = self.sourceModel().index(sourceRow, 1, sourceParent)
    index2 = self.sourceModel().index(sourceRow, 2, sourceParent)
    value = self.sourceModel().data(index0, self.role) 
    for ix in (index0, index1, index2):
        value = self.sourceModel().data(ix, self.role)
        if self.filterRegExp().indexIn(str(value)) &gt;= 0:
            return True
    return False
</code></pre>
</div>
<span class="comment-copy">This fixed my issue! Thanks for your help.</span>
<div class="post-text" itemprop="text">
<p>I have implemented unit tests for my Flask app. I use pytest. My goal is to make sure that a number of pre-defined queries always return the same output (some json).</p>
<p>In order to do that, I use a fixture to start an app with test settings:</p>
<pre><code># Session for scope, otherwise server is reloaded everytime
@pytest.fixture(scope="session")
def app():

    os.environ["FLASK_ENV"] = "development"
    os.environ["TEST_SETTINGS"] = os.path.join(
        ds.WORK_DIR, "..", "tests", "settings.py"
    )

    app = create_app()

    # http://flask.pocoo.org/docs/1.0/api/#flask.Flask.test_client
    app.testing = True

    return app
</code></pre>
<p>And then I run a test function, which is not really a test function, with pytest:</p>
<pre><code># Freeze time for consistent output
@pytest.mark.usefixtures("live_server")
@pytest.mark.freeze_time("2018-01-01")
class TestLiveServer:

    @pytest.mark.skip(reason="should only be used to update the test data")
    def test_export(self):
        """Not a test function.

        Used to export questions outputs in json file to freeze the expected output

        """

        for q in TESTED_QUESTIONS:
            r = requests.post(
                url_for("query_direct", _external=True), json={"query": q}
            )
            print(r.text)

            filename = (
                "".join(filter(lambda c: str.isalnum(c) or c == " ", q))
                .lower()
                .replace(" ", "_")
                + ".json"
            )
            export_path = os.path.join("tests", "fake_responses", filename)

            data = {"query": q, "response": r.json()}

            with open(export_path, "w") as outfile:
                json.dump(data, outfile, indent=4, sort_keys=True)
                outfile.write("\n")
</code></pre>
<p>To generate my frozen outputs,  I uncomment the pytest marker and I run this particular test. As you can see, it's not very elegant and error prone. Ssometimes I  forget to re-enable the marker, annd if I run all the tests at once, it first re-generates the fake outputs before running unit tests on them. If this  happens, my tests don't fail and I don't catch the potential mistakes (whhich kills the point of these tests).</p>
<p>Is there a way to run this particular function alone, maybe with some pytest flag or something?</p>
</div>
<div class="post-text" itemprop="text">
<p>This should probably be a standalone thing and not part of the pytest test suite (since it's not a test), but you can get around it by exploiting pytest's <a href="https://docs.pytest.org/en/latest/skipping.html#id1" rel="nofollow noreferrer">skipping facilities</a>.</p>
<pre class="lang-py prettyprint-override"><code># redefine test_export to feature a conditional skip
@pytest.mark.skipif(not os.getenv('FREEZE_OUTPUTS'), reason='')
def test_export(self):
</code></pre>
<p>Here we skip this test, unless the <code>FREEZE_OUTPUTS</code> environment variable is set.</p>
<p>You can then run this test by calling the following from the command line (define the environment variable for this invocation only):</p>
<pre class="lang-sh prettyprint-override"><code>$ FREEZE_OUTPUTS=1 py.test &lt;your_test_file&gt;::TestLiveServer::test_export
</code></pre>
<p>Which will only run that test. In all other cases it will be skipped.</p>
<p>You can even follow the above approach and declare this as a fixture that you include on a <a href="https://docs.pytest.org/en/latest/fixture.html#scope-sharing-a-fixture-instance-across-tests-in-a-class-module-or-session" rel="nofollow noreferrer">session level</a> with <code>autouse=True</code> <a href="https://docs.pytest.org/en/latest/fixture.html#autouse-fixtures-xunit-setup-on-steroids" rel="nofollow noreferrer">so it's always included</a> and then in the fixture itself add some logic to check if you've defined <code>FREEZE_OUTPUTS</code> and if so, run the logic in question. Something like:</p>
<pre class="lang-py prettyprint-override"><code>@pytest.fixture(scope='session', autouse=True)
def frozen_outputs():
    if os.getenv('FREEZE_OUTPUTS'):
        # logic for generating the outputs goes here
    return  # do nothing otherwise
</code></pre>
</div>
<span class="comment-copy">This is not what I'm asking for. I can check my responses already. I need a way to generate/export them without running that as a test.</span>
<span class="comment-copy">I've edited my reply.</span>
<span class="comment-copy">Ah, I think I like the second part with the fixture autouse. How do I run it though?</span>
<span class="comment-copy">It's always run/included (because of <code>autouse=True</code>) when you run <code>py.test</code> (and it lasts for the entire session because of <code>scope='session'</code>) but the logic will be executed only if you add the <code>FREEZE_OUTPUTS=1</code> before the command invocation. Otherwise it's skipped. Put something innocent in there and give it a go.</span>
<div class="post-text" itemprop="text">
<p>I have the <em>main.py</em> and the <em>codetest.pyx</em> files. </p>
<p>I am using Anaconda3 with Pycharm as IDE on Windows10; nonetheless, the problem arises even executing the <em>main.py</em> from the prompt.</p>
<p>I would like to use the cython file with "<code>import pyximport; pyximport.install(pyimport=True)</code>" instead of using <em>setup.py</em> (as suggested in <a href="https://stackoverflow.com/questions/36880336/setup-of-pycharm-for-cython">Setup of PyCharm for Cython</a>) </p>
<p>I have got the following error:</p>
<pre><code>ImportError: Building module codetest failed: ["distutils.errors.CompileError: command 'C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\2017\\\\BuildTools\\\\VC\\\\Tools\\\\MSVC\\\\14.16.27023\\\\bin\\\\HostX86\\\\x64\\\\cl.exe' failed with exit status 2\n"]
</code></pre>
<p>I added <em>C:\Program Files (x86)\Microsoft Visual Studio\2017\BuildTools\VC\Tools\MSVC\14.16.27023\bin\Hostx86\x64</em> as path env. </p>
<p>Could the issue depend on the several <code>\</code> between the folder paths? 
If yes, I have no idea how it happened. </p>
<p>If I apply this solution (<a href="https://stackoverflow.com/questions/40203488/pycharm-does-not-recognize-cython-modules-located-in-path">Pycharm does not recognize Cython modules located in path</a>) it seems that it is not able to find the function inside the cython file:</p>
<p><code>AttributeError: module 'codetest' has no attribute 'myfunction'</code></p>
<p>Any help is really appreciated.</p>
</div>
<span class="comment-copy">Is there any other output? This looks like the last (and least informative) line of a longer error message. I don't think it's saying that it can't find cl.exe. I think there's been some error while compiling or linking.</span>
<span class="comment-copy">Here the complete error message:  Traceback (most recent call last):   File "D:/Code/main.py", line 427, in otherfuncion     self._functioncaller(alpha, beta, gamma)   File "D:/Code/main.py", line 338, in functioncaller     codetest.myfunction(a, delta, b.row, b.col, b.data) AttributeError: module 'codetest' has no attribute 'myfunction'  So, the problem is the cython file for sure but I don't know how to fix it.</span>
<div class="post-text" itemprop="text">
<p>Assume I have many expression similar to</p>
<pre><code>class X:
    def __init__(self, a,b,c,d,e,f):
        self.a = a
        self.b = b
        self.c = c
        self.d = d
        self.e = e
        self.f = f
</code></pre>
<p>Is there an elegant way to rewrite this?</p>
<p>Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>Starting from Python 3.7, It could be done using <a href="https://docs.python.org/3/library/dataclasses.html" rel="nofollow noreferrer">data classes</a></p>
<pre><code>@dataclass
class X:
    a: int
    b: str
    c: float
    # etc...
</code></pre>
<p>The <code>dataclass</code> decorator automatically generates the suitable <code>__init__</code> method.</p>
<hr/>
<p>As @Lie Ryan commented, you could also use <a href="https://docs.python.org/2/library/collections.html#collections.namedtuple" rel="nofollow noreferrer">namedtuple</a>:</p>
<pre><code>&gt;&gt;&gt; X = namedtuple('X', ('a', 'b', 'c'))
&gt;&gt;&gt; x = X(1, 2, 3)
&gt;&gt;&gt; x
X(a=1, b=2, c=3)
&gt;&gt;&gt; x.a
1
</code></pre>
<p>It can even be inherited to add or overload methods:</p>
<pre><code>&gt;&gt;&gt; class X(namedtuple('XSuper', ('a', 'b', 'c'))):
...     def __repr__(self):
...         return 'pouet'
...     
&gt;&gt;&gt; x = X(1, 2, 3)
&gt;&gt;&gt; x
pouet
&gt;&gt;&gt; x.a
1
</code></pre>
<hr/>
<p>The answer from <a href="https://stackoverflow.com/a/55259615/2696355">fountainhead</a> is also a nice version-agnostic trick.</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>class X:
    def __init__(self, a,b,c,d,e,f):
        self.a = a
        self.b = b
        self.c = c
        self.d = d
        self.e = e
        self.f = f

class X:
    def __init__(self, *args):
        arglist = ['a', 'b', 'c', 'd']
        for i in range(0, len(arglist):
            try:
                setattr(self, arglist[i], args[i])
            except IndexError:
                raise Exception('Arg {} needs to be given a value'.format(arglist[i]))
</code></pre>
<p>Does not look like the most elegant thing everbut the longer the list the more simplified, also you only need to modify arglist and it will be reflected. Bad thing, you lose the signature (any non runtime checks you could make are lost, e.g. your IDE will freak out</p>
<p>Other suggestions include enumerate (cleaner way to work with indices).</p>
<p>Or you could just use zip, and do the check at the begginign:</p>
<pre><code>class X:
    def __init__(self, *args):
        arglist = ['a', 'b', 'c', 'd']
        if len(arglist) != len(args):
           raise CustomExceptino('Too few/many arguments...')
        for keyval_tuple in zip(arglist, args):
            setattr(self, keyval_tuple[0], keyval_tuple[1])
</code></pre>
<p>Note that you can still add arguments that don't behave this way:</p>
<pre><code>    class X:
        def __init__(self, special_arg, *args):
            self.special_consequence = self.do_sth_with_special_arg(special_arg)
            arglist = ['a', 'b', 'c', 'd']
            if len(arglist) != len(args):
               raise CustomExceptino('Too few/many arguments...')
            for keyval_tuple in zip(arglist, args):
                setattr(self, keyval_tuple[0], keyval_tuple[1])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could try this:</p>
<pre><code>class X:
    def __init__(self, a,b,c,d,e,f):
        all_l = locals() # Let this be the first statement.
        for l in all_l:
            if (l != 'self'):
                self.__dict__[l] = all_l[l]
</code></pre>
<p>Output:</p>
<pre><code>x = X(10,20,30,40,50,60)
print (x.d)

40
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can try using named <a href="https://www.digitalocean.com/community/tutorials/how-to-use-args-and-kwargs-in-python-3" rel="nofollow noreferrer">generic arguments</a>:</p>
<pre><code>class X:
    def __init__(self, **kwargs):
        for key, value in kwargs.items():
            setattr(self, key, value)       
</code></pre>
<p>and then:</p>
<pre><code>x = X(a=1, b=2, c=3, d=4, e=5, f=6)
</code></pre>
<p>But this is not good practice, as it gives you no control on what is actually passed.</p>
<p>Or:</p>
<pre><code>class X:
    def __init__(self, *args):
        for key, value in zip(['a', 'b', 'c', 'd', 'e', 'f'], args):
            setattr(self, key, value)    
</code></pre>
<p>and then:</p>
<pre><code>x = X(1, 2, 3, 4, 5, 6)
</code></pre>
<p>BUT, as the <a href="https://www.python.org/dev/peps/pep-0020/" rel="nofollow noreferrer">Zen of Python</a> says:</p>
<blockquote>
<p>explicit is better than implicit</p>
</blockquote>
<p>and your original code is good enough for that!</p>
<p><strong>EDIT</strong></p>
<p>Just to avoid overwriting <em>dangerous</em> properties, replace</p>
<pre><code>setattr(self, key, value)    
</code></pre>
<p>with</p>
<pre><code>if not hasattr(self, key):
    setattr(self, key, value)
</code></pre>
</div>
<span class="comment-copy">starting from Python 3.7, you could use data-classes: <a href="https://docs.python.org/3/library/dataclasses.html" rel="nofollow noreferrer">docs.python.org/3/library/dataclasses.html</a></span>
<span class="comment-copy">okay Tryph, this is what I searched for. Put into an answer and I will check it as solving the problem.</span>
<span class="comment-copy">In older versions, there are also <a href="https://docs.python.org/2/library/collections.html#collections.namedtuple" rel="nofollow noreferrer">namedtuple</a> or <a href="https://pypi.org/project/attrs/" rel="nofollow noreferrer">attrs</a>.</span>
<span class="comment-copy">prefer using <code>enumerate</code> builtin instead of <code>range(0, len(arglist)</code></span>
<span class="comment-copy">he is asking for args, not kwargs</span>
<span class="comment-copy">You can add a statement like: <code>assert set(kwargs.keys()).issubset({'a', 'b', 'c', 'd', 'e', 'f'})</code> or <code>if not set(kwargs.keys()).issubset({'a', 'b', 'c', 'd', 'e', 'f'}): raise ArgumentError()</code> to enforce what can be passed into the class.</span>
<span class="comment-copy">@E.Serra: <code>*args</code> can be handled similarly with <code>zip(['a', 'b', 'c', 'd', 'e', 'f'], args)</code> instead of <code>kwargs.items()</code></span>
<span class="comment-copy">I think that, as far as the OP's reasons are not clear, the best way to achieve that assignements is to be expicit. Any other solution wouldn't be "pythonic"</span>
<span class="comment-copy">That would make whatever passed as kwarg work, and give no room for args/kwargs that don't behave as self.arg =arg</span>
<div class="post-text" itemprop="text">
<p>I am trying to plot data with using  regplot from seaborn: </p>
<pre><code>Y=[0, 0, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 97, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 97, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 97, 98, 98, 98, 53, 98, 98, 98, 98, 98, 98, 97, 98, 53, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 67, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 53, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 93, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 97, 53, 98, 98, 98, 98, 50, 96, 98, 98, 98, 98, 98, 98, 98, 98, 96, 98, 98, 98, 98, 98, 98, 98, 98, 53, 98, 98, 55, 98, 98, 99, 98, 98, 20, 98, 98, 98, 98, 98, 98, 98, 53, 28, 96, 98, 98, 98, 98, 98, 98, 98, 98, 53, 69, 98, 98, 98, 68, 98, 98, 98, 31, 47, 98, 96, 98, 98, 98, 69, 11, 98, 98, 98, 98, 98, 98, 98, 53, 93, 11, 98, 98, 98, 98, 98, 11, 98, 98, 98, 95, 76, 98, 98, 98, 42, 58, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 11, 96, 98, 98, 73, 64, 47, 53, 76, 98, 98, 42, 25, 98, 11, 98, 98, 98, 98, 98, 98, 50, 98, 98, 98, 11, 23, 98, 98, 98, 96, 98, 98, 98, 98, 98, 25, 96, 98, 98, 98, 11, 98, 98, 98, 21, 51, 98, 98, 98, 53, 47, 53, 52, 98, 98, 25, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 53, 98, 98, 98, 98, 98, 98, 98, 59, 64, 98, 98, 98, 98, 11, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 25, 53, 51, 98, 98, 98, 98, 98, 98, 98, 98, 98, 69, 98, 98, 98, 98, 98, 98, 98, 98, 42, 98, 98, 98, 98, 98, 98, 64, 70, 98, 50, 98, 98, 53, 47, 98, 98, 98, 11, 98, 98, 53, 98, 68, 98, 98, 11, 98, 98, 98, 53, 47, 98, 98, 98, 11, 98, 98, 98, 53, 47, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 55, 97, 98, 98, 98, 98, 98, 98, 52, 42, 21, 98, 98, 42, 98, 98, 98, 98, 98, 25, 86, 96, 98, 54, 98, 11, 98, 98, 98, 98, 98, 98, 98, 98, 98, 11, 98, 98, 93, 98, 98, 98, 98, 98, 98, 47, 98, 25, 31, 98, 42, 25, 28, 98, 98, 98, 98, 98, 98, 98, 74, 98, 76, 11, 68, 47, 21, 98, 66, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 42, 12, 98, 98, 98, 72, 98, 98, 98, 98, 98, 14, 96, 98, 98, 68, 98, 98, 96, 18, 98, 98, 98, 98, 28, 98, 54, 98, 98, 98, 98, 98, 73, 98, 98, 98, 96, 98, 98, 98, 47, 98, 25, 98, 96, 98, 98, 98, 50, 98, 98, 98, 98, 98, 47, 98, 11, 98, 98, 98, 98, 98, 53, 47, 98, 96, 98, 98, 98, 98, 98, 53, 47, 98, 97, 98, 98, 50, 98, 98, 98, 98, 98, 68, 11, 98, 98, 68, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 47, 25, 98, 25, 98, 97, 98, 98, 98, 98, 98, 97, 55, 97, 98, 98, 98, 98, 47, 76, 98, 98, 97, 98, 97, 25, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 42, 98, 98, 98, 98, 98, 11, 98, 98, 98, 98, 98, 98, 11, 98, 68, 96, 98, 98, 98, 16, 96, 98, 98, 88, 98, 98, 98, 72, 98, 11, 98, 98, 11, 98, 98, 98, 51, 98, 98, 98, 98, 98, 98, 98, 76, 98, 11, 98, 98, 98, 98, 51, 98, 98, 21, 98, 98, 98, 98, 42, 42, 76, 9, 96, 98, 98, 98, 98, 98, 98, 98, 98, 98, 72, 76, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 64, 25, 98, 25, 76, 98, 98, 98, 54, 98, 98, 98, 42, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 42, 25, 96, 98, 98, 98, 11, 96, 98, 98, 98, 76, 42, 97, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 76, 42, 9, 72, 86, 98, 98, 98, 98, 98, 98, 25, 98, 11, 98, 98, 98, 98, 76, 25, 98, 44, 98, 98, 98, 98, 98, 98, 98, 98, 98, 54, 25, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 72, 3, 98, 98, 55, 98, 98, 98, 98, 21, 98, 98, 98, 98, 98, 98, 98, 9, 98, 98, 98, 98, 98, 98, 21, 98, 1, 98, 98, 98, 98, 23, 98, 98, 98, 98, 42, 98, 98, 98, 72, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 72, 98, 98, 98, 23, 98, 98, 98, 76, 98, 1, 98, 98, 98, 98, 98, 98, 76, 98, 68, 98, 98, 98, 98, 98, 98, 21, 9, 98, 98, 98, 72, 72, 25, 98, 98, 98, 98, 98, 54, 98, 9, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 76, 98, 98, 98, 98, 98, 98, 25, 96, 98, 98, 98, 98, 98, 98, 98, 98, 98, 42, 98, 98, 98, 25, 98, 98, 98, 98, 98, 98, 25, 98, 25, 98, 98, 98, 98, 98, 11, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 55, 98, 98, 72, 76, 98, 98, 98, 98, 98, 68, 37, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 9, 98, 98, 98, 98, 98, 98, 98, 98, 72, 98, 98, 11, 98, 98, 98, 98, 21, 96, 98, 98, 98, 98, 98, 98, 98, 54, 98, 98, 98, 98, 98, 98, 98, 98, 47, 98, 98, 98, 76, 98, 98, 98, 98, 25, 98, 11, 98, 97, 98, 20, 96, 98, 98, 42, 25, 36, 1, 98, 98, 98, 54, 98, 98, 25, 98, 98, 42, 98, 98, 98, 98, 42, 98, 98, 98, 98, 98, 98, 98, 98, 76, 98, 98, 68, 11, 98, 98, 98, 98, 25, 98, 98, 98, 98, 98, 11, 98, 98, 98, 98, 65, 98, 98, 11, 98, 98, 98, 98, 98, 58, 76, 66, 11, 98, 98, 98, 98, 42, 76, 98, 23, 11, 98, 98, 39, 42, 98, 98, 98, 98, 98, 98, 98, 98, 98, 54, 98, 98, 21, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 11, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 11, 97, 98, 98, 44, 98, 21, 98, 98, 54, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 68, 54, 98, 98, 25, 98, 98, 98, 98, 98, 98, 39, 86, 98, 98, 98, 98, 42, 1, 98, 98, 98, 98, 98, 98, 98, 98, 68, 98, 98, 58, 76, 98, 98, 98, 98, 97, 98, 39, 98, 98, 98, 98, 44, 98, 98, 98, 98, 58, 98, 98, 98, 98, 11, 98, 98, 98, 98, 98, 98, 98, 25, 58, 98, 98, 98, 98, 98, 98, 98, 98, 54, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 54, 25, 98, 96, 98, 98, 98, 98, 65, 42, 98, 98, 98, 98, 98, 98, 25, 42, 98, 98, 98, 98, 98, 98, 98, 98, 98, 58, 84, 95, 98, 98, 98, 98, 98, 98, 98, 11, 97, 98, 98, 54, 25, 98, 98, 98, 98, 98, 98, 98, 54, 98, 98, 98, 98, 86, 23, 98, 98, 98, 98, 98, 98, 98, 98, 98, 42, 11, 98, 98, 98, 98, 98, 98, 82, 39, 98, 98, 98, 98, 98, 68, 11, 44, 98, 98, 25, 86, 98, 98, 98]

X= [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023, 1024, 1025, 1026, 1027, 1028, 1029, 1030, 1031, 1032, 1033, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1047, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 1079, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101, 1102, 1103, 1104, 1105, 1106, 1107, 1108, 1109, 1110, 1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118, 1119, 1120, 1121, 1122, 1123, 1124, 1125, 1126, 1127, 1128, 1129, 1130, 1131, 1132, 1133, 1134, 1135, 1136, 1137, 1138, 1139, 1140, 1141, 1142, 1143, 1144, 1145, 1146, 1147, 1148, 1149, 1150, 1151, 1152, 1153, 1154, 1155, 1156, 1157, 1158, 1159, 1160, 1161, 1162, 1163, 1164, 1165, 1166, 1167, 1168, 1169, 1170, 1171, 1172, 1173, 1174, 1175, 1176, 1177, 1178, 1179, 1180, 1181, 1182, 1183, 1184, 1185, 1186, 1187, 1188, 1189, 1190, 1191, 1192, 1193, 1194, 1195, 1196, 1197, 1198, 1199, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223, 1224, 1225, 1226, 1227, 1228, 1229, 1230, 1231, 1232, 1233, 1234, 1235, 1236, 1237, 1238, 1239, 1240, 1241, 1242, 1243, 1244, 1245, 1246, 1247, 1248, 1249, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 1259, 1260, 1261, 1262, 1263, 1264, 1265, 1266, 1267, 1268, 1269, 1270, 1271, 1272, 1273, 1274, 1275, 1276, 1277, 1278, 1279, 1280, 1281, 1282, 1283, 1284, 1285, 1286, 1287, 1288, 1289, 1290, 1291, 1292, 1293, 1294, 1295, 1296, 1297, 1298, 1299, 1300, 1301, 1302, 1303, 1304, 1305, 1306, 1307, 1308, 1309, 1310, 1311, 1312, 1313, 1314, 1315, 1316, 1317, 1318, 1319, 1320, 1321, 1322, 1323, 1324, 1325, 1326, 1327, 1328, 1329, 1330, 1331, 1332, 1333, 1334, 1335, 1336, 1337, 1338, 1339, 1340, 1341, 1342, 1343, 1344, 1345, 1346, 1347, 1348, 1349, 1350, 1351, 1352, 1353, 1354, 1355, 1356, 1357, 1358, 1359, 1360, 1361]
</code></pre>
<p>This is my code: </p>
<pre><code>import seaborn as sns
import matplotlib.pyplot as plt
f1 = plt.figure(1)
for c, t in zip(Y,X):
    sns.regplot(x=t,y=c)
plt.show()
</code></pre>
<p>But, it gives me this error: </p>
<pre><code>    setattr(self, var, val[not_na])
TypeError: 'int' object is not subscriptable
</code></pre>
<p>An I don't which funtion may give me the comuted CI from thre regplot function. </p>
</div>
<div class="post-text" itemprop="text">
<p>you are getting error because in <code>sns.regplot</code> <code>x and y</code> requires <code>list</code>, you are giving <code>int</code></p>
<pre><code>import matplotlib.pyplot as plt
import scipy.stats
import seaborn as sns
Y=[0, 0, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 97, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 97, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 97, 98, 98, 98, 53, 98, 98, 98, 98, 98, 98, 97, 98, 53, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 67, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 53, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 93, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 97, 53, 98, 98, 98, 98, 50, 96, 98, 98, 98, 98, 98, 98, 98, 98, 96, 98, 98, 98, 98, 98, 98, 98, 98, 53, 98, 98, 55, 98, 98, 99, 98, 98, 20, 98, 98, 98, 98, 98, 98, 98, 53, 28, 96, 98, 98, 98, 98, 98, 98, 98, 98, 53, 69, 98, 98, 98, 68, 98, 98, 98, 31, 47, 98, 96, 98, 98, 98, 69, 11, 98, 98, 98, 98, 98, 98, 98, 53, 93, 11, 98, 98, 98, 98, 98, 11, 98, 98, 98, 95, 76, 98, 98, 98, 42, 58, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 11, 96, 98, 98, 73, 64, 47, 53, 76, 98, 98, 42, 25, 98, 11, 98, 98, 98, 98, 98, 98, 50, 98, 98, 98, 11, 23, 98, 98, 98, 96, 98, 98, 98, 98, 98, 25, 96, 98, 98, 98, 11, 98, 98, 98, 21, 51, 98, 98, 98, 53, 47, 53, 52, 98, 98, 25, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 53, 98, 98, 98, 98, 98, 98, 98, 59, 64, 98, 98, 98, 98, 11, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 25, 53, 51, 98, 98, 98, 98, 98, 98, 98, 98, 98, 69, 98, 98, 98, 98, 98, 98, 98, 98, 42, 98, 98, 98, 98, 98, 98, 64, 70, 98, 50, 98, 98, 53, 47, 98, 98, 98, 11, 98, 98, 53, 98, 68, 98, 98, 11, 98, 98, 98, 53, 47, 98, 98, 98, 11, 98, 98, 98, 53, 47, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 55, 97, 98, 98, 98, 98, 98, 98, 52, 42, 21, 98, 98, 42, 98, 98, 98, 98, 98, 25, 86, 96, 98, 54, 98, 11, 98, 98, 98, 98, 98, 98, 98, 98, 98, 11, 98, 98, 93, 98, 98, 98, 98, 98, 98, 47, 98, 25, 31, 98, 42, 25, 28, 98, 98, 98, 98, 98, 98, 98, 74, 98, 76, 11, 68, 47, 21, 98, 66, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 42, 12, 98, 98, 98, 72, 98, 98, 98, 98, 98, 14, 96, 98, 98, 68, 98, 98, 96, 18, 98, 98, 98, 98, 28, 98, 54, 98, 98, 98, 98, 98, 73, 98, 98, 98, 96, 98, 98, 98, 47, 98, 25, 98, 96, 98, 98, 98, 50, 98, 98, 98, 98, 98, 47, 98, 11, 98, 98, 98, 98, 98, 53, 47, 98, 96, 98, 98, 98, 98, 98, 53, 47, 98, 97, 98, 98, 50, 98, 98, 98, 98, 98, 68, 11, 98, 98, 68, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 47, 25, 98, 25, 98, 97, 98, 98, 98, 98, 98, 97, 55, 97, 98, 98, 98, 98, 47, 76, 98, 98, 97, 98, 97, 25, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 42, 98, 98, 98, 98, 98, 11, 98, 98, 98, 98, 98, 98, 11, 98, 68, 96, 98, 98, 98, 16, 96, 98, 98, 88, 98, 98, 98, 72, 98, 11, 98, 98, 11, 98, 98, 98, 51, 98, 98, 98, 98, 98, 98, 98, 76, 98, 11, 98, 98, 98, 98, 51, 98, 98, 21, 98, 98, 98, 98, 42, 42, 76, 9, 96, 98, 98, 98, 98, 98, 98, 98, 98, 98, 72, 76, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 64, 25, 98, 25, 76, 98, 98, 98, 54, 98, 98, 98, 42, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 42, 25, 96, 98, 98, 98, 11, 96, 98, 98, 98, 76, 42, 97, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 76, 42, 9, 72, 86, 98, 98, 98, 98, 98, 98, 25, 98, 11, 98, 98, 98, 98, 76, 25, 98, 44, 98, 98, 98, 98, 98, 98, 98, 98, 98, 54, 25, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 72, 3, 98, 98, 55, 98, 98, 98, 98, 21, 98, 98, 98, 98, 98, 98, 98, 9, 98, 98, 98, 98, 98, 98, 21, 98, 1, 98, 98, 98, 98, 23, 98, 98, 98, 98, 42, 98, 98, 98, 72, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 72, 98, 98, 98, 23, 98, 98, 98, 76, 98, 1, 98, 98, 98, 98, 98, 98, 76, 98, 68, 98, 98, 98, 98, 98, 98, 21, 9, 98, 98, 98, 72, 72, 25, 98, 98, 98, 98, 98, 54, 98, 9, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 76, 98, 98, 98, 98, 98, 98, 25, 96, 98, 98, 98, 98, 98, 98, 98, 98, 98, 42, 98, 98, 98, 25, 98, 98, 98, 98, 98, 98, 25, 98, 25, 98, 98, 98, 98, 98, 11, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 55, 98, 98, 72, 76, 98, 98, 98, 98, 98, 68, 37, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 9, 98, 98, 98, 98, 98, 98, 98, 98, 72, 98, 98, 11, 98, 98, 98, 98, 21, 96, 98, 98, 98, 98, 98, 98, 98, 54, 98, 98, 98, 98, 98, 98, 98, 98, 47, 98, 98, 98, 76, 98, 98, 98, 98, 25, 98, 11, 98, 97, 98, 20, 96, 98, 98, 42, 25, 36, 1, 98, 98, 98, 54, 98, 98, 25, 98, 98, 42, 98, 98, 98, 98, 42, 98, 98, 98, 98, 98, 98, 98, 98, 76, 98, 98, 68, 11, 98, 98, 98, 98, 25, 98, 98, 98, 98, 98, 11, 98, 98, 98, 98, 65, 98, 98, 11, 98, 98, 98, 98, 98, 58, 76, 66, 11, 98, 98, 98, 98, 42, 76, 98, 23, 11, 98, 98, 39, 42, 98, 98, 98, 98, 98, 98, 98, 98, 98, 54, 98, 98, 21, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 11, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 11, 97, 98, 98, 44, 98, 21, 98, 98, 54, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 68, 54, 98, 98, 25, 98, 98, 98, 98, 98, 98, 39, 86, 98, 98, 98, 98, 42, 1, 98, 98, 98, 98, 98, 98, 98, 98, 68, 98, 98, 58, 76, 98, 98, 98, 98, 97, 98, 39, 98, 98, 98, 98, 44, 98, 98, 98, 98, 58, 98, 98, 98, 98, 11, 98, 98, 98, 98, 98, 98, 98, 25, 58, 98, 98, 98, 98, 98, 98, 98, 98, 54, 98, 98, 98, 98, 98, 98, 98, 98, 98, 98, 54, 25, 98, 96, 98, 98, 98, 98, 65, 42, 98, 98, 98, 98, 98, 98, 25, 42, 98, 98, 98, 98, 98, 98, 98, 98, 98, 58, 84, 95, 98, 98, 98, 98, 98, 98, 98, 11, 97, 98, 98, 54, 25, 98, 98, 98, 98, 98, 98, 98, 54, 98, 98, 98, 98, 86, 23, 98, 98, 98, 98, 98, 98, 98, 98, 98, 42, 11, 98, 98, 98, 98, 98, 98, 82, 39, 98, 98, 98, 98, 98, 68, 11, 44, 98, 98, 25, 86, 98, 98, 98]

X= [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023, 1024, 1025, 1026, 1027, 1028, 1029, 1030, 1031, 1032, 1033, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1047, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 1079, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101, 1102, 1103, 1104, 1105, 1106, 1107, 1108, 1109, 1110, 1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118, 1119, 1120, 1121, 1122, 1123, 1124, 1125, 1126, 1127, 1128, 1129, 1130, 1131, 1132, 1133, 1134, 1135, 1136, 1137, 1138, 1139, 1140, 1141, 1142, 1143, 1144, 1145, 1146, 1147, 1148, 1149, 1150, 1151, 1152, 1153, 1154, 1155, 1156, 1157, 1158, 1159, 1160, 1161, 1162, 1163, 1164, 1165, 1166, 1167, 1168, 1169, 1170, 1171, 1172, 1173, 1174, 1175, 1176, 1177, 1178, 1179, 1180, 1181, 1182, 1183, 1184, 1185, 1186, 1187, 1188, 1189, 1190, 1191, 1192, 1193, 1194, 1195, 1196, 1197, 1198, 1199, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223, 1224, 1225, 1226, 1227, 1228, 1229, 1230, 1231, 1232, 1233, 1234, 1235, 1236, 1237, 1238, 1239, 1240, 1241, 1242, 1243, 1244, 1245, 1246, 1247, 1248, 1249, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 1259, 1260, 1261, 1262, 1263, 1264, 1265, 1266, 1267, 1268, 1269, 1270, 1271, 1272, 1273, 1274, 1275, 1276, 1277, 1278, 1279, 1280, 1281, 1282, 1283, 1284, 1285, 1286, 1287, 1288, 1289, 1290, 1291, 1292, 1293, 1294, 1295, 1296, 1297, 1298, 1299, 1300, 1301, 1302, 1303, 1304, 1305, 1306, 1307, 1308, 1309, 1310, 1311, 1312, 1313, 1314, 1315, 1316, 1317, 1318, 1319, 1320, 1321, 1322, 1323, 1324, 1325, 1326, 1327, 1328, 1329, 1330, 1331, 1332, 1333, 1334, 1335, 1336, 1337, 1338, 1339, 1340, 1341, 1342, 1343, 1344, 1345, 1346, 1347, 1348, 1349, 1350, 1351, 1352, 1353, 1354, 1355, 1356, 1357, 1358, 1359, 1360, 1361]
def mean_confidence_interval(data, confidence=0.95):
    a = 1.0 * np.array(data)
    n = len(a)
    m, se = np.mean(a), scipy.stats.sem(a)
    h = se * scipy.stats.t.ppf((1 + confidence) / 2., n-1)
    return m, m-h, m+h
print()

c, c1, c2 = mean_confidence_interval(Y)
sns.regplot(x=X, y=Y, ci=c)
plt.show()
</code></pre>
<p><a href="https://i.stack.imgur.com/SRaIK.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/SRaIK.png"/></a></p>
</div>
<span class="comment-copy">The CI is the confidence interval computed by regplot function.</span>
<div class="post-text" itemprop="text">
<p>I have a huge dataset with a lot of different client names, bills etc.</p>
<p>Now I want to show the 4 clients with the cumulated total highest bill. </p>
<p>So far I have used the groupby function:</p>
<pre><code>data.groupby(by = ["CustomerName","Bill"], as_index=False).sum()
</code></pre>
<p>I tried to group by the name of the customers and the bill but it's not giving me the total sum of all the individual customer orders but only each single order from the customer. </p>
<p>Can someone help and tell me how I can receive on the first position customer x (with the highest accumulated bill) and the sum of all his orders and on position 2 the customer with the second highest accumulated bill and so on?</p>
<p>Big thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>Since, I don't know the full structure of your <code>data</code> data frame, I recommend subsetting the relevant columns first:</p>
<pre><code>data = data[["CustomerName", "Bill"]]
</code></pre>
<p>Then, you just need to group by <code>CustomerName</code> and sum over all columns (<code>Bill</code> in that case):</p>
<pre><code>data.groupby(by=["CustomerName"]).sum()
</code></pre>
<p>Finally, you need to sort by the <code>Bill</code> column in non-ascending order:</p>
<pre><code>data.sort_values(by='Bill', ascending=False)

print(data.head(4))
</code></pre>
</div>
<span class="comment-copy">import pandas as pd   data = pd.read_excel("data_Shipments.xls")  data.groupby(by = ["CustomerName","Bill"], as_index=False).sum()</span>
<span class="comment-copy">Can you further elaborate what is in which column/row of your dataset?</span>
<div class="post-text" itemprop="text">
<p>When I set row_selectable as 'multi' in a DataTable, I would expect an extra column on the very left with checkboxes to select arbitrary rows. However, when I do it, that column does not contain any checkboxes. Therefore, row selection is not possible.</p>
<pre><code>import dash
import dash_table
import pandas as pd

df = pd.read_csv('https://raw.githubusercontent.com/plotly/datasets/master/solar.csv')

app = dash.Dash(__name__)

app.layout = dash_table.DataTable(
    id='table',
    columns=[{"name": i, "id": i} for i in df.columns],
    data=df.to_dict("rows"),
    row_selectable='multi'
)

if __name__ == '__main__':
    app.run_server(debug=True)
</code></pre>
<p>row_selectable='single' results in the same output. I am using Python 3.6.8, dash 0.39.0, dash-table 3.6.0</p>
<p>Can somebody help, please?</p>
</div>
<span class="comment-copy">I ran your example with a dummy dataframe, <code>df = pd.DataFrame(np.arange(30).reshape(5, 6))</code>, and the checkboxes appeared on the left correctly. I'm using the same version of everything except I have Python 3.7, but I doubt that would make a difference. I set up a simple callback as well, showing the selections, and it handles multiple selections fine.</span>
<div class="post-text" itemprop="text">
<p>I am writing a script that can encrypt and decrypt an image using the RSA algorithm. My public key is (7, 187) and the private key is (23,187) now the calculation for the encryption is correct like for an entry in the matrix of the image, 41 the encrypted value is 46. But when the decryption is happening it is not giving the appropriate result like for 46 it is giving 136 and for every entry of 46 in the encrypt matrix the result I am getting is 136 in the decrypt matrix. And I don't know why this is happening. When I am doing the same calculation in the python prompt(or shell) it is giving the correct answer. </p>
<p>In the script, I am first converting the RGB image into grayscale and then converting it to a 2d numpy array, then for each element, I am applying the RSA algo(the keys) and then saving it as an image. Then I am applying the decryption key in the encrypted matrix and then the problem is occurring. Heres the code:</p>
<pre><code>from PIL import Image
import numpy as np
from pylab import * 
#encryption

img1 = (Image.open('image.jpeg').convert('L')) 
img1.show()

img = array((Image.open('image.jpeg').convert('L')))
a,b = img.shape #saving the no of rows and col in a tuple
print('\n\nOriginal image: ')
print(img)
print((a,b))
tup = a,b

for i in range (0, tup[0]):
    for j in range (0, tup[1]):
        img[i][j]= (pow(img[i][j],7)%187)


print('\n\nEncrypted image: ')
print(img)
imgOut = Image.fromarray(img)
imgOut.show()
imgOut.save('img.bmp')

#decryption

img2 = (Image.open('img.bmp'))
img2.show()
img3 = array(Image.open('img.bmp'))
print('\n\nEncrypted image: ')
print(img3)
a1,b1 = img3.shape
print((a1,b1))
tup1 = a1,b1

for i1 in range (0, tup1[0]):
    for j1 in range (0, tup1[1]):
        img3[i1][j1]= ((pow(img3[i1][j1], 23))%187) 
print('\n\nDecrypted image: ')
print(img3)
imgOut1 = Image.fromarray(img3)
imgOut1.show()
print(type(img))  
</code></pre>
<p>The values of the matrices: </p>
<p>Original image: </p>
<p>[[41 42 45 ... 47 41 33]</p>
<p>[41 43 45 ... 44 38 30]</p>
<p>[41 42 46 ... 41 36 30]
 ...</p>
<p>[43 43 44 ... 56 56 55]</p>
<p>[45 44 45 ... 55 55 54]</p>
<p>[46 46 46 ... 53 54 54]]</p>
<p>Encrypted image: </p>
<p>[[ 46  15 122 ... 174  46  33]</p>
<p>[ 46  87 122 ...  22  47 123]</p>
<p>[ 46  15   7 ...  46   9 123]
 ...</p>
<p>[ 87  87  22 ...  78  78 132]</p>
<p>[122  22 122 ... 132 132 164]</p>
<p>[  7   7   7 ...  26 164 164]]</p>
<p>Decrypted image: </p>
<p>[[136  70  24 ... 178 136 164]</p>
<p>[136 111  24 ... 146 141  88]</p>
<p>[136  70  96 ... 136 100  88]
 ...</p>
<p>[111 111 146 ... 140 140   1]</p>
<p>[ 24 146  24 ...   1   1  81]</p>
<p>[ 96  96  96 ...  52  81  81]]</p>
<p>Any help will be greatly appreciated. Thank You.</p>
</div>
<div class="post-text" itemprop="text">
<p>I think you will get on better using the 3rd parameter to the <code>pow()</code> function which does the modulus internally for you.</p>
<p>Here is a little example without the complexity of loading images - just imagine it is a greyscale gradient from black to white.</p>
<pre><code># Make single row greyscale gradient from 0..255
img = [ x for x in range(256) ]

# Create encrypted version
enc = [ pow(x,7,187) for x in img ]

# Decrypt back to plaintext
dec = [ pow(x,23,187) for x in enc ]
</code></pre>
<p>It seems to decrypt back into the original values from 0..187, where it goes wrong - presumably because of overflow? Maybe someone cleverer than me will be able to explain that - please add comment for me if you know!</p>
</div>
<span class="comment-copy">It is weird that you are getting <code>46</code> as the encrypted value because your original image should have dtype <code>uint8</code> and <code>pow(np.uint8(41),7)%187</code> evaluates to <code>86</code>, not <code>46</code>.</span>
<span class="comment-copy">Then how to resolve the problem ?</span>
<span class="comment-copy">I cannot even reproduce the problem, let alone solve it. I get 86 instead of 46 in the encrypted image when I run your code. Are you sure you get 46?</span>
<span class="comment-copy">yes I'm pretty sure. btw this is written in python 3.7.</span>
<span class="comment-copy">Then I am at a loss. Can you provide a sample image?</span>
<span class="comment-copy">This will not work in this script as the <code>img[i][j]</code> is a <code>numpy.ndarray</code> and to use the 3rd parameter of the <code>pow()</code> i need to have all the parameter as <code>int</code></span>
<span class="comment-copy">For this to work i need to take each and every value of <code>img</code> into a <code>int</code> data type like <code>temp</code> then only i can use this.</span>
<span class="comment-copy">You can make a Numpy array into a list easily with <code>img.tolist()</code> However, my point is to use the 3rd parameter to <code>pow()</code> not to make you use a list.</span>
<div class="post-text" itemprop="text">
<p>It also gives an error " failed building wheel for twisted". I already have higher version microsoft visual c++ 14.0.
i even tried installing twisted, but i get same error for installing Twisted.</p>
<p><a href="https://i.stack.imgur.com/qRt98.png" rel="nofollow noreferrer">Error while running pip install Scrapy</a></p>
</div>
<div class="post-text" itemprop="text">
<p>Scrapy documentation is recommending using Anaconda (or Miniconda) to install Scrapy on Windows (<a href="https://doc.scrapy.org/en/latest/intro/install.html#windows" rel="nofollow noreferrer">link</a>):</p>
<blockquote>
<p>Though it’s possible to install Scrapy on Windows using pip, we recommend you to install Anaconda or Miniconda and use the package from the conda-forge channel, which will avoid most installation issues.</p>
</blockquote>
<p>Anaconda is a Python software distribution with data science and machine learning in mind, whereas Miniconda is trimmed-down version of Anaconda with easy way to install additional packages. For your use case I recommend Miniconda. </p>
<p>If you don't want to use Miniconda, maybe let's focus on installing Twisted first. It has recommendations for installing on Windows (<a href="https://twistedmatrix.com/trac/wiki/Downloads#ThroughPip" rel="nofollow noreferrer">link</a>):</p>
<blockquote>
<p>If you are installing on Windows, pip install Twisted[windows_platform] will install the Windows-specific requirements. </p>
</blockquote>
<p>Maybe you could try installing Twisted first and then try to install Scrapy?</p>
</div>
<span class="comment-copy">if I install Scrapy using Miniconda, will I be able to use Scrapy in Pycharm software</span>
<span class="comment-copy">Yes, here's how to configure it: <a href="https://www.jetbrains.com/help/pycharm/conda-support-creating-conda-virtual-environment.html" rel="nofollow noreferrer">jetbrains.com/help/pycharm/…</a></span>
<span class="comment-copy">Thanks a lot. This solved My problem.</span>
<span class="comment-copy">@meghanaV I'm glad I could help. In this case please mark my answer as accepted answer</span>
<div class="post-text" itemprop="text">
<p>I have text file in alphabetic order looking like this in Python:</p>
<pre><code>At 210.001 \n Au 196.9665 \n B 10.81 \n Ba 137.34 \n
</code></pre>
<p>How do I make each line a list? To make it a list, the space between the letters and the numbers need to be ",", and how do I do that as well?</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use the following code:</p>
<pre><code>with open('list.txt', 'r') as myfile:
    data=myfile.read()
    print([i.strip().split() for i in data.split(' \\n') if len(i.strip())&gt;0])
</code></pre>
<p><strong>output:</strong></p>
<pre><code>[['At', '210.001'], ['Au', '196.9665'], ['B', '10.81'], ['Ba', '137.34']] 
</code></pre>
<p>If you want to convert the 2nd element into a <code>float</code> then change the code into:</p>
<pre><code>def floatify_list_of_lists(nested_list):
    def floatify(s):
      try:
        return float(s)
      except ValueError:
        return s
    def floatify_list(lst):
        return [floatify(s) for s in lst]
    return [floatify_list(lst) for lst in nested_list]

with open('list.txt', 'r') as myfile:
    data = myfile.read()
    print(floatify_list_of_lists([i.strip().split() for i in data.split(' \\n') if len(i.strip())&gt;0]))
</code></pre>
<p><strong>output:</strong></p>
<pre><code>[['At', 210.001], ['Au', 196.9665], ['B', 10.81], ['Ba', 137.34]] 
</code></pre>
<p>If you do really need to have one string in all the nested lines then use:</p>
<pre><code>with open('list.txt', 'r') as myfile:
    data=myfile.read()
    print([[i.strip().replace(' ',',')] for i in data.split(' \\n') if len(i.strip())&gt;0])
</code></pre>
<p><strong>output:</strong></p>
<pre><code>[['At,210.001'], ['Au,196.9665'], ['B,10.81'], ['Ba,137.34']]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Using <code>replace()</code> to replace the space with <code>,</code>:</p>
<p>list.txt:</p>
<pre><code>At 210.001
Au 196.9665
B 10.81
Ba 137.34
</code></pre>
<p><strong>Hence</strong>:</p>
<pre><code>logFile = "list.txt"

with open(logFile) as f:
    content = f.readlines()      
# you may also want to remove empty lines
content = [l.strip() for l in content if l.strip()]        
for line in content:     
    print([line.replace(" ", ",")])  # for each line, replace the space with ,
</code></pre>
<p><strong>OUTPUT</strong>:</p>
<pre><code>['At,210.001']
['Au,196.9665']
['B,10.81']
['Ba,137.34']
</code></pre>
</div>
<span class="comment-copy">When reading the text file, you could use the <code>readlines()</code>method, returning a list where each object is a line in your document. For every object in that list, you can then apply <code>split()</code>. This will give you a list of the respective line, splitting the line into objects that are separated by a white space. However what I don't get from your question: Do want every line to be a single object in your list or every line to be a list?</span>
<span class="comment-copy">You could consider the csv module in the standard library</span>
<span class="comment-copy">Oh wow the first answer was exactly what I was looking for. Although, I do not want the second element to be a string, how do I convert so it will be a float instead?</span>
<div class="post-text" itemprop="text">
<p>I would like to plot two twiny x axis, according to <a href="https://pythonmatplotlibtips.blogspot.com/2018/01/add-second-x-axis-below-first-x-axis-python-matplotlib-pyplot.html" rel="nofollow noreferrer">https://pythonmatplotlibtips.blogspot.com/2018/01/add-second-x-axis-below-first-x-axis-python-matplotlib-pyplot.html</a></p>
<p>My original data is 
<a href="https://i.stack.imgur.com/NQadN.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/NQadN.png"/></a></p>
<p>My code :</p>
<pre><code>fig, ax = plt.subplots(figsize=(15,5))
index = data.coin
rects1 = ax.bar(index, data['message_count'])
ax.set_xlabel('Group')
ax.set_ylabel('message count')
ax.set_title('')
ax.legend()

ax2 = ax.twiny()
ax2.set_xticklabels(data.create_date)
ax2.xaxis.set_ticks_position('bottom') # set the position of the second x-axis to bottom
ax2.xaxis.set_label_position('bottom') # set the position of the second x-axis to bottom
ax2.spines['bottom'].set_position(('outward', 38))
ax2.set_xlabel('Create Date')
ax2.set_xlim(ax.get_xlim())
</code></pre>
<p>The plot I have:
<a href="https://i.stack.imgur.com/q2DMz.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/q2DMz.png"/></a></p>
<p>I dont know why the second axis does not match with the first one. I have tried adjusting the <code>ax2.set_xlim(ax.get_xlim())</code> but in vain.</p>
</div>
<div class="post-text" itemprop="text">
<p>Setting the x limit on the second axes objecct also changes the default x-tick positions for that axes. You can find how by printing <code>ax2.get_xticks()</code> before and after the <code>ax2.set_xlim(ax.get_xlim())</code> call.</p>
<p>You need to explicitly (re)set the x-tick positions once you change the x-limit, with <code>ax2.set_xticks()</code>, and set them to those for <code>ax</code>.</p>
<p>Below is a full example:</p>
<pre><code>import pandas as pd
import matplotlib.pyplot as plt

df = pd.DataFrame({'message_count': [557, 119, 108, 14, 9],
                   'coin': ['MEDX', 'CNX', 'IOST', 'AUTO', 'PPT'],
                   'create_date': ['2018-08-03 03:05:00',
                                   '2017-08-10 14:33:45',
                                   '2018-07-20 18:32:45',
                                   '2017-12-08 15:09:42',
                                   '2017-07-24 14:11:22']})
df['create_date'] = pd.to_datetime(df['create_date'])
print(df)

fig, ax = plt.subplots(figsize=(15,5))
index = df.coin
rects1 = ax.bar(index, df['message_count'])
ax.set_xlabel('Group')
ax.set_ylabel('message count')
ax.set_title('')
ax.legend()

ax2 = ax.twiny()
ax2.set_xticklabels(df.create_date)
ax2.xaxis.set_ticks_position('bottom') # set the position of the second x-axis to bottom
ax2.xaxis.set_label_position('bottom') # set the position of the second x-axis to bottom
ax2.spines['bottom'].set_position(('outward', 38))
ax2.set_xlabel('Create Date')
ax2.set_xlim(ax.get_xlim())
ax2.set_xticks(ax.get_xticks())
plt.tight_layout()
plt.savefig('twinplot.png')
</code></pre>
<p>which yields</p>
<p><a href="https://i.stack.imgur.com/GMJdE.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/GMJdE.png"/></a></p>
</div>
<span class="comment-copy">What do you mean by "I dont know why the second axis does not match with the first one."? They are matching perfectly and the ticks are aligned on top of each other. What output are you expecting?</span>
<span class="comment-copy">@Bazingaa The bottom labels are all shifted one position to the left. Compare the input table with the two sets of plot labels. That is also why the last item doesn't have a date label.</span>
<span class="comment-copy">@9769953 Exactly!</span>
<span class="comment-copy">Please make sure you create a <i>full</i> working example, including imports <i>and data</i>. The picture of your table 1/ is hard to read, 2/ is not copy-pasteable, 3/ is not copy-pasteable into a DataFrame, 4/ contains extra, unnecessary and distracting columns (such as two index columns, while in the code the "coin" column is used as index.</span>
<div class="post-text" itemprop="text">
<p>I want to run a locally stored .py program in the CMD line of windows because it is the only way I can call the programs from other programing enviroment.</p>
<p>When trying to do so I specify in the CMD line the location of python.exe (anaconda folders) and the location of the python program.</p>
<p>The problem is that whereas the programs work well when run in the anaconda environement (jupyter started from anaconda) they are missing the libraries installed in anaconda (the ones not included in the basic library, pandas numpy).</p>
<p>I find in <a href="https://stackoverflow.com/questions/53839857/anaconda-prompt-finds-libraries-cmd-python-doesnt-python-was-only-installe">here</a> exactly this same problem but trying to implement the solution proposed does not solve the problem in my case.</p>
<p>Situation:
Python 3.7 installed in Windows machine with anaconda.
Pandas and numpy present in the list of installed packages in the anaconda navigator. Pandas imported with no problem into the jupyter notebook with no problem.</p>
<p>Program writen in Jupyter notebook started from anaconda navigator.</p>
<p>Download .py file in a particular location of the hard disc.</p>
<p>Open CMD terminal and run</p>
<pre><code>C:\Users\xxxxxx&gt;C:\Users\xxxxxx\AppData\Local\Continuum\anaconda3\python.exe C:\Users\xxxxxx\pyCODE\pySoft.py 
</code></pre>
<p>Traceback (most recent call last):</p>
<pre><code> File "C:\Users\xxxxxx\pyCODE\pySoft.py", line 30, in &lt;module&gt; import pandas as pd

 ModuleNotFoundError: No module named 'pandas'
</code></pre>
<p>Following instructions in the above mentioned link I unstalled pandas and numpy in the anaconda prompt line</p>
<pre><code>(base) C:\Users\xxxxxx&gt;pip uninstall pandas
</code></pre>
<p>In principle the pandas should be uninstalled. </p>
<p>surprisingly enough the pandas package can still be found in the enviroments anaconda navigator (also after close and open), and the jupyter version works (importing pandas does not give error)</p>
<p>if I go again to the anaconda prompt and type:</p>
<pre><code>pip uninstall pandas
</code></pre>
<p>the message is:
    Skipping pandas as it is not installed.</p>
<p>So what is going on here?
where is and where is not installed pandas?
And above all what are the steps to run a pyhton program from </p>
<p>Btw, i tried to follow <a href="https://www.pythoncentral.io/execute-python-script-file-shell/" rel="nofollow noreferrer">this instructions</a> to run from CMD</p>
<p>thanks a lot</p>
<p>(xxxxxx for privacy reasons ofuscated)</p>
</div>
<span class="comment-copy">You need to add the location of the Anaconda python to your "Environment Variables" -- seems it's not on your path</span>
<span class="comment-copy">you can also try to use the <code>anaconda prompt</code>. there the paths are typically set correctly. (Press the windows key and type <code>ana</code>, then you should see it)</span>
<span class="comment-copy">I can not edit the "Environment Variables" in windows because I dont have administrative rights. (in case you are wondering, yes I could install pyhton with Anaconda)</span>
<span class="comment-copy">I tried adding the following to the .py code:  sys.path.append(r"C:\Users\JF30443\AppData\Local\Continuum\anaconda3\Lib\site-packages\blaze\compute") print(sys.path)</span>
<div class="post-text" itemprop="text">
<p>For a bachelors thesis, I need to count people using a video camera, and this as correct as possible. For this problem I make use of Python together with OpenCV. I know the neural networks like a CNN is the best solution to try and do this. Now the problem here is that for my thesis, I should not use Neural Networks.</p>
<p>I have been researching this topic quite often, but I keep finding object detection and tracking with Neural Network models on Tensorflow and Keras (Yolo, Mobilenet).
The only 'old school' methods that I have found is: background subtraction with mean width and height of a person and a method using HOG with SVM.
Are there any other algorithms I can use? (like knn or random forest instead of SVM)</p>
<p>Another question I still have and can't find a real answer too is how to use this in a video instead of an image. Do you split up the video frame by frame and then detect the person? Or is there another approach for this that I haven't found yet? I feel like doing the object recognition and detection for each frame will be pretty intensive for the machine it's running on. </p>
<p>Will it also be possible to detect multiple people in one frame?</p>
<p>I really hope somebody can help me with this matter, as I have been stuck on this part of my thesis for quite some time now. I want to make some progress again! Many thanks in advance!</p>
</div>
<div class="post-text" itemprop="text">
<ol>
<li><p>The first method - HAAR cascades as features + AdaBoost as classifier. Faster but worst - LBP instead HAAR.</p></li>
<li><p>HOG + linear SVM. And more: CoHOG, DPM,...</p></li>
<li><p>ICF (integral channel features) + forest.</p></li>
</ol>
<p>This is all the most important.</p>
<p><strong>Edit 1</strong>: 
And you can use more features (colors, symmetry features) and reduction technique: PCA, PLS etc. For example linear SVM is very fast but not robust for noise. Some researchers used reduction for feature vector size and gave the better results. A good paper "Vehicle Detection using Partial Least Squares": <a href="https://anikem.github.io/papers/Kembhavi_VehicleDetection_PAMI2011.pdf" rel="nofollow noreferrer">https://anikem.github.io/papers/Kembhavi_VehicleDetection_PAMI2011.pdf</a>
But DNNs showed much better results.</p>
</div>
<span class="comment-copy">There's a lot of literature on crowd density estimation from pre-CNN times - try to search for "crowd density estimation survey" on Google Scholar for a starting point. Articles earlier than 2010 are probably not using neural networks. I've skimmed over a few surveys, and it looks as if there were a lot of different approaches, e.g. using texture analysis, but I would guess that none of them can outperform a state of the art net like Faster-RCNN or Yolo</span>
<span class="comment-copy">I will look at them! Thanks a lot</span>
<span class="comment-copy">I am so sorry to bother you again, but I have found out about these algorithms. The only thing I can't find is why to use these 'combos'. Why not use HOG as feature extraction with forest as classifier? Why is it always HOG with a support vector classifier? why not HAAR + SVM. What am I not seeing?</span>
<span class="comment-copy">It's evolution. Only the most stable combinations remain. HAAR with integral image or LBP + AdaBoost is very fast,  it was a revolution in computer vision: smiles, faces, eyes detection in photo cameras. HOG + linear SVM was very robust for objects with structure: faces (in dlib library), pedestrians, license plates etc. CoHOG was used in Toshiba for automotive vision. ICF was very good for GPU before  DNN expansion.</span>
<div class="post-text" itemprop="text">
<p>I'd like to connect to a web service (using python) without going through a website. </p>
<p>The problem is that the website uses multiple web services with dynamic addresses. The only way I know how to check the web service address is to load the website in a browser, open the developer tools and check the web services column. </p>
<p>Is there a way I can check what the web service addresses are using Python?</p>
</div>
<span class="comment-copy">You can look into <a href="https://www.crummy.com/software/BeautifulSoup/" rel="nofollow noreferrer">BeautifulSoup</a> to parse HTML pages and find links in them.</span>
<span class="comment-copy">@Ralf thanks for the suggestion but the webservice URLs aren't in the html source of the page</span>
<div class="post-text" itemprop="text">
<p>I am writing <code>import mahotas as mt</code> in my python script. 
I get the error <code>ImportError: No module named mahotas</code></p>
<p>So I used this command to install </p>
<pre><code>$ sudo -H pip install mahotas
</code></pre>
<p>But it gives me the following error</p>
<pre><code>Requirement already satisfied: mahotas in /usr/local/lib/python3.5/dist-packages (1.4.5)
Requirement already satisfied: numpy in /usr/local/lib/python3.5/dist-packages (from mahotas) (1.16.2)
</code></pre>
<p>I have no idea what's happening here.</p>
</div>
<div class="post-text" itemprop="text">
<p>What are you using for code ? If Spyder, try select PYTHONPATH in tools. Add a path to  /usr/local/lib/python3.5/dist-packages</p>
</div>
<span class="comment-copy">No I am using atom. But when I tried python 3 it worked.</span>
<span class="comment-copy">Of course, if you were using python 2.x, and installed it in python 3.x file ;)</span>
<div class="post-text" itemprop="text">
<p>I have a text in file "File1" that contains the below text:</p>
<pre><code>-Accounting  
-HR

Some text  

-IT  
--Networks   
--Storage  
--DBA  
</code></pre>
<p>I need a piece of code that will read File1 line by line and replace "-" and "--" with appropriate HTML tags and save the end result shown below in a text file File2</p>
<pre><code>&lt;ul&gt;
&lt;li&gt;Accounting&lt;/li&gt;
&lt;li&gt;HR&lt;/li&gt;
&lt;/ul&gt;

Some text

&lt;ul&gt;&lt;li&gt;IT
       &lt;ul&gt;
          &lt;li&gt;Networks&lt;/li&gt;
          &lt;li&gt;Storage&lt;/li&gt;
          &lt;li&gt;DBA&lt;/li&gt;
         &lt;/ul&gt;
         &lt;/li&gt;&lt;/ul&gt;
</code></pre>
<p>So far I tried the code below. </p>
<p>I set two booleans that are used to check if the current line contains "-" or "--" to False initially. If there is a "-" or "--" in the current line then code adds appropriate tags in the beginning of the line, changes booleans to True and goes to the next line. </p>
<p>Now booleans are used to see if there was "-" or "--" in the previous line, if there were dashes it will add appropriate tags to the beginning of the line which should be in the previous line but we're already in the next line so. The other way would be to check if the next line starts with "-" or "--" but I am not sure how to. When I use next() the line is skipped. Would reading from two files at the same time with one being one line ahead and checking what it has in that next line be a better solution?  </p>
<pre><code>    single_dash_prev_line = False
    double_dash_prev_line = False
    for line in File1:
        current_line = line

        if line[0] == "-":
            if line[1] != "-":
                if single_dash_prev_line == False:
                    new_line = "&lt;ul&gt;&lt;li&gt;" + current_line[1:]
                    File2.write(new_line)
                    single_dash_prev_line = True
                elif single_dash_prev_line == True:
                    new_line = "&lt;/li&gt;&lt;li&gt;" + current_line[1:]
                    File2.write(new_line)
                    single_dash_prev_line = True


            elif line[1] == "-":
                if single_dash_prev_line == True:
                    new_line = "&lt;ul&gt;&lt;li&gt;" + line[2:]
                    print(new_line)
                    File2.write(new_line)
                    double_dash_prev_line = True
                elif double_dash_prev_line == True:
                    new_line = "&lt;/li&gt;&lt;li&gt;" + line[2:]
                    File2.write(new_line)
                    double_dash_prev_line = True

        elif single_dash_prev_line == True:
            new_line = "&lt;/li&gt;&lt;/ul&gt;" + current_line[1:]
            File2.write(new_line)
            single_dash_prev_line = False
        elif double_dash_prev_line == True:
            new_line = "&lt;/li&gt;&lt;/ul&gt;" + current_line[1:]
            File2.write(new_line)
            single_dash_prev_line = False

        else:
            single_dash_prev_line = False
            double_dash_prev_line = False
            File2.write(current_line)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The code below did what I needed.</p>
<pre><code>with open("finalfile.txt", 'w', encoding='utf-8') as File2, open("test.txt", "r", encoding='utf-8') as File1:
previous_line = ""
new_line = ""
double_dash_prev_line = False
single_dash_prev_line = False
for line in File1:
    current_line = line
    if line[0] == "-":
        if line[1] != "-":
            if single_dash_prev_line == False and double_dash_prev_line == False:
                new_line = "&lt;ul&gt;&lt;li&gt; " + current_line[1:]
                File2.write(new_line)
                single_dash_prev_line = True
                double_dash_prev_line = False
            elif single_dash_prev_line == True:
                new_line = "&lt;/li&gt;&lt;li&gt; " + current_line[1:]
                File2.write(new_line)
                single_dash_prev_line = True
                double_dash_prev_line = False
            elif double_dash_prev_line == True:
                new_line = "&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;&lt;ul&gt;&lt;li&gt; " + current_line[1:]
                File2.write(new_line)
                single_dash_prev_line = True
                double_dash_prev_line = False


        elif line[1] == "-":
            if single_dash_prev_line == True:
                new_line = "&lt;ul&gt;&lt;li&gt; " + line[2:]
                File2.write(new_line)
                double_dash_prev_line = True
                single_dash_prev_line = False
            elif double_dash_prev_line_line == True:
                new_line = "&lt;/li&gt;&lt;li&gt; " + line[2:]
                File2.write(new_line)
                double_dash_prev_line = True
                single_dash_prev_line = False
    elif single_dash_prev_line == True:
        new_line = "&lt;/li&gt;&lt;/ul&gt; " + current_line[1:]
        File2.write(new_line)
        single_dash_prev_line = False
        double_dash_prev_line = False
    elif double_dash_prev_line_line == True:
        new_line = "&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt; " + current_line[1:]
        File2.write(new_line)
        double_dash_prev_line = False
        single_dash_prev_line = False
    else:
        single_dash_prev_line = False
        double_dash_prev_line = False
        File2.write(current_line)
</code></pre>
</div>
<span class="comment-copy">Just learn how to write content to a file, then write content to a file named <code>index.html</code>. You can write HTML tags to that file :)</span>
<span class="comment-copy">Seb_ what did you try to do in solving this problem? We wan't to help make you a better programmer. So please show us what you tried. Assuming you don't know, I'll give you a hint: loop over de lines in the textfile, regex the "-" and substitute with place holders.</span>
<span class="comment-copy">@duhaime sorry should have been more clear. I know how to write to a file. I know how to add tags. But I have thousands of such text files which I will have to add HTML tags to so there is no option to add manually and would have done it already had it been a few pages.</span>
<span class="comment-copy">@Seb_ just read each of your files and generate a new corresponding html file--don't write html into the input files, generate new output files with your markup...</span>
<span class="comment-copy">@duhaime I think I wasn't clear again. What I need here is the logic that will be adding the appropriate tags depending on what in current and previous line. Or it could be rewritten to check current line and the next but I am not sure about this option because as I said the next() goes to the next line. Or perhaps reading from two files would be an option</span>
<div class="post-text" itemprop="text">
<p>I create a default dict in my code something like below:</p>
<blockquote>
<p>defaultdict(<code>&lt;class 'list'&gt;</code>, {'month': ['JAN', 'FEB'], 'car': ['baleno', 'santro'], 'measure': ['sales', 'expense']})</p>
</blockquote>
<p><code>cube = 'test'</code></p>
<p>Now I would like to print above dict in the below format by adding variable <code>cube</code>:</p>
<blockquote>
<p>['month', 'JAN', 'car', 'baleno', 'measure', 'sales', 'test']</p>
<p>['month', 'JAN', 'car', 'baleno', 'measure','expense', 'test']</p>
<p>['month', 'JAN', 'car', 'santro', 'measure', 'sales', 'test'] </p>
<p>['month', 'JAN', 'car', 'santro', 'measure', 'expense', 'test']</p>
<p>['month', 'FEB', 'car', 'baleno', 'measure','sales', 'test']</p>
<p>['month', 'FEB', 'car', 'baleno', 'measure','expense', 'test']</p>
<p>['month', 'FEB', 'car', 'santro', 'measure','sales', 'test']</p>
<p>['month', 'FEB', 'car', 'santro', 'measure','expense', 'test']</p>
</blockquote>
<p>I'm actually using three loops to achieve the above output, but would like to get a neat one.</p>
<pre><code>dim=['month','car','measure']
cube='test'
for b in itertools.product(*(k.values())):                                                  
        list1 = list()                                      
        for (f, c) in zip(b, dim):                                                         
            list1.append(c)                                 
            list1.append(f)                                 
        list1.append(cube)                             
        print(list1) 
</code></pre>
<p><strong>k</strong> is the default dict</p>
<p>PS: I'm new to PYTHON. Just using it for the couple of months.</p>
</div>
<div class="post-text" itemprop="text">
<p>Given the input is a dictionary, I don't think you can get much more efficient than nested for loops (note: itertools.product is equivalent to a for loop). You could possibly do it as a one liner using list comprehension, but this won't be more efficient and may be less readable.</p>
<p>Your implementation looks fine, here is a slightly more streamlined write up:</p>
<pre><code>k = {'month': ['JAN', 'FEB'], 
     'car': ['baleno', 'santro'], 
     'measure': ['sales', 'expense']}

# Grab the keys from the dictionary as opposed to hard-coding them
dim=k.keys()
cube='test'

# cartesian product of each key's set of values
for b in itertools.product(*k.values()):                                                
    list1 = list()
    # extending empty list by (key, value) for specific values in product b                         
    for pair in zip(dim, b):                                                         
        list1.extend(pair)                                 
    list1.append(cube)                             
    print(list1) 
</code></pre>
</div>
<span class="comment-copy">Have a look at <code>itertools.product</code></span>
<span class="comment-copy">I have updated the code I use. @BlueSheepToken I already use <code>itertools.product</code>, but not sure if I'm using it the right way!</span>
<span class="comment-copy">to me it looks ok. Unfortunatzly you cannot speed up this as it is already optimized</span>
<span class="comment-copy">Thanks for optimizing the code. But, looking for something to speed up the process. That dict <code>k</code> is just a small sample I gave you. But my real code has a very big dict.  The <code>for</code> loop in <code>itertools.product</code> iterates around <b>32616937604160</b> times, I'm able to parse only 150000 records per hour.</span>
<span class="comment-copy">@User1493 as I said, for calculating a cartesian product there isn't much more you can do in terms of efficiency than nested for loops. See similar implementations here: <a href="https://stackoverflow.com/questions/5228158/cartesian-product-of-a-dictionary-of-lists" title="cartesian product of a dictionary of lists">stackoverflow.com/questions/5228158/…</a> <a href="https://stackoverflow.com/questions/52190140/cartesian-product-of-dictionary-keys-and-values-python" title="cartesian product of dictionary keys and values python">stackoverflow.com/questions/52190140/…</a> etc</span>
<span class="comment-copy">@User1493 you may want to look into converting the dict to a dataframe and e.g. <code>melt</code> etc</span>
<div class="post-text" itemprop="text">
<p>Im trying to print all the values of a matrix in python2 by </p>
<pre><code>import numpy as np
np.set_printoptions(threshold=np.nan)
print myMatrix
</code></pre>
<p>but its giving me the error
<code>threshold must be numeric and non-NAN</code></p>
<p>In python3 I can print the array by</p>
<pre><code>import sys
numpy.set_printoptions(threshold=sys.maxsize)
print(myMatrix)
</code></pre>
<p>But why numpy.nan isn't working in python3</p>
</div>
<div class="post-text" itemprop="text">
<p><code>nunmpy.nan</code> was never <a href="https://github.com/numpy/numpy/issues/12987" rel="nofollow noreferrer">supposed to be supported</a>. This is why it doesn't work in python 3</p>
</div>
<div class="post-text" itemprop="text">
<p>I have a custom 'loading' image which I need to be able to start/stop a rotation animation while some action is occurring. I'm looking for code that will show me how to do this but I can't find anything specific to rotation in PyQt. I already have the following code which causes the image to rotate at the click of a button: </p>
<pre><code>import os
import sys

from PyQt5.QtWidgets import *
from PyQt5.QtGui import *
from PyQt5.QtCore import *

class myApplication(QWidget):

def __init__(self, parent=None):
    super(myApplication, self).__init__(parent)

    self.imgPath = os.path.join('path/to/image','image.svg')
    pixmap = QPixmap(self.imgPath)
    diag = (pixmap.width()**2 + pixmap.height()**2)**0.5

    self.label = QLabel()
    self.label.setMinimumSize(diag, diag)
    self.label.setAlignment(Qt.AlignCenter)
    self.label.setPixmap(pixmap)

    #---- Prepare a Layout ----

    grid = QGridLayout()

    button = QPushButton('Rotate 15 degrees')
    button.clicked.connect(self.rotate_pixmap)

    grid.addWidget(self.label, 0, 0)
    grid.addWidget(button, 1, 0)

    self.setLayout(grid)

    self.rotation = 0

def rotate_pixmap(self):

    pixmap = QPixmap(self.imgPath)
    self.rotation += 15
    transform = QTransform().rotate(self.rotation)
    pixmap = pixmap.transformed(transform, Qt.SmoothTransformation)

    #---- update label ----

    self.label.setPixmap(pixmap)

if __name__ == '__main__':

app = QApplication(sys.argv)

instance = myApplication()  
instance.show()    

sys.exit(app.exec_())
</code></pre>
<p>I found <a href="https://stackoverflow.com/questions/50286919/qpropertyanimation-for-rotating-qwidget">this C++ code</a> which shows how to create a rotation animation using <code>QVariantAnimation</code> and <code>QTransform</code>:</p>
<pre><code>class RotateMe : public QLabel {

    Q_OBJECT
public:
    explicit RotateMe(QWidget* parent = Q_NULLPTR) :
        QLabel(parent),
        pixmap(100, 100),
        animation(new QVariantAnimation )
    {
        resize(200, 200);
        pixmap.fill(Qt::red);

        animation-&gt;setDuration(10000);
        animation-&gt;setStartValue(0.0f);
        animation-&gt;setEndValue(90.0f);
        connect(animation, &amp;QVariantAnimation::valueChanged, [=](const QVariant &amp;value){
            qDebug()&lt;&lt;value;
            QTransform t;
            t.rotate(value.toReal());
            setPixmap(pixmap.transformed(t));
        });
        animation-&gt;start();
    }
private:
    QPixmap             pixmap;
    QVariantAnimation  *animation;
};
</code></pre>
<p>How can I re-write this in python? I can't find any examples which show how <code>QVariantAnimation</code> is used in PyQT. </p>
</div>
<div class="post-text" itemprop="text">
<p>The logic is similar as I show below:</p>
<pre><code>import os
from PyQt5 import QtCore, QtGui, QtWidgets

class RotateMe(QtWidgets.QLabel):
    def __init__(self, *args, **kwargs):
        super(RotateMe, self).__init__(*args, **kwargs)
        self._pixmap = QtGui.QPixmap()
        self._animation = QtCore.QVariantAnimation(
            self,
            startValue=0.0,
            endValue=360.0,
            duration=1000,
            valueChanged=self.on_valueChanged
        )

    def set_pixmap(self, pixmap):
        self._pixmap = pixmap
        self.setPixmap(self._pixmap)

    def start_animation(self):
        if self._animation.state() != QtCore.QAbstractAnimation.Running:
            self._animation.start()

    @QtCore.pyqtSlot(QtCore.QVariant)
    def on_valueChanged(self, value):
        t = QtGui.QTransform()
        t.rotate(value)
        self.setPixmap(self._pixmap.transformed(t))

class Widget(QtWidgets.QWidget):
    def __init__(self, parent=None):
        super(Widget, self).__init__(parent)
        label = RotateMe(alignment=QtCore.Qt.AlignCenter)
        img_path = os.path.join('path/to/image','image.svg')
        label.set_pixmap(QtGui.QPixmap(img_path))
        button = QtWidgets.QPushButton('Rotate')

        button.clicked.connect(label.start_animation)

        lay = QtWidgets.QVBoxLayout(self)
        lay.addWidget(label)
        lay.addWidget(button)


if __name__ == '__main__':
    import sys
    app = QtWidgets.QApplication(sys.argv)
    w = Widget()
    w.show()
    sys.exit(app.exec_())
</code></pre>
</div>
<span class="comment-copy">Perfect. Thanks very much!</span>
<div class="post-text" itemprop="text">
<p>I am trying to implement a Faster-RCNN model for object detection <a href="https://github.com/RockyXu66/Faster_RCNN_for_Open_Images_Dataset_Keras" rel="nofollow noreferrer">written by Yinghan Xu</a>. After I have trained and saved the model with <code>model_all.save('filename.h5')</code>, I am trying to freeze the Keras model as TensorFlow graph (as <code>.pb</code>) for inference using <a href="https://github.com/amir-abdi/keras_to_tensorflow/blob/master/keras_to_tensorflow.py" rel="nofollow noreferrer">keras_to_tensorflow.py</a> written by Amir Abdi. But when I try to convert it, I get a <code>ValueError: Unknown layer: roipoolingconv</code> due to a custom <code>RoiPoolingConv</code> layer:</p>
<pre><code>class RoiPoolingConv(Layer):
'''ROI pooling layer for 2D inputs.
See Spatial Pyramid Pooling in Deep Convolutional Networks for Visual Recognition,
K. He, X. Zhang, S. Ren, J. Sun
# Arguments
    pool_size: int
        Size of pooling region to use. pool_size = 7 will result in a 7x7 region.
    num_rois: number of regions of interest to be used
# Input shape
    list of two 4D tensors [X_img,X_roi] with shape:
    X_img:
    `(1, rows, cols, channels)`
    X_roi:
    `(1,num_rois,4)` list of rois, with ordering (x,y,w,h)
# Output shape
    3D tensor with shape:
    `(1, num_rois, channels, pool_size, pool_size)`
'''
def __init__(self, pool_size, num_rois, **kwargs):

    self.dim_ordering = K.image_dim_ordering()
    self.pool_size = pool_size
    self.num_rois = num_rois

    super(RoiPoolingConv, self).__init__(**kwargs)

def build(self, input_shape):
    self.nb_channels = input_shape[0][3]   

def compute_output_shape(self, input_shape):
    return None, self.num_rois, self.pool_size, self.pool_size, self.nb_channels

def call(self, x, mask=None):

    assert(len(x) == 2)

    # x[0] is image with shape (rows, cols, channels)
    img = x[0]

    # x[1] is roi with shape (num_rois,4) with ordering (x,y,w,h)
    rois = x[1]

    input_shape = K.shape(img)

    outputs = []

    for roi_idx in range(self.num_rois):

        x = rois[0, roi_idx, 0]
        y = rois[0, roi_idx, 1]
        w = rois[0, roi_idx, 2]
        h = rois[0, roi_idx, 3]

        x = K.cast(x, 'int32')
        y = K.cast(y, 'int32')
        w = K.cast(w, 'int32')
        h = K.cast(h, 'int32')

        # Resized roi of the image to pooling size (7x7)
        rs = tf.image.resize_images(img[:, y:y+h, x:x+w, :], (self.pool_size, self.pool_size))
        outputs.append(rs)


    final_output = K.concatenate(outputs, axis=0)

    # Reshape to (1, num_rois, pool_size, pool_size, nb_channels)
    # Might be (1, 4, 7, 7, 3)
    final_output = K.reshape(final_output, (1, self.num_rois, self.pool_size, self.pool_size, self.nb_channels))

    # permute_dimensions is similar to transpose
    final_output = K.permute_dimensions(final_output, (0, 1, 2, 3, 4))

    return final_output


def get_config(self):
    config = {'pool_size': self.pool_size,
              'num_rois': self.num_rois}
    base_config = super(RoiPoolingConv, self).get_config()
    return dict(list(base_config.items()) + list(config.items()))
</code></pre>
<p>I have looked at most of the resources out there and almost all of them suggest to comment out this layer. But since this layer is important for object detection, I was wondering if a workaround is possible or not. </p>
<p>The complete traceback of error (note: I've saved filename as <code>freezekeras.py</code>, contents are same as <code>keras_to_tensorflow.py</code>):</p>
<pre><code>Using TensorFlow backend.
Traceback (most recent call last):


File "freezekeras.py", line 181, in &lt;module&gt;
    app.run(main)
  File "/usr/local/lib/python3.5/dist-packages/absl/app.py", line 300, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.5/dist-packages/absl/app.py", line 251, in _run_main
    sys.exit(main(argv))
  File "freezekeras.py", line 127, in main
    model = load_model(FLAGS.input_model, FLAGS.input_model_json, FLAGS.input_model_yaml)
  File "freezekeras.py", line 105, in load_model
    raise wrong_file_err
  File "freezekeras.py", line 62, in load_model
    model = keras.models.load_model(input_model_path)
  File "/usr/local/lib/python3.5/dist-packages/keras/engine/saving.py", line 419, in load_model
    model = _deserialize_model(f, custom_objects, compile)
  File "/usr/local/lib/python3.5/dist-packages/keras/engine/saving.py", line 225, in _deserialize_model
    model = model_from_config(model_config, custom_objects=custom_objects)
  File "/usr/local/lib/python3.5/dist-packages/keras/engine/saving.py", line 458, in model_from_config
    return deserialize(config, custom_objects=custom_objects)
  File "/usr/local/lib/python3.5/dist-packages/keras/layers/__init__.py", line 55, in deserialize
    printable_module_name='layer')
  File "/usr/local/lib/python3.5/dist-packages/keras/utils/generic_utils.py", line 145, in deserialize_keras_object
    list(custom_objects.items())))
  File "/usr/local/lib/python3.5/dist-packages/keras/engine/network.py", line 1022, in from_config
    process_layer(layer_data)
  File "/usr/local/lib/python3.5/dist-packages/keras/engine/network.py", line 1008, in process_layer
    custom_objects=custom_objects)
  File "/usr/local/lib/python3.5/dist-packages/keras/layers/__init__.py", line 55, in deserialize
    printable_module_name='layer')
  File "/usr/local/lib/python3.5/dist-packages/keras/utils/generic_utils.py", line 138, in deserialize_keras_object
    ': ' + class_name)
ValueError: Unknown layer: RoiPoolingConv
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Try to specify the custom layer explicitly:</p>
<pre><code>model = load_model('my_model.h5', custom_objects={'RoiPoolingConv': RoiPoolingConv})
</code></pre>
<p>Obviously, you have to re-write the <code>keras_to_tensorflow.py</code> script. See <em>Handling custom layers (or other custom objects) in saved models</em> section under <a href="https://keras.io/getting-started/faq/" rel="nofollow noreferrer">Keras FAQ</a>.</p>
</div>
<span class="comment-copy">Please provide the complete trace stack of the error.</span>
<span class="comment-copy">Sure! I've added it.</span>
<span class="comment-copy">Thank you! I wasn't searching at the right place, I modified the code and it works.</span>
<div class="post-text" itemprop="text">
<p>I have a dataframe with date values and would like to manipulate them to 1 Jan or later. Since I need to do this element-wise, I use <code>np.maximum()</code>. The code below however gives </p>
<p><code>TypeError: Cannot compare type 'Timestamp' with type 'int'</code>.</p>
<p>What's the appropriate method to deal with this kind of data type?</p>
<pre><code>import pandas as pd
import numpy as np

df = pd.DataFrame({'date': np.arange('1999-12', '2000-02', dtype='datetime64[D]')})
df['corrected_date'] = np.maximum(pd.to_datetime('20000101', format='%Y%m%d'), df['date'])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>For me working comparing with <code>Series</code>:</p>
<pre><code>s  = pd.Series(pd.to_datetime('20000101', format='%Y%m%d'), index=df.index)
df['corrected_date'] = np.maximum(s, df['date'])
</code></pre>
<p>Or with <code>DatetimeIndex</code>:</p>
<pre><code>i  = np.repeat(pd.to_datetime(['20000101'], format='%Y%m%d'), len(df))
df['corrected_date'] = np.maximum(i, df['date'])
</code></pre>
</div>
<span class="comment-copy">Use <code>np.datetime64('2000-01-01', dtype='datetime64[D]')</code> for comparison?</span>
<div class="post-text" itemprop="text">
<p>I have several .vti files . How can I convert .vti files into a standard format of 2D images? I've tried ParaView, but didn't find any option to convert in one of above mentioned formats like JPEG or PNG.</p>
</div>
<div class="post-text" itemprop="text">
<p>In ParaView: load your vti file, then in the File menu click "Save Data..." and chose the image file format you prefer (I tested with PNG, it works). </p>
<p>In Python, this script reads test.vti and saves test.jpg: </p>
<pre><code>import vtk

reader = vtk.vtkXMLImageDataReader()
reader.SetFileName("test.vti")
reader.Update()
image = reader.GetOutput()

writer = vtk.vtkJPEGWriter()
writer.SetInputData(image)
writer.SetFileName("test.jpg")
writer.Write()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/30123319/converting-string-to-tuple-in-python">converting string to tuple in python</a>
<span class="question-originals-answer-count">
                    5 answers
                </span>
</li>
</ul>
</div>
<p>I have a string:</p>
<pre><code>s = "(1,2)"
</code></pre>
<p>How do I turn it into a tuple?
I can't cast it into a tuple, because:</p>
<pre><code>tuple(s)
</code></pre>
<p>turns s into:</p>
<pre><code>('(', '1', ',', '2', ')')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Not that fancy but does the job:</p>
<pre><code>s = "(1,2)"    
print(tuple(map(int, s.strip("()").split(","))))
</code></pre>
<p><strong>OUTPUT</strong>:</p>
<pre><code>(1, 2)
</code></pre>
</div>
<span class="comment-copy">strip those brackets away!</span>
<div class="post-text" itemprop="text">
<p>I am beginner in python and the simple task ---I am doing-- fetch all the branches on git repository and print on console. </p>
<p>I see below piece of code runs fine but all time it gives me different number of branches list for the same repository,I see subprocess.popen() is non blocking so i tried to use wait() and communicate() to hold the execution but wait() is never ending the process and communicate() gives me different number of branches each time i run the code.(different than running the command on git bash)</p>
<p>the repositories may take different time to complete its execution. Any help to have listed all the branches.</p>
<pre><code>proc = subprocess.Popen(['git', 'ls-remote', '--heads' , url],
                        stdin = subprocess.PIPE,
                        stdout=subprocess.PIPE,
                        stderr=subprocess.STDOUT, shell=True)
while proc.poll() is None:
    out = proc.stdout.readline()
    print (out)
proc.communicate()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>proc = subprocess.Popen(['git', 'ls-remote', '--heads' , url],
                        stdin = subprocess.PIPE,
                        stdout=subprocess.PIPE,
                        stderr=subprocess.STDOUT, shell=True)
for out in proc.stdout:
    print (out)

proc.wait()
proc.stdout.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I'm having trouble trying to make this work</p>
<pre><code>import requests
import random
response = requests.get("https://cdn.discordapp.com/attachments/480168592164257792/557872162661335040/aaaaa.txt")
data = response.text
for line in data:
    print(line)
</code></pre>
<p>I am trying to pull a txt file from the internet, and be able to use the list inside of the text file. </p>
<p>Right now all it does is assume each letter is a different string(?)</p>
</div>
<div class="post-text" itemprop="text">
<p>The attribute <code>response.text</code> is a string, so iterating over it will give you individual chars. You can split the string by spaces (or maybe be newlines) to get what you need (I also added a few print statements to show the steps):</p>
<pre><code>import requests
response = requests.get(
    "https://cdn.discordapp.com/attachments/480168592164257792/557872162661335040/aaaaa.txt")
print('response.text type:', type(response.text))
print('response.text len:', len(response.text))
print(response.text)

print()
print('splitting by spaces:')
for i, s in enumerate(response.text.split()):
    print(i, s)

print()
print('splitting by newlines:')
for i, line in enumerate(response.text.split('\n')):
    print(i, line)
</code></pre>
<p>The code gives this output:</p>
<pre><code>response.text type: &lt;class 'str'&gt;
response.text len: 21
a = ["please","work"]

splitting by spaces:
0 a
1 =
2 ["please","work"]

splitting by newlines:
0 a = ["please","work"]
</code></pre>
<hr/>
<p>@bruno suggested in a comment to use <a href="https://docs.python.org/3.7/library/stdtypes.html#str.splitlines" rel="nofollow noreferrer"><code>str.splitlines()</code></a>; this will work even if the response is bytes, since there also exists the method <a href="https://docs.python.org/3.7/library/stdtypes.html#bytes.splitlines" rel="nofollow noreferrer"><code>bytes.splitlines()</code></a>.</p>
</div>
<div class="post-text" itemprop="text">
<p>response.text seems to be characters, if you loop over them you get each string. (Read about how Python handles strings).
In this case Python doesn't know what a "line" is. So split the data with newlines and try again:</p>
<pre><code>import requests
import random
  response = requests.get("https://cdn.discordapp.com/attachments/480168592164257792/557872162661335040/aaaaa.txt")
data = response.text
for line in data.split("\n"):
  print(line)
</code></pre>
</div>
<span class="comment-copy">You want data.splitlines() instead of data.split("\n") (can make a difference if response.text is a byte string and uses another newline marker).</span>
<span class="comment-copy">@brunodesthuilliers I added that observation to my answer</span>
<span class="comment-copy">You want <code>data.splitlines()</code>  instead of <code>data.split("\n")</code> (can make a difference if <code>response.text</code> is a byte string and uses another newline marker).</span>
<div class="post-text" itemprop="text">
<p>It's a part of <code>html</code>-code of page, where I should click the button</p>
<pre><code>&lt;div class="add-company-form__form-control add-company-form__submit"&gt;
    &lt;button class="button button_theme_islands button_size_xl button_view_action button_type_submit button__control i-bem" data-bem='{"button":{}}' role="button" type="submit"&gt;
        &lt;span class="button__text"&gt;Добавить организацию&lt;/span&gt;
    &lt;/button&gt;
&lt;/div&gt;
</code></pre>
<p>I try to click on the button with</p>
<pre><code>driver.find_element_by_xpath("//div[@class='add-company-form__submit']/button").click()
</code></pre>
<p>but it returns</p>
<pre><code>NoSuchElementException: Message: no such element: Unable to locate element: {"method":"xpath","selector":"//div[@class='add-company-form__submit']/button"}
</code></pre>
<p>How can I fix that?</p>
</div>
<div class="post-text" itemprop="text">
<p>You should try instantiating a WebDriver wait before clicking the button:</p>
<pre><code>WebDriverWait wait = new WebDriverWait(driver, 10);
wait.until(ExpectedConditions.elementToBeClickable(By.XPATH, "//button[@class='button button_theme_islands button_size_xl button_view_action button_type_submit button__control i-bem']"));
</code></pre>
<p>NOTE:</p>
<p>I used Java syntax, but it should be very similar in Python.</p>
</div>
<div class="post-text" itemprop="text">
<p>Try following Xpath.</p>
<pre><code>  WebDriverWait(driver, 20).until(EC.element_to_be_clickable((By.XPATH, "//button[@class='button button_theme_islands button_size_xl button_view_action button_type_submit button__control i-bem']")))
</code></pre>
<p>If you want to use CssSelector try this.</p>
<pre><code>   WebDriverWait(driver, 20).until(EC.element_to_be_clickable((By.CSS_SELECTOR, "button.button_theme_islands")))
</code></pre>
</div>
<span class="comment-copy">Can you share the url?</span>
<span class="comment-copy">@QHarr it's not unique on the page</span>
<span class="comment-copy">can it be that it's in an iFrame?</span>
<span class="comment-copy">The problem is that your XPath is not correct. You have <code>@class='add-company-form__submit'</code> but in fact the class has more than class name, <code>class="add-company-form__form-control add-company-form__submit"</code>. You can change it to <code>//div[@class='add-company-form__form-control add-company-form__submit']/button</code> or probably even <code>//span[.='Добавить организацию']</code></span>
<div class="post-text" itemprop="text">
<p>I have the following situation:</p>
<p><strong>A</strong> - Django web application (public)</p>
<p><strong>B</strong> - Web application written mostly in PHP (front-end + back-end)</p>
<p><strong>C</strong> - Back-end Python server (used for data management)</p>
<p><strong>D</strong> - Back-end Python server (used for machine learning tasks)</p>
<p>The application A listen the MySql database called <strong>DB01</strong>, while the application C listen the MySql database called <strong>DB02</strong>.
All these applications are deployed on AWS.</p>
<p>At present these applications interact in the following ways:</p>
<blockquote>
<p><strong>B</strong> send a messages to <strong>C</strong>, <strong>C</strong> process the message and reply to <strong>B</strong>.</p>
</blockquote>
<p>or</p>
<blockquote>
<p><strong>B</strong> send a message to <strong>C</strong>,  <strong>C</strong> send a message to <strong>D</strong>,  <strong>D</strong> reply to <strong>C</strong> and <strong>C</strong> reply to <strong>B</strong>.</p>
</blockquote>
<p>The next challenge is to design a new pipeline:</p>
<blockquote>
<p><strong>A</strong> send a message to <strong>D</strong>, (this message require a lot of time to be
  COMPLETELY processed and it requires data from the database <strong>DB02</strong>) so <strong>D</strong> will calculate partial results and send
  back to <strong>A</strong> (in this way using Javascript on Django front-end the user
  could visualise a page that automatically updates it's content as soon
  as new data are pushed to it).</p>
</blockquote>
<p>The question is: "How could be designed this pipeline? Are there any frameworks in Python that helps in the development of this kind of solution?"</p>
<p>Just to take in mind that it's not possible to merge different web application, they need to exist as they are (business constraint).</p>
</div>
<span class="comment-copy">Look at <a href="https://nameko.readthedocs.io/en/stable/" rel="nofollow noreferrer">nameko</a>. may be useful</span>
<div class="post-text" itemprop="text">
<p>Good morning everyone,</p>
<p>I have an issue when using Scrapy. I would like to get the data contained in the column "commune" of the table from this url: <a href="https://fr.wikipedia.org/wiki/Liste_des_communes_de_Belgique_par_population" rel="nofollow noreferrer">https://fr.wikipedia.org/wiki/Liste_des_communes_de_Belgique_par_population</a></p>
<p>Here is my Spider:</p>
<pre><code>import scrapy
import json

class communes_spider(scrapy.Spider):
    name = "communes"

    def start_requests(self):
        urls = [
            'https://fr.wikipedia.org/wiki/Liste_des_communes_de_Belgique_par_population'
        ]
        for url in urls:
            yield scrapy.Request(url=url, callback=self.parse)

    def parse(self, response):
        yield response.css('table.wikitable td a::text').getall()
</code></pre>
<p>I'm using the terminal to crawl the page:</p>
<pre><code>scrapy crawl communes
</code></pre>
<p>However it does not output the data of the column "commune". Therefore I cannot store them on a json file. Does someone have an insight on what is going on here ? </p>
<p>Thanks in advance !</p>
</div>
<div class="post-text" itemprop="text">
<p>Spider must return Request, BaseItem, dict or None but you are returning a list </p>
<p>Please change your code into this </p>
<pre><code>import scrapy
import json

class communes_spider(scrapy.Spider):
    name = "communes"

    def start_requests(self):
        urls = [
            'https://fr.wikipedia.org/wiki/Liste_des_communes_de_Belgique_par_population'
        ]
        for url in urls:
            yield scrapy.Request(url=url, callback=self.parse)

    def parse(self, response):
        yield {'communes':response.css('table.wikitable td a::text').getall()}
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I have two dockerfiles, test and result. A python script running in test container has to create the image for result using docker sdk. I have both the dockerfiles and the python script for test copied into the workdirectory of the test. However when i get an error in test script saying No such file or directory. </p>
<p>Dockerfile of test:</p>
<pre><code>FROM python:3.7.2-slim
WORKDIR /test
COPY . /test
RUN pip install docker 
ENV PYTHONPATH="$PYTHONPATH:/test"
CMD ["python", "test.py"]
</code></pre>
<p>test.py:</p>
<pre><code>// dockerfile of result is named result
import docker
client = docker.from_env()
image = client.images.build(path="/test", dockerfile='result') 
container = client.containers.run(image)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>When you do</p>
<pre><code>COPY . /test
</code></pre>
<p>You copy everything of folder that is docker-compose.yml.</p>
<p>But when you are in test.py probably you are in another folder.
So you need to back levels of folder to acess /test.</p>
</div>
<span class="comment-copy">I'm not using Docker Compose</span>
<span class="comment-copy">If you can try it with docker compose, maybe it could help you.</span>
<div class="post-text" itemprop="text">
<p>I'm using <strong>latest</strong> version of python and robot framework with DatabaseLibrary (<a href="https://franz-see.github.io/Robotframework-Database-Library/api/1.0.1/DatabaseLibrary.html" rel="nofollow noreferrer">https://franz-see.github.io/Robotframework-Database-Library/api/1.0.1/DatabaseLibrary.html</a>)</p>
<p>And I have problem with SELECT from database when I try using Unicode character like this: select * from labcamprodfull where PRODUCTNAME like '%<strong>ščť</strong>%'</p>
<p><strong>Then I execute/run test and i get this error:</strong>
UnicodeEncodeError: 'ascii' codec can't encode character '\xae' in position 54: ordinal not in range(128)</p>
<p><strong><em>Here is my code:</em></strong></p>
<pre><code>*** Settings ***
Resource  ../globalVariables.robot
Library  DatabaseLibrary

*** Variables ***
${DB_LOAD_CONNECT_STRING} =  '${userLoad}/${passwordDb}@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=${hostnameDb})(PORT=${portDb}))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=${sid})))'
${originalSpecialCharacter}  ®

*** Test Cases ***
Validate_if_special_character_Original_symbol_is_correctly_saved_in_database

    ${byte_string}=  Encode String To Bytes     ${originalSpecialCharacter}  UTF-8
    log to console  bytes is
    log to console  ${byte_string}
    ${_string} =  Decode Bytes To String  ${byte_string}  UTF-8
    log to console  encoded string is
    log to console  ${_string}

    Connect To Database Using Custom Params  cx_Oracle  ${DB_LOAD_CONNECT_STRING}
        ${rowCount}  Row Count  select * from labcamprodfull where PRODUCTNAME like '%${_string}%'
        log to console  Product count with original symbol in name is
        log to console  ${rowCount}
    Disconnect from database
</code></pre>
<p><strong>Then I execute/run test and i get this error:</strong>
UnicodeEncodeError: 'ascii' codec can't encode character '\xae' in position 54: ordinal not in range(128)</p>
</div>
<div class="post-text" itemprop="text">
<p>The default encoding for cx_Oracle is indeed ASCII. If you can set the encoding for the connection upon creation, all should be well. With basic cx_Oracle that would be done as follows:</p>
<p><code>cx_Oracle.connect(user, password, dsn, encoding="UTF-8", nencoding="UTF-8")</code></p>
<p>I'm not sure how that is done with the tool you are using but hopefully that will be sufficient to get you going.</p>
<p>The other option is to the set the environment variable NLS_LANG as in</p>
<p><code>export NLS_LANG=.AL32UTF8</code></p>
<p>and then run your application.</p>
</div>
<span class="comment-copy"><b>I used this connected string</b>: ${DB_LOAD_CONNECT_STRING} =  '${userLoad}/${passwordDb}@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=${hostnameDb})(PORT=${portDb}))(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=${sid})))'  <b>where I can add this encoding parameters</b>?</span>
<span class="comment-copy">Only when you create the connection as noted in my answer. Or you can set the environment variable NLS_LANG as I also suggested.</span>
<div class="post-text" itemprop="text">
<p><strong>Sample DF:</strong></p>
<pre><code>ID   Name        Price     Date             Fit_Test
1    Apple         10      2018-01-15          Super_Fit
2    Apple         10      2018-01-15          Super_Fit
3    Apple         10      2019-01-15          Super_Fit

4    Orange        12      2019-02-15          Not_Fit
5    Orange        12      2018-09-25          Not_Fit
6    Orange        12      NaT                 Not_Fit
7    Orange        12      2028-01-25          Not_Fit

8    Banana        15      2019-12-25          Medium_Fit
9    Banana        15      NaT                 Medium_Fit

10   Cherry         30     2021-06-23          Super_Fit

11   PineAp         30     2023-02-03          Medium_Fit
12   PineAp         30     2020-12-13          Medium_Fit
</code></pre>
<p><strong>Expected DF:</strong></p>
<pre><code>ID   Name        Price     Date             Fit_Test
1    Apple         10      2018-01-15          Super_Fit
2    Apple         10      2018-01-15          Super_Fit
3    Apple         10      2019-01-15          Super_Fit

7    Orange        12      2028-01-25          Not_Fit

8    Banana        15      2019-12-25          Medium_Fit
9    Banana        15      NaT                 Medium_Fit

10   Cherry         30     2021-06-23          Super_Fit

11   PineAp         30     2023-02-03          Medium_Fit
</code></pre>
<p><strong>Problem Statement:</strong></p>
<p>I want to <code>group-by</code> by <code>Name</code> and <code>Price</code> and then filter based on <code>Date</code> with <code>Fit_Test</code> as conditional column.</p>
<ol>
<li><p>If Fit_Test is <code>Super_Fit</code> then don't the no operation is needed. <strong>(Rows 1,2,3 and 10 is same in Input and Expected DF)</strong></p></li>
<li><p>If within a <code>Name</code> and <code>Price</code> conditions and Fit_Test is not <code>Super_Fit</code> and there is no <code>NaT</code> in that group then compare the dates, whichever has the <strong>highest date keep it</strong> <strong>(ID 11&amp;12 and in Expected 12 is deleted)</strong></p></li>
<li><p>If within a <code>Name</code> and <code>Price</code> conditions and Fit_Test is not <code>Super_Fit</code> and there is a <code>NaT</code> in that group:</p>
<p>3.1 If the count in that group is greater than 2, then compare the dates, whichever has the <strong>highest date keep it</strong> <strong>(ID 4,5,6,7 and in Expected 4,5,6 is deleted)</strong></p>
<p>3.2 If the count in that group is equal to 2, then keep both the rows  ** 
 (ID 8,9 and in Expected 8,9 is there)**</p></li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p>Use:</p>
<pre><code>df['Date'] = pd.to_datetime(df['Date'])

m1 = df['Fit_Test'].eq('Super_Fit').groupby([df['Name'],df['Price']]).transform('all')

m2 = df['Date'].notna().groupby([df['Name'],df['Price']]).transform('all')

m22 = df['Date'].eq(df.groupby(['Name', 'Price'])['Date'].transform('max'))

m3 = df.groupby(['Name', 'Price'])['Date'].transform('size').eq(2)

df = df[m1 | (m2 &amp; m22) | (~m2 &amp; m3) | (~m2 &amp; m22)]
#it seems conditions should be simplify
#df = df[m1 | m22 | (~m2 &amp; m3)]
print (df)
    ID    Name  Price       Date    Fit_Test
0    1   Apple     10 2018-01-15   Super_Fit
1    2   Apple     10 2018-01-15   Super_Fit
2    3   Apple     10 2019-01-15   Super_Fit
6    7  Orange     12 2028-01-25     Not_Fit
7    8  Banana     15 2019-12-25  Medium_Fit
8    9  Banana     15        NaT  Medium_Fit
9   10  Cherry     30 2021-06-23   Super_Fit
10  11  PineAp     30 2023-02-03  Medium_Fit
</code></pre>
</div>
<span class="comment-copy">What have you tried so far? Where you get stuck?</span>
<span class="comment-copy">I am not able to write queries to chain these conditions. For Point 1, I have <code>m1 = df['Fit_Test'].eq('Super_Fit').groupby([df['Name'],df['Price']]).transform('all')</code>. I want similar queries for Point 2 &amp;3 so I can chain them</span>
<span class="comment-copy">I don't think there is a straight forward way to do this, filter each condition from main df and concat result once, would be my choice.</span>
<span class="comment-copy">Getting this warning <code>FutureWarning: In the future, 'NAT == x' and 'x == NAT' will always be False.</code> for <code>m22</code></span>
<span class="comment-copy">@RahulAgarwal - what is your pandas version?</span>
<span class="comment-copy">0.23.0 ,my pandas version</span>
<span class="comment-copy">@RahulAgarwal - for me it working correctly in pandas 0.24.2</span>
<span class="comment-copy">cool will update</span>
<div class="post-text" itemprop="text">
<p>I'm trying to write code using Tensorflow Probability to classify a set of samples (coming from multiple Gaussian distributions) using the EM algorithm.</p>
<p>As I want to write this code for any generic problem (I want it to work if the samples come from 2 Gaussian distributions or 8 Gaussian distributions).</p>
<p>The problem that I have right now is that <strong>I can't find a way to create an array of tfd.Normal</strong>.</p>
<p>I want to have it as an array (or another similar type of data) because this way I can work with an indeterminate number of distributions.</p>
<p><strong>Can anyone help me with this problem?</strong></p>
<p><strong>EDIT</strong>: Could be a solution the following code?</p>
<pre><code>true_mu = np.array([20,60], dtype=np.float64)
true_sigma = np.array([8,4], dtype=np.float64)  
true_dist = tfd.Normal(loc=true_mu, scale=true_sigma)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>TFP distributions are batch capable out of the box. Your code should work, and represents a vector of 2 normal distributions, where the first is <code>N(X|20, 8)</code> and the second is <code>N(X|60, 4)</code>.</p>
<p>You can query this by <code>true_dist.batch_shape</code> (which will return <code>[2]</code> in this case).</p>
<p>You can now sample: <code>true_dist.sample()</code> (returns a float64 with shape <code>[2]</code>).</p>
<p>You can compute probabilities: <code>true_dist.log_prob(0)</code> (returns a float64 with shape <code>[2]</code>, representing <code>[log N(0|20, 8), log N(0|60, 4)]</code>).</p>
<p>You can estimate independent probs for each batch member: <code>true_dist.log_prob([0, 1])</code> (returns a <code>float64</code> with shape <code>[2]</code>, representing <code>[log N(0|20, 8), log N(1|60, 4)]</code>).</p>
<p>Also note that TFP distributions broadcast their parameters, so if you want two normals with the same loc and different scale, you can write <code>tfd.Normal(0, [10, 20])</code>.</p>
</div>
<span class="comment-copy">Just check <a href="https://www.tensorflow.org/api_docs/python/tf/distributions/Normal" rel="nofollow noreferrer">this</a></span>
<span class="comment-copy">Thanks! Do you know if there is anyway to generate 200 samples of 1 distribution and 500 of the other one? The only way I find is: 1. Generate 500 samples and for the first one take the first 200 and discard the other 300. 2. Generate 500 samples and only take the second column, generate 200 samples and only take the first column.</span>
<span class="comment-copy">You could write <code>d[0].sample(200), d[1].sample(500)</code>, but note that distribution slicing is a new feature, you would need to use <code>pip install tfp-nightly</code></span>
<div class="post-text" itemprop="text">
<p>I have built a multi-lingual website with django. My problem is that when the user changes localization all floats turn from dot-based to comma-based (e.g. the "4.2" become "4,2"). </p>
<p>I have created a template filter that replaces comma separators with dots in order to handle this situation but I think it is not the best solution as there are many places that use floats. </p>
<p>Can I do that on the back-end while keeping all other localization settings?</p>
</div>
<span class="comment-copy">I had a similar issue over a year ago in the django admin (see <a href="https://stackoverflow.com/questions/48545392/thousand-separator-not-applied-in-django-admin">my question</a>); I don't have a good solution, just a workaround using a custom template filter, probably very similar to your solution.</span>
<div class="post-text" itemprop="text">
<p>I´m trying to obtain a list of the second value inside each list. </p>
<p>For example for 'val2':</p>
<pre><code>['xe-1/2/1.322','xe-9/1/2']
</code></pre>
<p>The original list looks something like this:</p>
<pre><code>l = [('val1', 'ae4.0'),
('val1', 'xe-9/1/7.0'),
('val1', 'xe-1/2/1.1151'),
('val2', 'xe-1/2/1.322'),
('val2', 'xe-9/1/2'),
('val3', 'xe-9/1/2'),
('val3', 'xe-1/2/1'),
('val3', 'xe-1/2/1.748')]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can just use a list comprehension and return the second element from the tuples if the first one matches with <code>val2</code>:</p>
<pre><code>l = [('val1', 'ae4.0'), ('val1', 'xe-9/1/7.0'), ('val1', 'xe-1/2/1.1151'), 
     ('val2', 'xe-1/2/1.322'), ('val2', 'xe-9/1/2'), ('val3', 'xe-9/1/2'), 
     ('val3', 'xe-1/2/1'), ('val3', 'xe-1/2/1.748')]

[i[1] for i in l if i[0] == 'val2']
# ['xe-1/2/1.322', 'xe-9/1/2']
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can create a dictionary with keys as the first value :</p>
<pre><code>l = [('val1', 'ae4.0'), ('val1', 'xe-9/1/7.0'), ('val1', 'xe-1/2/1.1151'), 
     ('val2', 'xe-1/2/1.322'), ('val2', 'xe-9/1/2'), ('val3', 'xe-9/1/2'), 
     ('val3', 'xe-1/2/1'), ('val3', 'xe-1/2/1.748')]
s = {}
for elem in l:
    if elem[0] not in s:
        s[elem[0]] = []
    s[elem[0]].append( elem[1])
print(s['val2'])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Using <code>enumerate()</code>:</p>
<pre><code>stList = [('val1', 'ae4.0'),
('val1', 'xe-9/1/7.0'),
('val1', 'xe-1/2/1.1151'),
('val2', 'xe-1/2/1.322'),
('val2', 'xe-9/1/2'),
('val3', 'xe-9/1/2'),
('val3', 'xe-1/2/1'),
('val3', 'xe-1/2/1.748')]

secList = []                              # empty list to store the results
for index, elem in enumerate(stList):
    if stList[index][0] == 'val2':        # If the second elem of tuple matches val2
        secList.append(stList[index][1])  # store the first elem of tuple

print(secList)
</code></pre>
<p><strong>OUTPUT</strong>:</p>
<pre><code>['xe-1/2/1.322', 'xe-9/1/2']
</code></pre>
<p><strong>OR</strong></p>
<p>Using list-comprehension (as stated by @yatu):</p>
<pre><code>print([x[1] for x in stList if x[0] == 'val2'])
</code></pre>
<p><strong>EDIT</strong>:</p>
<p>Over-did it, a simple for would even do it:</p>
<pre><code>secList = []    
for elem in stList:
    if elem[0] == 'val2':
        secList.append(elem[1])
print(secList)
</code></pre>
</div>
<span class="comment-copy">Missing <code>]</code> from your list though.</span>
<span class="comment-copy">Don't forget to give some feedback @LucasMengual, see <a href="https://stackoverflow.com/help/someone-answers">What should I do when someone answers my question?</a></span>
<span class="comment-copy">Why use enumerate and strList[index] instead using elem directly?</span>
<span class="comment-copy">@Lee Ah, I guess I over-did it. Edited. thank you!</span>
<div class="post-text" itemprop="text">
<p>I want to generate a lexicographic series of numbers such that for each number the sum of digits is a given constant. It is somewhat similar to 'subset sum problem'. For example if I wish to generate 4-digit numbers with sum = 3 then I have a series like:</p>
<p>[3 0 0 0]</p>
<p>[2 1 0 0]</p>
<p>[2 0 1 0]</p>
<p>[2 0 0 1]</p>
<p>[1 2 0 0] ... and so on.</p>
<p>I was able to do it successfully in Python with the following code:</p>
<pre><code>import numpy as np

M = 4 # No. of digits
N = 3 # Target sum

a = np.zeros((1,M), int)
b = np.zeros((1,M), int)

a[0][0] = N
jj = 0

while a[jj][M-1] != N:
    ii = M-2
    while a[jj][ii] == 0:
          ii = ii-1
    kk = ii
    if kk &gt; 0:
       b[0][0:kk-1] = a[jj][0:kk-1]
    b[0][kk] = a[jj][kk]-1
    b[0][kk+1] = N - sum(b[0][0:kk+1])
    b[0][kk+2:] = 0
    a = np.concatenate((a,b), axis=0)
    jj += 1

for ii in range(0,len(a)):
    print a[ii]

print len(a)
</code></pre>
<p>I don't think it is a very efficient way (as I am a Python newbie). It works fine for small values of M and N (&lt;10) but really slow beyond that. I wish to use it for M ~ 100 and N ~ 6. How can I make my code more efficient or is there a better way to code it?</p>
</div>
<div class="post-text" itemprop="text">
<p>Very effective algorithm adapted from Jorg Arndt book "Matters Computational"<br/>
(Chapter <code>7.2 Co-lexicographic order for compositions into exactly k parts</code>)</p>
<pre><code>n = 4
k = 3

x = [0] * n
x[0] = k

while True:
    print(x)
    v = x[-1]
    if (k==v ):
        break
    x[-1] = 0
    j = -2
    while (0==x[j]):
        j -= 1
    x[j] -= 1
    x[j+1] = 1 + v

[3, 0, 0, 0]
[2, 1, 0, 0]
[2, 0, 1, 0]
[2, 0, 0, 1]
[1, 2, 0, 0]
[1, 1, 1, 0]
[1, 1, 0, 1]
[1, 0, 2, 0]
[1, 0, 1, 1]
[1, 0, 0, 2]
[0, 3, 0, 0]
[0, 2, 1, 0]
[0, 2, 0, 1]
[0, 1, 2, 0]
[0, 1, 1, 1]
[0, 1, 0, 2]
[0, 0, 3, 0]
[0, 0, 2, 1]
[0, 0, 1, 2]
[0, 0, 0, 3]
</code></pre>
<p>Number of compositions and time on seconds for plain Python (perhaps numpy arrays are faster) for n=100, and k = 2,3,4,5 (2.8 ghz Cel-1840)</p>
<pre><code>2  5050 0.040000200271606445
3  171700 0.9900014400482178
4  4421275 20.02204465866089
5  91962520 372.03577995300293
I expect time  2 hours for 100/6 generation
</code></pre>
<p>Same with numpy arrays (<code>x = np.zeros((n,), dtype=int)</code>) gives <strong>worse</strong> results - but perhaps because I don't know how to use them properly</p>
<pre><code>2  5050 0.07999992370605469
3  171700 2.390003204345703
4  4421275 54.74532389640808
</code></pre>
<p>Native code (this is Delphi, C/C++ compilers might optimize better) generates 100/6 <strong>in 21 seconds</strong> </p>
<pre><code>3  171700  0.012
4  4421275  0.125
5  91962520  1.544
6  1609344100 20.748
</code></pre>
<p>Cannot go sleep until all measurements aren't done :)</p>
<p>MSVS VC++:  <strong>18 seconds</strong>! (O2 optimization)</p>
<pre><code>5  91962520 1.466
6  1609344100 18.283
</code></pre>
<p>So 100 millions variants per second. 
A lot of time is wasted for checking of empty cells (because fill ratio is small). Speed described by Arndt is reached on higher k/n ratios  and is about 300-500 millions variants per second: </p>
<pre><code>n=25, k=15 25140840660 60.981  400 millions per second
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>My recommendations:</p>
<ol>
<li>Rewrite it as a generator utilizing <code>yield</code>, rather than a loop that concatenates a global variable on each iteration.</li>
<li>Keep a running sum instead of calculating the sum of some subset of the array representation of the number.</li>
<li>Operate on a single instance of your working number representation instead of splicing a copy of it to a temporary variable on each iteration.</li>
</ol>
<p>Note no particular order is implied.</p>
</div>
<div class="post-text" itemprop="text">
<p>I have a better solution using itertools as follows,</p>
<pre><code>from itertools import product
n = 4 #number of elements
s = 3 #sum of elements
r = []
for x in range(n):
    r.append(x)
result = [p for p in product(r, repeat=n) if sum(p) == s]
print(len(result))
print(result)
</code></pre>
<p>I am saying this is better because it took 0.1 secs on my system, while your code with numpy took 0.2 secs. </p>
<p><img alt="enter image description here" src="https://i.stack.imgur.com/H5Gn8.png"/></p>
<p><img alt="enter link description here" src="https://i.stack.imgur.com/jhl46.png"/></p>
<p>But as far as n=100 and s=6, this code takes time to go through all the combinations, I think it will take days to compute the results.</p>
</div>
<span class="comment-copy">Have a look at <a href="https://en.m.wikipedia.org/wiki/Composition_(combinatorics)" rel="nofollow noreferrer">integer composition</a></span>
<span class="comment-copy">The given link has very useful information, however, it does not help in refining the algorithm.</span>
<span class="comment-copy">Ran your code for n=100 and k=6, its takes time in this algorithm as well, may be days</span>
<span class="comment-copy">@MBo I find this algorithm to be really fast and efficient. Perfect!</span>
<span class="comment-copy">@Shoyeb Sheikh Do you know how many compositions with such parameters do exist? Any algorithm generating trillions of variants requires a lot of time. Described approach is very optimized - being implemented in C, it generates 300 millions variants per second (not counting output or writing - the most time consuming part)</span>
<span class="comment-copy">@MBo well that was a part of question lol I didn't add anything to it, 300 millions per sec is very efficient though, Great !</span>
<span class="comment-copy">@Shoyeb Sheikh Yes, I noticed that author supposes to get a lot of variants - it is possible to calculate them, but it is rather hard to store and use such huge amount of data</span>
<span class="comment-copy">Actually I want to improve the way algorithm is coded (or code a more efficient algorithm) to compute <i>just the required</i> combinations. As far as I understand your code checks <i>all possible combinations</i> against the given sum. Can you time both the codes for M=10, N=3 as well?</span>
<span class="comment-copy">Its been an hour of so for M=10 and N=3 and its still running, I think MBo has a better answer there.</span>
<span class="comment-copy">Did you check the timing with my code as well?</span>
<span class="comment-copy">Nope you check it and let us know</span>
<span class="comment-copy">Ok, I did that. It took less than a second.</span>
<div class="post-text" itemprop="text">
<p>I am working on a group project for building a robot and we are trying to implement an accelerometer that triggers an alarm if the robot is picked up/pushed on the way. Right now our accelerometer is very noisy and not very reliable. Could someone point me in the right direction on how to fix this?
Current code:</p>
<pre><code> def accel_alarm(self):
        cur_accel = self.read_smooth_accel()
        accel_x, accel_y, accel_z = cur_accel
        base_x, base_y, base_z = (-32, 31, 1075)  # values when robot is static
        if abs(accel_x - base_x) &gt; 350 or abs(
                accel_y - base_y) &gt; 350 or abs(accel_z - base_z) &gt; 350:
            if not (self.alarm):
                self.send_alarm()
                self.alarm = True
                print(
                    "[accel_alarm] ALARM STATE " + str(accel_x) + " X " + str(
                        accel_y) + " Y  " + str(accel_z) + " Z")

    # Smooth accelerometer output by taking the average of the last n values
    # where n = len(self.accel_data)
    def read_smooth_accel(self):
        cur_accel, _ = self.accel.read()
        self.accel_data.pop()
        self.accel_data.appendleft(cur_accel)
        # For the first len(accel_data) values the average is not
        # representative - just return current value
        if [0, 0, 0] in self.accel_data:
            return cur_accel

        av_accel = [sum(i) / float(len(i)) for i in zip(*self.accel_data)]
        return av_accel
</code></pre>
<p>The second method is trying to tackle the noisiness but it is still not very nice... </p>
</div>
<span class="comment-copy">If your <b>hardware</b> is to noisy, why try to solve it with software? I'm suspecting your definition is a bit off when you say "noisy" tho, could you elaborate and explain why it's noisy and how you've noticed it?</span>
<span class="comment-copy">you could implement some kind of mulitsampling - the accelerometer could wait for more than one consecutive positive signal (e.g. record last 3 results and if all of them are True, send True) or a part of the group being positive (e.g. record last 6 results and if 3 or more of them are True send True)</span>
<span class="comment-copy">Basically, when it is turned on now and the robot is even static, it prints out the coordinates to the console every millisecond. We want to try to reduce the number of outputs to only appear when the robot moves more than 10cm in direction.</span>
<span class="comment-copy">Did you calculate the bias or offset values of the sensor? Why did you choose static values as (-32, 31, 1075) and 350 for threshold?</span>
<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/38492314/reordering-cluster-numbers-for-correct-correspondence">reordering cluster numbers for correct correspondence</a>
<span class="question-originals-answer-count">
                    1 answer
                </span>
</li>
</ul>
</div>
<p>I am using scikit-learn to cluster some data, and I want to compare the results of different clustering techniques.  I am immediately faced with the issue that the labels for the clusters are different for different runs, so even if they are clustered exactly the same the similarity of the lists is still very low.</p>
<p>Say I have </p>
<pre><code>list1 = [1, 1, 0, 5, 5, 1, 8, 1]
list2 = [3, 3, 1, 2, 2, 3, 8, 3]
</code></pre>
<p>I would (ideally) like a function that returns the best mapping in the form of a translation dictionary like this:</p>
<pre><code>findMapping(list1, list2)
&gt;&gt;&gt; {0:1, 1:3, 5:2, 8:8}
</code></pre>
<p>And I said "best mapping" because let's say <code>list3 = [3, 3, 1, 2, 2, 3, 8, 4]</code> then <code>findMapping(list1, list3)</code> would still return the same mapping even though the final <code>1</code> turns into a <code>4</code> instead of a <code>3</code>.  </p>
<p>So the best mapping is the one that minimizes the number of differences between the two lists. I think's a good criterion, but there may be a better one.  </p>
<p>I could write a trial-and-error optimization algorithm to do this, but I'm hardly the first person to want to compare the results of clustering algorithms.  I expect something like this already exists and I just don't know what it's called.  But I searched around and didn't find any answers.  </p>
<p>The point is that after applying the best translation I will measure the difference between the lists, so maybe there is a way to measure the difference between lists of numbers indexed differently without finding the translation as an intermediate step, and that's good too.</p>
<p>===================================</p>
<p>Based on Pallie's answer I was able to create the findMapping function, and then I took it one step further to create a translation function that returns the second list converted to the labels of the first list.  </p>
<pre><code>def translateLabels(masterList, listToConvert):    
  contMatrix = contingency_matrix(masterList, listToConvert)
  labelMatcher = munkres.Munkres()
  labelTranlater = labelMatcher.compute(contMatrix.max() - contMatrix)

  uniqueLabels1 = list(set(masterList))
  uniqueLabels2 = list(set(listToConvert))

  tranlatorDict = {}
  for thisPair in labelTranlater:
    tranlatorDict[uniqueLabels2[thisPair[1]]] = uniqueLabels1[thisPair[0]]

  return [tranlatorDict[label] for label in listToConvert]
</code></pre>
<p>Even with this conversion (which I needed for consistent plotting of cluster colors), using the Rand index and/or normalized mutual information does seem like a good way to compare the differences that don't require a shared labeling.  </p>
<p>I also like the idea of first <a href="https://stackoverflow.com/questions/44888415/how-to-set-k-means-clustering-labels-from-highest-to-lowest-with-python">sorting both lists according the values in the data</a>, but that may not work when comparing clusters from very different data.</p>
</div>
<div class="post-text" itemprop="text">
<p>You could try calculating the <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.adjusted_rand_score.html" rel="nofollow noreferrer">adjusted Rand index</a> between two results. This gives a score between -1 and 1, where 1 is a perfect match.</p>
<p>Or by taking argmax of confusion matrix:</p>
<pre><code>list1 = ['a', 'a', 'b', 'c', 'c', 'a', 'd', 'a']
list2 = [3, 3, 1, 2, 2, 3, 8, 3]
np.argmax(contingency_matrix(list1, list2), axis=1)
array([2, 0, 1, 3])
</code></pre>
<p>2 means row 2 (the value 2, the cluster 3) best matches "a" column 0 (the index of 2). Row 0 then matches column 1, etc.</p>
<p><a href="https://i.stack.imgur.com/NolO2.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/NolO2.png"/></a></p>
<p>For the Hungarian method:</p>
<pre><code>m = Munkres()
contmat = contingency_matrix(list1, list2)
m.compute(contmat.max() - contmat)
[(0, 2), (1, 0), (2, 1), (3, 3)]
</code></pre>
<p>using: <a href="https://github.com/bmc/munkres" rel="nofollow noreferrer">https://github.com/bmc/munkres</a></p>
</div>
<div class="post-text" itemprop="text">
<p>As answered many times before, the standard algorithm to compute such a mapping is the <strong>Hungarian algorithm</strong>.</p>
<p>It originally is meant to match producers and consumers, but it will work for aligning cluster numbers, too.</p>
</div>
<span class="comment-copy">I think the question justifies a certain degree of merit, even if it is purportedly considered by someone as a duplicate. I'm upvoting it.</span>
<span class="comment-copy">Yes, this is the kind of thing that I expected existed.  It does satisfy my need to measure the distance between lists without finding the translation.  If possible I'd still like to have the "translation map" so I can identify which items are different and produce a global color scheme for plots.</span>
<span class="comment-copy">For that information try the contingency matrix: <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.cluster.contingency_matrix.html" rel="nofollow noreferrer">scikit-learn.org/stable/modules/generated/…</a></span>
<span class="comment-copy">I believe you that the contingency matrix can provide the information necessary to convert one set of labels to another, but with just that documentation and no examples to be found, it's totally unclear how that can be done.</span>
<span class="comment-copy">Taking the np.argmax of the contingency matrix should result in a list where the indices are the key and the values are the values of the mapping.a good mapping.</span>
<span class="comment-copy">Well, for my sample data, <code>contingency_matrix</code> outputs <code>[[1 0 0 0] [0 0 4 0] [0 2 0 0] [0 0 0 1]]</code> and applying <code>argmax</code> yields <code>[0 2 1 3]</code>, but I don't see how to translate those two lists into the same indices from that output.  I mean, what should <code>5</code> translate to? What about 8? Sorry, I'm just not seeing how to get this to do the job.</span>
<span class="comment-copy">My <i>question</i> is mostly a duplicate of "reordering cluster numbers for correct correspondence"; albeit much more detailed.  However, that question doesn't have a specific answer, just a vague pointer to a method that can be adapted to solve the problem, but no information on how to do that.  This question still needs an actual answer (which may, and probably does, exist somewhere).</span>
<div class="post-text" itemprop="text">
<p>My question is about the tf.gradient(ys,xs) which always returns sum(dy/dx) for all y in ys. The summing up is implicit and there does not seem to be an official way to get a list of gradients for each y (for instance a batch of 100 examples).</p>
<p>I know there are some posts here with similar question, but none seems to give a good answer. My question is more related to the solution given at this discussion: <a href="https://github.com/tensorflow/tensorflow/issues/4897" rel="nofollow noreferrer">github issues</a>. I would like to know if anyone has tried the method given by user goodfeli? Here is my attempt:</p>
<pre><code>with tf.device('/GPU:4'):
    batch_size = 1000
    W = tf.Variable([[1.,2.],[3.,4.],[4.,8.],[3.,6.]])
    x = tf.placeholder(dtype = tf.float32, shape = [None,4])

    y = tf.tensordot(x,W,axes=1)
    loss = tf.reduce_prod(y)
    grad_old = tf.gradients(ys=loss,xs=W)

    ##Non Aggregate

    examples = tf.split(x,num_or_size_splits=batch_size)
    weight_copies = [tf.identity(W) for xs in examples]
    output = tf.stack([tf.tensordot(xs,ws,axes=1) for xs,ws in zip(examples,weight_copies)])
    batch_loss = tf.squeeze(tf.reduce_prod(output,axis=2))
    batch_grad = tf.gradients(ys=batch_loss,xs=weight_copies)
#Run session
sess = tf.Session(config=tf.ConfigProto(allow_soft_placement=True,log_device_placement=False))
tf.global_variables_initializer().run(session=sess)

val = np.random.rand(batch_size,4)
fd = {x:val}
st0 = timeit.default_timer()
grad_b = np.array(sess.run(batch_grad,feed_dict=fd))
print("Batch: %f" %(timeit.default_timer()-st0))

st1 = timeit.default_timer()
grad_s = []
for s in val:
    val_x = [s]
    fds = {x:val_x}
    grad_s.append(sess.run(grad_old,feed_dict=fds)[0])
grad_s = np.array(grad_s)
print("Single: %f" %(timeit.default_timer()-st1))
</code></pre>
<p>However, when I run this, the time taken for the batch method is around 10 times slower than that for looping through each example. I find this quite strange. Is there any reason why it is behaving like this for me when the github thread seems to confirm that the batch method is faster. Is my setup too simple that the overhead is killing any efficiency? Any help would be really appreciated.</p>
</div>
<span class="comment-copy">Seems you want to get the <a href="https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant" rel="nofollow noreferrer">Jacobian matrix</a>, for which there is no straightforward computation in TensorFlow. See <a href="https://stackoverflow.com/q/46425630">taking the gradient in Tensorflow, tf.gradient</a> / <a href="https://github.com/tensorflow/tensorflow/issues/675" rel="nofollow noreferrer">issue #675</a>. There are several possible implementations (<a href="https://stackoverflow.com/a/54114614">here I include one for 1D variables</a>), but all involve looping in some way and are significantly slower than the aggregated gradient.</span>
<div class="post-text" itemprop="text">
<p>So I installed the package for the <em>airtable-python-wrapper</em> found on the github page <a href="https://github.com/gtalarico/airtable-python-wrapper/blob/master/README.md" rel="nofollow noreferrer">https://github.com/gtalarico/airtable-python-wrapper/blob/master/README.md</a> by inputting in my project folder: </p>
<pre><code>pip install airtable-python-wrapper
</code></pre>
<p>Later on I wrote the following script :</p>
<pre><code>from airtable import Airtable
from pprint import pprint


base_key = 'mykey'
table_name = 'MyBase'
myVar = Airtable(base_key, table_name)
print(myVar)

</code></pre>
<p>which when I run I get the error : </p>
<pre><code>ImportError: cannot import name 'Airtable' from 'airtable' (unknown location)
</code></pre>
<p>Does anyone know why this happens? Why does it not recognize the class <em>Airtable</em>? I am following the documentation, so I do not understand what the problem is. Thanks in advance</p>
</div>
<span class="comment-copy"><code>pip install airtable-python.wrapper</code>, with a dot?</span>
<span class="comment-copy">maybe it's the python version? Try to execute that script on Python 2 and 3</span>
<span class="comment-copy">@Shinratensei thanks for the answer! why would you use a dot instread of - since the documentation suggests the command  <i>pip install airtable-python-wrapper</i> ?</span>
<span class="comment-copy">exactly that's what I'm asking you, because in your question you've written it as I did. I suppose you just made a typo there while writing it and it's not in your code but still</span>
<span class="comment-copy">@Shinratensei oh I am sorry, I  corrected it! How could I run a script with Python 2? Should I install Python 2?</span>
<div class="post-text" itemprop="text">
<p>I have a DataFrame that is a follows:</p>
<pre><code>df[16820:16830]
       data0  start_stop
16820      1           0
16821      1           1
16822      1           0
16823      1           0
16824      1           0
16825      1          -1
16826      0           0
16827      0           0
16828      1           1
16829      0           0
16830      1          -1
</code></pre>
<p>What I need to do is mark values between 1 and -1 in the start_stop columns as valid(1 means 'start', -1 means 'stop') and values between -1 and 1 as invalid (rubbish that I will later discard).
Is there any efficient way to do this instead of iterating with loops over the whole dataframe?</p>
<p>The end result would look like this:</p>
<pre><code>       data0  start_stop  valid
16820      1           0   False
16821      1           1   True
16822      1           0   True
16823      1           0   True
16824      1           0   True
16825      1          -1   False
16826      0           0   False
16827      0           0   False
16828      1           1   True
16829      0           0   True
16830      1          -1   False
...
</code></pre>
<p>The relevant loop that would achieve it is, i think this:</p>
<pre><code>df = df.reset_index(drop=True)
value = False
for i in range(0,df.shape[0]):
    if df.loc[i, 'start_stop'] == 1:
        df.loc[i,'valid'] = True
        value = True
    elif df.loc[i, 'start_stop'] == -1:
        df.loc[i, 'valid'] = False
        value = False
    if df.loc[i, 'start_stop'] == 0:
        df.loc[i, 'valid'] = value
</code></pre>
<p>Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>This should work</p>
<pre><code>df['valid'] = df.start_stop.cumsum()
</code></pre>
<p>Then</p>
<pre><code>df['valid'] = df['valid'].apply(lambda x: True if x==1 else False)

df

    start_stop  valid
0            0  False
1            1   True
2            0   True
3            0   True
4            0   True
5           -1  False
6            0  False
7            0  False
8            1   True
9            0   True
10          -1  False
</code></pre>
</div>
<span class="comment-copy">why is the last value from <code>start_stop</code> -1 in the output?</span>
<span class="comment-copy">@anky_91my mistake, edited.</span>
<span class="comment-copy">This is how it's done. I was mistakenly trying to find a way through numpy.trapz(). Thanks!</span>
<span class="comment-copy"><code>df['valid']=df['start_stop'].cumsum().astype(bool)</code> would be more convenient</span>
<div class="post-text" itemprop="text">
<p>While trying to tackle a more complex problem, I came to compare access speed to local variable vs member variables.</p>
<p>Here a test program:</p>
<pre><code>#!/usr/bin/env python

MAX=40000000

class StressTestMember(object):
    def __init__(self):
        self.m = 0

    def do_work(self):
        self.m += 1
        self.m *= 2

class StressTestLocal(object):
    def __init__(self):
        pass

    def do_work(self):
        m = 0
        m += 1
        m *= 2

# LOCAL access test
for i in range(MAX):
    StressTestLocal().do_work()

# MEMBER access test
for i in range(MAX):
    StressTestMember().do_work()
</code></pre>
<p>I know it might look like a bad idea to instantiate <code>StressTestMember</code> and <code>StressTestLocal</code> on each iterations but it makes sense in the modeled program where these are basically Active Records.</p>
<p>After a simple benchmark,</p>
<ul>
<li>LOCAL access test: 0m22.836</li>
<li>MEMBER access test: 0m32.648s</li>
</ul>
<p>The local version is ~33% faster while still part of a class. Why?</p>
</div>
<div class="post-text" itemprop="text">
<p><code>self.m += 1</code> means you have to look up a local variable called <code>self</code> and then find the attribute called <code>m</code></p>
<p>Of course if you just have to look up a local variable, it will be faster without the extra step.</p>
<p>It can be useful to look at what is happening under the hood:</p>
<pre><code>&gt;&gt;&gt; import dis
&gt;&gt;&gt; dis.dis(StressTestLocal.do_work)
 18           0 LOAD_CONST               1 (0)
              3 STORE_FAST               1 (m)

 19           6 LOAD_FAST                1 (m)
              9 LOAD_CONST               2 (1)
             12 INPLACE_ADD         
             13 STORE_FAST               1 (m)

 20          16 LOAD_FAST                1 (m)
             19 LOAD_CONST               3 (2)
             22 INPLACE_MULTIPLY    
             23 STORE_FAST               1 (m)
             26 LOAD_CONST               0 (None)
             29 RETURN_VALUE        
&gt;&gt;&gt; dis.dis(StressTestMember.do_work)
 10           0 LOAD_FAST                0 (self)
              3 DUP_TOP             
              4 LOAD_ATTR                0 (m)
              7 LOAD_CONST               1 (1)
             10 INPLACE_ADD         
             11 ROT_TWO             
             12 STORE_ATTR               0 (m)

 11          15 LOAD_FAST                0 (self)
             18 DUP_TOP             
             19 LOAD_ATTR                0 (m)
             22 LOAD_CONST               2 (2)
             25 INPLACE_MULTIPLY    
             26 ROT_TWO             
             27 STORE_ATTR               0 (m)
             30 LOAD_CONST               0 (None)
             33 RETURN_VALUE        
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Local names is faster because Python does some optimization that local names don't need dict access, on the other hand, instance attributes need to access the <code>__dict__</code> of the object.</p>
<p>This is also the reason why local names are faster than global names.</p>
</div>
<span class="comment-copy">+1 Very good, clear answer.</span>
<span class="comment-copy">very nice. this deserves the accept.</span>
<span class="comment-copy">So does it follow that it'd be wise to create a new reference to a class variable in local scope? e.g., <code>m = self.m</code>? It wouldn't make any difference in this test, but my version of <code>do_work()</code> is a loop that runs millions of times.</span>
<span class="comment-copy">@JamesS, It's always best to measure your exact use case if it's important enough to tune it. If you were referencing <code>self.m</code> a few times I'd expect it to be faster to pull into a local var. Remember to save the local back to the attribute if you are mutating it.</span>
<div class="post-text" itemprop="text">
<p>I have some plots with a lot of information and lines, so sometimes I tend to put the legend outside the plot itself <code>using bbox_to_anchor</code>. I also prefer to have a title of the plot, but this will positionally coincide with the legend in that case. The following example below is just an illustration of the problem. </p>
<pre><code>import numpy as np
import matplotlib.pyplot as plt

t = np.arange(0.0, 2.0, 0.01)
s = 1 + np.sin(2 * np.pi * t)
r = 1 + np.sin(4 * np.pi * t)
q = 1 + np.sin(6 * np.pi * t)

fig, ax = plt.subplots()
ax.plot(t, s, label='S')
ax.plot(t, r, label='R')
ax.plot(t, q, label='Q')
leg = ax.legend(loc=3, ncol=3, bbox_to_anchor=(.0, 1.02, 1., .102), borderaxespad=0., mode='expand')
ax.set_title('SIMPLE PLOT', y=1.1)
plt.show()
</code></pre>
<p>To avoid this, I set some kind of y-value (e.g. <code>y=1.1</code>). I would like to automate this process because I keep updating the same plot with new data, so the legend grows in size, and I need to adjust the position of the title accordingly. </p>
<ul>
<li>Is there a way to automate this process? </li>
<li>Is there a function in Python that is able to read the height of the legend so that this can be used to adjust the title position?</li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>The height of the legend is determined at draw time. You can get it after having drawn the figure via <code>legend.get_window_extent()</code>. The resulting bounding box is in units of pixels. In order to find the offset of the title, you will need to subtract the upper limit of the legend from the upper limit of the axes. So you need to get the axes position in pixels as well. </p>
<p>The title can be offset either in figure coordinates (<code>y=1.1</code>) or points (<code>pad=20</code>). I would suggest to use points here, to make it independent of the size of the axes. So you can calculate the difference in upper positions, convert from pixels to points (i.e. <code>distance [pixels] * ppi / dpi</code>) and add some constant offset in points (because usually you would not want the title to sit exactly on the border of the legend). Then use that number as <code>pad</code>.</p>
<pre><code>import numpy as np
import matplotlib.pyplot as plt


fig, ax = plt.subplots(constrained_layout=True)

ax.plot([1,2,3], np.random.rand(3,5), label='Label')

leg = ax.legend(loc="lower center", ncol=3, bbox_to_anchor=(.0, 1.02, 1., 1.02),
                borderaxespad=0, mode='expand')

fig.canvas.draw()
leg_box = leg.get_window_extent()
ax_box = ax.get_position().transformed(fig.transFigure)
pad = (leg_box.y1 - ax_box.y1)*72./fig.dpi + 6
ax.set_title('SIMPLE PLOT', pad=pad)

plt.show()
</code></pre>
<p><a href="https://i.stack.imgur.com/YNGAV.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/YNGAV.png"/></a></p>
<p>Note that here I also used <code>constrained_layout</code> to have the title not cropped by the figure boundaries. </p>
</div>
<span class="comment-copy">Thank you, @ImportanceOfBeingErnest -- this was actually what I had in mind!</span>
<div class="post-text" itemprop="text">
<p>For some reason the <code>and</code> operator is not functioning properly within the <code>while</code> loop. </p>
<p>When I go to run the code it will exit the loop when either the password or username are matching and not both.</p>
<p>Any help would be great.</p>
<pre><code>    root_password = "password123"
    root_username = "root"
    username = "default"
    password = "default"

    while username != root_username and password != root_password:
        username = input("Username: ")
        password = input("Password: ")
        if username != root_username and password != root_password:
        print("Wrong Credentials")


    print("Welcome")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The and operator is exactly doing what it should, it stays in the loop as long as both are not matching.
What you want is continuing loop until both match, so you have to use the OR operator here</p>
</div>
<div class="post-text" itemprop="text">
<p>This will result in True only when both, username and password don't match. In case the username is correct but password is wrong, False and True = False, and loop will end. What you need is to prompt "Wrong credentials" when either of them is wrong, using OR. </p>
<p>This is a common error while operating on negations or complements. Refer to De-Morgan Laws:</p>
<pre><code>!(username == root_username and password==root_password)
</code></pre>
<p>is</p>
<pre><code>username != root_username or password!=root_password
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>One way to do this is to create a conditional which checks if both the username and password are matching and then put a <code>not</code> in front of that conditional, like this:</p>
<pre class="lang-py prettyprint-override"><code>not (username == root_username and password == root_password)
</code></pre>
<p>This just checks if the user doesn't have a matching username and password, or doesn't have the right credentials.</p>
<p>As Speeeddy has stated, using De-Morgan Laws, this conditional is the same as <code>username != root_username or password != root_password</code>, but this just makes the code easier to read and understand.</p>
<p>Here's the code with this change:</p>
<pre class="lang-py prettyprint-override"><code>root_password = "password123"
root_username = "root"
username = "default"
password = "default"

while not (username == root_username and password == root_password):
  username = input("Username: ")
  password = input("Password: ")
  if not (username == root_username and password == root_password):
    print("Wrong Credentials")

print("Welcome")
</code></pre>
</div>
<span class="comment-copy">Use <code>or</code> instead of <code>and</code>. Think it through.</span>
<span class="comment-copy">@Aran-Fey is right, the problem is with the logic, not the operator.</span>
<div class="post-text" itemprop="text">
<p>I have an image of a puzzle piece that i need to resize in order for both the pieces I need to compare to have the same size. I have used the following codes to resize my image. The problem is the length of the line in the image 1 is 187 and after resizing the length of the line in image 2 is 194. intended output is for them to be same</p>
<pre><code>ratio = math.hypot(x2 - x1, y2 - y1) / math.hypot(x4 - x3, y4 - y3)
print("img1", math.hypot(x2 - x1, y2 - y1),"img 2", math.hypot(x4 - x3, y4 - y3)*ratio)

n = int(ratio * new_img_2.shape[0])
img = cv2.resize(new_img_2, (n, n), cv2.INTER_CUBIC)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I'm not entirely sure what you're asking but it seems like you want to resize two images and maintain aspect ratio between the two. If so, here's a function to resize a image and maintain aspect ratio to any width or height.</p>
<p><a href="https://i.stack.imgur.com/UPqXf.jpg" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/UPqXf.jpg"/></a></p>
<pre><code>import cv2

# Resizes a image and maintains aspect ratio
def maintain_aspect_ratio_resize(image, width=None, height=None, inter=cv2.INTER_AREA):
    # Grab the image size and initialize dimensions
    dim = None
    (h, w) = image.shape[:2]

    # Return original image if no need to resize
    if width is None and height is None:
        return image

    # We are resizing height if width is none
    if width is None:
        # Calculate the ratio of the height and construct the dimensions
        r = height / float(h)
        dim = (int(w * r), height)
    # We are resizing width if height is none
    else:
        # Calculate the ratio of the 0idth and construct the dimensions
        r = width / float(w)
        dim = (width, int(h * r))

    # Return the resized image
    return cv2.resize(image, dim, interpolation=inter)

if __name__ == '__main__':
    image = cv2.imread('../color_palette.jpg')
    cv2.imshow('image', image)
    cv2.waitKey(0)

    resized = maintain_aspect_ratio_resize(image, width=400)
    cv2.imshow('resized', resized)
    cv2.waitKey(0)
</code></pre>
<p>You may want to rephrase your question to be more clear.</p>
</div>
<span class="comment-copy">You resized your images so that their diagonals have the same length, but they probably didn't have the same shape (width/height ratio) to begin with.</span>
<span class="comment-copy">@ThierryLathuille they do have the same width and height. the outer size of the image is a perfect square</span>
<span class="comment-copy">Is it possible that this is the result of a rounding error? n = int(ratio * ...) leads to some data lose. You should take this in account and add one more computing step.</span>
<span class="comment-copy">@xMutzelx this maximum that this error can be is a difference of 1 right, there its a lot more than that</span>
<div class="post-text" itemprop="text">
<p>I am trying to run super mario environment in OpenAI baseline but having difficulty with that</p>
<p>by default openAI baseline does provide SuperMarioBros environment but it doesn't fully support the environment type during the execution, any suggestions how to work around this </p>
<pre><code>_game_envs['retro'] = {
'BubbleBobble-Nes',
'SuperMarioBros-Nes',
'TwinBee3PokoPokoDaimaou-Nes',
'SpaceHarrier-Nes',
'SonicTheHedgehog-Genesis',
'Vectorman-Genesis',
'FinalFight-Snes',
'SpaceInvaders-Snes',
</code></pre>
<p>}</p>
</div>
<span class="comment-copy">you need to clarify "having difficulty" and what you're having trouble with. Right now, as the question is written, there's no way to even know what your problem is, let alone help you.</span>
<div class="post-text" itemprop="text">
<p>I need to query data from a mysqldatabase with the table name containing hyphens.</p>
<pre><code>current_table = "tw3-10_1"
sql2 = "SELECT * FROM " + str(current_table ) 
cursor.execute(sql2)
</code></pre>
<p>Unfortunately I get:
1064, "You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near '-10_1' at line 1")</p>
<p>Is there any way to work around that issue? Unfortunately I cannot change the names of the tables.....</p>
</div>
<div class="post-text" itemprop="text">
<p>You can normally use backticks to quote a table name or column name, in case it contains unhelpful characters.</p>
<pre><code>current_table = "`tw3-10_1`"
sql2 = "SELECT * FROM " + current_table
</code></pre>
<p>or if you prefer</p>
<pre><code>current_table = "tw3-10_1"
sql2 = "SELECT * FROM `{}`".format(current_table)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>try like this, I don't know about MariaDB but quotes should work in SQL</p>
<pre><code>sql2 = """
    SELECT
            *
    FROM "{table_name}"
    """.format(
            table_name='table-with-hyphens'
        )
print(sql2)
    # SELECT
    #         *
    # FROM "table-with-hyphens"
</code></pre>
</div>
<span class="comment-copy">Perhaps quoting the table name in backticks <code>`tw3-10_1`</code> will help.</span>
<span class="comment-copy">Many thanks. I tried both methods, I do not get an error any more but somehow I jut get an empty tuple if I do afterwards: cursor.execute(sql2) and then current_data = cursor.fetchall(), If I change the table name to one without a hyphen I get the data</span>
<div class="post-text" itemprop="text">
<p>I am writing a test case for my model to test the <code>__str__</code> but apparently it is failing.</p>
<p>Here is my <strong>tests.py</strong>:</p>
<pre><code>from todoapp.models import User, Task
from django.test import TestCase


class UserModelTest(TestCase):
    def setUp(self):
        self.user = User.objects.create(
            first_name='john',
            last_name='doe',
            email='abc@example.com',
            password='johndoe')

    def test_string_representation(self):
        object_name = User.objects.get(id=50)
        expected_object_name = object_name.email
        self.assertEqual(expected_object_name, str(object_name))
</code></pre>
<p>Here is my <strong>models.py</strong>:</p>
<pre><code>class User(AbstractUser):
    username = None
    email = models.EmailField(unique=True)
    USERNAME_FIELD = 'email'
    REQUIRED_FIELDS = ['first_name', 'last_name']

    def __str__(self):
        return self.email
</code></pre>
<p><strong>P.S.</strong>:
A user with <code>id=50</code> already exists</p>
</div>
<div class="post-text" itemprop="text">
<p>Django creates a test database when you run the test, so it sounds like the user with <code>id=50</code> <em>doesn't</em> exist in the test database.</p>
<p>You are already creating a user in the <code>setUp</code> method, so I suggest you fetch that user in the test.</p>
<pre><code>def test_string_representation(self):
    object_name = User.objects.get(email='abc@example.com')
    expected_object_name = object_name.email
    self.assertEqual(expected_object_name, str(object_name))
</code></pre>
<p>Note that you shouldn't usually rely on the id when fetching objects during tests. The id can change from run to run, for example if the tests run in a different order.</p>
</div>
<span class="comment-copy">If the test is failing, please show the output when you run the test.</span>
<span class="comment-copy">It worked. Thanks a lot. Btw is the <code>setUp</code> method compulsory ? What should my code be if I omit it ?</span>
<span class="comment-copy">If you remove the <code>setUp</code> method, then you'll have to create the user somewhere else, otherwise <code>User.objects.get(...)</code> will fail. The <code>setUp</code> method runs before every test in the class. If you have more than one test in the class, then putting <code>User.objects.create(...)</code> in the <code>setUp</code> method means you don't have to repeat it in every test method. Django also has <a href="https://docs.djangoproject.com/en/2.1/topics/testing/tools/#django.test.TestCase.setUpTestData" rel="nofollow noreferrer"><code>setUpTestData</code></a> which can be faster if you have lots of tests in the test class.</span>
<span class="comment-copy">Gotcha ! Thanks mate :)</span>
<div class="post-text" itemprop="text">
<p>On server 1 i have ansible 2.4.2.0 with python version = 2.7.5 : </p>
<p>On server 2 i have ansible 2.6.0 with python version = 3.6.3 :</p>
<p>on Server 1, this works fine , by calling a dictionary <strong><em>roles/webapp/defaults/main.yml</em></strong> inside <strong><em>roles/webapp/vars/main.yml</em></strong>:</p>
<pre><code>nexus_download_url: '{{ nexus_redirect_base_url }}?r={{ nexus_repo_name }}&amp;g={{ apps[application_name].artifact_group_id }}&amp;a={{ application_name }}&amp;v={{ application_version }}&amp;c=exec&amp;e=jar'
</code></pre>
<p>While on server 2 i get following error : </p>
<pre><code>{"msg": "The task includes an option with an undefined variable. The error was: 'dict object' has no attribute...}
</code></pre>
<p>The issue is linked to : </p>
<pre><code>&amp;g={{ apps[application_name].artifact_group_id }}
</code></pre>
<p>Is there any modifications done between the two ansible version on dictionary syntax , i didn't find anything on ansible changelog for both version 2.5 and 2.6 ?</p>
</div>
<div class="post-text" itemprop="text">
<p>I have tried two things and it worked :</p>
<ol>
<li>Adding the dictionary directly inside <strong><em>/role/test/vars/main.yml</em></strong></li>
<li><p>add to the ansible config file (ansible.cfg)</p>
<p>hash_behaviour = merge</p></li>
</ol>
</div>
<span class="comment-copy">It's not an answer but wanted to confirm if we specify the nexus_download_url within " "(double quotes)</span>
<span class="comment-copy">yes we do when passing parameter to playbook.</span>
<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/34057851/python-flask-typeerror-dict-object-is-not-callable">Python Flask, TypeError: 'dict' object is not callable</a>
<span class="question-originals-answer-count">
                    4 answers
                </span>
</li>
</ul>
</div>
<p>I'm trying to build my first flask application and when I try to send login data from this form:</p>
<pre><code>&lt;form class="border border-light p-5" action="http://localhost:5000/login" method="POST"&gt;

    &lt;p class="h4 mb-4 text-center"&gt;Connexion&lt;/p&gt;
    &lt;input type="email" id="defaultLoginFormEmail" class="form-control mb-4" placeholder="E-mail" name="username"&gt;
    &lt;input type="password" id="defaultLoginFormPassword" class="form-control mb-4" placeholder="Mot de passe" name="password"&gt;
    &lt;div class="d-flex justify-content-between"&gt;
    &lt;/div&gt;
    ...
&lt;/form&gt;
</code></pre>
<p><strong>Route mapping:</strong></p>
<pre><code>@app.route('/login', methods=['POST'])
def UserLogin():
    credentials={}
    credentials['username'] = request.form['username']
    credentials['password'] = request.form['password']
    #I think that the problem in the 3 lines above
    current_user = UserModel.find_by_username(credentials['username'])
    if not current_user:
        return {'message': 'User {} doesn\'t exist'.format(credentials['username'])}

    if UserModel.verify_hash(credentials['password'], current_user.password):
        access_token = create_access_token(identity = credentials['username'])
        refresh_token = create_refresh_token(identity = credentials['username'])
        return redirect(url_for('search'))
    else:
        return {'message': 'Wrong credentials'}
</code></pre>
<p>When I try to log in I get: <code>TypeError: 'dict' object is not callable</code>. </p>
<p>Full traceback as asked:</p>
<pre><code>Traceback (most recent call last):
  File "C:\Users\acer\Anaconda3\lib\site-packages\flask\app.py", line 1997, in __call__
    return self.wsgi_app(environ, start_response)
  File "C:\Users\acer\Anaconda3\lib\site-packages\flask\app.py", line 1985, in wsgi_app
    response = self.handle_exception(e)
  File "C:\Users\acer\Anaconda3\lib\site-packages\flask\app.py", line 1540, in handle_exception
    reraise(exc_type, exc_value, tb)
  File "C:\Users\acer\Anaconda3\lib\site-packages\flask\_compat.py", line 33, in reraise
    raise value
  File "C:\Users\acer\Anaconda3\lib\site-packages\flask\app.py", line 1982, in wsgi_app
    response = self.full_dispatch_request()
  File "C:\Users\acer\Anaconda3\lib\site-packages\flask\app.py", line 1615, in full_dispatch_request
    return self.finalize_request(rv)
  File "C:\Users\acer\Anaconda3\lib\site-packages\flask\app.py", line 1630, in finalize_request
    response = self.make_response(rv)
  File "C:\Users\acer\Anaconda3\lib\site-packages\flask\app.py", line 1740, in make_response
    rv = self.response_class.force_type(rv, request.environ)
  File "C:\Users\acer\Anaconda3\lib\site-packages\werkzeug\wrappers.py", line 921, in force_type
    response = BaseResponse(*_run_wsgi_app(response, environ))
  File "C:\Users\acer\Anaconda3\lib\site-packages\werkzeug\test.py", line 923, in run_wsgi_app
    app_rv = app(environ, start_response)
TypeError: 'dict' object is not callable
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You're trying to return a <code>dict</code> as a response. - Try using something as shown below.</p>
<pre><code>from flask import jsonify

@app.route('/route')
def example():
    return jsonify({"your": "dict"})
</code></pre>
</div>
<span class="comment-copy">post full traceback of your error</span>
<span class="comment-copy">I just added it to the post there you go</span>
<span class="comment-copy">also check indentation of your code</span>
<span class="comment-copy">checked, all good</span>
<span class="comment-copy">but I'm not returning the <code>dict</code>, I'm just trying to extract the data to check if the user exists etc.</span>
<span class="comment-copy">Well, the code of your view function says you are returning a <code>dict</code> -- <code>return {'message': 'User {} doesn\'t exist'.format(credentials['username'])}</code> and <code>return {'message': 'Wrong credentials'}</code></span>
<span class="comment-copy">You are returning a <code>dict</code> and I believe you have invalid indentations too.</span>
<span class="comment-copy">you were right, I was trying to log in with valid credentials so it didn't come to my mind to check those <code>dict</code>s, now I have to go back and check my database. thanks and sorry I'll try to be more careful next time.</span>
<span class="comment-copy">You don't have to be sorry. - Glad it helped.</span>
<div class="post-text" itemprop="text">
<p>I would like to know how to convert ISO date to UTC in python(2.6.6)</p>
<pre><code>date_dob = getattr(model, value)
                 tz=pytz.UTC
                 date_dob =tz.localize(date_dob)
                 print(date_dob) 
</code></pre>
<p>Here date_dob is mapped to DB property with value ISODate("1989-08-27T00:00:00.000Z").My requirement is to convert it into a UTC date time.</p>
<p>Output  1989-08-27 00:00:00+00:00 ,I believe its not a UTC value</p>
</div>
<div class="post-text" itemprop="text">
<p>Is this what you want?</p>
<pre><code>import dateutil.parser
datestring = '1989-08-27T00:00:00.000Z'
yourdate = dateutil.parser.parse(datestring)
print(yourdate)


from datetime import datetime
from pytz import timezone
date_str = '1989-08-27T00:00:00.000Z'
print(date_str)

datetime_obj = datetime.strptime(date_str, "%Y-%m-%dT%H:%M:%S.%fZ")
datetime_obj_utc = datetime_obj.replace(tzinfo=timezone('UTC'))
print(datetime_obj_utc.strftime("%Y-%m-%d %H:%M:%S %Z%z"))

datetime_obj_utc = datetime_obj.replace(tzinfo=timezone('US/Eastern'))
print(datetime_obj_utc.strftime("%Y-%m-%d %H:%M:%S %Z%z"))
</code></pre>
</div>
<span class="comment-copy"><code>UTC</code> is a time zone, <code>ISO date</code> is a (date)time format</span>
<span class="comment-copy">No, I have a date object (date_dob ) and I want to change the time zone</span>
<div class="post-text" itemprop="text">
<p>I want to add a <strong>Sessions</strong> tabs to my Django project:</p>
<p><strong>navbar.html</strong></p>
<pre><code> &lt;li&gt;&lt;a href="{% url 'user_sessions:session_list' %}"&gt;Sessions&lt;/a&gt;&lt;/li&gt;
</code></pre>
<p>But i keep getting the following error:</p>
<pre><code>'User' object has no attribute 'session_set''User' object has no attribute 'session_set'
Exception Location: C:\Users\User\lib\site-packages\django\utils\functional.py in inner, line 214
</code></pre>
<p>I don't know where this error comes from, i did not find any other reference online, can anyone help me?</p>
<p>Here is the login view that i'm using: <a href="https://github.com/Bouke/django-two-factor-auth/blob/master/two_factor/views/core.py" rel="nofollow noreferrer">https://github.com/Bouke/django-two-factor-auth/blob/master/two_factor/views/core.py</a></p>
<p><strong>Full traceback</strong></p>
<pre><code>Environment:


Request Method: GET
Request URL: http://127.0.0.1:8000/account/sessions/

Django Version: 2.1.7
Python Version: 3.7.0
Installed Applications:
['django.contrib.admin',
 'django.contrib.auth',
 'django.contrib.contenttypes',
 'django.contrib.sessions',
 'django.contrib.messages',
 'django.contrib.staticfiles',
 'main.apps.MainConfig',
 'tinymce',
 'captcha',
 'django.contrib.sites',
 'django_otp',
 'django_otp.plugins.otp_static',
 'django_otp.plugins.otp_totp',
 'two_factor']
Installed Middleware:
['django.middleware.security.SecurityMiddleware',
 'django.contrib.sessions.middleware.SessionMiddleware',
 'django.middleware.common.CommonMiddleware',
 'django.middleware.csrf.CsrfViewMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django.contrib.messages.middleware.MessageMiddleware',
 'django.middleware.clickjacking.XFrameOptionsMiddleware',
 'django.contrib.auth.middleware.AuthenticationMiddleware',
 'django_otp.middleware.OTPMiddleware']



Traceback:

File "C:\Users\User\lib\site-packages\django\core\handlers\exception.py" in inner
  34.             response = get_response(request)

File "C:\Users\User\lib\site-packages\django\core\handlers\base.py" in _get_response
  126.                 response = self.process_exception_by_middleware(e, request)

File "C:\Users\User\lib\site-packages\django\core\handlers\base.py" in _get_response
  124.                 response = wrapped_callback(request, *callback_args, **callback_kwargs)

File "C:\Users\User\lib\site-packages\django\views\generic\base.py" in view
  68.             return self.dispatch(request, *args, **kwargs)

File "C:\Users\User\lib\site-packages\django\utils\decorators.py" in _wrapper
  45.         return bound_method(*args, **kwargs)

File "C:\Users\User\lib\site-packages\django\contrib\auth\decorators.py" in _wrapped_view
  21.                 return view_func(request, *args, **kwargs)

File "C:\Users\User\lib\site-packages\user_sessions\views.py" in dispatch
  22.                                                         **kwargs)

File "C:\Users\User\lib\site-packages\django\views\generic\base.py" in dispatch
  88.         return handler(request, *args, **kwargs)

File "C:\Users\User\lib\site-packages\django\views\generic\list.py" in get
  142.         self.object_list = self.get_queryset()

File "C:\Users\User\lib\site-packages\user_sessions\views.py" in get_queryset
  14.         return self.request.user.session_set\

File "C:\Users\User\lib\site-packages\django\utils\functional.py" in inner
  214.         return func(self._wrapped, *args)

File "C:\Users\User\lib\site-packages\django\utils\functional.py" in inner
  214.         return func(self._wrapped, *args)

Exception Type: AttributeError at /account/sessions/
Exception Value: 'User' object has no attribute 'session_set'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You need to replace <code>django.contrib.sessions</code> in your <code>INSTALLED_APPS</code> with <code>user_sessions</code> if you want to use django-user-sessions. This will setup its models correctly.</p>
<p>Furthermore make sure you have also followed all other <a href="https://django-user-sessions.readthedocs.io/en/stable/installation.html" rel="nofollow noreferrer">installation instructions</a>.</p>
</div>
<span class="comment-copy">You seem to be using this package <a href="https://django-user-sessions.readthedocs.io/en/stable/installation.html" rel="nofollow noreferrer">django-user-sessions.readthedocs.io/en/stable/installation.html</a> if so please follow the install instructions</span>
<span class="comment-copy">add <code>user_sessions</code> to your installed apps and migrate if you want to use sessions with foreign keys to users. See also the example app's <a href="https://github.com/Bouke/django-two-factor-auth/blob/master/example/settings.py" rel="nofollow noreferrer">settings.py</a></span>
<span class="comment-copy">Yes! Thank you both! I suspected it was an import error, but since i noticed that i already had a Session module on my INSTALLED_APPS, i was not able to figure out what i was missing!</span>
<span class="comment-copy">Indeed, my error was to use django.contrib.sessions instead of django-user-sessions. Installing and adding to my INSTALLED_APPS django-user-sessions worked!</span>
<div class="post-text" itemprop="text">
<p>I have a little probleme with the sklearn library.
I am trying to import a module named 'pls' and I have en error </p>
<pre><code>ImportError: cannot import name 'pls'
</code></pre>
<p>I tried to do like this post: <a href="https://stackoverflow.com/questions/10729116/adding-a-module-specifically-pymorph-to-spyder-python-ide">adding-a-module-specifically</a>
but I have no 'pls' file in my 'sklearn' file.</p>
<p>Even after upgraded my sklearn version with <code>pip install -U scikit-learn</code>...
It says it is already up-to-date.</p>
<p>Any idea ? 
Thanks for your help, and pardon my english :P</p>
</div>
<div class="post-text" itemprop="text">
<p>Python cannot magically know that the <code>pls</code> module you want is inside <code>sklearn</code>. You need to specify it. Also the sklearn version 0.11 is many years old, things have moved since then. With scikt-learn 0.20, the right way is:</p>
<pre class="lang-py prettyprint-override"><code>from sklearn.cross_decomposition import PLSRegression

estimator = PLSRegression()
</code></pre>
</div>
<span class="comment-copy">Could you add the exact import statement you are trying to use to your question (not as a comment though). I also cannot find any reference that a <code>pls</code> module exists in <code>scikit-learn</code></span>
<span class="comment-copy">what is exactly the module you are trying to get?</span>
<span class="comment-copy">try installing scipy and numpy ??</span>
<span class="comment-copy">Scipy and Numpy already installed and both up-to-date. I want to get this module : <a href="http://ogrisel.github.io/scikit-learn.org/sklearn-tutorial/modules/generated/sklearn.pls.PLSRegression.html" rel="nofollow noreferrer">sklearn.pls</a></span>
<div class="post-text" itemprop="text">
<p>I’m implementing JWT authentication in my Django project and at the moment I’m stuck in a part where I’d like to filter response data by my JWT.</p>
<p>I’d like to get particular data referring to authenticated user in my Django view. How can I get this filtered data? </p>
<p>Here’s example for my Settings view.</p>
<p>Views.py 
</p>
<pre><code>Class SettingsViewSet(viewsets.ModelViewSet):
    # here I'd like to decode my JWT token 
    # and filter the response data for particular user 
    queryset = Settings.objects.all()
    serializer_class = SettingsSerializer
</code></pre>
<p>urls.py</p>
<pre><code># ...
router.register(r'api/settings', SettingsViewSet)
# ...
urlpatterns = [
    # ...
    url(r'^', include(router.urls)),
    url(r'^api-auth/', include('rest_framework.urls', namespace='rest_framework')),
    url('api/token/', jwt_views.TokenObtainPairView.as_view(), name='token_obtain_pair'),
    # ...
]
</code></pre>
<p>Serializers.py</p>
<pre><code>class SettingsSerializer(serializers.ModelSerializer):
    class Meta:
        model = Settings 
        fields = ('id', 'name', 'value', 'description', 'office')
</code></pre>
<p>settings.py</p>
<pre><code>REST_FRAMEWORK = {
'DEFAULT_PERMISSION_CLASSES': [
    'rest_framework.permissions.IsAuthenticated',
],
'DEFAULT_AUTHENTICATION_CLASSES': [
    'rest_framework_simplejwt.authentication.JWTAuthentication',
],
</code></pre>
<p>}</p>
<p>Here’s a curl command which I use to get response from server:</p>
<pre><code>curl -H ‘Content-Type: application/json’ http://127.0.0.1:8000/api/settings/ -H ‘Authorization: Bearer &lt;Here goes JWT token for particular user&gt;’ 
</code></pre>
<p>In response I get all the settings for all users. I’d like to get data only for the authenticated one. </p>
</div>
<div class="post-text" itemprop="text">
<p>Currently logged in user instance should be automatically added to <strong>request</strong> objects by the library you are using. With that, you can override <strong>get_queryset</strong> method to filter the response by currently logged in user, assuming you have a user field in your Settings model:</p>
<pre><code>class SettingsViewSet(viewsets.ModelViewSet):
    queryset = Settings.objects.all()
    serializer_class = SettingsSerializer

    def get_queryset(self):
        queryset = Settings.objects.filter(user=self.request.user)
        return queryset
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I'm creating a web applcation in Python and I only want the user to be able to enter a weekday that is older than today's date. I've had a look at isoweekday() for example but don't know how to integrate it into a flask form. The form currently looks like this:</p>
<p><code>appointment_date = DateField('Appointment Date', format='%Y-%m-%d', validators=[DataRequired()])</code></p>
<p>Thanks</p>
</div>
<div class="post-text" itemprop="text">
<p>If you just want a weekday, you should put a <code>select</code> or a <code>textbox</code>, not a <code>date picker</code>.</p>
<p>If you put a <code>select</code>, you can disable the days before today so you don't even need a validation</p>
</div>
<span class="comment-copy">Thanks for the answer, what would I need to change in the code to do this? Thanks</span>
<span class="comment-copy">You can use something like this: <code>SelectField(u'Field name', choices = myChoices, validators = [Required()])</code>. Take a look at <a href="https://wtforms.readthedocs.io/en/stable/fields.html#wtforms.fields.SelectField" rel="nofollow noreferrer">docs</a></span>
<span class="comment-copy">but how would I set this so that the number of days in the month is correct? Eg not having 31 in every month?</span>
<div class="post-text" itemprop="text">
<p>I was trying:</p>
<pre><code>from pymessager.message import Messager
... 
client = Messager(PAGE_ACCESS_TOKEN)
client.set_greeting_text("Hello world")
client.set_get_started_button_payload("Get Start")
 ...
</code></pre>
<p>this worked:</p>
<pre><code>client.set_greeting_text("Hello world")
</code></pre>
<p>but this did not:</p>
<pre><code>client.set_get_started_button_payload("Get Start")
</code></pre>
<p>Does anyone know what I did wrong?</p>
</div>
<span class="comment-copy">Hi, please elaborate on what "<i>not worked</i>" means. Was there an error message? What were the actual vs. the expected results? Please create a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a> and see <a href="https://stackoverflow.com/questions/how-to-ask">How to Ask</a>. Thanks.</span>
<div class="post-text" itemprop="text">
<p>In the below data(df2), I need to know how many(count) children every p1 have?
for example: In <a href="https://i.stack.imgur.com/DO9GD.png" rel="nofollow noreferrer">this picture</a> a single p1 is showing.
I need a data table for this picture in the following form.</p>
<pre><code>p1_id | no. of p1|no. of p2| no. of p3 |
374971| 1        |3        | 4         |
....  |.....     |......   |.....      |
</code></pre>
<p>given that: there is no certain hierarchy. like, may be possible that p1 have another p1 under him or p3 under him. And there may be n number of branches and node possible.</p>
<p>Df2</p>
<pre><code>   id   title   parent_id
0   11  p1          11
1   12  p1          11
2   13  p2          12
3   14  p2          12
4   15  p2          13
5   16  p2          13
6   17  p3          13
</code></pre>
<p>This df2 problem should give output like</p>
<pre><code>p1_id | no. of p1|no. of p2| no. of p3 |
11    | 1        |4        | 1         |
12    | 0        |2        | 0         |
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If I understand your question correctly,
You just want to count how many p1, p2, p3, etc are there per parent_id.
In this case, you can do .groupby using a list of two columns:</p>
<pre><code>df = pd.DataFrame.from_dict(
    {'c_id':[374971,363401,373600,363401],
     'title':['p1','p2','p1','p3'],
     'parent_id':[443547,360652,256963,360652]
    })

df.groupby(['parent_id','title']).count()
</code></pre>
<p>Will give a result which is similar to what you wanted, but not quite in the same format:</p>
<pre><code>parent_id   title   c_id    
256963      p1      1
360652      p2      1
            p3      1
443547      p1      1
</code></pre>
<p>Hope this helps!</p>
</div>
<span class="comment-copy">but this will show only immediate child not the grandchilds. please refer image</span>
<div class="post-text" itemprop="text">
<p>I have this dataframe :</p>
<pre><code>Team    Age
 X       [28,21,16,45]
 B       [18,19,16,23]
 Y       [32,27,34,23]
</code></pre>
<p>And all I want is to get the brackets off the Age column to go further. I am doing the following:</p>
<pre><code> df['Age']=[','.join(i) for i in df['Age']] 
</code></pre>
<p>But  I get the <strong>can only join an iterable</strong> error when doing so; If i go through a loop and print the result I able to get what want.</p>
</div>
<div class="post-text" itemprop="text">
<p>If values are strings:</p>
<pre><code>df['Age'] = df['Age'].str.strip('[]')
</code></pre>
<p>If values are lists:</p>
<pre><code>df['Age'] = df['Age'].str.join(',')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use:</p>
<pre><code>df['Age'] = df['Age'].astype(str).str[1:-1]
</code></pre>
<p>If the <code>'Age'</code> column is a string column, just use:</p>
<pre><code>df['Age'] = df['Age'].str[1:-1]
</code></pre>
<p>And now:</p>
<pre><code>print(df)
</code></pre>
<p>Is the desired output.</p>
</div>
<span class="comment-copy">What is <code>print (type(df['Age'].iat[0]))</code> ?</span>
<span class="comment-copy">great. Much easier than I thought. Thanks</span>
<div class="post-text" itemprop="text">
<p>I am writing a small command line utility for my script and I can't figure out how to properly get the full path from the argument.</p>
<p>Here's what I mean.</p>
<pre><code>parser = ArgumentParser()
parser.add_argument("-src",
                    required = True, help="path to some folder")
args = parser.parse_args()
print(args.src)
</code></pre>
<p>If the user pass the full path, e.g. <code>"/home/username/projectname/folder"</code>, everything is fine. </p>
<p>But if the user runs the script from let's say <code>"projectname"</code> folder and pass the relative path <code>"./folder"</code> I get exactly the same string <code>"./folder"</code> while parsing the arguments instead of the full path <code>"/home/username/projectname/folder"</code>.</p>
<p>So, I have been wondering if there is some kind of inbuilt functionality in <code>Argparse</code> that allows to get the full path from the relative path?</p>
</div>
<div class="post-text" itemprop="text">
<p>To add onto Tryph's answer, you can specify the <a href="https://docs.python.org/3/library/argparse.html#type" rel="nofollow noreferrer"><code>type</code></a> parameter in the argument declaration. It can take any callable that takes a single string argument and returns the converted value:</p>
<pre><code>parser.add_argument("-src",
                    required=True,
                    help="path to some folder",
                    type=os.path.abspath)
</code></pre>
<p>This returns a string with the absolute path, you could specify your own function as well:</p>
<pre><code>def my_full_path(string):
    script_dir = os.path.dirname(__file__)
    return  os.path.normpath(os.path.join(script_dir, string))


parser = ArgumentParser()
parser.add_argument("-src",
                    required=True,
                    help="path to some folder",
                    type=my_full_path)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><strong>EDIT</strong>: The <a href="https://stackoverflow.com/a/55258475/2696355">Alex's answer</a> shows how to make <code>argparse</code> manage relative-to-absolute path conversion by simply filling the <code>add_argument</code>'s <code>type</code> parameter.</p>
<hr/>
<p>I do not think argparse provides such feature but you can achieve it using <a href="https://docs.python.org/3.7/library/os.path.html#os.path.abspath" rel="nofollow noreferrer">os.path.abspath</a>:</p>
<pre><code>abs_src = os.path.abspath(args.src)
</code></pre>
<p>Keep in mind that this will make an absolute path by concatenating the working directory with the relative path. Thus the path is considered relative to working directory.</p>
<hr/>
<p>If you want to make the path relative to the script directory, you can use <a href="https://docs.python.org/3.7/library/os.path.html#os.path.dirname" rel="nofollow noreferrer">os.path.dirname</a> on the <code>__file__</code> variable and <a href="https://docs.python.org/3.7/library/os.path.html#os.path.join" rel="nofollow noreferrer">os.path.join</a> to build an absolute path from a path relative to your Python script:</p>
<pre><code>script_dir = os.path.dirname(__file__)
abs_src = os.path.join(script_dir, args.src)
</code></pre>
<p>Finally, since joined path can contain tokens such as <code>.</code> and <code>..</code>, you can "prettify" your built path with <a href="https://docs.python.org/3.7/library/os.path.html#os.path.normpath" rel="nofollow noreferrer">os.path.normpath</a>:</p>
<pre><code>abs_path = os.path.normpath(os.path.join(script_dir, args.src))
</code></pre>
</div>
<span class="comment-copy">try <code>os.path.abspath(args.src)</code></span>
<span class="comment-copy">@user3051029 see answer from Alex. regarding your question, I think it should be the accepted answer</span>
<span class="comment-copy">@Tryph sure, if you don't mind it, I'll change the accepted answer.</span>
<span class="comment-copy">very nice trick. linked it in my answer</span>
<span class="comment-copy">Thanks, it works pretty well for my scenario. Didn't know about this function.</span>
<div class="post-text" itemprop="text">
<p>I am trying to make a box plot of values contained in a <code>Series</code>. I have seen this <a href="https://stackoverflow.com/questions/26507404/time-series-boxplot-in-pandas">post</a> but my case is a little different. My Series values is a list of N D-dimensional arrays taken on each day. What I want is to make a per day plot where a box plot is drawn for each of the N arrays but I am getting, <code>TypeError: unhashable type: 'numpy.ndarray'</code>. Any ideas please?</p>
<p>Thanks in advance.</p>
<p><strong>EDIT1:</strong> 
Data sample:</p>
<pre><code>Date
2014-02-01    [-0.13934771706335308, 0.52431438441752, 0.303... -&gt; Box plot 1
2014-02-02    [-0.15212360891411472, 0.5057162101551876, 0.3... -&gt; Box plot 2
2014-02-03    [-0.15906372162522756, 0.4900703653941794, 0.2...
2014-02-04    [-0.18159376988693987, 0.48163379794842914, 0....
2014-02-05    [-0.18234763860841446, 0.4768498811155851, 0.2...
</code></pre>
<p>Sample Series data:</p>
<pre><code>N= 200
D=20
ts = pd.Series([np.random.randn(D) for _ in range(N)], index=pd.date_range(start="2014-02-01", periods=N, freq="D"))
</code></pre>
<p><strong>EDIT2:</strong> 
I think I got it using <a href="https://stackoverflow.com/questions/40066648/boxplot-for-list-in-pandas-dataframe">this</a> <code>ts.apply(lambda x: pd.Series(x)).T.boxplot(figsize=(10, 10), rot=90)</code> but the output is dense especially when N is large. I am trying to sample it either by taking the sum, mean or the last of values in a range of 3 Business (B) day but keeps me in trouble. Any help is highly appreciated. Code sample I am trying with:</p>
<pre><code>ts.resample('3D', label='right', closed='right', how='last').apply(lambda x: x.last()).T.boxplot(figsize=(20, 10), rot=90) 
</code></pre>
<p>returns: <code>Must Produce Aggregated Value</code></p>
<p><strong>EDIT3:</strong> 
I think I got the results I want with</p>
<pre><code>tss=ts.resample('2D', label='right', closed='right').agg(lambda x: x.sum())
</code></pre>
</div>
<span class="comment-copy">Show your code and a sample of the data</span>
<span class="comment-copy">@SreeramTP thanks for the response. What is have tries is based on the reference post by I can not find a way (an elegant way) to adapt it. Excuse my ignorance I am new in dataframes rationale.</span>
<span class="comment-copy">I have problem running <code>agg(lambda x: x.median())</code>, returns <code>TypeError: setting an array element with a sequence.</code>. Any ideas how can we make it to compute the median instead of the sum?</span>
<div class="post-text" itemprop="text">
<p>I am currently trying to generate a binary matrix of a animated figure for each frame. I use the matplotlib animation package to create a animation of moving dots in a 10 x 10 figure. </p>
<pre><code>def animate(i):
    for dot in dots:
        dot.move()
    d.set_data([dot.x for dot in dots],
               [dot.y for dot in dots])

    return d,


anim = animation.FuncAnimation(fig, animate, frames=200, interval=1)
</code></pre>
<p><a href="https://i.stack.imgur.com/rDe7W.png" rel="nofollow noreferrer"><img alt="" src="https://i.stack.imgur.com/rDe7W.png"/></a></p>
<p>I know I could save the fig as <strong>a .png</strong> and load it again to get the RGB and then generate the binary matrix by thresholds, but this cant be a proper soloution.</p>
<p>Any other ideas ?   </p>
</div>
<span class="comment-copy">If you have the raw data (to even make the animation), why can't you just use that data?</span>
<span class="comment-copy">i want to use the binary Matrix (0 for White spot and 1 for black spot) data as Input of a neuronal Network. In reality i don't have the Position of the dots and there is no possibility of detecting the position. But i have an Image of the dots moving which i am taking with a camera. If i use the raw data i would somehow cheat and could not use the NN in reality</span>
<div class="post-text" itemprop="text">
<p>I have a django application, listening to 127.0.0.1, and reachable via nginx.</p>
<p>What are my options in order to get information about the public IP (the ones clients are using) from within the django application?</p>
<p>Currently I am doing:</p>
<pre><code>def get_local_ip(request):
    """Return the local IP (where the application is listening to)"""
    # TODO: this should be the server IP as seen by the UI (the public IP, where nginx is listening)
    return request.META.get('HTTP_HOST') if request else None
</code></pre>
<p>But this returns <code>127.0.0.1</code>.</p>
</div>
<div class="post-text" itemprop="text">
<p>Your nginx configuration needs to add that to the headers, not sure that's done by default. The <code>$server_addr</code> is the one you need to add to the headers, so in your nginx config you would need to add (assuming you're using reverse proxy):</p>
<pre class="lang-none prettyprint-override"><code>proxy_set_header X-Server-IP $server_addr;
</code></pre>
<p>And then in your <code>get_local_ip</code> method you'd be able to access that header with:</p>
<pre><code>return request.META.get('HTTP_X_SERVER_IP')
</code></pre>
<p>Note that if your nginx server is behind a load balancer, this still won't be the address your users "see", since they see the IP address of your load balancer. The address they see is:</p>
<pre><code>import socket
ip_address = socket.gethostbyname(request.META.get('SERVER_NAME'))
</code></pre>
<p>which just resolves your domain name using DNS (and may slow down your request, since a DNS lookup needs to be made, depending on the TTL you have set in your DNS records)</p>
</div>
<div class="post-text" itemprop="text">
<p>Does anyone know how to make this work? (in python)
I am a beginner by the way :)</p>
<pre><code>import random
def roll():
    input1 = input("Player1, type 'ROLL' to roll.")
    if (input1 == "ROLL"):
        dice1 = random.randint(1,6)
        dice2 = random.randint(1,6)
        print("You rolled a " + dice1() + " and a " + dice2() ".")

    else:
        pass

roll()
</code></pre>
<p>I get:</p>
<pre><code>  File "main.py", line 9
    print("You rolled a " + dice1() + " and a " + dice2() ".")
                                                            ^
SyntaxError: invalid syntax
</code></pre>
<p>I also want it to repeat the "Player1, type 'ROLL' to roll." if the input doesnt equal ROLL
Please :) Thank you</p>
</div>
<div class="post-text" itemprop="text">
<p>You have an invalid syntax near:</p>
<pre><code>print("You rolled a " + dice1() + " and a " + dice2() ".")
</code></pre>
<p>Using <a href="https://www.digitalocean.com/community/tutorials/how-to-use-string-formatters-in-python-3" rel="nofollow noreferrer"><code>string format</code></a>:</p>
<p><strong>Replace this</strong>:</p>
<pre><code>print("You rolled a " + dice1() + " and a " + dice2() ".")
</code></pre>
<p><strong>With this</strong>:</p>
<pre><code>print("You rolled a {} and {}".format(dice1,dice2))
</code></pre>
<blockquote>
<p>Note: You can use a <code>while loop</code> to keep taking the <code>user-input</code> unless the <code>input</code> matches with <code>ROLL</code>:</p>
</blockquote>
<p><strong>Hence</strong>:</p>
<pre><code>import random

def roll():
    while True:
        input1 = input("Player1, type 'ROLL' to roll.")
        if input1 == "ROLL":
            dice1 = random.randint(1,6)
            dice2 = random.randint(1,6)
            print("You rolled a {} and {}".format(dice1, dice2))
            break  
roll()
</code></pre>
<p><strong>OUTPUT</strong>:</p>
<pre><code>Player1, type 'ROLL' to roll.whaaaat?
Player1, type 'ROLL' to roll.okay
Player1, type 'ROLL' to roll.roll
Player1, type 'ROLL' to roll.ROLL
You rolled a 2 and 2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>There's a syntax error in the <code>print</code>.</p>
<p>Both <code>int</code> values need to be cast to string using <code>str()</code>.</p>
<p><code>dice1</code> and <code>dice2</code> are not functions so we can't write <code>()</code> next to them.</p>
<pre><code>print("You rolled a " + dice1() + " and a " + dice2() ".")
</code></pre>
<p>should be </p>
<pre><code>print("You rolled a " + str(dice1) + " and a " + str(dice2) + ".")
</code></pre>
<p>Preferrably, you can use the <code>format</code> function that comes with any string.</p>
<pre><code>print("You rolled a {dice1} and a {dice2}.\n".format(
        dice1=dice1,
        dice2=dice2
    )
)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The whole function should be:</p>
<pre><code>import random
def roll():
    input1 = input("Player1, type 'ROLL' to roll.")
    if (input1 == "ROLL"):
        dice1 = random.randint(1,6)
        dice2 = random.randint(1,6)
        print("You rolled a %s and a %s." % (dice1,dice2))

    else:
        pass

roll()
</code></pre>
<p>If you mean to show the two variables, <code>dice1</code> and <code>dice2</code>.</p>
<p>Use:</p>
<pre><code>print("You rolled a %s and a %s." % (dice1,dice2))
</code></pre>
<p>Instead of:</p>
<pre><code>print("You rolled a " + dice1() + " and a " + dice2() ".")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You forgot a comma or + in the print statment.
You also call variables dice1 dice2 as functions.</p>
<pre class="lang-py prettyprint-override"><code>import random

def roll():
    input1 = input("Player1, type 'ROLL' to roll. ")
    print(input1)
    if input1 == 'ROLL':
        dice1 = random.randint(1,6)
        dice2 = random.randint(1,6)
        print("You rolled a " + str(dice1) + " and a " + str(dice2) + ".")
    else:
        pass

roll()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Python's <code>random.randint</code> returns an integer so you don't need to call your <code>dice1</code> and <code>dice2</code> variables.
Replace this line:</p>
<pre><code>print("You rolled a " + dice1() + " and a " + dice2() ".")
</code></pre>
<p>with this:</p>
<pre><code>print("You rolled a " + dice1 + " and a " + dice2 ".")
</code></pre>
<p>reference for Python's <a href="https://docs.python.org/2/library/random.html" rel="nofollow noreferrer">random module</a></p>
</div>
<span class="comment-copy">you forgot a comma at the print line</span>
<span class="comment-copy">What's wrong with the above code?</span>
<span class="comment-copy">What have you tried? What you wanna do...please specify in the question</span>
<span class="comment-copy">Why do you apply parentheses on dice1 and dice2? They have each been assigned some int. Just use str(dice1) and str(dice2), or a format string with %d.</span>
<span class="comment-copy">Dupe <a href="https://stackoverflow.com/questions/12018992/print-combining-strings-and-numbers">https://stackoverflow.com/questions/12018992/print-combining-strings-and-numbers</a></span>
<span class="comment-copy">How can you add <code>int</code> and a <code>str</code>?</span>
<div class="post-text" itemprop="text">
<h2>Background</h2>
<p>I would like to make a program using the RealSense depth camera in python 3.6. However, the wrappers are only avaialable for python 2, but according to their <a href="https://github.com/IntelRealSense/librealsense/tree/master/wrappers/python" rel="nofollow noreferrer">github page</a>, could be built by users themselves:</p>
<blockquote>
<p>Windows users can install the RealSense SDK 2.0 from the release tab to get pre-compiled binaries of the wrapper, for both x86 and x64 architectures. (Note that these binaries are built with Python 2.7, and cannot be import using Python 3).</p>
</blockquote>
<p>and also in one of the <a href="https://github.com/IntelRealSense/librealsense/issues/980" rel="nofollow noreferrer">issues</a>:</p>
<blockquote>
<p>Unfortunately no, the only way at the moment is by building it from source. We are planing to provide a PyPI package that will allow you to simply pip install pyrealsense2 and it will have both python 2 and 3 support, but it is still work in progress...</p>
</blockquote>
<p>Therefore, I decided to try and build it myself before reverting to python 2.x.
I followed the explanation on the <a href="https://github.com/IntelRealSense/librealsense/tree/master/wrappers/python#windows" rel="nofollow noreferrer">github documentation</a>, which is a little too basic for someone who never really built anything. I puzzled together quite a bit, but I have hit a wall where the CMake documentation, stackoverflow, and generic google searches did not help me. It could be due to my lacking understanding, but I decided to reach out and see what I can learn.</p>
<h2>My issue</h2>
<p>Currently I'm stuck with the error:</p>
<pre><code>CMake Error at core/CMakeLists.txt:3 (target_sources):
  Cannot specify sources for target "PRIVATE" which is not built by this
  project.
Call Stack (most recent call first):
  CMakeLists.txt:5 (include)
</code></pre>
<p>I tried understanding the CMakeLists.txt which looks like this:</p>
<pre><code>target_sources(${LRS_TARGET}
    PRIVATE
        "${CMAKE_CURRENT_LIST_DIR}/streaming.h"
        ...
)
</code></pre>
<p>After looking in the documentation I decided to change <code>PRIVATE</code> into <code>PUBLIC</code>, but this results in the same error (but with public instead of private).</p>
<p>Literal internet searches (in between quotation marks) for this error return nothing, and other trials didn't help me any further.</p>
<p>I'm now assuming the issue is with the <code>${LRS_TARGET}</code> variable, but I have no idea where to look. I can't seem to find out where it should be defined, and setting it as an "Entry" in the CMake gui makes the error say "value" instead of "PRIVATE".</p>
<p>Can anyone help me out? Thanks in advance!</p>
<h2>My Settings</h2>
<p>I'm using cmake-gui, and setting the following:</p>
<ul>
<li>"Where is the source code:" = D:/librealsense-master/src</li>
<li>"Where to build the binaries:" = D:/librealsense-master/bin</li>
<li>BUILD_PYTHON_BINDINGS = True</li>
<li>-DPYTHON_EXECUTABLE = D:/Anaconda3/python.exe</li>
</ul>
<p>For the rest, I did nothing, and only some Entries appear made my CMake itself.</p>
<h2>Issues I Solved</h2>
<p>As someone might be trying the same thing as I am, I will mention the steps I took until now:</p>
<ol>
<li><p>The first issue I got was that I needed to add the following line at the top of the main CMakeLists.txt file:</p>
<pre><code>cmake_minimum_required(VERSION 3.14)
</code></pre></li>
<li><p>Then I found out I needed to install Visual Studio</p></li>
<li><p>Then I found out that only Visual Studio was not enough, and that I needed to add the <em>Desktop development with C++</em> "Workload"</p></li>
</ol>
</div>
<span class="comment-copy">You have specified <b>wrong directory</b> as a <i>source</i> one. Correct directory is <code>D:/librealsense-master/</code> (this is the top directory of the project on GitHub). BTW, absence of <code>cmake_minimum_required</code> should signal that you are doing something wrong.</span>
<span class="comment-copy">Damn, I tried that when working in the installed folder (However, that did not contain other CMakeLists.txt files, and errored on that). It did not occur to me to redo this test in the downloaded master folder. Thanks a lot, @Tsyvarev! I now get other errors, let's see if I can solve those!</span>
<div class="post-text" itemprop="text">
<p>I have a class inside a .py file that contains two functions.</p>
<p><code>new_column</code> generates a new column based on values of existing columns (Col1 and Col2).</p>
<p><code>transform_df</code> applies the previous function to a dataframe, via a lambda expression.</p>
<p>The end result looks like this:</p>
<pre><code>Col1    Col2    col3
0   a   b   ab
1   a   b   ab
2   a   c   None
3   a   b   ab
</code></pre>
<p>How do I use these functions in a new file/notebook?</p>
<pre><code># kept within file df_functions.py
class Functions():

    def __init__(self, path):
        self.path = path # path to .csv

    # function to create new column, based on Col1 and Col2 values
    def new_column(self, row):
        if (row['Col1'] == 'a') &amp; (row['Col2'] == 'b'):
            return 'ab'

    # apply previously defined function via lambda expression
    def transform_df(self, path):        
        df = pd.read_csv(self.path)

        # apply function 'new_column' to df
        df['col3'] = df.apply(lambda row: self.new_column(row), axis=1)

        # other potential functions applications here

        return df
</code></pre>
<p>I have tried the following:</p>
<pre><code>from df_functions import Functions

df_path = '../datafile.csv'
FunctionsObject = Functions(path=df_path)

new_df = FunctionsObject.transform_df(path=df_path)
</code></pre>
<p>However this returns</p>
<pre><code>NameError: ("name 'new_column' is not defined", 'occurred at index 0')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Appears to be a problem related to making edits to the .py file containing the class. After making changes, I restarted the kernel and the imported functions work as expected.</p>
</div>
<span class="comment-copy"><code>FunctionsObject.transform_df()</code> this must have caused error since <code>transform_df()</code> requires <code>path</code> parameter. This shows that your code has few missing statements, without which we cannot determine what went wrong.</span>
<span class="comment-copy">What is the point of having the two functions be part of a class? You are passing the path to <code>transform_df</code> anyway</span>
<span class="comment-copy">Additionally, there is inconsistency in your class name. Is it called <code>Functions</code> or is it called <code>FunnelFunctions</code>?</span>
<span class="comment-copy">I suggest adding pandas tag to the question, because it is specific to the library</span>
<span class="comment-copy">Please provide a minimal example that allows us to reproduce your error. There are currently several inconsistencies in your code. For example, you import <code>Functions</code> but use <code>FunnelFunctions</code>, and you define <code>transform_df</code> as taking a <code>path</code> parameter but do not supply one.</span>
<div class="post-text" itemprop="text">
<p>I have a folder with images of dogs, named dogID-X.jpg where X is the number of the picture that belongs to one dogID, e.g. 0a08e-1.jpg, 0a08e-2.jpg, 0a08e-3.jpg means there are three images that belong to the same dog.
How do I sort these images into two subfolders based on two lists that have only the dogID [0a08e, 4a45t, ...] i.e. all images with IDs from one list should go to one folder, and all images from another list should go into the other folder. Thanks! The list looks like this: <code>list(y_labels) = ['86e1089a3',
 '6296e909a',
 '5842f1ff5',
 '850a43f90',
 'd24c30b4b',
 '1caa6fcdb', ...]</code></p>
<pre><code>for image in list(y_labels):
              folder = y_labels.loc[image, 'PetID']
              old = './train_images/{}'.format(image)
              new = '//train_images_new/{}/{}'.format(folder, image)
  try:
    os.rename(old, new)
  except:
    print('{} - {}'.format(image,folder))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Well let's assume you have lis1 and lis2 as 2 lists containing only dogID, there is also a folder which contains all the images and I'll call it "mypath", sub folders will be named "lis1" and "lis2".</p>
<pre><code>import os

# path to image folder, get all filenames on this folder
# and store it in the onlyfiles list

mypath = "PATH TO IMAGES FOLDER"
onlyfiles = [f for f in os.listdir(mypath) if os.path.isfile(os.path.join(mypath, f))]

# your list of dogID's
lis1 = ["LIST ONE"]
lis2 = ["LIST TWO"]

# create two seperate lists from onlyfiles list based on lis1 and lis2
lis1files = [i for i in onlyfiles for j in lis1 if j in i]
lis2files = [i for i in onlyfiles for j in lis2 if j in i]

# create two sub folders in mypath folder
subfolder1 = os.path.join(mypath, "lis1")
subfolder2 = os.path.join(mypath, "lis2")

# check if they already exits to prevent error
if not os.path.exists(subfolder1):
    os.makedirs(subfolder1)

if not os.path.exists(subfolder2):
    os.makedirs(subfolder2)

# move files to their respective sub folders
for i in lis1files:
    source = os.path.join(mypath, i)
    destination = os.path.join(subfolder1, i)
    os.rename(source, destination)

for i in lis2files:
    source = os.path.join(mypath, i)
    destination = os.path.join(subfolder2, i)
    os.rename(source, destination)

</code></pre>
<p>I hope it solves your problem.</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>import os
import shutil 
path = r'C:\Users\user\temp\test\dog_old' #folder where all dog images present
list_name =[]
# traverse root directory, and list directories as dirs and files as files
for root, dirs, files in os.walk(path):
    list_name.extend(files)

from collections import defaultdict

dic=defaultdict(list)



for i in list_name:
    filename,ext =os.path.splitext(i)
    group, img_index = filename.split('-')
    dic[group].append(img_index)

# folder path where new  dog images had to added
new_folder = r'C:\Users\user\temp\test\dog_new'

for i in dic:        
        if not os.path.exists(os.path.join(new_folder,i)):
            os.mkdir(os.path.join(new_folder,i))
            for img in dic[i]:
                old_image = os.path.join(path,'{}-{}.jpg'.format(i,img))
                new_image = r'{}.jpg'.format(img)
                new_path =os.path.join(new_folder,i)

                shutil.move(old_image,os.path.join(new_path,new_image))
        else:
            for img in dic[i]:
                old_image = os.path.join(path,'{}-{}.jpg'.format(i,img))
                new_image = r'{}.jpg'.format(img)
                new_path =os.path.join(new_folder,i)
                print(new_path)
                shutil.move(old_image,os.path.join(new_path,new_image))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Try this,</p>
<pre><code>import os
pet_names = ['0a08e', '0a08d']
image_ids =  ["0a08e-1.jpg", "0a08e-2.jpg", "0a08e-3.jpg","0a08d-1.jpg", "0a08d-2.jpg", "0a08d-3.jpg"]

image_folder_path = os.getcwd()#"&lt;image folder path&gt;"
# assuming you want to name the folder with the pet name, create folders with the names in the list.
for pet_name in pet_names:
    if not os.path.exists(os.path.join(image_folder_path,pet_name)):
        print("creating")
        os.makedirs(pet_name)
# loop over the image id's match the pet name and put it in the respective folder
for img_id in image_ids:
    for pet_name in pet_names:
        if pet_name in img_id:
                image_full_path_source = os.path.join(image_folder_path,img_id)

                dest_path = os.path.join(image_folder_path,pet_name)

                image_full_path_destination = os.path.join(dest_path,img_id)

                os.rename(image_full_path_source, image_full_path_destination)
</code></pre>
<p>Hope it helps!</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.python.org/2/library/shutil.html" rel="nofollow noreferrer">shutil</a> for that. Just use the dst as the file destination where it should go based on a list.</p>
<pre><code>from shutil import copyfile

copyfile(src, dst)

</code></pre>
<p>I can provide further help, if you show your code you have written so far.</p>
</div>
<span class="comment-copy">Have you tried anything?</span>
<span class="comment-copy">Welcome to stackoverflow. Please show us what you have tried so far and where exactly you are stuck. You should add a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete and Verifiable</a> example to your question.</span>
<span class="comment-copy">can you gives the name of all the pics in a list. upto 10 would be good</span>
<span class="comment-copy">thank you so much, this worked perfectly!</span>
<span class="comment-copy">@Olivia your welcome!</span>
<span class="comment-copy">OP hasn't provide the full problem description yet, but it's bad to give answer which is totally wrong</span>
<div class="post-text" itemprop="text">
<p>Python beginner (no web dev know-how) here:
The html page shows list of a friend network of a person (each Name has anchor  tag w. link to list of friend network).
Since the page has a timer, I've written a py code to scrap the mth position (friend) of the nth count (page) by traversing through the cycle: (m-&gt;n-&gt;m-&gt;n....). And it works! </p>
<p>Code:</p>
<pre><code>import urllib.request, urllib.parse, urllib.error
from bs4 import BeautifulSoup
import ssl

# Ignore SSL certificate errors
ctx = ssl.create_default_context()
ctx.check_hostname = False
ctx.verify_mode = ssl.CERT_NONE

url = input('Enter URL: ')
position = int(input('Enter position: '))  #Name/link Traverse 
count = int(input('Enter count: ')) #Page Traverse    
print("Retrieving:", url)
for c in range(count):      #returns range of indices
    html = urllib.request.urlopen(url, context=ctx).read() #opening URL
    soup = BeautifulSoup(html, 'html.parser')
    a_tags=soup('a')
    link=a_tags[position-1].get('href', None) #url = href(key) value pair
    content=a_tags[position-1].contents     #name=a_tag.contents
    url=link
    print("Retrieving:", url)
</code></pre>
<p><strong>Input:</strong></p>
<pre><code>Enter URL: http://py4e-data.dr-chuck.net/known_by_Kory.html
Enter position: 1
Enter count: 10
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Retrieving: http://py4e-data.dr-chuck.net/known_by_Kory.html
Retrieving: http://py4e-data.dr-chuck.net/known_by_Shaurya.html
Retrieving: http://py4e-data.dr-chuck.net/known_by_Raigen.html
Retrieving: http://py4e-data.dr-chuck.net/known_by_Dougal.html
Retrieving: http://py4e-data.dr-chuck.net/known_by_Aonghus.html
Retrieving: http://py4e-data.dr-chuck.net/known_by_Daryn.html
Retrieving: http://py4e-data.dr-chuck.net/known_by_Pauline.html
Retrieving: http://py4e-data.dr-chuck.net/known_by_Laia.html
Retrieving: http://py4e-data.dr-chuck.net/known_by_Iagan.html
Retrieving: http://py4e-data.dr-chuck.net/known_by_Leanna.html
Retrieving: http://py4e-data.dr-chuck.net/known_by_Malakhy.html
</code></pre>
<p><strong>Questions:</strong></p>
<ol>
<li><p>Is there a better way to approach this? (libraries, workarounds to delay the timer lol)</p></li>
<li><p>My goals is to make an exhaustive 'list' of friends of all unique Names here; I don't want any code(s), just suggestions and approaches will do.</p></li>
</ol>
</div>
<span class="comment-copy">this should be posted on <a href="https://codereview.stackexchange.com/">codereview.stackexchange.com</a></span>
<div class="post-text" itemprop="text">
<p>Given a pandas dataFrame, how does one convert several numeric columns (where x≠1 denotes the value exists, x=0 denotes it doesn't) into pairwise categorical dataframe? I know it is similar to one-hot decoding but the columns are not exactly one hot.</p>
<p>An example:</p>
<pre><code> df
id A  B  C  D
0  3  0  0  1
1  4  1  0  0
2  1  7  20 0
3  0  0  0  4
4  0  0  0  0
5  0  1  0  0
</code></pre>
<p>The result would be:
    df
    id match</p>
<pre><code> result 
0  A
0  D 
1  A
1  B
2  A
2  B
2  C
3  D
5  B
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.stack.html" rel="nofollow noreferrer"><code>DataFrame.stack</code></a> with filtering and <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Index.to_frame.html" rel="nofollow noreferrer"><code>Index.to_frame</code></a>:</p>
<pre><code>s = df.stack()

df = s[s!=0].index.to_frame(index=False).rename(columns={1:'result'})
print (df)
   id result
0   0      A
1   0      D
2   1      A
3   1      B
4   2      A
5   2      B
6   2      C
7   3      D
8   5      B
</code></pre>
<p>Or if performance is important use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html" rel="nofollow noreferrer"><code>numpy.where</code></a> for indices by matched values with <code>DataFrame</code> constructor:</p>
<pre><code>i, c = np.where(df != 0)

df = pd.DataFrame({'id':df.index.values[i],
                   'result':df.columns.values[c]})
print (df)
   id result
0   0      A
1   0      D
2   1      A
3   1      B
4   2      A
5   2      B
6   2      C
7   3      D
8   5      B
</code></pre>
<p>EDIT:</p>
<p>For first:</p>
<pre><code>s = df.stack()

df = s[s!=0].reset_index()
df.columns= ['id','result','vals']
print (df)
   id result  vals
0   0      A     3
1   0      D     1
2   1      A     4
3   1      B     1
4   2      A     1
5   2      B     7
6   2      C    20
7   3      D     4
8   5      B     1
</code></pre>
<p>For second:</p>
<pre><code>df = pd.DataFrame({'id':df.index.values[i],
                   'result':df.columns.values[c],
                   'vals':df.values[i,c]})
</code></pre>
</div>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/26762100/reconstruct-a-categorical-variable-from-dummies-in-pandas">Reconstruct a categorical variable from dummies in pandas</a></span>
<span class="comment-copy">Thanks! do you know hoe to add into an extra column the value itself?</span>
<span class="comment-copy">@Codevan - sure, give em a sec.</span>
<span class="comment-copy">'value':df_train.iloc[i,c] for the resulted df would help</span>
<div class="post-text" itemprop="text">
<p>I'm trying to set in-memory database for testing with peewee. However, I cannot initialize database:</p>
<pre><code>&gt;&gt;&gt; import peewee
&gt;&gt;&gt; import Entities
&gt;&gt;&gt; db = peewee.SqliteDatabase(':memory:')
&gt;&gt;&gt; db.connect()
True
</code></pre>
<p>This above is okay. Then I got following error:</p>
<pre><code>&gt;&gt;&gt; db.bind(Entities.RouterSettings)
Traceback (most recent call last):
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2833, in execute_sql
    cursor = self.cursor(commit)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2819, in cursor
    self.connect()
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2768, in connect
    raise InterfaceError('Error, database must be initialized '
peewee.InterfaceError: Error, database must be initialized before opening a connection.
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "&lt;input&gt;", line 1, in &lt;module&gt;
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 3008, in bind
    for model in models:
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 5630, in __iter__
    return iter(self.select())
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 6198, in __iter__
    self.execute()
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 1698, in inner
    return method(self, database, *args, **kwargs)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 1769, in execute
    return self._execute(database)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 1943, in _execute
    cursor = database.execute(self)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2848, in execute
    return self.execute_sql(sql, params, commit=commit)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2842, in execute_sql
    self.commit()
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2627, in __exit__
    reraise(new_type, new_type(*exc_args), traceback)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 178, in reraise
    raise value.with_traceback(tb)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2833, in execute_sql
    cursor = self.cursor(commit)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2819, in cursor
    self.connect()
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2768, in connect
    raise InterfaceError('Error, database must be initialized '
peewee.InterfaceError: Error, database must be initialized before opening a connection.
</code></pre>
<p>Me entities are all right for sure, since I use peewee for managing data in sqlite database without troubles. They came when I made a try to create tests with in-memory database. The same error happens when I try to create tables:</p>
<pre><code>&gt;&gt;&gt; db = peewee.SqliteDatabase(':memory:')
&gt;&gt;&gt; db.connect()
True
&gt;&gt;&gt; db.create_tables([Entities.RouterSettings], safe=True)
Traceback (most recent call last):
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2833, in execute_sql
    cursor = self.cursor(commit)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2819, in cursor
    self.connect()
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2768, in connect
    raise InterfaceError('Error, database must be initialized '
peewee.InterfaceError: Error, database must be initialized before opening a connection.
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "&lt;input&gt;", line 1, in &lt;module&gt;
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2995, in create_tables
    model.create_table(**options)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 6012, in create_table
    cls._schema.create_all(safe, **options)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 5225, in create_all
    self.create_table(safe, **table_options)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 5111, in create_table
    self.database.execute(self._create_table(safe=safe, **options))
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2848, in execute
    return self.execute_sql(sql, params, commit=commit)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2842, in execute_sql
    self.commit()
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2627, in __exit__
    reraise(new_type, new_type(*exc_args), traceback)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 178, in reraise
    raise value.with_traceback(tb)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2833, in execute_sql
    cursor = self.cursor(commit)
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2819, in cursor
    self.connect()
  File "C:\Users\Kamil\AppData\Local\Programs\Python\Python37-32\lib\site-packages\peewee.py", line 2768, in connect
    raise InterfaceError('Error, database must be initialized '
peewee.InterfaceError: Error, database must be initialized before opening a connection.
</code></pre>
<p>I'm using:</p>
<ul>
<li>Python 3.7.1</li>
<li>Peewee 3.9.2</li>
</ul>
<p>Anybody faced similar problem?</p>
</div>
<div class="post-text" itemprop="text">
<p>I found the reason of the error. It looks I forgot to put <code>foreign_key</code> pragma:</p>
<pre><code>&gt;&gt;&gt; import peewee
&gt;&gt;&gt; test_db = peewee.SqliteDatabase(':memory:', pragmas={'foreign_keys': 1})
import Entities
&gt;&gt;&gt; models = [Entities.RouterSettings]
&gt;&gt;&gt; test_db.bind(models, bind_refs=False, bind_backrefs=False)
&gt;&gt;&gt; test_db.connect()
True
&gt;&gt;&gt; test_db.create_tables(models)
</code></pre>
<p>When I put <code>pragmas={'foreign_keys': 1}</code>, which is what my entity requires, this error disappears.</p>
</div>
<div class="post-text" itemprop="text">
<p>I have a 'WedDriverWait' for a presence of element which works fine if the page loads correctly but occasionally the page doesn't load (I just get a blank page) and then the 'wait' is about 5 mins rather then the 45secs I have it set to. </p>
<p>The code:</p>
<pre><code>import selenium  
import random  
from selenium import webdriver  
from selenium.webdriver.common.by import By  
from selenium.webdriver.support.ui import WebDriverWait  
from selenium.webdriver.support import expected_conditions as EC  
import time  
import pyautogui  
driver = webdriver.Chrome()  
driver.get('some webpage')  
WebDriverWait(driver, 20).until(EC.presence_of_element_located((By.CSS_SELECTOR,'body &gt; div.content.login &gt; div.wrap &gt; div')))  
elem2 = driver.find_element_by_id ('data_body')  
compa = elem2.text  
if compa:  
    name()  
    click()  
    time.sleep(8)  
    driver.switch_to_window(driver.window_handles[1])  
    try:  
        WebDriverWait(driver, 45).until(EC.presence_of_element_located((By.CSS_SELECTOR,'something')))  
        login()                          
    except Exception:  
        closing_page()
else:  
    moveon()
</code></pre>
</div>
<span class="comment-copy">Where is your code?</span>
<span class="comment-copy">It could be that there is another - global - WAIT set up somewhere else in your code, that is 5 mins long.</span>
<span class="comment-copy">There are some other waits that are not tied to this one, but they are all set to 45secs anyway.</span>
<span class="comment-copy">Post your full code.</span>
<div class="post-text" itemprop="text">
<p>I'm trying to run a <code>WALSModel</code> (see <a href="https://colab.research.google.com/drive/1oJDfvIWnf7sY5uFcJ7XhTSEdA1n_3Jxv" rel="nofollow noreferrer">colab</a>) locally. </p>
<p>Regardless of the system on which I try to run, I always encounter allocation errors; namely that it exceeds 10% of system memory.</p>
<p>I have tried on a modest system with 8GB ram and <code>4GiB</code> on the GPU (says its needs <code>4.5GiB</code> to allocate). I then tried on a system with 16GB ram and <code>8GiB</code> on a 1070 GPU and it says it needs to allocate <code>9.1GiB</code> memory. I am now trying on a system with 100GiB ram and <code>16GiB</code> on the GPU, and it says it needs <code>17 GiB</code>. </p>
<p>The model will run on CPU despite the warning because it does not actually need this much (more on that in a moment). However when using a GPU it will throw an error killing the process.</p>
<p>What am I doing wrong? (see <a href="https://colab.research.google.com/drive/1oJDfvIWnf7sY5uFcJ7XhTSEdA1n_3Jxv" rel="nofollow noreferrer">colab</a> for all code necessary to run).</p>
<p>The data, on disk, is less than <code>2GiB</code>. So I do not understand why it always says it needs at least 10% more than what is available. Especially as when running on the GPU it says it tried to allocate 4.5, 9.1 and 17 GiB, and then when I run on 8, 16, 100 GiB ram, I still get the warning that allocation exceeds more than 10% of system memory</p>
<h3>Hardward Specs</h3>

CPU

<pre class="lang-sh prettyprint-override"><code>free -m
              total        used        free      shared  buff/cache   available
Mem:          95325       36405       30328         283       28591       57339
Swap:         96933         101       96832
</code></pre>

GPU

<pre class="lang-sh prettyprint-override"><code>name: Quadro GP100 major: 6 minor: 0 memoryClockRate(GHz): 1.4425
pciBusID: 0000:af:00.0
totalMemory: 15.90GiB freeMemory: 14.75GiB
</code></pre>
<h3>Data details</h3>
<pre class="lang-py prettyprint-override"><code>shape = (210000, 44000)
</code></pre>
<pre class="lang-sh prettyprint-override"><code># SciPy coordinate form file on disk
1.903 GiB
</code></pre>
<h3>Log Details</h3>

Run on GPU

<pre class="lang-sh prettyprint-override"><code>Allocator (GPU_0_bfc) ran out of memory trying to allocate 17.32GiB.  Current allocation summary follows.
</code></pre>

Run on CPU

<pre class="lang-sh prettyprint-override"><code>W tensorflow/core/framework/allocator.cc:108] Allocation of 18599850000 exceeds 10% of system memory.
</code></pre>
</div>
<span class="comment-copy">Is it possible there's a memory leak? That looks to me like it's just consuming as much memory as possible until memory allocation creates an error - which can only happen once the requested amount is greater than that which is available, so it would <i>always</i> appear to be somewhat above the available memory.</span>
<span class="comment-copy">@Avery it is possible, but I doubt it. In the code you can see I am manually calling garbage collection to ensure that it doesnt and the code does run for smaller matrices without a problem (and printing out resources shows that it doesnt grow). So I think that this matrix is just large enough that maybe it triggers some bug during allocation.</span>
<span class="comment-copy">Manually calling GC doesn't help if there are too many references being held - they will always appear to be active and not ready for GC. If you can run smaller data sets though, maybe you can try to calculate how the memory needs scale with data size and estimate what your usage "should" be?</span>
<span class="comment-copy">@Avery, well in the code in the linked colab I have the SciPy <code>sp.sparse.coo_matrix</code>, the <code>tf.SparseTensor</code> and the <code>WALSModel</code>. Since the dense file is ~2GiB, and the <code>WALSModel</code> results in two smaller matrices <code>n x k</code> and <code>k x m</code>, where <code>k &lt;&lt; n &amp;&amp; k &lt;&lt; m</code> I would hope that the upper bound on memory usage would be <code>6GiB</code></span>
<span class="comment-copy">@Avery in addition I call <code>resource.getrusage(resource.RUSAGE_SELF).ru_maxrss</code> which on CPU returns <code>14386424</code>. To my understanding this is kilobytes on Linux systems. So this "max" model is <code>~14.4GiB</code> at <i>peak</i> usage. So the Quadro with <code>freeMemory: 14.75GiB</code> should be enough...</span>
<div class="post-text" itemprop="text">
<p>I had a issue solving the below problem, please check the the below code.</p>
<pre><code>filenamee5 = 'ABC'
counter1 = 1
counter2 = 2          
list1 = []
list2 = range(1000)
for x in list2:
    counter1 = str(counter1)
    full_name5 = (filenamee5 + counter1)
    list1.append(full_name5)
    counter1 = counter2
    counter2 += 1
    numbers_list = []
    level1 = []
    for x in list1:
        numbers_list.append(x)
        ListsOfAll = numbers_list[1:1000]
        for x1 in range(1, len(ListsOfAll), 4):
            level1.append(list(numbers_list[x1:x1 + 4]))
            l1 = level1[0]
            l2 = level1[1:5]
            l3 = level1[5:21]
            l4 = level1[21:85]
            l5 = level1[85:341]
            l6 = level1[341:1365]
            ll2 = []
            for i in range(len(l2)):
                aaa = l1[i], l2[i]
                ll2.append(aaa)
                print(ll2)
                print("the length is:",len(ll2))
</code></pre>
<p>My actual output for only first and second list:</p>
<pre><code>[('ABC2', ['ABC6', 'ABC7', 'ABC8', 'ABC9']),

 ('ABC3', ['ABC10', 'ABC11', 'ABC12', 'ABC13']),

 ('ABC4', ['ABC14', 'ABC15', 'ABC16', 'ABC17']), 

 ('ABC5', ['ABC18', 'ABC19', 'ABC20', 'ABC21'])]

the length is: 4
</code></pre>
<p>Here each list item should contain four items in below list i.e. in the ratio 1:4 group.</p>
<p>Please see the example below to understand my problem:</p>
<pre><code>List1 = ['A','B','C','D']

List2=['E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T']

List3 = ['A',['E','F','G','H'],'B',['I','J','K','L'],'C',['M','N','O','P'],'D',['Q','R','S','T']]
</code></pre>
<p>Kindly please help me with your suggestions, will be appreciated!</p>
</div>
<div class="post-text" itemprop="text">
<p>I have not the slightest idea why you need this (and I dare to guess that this <em>might</em> be another case of the <a href="https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem[xy%20problem]">xy problem</a>...) and I have to state that it's a little odd to add <em>different</em> sample data sets for one problem into one post... However - perhaps you can use this one:<br/>
(I called it "quadratic chaining", because <code>mapping</code> is sth different...)</p>
<p><strong>solution function:</strong></p>
<pre><code>def quadraticChaining(somelists):
    out = []
    for i, e in enumerate(somelists[0]):
        out.append(e)
        for p, sub in enumerate(somelists[1:]):
            L = 4**(p+1)
            out.append(sub[i*L:(i+1)*L])
    return out
</code></pre>
<p>...or if you don't need the whole thing in memory but just want to iterate over it<br/>
<strong>as a generator:</strong></p>
<pre><code>def quadraticChaining(somelists):
    for i, e in enumerate(somelists[0]):
        yield e
        for p, sub in enumerate(somelists[1:]):
            L = 4**(p+1)
            yield sub[i*L:(i+1)*L]
</code></pre>
<hr/>
<p><strong>sample data:</strong></p>
<pre><code>list1 = ['A'+str(i) for i in range(4)]
list2 = ['B'+str(i) for i in range(4**2)]
list3 = ['C'+str(i) for i in range(4**3)]
list4 = ['D'+str(i) for i in range(4**4)]
list5 = ['E'+str(i) for i in range(4**5)]
list6 = ['F'+str(i) for i in range(4**6)]
</code></pre>
<p><strong>function example:</strong></p>
<pre><code>quadraticChaining([list1, list2])

# ['A0',
#  ['B0', 'B1', 'B2', 'B3'],
#  'A1',
#  ['B4', 'B5', 'B6', 'B7'],
#  'A2',
#  ['B8', 'B9', 'B10', 'B11'],
#  'A3',
#  ['B12', 'B13', 'B14', 'B15']]
</code></pre>
<p>or</p>
<pre><code>quadraticChaining([list1, list2, list3])

# ['A0',
#  ['B0', 'B1', 'B2', 'B3'],
#  ['C0',
#   'C1',
#   'C2',
#   'C3',
#   'C4',
#   'C5',
#   'C6',
#   'C7',
#   'C8',
#   'C9',
#   'C10',
#   'C11',
#   'C12',
#   'C13',
#   'C14',
#   'C15'],
#  'A1',
#  ['B4', 'B5', 'B6', 'B7'],
#  ['C16',
#   'C17',
#   'C18',
#   'C19',
#   'C20',
#   'C21',
#   'C22',
#   'C23',
#   'C24',
#   'C25',
#   'C26',
#   'C27',
#   'C28',
#   'C29',
#   'C30',
#   'C31'],
#  'A2',
#  ['B8', 'B9', 'B10', 'B11'],
#  ['C32',
#   'C33',
#   'C34',
#   'C35',
#   'C36',
#   'C37',
#   'C38',
#   'C39',
#   'C40',
#   'C41',
#   'C42',
#   'C43',
#   'C44',
#   'C45',
#   'C46',
#   'C47'],
#  'A3',
#  ['B12', 'B13', 'B14', 'B15'],
#  ['C48',
#   'C49',
#   'C50',
#   'C51',
#   'C52',
#   'C53',
#   'C54',
#   'C55',
#   'C56',
#   'C57',
#   'C58',
#   'C59',
#   'C60',
#   'C61',
#   'C62',
#   'C63']]
</code></pre>
<p><strong>generator example:</strong></p>
<pre><code>L = quadraticChaining([list1, list2, list3])
# &lt;generator object quadraticChaining at 0x0000000009993B88&gt;

next(L)
# 'A0'

next(L)
# ['B0', 'B1', 'B2', 'B3']

next(L)
# ['C0',
#  'C1',
#  'C2',
#  'C3',
#  'C4',
#  'C5',
#  'C6',
#  'C7',
#  'C8',
#  'C9',
#  'C10',
#  'C11',
#  'C12',
#  'C13',
#  'C14',
#  'C15']

next(L)
# 'A1'

...
</code></pre>
</div>
<span class="comment-copy">What is your issue? Do you have any error? Could you describe your problem? It's hard to figure it out from this code and examples (at least describe what is your input/output)</span>
<span class="comment-copy">Don't paste your output as images. It's better to copy/paste it to your answer. It will be easier to find it through search engine.</span>
<span class="comment-copy">yes . i have defined lists where list1 has 4 items, list2 has 16 items and so on upto 4096 items in list 6..but i need an execution result like for each item in list1 has to map 4 consecutive items from list2 so that for each list has to get 4 equal chunks items any items for any list below that.</span>
<span class="comment-copy">the overall picture is like an tree structure , one below four , one below four ...so on !</span>
<span class="comment-copy">But <code>List3</code> contains 8 elements (or 20 depends how you count), not 64.</span>
<div class="post-text" itemprop="text">
<p>I'm trying to load in data for a school project on Tensorflow/Keras.</p>
<pre><code>import numpy as np
import matplotlib.pyplot as plt
import os
import cv2
import json

DATADIR = (r"C:\Users\ellio\Anaconda Lessons &amp; Quizzes\Competition\Images")
with open('categories.json') as json_file:  
    categories = json.load(json_file)

for category in categories:
    path=os.path.join(DATADIR,category)
    for img in os.listdir(path):
        img_array=cv2.imread(os.path.join(path,img),cv2.IMREAD_GRAYSCALE)
        plt.imshow(img_array,cmap='gray')
        plt.show()
        break
break

training_data = []

def create_training_data(): 
    for category in categories:
        path=os.path.join(DATADIR,category)
        class_num=categories.index(category)
        for img in os.listdir(path):
            try:
                img_array=cv2.imread(os.path.join(path,img),cv2.IMREAD_GRAYSCALE)
                new_array=cv2.resize(img_array,(IMG_SIZE,IMG_SIZE))
                training_data.append([new_array,class_num])
            except Exception as e:
                pass

create_training_data()
</code></pre>
<p>When I enter the code, the error is <code>'dict' object has no attribute 'index'</code> </p>
<p>I reckon this has something to do with my json file on the categories. Below are are the categories from the json file. Is something to do with it being a dictionary instead of a list?</p>
<pre><code>{'Mobile': {'Others Mobile &amp; Tablet': 35, 'Smartfren': 53, 'Infinix': 40, 'Brandcode': 39, 'Icherry': 52, 'Advan': 45, 'Iphone': 31, 'Realme': 51, 'Motorola': 49, 'Maxtron': 56, 'Nokia': 38, 'Xiaomi': 34, 'Mito': 46, 'Sony': 33, 'SPC': 57, 'Lenovo': 37, 'Alcatel': 55, 'Samsung': 32, 'Vivo': 42, 'Evercoss': 44, 'Strawberry': 50, 'Blackberry': 36, 'Asus': 43, 'Honor': 54, 'Oppo': 41, 'Huawei': 47, 'Sharp': 48}, 'Fashion': {'Wedding Dress': 23, 'Shirt': 27, 'Casual Dress': 18, 'Maxi Dress': 20, 'Big Size Dress': 24, 'Bodycon Dress': 22, 'Party Dress': 19, 'Blouse\xa0': 26, 'Tshirt': 25, 'Crop Top ': 29, 'Tanktop': 28, 'Others': 17, 'A Line Dress': 21, 'Big Size Top': 30}, 'Beauty': {'Foundation': 1, 'Face Palette': 0, 'Concealer': 7, 'Lip Gloss': 14, 'Blush On': 2, 'Highlighter': 8, 'BB &amp; CC Cream': 5, 'Other Face Cosmetics': 4, 'Lip Tint': 13, 'Bronzer': 11, 'Lip Liner': 15, 'Powder': 3, 'Setting Spray': 10, 'Primer': 9, 'Contour': 6, 'Other Lip Cosmetics': 16, 'Lipstick': 12}}
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Hey first of all I would avoid having spaces in directories.</p>
<pre><code>DATADIR = (r"C:\Users\ellio\Anaconda Lessons &amp; Quizzes\Competition\Images")
</code></pre>
<p>Also, in python, the value of a dictionary object is based off a key rather than an index therefore it should be:</p>
<pre><code>class_num=categories.get(category)
</code></pre>
<p>or</p>
<pre><code>class_num=categories[category]
</code></pre>
<p>check here for more: <a href="https://docs.python.org/2/tutorial/datastructures.html#dictionaries" rel="nofollow noreferrer">https://docs.python.org/2/tutorial/datastructures.html#dictionaries</a></p>
</div>
<div class="post-text" itemprop="text">
<p>In your case (nested json structure), without flattening your json you would not get what you want.</p>
<p>You should flatten dictionary at first by creating a function:</p>
<pre><code>def flatten(d):
    if not isinstance(d, dict):
        return d
    flattened = dict()
    for k in d:
        if isinstance(d[k], dict):
            flattened = {**flattened, **flatten(d[k])}
        else:
            flattened[k] = d[k]
    return flattened
</code></pre>
<p>And add this line after your <code>json.load</code> line:</p>
<pre><code>categories = flatten(categories)
</code></pre>
<p>Finally you will get your <code>class_num</code> in your <code>for</code> loop by:</p>
<pre><code>class_num = categories[category]
</code></pre>
</div>
<span class="comment-copy">Have you tried changing "index" to "get" ?</span>
<div class="post-text" itemprop="text">
<p>I am trying to find url's that I can't reach from a list of urls. The code is below:</p>
<pre><code>def sanity(url,errors):
    global count
    count+=1
    if count%1000==0:
       print(count)
    try:
       if 'media' in url[:10]:
           url = "http://edoola.s3.amazonaws.com" + url
       headers={'User-Agent': "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.84 Safari/537.36",
    }
       req=urllib.request.Request(url,headers=headers)
       ret = urllib.request.urlopen(req)
       return 1
    except:
       print(e, url)
       errors.append(url)
       return 0

limit=1000
count=0
errors = []
with open('file.csv','r',encoding="utf-8") as file:
      text = file.read()
      text = str(text)
      urls = re.findall(r'&lt;img.*?src=""(.*?)""[\s&gt;]', text, flags=re.DOTALL)

arr = list(range(0,len(urls)+1,limit))
start=0
for i in arr:
    threads = [threading.Thread(target=sanity, args=(url, errors,)) for url in urls[start:i]]
    [thread.start() for thread in threads]
    [thread.join() for thread in threads]
    if i==0:
       start=0
    else:
       start=i+1

print(errors)
with open('errors_urls.txt','w') as file:
     file.write('\n'.join(errors))
</code></pre>
<p>The code runs for 1000 properly but in the next thousand prints url's that are reachable from my chrome browser. I have looked into <a href="https://stackoverflow.com/a/40984579/5658251">this</a>, and <a href="https://docs.python.org/3.4/howto/urllib2.html" rel="nofollow noreferrer">others</a>. I have tried these approaches in ipython terminal choosing a particular url and it worked fine. But when I put the same approach on the above code. I get reachable url's.  How do I solve this?</p>
<p>The number of urls is 15000 approx. So, in the code above I'm running in chunks of 1000, accordingly spawning 1000 threads.</p>
<p>Any help is appreciated!!</p>
</div>
<span class="comment-copy">Please <a href="https://stackoverflow.com/posts/55257514/edit">edit</a> your question to fix the obvious indentation errors.</span>
<span class="comment-copy">Are you being rate limited?</span>
<span class="comment-copy">@tripleee I have fixed the indentation errors.</span>
<span class="comment-copy">@DanielRoseman I did not understand rate limited!! I am basically processing the urls in chunks of 1000(limit).</span>
<span class="comment-copy">Rate limiting means your server, or one you are connecting to frequently, thinks you are using the network too much, and starts returning errors to defend against your attack.</span>
<div class="post-text" itemprop="text">
<p>I'm working with multiple JSON objects where they are converted to nested dictionaries in which the last dictionary is extracted (as shown in "Data" segment). I want to extract all values of "Tags" into a list. WHile I'm trying to do this, I'm getting the output followed by an error.</p>
<p>Code:</p>
<pre><code>import json

with open('console_data.json', 'r') as console_data:
    parsed_data = console_data.read()
    nodes = json.loads(parsed_data)

last_node = nodes[-1]                   # extract last dictionary

print("\n\n\n")
for item in last_node:
    tags = last_node[item].get("Tags", {})
    try:
        print(tags)
    except AttributeError:
        pass
</code></pre>
<p>Data:</p>
<pre><code>  {
    "Node": {
      "ID": "1a2b78dc-078d-cfe2-6c55-189aa2c67d29",
      "Node": "NAVIAPP05",
      "Address": "10.2.2.5",
      "Datacenter": "naviprod",
      "TaggedAddresses": {
        "lan": "10.2.2.5",
        "wan": "10.2.2.5"
      },
      "Meta": {
        "consul-network-segment": ""
      },
      "CreateIndex": 5171424,
      "ModifyIndex": 5453151
    },
    "Service": {
      "ID": "sim-work102235-10185",
      "Service": "sim",
      "Tags": [
        "fc216ed1-ef55-4064-b25d-de37ac612984",
        "2a82837f-1867-4b59-ab21-72331b75f4c2",
        "732b3fc1-687b-42ac-b71f-d755fe90de04",
        "d85d8902-8c36-4591-8f39-b4d8528301ce",
        "d5d695a6-710f-4edc-ae03-47ee034137a4",
        "62002f4a-4029-4f4f-a9d0-6b0fc2f34951",
        "459cc8e3-fc44-43ce-9d7f-dfa3fe92665e"
      ],
      "Address": "10.2.2.35",
      "Meta": {
        "apiContext": "/sim/sim.do",
        "defaultContext": "/sim",
        "workflowContext": "/sim/services",
        "zspContext": "/sim/services",
        "zspProductURL": "https://sim.abcde.com/sim/"
      },
      "Port": 10185,
      "EnableTagOverride": false,
      "CreateIndex": 7327367,
      "ModifyIndex": 7327367
    },
    "Checks": [
      {
        "Node": "NAVIAPP05",
        "CheckID": "serfHealth",
        "Name": "Serf Health Status",
        "Status": "passing",
        "Notes": "",
        "Output": "Agent alive and reachable",
        "ServiceID": "",
        "ServiceName": "",
        "ServiceTags": [],
        "Definition": {},
        "CreateIndex": 5171424,
        "ModifyIndex": 5171424
      }
    ]
  }
</code></pre>
<p>Output:</p>
<pre><code>{}
['fc216ed1-ef55-4064-b25d-de37ac612984', '2a82837f-1867-4b59-ab21-72331b75f4c2', '732b3fc1-687b-42ac-b71f-d755fe90de04', 'd85d8902-8c36-4591-8f39-b4d8528301ce', 'd5d695a6-710f-4edc-ae03-47ee034137a4', '62002f4a-4029-4f4f-a9d0-6b0fc2f34951', '459cc8e3-fc44-43ce-9d7f-dfa3fe92665e']
Traceback (most recent call last):
  File "so_parse_json.py", line 12, in &lt;module&gt;
    tags = last_dict[item].get("Tags", {})
AttributeError: 'list' object has no attribute 'get'
</code></pre>
<p>Expected Output:</p>
<pre><code>['fc216ed1-ef55-4064-b25d-de37ac612984', '2a82837f-1867-4b59-ab21-72331b75f4c2', '732b3fc1-687b-42ac-b71f-d755fe90de04', 'd85d8902-8c36-4591-8f39-b4d8528301ce', 'd5d695a6-710f-4edc-ae03-47ee034137a4', '62002f4a-4029-4f4f-a9d0-6b0fc2f34951', '459cc8e3-fc44-43ce-9d7f-dfa3fe92665e']
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Assuming that Data you enclosed is from <code>last_node</code>, why not just use:</p>
<p><code>last_node['Service']['Tags']</code></p>
<p>This outputs:</p>
<pre><code>['fc216ed1-ef55-4064-b25d-de37ac612984',
 '2a82837f-1867-4b59-ab21-72331b75f4c2',
 '732b3fc1-687b-42ac-b71f-d755fe90de04',
 'd85d8902-8c36-4591-8f39-b4d8528301ce',
 'd5d695a6-710f-4edc-ae03-47ee034137a4',
 '62002f4a-4029-4f4f-a9d0-6b0fc2f34951',
 '459cc8e3-fc44-43ce-9d7f-dfa3fe92665e']
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I don't know what's in your <code>console_data.json</code>. This code works on <code>Data</code> above.</p>
<pre class="lang-py prettyprint-override"><code>import json
with open('Data.json','r') as f:
    data = f.read()
    nodes = json.loads(data)

tags = nodes['Service']['Tags']
print(tags)
</code></pre>
</div>
<span class="comment-copy">I've had a look at related questions, but unable to solve this.</span>
<div class="post-text" itemprop="text">
<p>I want to send an api request in this form:</p>
<pre><code>         "line_items": [
        {

            "account_id": "1717893000000067010",
            "debit_or_credit": "debit",
            "amount": 400,
            "tags": [
                {
                    "tag_option_id": "1717893000000115007",
                    "tag_id": "1717893000000000333"
                },
                {
                    "tag_option_id": "1717893000000123007",
                    "tag_id": "1717893000000000335"
                },
                {
                    "tag_option_id": "1717893000000126003",
                    "tag_id": "1717893000000000337"
                }
            ]
</code></pre>
<p>The above JSON may have hundreds of (line_items) and each (tags) in it may have different number of dictionaries.</p>
<p>what I did in python is:</p>
<pre><code>          accounts = []
          tags = []
          for line in payroll.line_ids:

            ######## code missing some correction for tags

            if len(line.x_zoho_jtag) == 0:
               the_tags = {"tag_id": " ", "tag_option_id": " "}
               tags.append(the_tags)


            for tag in line.x_zoho_jtag:
                for option in line.x_zoho_jtag_option:
                    if option.tag_ids == tag.tag_id:
                      the_tags = {"tag_id": tag.tag_id, "tag_option_id": option.option_tag_id}
                      tags.append(the_tags)

              ########

            if line.debit != 0.0:
               credit = {"amount": line.debit,"account_id": line.x_zoho_account_no,"debit_or_credit": "debit", "tags": tags}
               accounts.append(credit)
               print(credit)
            else:
                debit = {"amount": line.credit, "account_id": line.x_zoho_account_no,"debit_or_credit": "credit", "tags": tags}
                accounts.append(debit)
                print(debit)
          print(accounts)
</code></pre>
<p>As you can see in the above python code, I have 2 list (accounts and tags). I store (account_id, debit_or_credit, amount) in (accounts) list and it works fine.   </p>
<pre><code>  if line.debit != 0.0:
           credit = {"amount": line.debit,"account_id": line.x_zoho_account_no,"debit_or_credit": "debit", "tags": tags}
           accounts.append(credit)
           print(credit)
        else:
            debit = {"amount": line.credit, "account_id": line.x_zoho_account_no,"debit_or_credit": "credit", "tags": tags}
            accounts.append(debit)
            print(debit)
</code></pre>
<p>Along with that I have added (tags) key and (tags) list as you can see in the above line. </p>
<p>The problem that I am facing is in the (tags) key where I need to pass multiple block of dictionaries inside a list. So How to do that? </p>
<p>expected output:</p>
<pre><code>  "line_items": [       
          {
"account_id": "1717893000000067010",
"debit_or_credit": "debit",
"amount": 400,
"tags": [
  {
    "tag_option_id": " ",
    "tag_id": " "
  },
  {
    "tag_option_id": "1717893000000126003",
    "tag_id": "1717893000000000337"
  },
  {
    "tag_option_id": "1717893000000123007",
    "tag_id": "1717893000000000335"
  }


   "line_items": [
       {
"account_id": "1717893000000067036",
"debit_or_credit": "credit",
 "amount": 400,
"tags": [
  {
    "tag_option_id": "1717893000000126003",
    "tag_id": "1717893000000000337"
  }
</code></pre>
<p>wrong output:</p>
<pre><code>            {
"account_id": "1717893000000067010",
"debit_or_credit": "debit",
"amount": 400,
"tags": [
  {
    "tag_option_id": " ",
    "tag_id": " "
  },
  {
    "tag_option_id": "1717893000000126003",
    "tag_id": "1717893000000000337"
  },
  {
    "tag_option_id": "1717893000000123007",
    "tag_id": "1717893000000000335"
  }


      {
"account_id": "1717893000000067036",
"debit_or_credit": "credit",
 "amount": 400,
"tags": [
  {
    "tag_option_id": " ",
    "tag_id": " "
  },
  {
    "tag_option_id": "1717893000000126003",
    "tag_id": "1717893000000000337"
  },
  {
    "tag_option_id": "1717893000000123007",
    "tag_id": "1717893000000000335"
  }
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The issue here is that when you are looping through the tags you are not differentiating between the ones that should go on the <code>credit</code> and the ones that should go on the <code>debit</code>.<br/>
What you need to do is get the line first and then get the associated tags for that line.<br/>
Below should work, I think, but has a bit of repetition so could be improved further.   </p>
<pre class="lang-py prettyprint-override"><code>    accounts = []
    for line in payroll.line_ids:
        if line.debit != 0.0:
            credit = {
                "amount": line.debit,
                "account_id": line.x_zoho_account_no,
                "debit_or_credit": "debit", 
                "tags": []
            }
            if len(line.x_zoho_jtag) == 0:
                credit["tags"].append({"tag_id": " ", "tag_option_id": " "})
            else:
                for tag in line.x_zoho_jtag:
                    for option in line.x_zoho_jtag_option:
                        if option.tag_ids == tag.tag_id:
                          credit["tags"].append({"tag_id": tag.tag_id, 
                                                 "tag_option_id": option.option_tag_id})
            accounts.append(credit)
            print(credit)
        else:
            debit = {
                "amount": line.credit, 
                "account_id": line.x_zoho_account_no,
                "debit_or_credit": "credit", 
                "tags": []
            }
            if len(line.x_zoho_jtag) == 0:
                debit["tags"].append({"tag_id": " ", "tag_option_id": " "})
            else:
                for tag in line.x_zoho_jtag:
                    for option in line.x_zoho_jtag_option:
                        if option.tag_ids == tag.tag_id:
                          debit["tags"].append({"tag_id": tag.tag_id, 
                                                "tag_option_id": option.option_tag_id})

            accounts.append(debit)
            print(debit)
</code></pre>
<h3>Refactored Further</h3>
<p>Moving repetitive code block into a function</p>
<pre class="lang-py prettyprint-override"><code>accounts = []
for line in payroll.line_ids:
    if line.debit != 0.0:
        credit = create_account("credit", line)
        accounts.append(credit)
        print(credit)
    else:
        debit = create_account("debit", line)
        accounts.append(debit)
        print(debit)


def create_account(account_type, line):
    if account_type == "credit":
        amount = line.debit
        d_or_c = "debit"
    else: 
        amount = line.credit
        d_or_c = "credit"

    account = {
        "amount": amount,
        "account_id": line.x_zoho_account_no,
        "debit_or_credit": d_or_c, 
        "tags": []
    }
    if len(line.x_zoho_jtag) == 0:
        account["tags"].append({"tag_id": " ", "tag_option_id": " "})
    else:
        for tag in line.x_zoho_jtag:
            for option in line.x_zoho_jtag_option:
                if option.tag_ids == tag.tag_id:
                  account["tags"].append({"tag_id": tag.tag_id, 
                                         "tag_option_id": option.option_tag_id})
    return account
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I guess I see you... soo... move the tags = [] inside the top level for loop. </p>
</div>
<span class="comment-copy">Can you clarify what your problem is?</span>
<span class="comment-copy">The tags info  repeated for each tags in line_items where each one should be different</span>
<span class="comment-copy">Thank you so much , It works fine now .. appreciated</span>
<span class="comment-copy">No problem. Glad its working</span>
<span class="comment-copy">I dont think this answers the question asked, and it certainly doesnt make it easier to access either key or value.</span>
<span class="comment-copy">sorry, my colleagues are shouting around me and I just went through the post quickly...</span>
<span class="comment-copy">but I don't get it what is the problem, it seems to be fine.  you create a 'tags' list what stores a dictionary in each item.  and this 'tags' list will be the value of the 'tags' key, right? this is not working?</span>
<span class="comment-copy">I dont know. @Alqebaiti can you clarify the problem?</span>
<span class="comment-copy">and what do you want? can you paste the current output and the one what you want to achieve?</span>
<div class="post-text" itemprop="text">
<p>I want to get data from xml file in Flask and that data should display in html page. My file structure is as below.</p>
<p><a href="https://i.stack.imgur.com/3DHrx.png" rel="nofollow noreferrer">enter image description here</a>
 - Flask</p>
<pre><code>from flask import Flask
app = Flask(__name__)
@app.route('/')
</code></pre>
<ul>
<li>XML file</li>
</ul>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-html lang-html prettyprint-override"><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
     &lt;bookstore&gt;
     &lt;book category="COOKING"&gt;
     &lt;title lang="en"&gt;Everyday Italian&lt;/title&gt;
     &lt;author&gt;Giada De Laurentiis&lt;/author&gt;
     &lt;year&gt;2005&lt;/year&gt;
     &lt;price&gt;30.00&lt;/price&gt;
    &lt;/book&gt;
    &lt;/bookstore&gt;</code></pre>
</div>
</div>
</p>
<p>I want to get a data from xml file (category, title, author, year and price)</p>
<p>How can I get that data from xml file in flask?</p>
<p>Can someone give an answer with example how to get a data from xml file in flask.</p>
</div>
<span class="comment-copy">We need more info. Where is your xml file? What you need to do with it? Have you tried anything? If yes show us.</span>
<span class="comment-copy">You could add to the question how you would prefer to access your data e.g do you want to read them into variables in memory/query by XPath or the like.</span>
<div class="post-text" itemprop="text">
<p>I am newbie for python and had a task to send multiple email with relevant attachments.  I will eloborate it , A folder contains multiple pdf files each file contains some text including email id.I need to read the email id from the each pdf file and send the same file as the attachment to the mailid in the pdf file. below is the code for reference</p>
<pre><code># Get the count of files in the folder
import os
import re
global str
import smtplib
from email.mime.text import MIMEText
from email.mime.multipart import MIMEMultipart
from email.mime.base import MIMEBase

cpt = sum([len(files) for r, d, files in 
os.walk("D:\MyOfficeDocuments\ADCB\PythonScripts\PdfFiles")])

#Reading Mail from each pdf file and send the same file as attachment to 
these mails
import PyPDF2
from os import listdir
from os.path import isfile, join
from PyPDF2 import PdfFileWriter, PdfFileReader
mypath='D:\MyOfficeDocuments\ADCB\PythonScripts\PdfFiles'
onlyfiles = [f for f in listdir(mypath) if isfile(join(mypath, f))]
for file in onlyfiles:

count = 1
while count &lt;cpt:
    os.chdir(r'D:\MyOfficeDocuments\ADCB\PythonScripts\PdfFiles')
    pdfFileObj = open(file,'rb')
    pdfReader = PyPDF2.PdfFileReader(pdfFileObj)
    pageObj = pdfReader.getPage(0)
    count +=1
    text = pageObj.extractText()
    email_user='madhugut82@gmail.com'
    eline = re.findall('\S+@\S+.com', text)
    email_send=eline
    print(file)
    password='harshi54537'
    subject='Python !'
    msg=MIMEMultipart()
    msg['From']=email_user
    msg['To']=', '.join(email_send)
    #listalink = " ".join(listalink)
    msg['Subject']=subject
    #print (email_send)
    body='Hi there, sending this email from python using python scripting'
    msg.attach(MIMEText(body,'plain'))
    filename 
    ='D:\MyOfficeDocuments\ADCB\PythonScripts\Destination\Document.txt'
    attachment=open(file,'rb')
    #print(attachment)
    part=MIMEBase('application','pdf')
    part.set_payload(attachment.read())
    part.add_header('Content-Disposition',"attachement; filename="+file)
    msg.attach(part)
    #email.encoders.encode_base64(part)
    print('x')

    text=msg.as_string()

    #text=msg.encode("utf8")
    #text=msg.as_string().encode('utf-8','ignore')
    #text=msg.as_string().encode('ascii','ignore')
    server=smtplib.SMTP('smtp.gmail.com',587)
    server.starttls()
    server.login(email_user,password)
    server.sendmail(email_user,email_send,text)
    #server.sendmail(email_user,email_send,msg.encode("utf8"))
    server.quit()
</code></pre>
<p>As per the above code I am getting an error message shown in below</p>
<p>msg = _fix_eols(msg).encode('ascii')</p>
<p>UnicodeEncodeError: 'ascii' codec can't encode characters in position 559-562: ordinal not in range(128)</p>
<p>But if I change the code as below for </p>
<pre><code>text=ms.as_string().encode("UTF")
</code></pre>
<p>I am not getting any error but attachement is showing blank</p>
<p>Please suggest me where the exact issue is and what is the issue to getting blank pdf attachment.</p>
<p>I requesting you if there is any code suggestion then please suggest for pdf file only</p>
<p>Thanks in Advance
Madhu</p>
</div>
