<div class="post-text" itemprop="text">
<p>Here is my code:</p>
<pre><code>import mailbox
import pprint
mbox = mailbox.mbox('c:\documents and settings\student\desktop\mail\mailall.mbox')
for msg in mbox:
pprint.pprint(msg._headers)
</code></pre>
<p>This prints out hundreds of emails headers one after another. How can i write these results to a txt file?</p>
</div>
<div class="post-text" itemprop="text">
<p>Any of:</p>
<ol>
<li>Use the <code>stream</code> parameter of <a href="https://docs.python.org/3/library/pprint.html?highlight=pprint#pprint.pprint" rel="noreferrer"><code>pprint.pprint</code></a></li>
<li>Use <a href="https://docs.python.org/3/library/pprint.html?highlight=pprint#pprint.pformat" rel="noreferrer"><code>pprint.pformat</code></a> and separate write operation(s)</li>
<li>Redirect the program's output</li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p>You can use a file output stream.</p>
<pre><code>import mailbox
import pprint
f=open('./headersfile.txt', 'w+')
mbox = mailbox.mbox('c:\documents and settings\student\desktop\mail\mailall.mbox')
for msg in mbox:
    pprint.pprint(msg._headers, stream=f)
f.close()
</code></pre>
<p>Details here: <a href="https://docs.python.org/2/library/pprint.html#pprint.pprint" rel="nofollow">https://docs.python.org/2/library/pprint.html#pprint.pprint</a></p>
</div>
<span class="comment-copy">Ive done it. thanks for your help :)</span>
<span class="comment-copy">As always, I'd more appreciate you reward me with some rep by accepting the answer as a "thanks" :^)</span>
<span class="comment-copy">Its giving me an undefined error when i try and open the txt file. the path is correct?</span>
<span class="comment-copy">Hm... You are using Windows, right? Try to use just a file name ("headersfile.txt") or a full path to a file ('c:\documents and settings\student\desktop\headersfile.txt').</span>
