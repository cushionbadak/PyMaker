<div class="post-text" itemprop="text">
<p>I am sending the numerical field into for loop and calculating the max, min and percentile. I want to store each result (last print statement) into the csv file. I am literally struck here.</p>
<p>Each iteration in the for loop prints result like below:</p>
<pre class="lang-none prettyprint-override"><code>emp_id, 10, 23, 45.4
</code></pre>
<p>I want to save these results in a csv file.</p>
<pre><code>import pandas as pd
import numpy as np

data = pd.read_csv(r'C:\Users\spanda031\Downloads\test_19.csv')
#abc=data.dtypes
#print(abc)
df = data.select_dtypes(include='number')
cols = df.columns.values
print(cols)
arr = df.values
#print("new array ", arr)
#with open(r'C:\Users\spanda031\Downloads\test_19.csv') as f:
#    d_reader = csv.DictReader(f)

    #get fieldnames from DictReader object and store in list
#    headers = d_reader.fieldnames
#    print(headers)
for line in cols:
        #print value in MyCol1 for each row
        #print(line)        
        v3=np.array(data[line])
        #print(v3)        
        print(line,",",v3.min(),",",v3.max(),",",np.percentile(v3, 25))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This way i could resolve it.</p>
<pre><code>res_df=line,v3.min(),v3.max(),np.percentile(v3, 25),np.std(v3)      
    with open('C:\\Users\\spanda031\\Downloads\\abccc.csv', 'a', newline='') as csvfile:
        writerows = csv.writer(csvfile, delimiter=',',
                        quotechar='"', quoting=csv.QUOTE_MINIMAL)
        writerows.writerow(map(lambda x: x, res_df))
</code></pre>
</div>
<span class="comment-copy">You're probably looking for either the <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">csv module</a> or the numpy <a href="https://docs.scipy.org/doc/numpy-1.15.0/reference/generated/numpy.ndarray.tofile.html" rel="nofollow noreferrer">tofile</a> functionality</span>
<span class="comment-copy">You can use <code>python your_script.py &gt;&gt; your_file.csv</code> to append to an existing file.</span>
<span class="comment-copy">Actually i am going to run the python script as standalone resource and i will create hive table on top of that csv file</span>
