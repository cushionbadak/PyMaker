<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/2502833/store-output-of-subprocess-popen-call-in-a-string">Store output of subprocess.Popen call in a string</a>
<span class="question-originals-answer-count">
                    9 answers
                </span>
</li>
</ul>
</div>
<p>I've created and deployed a Flask App with Apache2 server WSGI in which now would like to run a .sh script from the App.  However, from calling from python code, it doesn't execute. </p>
<p>Here is the test.sh:</p>
<pre><code>#!/bin/bash
echo "hi from shell script"
</code></pre>
<p>Here is my python flask app code index.py (runs when App is opened) but nothing is printed or executed:</p>
<pre><code>import subprocess
subprocess.call('/var/www/FlaskApp/FlaskApp/scripts/test.sh')
</code></pre>
<p>To check that there is not errors in my code, I've check flask error logs, and no errors.  Also, I created a script called test_shell_script.py with same python code as above (but not flask app code) and it runs great like this:</p>
<pre><code># test_shell_script.py
import subprocess
subprocess.call('/var/www/FlaskApp/FlaskApp/scripts/test.sh')
</code></pre>
<p>And then run it with python:
    python3 /var/www/FlaskApp/FlaskApp/test_shell_script.py</p>
<pre><code>hi from shell script
</code></pre>
<p>I did change the permissions as well:</p>
<pre><code>-rwxr-xr-x 1 root root 364 Nov 19 17:48 ../scripts/test.sh
</code></pre>
<p>What am I missing here which is not allowing my Flask app to run shell commands from the python code?</p>
</div>
<div class="post-text" itemprop="text">
<p>To show command output inside Python, there are two popular methods:</p>
<ol>
<li><code>check_output()</code>: It runs command with arguments and return its output. <a href="https://docs.python.org/3/library/subprocess.html#subprocess.check_output" rel="nofollow noreferrer">(official documentation)</a></li>
<li><code>subprocess.communicate()</code>: Interact with process: Send data to stdin. Read data from stdout and stderr, until end-of-file is reached. <a href="https://docs.python.org/2.7/library/subprocess.html#subprocess.Popen.communicate" rel="nofollow noreferrer">(official documentation)</a></li>
</ol>
<p>I could view the shell file output using these both methods using <em>Python 3.5</em> in an <em>Ubuntu</em> machine.</p>
<p><code>app.py</code>:</p>
<pre><code>import subprocess
from subprocess import Popen, PIPE
from subprocess import check_output
from flask import Flask

def get_shell_script_output_using_communicate():
    session = subprocess.Popen(['./some.sh'], stdout=PIPE, stderr=PIPE)
    stdout, stderr = session.communicate()
    if stderr:
        raise Exception("Error "+str(stderr))
    return stdout.decode('utf-8')

def get_shell_script_output_using_check_output():
    stdout = check_output(['./some.sh']).decode('utf-8')
    return stdout

app = Flask(__name__)

@app.route('/',methods=['GET',])
def home():
    return '&lt;pre&gt;'+get_shell_script_output_using_check_output()+'&lt;/pre&gt;'

app.run(debug=True)
</code></pre>
<p><code>some.sh</code>:</p>
<pre><code>#!/bin/bash
echo "hi from shell script"
echo "hello from shell script"
</code></pre>
<p>Output screenshot:</p>
<p><a href="https://i.stack.imgur.com/bua21.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/bua21.png"/></a></p>
</div>
<span class="comment-copy">What kind of error do you get? This looks similar: <a href="https://stackoverflow.com/questions/4256107/running-bash-commands-in-python" title="running bash commands in python">stackoverflow.com/questions/4256107/â€¦</a>, can you try the <code>subprocess.Popen</code> suggestion?</span>
<span class="comment-copy">Receive no error.  I've tried subprocess.Popen and even os.system</span>
<span class="comment-copy">You gave permission to root for the file <code>run_sql.sh</code> but the file name you are trying to run is <code>test.sh</code></span>
<span class="comment-copy">@Seraf - sorry that was a typo, fixed it now</span>
<span class="comment-copy">Weird, the user that runs the Flask app is root? (Probably yes but still asking)</span>
