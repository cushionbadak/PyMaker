<div class="post-text" itemprop="text">
<p>I am using win32com to parse outlooks msg files on my hard drive.  Everything is working except the sent date.  I have the list of emails in a wxPython list box and when you click on an email I want to populate the date in a text box. When I try to convert the msg.SentOn from time type to string type I get a TypeError.  I believe it is looking for a timestamp and I am not sure how to get there from Pytime.</p>
<pre><code>def onListBox(self, event):

    attachList = []
    self.attachList.Clear()
    outlook = win32com.client.Dispatch("Outlook.Application").GetNamespace("MAPI")
    self.email = event.GetEventObject().GetStringSelection()
    if self.toFrom == 0:
        fileName = "C:\Users\onp1ldy\Desktop\EMAILS\emails_Sent\\" + self.email
    else:
        fileName = "C:\Users\onp1ldy\Desktop\EMAILS\emails\\" + self.email
    msg = outlook.OpenSharedItem(fileName)
    #print msg.SenderName
    #print msg.SenderEmailAddress
    print type(msg.SentOn)
    print msg.SentOn
    newDate = time.strftime('%m/%d/%Y %H:%M:%S', msg.SentOn)
    print newDate
</code></pre>
<p>Output:</p>
<pre><code>&lt;type 'time'&gt;
Traceback (most recent call last):
  File  line 181, in onListBox
12/04/17 20:43:49
    newDate = time.strftime('%m/%d/%Y %H:%M:%S', msg.SentOn)
TypeError: argument must be 9-item sequence, not time
</code></pre>
<p>Can someone help with this conversion?</p>
</div>
<div class="post-text" itemprop="text">
<p>After some searching I found <a href="http://timgolden.me.uk/pywin32-docs/PyTime.html" rel="nofollow noreferrer">Pytime</a>. This showed the conversion of pytime to an int that is compatible with the time module.</p>
<pre><code>time.strftime("%#c", time.localtime(int(timeObject)))
</code></pre>
</div>
<span class="comment-copy"><i>"I get a strange tuple"</i> but you did assign <code>newDate</code> to a tuple of <code>(time.strftime, msg.SentOn)</code>.  What did you expect? You probably meant to do this instead? <code>newDate = time.strftime('%m/%d/%Y %H:%M:%S', msg.SentOn)</code></span>
<span class="comment-copy">You are correct, I did mean to do that.  That was a copy paste issue that I missed. I updated the code with the new TypeError.</span>
<span class="comment-copy">If you're looking for the <code>str</code> of <code>msg.SentOn</code> in the same format, could you not just <code>newDate = str(msg.SentOn)</code>?</span>
<span class="comment-copy">Since <code>msg.SentOn</code> appears to be an instance of <a href="https://docs.python.org/3/library/datetime.html#time-objects" rel="nofollow noreferrer"><code>time</code></a>, I think you want <a href="https://docs.python.org/3/library/datetime.html#datetime.time.strftime" rel="nofollow noreferrer"><code>msg.SentOn.strftime('%m/%d/%Y %H:%M:%S')</code></a></span>
<span class="comment-copy">I just found something on time from win32com objects.  The only way I could get it converted was with <code>newDate = time.strftime('%m/%d/%Y %H:%M:%S', time.localtime(int(msg.SentOn)))</code>  . The <code>int</code> returns an integer compatible with the standard Python time module.</span>
