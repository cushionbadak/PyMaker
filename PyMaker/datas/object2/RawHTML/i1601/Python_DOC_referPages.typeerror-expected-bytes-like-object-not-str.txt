<div class="post-text" itemprop="text">
<p>I know this question has been asked much times, but please look once in my problem.</p>
<p>I am sending <code>base64</code> image data from angular to <strong>python flask</strong> but when I am processing that <code>base64</code> data on flask server(python3) then it is giving me the error</p>
<blockquote>
<p><code>TypeError: expected bytes-like object, not str</code></p>
</blockquote>
<p>my Javascript code is: </p>
<p><code>window['__CANVAS'].toDataURL("image/png");</code> </p>
<p>Output of the above line is:</p>
<p><code>"data:image/png;base64,iVBORw0KGgoAAAANSUhEUg....."</code> </p>
<p>I am receiving same data on flask server as string.</p>
<p>Code on python server that is using above base 64 data is: </p>
<pre><code>def convert_to_image(base64_code):
  image_64_decode = base64.decodebytes(base64_code)
  image_result = open('baseimage.jpg', 'wb')
  image_result.write(image_64_decode)
  img_rgb = cv2.imread('baseimage.jpg')
  return img_rgb
</code></pre>
<p>then it is giving the following error trace:</p>
<pre><code>File "/home/shubham/py-projects/DX/Web/app/base64toimage.py", line 10, in convert_to_image    
  image_64_decode = base64.decodebytes(base64_code)
File "/usr/lib/python3.5/base64.py", line 552, in decodebytes    
  _input_type_check(s)
File "/usr/lib/python3.5/base64.py", line 521, in _input_type_check  
  raise TypeError(msg) from err 
TypeError: expected bytes-like object, not str
</code></pre>
<p>above python function working fine if I am converting the image using this function</p>
<pre><code>import base64

with open("t.png", "rb") as imageFile:
  str = base64.b64encode(imageFile.read())
  print str
</code></pre>
<p>please help me to solve this question? I am new to python.</p>
</div>
<div class="post-text" itemprop="text">
<p><code>base64.decodebytes</code> only accepts byte arrays, use <code>base64.b64decode</code> instead it accepts Strings as well</p>
</div>
<span class="comment-copy"><code>b64encode</code> returns <code>bytes</code>, that's why <code>decodebytes</code> works, because it is expecting bytes, not a string (as the error message clearly states). See: <a href="https://docs.python.org/3/library/base64.html" rel="nofollow noreferrer">docs.python.org/3/library/base64.html</a> To solve your problem, convert <code>base64_code</code> to bytes or pass a byte-like-object to the function instead of a string. Side note:  you have successfully overriden the built-in <code>str</code> with <code>str = base64.b64encode(...</code> - don't do that!</span>
<span class="comment-copy">by changing this I am getting new error <code>hsv_img = cv2.cvtColor(image,cv2.COLOR_BGR2HSV) cv2.error: OpenCV(3.4.3) /io/opencv/modules/imgproc/src/color.cpp:181: error: (-215:Assertion failed) !_src.empty() in function 'cvtColor' </code></span>
<span class="comment-copy"><a href="https://stackoverflow.com/a/33522724/5048815">stackoverflow.com/a/33522724/5048815</a></span>
