<div class="post-text" itemprop="text">
<p>I currently have a column which has data I want to parse, and then put this data on other columns. Currently the best I can get is from using the apply method:</p>
<pre><code>def parse_parent_names(row):
    split = row.person_with_parent_names.split('|')[2:-1]
    return split

df['parsed'] = train_data.apply(parse_parent_names, axis=1).head()
</code></pre>
<p>The data is a panda df with a column that has names separated by a pipe (|):</p>
<pre><code>'person_with_parent_names'
|John|Doe|Bobba|
|Fett|Bobba|
|Abe|Bea|Cosby|
</code></pre>
<p>Being the rightmost one the person and the leftmost the "grandest parent". I'd like to transform this to three columns, like:</p>
<pre><code>'grandfather'    'father'    'person'
John             Doe         Bobba
                 Fett        Bobba
Abe              Bea         Cosby
</code></pre>
<p>But with apply, the best I can get is</p>
<pre><code>'parsed'
[John, Doe,Bobba]
[Fett, Bobba]
[Abe, Bea, Cosby]
</code></pre>
<p>I could use apply three times, but it would not be efficient to read the entire dataset three times.</p>
</div>
<div class="post-text" itemprop="text">
<p>Your function should be changed by compare number of <code>|</code> and split by ternary operator, last pass to <code>DataFrame</code> constructor:</p>
<pre><code>def parse_parent_names(row):
    m = row.count('|') == 4
    split = row.split('|')[1:-1] if m else row.split('|')[:-1]
    return split

cols = ['grandfather','father','person']
df1 = pd.DataFrame([parse_parent_names(x) for x in df.person_with_parent_names],
                    columns=cols)
print (df1)
  grandfather father person
0        John    Doe  Bobba
1               Fett  Bobba
2         Abe    Bea  Cosby
</code></pre>
</div>
<span class="comment-copy">Look here <a href="https://stackoverflow.com/questions/39050539/adding-multiple-columns-to-pandas-simultaneously" title="adding multiple columns to pandas simultaneously">stackoverflow.com/questions/39050539/â€¦</a>. It looks like the thing you need.</span>
