<div class="post-text" itemprop="text">
<p>I have written a function that converts each pdf from a directory into text and I want to get the converted text from the pdf's as txt files. I am getting "TypeError: expected str, bytes or os.PathLike object, not tuple" error in my code. Can anyone please help me with this. Attaching code here:</p>
<pre><code>import io
import os
import os.path
from pdfminer.converter import TextConverter
from pdfminer.pdfinterp import PDFPageInterpreter
from pdfminer.pdfinterp import PDFResourceManager
from pdfminer.pdfpage import PDFPage

    def extract_text_from_pdf(pdf_path):
        resource_manager = PDFResourceManager()
        fake_file_handle = io.BytesIO()
        converter = TextConverter(resource_manager, fake_file_handle)
        page_interpreter = PDFPageInterpreter(resource_manager, converter)

        with open(pdf_path, 'rb') as fh:
            for page in PDFPage.get_pages(fh, 
                                          caching=True,
                                          check_extractable=True):
                page_interpreter.process_page(page)

            text = fake_file_handle.getvalue()

        # close open handles
        converter.close()
        fake_file_handle.close()

        if text:
            return text

    def save_to_txt(lst):
            for i, ele in enumerate(lst): 
                txtfile = "{}.txt".format(i)
                files = extract_text_from_pdf(ele)
                with open(txtfile, "w") as textfile:
                    textfile.write(files) 

    if __name__ == '__main__':
        pdf_path = 'C:\\Users\\Lenovo\\.spyder-py3\\OCR'
        for root, _, files in os.walk(pdf_path):
            for filename in files:
                filepath = os.path.join(root, filename)
                extract_text_from_pdf(filepath)

        for f in filepath:
            save_to_txt(f)
</code></pre>
<p>The error is as follows:</p>
<pre><code>runfile('C:/Users/Lenovo/.spyder-py3/updatedpy.py', wdir='C:/Users/Lenovo/.spyder-py3')
Traceback (most recent call last):

  File "&lt;ipython-input-17-f6b3bb00c382&gt;", line 1, in &lt;module&gt;
    runfile('C:/Users/Lenovo/.spyder-py3/updatedpy.py', wdir='C:/Users/Lenovo/.spyder-py3')

  File "C:\Program Files (x86)\Microsoft Visual Studio\Shared\Anaconda3_64\lib\site-packages\spyder\utils\site\sitecustomize.py", line 705, in runfile
    execfile(filename, namespace)

  File "C:\Program Files (x86)\Microsoft Visual Studio\Shared\Anaconda3_64\lib\site-packages\spyder\utils\site\sitecustomize.py", line 102, in execfile
    exec(compile(f.read(), filename, 'exec'), namespace)

  File "C:/Users/Lenovo/.spyder-py3/updatedpy.py", line 47, in &lt;module&gt;
    extract_text_from_pdf(file)

  File "C:/Users/Lenovo/.spyder-py3/updatedpy.py", line 22, in extract_text_from_pdf
    with open(pdf_path, 'rb') as fh:

TypeError: expected str, bytes or os.PathLike object, not tuple
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The error come from the use of the os.walk method in your main section, which does not return a filename, but a tuple. See the <a href="https://docs.python.org/3/library/os.html" rel="nofollow noreferrer">os documentation</a> for more details.</p>
<p><strong>Edit</strong>: You could use the os.walk method like this:</p>
<pre><code>for root, _, files in os.walk(pdf_path):
    for filename in files:
        filepath = os.path.join(root, filename)
        extract_text_from_pdf(filepath)
</code></pre>
<p><strong>Or</strong> You could use the <a href="https://pathpy.readthedocs.io/en/stable/api.html" rel="nofollow noreferrer">path.py</a> library and use the <a href="https://pathpy.readthedocs.io/en/stable/api.html#path.Path.walkfiles" rel="nofollow noreferrer">walkfiles method</a>. That way you could do:</p>
<pre><code>from path import Path

pdf_path = Path('C:\\dev') 

for file in pdf_path.walkfiles():
    extract_text_from_pdf(file)
</code></pre>
</div>
<span class="comment-copy">Which line is getting that error? It's best to post the full traceback.</span>
<span class="comment-copy">Thanks for replying. I have attached the full traceback with the code.</span>
<span class="comment-copy"><a href="https://docs.python.org/3/library/os.html#os.walk" rel="nofollow noreferrer"><code>os.walk()</code></a> returns a tuple of root, directories, and files--not individual paths.  You need to do a bit more work with the results of os.walk() to get what you want.  If you're using a new enough version of Python, you might want to consider <a href="https://docs.python.org/3/library/os.html#os.scandir" rel="nofollow noreferrer"><code>os.scandir()</code></a>.</span>
<span class="comment-copy">You're calling <code>extract_text_from_pdf()</code> from both the <code>for file in os.walk</code> loop and also inside <code>save_to_text()</code>. Do you really need to do both? Also <code>for f in file:</code> doesn't seem right. <code>file</code> is not a list of anything. And <code>save_to_text()</code> expects the argument to be a list.</span>
<span class="comment-copy">Thanks . can you please suggest the code changes as I am new to python.</span>
<span class="comment-copy">Thanks, I have edited my code with the inputs you have provided but I am getting an error 'PDFTextExtractionNotAllowed: Text extraction is not allowed: &lt;_io.BufferedReader name='C:'. Can you please let me know the changes I need to make</span>
<span class="comment-copy">I don't think this bug is related to the way you open your file. It seems like your pdf is protected or encrypted. Take a look at <a href="https://stackoverflow.com/questions/39981980/pdfminer-pdftextextractionnotallowed-error?noredirect=1">this post</a></span>
