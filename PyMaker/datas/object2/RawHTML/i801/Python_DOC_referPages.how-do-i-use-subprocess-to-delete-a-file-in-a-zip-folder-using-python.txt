<div class="post-text" itemprop="text">
<p>[Python 2.6.5] Simple question but can't seem to find any documentation or previous questions answering my problem. I'm trying to delete 2 files within a ZIP Folder (Its 2 Folders deep in the ZIP Folder if that matters). I want to use subprocess to call 7Zip to delete the files but have no clue how to even start that process. As of now I can only open the application. Ideally, I'd like to run the python script, have the file names hard coded into the script, and have 7zip just automatically delete those files without the application ever opening if possible.</p>
<p>What I have so far:</p>
<pre><code>import subprocess, os


rawLocation = 'SomeLocation\7-ZipPortable.exe'
subprocess.Popen([rawLocation])
</code></pre>
<p>This successfully opens the application, but I'd like to run and have it automatically delete files without even opening up if possible.</p>
<ul>
<li>Note: Thanks for the help everyone. The customer's requirements ended up changing so I don't need to use this logic anymore. </li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>You need to use the <a href="https://sevenzip.osdn.jp/chm/cmdline/index.htm" rel="nofollow noreferrer">command line version</a> of 7zip. And then according to <a href="https://sevenzip.osdn.jp/chm/cmdline/commands/delete.htm" rel="nofollow noreferrer">this documentation</a>, you should be able to delete files like so.</p>
<pre><code>7z d archive.zip deleteme.ext
</code></pre>
<p>Note: for anyone who might think that Python's <a href="https://docs.python.org/3/library/zipfile.html" rel="nofollow noreferrer">zipfile</a> module would be a good solution, I looked through the module, and it doesn't look like it supports deleting files from an archive.</p>
</div>
<div class="post-text" itemprop="text">
<p>something like this :</p>
<pre class="lang-py prettyprint-override"><code>from subprocess import call

delete_me = "note.txt"
zip_file = "archive.zip"
try:
    call(['7z d', zip_file, delete_me])
except OSError:
    # handle errors here
    pass
</code></pre>
</div>
<span class="comment-copy">Why use a subprocess instead of the <code>zipfile</code> module?</span>
<span class="comment-copy">The zipfile Module doesn't support the deletion of files within the zip folder from everything I've researched.</span>
<span class="comment-copy">Thanks so much for comment Mr. Me, I was wondering if you could show what I should type in exactly to make it work. I'm trying this but it's clearly wrong.   <code>subprocess.run(" 7z d bin3.zip product.json")</code>   I'm pretty new to these modules/coding in general.</span>
<span class="comment-copy">What happens if you run <code>7z d bin3.zip product.json</code> on the command line?</span>
