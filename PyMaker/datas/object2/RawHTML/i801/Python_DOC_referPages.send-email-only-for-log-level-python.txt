<div class="post-text" itemprop="text">
<p>There are several similar questions asked, but none I could find that specifically address this scenario.</p>
<p>In python, I have a class that uses a library that throws exceptions when there are errors or data it cant handle.</p>
<p>My class wraps the library, catches the exceptions and logs them using logger.</p>
<p>I want to email any exception that is raised to myself, but I do not want to get an email for every log entry.  That is to say, I only want to get email when something is logged with logger.exception("The Exception"), but not if logged with logger.info("Great things are happening")</p>
<p>As I understand it the SMTP handler would email all log entries to me.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can create your own logging filter, like so:</p>
<pre class="lang-py prettyprint-override"><code>import logging


class MessageFilter(logging.Filter):
    def filter(self, record):
        return 'goodbye' in record.msg


logger = logging.getLogger(__name__)


handler = logging.StreamHandler()
handler.addFilter(MessageFilter())
logger.addHandler(handler)


logger.error('hello world')
logger.error('goodbye moon')
</code></pre>
<p>which results in</p>
<pre><code>goodbye moon
</code></pre>
<p>Just replace the message in <code>filter</code> with the one you want to match and attach it to your SMTPHandler.</p>
</div>
<span class="comment-copy">Use different handlers? <a href="https://docs.python.org/3/howto/logging-cookbook.html#multiple-handlers-and-formatters" rel="nofollow noreferrer">Multiple handlers and formatters</a></span>
<span class="comment-copy">Do you want to <i>log</i> other levels also? Or do you only care about exceptions?</span>
<span class="comment-copy">@wwii I want to log everything, but only send email for exceptions.</span>
<span class="comment-copy"><a href="https://docs.python.org/3/howto/logging.html#handlers" rel="nofollow noreferrer">Handlers</a>. Also see the cookbook link in the other comment.  Make a handler and set it for CRITICAL or ERROR, when handling an Exception log with the appropriate level.</span>
<span class="comment-copy">Great.  Is there an easy way to check whether the "record" is an exception?</span>
<span class="comment-copy">As mentioned in <a href="https://docs.python.org/3/library/logging.html#logrecord-attributes" rel="nofollow noreferrer">LogRecord attributes</a>, log records may have an <code>exc_info</code> field if they have captured an exception.</span>
