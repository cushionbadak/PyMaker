<div class="post-text" itemprop="text">
<p>I want to hash a password with the <a href="https://docs.python.org/3/library/crypt.html" rel="nofollow noreferrer">crypt</a> module using <em>blowfish</em> encryption.</p>
<p>On Fedora 29 I get the correct result:</p>
<pre class="lang-sh prettyprint-override"><code>$ python3.7
Python 3.7.2 (default, Jan  3 2019, 09:14:01) 
[GCC 8.2.1 20181215 (Red Hat 8.2.1-6)] on linux

&gt;&gt;&gt; import crypt
&gt;&gt;&gt; crypt.crypt("password", "$2y$08$heregoesasaltstring...")
'$2y$08$heregoesasaltstring...ZR2mMC1niL.pkti1MfmoP.3XVbdoNHm'
&gt;&gt;&gt;
</code></pre>
<p>On Ubuntu 18.04 it returns nothing:</p>
<pre class="lang-sh prettyprint-override"><code>$ python3.7
Python 3.7.2 (default, Dec 25 2018, 03:50:46) 
[GCC 7.3.0] on linux

&gt;&gt;&gt; import crypt
&gt;&gt;&gt; crypt.crypt("password", "$2y$08$heregoesasaltstring...")
&gt;&gt;&gt;
</code></pre>
<p>Python 3.7.1 on Fedora comes from the default repos, while on Ubuntu the problem can be seen with both the python 3.7.1 from the official repos and the one I found on an <a href="https://launchpad.net/~deadsnakes/+archive/ubuntu/ppa" rel="nofollow noreferrer">external PPA</a>.</p>
<p>Is there any environment variable or underlying program/library that could change the behavior of Python?</p>
</div>
<div class="post-text" itemprop="text">
<p>Your salt string is invalid on Ubuntu. Try dropping all those dollar signs.</p>
<hr/>
<p>From the Python documentation of <code>crypt</code> module you linked:</p>
<blockquote>
<p>This module implements an interface to the <em>crypt(3)</em> routine</p>
</blockquote>
<blockquote>
<p><em>salt</em> (either a random 2 or 16 character string, possibly prefixed with <code>$digit$</code> to indicate the method) which will be used to perturb the encryption algorithm. The characters in salt must be in the set <code>[./a-zA-Z0-9]</code>, with the exception of Modular Crypt Format which prefixes a <code>$digit$</code>.</p>
</blockquote>
<p>From <code>man 3 crypt</code>:</p>
<blockquote>
<p>ERRORS</p>
<p>EINVAL: salt has the wrong format.</p>
</blockquote>
<p>I wrote a test program to confirm this:</p>
<pre class="lang-c prettyprint-override"><code>#include &lt;unistd.h&gt;
#include &lt;crypt.h&gt;
#include &lt;errno.h&gt;
#include &lt;stdio.h&gt;

int main() {
    char *s = crypt("password", "$2y$08$heregoesasaltstring...");
    printf("%d\n%d\n%d\n", errno == EINVAL, errno == ENOSYS, errno == EPERM);
    puts(s);
    return 0;
}
</code></pre>
<p>The output on Ubuntu 18.04 is</p>
<pre><code>ibug@ubuntu:~/t $ gcc t.c -lcrypt
ibug@ubuntu:~/t $ a.out
1
0
0
Segmentation fault (core dumped)
139|ibug@ubuntu:~/t $
</code></pre>
<p>I don't have Fedora in hand, so I didn't test it. You can copy the test program and compile &amp; run it yourself.</p>
</div>
