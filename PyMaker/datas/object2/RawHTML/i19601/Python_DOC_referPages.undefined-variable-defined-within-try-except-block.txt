<div class="post-text" itemprop="text">
<p>I am using the below code to scrape over XFN content from web page <a href="http://ajaxian.com" rel="nofollow">http://ajaxian.com</a>
but I am getting undefined variable error:</p>
<p>My code is as follows:</p>
<pre><code>'''
Created on Jan 11, 2013

@author: Somnath
'''
# Scraping XFN content from a web page
# -*-coding: utf-8 -*-

import sys
import urllib2
import HTMLParser
from BeautifulSoup import BeautifulSoup

# Try http://ajaxian.com
URL = sys.argv[0]

XFN_TAGS = set([
            'colleague',
            'sweetheart',
            'parent',
            'co-resident',
            'co-worker',
            'muse',
            'neighbor',
            'sibling',
            'kin',
            'child',
            'date',
            'spouse',
            'me',
            'acquaintance',
            'met',
            'crush',
            'contact',
            'friend',
            ])


try:
    page = urllib2.urlopen(URL)
except urllib2.URLError:
    print 'Failed to fetch ' + item

try:
    soup = BeautifulSoup(page)
except HTMLParser.HTMLParseError:
    print 'Failed to parse ' + item

anchorTags = soup.findAll('a')

for a in anchorTags:
    if a.has_key('rel'):
        if len(set(a['rel'].split()) &amp; XFN_TAGS) &gt; 0:
            tags = a['rel'].split()
            print a.contents[0], a['href'], tags
</code></pre>
<p>I have two try blocks in my code and it is giving an error undefined variable : item. If I want to re-include the try-except blocks, should I give a blank definition of variable, item outside the try blocks? </p>
<p>P.S: Please note that is a standard code followed from a book. And I expect that they would not have made such a trivial mistake. Am I getting something wrong here ?</p>
</div>
<div class="post-text" itemprop="text">
<p>Assuming that you want to print the URL that failed to load, try changing it to <code>print 'Failed to fetch ' + URL</code>. You aren't actually defining <code>item</code> anywhere, so Python doesn't know what you mean:</p>
<pre><code>try:
    page = urllib2.urlopen(URL)
except urllib2.URLError:
    print 'Failed to fetch ' + URL
</code></pre>
<p>And in your second block, change <code>item</code> to <code>URL</code> as well (assuming the error you want to display shows the URL and not the content).</p>
<pre><code>try:
    soup = BeautifulSoup(page)
except HTMLParser.HTMLParseError:
    print 'Failed to parse ' + URL
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>print 'Failed to fetch ' + item
</code></pre>
<p>item is not <strong>defined</strong> any where. I guess you wanted to print URL there.</p>
<p>As per <a href="http://docs.python.org/3/tutorial/introduction.html" rel="nofollow">python tutorial</a></p>
<blockquote>
<p>Variables must be “defined” (assigned a value) before they can be used, or an error will occur:</p>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>You did not define the variable 'item'. That's what is causing the error. You must define a variable before you use it.</p>
</div>
<span class="comment-copy">Then I must say that the O'Reilly book I am following, has made a very trivial mistake, which is easily noticeable. I must say that one shouldn't trust the book blindly except his/her own logic</span>
<span class="comment-copy">@somnathchakrabarti Ha, that is a bit bizarre. As far as I can tell, it is indeed incorrect.</span>
<span class="comment-copy">Yes I can understand that but that's the code from a O'reilly press book which I didn't expect to be so trivial !</span>
<span class="comment-copy">@ somnathchakrabarti: I would guess that was a mistake they made.</span>
