<div class="post-text" itemprop="text">
<blockquote>
<p><strong>Possible Duplicate:</strong><br/>
<a href="https://stackoverflow.com/questions/5512811/builtins-typeerror-must-be-str-not-bytes">builtins.TypeError: must be str, not bytes</a> </p>
</blockquote>
<p>I wrote a program to write a dict to file and in Python 2.7 it works well, but now in Python 3 I receive <code>TypeError: 'str' does not support the buffer interface</code> and <code>TypeError: must be str, not bytes</code></p>
<p><strong>CODE UPDATED</strong></p>
<p><strong>Inputs</strong>: path to dir, file name (<code>!hamers.txt</code> for example) and new dictionary</p>
<p><strong>Outputs</strong>: none</p>
<p><strong>Effects</strong>: Generate new file with dictionary. Check if file exists and then merge two dictionaries (existing and new).</p>
<pre><code>def generate_file_from_dict(self, path, fname, my_new_dict):                   
                    mfile = self.add_slash(path)+fname
            if os.path.exists(mfile):
                    mfile = open(mfile, 'rb')
                    my_existing_dict = pickle.load(mfile)
                    my_new_dict = dict(my_existing_dict.items() + my_new_dict.items())
                    mfile.close()
            mfile = open(self.add_slash(path)+fname, 'wb+')
            pickle.dump(my_new_dict, mfile)
            mfile.close()
</code></pre>
<p><strong>Now its</strong> </p>
<pre><code>my_existing_dict = pickle.load(mfile)
EOFError
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The file should opened in binary</p>
<pre><code>mfile = open(mfile,'rb')

mfile = open(self.add_slash(path)+fname, 'wb+')
</code></pre>
</div>
<span class="comment-copy">I'm always puzzled by this sort of question, doesn't the error tell you what exactly the problem is? It says <code>"must be a str, not bytes"</code>. How else could this be interpreted but to mean, that you're trying to pass <code>bytes</code>, when you should pass <code>str</code>.</span>
<span class="comment-copy">Hmmm... maybe I ask because on Python 2.7 it works fine!?</span>
<span class="comment-copy">May be you should read docs?</span>
<span class="comment-copy">@VladislavIl'ushin: When switching a major version of anything, you should expect that not everything works. This might help you: <a href="http://docs.python.org/3/howto/pyporting.html" rel="nofollow noreferrer">docs.python.org/3/howto/pyporting.html</a></span>
<span class="comment-copy">And now your file is empty.</span>
<span class="comment-copy"><code>my_existing_dict = pickle.load(mfile) TypeError: 'str' does not support the buffer interface</code></span>
<span class="comment-copy">@VladislavIl'ushin: all <code>open</code> calls should use <code>b</code> mode, when using pickle. <b>all</b> calls.</span>
<span class="comment-copy">OK, a edit it, but now <code>my_existing_dict = pickle.load(mfile) EOFError</code>, where mfile is <code>mfile = open(mfile, 'wb+')</code></span>
<span class="comment-copy"><b>CODE UPDATED</b></span>
<span class="comment-copy">@VladislavIl'ushin: read the answer. People are actually trying to help you. Is this what Pearsonartphoto suggested you do?</span>
