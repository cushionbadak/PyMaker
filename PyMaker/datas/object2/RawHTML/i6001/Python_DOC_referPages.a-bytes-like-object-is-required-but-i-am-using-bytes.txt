<div class="post-text" itemprop="text">
<p>With Python3 I have re-opened stdout in binary mode. After that when I <code>print("Hello")</code> it tells me that I need to use a bytes-like object. Fair enough, it's in binary mode now.</p>
<p>However when I do this:</p>
<pre><code>print(b"Some bytes")
</code></pre>
<p>I <em>still</em> get this error:</p>
<pre><code>TypeError: a bytes-like object is required, not 'str'
</code></pre>
<p>What's up with that?</p>
</div>
<div class="post-text" itemprop="text">
<p><code>print()</code> <strong>always</strong> writes <code>str</code> values. It'll convert any arguments to strings first, including bytes objects.</p>
<p>From the <a href="https://docs.python.org/3/library/functions.html#print" rel="nofollow noreferrer"><code>print()</code> documentation</a>:</p>
<blockquote>
<p>All non-keyword arguments are converted to strings like <code>str()</code> does and written to the stream, separated by <em>sep</em> and followed by <em>end</em>.</p>
</blockquote>
<p>You can't use <code>print()</code> on a binary stream, period. Either write directly to the stream (using it's <code>.write()</code> method), or wrap the stream in a <a href="https://docs.python.org/3/library/io.html#io.TextIOWrapper" rel="nofollow noreferrer"><code>TextIOWrapper()</code> object</a> to handle encoding.</p>
<p>These both work:</p>
<pre><code>import sys

sys.stdout.write(b'Some bytes\n')  # note, manual newline added
</code></pre>
<p>and</p>
<pre><code>from io import TextIOWrapper
import sys

print('Some text', file=TextIOWrapper(sys.stdout, encoding='utf8'))
</code></pre>
</div>
