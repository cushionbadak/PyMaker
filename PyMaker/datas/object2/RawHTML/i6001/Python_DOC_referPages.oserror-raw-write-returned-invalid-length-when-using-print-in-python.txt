<div class="post-text" itemprop="text">
<p>I'm using python tensorflow to train a model to recognise images in python. But I'm getting the below error when trying to execute train.py from <a href="https://github.com/loicmarie/sign-language-alphabet-recognizer" rel="noreferrer">github</a> </p>
<pre><code>Traceback (most recent call last):
File "train.py", line 1023, in &lt;module&gt;
tf.app.run(main=main, argv=[sys.argv[0]] + unparsed)
File "C:\Users\sande\Anaconda3\envs\tensorflow\lib\site-
packages\tensorflow\python\platform\app.py", line 48, in run
_sys.exit(main(_sys.argv[:1] + flags_passthrough))
File "train.py", line 766, in main
bottleneck_tensor)
File "train.py", line 393, in cache_bottlenecks
jpeg_data_tensor, bottleneck_tensor)
File "train.py", line 341, in get_or_create_bottleneck
bottleneck_tensor)
File "train.py", line 290, in create_bottleneck_file
print('Creating bottleneck at ' + bottleneck_path)
OSError: raw write() returned invalid length 112 (should have been between 0 
and 56)
</code></pre>
<p>Below is the code for create_bottleneck_file()</p>
<pre><code>def create_bottleneck_file(bottleneck_path, image_lists, label_name, index,
                       image_dir, category, sess, jpeg_data_tensor,
                       bottleneck_tensor):
"""Create a single bottleneck file."""
print('Creating bottleneck at ' + bottleneck_path)
image_path = get_image_path(image_lists, label_name, index,
                          image_dir, category)
if not gfile.Exists(image_path):
    tf.logging.fatal('File does not exist %s', image_path)
image_data = gfile.FastGFile(image_path, 'rb').read()
try:
    bottleneck_values = run_bottleneck_on_image(
        sess, image_data, jpeg_data_tensor, bottleneck_tensor)
except:
    raise RuntimeError('Error during processing file %s' % image_path)

bottleneck_string = ','.join(str(x) for x in bottleneck_values)
with open(bottleneck_path, 'w') as bottleneck_file:
    bottleneck_file.write(bottleneck_string)
</code></pre>
<p>I tried reducing the file names so that bottleneck_path will be a small value but that did not work. I tried to search online for this error but did not find anything useful. Please let me know if you have a fix to this issue</p>
</div>
<div class="post-text" itemprop="text">
<p>If you're unable to migrate to 3.6 or from Windows like me, install the <em>win_unicode_console</em> package, import it and add this line at the beggining of your script to enable it:</p>
<pre><code>win_unicode_console.enable()
</code></pre>
<p>This issue appears to be generally unique to pre-3.6 Python as the code responsible for handling text output was rewritten for this latest version. This also means that we will most likely not see a fix coming for this issue.</p>
<p>Source: <a href="https://bugs.python.org/issue32245" rel="noreferrer">https://bugs.python.org/issue32245</a></p>
</div>
<div class="post-text" itemprop="text">
<p>I think this is a bug on the stdout/stderr streams introduced by the November's creators update, it happens in both powershell.exe and cmd.exe</p>
<p>It seems to only happen on Windows 10 Version 1709 (OS Build 16299.64). My guess is that it is unicode realted (output size is <strong>twice</strong> the length expected)</p>
<p>A (very) quick and dirty fix is to only output ASCII on your console :</p>
<p><code>mystring.encode("utf-8").decode("ascii")</code></p>
<p><a href="https://github.com/Microsoft/vscode/issues/39149#issuecomment-347260954" rel="noreferrer">https://github.com/Microsoft/vscode/issues/39149#issuecomment-347260954</a></p>
</div>
<div class="post-text" itemprop="text">
<p>Adding more to @AMSAntiago answer. You could run the win_unicode_console.enable(). But instead of using it on every file, you could run it on every Python invocation (<a href="https://docs.python.org/3/tutorial/appendix.html#the-customization-modules" rel="nofollow noreferrer">docs</a>). That works for me.</p>
</div>
<span class="comment-copy">I think the problem is that you're running the application on Windows, but the code is intended for Linux or Mac OS. If you run <code>print(bottleneck_path)</code> on Line 338, what's the output?</span>
<span class="comment-copy">I think you interacted cmd when the cmd was running, maybe this can help <a href="https://stackoverflow.com/questions/48371993/tqdm-crashes-on-windows-console-upon-accidental-mouse-keyboard-input/48374209#48374209" title="tqdm crashes on windows console upon accidental mouse keyboard input">stackoverflow.com/questions/48371993/â€¦</a></span>
