<div class="post-text" itemprop="text">
<p>I am trying to replace all text between the div class="one" tag
What I have so far works, but only if everything is on one line.<br/>
text_msg is the </p>
<pre><code>text = re.sub('&lt;div class="one"&gt;.*?&lt;/div&gt;',new_text,text_msg,re.DOTALL)

&lt;div class="one"&gt;replace this 
more text here
another line
&lt;/div&gt;
</code></pre>
<p>I have tried re.MULTILINE, got nowhere.  What am I doing wrong?</p>
</div>
<div class="post-text" itemprop="text">
<p>I went and modified your <code>re.sub</code>.  The problem with your current code is that you aren't using the <code>flags</code> key word arguments to specify flags.  I also changed your regex to look for a precursor pattern <code>(?&lt;=&lt;div class="one"&gt;)</code> and post pattern <code>(?=&lt;\/div&gt;)</code>.</p>
<pre><code>import re

text_msg = """
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Terrible webpage&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;div class="one"&gt;Cool text!&lt;/div&gt;
&lt;b&gt;test&lt;/b&gt;
&lt;div class="one"&gt;Second text!&lt;/div&gt;
&lt;div class="one"&gt;third text!&lt;/div&gt;
&lt;div class="one"&gt;replace this 
more text here
another line
&lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;
"""

print(re.sub('(?&lt;=&lt;div class="one"&gt;).*?(?=&lt;\/div&gt;)',"out",text_msg,flags=re.DOTALL))
</code></pre>
<p>Output:</p>
<pre><code>&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Terrible webpage&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;

&lt;div class="one"&gt;out&lt;/div&gt;
&lt;b&gt;test&lt;/b&gt;
&lt;div class="one"&gt;out&lt;/div&gt;
&lt;div class="one"&gt;out&lt;/div&gt;
&lt;div class="one"&gt;out&lt;/div&gt;

&lt;/body&gt;
&lt;/html&gt;
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Just replace <code>.</code> with <code>[\s\S]</code> in your regex as shown below:</p>
<p><code>&lt;div class=\"one\"&gt;[\s\S]*?&lt;\/div&gt;</code></p>
<p><a href="https://regex101.com/r/L8gwWB/1" rel="nofollow noreferrer">Click for Demo</a></p>
<p><strong>Explanation:</strong></p>
<ul>
<li><code>&lt;div class=\"one\"&gt;</code> - literally matches <code>&lt;div class="one"&gt;</code></li>
<li><code>[\s\S]*?</code> - matches 0+ occurrences of any character(include the newline character), as few as possible</li>
<li><code>&lt;\/div&gt;</code> - literally matches <code>&lt;/div&gt;</code></li>
</ul>
</div>
<span class="comment-copy">You need to use the <a href="https://docs.python.org/3/library/re.html#re.DOTALL" rel="nofollow noreferrer"><code>re.DOTALL</code></a> flag.</span>
<span class="comment-copy">@eugenhu Did you read the question?</span>
<span class="comment-copy">@TimBiegeleisen Woops, apparently not sorry.</span>
<span class="comment-copy">The fourth argument is count, <a href="https://docs.python.org/3.4/library/re.html#re.sub" rel="nofollow noreferrer"><code>re.sub()</code></a>. You need to specify flags as a keyword argument.</span>
<span class="comment-copy">And do something like <code>re.sub('(&lt;div class="one"&gt;).*?(&lt;/div&gt;)',r"\1" + new_text + r"\2",  text_msg, flags=re.DOTALL)</code> so the div tags don't get cut off from the final string.</span>
<span class="comment-copy">Thanks for all your help.</span>
<span class="comment-copy">Thanks for the advice.</span>
