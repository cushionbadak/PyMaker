<div class="post-text" itemprop="text">
<p>I have the code I would like for the content I need, however i would like to run through all the gameId's that have played so far instead of just the one in the URL. I would like to change 2017020001 and make it go through to 2017021272 or till the end of the season which is around 1272 i believe. How can that be done with the code below?</p>
<pre><code>import csv
import requests
import os

req = requests.get('https://statsapi.web.nhl.com/api/v1/game/2017020001/feed/live?site=en_nhl')
data = req.json()

my_data = []
pk = data['gameData']['game']['pk']
for item in data['liveData']['plays']['allPlays']:
    players = item.get('players')
    if players:
        player_a = players[0]['player']['fullName'] if len(players) &gt; 0 else None
        player_b = players[1]['player']['fullName'] if len(players) &gt; 1 else None
    else:
        player_a, player_b = None, None
    event = item['result']['event']
    time = item['about']['periodTime']
    triCode = item.get('team', {}).get('triCode')
    coordinates_x, coordinates_y = item['coordinates'].get('x'), item['coordinates'].get('y')
    my_data.append([pk, player_a, player_b, event, time, triCode, coordinates_x, coordinates_y])

headers = ["pk", "player_a", "player_b", "event", "time", "triCode", "coordinates_x", "coordinates_y"]

with open("NHL_2017020001.csv", "a", newline='') as f:
    writer = csv.writer(f)
    writer.writerow(headers)
    writer.writerows(my_data)
f.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If the game ids are numbered sequentially then it would be as simple as nesting all your code under a for loop that iterates through all the game ids and using str.format() add the necessary padding to the number in this case some parts would change:</p>
<pre><code>import csv
import requests
import os

for i in range(1, 1273):
    url = 'https://statsapi.web.nhl.com/api/v1/game/201702{:04d}/feed/live?site=en_nhl'.format(i)
    req = requests.get(url)
    req.raise_for_status()
    data = req.json()
    my_data = []
    pk = data['gameData']['game']['pk']
    for item in data['liveData']['plays']['allPlays']:
        players = item.get('players')
        if players:
            player_a = players[0]['player']['fullName'] if len(players) &gt; 0 else None
            player_b = players[1]['player']['fullName'] if len(players) &gt; 1 else None
        else:
            player_a, player_b = None, None
            event = item['result']['event']
            time = item['about']['periodTime']
            triCode = item.get('team', {}).get('triCode')
        coordinates_x, coordinates_y = item['coordinates'].get('x'), item['coordinates'].get('y')
        my_data.append([pk, player_a, player_b, event, time, triCode, coordinates_x, coordinates_y])

        headers = ["pk", "player_a", "player_b", "event", "time", "triCode", "coordinates_x", "coordinates_y"]

    with open("NHL_201702{:04d}.csv".format(i), "a", newline='') as f:
        writer = csv.writer(f)
        writer.writerow(headers)
        writer.writerows(my_data)
</code></pre>
<p>One last correction is that using <code>with ... as</code> makes it so that you don't need to close the file explictily.
You can find additional information on using str.format() <a href="https://docs.python.org/3/library/string.html#formatstrings" rel="nofollow noreferrer">here</a></p>
</div>
<div class="post-text" itemprop="text">
<p>You should iterate over your code using a for-loop</p>
<p>Something like this should work:</p>
<pre><code>import csv
import requests
import os

for x in range(2017020001, 2017021273):
    req = requests.get('https://statsapi.web.nhl.com/api/v1/game/%s/feed/live?site=en_nhl' % x)
    data = req.json()

    my_data = []
    pk = data['gameData']['game']['pk']
    for item in data['liveData']['plays']['allPlays']:
        players = item.get('players')
        if players:
            player_a = players[0]['player']['fullName'] if len(players) &gt; 0 else None
            player_b = players[1]['player']['fullName'] if len(players) &gt; 1 else None
        else:
            player_a, player_b = None, None
        event = item['result']['event']
        time = item['about']['periodTime']
        triCode = item.get('team', {}).get('triCode')
        coordinates_x, coordinates_y = item['coordinates'].get('x'), item['coordinates'].get('y')
        my_data.append([pk, player_a, player_b, event, time, triCode, coordinates_x, coordinates_y])

    headers = ["pk", "player_a", "player_b", "event", "time", "triCode", "coordinates_x", "coordinates_y"]

    with open("NHL_2017020001.csv", "a", newline='') as f:
        writer = csv.writer(f)
        writer.writerow(headers)
        writer.writerows(my_data)
    f.close()
</code></pre>
</div>
<span class="comment-copy">The <a href="https://docs.python.org/2/library/functions.html#range" rel="nofollow noreferrer"><code>stop</code> in <code>range</code> should be <code>1272+1</code></a> since it won't include the stop value in the resulting sequence.</span>
<span class="comment-copy">Yes you're right. I've corrected it. Thanks</span>
<span class="comment-copy">Thats not working with the code above. Have you tested it with it by chance?</span>
<span class="comment-copy">Its when says name data is not defined. when i change it it says response object is not subscriptable. alittle stuck</span>
<span class="comment-copy">Have you tried checking if the request is succesful before trying to acces the data? This is done by ensuring the following evaluates to true after running the request.get() function :  <code>req.status_code == 200</code></span>
<span class="comment-copy">The <code>stop</code> value of <code>2017021272</code> in <a href="https://docs.python.org/2/library/functions.html#range" rel="nofollow noreferrer"><code>range</code> should be <code>2017021272+1</code></a> since it won't include the stop value in the resulting sequence.</span>
