<div class="post-text" itemprop="text">
<p>I want to write python code that takes as input a  traffic pattern (i.e. an IP range, port and protocol) and determines whether the pattern is accepted or rejected by a firewall policy. </p>
<p>I think using IPSets would help. In particular, I thought of using <code>hash:net,port</code></p>
<p>When I try to create such a set in my code, I get an invalid syntax error. </p>
<p>This is the syntax I am using:</p>
<pre><code>ipset -N -exist contract hash:net,port
</code></pre>
<p>I also tried:</p>
<pre><code>ipset create -exist contract hash:net,port
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>Adding and removing set elements:
    s1 = IPSet()
    s1.add('192.0.2.0')
    IPSet(['192.0.2.0/32'])
Here is a simple arbitrary IP address range:
    iprange = IPRange('192.0.1.255', '192.0.2.16')
We can see the CIDR networks that can existing with this defined range:
    iprange.cidrs()
    [IPNetwork('192.0.1.255/32')
    IPNetwork('192.0.2.0/28')
    IPNetwork('192.0.2.16/32')]
</code></pre>
</div>
<span class="comment-copy">You can take a look on <a href="https://docs.python.org/3/library/ipaddress.html" rel="nofollow noreferrer">docs.python.org/3/library/ipaddress.html</a></span>
<span class="comment-copy">I need to perform set operations (set minus, union, intersection). Would the ipaddress module support that?</span>
<span class="comment-copy">I <a href="https://stackoverflow.com/help/editing">edited your question</a>, improving either its formatting, or <a href="https://stackoverflow.blog/2011/02/05/suggested-edits-and-edit-review/">its quality</a> to help people understanding your question, and to help you to get an appropriate answer.  But you still may need to add further information for your question to become fully solvable.</span>
<span class="comment-copy">Can you show us your code?  Those commands aren't Python syntax, so if you tried that verbatim it's no surprise you received a syntax error.  Include your code and the exact error message you are receiving. It may not be possible to do what you want; the kernel firewall tools don't generally provide facilities for testing a ruleset in this fashion.</span>
