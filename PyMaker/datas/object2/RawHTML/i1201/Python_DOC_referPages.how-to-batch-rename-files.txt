<div class="post-text" itemprop="text">
<p>I have hundreds of files in this form, with only a document number:</p>
<pre><code>28OPV-000333.000-A-001_00.pdf 
28OPV-000333.000-A-002_00.pdf 
</code></pre>
<p>I want to add a description for all of them. I have prepared all the new names in txt. How can I batch rename them using Python?</p>
<p>Desired output:</p>
<pre><code>28OPV-000333.000-A-001_equipment list.pdf
28OPV-000333.000-A-002_master tag.pdf 
</code></pre>
<p> </p>
<pre><code>import os
path = "D:\\TEST\\"
newnames = open("d:\\newnames.txt")
lines = newnames.readlines()
for file in os.listdir(path):
    for line in lines:
        if line[0:22]==file[0:22]:
            os.renames(path+file,path+line)
        else:
            break
</code></pre>
<p>I am new to programming, my code above is throwing an error as below, I'm not able to find where the issue is.</p>
<pre><code>OSError: [WinError 123] The filename, directory name, or volume label syntax is incorrect: 'D:\\TEST\\28OPV-000333.000-B-555_0000.PDF' -&gt; 'D:\\TEST\\28OPV-000333.000-B-555_HAHA.PDF\n'

Process finished with exit code 1
</code></pre>
<p>Finally, with the conduct of below friends, i get the desired result.
and i put the corrected codes below for future reference.</p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>import os,sys
path = "D:\\2 BA\\3 TP TQ Vendor drawings\\siemens\\"
newnames = open("d:\\newnames.txt")
lines = newnames.read().splitlines()
for file in os.listdir(path):
    for line in lines:
        if line[0:22]==file[0:22]:
            try:
                os.renames(path+file,path+line)
            except Exception:
                pass</code></pre>
</div>
</div>
</p>
<p>or below code</p>
<p><div class="snippet" data-babel="false" data-console="true" data-hide="false" data-lang="js">
<div class="snippet-code">
<pre class="snippet-code-js lang-js prettyprint-override"><code>import os
path = "D:\\TEST\\"
newnames = open("d:\\newnames.txt")
lines = newnames.readlines()
for file in os.listdir(path):
    for line in lines:
        if line[0:22]==file[0:22]:
            try:
                os.renames(path+file,path+line.strip())
            except Exception:
                pass</code></pre>
</div>
</div>
</p>
</div>
<div class="post-text" itemprop="text">
<p>Note that there is one <code>\n</code> behind. It's illegal for a file name on windows.Try <code>lines = newnames.readlines().strip()</code>.</p>
<p><img alt="screenshot" src="https://i.stack.imgur.com/3sfdI.png"/></p>
</div>
<span class="comment-copy">What is the current file name, and what is the filename you trying to achieve.</span>
<span class="comment-copy">28OPV-000333.000-A-001_00.pdf is current name, want to rename it to 28OPV-000333.000-A-001_equipment list.pdf</span>
<span class="comment-copy"><a href="https://docs.python.org/3/library/pathlib.html" rel="nofollow noreferrer">Pathlib</a></span>
<span class="comment-copy">can you paste sample structure of your excel sheet ?</span>
<span class="comment-copy">reply to rɑːdʒɑ:          28OPV-000333.000-A-001_equipment list.pdf,28OPV-000333.000-A-002_calculation list.pdf   etc. , i have tried to list all files in the folder, and open this new name list which is a txt file, and read the new name row by row, compare this new name and file name with the same part, just the first 22 characters, if it is true, then, os.rename, but i have a problem that, this " for " loop only execute one time then throw OSError...</span>
<span class="comment-copy"><i>It's illegal for a file name</i> <b>on Windows.</b></span>
<span class="comment-copy">.strip() will still throw errors, and i changed to 	lines = newnames.read().splitlines(), it works. anyway thanks a lot.</span>
