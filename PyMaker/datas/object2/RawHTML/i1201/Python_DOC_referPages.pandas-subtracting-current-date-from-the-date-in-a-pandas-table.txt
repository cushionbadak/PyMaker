<div class="post-text" itemprop="text">
<p>I am attempting to calculate the difference in days between todays and a pandas data consisting of historical data. Below is the intended code:</p>
<pre><code>df['diff'] = pd.to_datetime( df['date']) - pd.datetime.now().date()
</code></pre>
<p>However, it produces the following error:</p>
<blockquote>
<p>TypeError: unsupported operand type(s) for -: 'DatetimeIndex' and
  'datetime.date'</p>
</blockquote>
<p>The date column in the pandas table looks like this:</p>
<pre><code>0       2018-12-18
1       2018-12-18
2       2018-12-18
3       2018-12-18
4       2018-12-18
</code></pre>
<p>How do I fix this error. Thanks in advance.</p>
</div>
<div class="post-text" itemprop="text">
<p>You have to subtract same types - <strong>datetimes</strong> with <strong>datetime</strong> (with zero times) or <strong>dates</strong> with <strong>date</strong>.</p>
<p>Use <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Timestamp.now.html" rel="nofollow noreferrer"><code>Timestamp.now</code></a> with <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Timestamp.normalize.html" rel="nofollow noreferrer"><code>Timestamp.normalize</code></a> or <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Timestamp.floor.html" rel="nofollow noreferrer"><code>Timestamp.floor</code></a> for remove <code>time</code>s:</p>
<pre><code>df['diff'] = pd.to_datetime( df['date']) - pd.Timestamp.now().normalize() 

df['diff'] = pd.to_datetime( df['date']) - pd.Timestamp.now().floor('d')
</code></pre>
<p>You can also use <a href="https://stackoverflow.com/a/5476166"><code>replace</code></a>:</p>
<pre><code>dt = pd.datetime.now().replace(hour=0, minute=0, second=0, microsecond=0)
df['diff'] = pd.to_datetime( df['date']) - dt
</code></pre>
<p>Or convert <code>Datetimes</code> to <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.dt.date.html" rel="nofollow noreferrer"><code>date</code></a>s for subtract same types:</p>
<pre><code>dt = datetime.datetime.now().date()
df['diff'] = pd.to_datetime(df['date']).dt.date - dt
</code></pre>
<p><strong>Sample</strong>:</p>
<pre><code>rng = pd.date_range('2018-04-03', periods=10, freq='100D')
df = pd.DataFrame({'date': rng}) 

df['diff'] = pd.to_datetime( df['date']) - pd.Timestamp.now().normalize() 
print (df)
        date      diff
0 2018-04-03 -261 days
1 2018-07-12 -161 days
2 2018-10-20  -61 days
3 2019-01-28   39 days
4 2019-05-08  139 days
5 2019-08-16  239 days
6 2019-11-24  339 days
7 2020-03-03  439 days
8 2020-06-11  539 days
9 2020-09-19  639 days
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>There is a subtle but important distinction. Pandas supports <strong><a href="https://docs.python.org/3/library/datetime.html#datetime.datetime" rel="nofollow noreferrer"><code>datetime.datetime</code></a></strong> objects but does <strong>not</strong> support <strong><a href="https://docs.python.org/3/library/datetime.html#datetime.date" rel="nofollow noreferrer"><code>datetime.date</code></a></strong> objects:</p>
<pre><code>from datetime import date, datetime

# TypeError: unsupported operand type(s) for -: 'DatetimeIndex' and 'datetime.date'
df['date'] - date.today()

# works correctly
df['date'] - datetime.now()

# works correctly
df['date'] - datetime.now().replace(minute=0, hour=0, second=0, microsecond=0)
</code></pre>
<p>Note <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Timestamp.date.html" rel="nofollow noreferrer"><code>pd.Timestamp.date</code></a> returns a <code>datetime.date</code> object. The docs do specify this: <code>Return date object with same year, month and day</code>. That <code>date</code> object is <strong>not</strong> supported natively by Pandas in the same way <code>datetime</code> objects are supported.</p>
<p>But replacing time values is cumbersome. You will likely prefer using in-built Pandas methods for your calculations. These are all equivalent:</p>
<pre><code>df['date'] - pd.Timestamp('today').floor('D')
df['date'] - pd.Timestamp.today().normalize()
df['date'] - pd.to_datetime('today').normalize()
</code></pre>
</div>
<span class="comment-copy">df['diff'] = pd.to_datetime( df['date'])  - pd.datetime.now(); Please try this one</span>
<span class="comment-copy">@MadhuriPatel, That's incorrect, since <code>now</code> includes time components and this isn't what OP is looking for.</span>
