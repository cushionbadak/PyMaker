<div class="post-text" itemprop="text">
<p>When running the updatePrice command, if an item is not on the list in the json file, this should reject the item, but instead it just adds the item at the bottom of the list and accepts it.</p>
<pre><code>@client.command(name='updatePrice',aliases= ['up'], pass_context=True)
async def update_price(ctx, item: str, quantity: float):
if (ctx.message.author.id in adminUsers):
    item = item.replace(" ", "").lower()
    with open(CONFIG, 'r+') as f:
        data = json.load(f)
        try:
            items[item] = quantity
            data['items'] = items
            f.seek(0)
            json.dump(data, f, indent=4)
            f.truncate()
            await client.say('{item} price updated'.format(item = item))
        except KeyError:
            await client.say('No match found for ' + item)
else:
    await client.say('You are not permitted to update item prices')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Let me guess: you're coming from a C# or Java background and you're assuming that <code>items[item] = ...</code> throws a KeyError if the key does not exist yet.</p>
<p>However, look at the <a href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries" rel="nofollow noreferrer">Dictionaries example</a>: <code>items[item] = ...</code> will add or change the item.</p>
<p>If you want to check whether an item is in a list, use <code>... in items</code>.</p>
<p>Sample code:</p>
<pre><code>from pprint import *
items = { "test":"something"}
items["new"] = "else"
pprint(items)
print ("not" in items)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I rewrote the command</p>
<pre><code>async def update_price(ctx, item: str, quantity: float):
    item = item.replace(" ", "").lower()
    with open(CONFIG, 'r+') as f:
        data = json.load(f)
        if item in items:
            items[item] = quantity
            data['items'] = items
            f.seek(0)
            json.dump(data, f, indent=4)
            f.truncate()
            await ctx.send(f'{item} price updated')
        else:
            await ctx.send('No match found for ' + item)
        return
</code></pre>
</div>
<span class="comment-copy">"if an item is not on the list in the json file, this should reject the item" why do you believe this? What list? Can you please be specific about exactly what you are expecting? Where are you even using a <code>list</code> here? I can only assume you are using <code>dict</code> objects, given that you are trying to index into <code>data</code> with a string...</span>
<span class="comment-copy">Thank you, I'll start with that direction.</span>
<span class="comment-copy">@giveen: if this answer solves your problem, please check the checkmark so that others don't need to spend time on it.</span>
