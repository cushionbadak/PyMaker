<div class="post-text" itemprop="text">
<p>When reading emails from a specific folder (Office365), the body of the message is a random long string that makes no sense. </p>
<p>Initially, I sent those emails to my personal mail as copy, to a specific folder. Reading from there I haven't had problems. 
But when I try to read directly from the main inbox, the messages are  long strings that makes no sense (so, I can´t parse anything)</p>
<pre><code>mail = imaplib.IMAP4_SSL(SMTP_SERVER)
     mail.login(FROM_EMAIL, FROM_PWD)
     boxes = mail.list()
     mail.select('INBOX/netstatus', readonly=True) 
     (type, data) = mail.uid('SEARCH', None, '(UNSEEN)') 
     mail_ids = data[0]
     id_list = mail_ids.split()


def read_email(self, *id_list):
    id_list = list(id_list)
    for i in reversed(id_list):
        (typ, data) = mail.uid('FETCH', i, '(RFC822)')
    for response_part in data:                  
        if isinstance(response_part, tuple):
            print("Response: ",response_part)
            msg = \         email.message_from_string(response_part[1].decode('utf-8'))                                                                       

            body = ''
            email_subject = msg['subject']
            email_from = msg['from']
            email_date = msg['date']
            message= msg.get_payload().encode('utf-8')
            print(message) 
</code></pre>
<p>I receive something like this when I read from my personal inbox:</p>
<blockquote>
<p>mymail:  b'Status from Device (x.x.x.x) to AnotherDevice (y.y.y.y), interface A B, in Protocol came up\r\n'</p>
</blockquote>
<p>But when I read from the main inbox:</p>
<blockquote>
<p>'QWRq4N5IGZyb20gVVREFxLXJlMSAuMTAuMjUsIDAxMDAuMTAwMS4w\r\nMDI1LjAwKSB0byBVU0FEQUxIERS4MC4xMC4xMMDAxLjAw\r\nMjUuMDQpLCBpbnZhY2UgMTAuMTA4AuMjI5IHRvIDEwLjEwLjIwLjEzMCwgaW4gSVNJUy9M\r\nZXZlbDIgd2VudCBkkNvbmZ3VyZWQgd2F0Y2hsaXN0OiI1OQ0K\r\n'</p>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>With Python3.6 or later, you can use <a href="https://docs.python.org/3/library/email.message.html#email.message.EmailMessage.get_content" rel="nofollow noreferrer"><code>EmailMessage.get_content()</code></a> to decode the encoded content automatically.</p>
<pre><code>import email
from email import policy

# Email based on one of the examples at https://docs.python.org/3.6/library/email.examples.html

s = """
Subject: Ayons asperges pour le =?utf-8?q?d=C3=A9jeuner?=
From: =?utf-8?q?Pep=C3=A9?= Le Pew &lt;pepe@example.com&gt;
To: Penelope Pussycat &lt;penelope@example.com&gt;,
 Fabrette Pussycat &lt;fabrette@example.com&gt;
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
MIME-Version: 1.0

ICAgIFNhbHV0IQoKICAgIENlbGEgcmVzc2VtYmxlIMOgIHVuIGV4Y2VsbGVudCByZWNpcGllWzFd
IGTDqWpldW5lci4KCiAgICBbMV0gaHR0cDovL3d3dy55dW1tbHkuY29tL3JlY2lwZS9Sb2FzdGVk
LUFzcGFyYWd1cy1FcGljdXJpb3VzLTIwMzcxOAoKICAgIC0tUGVww6kKICAgIAo=
"""

msg = email.message_from_string(s, policy=policy.default)
print(msg.get_content())

    Salut!

    Cela ressemble à un excellent recipie[1] déjeuner.

    [1] http://www.yummly.com/recipe/Roasted-Asparagus-Epicurious-203718

    --Pepé
</code></pre>
<p>For multipart messages you need to iterate over the parts:</p>
<pre><code>for part in msg.iter_parts():
    print(part.get_content())
</code></pre>
</div>
<span class="comment-copy">It is a base64 encoded message (although malformed). Use <code>message.decode("base64")</code> to decode.</span>
<span class="comment-copy">Looks like a server-side error. This is Microsoft Exchange, you say?</span>
<span class="comment-copy">You have indentation error at <code>for response_part ...</code>.</span>
<span class="comment-copy">get_payload(decode=true) will cause the email library to automatically do base64 and Quoted-Printable decoding.</span>
<span class="comment-copy">Thanks for the answers guys.  Max, your solution worked just fine! Another day  I will try to understand why this happen only on one inbox.</span>
