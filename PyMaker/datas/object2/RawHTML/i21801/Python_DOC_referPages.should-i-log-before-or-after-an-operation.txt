<div class="post-text" itemprop="text">
<p>I'm thinking about where to write the log record around an operation. Here are two different styles. The first one, write log before the operation.</p>
<p>Before:</p>
<pre><code>log.info("Perform operation XXX")
operation()
</code></pre>
<p>And here is a different style, write the log after the operation.</p>
<p>After:</p>
<pre><code>operation()
log.info("Operation XXX is done.")
</code></pre>
<p>With the before-style, the logging records say what is going to do now. The pro of this style is that when something goes wrong, developer can detect it easily, because they know what is the program doing now.  But the con is that you are not sure is the operation finished correctly, if something wrong is inside the operation, for example, a function call gets blocked there and never return, you can't never know it by reading the logging records.  With the after-style, you are sure the operation is done.</p>
<p>Of course, we can mix those two style together</p>
<p>Both:</p>
<pre><code>log.info("Perform operation XXX")
operation()
log.info("Operation XXX is done.")
</code></pre>
<p>But I feel that is kinda verbose, it makes double logging records.  So, here is my question - what is the good logging style?  I would like to know how do you think.</p>
</div>
<div class="post-text" itemprop="text">
<p>I'd typically use two different <a href="https://docs.python.org/3/howto/logging.html#when-to-use-logging" rel="nofollow noreferrer">log levels</a>.</p>
<p>The first one I put on a "debug" level, and the second one on an "info" level. That way typical production machines would only log what's being done, but I can turn on the debug logging and see what it tries to do before it errors out.</p>
</div>
<div class="post-text" itemprop="text">
<p>It all depends what you want to log. If you're interested in the code getting to the point where it's about to do an operation. If you want to make sure the operation succeeded, do it after. If you want both, do both.</p>
</div>
<div class="post-text" itemprop="text">
<p>The latter form:</p>
<pre><code>log.info("Start XXX") 
operation() 
log.info("End XXX") 
</code></pre>
<p>because it provides the most information.</p>
<p>You can turn logging level down obviously, so won't be too verbose under normal operating conditions.</p>
</div>
<div class="post-text" itemprop="text">
<p>Maybe you could use something like a try catch ? Here 's a naive python example :</p>
<pre><code>try :
    operation()
    log.info("Operation XXX is done.")
except Exception:
    log.info("Operation xxx Failed")
    raise Exception() # optional : if you want to propagate failure to another try catch statement and/or crash eventually. 
</code></pre>
<p>Operation will be launched.
If it doesn't fail (no exception raised) you get a success statement in the logs.</p>
<p>If it fails (by raising an exception. Like disc full or whatever you are trying to do), Exception is caught and you get a failure statement.</p>
<p>Log is more meaning full. You get to keep the verbosity to a oneliner and get to know if operation succeeded. Best of all choices.</p>
<p>Oh and you get a hook point where you can add some code to be executed in case of failure.</p>
<p>I hope it help.</p>
</div>
<div class="post-text" itemprop="text">
<p>There's another style that I've seen used in Linux boot scripts and in <code>strace</code>.  It's got the advantages of your combined style with less verbosity, but you've got to make sure that your logging facility isn't doing any buffering.  I don't know <code>log.info</code>, so here's a rough example with <code>print</code>:</p>
<pre><code>print "Doing XXX... ",  # Note lack of newline :)
operation()
print "Done."
</code></pre>
<p>(Since in most cases <code>print</code> uses buffering, using this example verbatim won't work properly. You won't see "Doing XXX" until you see the "Done".  But you get the general idea.)</p>
<p>The other disadvantage of this style is that things can get mixed up if you have multiple threads writing to the same log.</p>
</div>
<span class="comment-copy">I'm not sure how turning down the logging level would help if both messages use the same level.</span>
<span class="comment-copy">I would highly suggest not doing this. What if you want to add logging to <code>operation()</code>? Also, <code>print</code> adds a new line. I know it's just pseudocode, but this wouldn't be easy to implement with any of the logging libraries.</span>
<span class="comment-copy">That's true, you could certainly run into nesting issues.  As for <code>print</code>, AIUI adding the comma at the end suppresses the newline.</span>
