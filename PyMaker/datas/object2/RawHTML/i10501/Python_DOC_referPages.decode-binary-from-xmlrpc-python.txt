<div class="post-text" itemprop="text">
<p>I'm new to python and xml-rpc , and I'm stuck with decoding binary data coming from a public service :</p>
<p>the service request response with this code is :</p>
<pre><code>from xmlrpc.client import Server

import xmlrpc.client  

from pprint import pprint

DEV_KEY = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxx'

logFile = open('stat.txt', 'w')

s1 = Server('http://muovi.roma.it/ws/xml/autenticazione/1')
s2 = Server('http://muovi.roma.it/ws/xml/paline/7')

token = s1.autenticazione.Accedi(DEV_KEY, '')

res = s2.paline.GetStatPassaggi(token)

pprint(res, logFile)
</code></pre>
<p>response :</p>
<pre><code>{'id_richiesta': '257a369dbf46e41ba275f8c821c7e1e0',
 'risposta': {'periodi_aggregazione': &lt;xmlrpc.client.Binary object at 0x0000027B7D6E2588&gt;,
              'tempi_attesa_percorsi': &lt;xmlrpc.client.Binary object at 0x0000027B7D9276D8&gt;}}
</code></pre>
<p>I need to decode these two binary objects , and I'm stuck with this code :</p>
<pre><code>from xmlrpc.client import Server

import xmlrpc.client  

from pprint import pprint

DEV_KEY = 'xxxxxxxxxxxxxxxxxxxxxxxx'

logFile = open('stat.txt', 'w')

s1 = Server('http://muovi.roma.it/ws/xml/autenticazione/1')
s2 = Server('http://muovi.roma.it/ws/xml/paline/7')

token = s1.autenticazione.Accedi(DEV_KEY, '')

res = s2.paline.GetStatPassaggi(token)

dat = xmlrpc.client.Binary(res)
out = xmlrpc.client.Binary.decode(dat)

pprint(out, logFile)
</code></pre>
<p>that ends in :</p>
<blockquote>
<p>Traceback (most recent call last):   File "stat.py", line 18, in
  
      dat = xmlrpc.client.Binary(res)   File "C:\Users\Leonardo\AppData\Local\Programs\Python\Python35\lib\xmlrpc\client.py",
  line 389, in <strong>init</strong>
      data.<strong>class</strong>.<strong>name</strong>) TypeError: expected bytes or bytearray, not dict</p>
</blockquote>
<p>The only doc I found for xmlrpc.client is the one at docs.python.org , but I can't figure out how I could decode these binaries</p>
</div>
<div class="post-text" itemprop="text">
<p>If the content of <code>res</code> variable (what you get from the 2<sup>nd</sup> (<code>s2</code>) server) is the response you pasted into the question, then you should modify the last 3 lines of your 2<sup>nd</sup> snippet to (as you already have 2 <code>Binary</code> objects in the <code>res</code> <em>dictionary</em>):</p>
<pre><code># Existing code
res = s2.paline.GetStatPassaggi(token)

answer = res.get("risposta", dict())
aggregation_periods = answer.get("periodi_aggregazione", xmlrpc.client.Binary())
timeout_paths = answer.get("tempi_attesa_percorsi", xmlrpc.client.Binary())

print(aggregation_periods.data)
print(timeout_paths.data)
</code></pre>
<p><strong>Notes</strong>:</p>
<ul>
<li>According to <a href="https://docs.python.org/3/library/xmlrpc.client.html#binary-objects" rel="nofollow noreferrer">[Python]: Binary Objects</a>:

<blockquote>
<p>Binary objects have the following methods, supported <strong>mainly for internal use</strong> by the marshalling/unmarshalling code:</p>
</blockquote></li>
<li>I wasn't able to connect (and this test the solution), since <code>DEV_KEY</code> is (obviously) fake</li>
</ul>
</div>
<span class="comment-copy">It seems like you are doing the correct call, maybe the problem is on the website? ´TypeError: expected bytes or bytearray, not dict´ ? I would think that you are actually receiving a ´dict´ instead of a ´bytearray´</span>
<span class="comment-copy">yes , I think it's a dict. I'll try to contact website developer</span>
