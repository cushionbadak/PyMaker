<div class="post-text" itemprop="text">
<p>How is it possible to take a CSV file with rows of varying lengths (up to 12 in practice) as input and then output a new CSV file where new rows consist of 
the 0th element of each row + each unique pair of elements (&gt;0th) in alphabetical order?</p>
<p>The original row elements are not in alphabetical order.</p>
<p>Please see image for example input and output.
<a href="http://i.stack.imgur.com/tbQgo.jpg" rel="nofollow">enter image description here</a></p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.python.org/3/library/csv.html#module-csv" rel="nofollow"><code>csv</code></a> for reading &amp; writing and <a href="https://docs.python.org/3.5/library/itertools.html#itertools.combinations" rel="nofollow"><code>itertools.combinations</code></a> for generating the pairs:</p>
<pre><code>import csv
from itertools import combinations

with open('input.csv') as in_f, open('output.csv', 'w') as out_f:
    reader = csv.reader(in_f)
    writer = csv.writer(out_f)

    for row in reader:
        for combination in combinations(sorted(row[1:]), 2):
            writer.writerow(tuple(row[:1]) + combination)
</code></pre>
<p>Output:</p>
<pre><code>0,A,B
1,A,B
1,A,C
1,B,C
2,A,B
2,A,C
2,A,D
2,B,C
2,B,D
2,C,D
</code></pre>
</div>
<span class="comment-copy">Thanks @niemmi ! I'm using python 3.5 so I need to add a newline parameter in open('output.csv', 'w', newline='') as out_f  or else the output.csv file had an empty row between lines  Also, was getting TypeError: a bytes-like object is required, not 'str' so I only used 'w' and 'r' in the open statements.  Everything has worked except the unique pairs are not in alphabetical order.</span>
<span class="comment-copy">@WhyNot: It should work if you change the output file mode from <code>wb</code> to <code>w</code>. I tested the original response on Python 2.7 where things work bit differently but now I updated the answer and tested it on 3.4. I doubt 3.5 would be any different compared to 3.4.</span>
<span class="comment-copy">It works perfectly. The alphabetical sort is placing upper case letters ahead of lower case letters, so 'Zebra' is ordered before 'apple'. This was my confusion. Thanks again @niemmi</span>
