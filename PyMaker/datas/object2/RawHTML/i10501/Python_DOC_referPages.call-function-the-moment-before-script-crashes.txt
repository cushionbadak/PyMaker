<div class="post-text" itemprop="text">
<p>I am solving the following problem:</p>
<p>I have a script which should be running as a service 24/7. Because it is quite important, I would like it to send me an email in case it crashes. I found <a href="https://docs.python.org/3/library/atexit.html" rel="nofollow">atexit</a> module, but the docs specifically says it cannot handle crashes.</p>
<p>So my question is: is there any better way of achieving this than by running another serivce which will be checking if this one is running? Or the goal here is to write the service so that it cannot crash (which is almost impossible)?</p>
<p>Thanks for your ideas!</p>
</div>
<div class="post-text" itemprop="text">
<p>I mean to do what you ask in the first part just wrap the main part of the script with a try/except.</p>
<p>myscript.py:</p>
<pre><code>def main():
   long_running_process()

if __name__ == '__main__':
   try:
       main()
   except:
       send_email()
</code></pre>
</div>
<span class="comment-copy">How crash-y is this crash? Are we talking unhandled exceptions here, or something like a segfault? <code>atexit</code> exit handlers will still run in the case of an unhandled exception.</span>
<span class="comment-copy">You cannot handle all types of crashes, as some of them are "uncatchable" like mentioned segfault, or <code>SIGTERM</code>. What you can do is to use external tool like <a href="http://supervisord.org/index.html" rel="nofollow noreferrer">supervisor</a> which will handle starting/restarting for you and using it's <a href="http://supervisord.org/events.html" rel="nofollow noreferrer">events</a> you may listen for example for processes entering <code>FATAL</code> state to send an e-mail. Embedding mechanisms to monitor process into same process is risky.</span>
<span class="comment-copy">I will look at the supervisor tool, it seems that it is the only correct aproach. Thanks</span>
<span class="comment-copy">In case of a segmentation fault, this has no chance to work.</span>
<span class="comment-copy">yea then like said above you need some service monitor like supervisor, upstart, init.d etc..</span>
