<div class="post-text" itemprop="text">
<p>Hi I would like to execute the following command via shell.</p>
<pre><code> curl -g -d '{ "action": "block_count" }' [::1]:7076
</code></pre>
<p>However when inserted in an os.system call , I get an invalid syntax. What would be the right syntax format.</p>
<pre><code>#!/usr/bin/env python
import os
import json

aba = os.system('curl -g -d '{ "action": "block_count" }' [::1]:7076')

baba = json.loads(aba)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could simply use the <a href="https://docs.python.org/3/tutorial/introduction.html#strings" rel="nofollow noreferrer">triple-quoted string literal</a>, like:</p>
<pre><code>os.system('''curl -g -d '{"action": "block_count"}' [::1]:7076''')
</code></pre>
<p>but even better, use the <strong>right tool for the job</strong>, i.e. <a href="http://docs.python-requests.org/en/master/" rel="nofollow noreferrer"><code>requests</code></a>:</p>
<pre><code>import requests
data = requests.post('[::1]:7076', json={"action": "block_count"}).json()
</code></pre>
<hr/>
<p>If you insist on direct <code>curl</code> command invocation, please use the <a href="https://docs.python.org/3/library/subprocess.html#module-subprocess" rel="nofollow noreferrer"><code>subprocess</code></a> module instead of the old and inflexible <a href="https://docs.python.org/3/library/os.html#os.system" rel="nofollow noreferrer"><code>os.system</code></a> (also unsafe, for inputs not strictly checked). You can use the <a href="https://docs.python.org/3/library/subprocess.html#subprocess.check_output" rel="nofollow noreferrer"><code>subprocess.check_output</code></a> as a <a href="https://docs.python.org/3/library/subprocess.html#replacing-older-functions-with-the-subprocess-module" rel="nofollow noreferrer">replacement in your case</a>. There's no need to execute your <code>curl</code> command in a subshell, so you can split <code>curl</code>'s arguments, like:</p>
<pre><code>import subprocess
output = subprocess.check_output(['curl', '-g', '-d', '{"action": "block_count"}', '-s', '[::1]:7076'])
data = json.loads(output)
</code></pre>
<p>Note that <code>check_output</code> will return the standard output of the command executed (like <code>os.system</code> does), but it'll raise a <a href="https://docs.python.org/3/library/subprocess.html#subprocess.CalledProcessError" rel="nofollow noreferrer"><code>CalledProcessError</code></a> exception in case the command fails with non-zero status, or <a href="https://docs.python.org/3/library/exceptions.html#OSError" rel="nofollow noreferrer"><code>OSError</code></a> exception if the command is not found.</p>
</div>
<div class="post-text" itemprop="text">
<p>You need to escape the single quotes. So change this:</p>
<p><code>aba = os.system('curl -g -d '{ "action": "block_count" }' [::1]:7076')</code></p>
<p>to this:</p>
<p><code>aba = os.system('curl -g -d \'{ "action": "block_count" }\' [::1]:7076')</code></p>
</div>
<span class="comment-copy">Could you include the syntax error you are getting?</span>
<span class="comment-copy">Remember to properly escape nested quote marks.</span>
<span class="comment-copy">Don't use shell out to <code>curl</code> to make an HTTP request; use a Python library like <code>requests</code>.</span>
<span class="comment-copy">Failing that, don't use <code>os.system</code>; use the <code>subprocess</code> module instead.</span>
<span class="comment-copy"><code>os.system()</code> creates problems for you because it needs a string that can be parsed as a shell command. <code>subprocess.call(['curl', '-g', '-d', '{ "action": "block_count" }', '[::1]:7076'])</code> passes each argument as a separate Python string, with no shell involved -- so you don't need to worry about shell-safe quoting.</span>
<span class="comment-copy"><code>subprocess.Popen()</code> without <code>shell=True</code> is an intermediate step that might be worth adding -- better than <code>os.system()</code>, worse (but, perhaps, more broadly applicable) than <code>requests</code>.</span>
<span class="comment-copy">I was in doubt should I mention the <code>subprocess</code> as a replacement for <code>os.system</code>, since I wouldn't recommend neither over <code>requests</code>. But it makes sense to emphasize that <code>os.system</code> is deprecated. I'll add it, thanks.</span>
<span class="comment-copy">or alternatively use bigger quotes for the outside string. <code>'''</code> or <code>"""</code></span>
