<div class="post-text" itemprop="text">
<p>Hi I've searched through Stackoverflow and have been struggling with the following list-related challenge, but as a Python novice I'm stumped.</p>
<p>I currently have 2 lists of test data, one with user info, (both new and old user ID followed by name data) and the other a list of lists with user and page numbers (eeIDlist). I want to check if the page numbers associated with a particular user matches either the new or old ID , and if either ID matches, append the page numbers back to the original list.</p>
<p>I've gotten as far as matching and appending a list to the CompanyName list, but the list seems to grown exponentially and represents all of the user page data, rather than just the page numbers associated with the individuals.</p>
<p>Advice warmly welcomed!</p>
<p>My code is as follows:</p>
<pre><code>pagenumbers=[]

for i in CompanyNameList:

    for ee in i:
        for eeid in eeIDlist:
            try:
                if (str(eeid[1]) in ee):
                    pagenumbers.extend([eeid[0]]) 
                    i.append(pagenumbers)
                    i.append([eeid[0]])
            except ValueError:
                print "Not a valid number"

print i
</code></pre>
<p>My source data is as follows:</p>
<pre><code>CompanyNameList:

[['144128', '40013', 'John', 'Dodge', 'F', 'DODGEJ'],['144130', '40023', 'John', 'Apple', 'Z', 'APPLEJ'],['144131', '40050', 'Gerald', 'Key', 'M', 'KEYG'],['144138', '40074', 'Saul', 'VanWinkle', 'VANWINKLE']] 
</code></pre>
<p>UserID and Page Number
eeIDlist:</p>
<pre><code>[[144128,1],[144138,12],[144130,6],[144131,9],[40013,153],[40074,310],[40023, 210], 
[40050,250]] 
</code></pre>
<p>Desired Output List:</p>
<pre><code>[['144128', '40013', 'John', 'Dodge', 'F', 'DODGEJ',[1,153]],
['144130', '40023', 'John', 'Apple', 'Z', 'APPLEJ',[6,210]], 
['144131', '40050', 'Gerald', 'Key', 'M', 'KEYG',[9,250]],
['144138', '40074', 'Saul', 'VanWinkle', 'VANWINKLE',[12,310]]]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You have some errors in your code. </p>
<ul>
<li><p>You don't need the loop <code>for ee in i</code>. You want to check if '123214' <code>in</code> <code>['144128', '40013', 'John', 'Dodge', 'F', 'DODGEJ']</code> for example not if <code>123214</code> in <code>'144128'</code>, and in <code>'40013'</code>, and in <code>'John'</code>, etc.</p></li>
<li><p>Also, you don't need <code>i.append([eeid[0]])</code> since you are dealing with <code>pagenumbers</code>, and that's enough; you don't want duplicates in your results.</p></li>
<li><p>Moreover, <code>pagenumbers</code> should be appended outside the <code>for</code> loop. Otherwise, you would get more than one list appended.</p></li>
</ul>
<p>Following is a code that fixes errors of your code:</p>
<pre><code>CompanyNameList = [
    ['144128', '40013', 'John', 'Dodge', 'F', 'DODGEJ'],
    ['144130', '40023', 'John', 'Apple', 'Z', 'APPLEJ'],
    ['144131', '40050', 'Gerald', 'Key', 'M', 'KEYG'],
    ['144138', '40074', 'Saul', 'VanWinkle', 'VANWINKLE']]

eeIDlist = [[144128,1],
            [144138,12],
            [144130,6],
            [144131,9],
            [40013,153],
            [40074,310],
            [40023, 210], 
            [40050,250]] 

pagenumbers=[]

for i in CompanyNameList:
    for eeid in eeIDlist:
        try:
            # eeid[0] not eeid[1] 
            if (str(eeid[0]) in i): 
                # eeid[1] not eeid[0]
                pagenumbers.extend([eeid[1]])
        except ValueError:
            print ("Not a valid number")
    i.append(pagenumbers)
    pagenumbers = []

print CompanyNameList
</code></pre>
<p>Output:</p>
<pre><code>[['144128', '40013', 'John', 'Dodge', 'F', 'DODGEJ', [1, 153]], 
 ['144130', '40023', 'John', 'Apple', 'Z', 'APPLEJ', [6, 210]], 
 ['144131', '40050', 'Gerald', 'Key', 'M', 'KEYG', [9, 250]], 
 ['144138', '40074', 'Saul', 'VanWinkle', 'VANWINKLE', [12, 310]]]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Here's some code that does the trick (although it's not the most <em>python</em>ic):</p>
<pre><code>from pprint import pprint as pp

company_name_list = [['144128', '40013', 'John', 'Dodge', 'F', 'DODGEJ'],
                     ['144130', '40023', 'John', 'Apple', 'Z', 'APPLEJ'],
                     ['144131', '40050', 'Gerald', 'Key', 'M', 'KEYG'],
                     ['144138', '40074', 'Saul', 'VanWinkle', 'VANWINKLE']]

id_page_list = [[144128, 1],
                [144138, 12],
                [144130, 6],
                [144131, 9],
                [40013, 153],
                [40074, 310],
                [40023, 210],
                [40050, 250]]


if __name__ == "__main__":
    id_str_page_list = [[str(item[0]), item[1]] for item in id_page_list]
    for employee in company_name_list:
        pages_list = list()
        for id_page in id_str_page_list:
            if id_page[0] == employee[0] or \
                    id_page[0] == employee[1]:
                pages_list.append(id_page[1])
        if pages_list:
            employee.append(pages_list)

    pp(company_name_list)
</code></pre>
<p><strong>Notes</strong>:</p>
<ul>
<li>I converted the integer ids from <code>id_str_page</code> to strings and saved them into <code>id_str_page_list</code> using <a href="https://docs.python.org/3/tutorial/datastructures.html#list-comprehensions" rel="nofollow noreferrer">[Python]: List Comprehensions</a> to do all the conversions at once</li>
<li>Then I iterate on each employee and if one of its <em>id</em>s is found on the 2<sup>nd</sup> list on the 1<sup>st</sup> position, I "save" page number in another list, which at the end (if not empty) I append it to the employee list</li>
<li>I renamed some of the variables to be <a href="https://www.python.org/dev/peps/pep-0008" rel="nofollow noreferrer">[Python]: PEP 8 -- Style Guide for Python Code</a> compliant</li>
</ul>
<p><strong>Output</strong>:</p>
<blockquote>
<pre><code>c:\Work\Dev\StackOverflow\q47257333&gt;"c:\Work\Dev\VEnvs\py35x64_test\Scripts\python.exe" a.py
[['144128', '40013', 'John', 'Dodge', 'F', 'DODGEJ', [1, 153]],
 ['144130', '40023', 'John', 'Apple', 'Z', 'APPLEJ', [6, 210]],
 ['144131', '40050', 'Gerald', 'Key', 'M', 'KEYG', [9, 250]],
 ['144138', '40074', 'Saul', 'VanWinkle', 'VANWINKLE', [12, 310]]]
</code></pre>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>You could also turn the <strong>eeIDlist</strong> into a dictionary which would make searching it a lot faster. This would also let you perform the entire operation in one line:</p>
<pre><code>eeIDdict = dict(eeIDlist)
[j.append([eeIDdict[int(k)] for k in j[0:2]]) for j in CompanyNameList]
</code></pre>
<p>Now we have:</p>
<pre><code>CompanyNameList = 
[['144128', '40013', 'John', 'Dodge', 'F', 'DODGEJ', [1, 153]],
['144130', '40023', 'John', 'Apple', 'Z', 'APPLEJ', [6, 210]],
['144131', '40050', 'Gerald', 'Key', 'M', 'KEYG', [9, 250]],
['144138', '40074', 'Saul', 'VanWinkle', 'VANWINKLE', [12, 310]]]
</code></pre>
<p>As required.</p>
</div>
<div class="post-text" itemprop="text">
<p>I have corrected your code</p>
<pre><code>CompanyNameList = [['144128', '40013', 'John', 'Dodge', 'F', 'DODGEJ'],['144130', '40023', 'John', 'Apple', 'Z', 'APPLEJ'],['144131', '40050', 'Gerald', 'Key', 'M', 'KEYG'],['144138', '40074', 'Saul', 'VanWinkle', 'VANWINKLE']]
eeIDlist = [[144128,1],[144138,12],[144130,6],[144131,9],[40013,153],[40074,310],[40023, 210], [40050,250]]

for CompanyName in CompanyNameList:
    pageList = []
    newID = int(CompanyName[0])
    oldID = int(CompanyName[1])
    for eeID in eeIDlist:
        if eeID[0] == newID or eeID[0] == oldID:
            pageList.append(eeID[1])
    CompanyName.append(pageList)

print(CompanyNameList)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I agree with Robbie that <code>eeIDlist</code> should be a dict... but otherwise, here's a solution using your lists.</p>
<pre><code>for c in CompanyNameList:
    c.append([
        next(e[1] for e in eeIDlist if e[0] == int(c[0])),
        next(e[1] for e in eeIDlist if e[0] == int(c[1])),
    ])
    print(c)
</code></pre>
<p>The use of <code>next()</code> with a generator means the list stops being search as soon as a match is found.</p>
</div>
<span class="comment-copy">What is the purpose of <code>i.append(pagenumbers)</code>? That code is bad news, you're appending multiple references to a list that's expanding.</span>
<span class="comment-copy">thanks for taking the time to answer my question, your answer and detailed explanation was very helpful.</span>
<span class="comment-copy">It's more useful if you explain why it's fixed and how you've done it. That way, people with similar but not the exact same issue will be able to correct theirs and the OP will understand the issue to prevent in repeating</span>
