<div class="post-text" itemprop="text">
<p>I am importing stock data in python from yahoo. </p>
<pre><code>import pandas as pd
import numpy as np
from pandas_datareader import data
from datetime import date
from datetime import timedelta

def Get_Historic_SP(ticker):
    end_date = date.today()
    start_end = end_date - timedelta(weeks=260)
    df = data.DataReader(ticker, data_source='yahoo',start=start_date, end=end_date)
    df.index = pd.to_datetime(df.index)
    df.reset_index().rename(columns={df.index.name:'Date'})
    return df['Close']
</code></pre>
<p>This works well. I would like to do this for multiple codes and create one dataframe with the companies in columns. Also each column to have ticker (comps) as the title. </p>
<p>I am using:</p>
<pre><code>    comps = ['AVON.L', 'BYG.L']
</code></pre>
<p>example</p>
<pre><code>    Date         AVON.L    BYG.L
    20/03/2019   193       980
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Fixing your code as follows:</p>
<pre><code>import pandas as pd
import numpy as np
from pandas_datareader import data
from datetime import date
from datetime import timedelta

def Get_Historic_SP(ticker, start_date):
    end_date = date.today()
    start_end = end_date - timedelta(weeks=260)
    df = data.DataReader(ticker, data_source='yahoo',start=start_date, end=end_date)
    df.index = pd.to_datetime(df.index)
    df.reset_index().rename(columns={df.index.name:'Date'})
    return df['Close']
</code></pre>
<p>You can use the following code that first creates a dictionary and then converts it to a DataFrame:</p>
<pre><code>tickers = ['googl', 'aapl']

ticker_dict = {}
for ticker in tickers:
    ticker_dict[ticker] = Get_Historic_SP(ticker, date(2019,3,1))

df = pd.DataFrame(ticker_dict)
</code></pre>
</div>
<span class="comment-copy">What is <i>this</i>? Could you explain what you are trying to do.</span>
<span class="comment-copy">I can get historical stock price data from yahoo easier enough (the first set of code). But struggling to put multiple calls of the function - Get_Historic_SP - into a pandas dataframe</span>
<span class="comment-copy">You code example cant execute, you are missing a timedelta import from datetime, and your function does not take start_date as an input.</span>
