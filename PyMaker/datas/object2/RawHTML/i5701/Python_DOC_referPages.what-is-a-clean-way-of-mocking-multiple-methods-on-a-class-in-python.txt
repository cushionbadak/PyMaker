<div class="post-text" itemprop="text">
<p>When writing tests I am often faced with the needed to mock several class methods. Currently I am doing this by nesting <code>with</code> statements contain the <code>mock</code> references e.g.</p>
<pre><code>from ... import A


def test_sample(self)
    instance = A()
    with mock(A, 'function_1', return_value=1):
        with mock(A, 'function_2', return_value=2):
            with mock(A, 'function_3', return_value=3):
                assert A.function_4, 10
</code></pre>
<p>Is there a neater / recommended way of doing this? It would be nice to be able to remove several nested calls!</p>
<p>During this process there may or may not be other methods on the class that are not mocked.</p>
</div>
<div class="post-text" itemprop="text">
<p>You don't need to have nested context managers - you can patch all the methods in one go:</p>
<pre><code>def test_sample(self)
    instance = A()
    with (mock(A, 'function_1', return_value=1),
          mock(A, 'function_2', return_value=2),
          mock(A, 'function_3', return_value=3)):

         assert A.function_4, 10
</code></pre>
<p>Alternatively you can use <a href="https://docs.python.org/3/library/unittest.mock.html#patch-multiple" rel="nofollow noreferrer"><code>patch.multiple</code></a>:</p>
<pre><code>from unittest import patch

def test_sample(self)
    instance = A()
    with patch.multiple(A, function_1=2, function_2=2, function_3=3) as patched_values:
        assert A.function_4, 10
</code></pre>
</div>
<span class="comment-copy">Are there other methods in <code>A</code> that will run in the test, that are not being mocked?</span>
<span class="comment-copy">Thanks @solarissmoke I have updated the question to add that there may or may not be non-mocked methods</span>
