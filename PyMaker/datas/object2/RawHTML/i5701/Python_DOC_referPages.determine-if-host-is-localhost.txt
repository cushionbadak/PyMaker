<div class="post-text" itemprop="text">
<p>I have a string <code>host</code> which can be a hostname (without domain), ipv4 address or ipv6 address.</p>
<p>Is there a simple way to determine if this refers to <code>localhost</code> loop-back device?</p>
<p>Python Version: 2.7</p>
</div>
<div class="post-text" itemprop="text">
<p>You could check if IP address of the inputted host within <a href="https://en.wikipedia.org/wiki/Localhost" rel="nofollow noreferrer">loopback address block</a>, <code>127.0.0.0/8</code> for IPv4, <code>::1</code> for IPv6:</p>
<pre><code>import socket
import struct

def is_loopback(host):
    loopback_checker = {
        socket.AF_INET: lambda x: struct.unpack('!I', socket.inet_aton(x))[0] &gt;&gt; (32-8) == 127,
        socket.AF_INET6: lambda x: x == '::1'
    }
    for family in (socket.AF_INET, socket.AF_INET6):
        try:
            r = socket.getaddrinfo(host, None, family, socket.SOCK_STREAM)
        except socket.gaierror:
            return False
        for family, _, _, _, sockaddr in r:
            if not loopback_checker[family](sockaddr[0]):
                return False
    return True

for host in ('localhost', 'alias-of-localhost', 'google.com'):
    print host, is_loopback(host)
</code></pre>
<p>yields:</p>
<pre><code>localhost True
alias-of-localhost True
google.com False
</code></pre>
<hr/>
<p>Update: there is <a href="https://pypi.python.org/pypi/py2-ipaddress" rel="nofollow noreferrer">a python2 backport</a> of python3 <code>ipaddress</code> library, you could replace checker part with checking against its <code>.is_loopback</code> property, internal logic is the same.</p>
</div>
<div class="post-text" itemprop="text">
<p>try this on Unix:</p>
<h3>you need the subprocess module to find out the local hostname</h3>
<p>import subprocess</p>
<p>hn = subprocess.Popen(['hostname'], stdout=subprocess.PIPE)
hn_out = hn.stdout.readline().strip('\n')</p>
<h3>Test if "host" string is the IPv4 loop back address, IPv6 loop back address or if it's the local host name</h3>
<p>if host == '127.0.0.1' or host == '::1' or host == hn_out:
    print("It's localhost")</p>
</div>
<span class="comment-copy">What is the value of <code>host</code> when working with localhost?</span>
<span class="comment-copy"><a href="https://docs.python.org/3/library/ipaddress.html" rel="nofollow noreferrer">docs.python.org/3/library/ipaddress.html</a> ipaddress library has is_loopback method. This might help!</span>
<span class="comment-copy">@AndyG The value of "host" is the value you see with <code>uname -a</code>. It is hostname without domain.</span>
<span class="comment-copy">@VivekHarikrishnan we are still on Python2.7. AFAIK the ipaddress library is from Python3</span>
<span class="comment-copy">Yes, this works (the library). Thank you for the hint that there is the library <code>ipaddress</code> even for Python2!</span>
<span class="comment-copy">I am unsure whether 127.0.0.2 is localhost, too.</span>
<span class="comment-copy">I already have the string "host". I guess the subprocess part of your answer is not needed.</span>
<span class="comment-copy">"<i>I am unsure whether 127.0.0.2 is localhost, too.</i>" @guettli see the answer to <a href="https://networkengineering.stackexchange.com/q/44635/8499">this question</a>.</span>
