<div class="post-text" itemprop="text">
<p>I have FTP code which I'm testing with <code>__name__ == '__main__'</code> method which works in certain condition and fails on other. This is basically doing FTP to a site with user name password and then traverse into a Directory where we need to inlist the files using <code>ftplib</code> module. Along with I have kept the exception handling if could not find the Files in the Dir path then come with a error.</p>
<pre><code>#!/usr/bin/python3
import ftplib
from ftplib import FTP

def FtpMirroList():
  with FTP("ftp.rraka.com") as ftp:
    ftp.login("rar1", "Hf090rFD")
    ftp.cwd("mirror/Nimble/1522_rc/optimize_gather/")
    #ftp.retrlines('LIST')
    try:
      FileList = ftp.retrlines('LIST')
    except ftplib.error_perm as resp:
      if str(resp) == "550 No files found":
        print("No files in this directory")
      else:
        raise

def main():
  for files in FtpMirroList():
    print(files)

#main()
if __name__ == '__main__':
  FtpMirroList()
</code></pre>
<p>When I execute this without <code>main()</code> which I have hashed in the code then it runs fine.</p>
<pre><code>$ ./ftplib-example-4.py
total 19535864
-rw-r--r-- 1   rar1       ftpsecure 9963085277 Jan 09 07:09 15.22.s039.20180109-043530_pslv3.tar.gz
-rw-rw-r-- 1   rar1       ftpsecure 387     Jan 09 06:02 15.22.s039.20180109-043530_pslv3.tar.gz.README
-rw-rw-r-- 1   rar1       ftpsecure 9963166015 Jan 09 14:08 15.22.s039.20180109-164514_pslv3.tar.gz
-rw-rw-r-- 1   rar1       ftpsecure 387     Jan 09 14:11 15.22.s039.20180109-164514_pslv3.tar.gz.README
</code></pre>
<p>If I will run this code with <code>main()</code> then it will produce the Error for <code>'NoneType' object</code> as follows:</p>
<pre><code>Traceback (most recent call last):
  File "./ftplib-example-4.py", line 22, in &lt;module&gt;
    main()
  File "./ftplib-example-4.py", line 19, in main
    for files in FtpMirroList():
TypeError: 'NoneType' object is not iterable
</code></pre>
<p>Please advise best practice to use with  <code>__name__ == '__main__'</code> method while using with functions and calling <code>main()</code>.</p>
<blockquote>
<p>What i see there is no need of the second function... after editing it
  works as expected</p>
</blockquote>
<pre><code>  #!/usr/bin/python3
    import ftplib
    from ftplib import FTP

    def FtpMirroList():
      with FTP("ftp.rraka.com") as ftp:
        ftp.login("rar1", "Hf090rFD")
        ftp.cwd("mirror/Nimble/1522_rc/optimize_gather/")
        #ftp.retrlines('LIST')
        try:
          FileList = ftp.retrlines('LIST')
        except ftplib.error_perm as resp:
          if str(resp) == "550 No files found":
            print("No files in this directory")
          else:
            raise
        for files in FileList:
          print(files)

    if __name__ == '__main__':
      FtpMirroList()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I got it corrected another way using through <code>return</code> keyword in the main function <code>FtpMirroList</code> and lastly calling it through <code>if __name__ == '__main__':</code> and that works as expected.</p>
<pre><code>  #!/usr/bin/python3
    import ftplib
    from ftplib import FTP

    def FtpMirroList():
      with FTP("ftp.rraka.com") as ftp:
        ftp.login("rar1", "Hf090rFD")
        ftp.cwd("mirror/Nimble/1522_rc/optimize_gather/")
        #ftp.retrlines('LIST')
        try:
          FileList = ftp.retrlines('LIST')
        except ftplib.error_perm as resp:
          if str(resp) == "550 No files found":
            print("No files in this directory")
          else:
            raise
        for files in FileList:
          return files

    if __name__ == '__main__':
      FtpMirroList()
</code></pre>
</div>
<span class="comment-copy"><code>for files in FtpMirroList()</code> - that's the line <b><i>with the error</i></b> (the exception says exactly what kind of error), so if you don't call it (with <code>main()</code>, since it's in the function called "main"..), the error "won't occur". The practice is to identify and fix broken code. (Hint: what does <code>FtpMirrorList</code> return?)</span>
<span class="comment-copy">@user2864740 ..So if that to remov ethen how to list the files?</span>
<span class="comment-copy">Start here at <a href="https://docs.python.org/3/tutorial/" rel="nofollow noreferrer">docs.python.org/3/tutorial</a> and <a href="https://stackoverflow.com/tags/python-3.x/info">stackoverflow.com/tags/python-3.x/info</a> and <a href="https://www.learnpython.org/" rel="nofollow noreferrer">learnpython.org</a> - there are several concepts to learn, have a good time!</span>
<span class="comment-copy">@user2864740 .. its working if hash the <code>main()</code> i i saw in my code.. i'm already reading over the pyton doc</span>
<span class="comment-copy">When you "hash the main()" it is commenting the line so <b>the code is not calling the main() function</b>. And the error <b>is in the main() function</b>. Skipping the main function and calling the FtpMirrorList function directly bypasses <i>that</i> error. See the links above: Python is doing <i>exactly</i> what it has been told to do.</span>
