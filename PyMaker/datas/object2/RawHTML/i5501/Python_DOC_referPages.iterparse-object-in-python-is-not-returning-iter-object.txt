<div class="post-text" itemprop="text">
<p>I'm working with the XML file in this <a href="https://www.grants.gov/web/grants/xml-extract.html?p_p_id=xmlextract_WAR_grantsxmlextractportlet_INSTANCE_5NxW0PeTnSUa&amp;p_p_lifecycle=2&amp;p_p_state=normal&amp;p_p_mode=view&amp;p_p_cacheability=cacheLevelPage&amp;p_p_col_id=column-1&amp;p_p_col_pos=1&amp;p_p_col_count=2&amp;download=GrantsDBExtract20180104v2.zip" rel="nofollow noreferrer">link</a> (Downloadable file of 40MB). In this file, I'm expecting data from 2 types of tags. </p>
<p>Those are: <code>OpportunityForecastDetail_1_0</code> and <code>OpportunitySynopsisDetail_1_0</code>. </p>
<p>I wrote the following code for that:</p>
<pre><code>ARTICLE_TAGS = ['OpportunitySynopsisDetail_1_0', 'OpportunityForecastDetail_1_0']

for _tag in ARTICLE_TAGS:
    f = open(xml_f)
    context = etree.iterparse(f, tag = _tag)

    for _, e in context:
        _id = e.xpath('.//OpportunityID/text()')
        text = e.xpath('.//OpportunityTitle/text()')
    f.close()
</code></pre>
<p>Then <code>etree.iterparse(f, tag = _tag)</code> is returning an object which is not iterable. I think this occurs when the tag is not found in the XML file.</p>
<p>So, I added name spaces to the iterable tag like this.</p>
<pre><code>context = etree.iterparse(f, tag='{http://apply.grants.gov/system/OpportunityDetail-V1.0}'+_tag)
</code></pre>
<p>Now, it is creating an iterable object. But, I'm not getting any text. I tried other namespaces in that file. But, not working.</p>
<p>Please tell me the solution to this problem. This is a sample snippet of the XML file. <code>OpportunityForecastDetail_1_0</code> and <code>OpportunitySynopsisDetail_1_0</code> tags are repeated n number of times in the XML file.</p>
<pre><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Grants xsi:schemaLocation="http://apply.grants.gov/system/OpportunityDetail-V1.0 https://apply07.grants.gov/apply/system/schemas/OppotunityDetail-V1.0.xsd" xmlns="http://apply.grants.gov/system/OpportunityDetail-V1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instace"&gt;
&lt;OpportunitySynopsisDetail_1_0&gt;
&lt;OpportunityID&gt;262148&lt;/OpportunityID&gt;
&lt;OpportunityTitle&gt;Establishment of the Edmund S. Muskie Graduate Internship Program&lt;/OpportunityTitle&gt;
&lt;/OpportunitySynopsisDetail_1_0&gt;
&lt;OpportunityForecastDetail_1_0&gt;
&lt;OpportunityID&gt;284765&lt;/OpportunityID&gt;
&lt;OpportunityTitle&gt;PPHF 2015: Immunization Grants-CDC Partnership: Strengthening Public Health Laboratories-financed in part by 2015 Prevention and Public Health Funds&lt;/OpportunityTitle&gt;
&lt;/OpportunityForecastDetail_1_0&gt;
&lt;/Grants&gt;
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>First, when you are parsing XML that contains namespaces, you must use those namespaces when looking at tag names.<br/>
Second, <code>iterparse</code> doesn't take an argument named <code>tag</code>, so I don't see how your code could have worked as posted.
Finally, the elements returned from <code>iterparse</code> don't have a member function called <code>xpath</code>, so that can't have worked either.</p>
<p>Here is an example of how to parse XML using <code>iterparse</code>:</p>
<pre><code>NS='{http://apply.grants.gov/system/OpportunityDetail-V1.0}'
ARTICLE_TAGS = [NS+'OpportunitySynopsisDetail_1_0', NS+'OpportunityForecastDetail_1_0']

with open(xml_f, 'r') as f:
    context = etree.iterparse(f)

    for _, e in context:
    if e.tag  in ARTICLE_TAGS:
        _id = e.find(NS+'OpportunityID')
        text = e.find(NS+'OpportunityTitle')
        print(_id.text, text.text)
</code></pre>
<p>As I said in my comment, the <a href="http://docs.python.org/3/library/xml.etree.elementtree.html" rel="nofollow noreferrer">Python documentation</a> is helpful, as is the <a href="http://effbot.org/zone/element-index.htm" rel="nofollow noreferrer">Effbot page on ElementTree</a>.  There are lots of other resources available; put <code>xml.etree.elementtree</code> into Google and start reading!</p>
</div>
<span class="comment-copy">Include a minimal but meaningful snippet of your 40 MB XML file in your question. A) Nobody downloads a file that large just to understand what your question is about. B) When the link goes away in the future, nobody can even download a file figure out what you question is about.</span>
<span class="comment-copy">@Tomalak Thank you. Edited the question.</span>
<span class="comment-copy">There are a number of problems here; you are not using the iterparse function correctly - see <a href="https://docs.python.org/3/library/xml.etree.elementtree.html" rel="nofollow noreferrer">docs.python.org/3/library/xml.etree.elementtree.html</a> for documentation, or <a href="http://effbot.org/zone/element-index.htm" rel="nofollow noreferrer">effbot.org/zone/element-index.htm</a> for more tutorials and links.</span>
