<div class="post-text" itemprop="text">
<p>Suppose I have a tab-delineated .txt file like this:</p>
<p><a href="https://i.stack.imgur.com/mMD5i.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/mMD5i.png"/></a></p>
<p>And I want to collapse columns 1-5 so that for a given unique combination (i.e.: a-b-c-d-e), all of the values associated with that unique combination (column 6; in this case for the combination a-b-c-d-e, the associated values are f,g,h) are displayed while that unique combination is only displayed once. </p>
<p>Here's what I'm trying to accomplish :</p>
<p><a href="https://i.stack.imgur.com/oL5lX.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/oL5lX.png"/></a></p>
<p>What would the python script look like to accomplish this (if possible)?</p>
</div>
<div class="post-text" itemprop="text">
<p>Use Python's <code>groupby</code> function to spot changes in the first 5 cells as follows:</p>
<pre><code>from itertools import groupby
import csv

group = 5

with open('input.txt', 'rb') as f_input, open('output.txt', 'wb') as f_output:
    csv_input = csv.reader(f_input, delimiter='\t')
    csv_output = csv.writer(f_output, delimiter='\t')

    for k, g in groupby(csv_input, lambda x: x[:group]):
        csv_output.writerow(next(g))
        for row in g:
            csv_output.writerow([''] * group + row[group:])
</code></pre>
<p>Giving you an output file:</p>
<pre><code>a   b   c   d   e   f
                    f
                    g
                    h
1   2   3   4   5   z
                    y
                    t
</code></pre>
<p>Note: This assumes you are using Python 2.x</p>
</div>
<span class="comment-copy">I guess it will contain some Python keywords like <code>for</code>, <code>in</code>, etc. :)</span>
<span class="comment-copy">It's a big file? Performance matters? What have your try?</span>
<span class="comment-copy">I'd say "Welcome to Stack Overflow", but I see you've been here long enough to get 6 medals.  You should probably already know that most people won't do the program for you, but are willing to help you with the work you've done.  Here's some hints.  You'll want to look into <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">csv</a> for reading and writing, and <a href="https://docs.python.org/3/howto/sorting.html#key-functions" rel="nofollow noreferrer">sorting with a special key</a> to handle sorting the way you want.</span>
<span class="comment-copy">@ScottMermelstein, yea! <a href="https://stackoverflow.com/help/badges/38/peer-pressure?userid=8792060">peer pressure</a> included</span>
<span class="comment-copy">Note, this assumes that the file is already sorted.  The sample data seems to be sorted, but the OP did not explicitly say that it is.</span>
