<div class="post-text" itemprop="text">
<p>I am running the command <code>netsh wlan show interfaces</code> from Python using <code>subprocess.check_output</code> and collecting it in a variable.</p>
<pre><code>a = subprocess.check_output(["netsh","wlan","show","interfaces"])
</code></pre>
<p>And it is giving me output as:</p>
<pre><code>&gt;&gt;&gt; print a
&gt;&gt;&gt; \r\nThere is 1 interface on the system: \r\n\r\n    Name                   : Wireless Network Connection\r\n    Description            : Ralink RT3290 802.11bgn Wi-Fi Adapter\r\n    GUID                   : 77cbe2d6-1a1e-41e7-be0a-3f18689c9ceb\r\n    Physical address       : c0:38:96:92:b7:1d\r\n    State                  : connected\r\n    SSID                   : PenguinWiFi\r\n    BSSID                  : 6c:72:20:d2:f9:21\r\n    Network type           : Infrastructure\r\n    Radio type             : 802.11n\r\n    Authentication         : WPA2-Personal\r\n    Cipher                 : CCMP\r\n    Connection mode        : Auto Connect\r\n    Channel                : 11\r\n    Receive rate (Mbps)    : 72\r\n    Transmit rate (Mbps)   : 72\r\n    Signal                 : 100% \r\n    Profile                : PenguinWiFi \r\n\r\n    Hosted network status  : Not available\r\n\r\n'
</code></pre>
<p>I want to get the status of wlan from this output as <code>"connected"</code> or <code>"not connected"</code>. </p>
<p>For that I want to convert the above string into dictionary and want to use <code>"state"</code> as a key so that I can get the value from a key and decide whether <code>wlan</code> is connected or not connected.</p>
<p>But when I am converting it to a dictionary its giving error something like this:</p>
<pre><code>&gt;&gt;&gt; a_dict = dict(a)

Traceback (most recent call last):
  File "&lt;pyshell#4&gt;", line 1, in &lt;module&gt;
    a_dict = dict(a)
ValueError: dictionary update sequence element #0 has length 1; 2 is required
</code></pre>
<p>I am not getting what is the real problem, its with the string or something else?</p>
</div>
<div class="post-text" itemprop="text">
<p>Why don't simply use regex like:</p>
<pre><code>&gt;&gt;&gt; re.search('State\s+: (\w+)', a).group(1)
'connected'
&gt;&gt;&gt; 
</code></pre>
<hr/>
<p>If it's needed to covert it to a dict, use <a href="http://docs.python.org/3/library/re.html#re.split" rel="nofollow"><code>re.split()</code></a> with some <a class="post-tag" href="/questions/tagged/magic" rel="tag" title="show questions tagged 'magic'">magic</a> like this:</p>
<pre><code>&gt;&gt;&gt; dict(map(str.strip, re.split('\s+:\s+', i)) 
         for i in a.strip().splitlines() if i.startswith('    '))

{'State': 'connected',
 'Hosted network status': 'Not available',
 'Network type': 'Infrastructure',
 'Physical address': 'c0:38:96:92:b7:1d', 
 'GUID': '77cbe2d6-1a1e-41e7-be0a-3f18689c9ceb',
 'Authentication': 'WPA2-Personal',
 'Description': 'Ralink RT3290 802.11bgn Wi-Fi Adapter',
 'Radio type': '802.11n',
 'Signal': '100%',
 'Connection mode': 'Auto Connect',
 'SSID': 'PenguinWiFi',
 'Channel': '11',
 'Profile': 'PenguinWiFi',
 'BSSID': '6c:72:20:d2:f9:21',
 'Name': 'Wireless Network Connection',
 'Cipher': 'CCMP', 'Receive rate (Mbps)': '72',
 'Transmit rate (Mbps)': '72'}


&gt;&gt;&gt; dict(map(str.strip, re.split('\s+:\s+', i)) 
         for i in a.strip().splitlines() if i.startswith('    '))['State']

'connected'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p>I am not getting what is the real problem, its with the string or something else? </p>
</blockquote>
<p>You can't just convert a string to a dictionary, even if the string reads like one to a human.</p>
<p>You're going to have to parse that string and pluck the (key, value) pairs from it.</p>
<p>The key would be e.g. "Physical address" and the value "c0:38:96:92:b7:1d"</p>
<h2>netsh has an XML output which is computer readable</h2>
<blockquote>
<p>The Netsh commands for the Windows Filtering Platform (WFP) enable you
  The tool then exports the collected data into an XML file
  that you can examine for clues to the cause of the problem.</p>
</blockquote>
<p>Why not use the <a href="https://technet.microsoft.com/en-us/library/dd735538(v=ws.10).aspx" rel="nofollow noreferrer">XML output</a> instead of fragile hacks that may stop working at the tiniest console output format change?</p>
<pre><code>netsh wlan export profile folder="PATH_TO_FOLDER" name=PROFILENAME
</code></pre>
<p>This ought to give you a computer readable file, easily traversable with <a href="https://stackoverflow.com/questions/1912434/how-do-i-parse-xml-in-python">Python numerous XML tools</a>.</p>
<h2>Forming dicts from a list of pairs</h2>
<blockquote>
<p>ValueError: dictionary update sequence element #0 has length 1; 2 is
  required</p>
</blockquote>
<p>This is because <code>dict</code> expected a list of (key, value) pairs from which to form a dict. (key, value) has a length of 2 (it's a pair)</p>
<p>e.g.</p>
<pre><code>&gt;&gt;&gt; dict([('a', 1), ('b', 2)])
{'a': 1, 'b': 2}
</code></pre>
</div>
<span class="comment-copy">I got the string directly using regex. Thanks for detailed description.. :)</span>
<span class="comment-copy">Thanks a lot bakkal, the description you gave is very good..!</span>
