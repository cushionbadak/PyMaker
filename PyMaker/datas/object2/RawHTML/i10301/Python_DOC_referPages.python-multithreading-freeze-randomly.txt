<div class="post-text" itemprop="text">
<p>I'm writing a script that's supposed to get some pictures from a very large amount or websites. First time using multithreading, think it is required here so get an okay runtime. So the Problem: The script runs, but after a seemingly random amount of passed websites it just doesn't continue any more. It doesn't totally freeze tho, the time just goes up from what feels like 1/100 of a sec. to several minutes or so, sometimes so long id just close it instead. Also it doesn't seem like some of the websites are responsible in particular, sometimes it get 970, the only 200 entries. Here the relevant parts of the code:</p>
<pre><code>concurrent = 200
q = Queue(concurrent * 2)

def main(listPath, usagePath, idListPath):
    [...]
    for i in range(concurrent):
        t = Thread(target=work)
        t.daemon = True
        t.start()
    try: 
        for code in usedIDs:
            q.put(code)
        q.join()

    except KeyboardInterrupt:
        sys.exit(1)


def work():
    while True:
        code = q.get()
        picture = getPicture(code)
        if picture is None:
            pass  # todo: find other source or default
        if not code in usage.keys():
            usage[code] = list()
        usage[code].append(picture)
        q.task_done()
</code></pre>
<p>Hope i got all the important code there. Thanks in advance! </p>
</div>
<div class="post-text" itemprop="text">
<p>My bad guys, the problem was actually in the getPicture function. Thanks for the answers anyways!</p>
</div>
<span class="comment-copy">For this kind of task I would prefer using <a href="https://docs.python.org/3/library/multiprocessing.html#multiprocessing.pool.Pool" rel="nofollow noreferrer">Pool</a> from <a href="https://docs.python.org/3/library/multiprocessing.html#module-multiprocessing.dummy" rel="nofollow noreferrer">multiprocessing.dummy</a> (which uses threads) because it is easier to use.</span>
<span class="comment-copy">You might be experiencing a memory leak. Have you looked at any profiling of your script or even just system resources when the slow down happens?</span>
<span class="comment-copy">You seem to store the pictures in memory. If you use too much memory in your program (more than your RAM can hold) then your OS hast to use <a href="https://en.wikipedia.org/wiki/Paging#Performance" rel="nofollow noreferrer">paging</a> to disk to provide the needed space - which is very slow.</span>
