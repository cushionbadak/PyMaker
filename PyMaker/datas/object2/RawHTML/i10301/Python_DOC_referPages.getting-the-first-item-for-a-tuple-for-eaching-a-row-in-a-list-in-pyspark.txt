<div class="post-text" itemprop="text">
<p>I'm a bit new to Spark and I am trying to do a simple mapping.<br/>
My data is like the following:</p>
<pre><code>RDD((0, list(tuples)), ..., (19, list(tuples))
</code></pre>
<p>What I want to do is grabbing the first item in each tuple, so ultimately something like this: </p>
<pre><code>RDD((0, list(first item of each tuple),..., (19, list(first item of each tuple))
</code></pre>
<p>Can someone help me out with how to map this?<br/>
I'll appreciate that! </p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <code>mapValues</code> to convert the list of tuples to a list of tuple[0]:</p>
<pre><code>rdd.mapValues(lambda x: [t[0] for t in x])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Something like this? </p>
<p><code>kv</code> here meaning "key-value" and mapping <a href="https://docs.python.org/3/library/operator.html#operator.itemgetter" rel="nofollow"><code>itemgetter</code></a> over the values. So, <code>map</code> within a <code>map</code> :-)</p>
<pre><code>from operator import itemgetter
rdd = sc.parallelize([(0, [(0,'a'), (1,'b'), (2,'c')]), (1, [(3,'x'), (5,'y'), (6,'z')])])
mapped = rdd.mapValues(lambda v: map(itemgetter(0), v))
</code></pre>
<p>Output</p>
<pre><code>mapped.collect()
[(0, [0, 1, 2]), (1, [3, 5, 6])]
</code></pre>
</div>
<span class="comment-copy">Ah yes, this makes total sense. Thanks so much @AChampion</span>
<span class="comment-copy">I believe the OP said the list is a list of tuples...</span>
<span class="comment-copy">Don't think so as this will just return the first item of the list, not the first of every tuple in the list - you would need <code>(kv[0], [a[0] for a in kv[1]])</code> but given you are just affecting the values you can use <code>mapValues()</code> to simplify</span>
<span class="comment-copy">@cricket_007 I tried what you said already, and it just gives me the first tuple in each tuple.</span>
<span class="comment-copy">@AceHaidrey Yeah, sorry. Fixed with alternate solution</span>
