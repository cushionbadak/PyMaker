<div class="post-text" itemprop="text">
<p>I am scraping info to a text file and am trying to write the date at the top.  I have the method to grab the date but have no clue how I can use the write function to place at top.    Below is a stripped down version of what I am working on.</p>
<pre><code>import re
import urllib2
import json
from datetime import datetime
import time

now = datetime.now()
InputDate = now.strftime("%Y-%m-%d")
Today = now.strftime("%B %d")

header = ("Today").split()

newfile = open("File.txt", "w")

### Irrelevant Info Here ###

string = title"\n"+info+"\n"
#newfile.write(header)
newfile.write(string)
print title+" written to file"

newfile.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>To write the date to the 'top' of the file you would want to put:</p>
<pre><code>newfile.write(InputDate)
newfile.write(Today)
</code></pre>
<p>after where you open the file and before anything else.  </p>
</div>
<div class="post-text" itemprop="text">
<p>You can't insert something at the beginning of a file.  You need to write a new file, starting with the line you want to insert, then finish with the contents of the old file. Unlike appending to the end, writing to the start of the file is really, really inefficient</p>
<p>The key to this problem is to use a <a href="https://docs.python.org/3/library/tempfile.html#tempfile.NamedTemporaryFile" rel="nofollow noreferrer"><code>NamedTemporaryFile</code></a>.  After you finish constructing it, you then rename it on top of the old file.</p>
<h3>Code:</h3>
<pre><code>def insert_timestamp_in_file(filename):
    with open(filename) as src, tempfile.NamedTemporaryFile(
            'w', dir=os.path.dirname(filename), delete=False) as dst:

        # Save the new first line
        dst.write(dt.datetime.now().strftime("%Y-%m-%d\n"))

        # Copy the rest of the file
        shutil.copyfileobj(src, dst)

    # remove old version
    os.unlink(filename)

    # rename new version
    os.rename(dst.name, filename)
</code></pre>
<h3>Test Code:</h3>
<pre><code>import datetime as dt
import tempfile
import shutil

insert_timestamp_in_file("file1")
</code></pre>
<h3>file1</h3>
<pre><code>I am scraping info to a text file and am trying to write the date at
the top. I have the method to grab the date but have no clue how I can
use the write function to place at top. Been trying for 2 days and all.
</code></pre>
<h3>Results:</h3>
<pre><code>2018-02-15
I am scraping info to a text file and am trying to write the date at
the top. I have the method to grab the date but have no clue how I can
use the write function to place at top. Been trying for 2 days and all.
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Just to give you idea</p>
<p><strong>Try this:-</strong></p>
<pre><code>import re
import urllib2
import json
from datetime import datetime
import time
now = datetime.now()
InputDate = now.strftime("%Y-%m-%d")
Today = now.strftime("%B %d")
#start writing from here
newfile = open("File.txt", "a")
newfile.write(InputDate+"\n")
newfile.write("hello Buddy")
newfile.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Simple One will be, if you will not call it as a <code>str</code> then it will throw an error <code>TypeError: write() argument must be str, not list</code></p>
<p>I have rfreshed teh code to be more precise and effective use..</p>
<pre><code>import re
from datetime import datetime
import time

now = datetime.now()
InputDate = now.strftime("%B"+" "+"%Y-%m-%d")
newfile = open("File.txt", "a")
string = "Hi trying to add a datetime at the top of the file"+"\n"
newfile.write(str(InputDate+"\n"))
newfile.write(string)
newfile.close()
</code></pre>
<p>Result will be:</p>
<pre><code>February 152018-02-15
Hi trying to add a datetime at the top of the file
</code></pre>
</div>
<span class="comment-copy">Wow thats super simple and worked like a charm.  Thank you.</span>
<span class="comment-copy">Im struggling with this one but I am not great at this.  I for sure see the theory and believe it works.  Thank you very much</span>
<span class="comment-copy">That works perfectly. Thank you.</span>
<span class="comment-copy">Thank you, works good.</span>
