<div class="post-text" itemprop="text">
<p>Here is the s84.txt which is on hdfs and I want to do wordcount on it:</p>
<blockquote>
<p>[paslechoix@gw03 ~]$ hdfs dfs -cat s84.txt 
  Lorem Ipsum is simply dummy
  text of the printing and typesetting industry. Lorem Ipsum has been
  the industry's standard dummy text ever since the 1500s,</p>
<p>when an unknown printer took a galley of type and scrambled it to make
  a type specimen book. It has survived not only five centuries, but
  also the leap into electronic typesetting,</p>
<p>remaining essentially unchanged. It was popularised in the 1960s with
  the release of Letraset sheets containing Lorem Ipsum passages, and
  more recently with desktop publishing software like Aldus</p>
<p>PageMaker including versions of Lorem Ipsum. </p>
</blockquote>
<pre><code>s84RDD = sc.textFile("p84.txt") 
nonempty_lines = s84RDD.filter(lambda x: len(x) &gt; 0)
words = nonempty_lines.flatMap(lambda x: x.split("")) 
wc = words.map(lambda x: (x,1)).reduceByKey(lambda x, y: x+y).map(lambda x: (x[1], x[0])).sortByKey(False)
</code></pre>
<p>Error:</p>
<p>ValueError: empty separator</p>
<p>What am I missing here? Thank you very much.</p>
</div>
<div class="post-text" itemprop="text">
<p>From the official <a href="https://docs.python.org/3/library/stdtypes.html#str.split" rel="nofollow noreferrer">docs</a>:</p>
<blockquote>
<p>Return a list of the words in the string, using sep as the delimiter string.</p>
</blockquote>
<p><code>split()</code> needs a separator. You are using <code>split("")</code> with argument as <code>""</code> which is an empty string.</p>
<pre><code>&gt;&gt;&gt; '1,2,3'.split(',')
['1', '2', '3']

&gt;&gt;&gt; '1 2 3'.split()
['1', '2', '3']

&gt;&gt;&gt; "Lorem ipsum sit dolor amet".split("")
Traceback (most recent call last):
  File "&lt;pyshell#1&gt;", line 1, in &lt;module&gt;
    x.split("")
ValueError: empty separator

&gt;&gt;&gt; "Lorem ipsum sit dolor amet".split(" ")
['Lorem', 'ipsum', 'sit', 'dolor', 'amet']
</code></pre>
</div>
<span class="comment-copy">What are you trying to <code>split()</code> on? An empty string is not a valid argument, no argument defaults to whitespace, any explicit argument is used for the split. Note: your test for an empty line may not be correct. BTW you show <code>s84.txt</code> but are loading <code>p84.txt</code>.</span>
<span class="comment-copy">Thank you AChampion for noticing the missing space and the confusing file name</span>
<span class="comment-copy">Thank you for help. It works.</span>
