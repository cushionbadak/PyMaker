<div class="post-text" itemprop="text">
<p>I am looking at a piece of XML that I want to add a node in.</p>
<pre><code>&lt;profile&gt;
    &lt;dog&gt;1&lt;/dog&gt;
        &lt;halfdog&gt;0&lt;/halfdog&gt;
    &lt;cat&gt;545&lt;/cat&gt;
        &lt;lions&gt;0&lt;/lions&gt;
    &lt;bird&gt;23&lt;/bird&gt;
        &lt;dino&gt;0&lt;/dino&gt;
        &lt;pineapples&gt;2&lt;/pineapples&gt;
    &lt;people&gt;0&lt;/people&gt;
&lt;/profile&gt;
</code></pre>
<p>With the above XML, I'm able to insert XML nodes into it. However, I'm not able to insert it at exact locations.</p>
<p>Is there a way to find if I am next to a certain node, whether it be before or after. Say if I wanted to add <code>&lt;snail&gt;2&lt;/snail&gt;</code> between the <code>&lt;dino&gt;0&lt;/dino&gt;</code> and <code>&lt;pineapples&gt;2&lt;/pineapples&gt;</code> nodes. </p>
<p>Using <code>ElementTree</code> how can I find what node is next to me? I'm asking about <code>ElementTree</code> or any standard Python library. Unfortunately, <code>lxml</code> is out of the question for me.</p>
</div>
<div class="post-text" itemprop="text">
<p>I believe its not doable using ElementTree, but you can do it using the standard <a href="http://docs.python.org/2/library/xml.dom.minidom.html" rel="nofollow">python minidom</a>:</p>
<pre><code># create snail element
snail = dom.createElement('snail')
snail_text = dom.createTextNode('2')
snail.appendChild(snail_text)

# add it in the right place
profile = dom.getElementsByTagName('profile')[0]
pineapples = dom.getElementsByTagName('pineapples')[0]
profile.insertBefore(snail, pineapples)
</code></pre>
<p>output:</p>
<pre><code>&lt;?xml version="1.0" ?&gt;&lt;profile&gt;
    &lt;dog&gt;1&lt;/dog&gt;
    &lt;halfdog&gt;0&lt;/halfdog&gt;
    &lt;cat&gt;545&lt;/cat&gt;
    &lt;lions&gt;0&lt;/lions&gt;
    &lt;bird&gt;23&lt;/bird&gt;
    &lt;dino&gt;0&lt;/dino&gt;
    &lt;snail&gt;2&lt;/snail&gt;&lt;pineapples&gt;2&lt;/pineapples&gt;
    &lt;people&gt;0&lt;/people&gt;
&lt;/profile&gt;
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you know the parent element and the element to insert before, you can use the following method with ElementTree:</p>
<pre><code>index = parentElem.getchildren().index(elemToInsertBefore)
parent.insert(index, newElement)
</code></pre>
</div>
<span class="comment-copy">Note if using Python 3.2 or above: <code>getchildren()</code> is deprecated and can be replaced with <code>list(elem)</code> <a href="https://docs.python.org/3/library/xml.etree.elementtree.html#xml.etree.ElementTree.Element.getchildren" rel="nofollow noreferrer">(see the Python 3 documentation)</a>. The first line would then instead become <code>index = list(parentElem).index(elemToInsertBefore)</code></span>
