<div class="post-text" itemprop="text">
<p>I'm a beginner in Python, and I've been struggling to create a code to add columns to a set of similar csv files.</p>
<p>Here's what I have so far:</p>
<pre><code>import csv, os

for csvFilename in os.listdir('.'):
    if not csvFilename.endswith('.csv'):
        continue
    print('Editing file ' + csvFilname + '...')

    file = open(csvFilename)
    reader = csv.reader(file)
    writer = csv.writer(open('new_' + csvFilename, 'w'))
    headers = reader.next()
    headers.append('ColName')
    writer.write(headers)
    for row in reader:
        row.append(str(row[12]) + ' ' + str(row[13]) + " some text")
        writer.write(row)
</code></pre>
<p>Basically, I'd like to add a column in which I had "<em>Row 13's text</em> + <em>row 14's text</em> + <em>more text, the same every time</em>".</p>
<p>I get this error message on the <em>writer.write(headers)</em> line, though:
<em>AttributeError: '_csv.writer' object has no attribute 'write'</em></p>
<p>What should I do?</p>
</div>
<div class="post-text" itemprop="text">
<p>I have to refactor your code but this should be closest to what you would like to achieve. You would need to do exception handling and checking if there are more than 13 elements in the row, etc.</p>
<pre><code>import tempfile, os, csv

for csvFilename in os.listdir('.'):
    if not csvFilename.endswith('.csv'):
        continue
    print('Editing file ' + csvFilename + '...')
    with open(csvFilename, 'r') as csvFile:
        reader = csv.reader(csvFile, delimiter=',', quotechar='"')
        with open('new_' + csvFilename, 'w') as tempfile:
            writer = csv.writer(tempfile, delimiter=',', quotechar='"')
            header = True
            for row in reader:
                if (header):
                    row.append('ColName')
                    writer.writerow(row)
                    header = False
                else:
                    row.append(str(row[12]) + ' ' + str(row[13]) + " some text")
                    writer.writerow(row)
</code></pre>
<p>More on python csv : <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">https://docs.python.org/3/library/csv.html</a></p>
</div>
<div class="post-text" itemprop="text">
<p>You need read the API document,</p>
<p><a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">https://docs.python.org/3/library/csv.html</a></p>
<p>The <code>csv.writer</code> write function used <code>writerow</code> not the <code>write</code>, please check.</p>
<p>The sample to write CSV file, </p>
<pre><code>import csv
with open('eggs.csv', 'w', newline='') as csvfile:
    spamwriter = csv.writer(csvfile, delimiter=' ',
                            quotechar='|', quoting=csv.QUOTE_MINIMAL)
    spamwriter.writerow(['Spam'] * 5 + ['Baked Beans'])
    spamwriter.writerow(['Spam', 'Lovely Spam', 'Wonderful Spam'])
</code></pre>
</div>
