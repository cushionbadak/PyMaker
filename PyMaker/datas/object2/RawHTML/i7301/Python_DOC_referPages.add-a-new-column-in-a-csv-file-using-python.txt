<div class="post-text" itemprop="text">
<p>Add a new column in a csv file using Python?</p>
<p>I have a csv file. </p>
<pre><code>    c-ip-1         
0   31.7.188.55     
1   68.180.231.57   
2   157.55.39.64    
</code></pre>
<p>I use function to read the file as a matrix excel_list:</p>
<pre><code>[[1.0, u'31.7.188.55'], [2.0, u'68.180.231.57'], [3.0, u'157.55.39.64']]
</code></pre>
<p>I also have a function called spider to transfer the IP address into location. But I have no idea how to save the location value as a new column into the file.</p>
<p>My simple code is like:</p>
<pre><code>for w_index, row in enumerate(excel_list):
    ip = row[1]
    temp_list = spider(ip)  # transfer IP address into location
    row.append(temp_list)
</code></pre>
<p>The expected csv file is like:</p>
<pre><code>    c-ip-1          location
0   31.7.188.55     Germany
1   68.180.231.57   United States
2   157.55.39.64    United States
</code></pre>
<p>But it doesn't work. Maybe I should not use append. How can solve the problem?</p>
</div>
<div class="post-text" itemprop="text">
<p>Could it be that you aren't writing your changes back out to the CSV file, and you're just modifying your local list in memory?  Thanks for posting the expected results but what does the CSV look like after running?</p>
<p><a href="https://automatetheboringstuff.com/chapter14/" rel="nofollow noreferrer">Automate the Boring Stuff - Chapter 14 â€“ Working with CSV Files and JSON Data</a> is a great resource and may be able to help you further.</p>
</div>
<span class="comment-copy"><code>temp_list</code> is a string, right? Also, what part of it doesn't work? Are you writing this data back to the csv?</span>
<span class="comment-copy">excel_list is matrix [[1.0, u'31.7.188.55'], [2.0, u'68.180.231.57'], [3.0, u'157.55.39.64']], it is easier to locate ip address I want to transfer.</span>
<span class="comment-copy">yes I want this data back to the csv. But it did nothing. The csv doesn't change.</span>
<span class="comment-copy">Nothing changes unless you actually open a new file and write your data back to it.</span>
<span class="comment-copy">Do you use the <code>writer()</code> method that Python offers ? <a href="https://docs.python.org/3/library/csv.html#csv.writer" rel="nofollow noreferrer">docs.python.org/3/library/csv.html#csv.writer</a></span>
<span class="comment-copy">The csv doesn't change. Still as what it was like before. Yeah maybe I just create a list but not write back into the csv file. So is there any method to write changes back to the csv file?</span>
<span class="comment-copy">You'll need to open the file not as a read-only, but as read and write.  Or, close the file after you read it, and then open it in write mode.  If you follow the link I posted, it walks you through how to do it.</span>
