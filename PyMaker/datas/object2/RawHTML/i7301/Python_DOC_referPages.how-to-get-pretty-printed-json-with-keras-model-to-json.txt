<div class="post-text" itemprop="text">
<p>I am trying to <a href="https://keras.io/getting-started/faq/#how-can-i-save-a-keras-model" rel="noreferrer">save model to JSON with Keras</a> and getting condensed JSON code.</p>
<p>Is it possible to save in pretty-printed human friendly JSON here? </p>
</div>
<div class="post-text" itemprop="text">
<p>The <a href="https://github.com/fchollet/keras/blob/395a2edfd7741b5cdce7997bf8d4018d0e4b10d9/keras/engine/topology.py#L2630" rel="noreferrer"><code>to_json</code> method</a> from keras accepted <code>**kwargs</code> and passed them to <code>json.dumps</code>. Therefore this is the one line solution:</p>
<pre><code>print(model.to_json(indent=4))
</code></pre>
<p>It generate results similar to the example of @anton-vbr.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.python.org/2/library/pprint.html#pprint.pformat" rel="nofollow noreferrer"><code>pprint.pformat</code></a> to retrieve a pretty string:</p>
<pre><code>import pprint
json_str = model.to_json()
formatted_str = pprint.pformat(json.loads(json_str), indent=4)
</code></pre>
<p>If you don't want to save a copy of the formatted json, rather if you prefer to save it to a file, you can use <a href="https://docs.python.org/2/library/pprint.html#pprint.pprint" rel="nofollow noreferrer"><code>pprint.pprint</code></a> and specify <code>stream=...</code> with a file handler:</p>
<pre><code>pprint.pprint(json.loads(json_str), indent=1, stream=open('model.json', 'w'))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use the json library.
Docs here: <a href="https://docs.python.org/3.6/library/json.html" rel="nofollow noreferrer">https://docs.python.org/3.6/library/json.html</a></p>
<pre><code>import json
json_str = model.to_json()
print(json.dumps(json.loads(json_str),indent=4))
</code></pre>
<p>To save it to file:</p>
<pre><code>import json
json_str = model.to_json()
with open("output.json", "w") as f:
    json.dump(json.loads(json_str), f, indent=4)
</code></pre>
<p>Example dataframe from pandas:</p>
<pre><code>datetime            temp    weather
2017-07-27 02:00:00 22.94   light rain
2017-07-27 05:00:00 21.74   clear sky
2017-07-27 08:00:00 21.10   light rain
2017-07-27 11:00:00 27.69   clear sky
</code></pre>
<p>Results in:</p>
<pre><code>{
    "weather": {
        "1501131600000": "clear sky",
        "1501153200000": "clear sky",
        "1501142400000": "light rain",
        "1501120800000": "light rain"
    },
    "temp": {
        "1501131600000": 21.74,
        "1501153200000": 27.69,
        "1501142400000": 21.1,
        "1501120800000": 22.94
    }
}
</code></pre>
</div>
<span class="comment-copy"><code>pprint</code> <a href="https://docs.python.org/3.4/library/pprint.html" rel="nofollow noreferrer">docs.python.org/3.4/library/pprint.html</a></span>
<span class="comment-copy">@DeepSpace where do you see it can reparse string?</span>
<span class="comment-copy">I found it just doesn't work.</span>
<span class="comment-copy">@SuzanCioc What error do you get?</span>
<span class="comment-copy">No error. Just no pretty printing. And this is actually expected, because I can't beleive <code>pformat</code> can parse JSON string. In example <a href="https://docs.python.org/3/library/pprint.html" rel="nofollow noreferrer">docs.python.org/3/library/pprint.html</a> here it accepts parsed JSON, not string. The problem is to_json() returns string.</span>
<span class="comment-copy">@SuzanCioc Okay. You can call <code>json.loads</code> to convert it to an object. Look at my edit.</span>
<span class="comment-copy">Yes, but this is doubling the work.</span>
<span class="comment-copy">This will not indent it. Just double escape everything.</span>
<span class="comment-copy">@cᴏʟᴅsᴘᴇᴇᴅ thanks for pointing it out. it should of course be loaded first.</span>
