<div class="post-text" itemprop="text">
<p>I am trying to import a DLL into Python 2.7.12 64 bit using ctypes. To narrow down the scope for errors I used Microsoft's MathLibrary DLL example and built my own based on these instructions (<a href="https://msdn.microsoft.com/en-GB/library/ms235636.aspx" rel="nofollow noreferrer">https://msdn.microsoft.com/en-GB/library/ms235636.aspx</a>). I built it as x64 release and copied the resulting dll into C:\ root to eliminate path length or spelling error issues. My machine us running Windows 7 Pro 64 Bit.</p>
<p>My python code is:</p>
<pre><code>from ctypes import cdll, windll, c_long, c_int, create_string_buffer

test_dll = windll("C:\\MathLibrary.dll")

add = test_dll.add
</code></pre>
<p>When run it reports the following:</p>
<pre><code>Traceback (most recent call last):
  File "C:\temp.py", line 3, in &lt;module&gt;
    test_dll = windll("C:\\MathLibrary.dll")
TypeError: 'LibraryLoader' object is not callable
</code></pre>
<p>Can anyone advise what might be the issue?</p>
<p>Thanks</p>
<p>Andy</p>
<hr/>
<p>Update:</p>
<p>@eryksun comment  - this removed the LibraryLoader error. However I am now struggling to access the add function and get this error:</p>
<pre><code>    add = test_dll.add
  File "C:\Python27\lib\ctypes\__init__.py", line 375, in __getattr__
    func = self.__getitem__(name)
  File "C:\Python27\lib\ctypes\__init__.py", line 380, in __getitem__
    func = self._FuncPtr((name_or_ordinal, self))
AttributeError: function 'add' not found
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>windll is an object from the ctypes module. It can't be invoked like a function ('object is not callable'). You probably want to reference one of its methods and invoke it.</p>
<pre><code>test_dll = windll.&lt;func_name&gt;("C:\\MathLibrary.dll")
</code></pre>
<p>you can use <code>__dir__()</code> to see the objects attributes and methods, or better yet, check the <a href="https://docs.python.org/3/library/ctypes.html" rel="nofollow noreferrer">documentation</a>.</p>
</div>
<span class="comment-copy">In general it's better to use <code>ctypes.WinDLL("C:\\MathLibrary.dll")</code>. Or if the library uses <code>SetLastError</code>, use <code>ctypes.WinDLL("C:\\MathLibrary.dll", use_last_error=True)</code>. If you insist on using <code>windll</code> to load the DLL, use <code>windll.LoadLibrary("C:\\MathLibrary.dll")</code> -- a method that calls <code>WinDLL</code> but doesn't allow passing parameters to the constructor -- or either <code>windll["C:\\MathLibrary.dll"]</code> or <code>getattr(windll, "C:\\MathLibrary.dll")</code>, both of which cache the loaded DLL.</span>
