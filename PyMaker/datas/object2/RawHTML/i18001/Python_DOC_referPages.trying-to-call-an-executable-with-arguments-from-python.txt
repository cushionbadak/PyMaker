<div class="post-text" itemprop="text">
<p>I am using a third party software that I can run in command line which consists of the .exe file as well as several switches that pass through arguments. The goal is to script this using Python but I am a beginner to programming in Python and could use some help in translating the following command line in Python. The arguments are seperated by "/" and the arguments are /inbook1, /inbook2, /report</p>
<pre><code>C:\Program Files(x86)\Florencesoftt\diffenginex\diffenginex.exe /inbook1:"c:\users\file.xlsx /inbook2: "c:\users\file2.xlsx /report:"c:\users\file3.xlsx"
</code></pre>
<p>So, would anyone be able to help me call this command using Python?</p>
</div>
<div class="post-text" itemprop="text">
<p>You want to use the <a href="http://docs.python.org/3/library/subprocess.html" rel="nofollow"><code>subprocess</code></a> module.</p>
<p>Exactly how you want to use it depends on exactly what you want to do. For example, do you want to let the program's output mix in with your output, or do you want to capture it to a string? Do you want to wait until it's done, or kick it off in the background?</p>
<p>Fortunately, the documentation is pretty clear, and explains how to do each thing you might want to do.</p>
<p>Meanwhile, I'm 95% sure you've gotten some of the quotes wrong on your command line. For example, the <code>/inbook</code> argument starts with a <code>"</code>, which isn't closed until the start of the <code>/inbook2</code> argument.</p>
<p>Anyway, trying to guess what you might want, here's one possibility:</p>
<pre><code>args = [r'C:\Program Files(x86)\Florencesoftt\diffenginex\diffenginex.exe',
        r'/inbook1:"c:\users\file.xlsx"',
        r'/inbook2:"c:\users\file2.xlsx"',
        r'/report:"c:\users\file3.xlsx"']
output = subprocess.check_output(args)
</code></pre>
<p>The <a href="http://docs.python.org/3/library/subprocess.html#subprocess.check_output" rel="nofollow"><code>check_output</code></a> function runs the program, waits for it to finish, raises an exception if it finishes with an error return code, and returns the program's output as a string (or, in Python 3, a <code>bytes</code>).</p>
<p>The extra double quotes <em>probably</em> aren't necessary here (especially since there are no spaces in your pathnames), but since they were in your original code, I left them as-is. Generally, Python will do whatever is necessary to get each separate argument treated as a single argument by the target program, even if you have arguments that have spaces or quotes in them, so you don't have to worry about that.</p>
<p>Mweanwhile, if it's easier to write the arguments as one big string, instead of as a list of four separate strings, you can do that instead. (Only on Windows; don't do it on Unix unless you're using <code>shell=True</code>.) But usually that just means more opportunities to get the quoting wrong, and since you appear to have already gotten it wrong multiple times, I think you're better off this way.</p>
</div>
<div class="post-text" itemprop="text">
<p>I'm a newbie, but would you like to try this code:</p>
<p>---EDIT---
I've edited so much according to @Abarnert's suggestions that this code is more his than mine, so don't up-vote me. I'm leaving the solution for sake of the fact that now it should work.</p>
<p>The code:</p>
<pre><code>import subprocess
basecommand = r"C:\Program Files(x86)\Florencesoftt\diffenginex\diffenginex.exe"
inbook1 = r"c:\users\file.xlsx"
inbook2 = r"c:\users\file2.xlsx"
report = r"c:\users\file3.xlsx"

inbook1 = r'/inbook1:"' + inbook1 + '"'
inbook2 = r'/inbook2:"' + inbook2 + '"'
report = r'/report:"' + report + '"'
subprocess.call([basecommand, inbook1, inbook2, report])
</code></pre>
<p>Thanks @Abarnert!</p>
</div>
<span class="comment-copy">The question is, how is the executable handling this? Is the code you posted works in the command prompt?</span>
<span class="comment-copy">This is close, but you're not passing the <code>/inbook1:</code>, <code>/inbook2:</code>, and <code>/report:</code> parts of the flag arguments, you're just passing the filenames themselves (with extra quotes around them).</span>
<span class="comment-copy">You are right! The first version had them, then I edited and took them away by mistake. How does it look now?</span>
<span class="comment-copy">Now you've got an extra space at the start of each argument, and you've forgotten to make the paths into raw strings so each <code>\f</code> is going to turn into <code>\x0c</code>. I like the general idea of putting the pathnames into variables, though.</span>
<span class="comment-copy">Wow. Thanks guys. This was extremely helpful and I ended up using @Abarnert code that he posted in pastebin.</span>
<span class="comment-copy">The <code>r</code> is part of a _string literal_—that is, the thing between quotes in your source code—not part of the string object itself. The <a href="http://docs.python.org/3/tutorial/introduction.html#strings" rel="nofollow noreferrer">Strings</a> section in the official tutorial explains a little bit about string literals vs. strings, and about raw string literals and backslashes, although there might be a better tutorial or explanation out there. (You can also read the reference docs on <a href="http://docs.python.org/3/reference/lexical_analysis.html#literals" rel="nofollow noreferrer">Literals</a>, but that's really only helpful for people who already understand.)</span>
