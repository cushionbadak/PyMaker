<div class="post-text" itemprop="text">
<p>On windows, when there are chinese characters in file path, the chinese characters will be garbled in tar.gz and after decompression, they are still garbled.</p>
</div>
<div class="post-text" itemprop="text">
<p>This is all explained in <a href="http://docs.python.org/3/library/tarfile.html#tar-unicode" rel="nofollow">Unicode issues</a> in the docs.</p>
<p>For all tarball formats before PAX—including the default format used by <code>tarfile</code>—filenames are stored in a "local filesystem encoding". The compressing program has to take a wild guess at what the decompressing program will want, and vice-versa. If you don't take a guess in your program, Python will do it for you, and guess UTF-8. See <a href="http://docs.python.org/3/library/tarfile.html#tarfile-objects" rel="nofollow"><code>TarFile</code></a>, which explains that it uses <code>ENCODING</code> if you don't specify anything, and <a href="http://docs.python.org/3/library/tarfile.html#tarfile.ENCODING" rel="nofollow"><code>ENCODING</code></a>, which explains that it defaults to <code>'utf-8'</code> on Windows.</p>
<p>So, there are three solutions:</p>
<ol>
<li>Use PAX-format tarballs. This is easy; just pass <code>format=tarfile.PAX_FORMAT</code> to the <code>TarFile</code> constructor. (You can also set <code>tarfile.DEFAULT_FORMAT = tarfile.PAX_FORMAT</code> to change the default.) As long as the tool you're using to decompress understands PAX, you're set.</li>
<li>Figure out which encoding your decompression tool wants, and specify that explicitly by passing, e.g., <code>format='big5'</code> to the <code>TarFile</code> constructor. (You can also set <code>tarfile.ENCODING='big5'</code> to change the default.) Again, there's a good chance your tool uses your system's configured OEM charset, but no guarantee of that, and without knowing what tool you're using, I can't give any more details on how to figure it out.</li>
<li>Let Python use UTF-8, and convince your decompression tool to read UTF-8 instead of making a wild guess. Without knowing which tool you're using, I can't give any more detail than that.</li>
</ol>
</div>
<span class="comment-copy">Good to know...</span>
<span class="comment-copy">python3, you can see it in the title</span>
<span class="comment-copy">So, did you try reading the <code>tarfile</code> docs and not understand the explanation there? Or did you just not bother trying?</span>
