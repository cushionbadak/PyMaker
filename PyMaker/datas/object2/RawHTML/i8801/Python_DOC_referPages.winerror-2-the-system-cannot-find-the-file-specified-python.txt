<div class="post-text" itemprop="text">
<p>I have a Fortran program and want to execute it in python for multiple files. I have 2000 input files but in my Fortran code I am able to run only one file at a time. How should I call the Fortran program in python?</p>
<p><strong>My Script:</strong></p>
<pre><code>import subprocess
import glob
input = glob.glob('C:/Users/Vishnu/Desktop/Fortran_Program_Rum/*.txt')
output = glob.glob('C:/Users/Vishnu/Desktop/Fortran_Program_Rum/Output/')
f = open("output", "w")
for i in input:
    subprocess.Popen(["FORTRAN ~/C:/Users/Vishnu/Desktop/Fortran_Program_Rum/phase1.f", "--domain "+i])
f.write(i)
</code></pre>
<p><strong>Error:</strong></p>
<pre><code>runfile('C:/Users/Vishnu/Desktop/test_fn/test.py', wdir='C:/Users/Vishnu/Desktop/test_fn')
Traceback (most recent call last):

   File "&lt;ipython-input-3-f8f378816004&gt;", line 1, in &lt;module&gt;
runfile('C:/Users/Vishnu/Desktop/test_fn/test.py', wdir='C:/Users/Vishnu/Desktop/test_fn')

  File "C:\Users\Vishnu\Anaconda3\lib\site-packages\spyder\utils\site\sitecustomize.py", line 866, in runfile
execfile(filename, namespace)

  File "C:\Users\Vishnu\Anaconda3\lib\site-packages\spyder\utils\site\sitecustomize.py", line 102, in execfile
exec(compile(f.read(), filename, 'exec'), namespace)

  File "C:/Users/Vishnu/Desktop/test_fn/test.py", line 30, in &lt;module&gt;
subprocess.Popen(["FORTRAN ~/C:/Users/Vishnu/Desktop/Fortran_Program_Rum/phase1.f", "--domain "+i])

  File "C:\Users\Vishnu\Anaconda3\lib\subprocess.py", line 707, in __init__
restore_signals, start_new_session)

  File "C:\Users\Vishnu\Anaconda3\lib\subprocess.py", line 990, in _execute_child
startupinfo)

FileNotFoundError: [WinError 2] The system cannot find the file specified
</code></pre>
<p><strong>Edit:</strong></p>
<pre><code>import subprocess
import os
input = os.path.normcase(r'C:/Users/Vishnu/Desktop/Fortran_Program_Rum/*.txt')
output = os.path.normcase(r'~/C:/Users/Vishnu/Desktop/Fortran_Program_Rum/Output/')
f = open("output", "w")
for i in input:
    exe = os.path.normcase(r'~/C:/Program Files (x86)/Silverfrost/ftn95.exe')
    fortran_script = os.path.normcase(r'~/C:/Users/Vishnu/Desktop/test_fn/test_f2py.f95')
    i = os.path.normcase(i)
    subprocess.Popen([exe, fortran_script, "--domain", i])
    f.write(i)
</code></pre>
<p><strong>Error:</strong></p>
<pre><code>FileNotFoundError: [WinError 2] The system cannot find the file specified
</code></pre>
<p><strong>Edit - 2:</strong></p>
<p>I have change my script as below: but error is same</p>
<pre><code>input = os.path.normcase(r'C:/Users/Vishnu/Desktop/Fortran_Program_Rum/*.txt')
output = os.path.normcase(r'C:/Users/Vishnu/Desktop/Fortran_Program_Rum/Output/')
f = open("output", "w")
for i in input:
    exe = os.path.normcase(r'C:/Program Files (x86)/Silverfrost/ftn95.exe')
    fortran_script = os.path.normcase(r'C:/Users/Vishnu/Desktop/test_fn/test_f2py.f95')
    i = os.path.normcase(i)
    subprocess.Popen([exe, fortran_script, "--domain", i])
    f.write(i)
</code></pre>
<p><strong>Error: 2</strong></p>
<pre><code>FileNotFoundError: [WinError 2] The system cannot find the file specified
</code></pre>
<p><strong>Error: 3 - 15-03-2017</strong></p>
<pre><code>import subprocess
import os
input = os.path.normcase(r'C:/Users/Vishnu/Desktop/Fortran_Program_Rum/*.txt')
output = os.path.normcase(r'C:/Users/Vishnu/Desktop/Fortran_Program_Rum/Output/')
f = open('output', 'w+')
for i in input:
    exe = os.path.normcase(r'C:/Program Files (x86)/Silverfrost/ftn95.exe')
    fortran_script = os.path.normcase(r'C:/Users/Vishnu/Desktop/Fortran_Program_Rum/phase1.f')
    i = os.path.normcase(i)
    subprocess.Popen([exe, fortran_script, "--domain", i], shell = True)
    f.write(i)
</code></pre>
<p>** Error **</p>
<pre><code>PermissionError: [Errno 13] Permission denied: 'output'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Popen expect a list of strings for non-shell calls and a string for shell calls.</p>
<p>Call subprocess.Popen with shell=True:</p>
<pre><code>process = subprocess.Popen(command, stdout=tempFile, shell=True)
</code></pre>
<p>Hopefully this solves your issue.</p>
<p>This issue is listed here:
<a href="https://bugs.python.org/issue17023" rel="noreferrer">https://bugs.python.org/issue17023</a></p>
</div>
<div class="post-text" itemprop="text">
<p>I believe you need to <code>.f</code> file as a parameter, not as a command-single-string. same with the <code>"--domain "+i</code>, which i would split in two elements of the list.
Assuming that: </p>
<ul>
<li>you have the path set for <code>FORTRAN</code> executable, </li>
<li>the <code>~/</code> is indeed the correct way for the <code>FORTRAN</code> executable</li>
</ul>
<p>I would change this line:</p>
<pre><code>subprocess.Popen(["FORTRAN ~/C:/Users/Vishnu/Desktop/Fortran_Program_Rum/phase1.f", "--domain "+i])
</code></pre>
<p>to </p>
<pre><code>subprocess.Popen(["FORTRAN", "~/C:/Users/Vishnu/Desktop/Fortran_Program_Rum/phase1.f", "--domain", i])
</code></pre>
<p>If that doesn't work, you should do a <code>os.path.exists()</code> for the <code>.f</code> file, and check that you can launch the <code>FORTRAN</code> executable without any path, and set the path or system path variable accordingly </p>
<p>[EDIT 6-Mar-2017]</p>
<p>As the exception, detailed in the original post, is a python exception from <code>subprocess</code>; it is likely that the <code>WinError 2</code> is because it cannot find <code>FORTRAN</code></p>
<p>I highly suggest that you specify full path for your executable:</p>
<pre><code>for i in input:
    exe = r'c:\somedir\fortrandir\fortran.exe'
    fortran_script = r'~/C:/Users/Vishnu/Desktop/Fortran_Program_Rum/phase1.f'
    subprocess.Popen([exe, fortran_script, "--domain", i])
</code></pre>
<p>if you need to convert the forward-slashes to backward-slashes, as suggested in one of the comments, you can do this:</p>
<pre><code>for i in input:
    exe = os.path.normcase(r'c:\somedir\fortrandir\fortran.exe')
    fortran_script = os.path.normcase(r'~/C:/Users/Vishnu/Desktop/Fortran_Program_Rum/phase1.f')
    i = os.path.normcase(i)
    subprocess.Popen([exe, fortran_script, "--domain", i])
</code></pre>
<p>[EDIT 7-Mar-2017]</p>
<p>The following line is incorrect:</p>
<pre><code>exe = os.path.normcase(r'~/C:/Program Files (x86)/Silverfrost/ftn95.exe'
</code></pre>
<p>I am not sure why you have <code>~/</code> as a prefix for every path, don't do that.</p>
<pre><code>for i in input:
    exe = os.path.normcase(r'C:/Program Files (x86)/Silverfrost/ftn95.exe'
    fortran_script = os.path.normcase(r'C:/Users/Vishnu/Desktop/Fortran_Program_Rum/phase1.f')
    i = os.path.normcase(i)
    subprocess.Popen([exe, fortran_script, "--domain", i])
</code></pre>
<p>[2nd EDIT 7-Mar-2017]</p>
<p>I do not know this FORTRAN or ftn95.exe, does it need a shell to function properly?, in which case you need to launch as follows:</p>
<pre><code>subprocess.Popen([exe, fortran_script, "--domain", i], shell = True)
</code></pre>
<p>You really need to try to launch the command manually from the working directory which your python script is operating from. Once you have the command which is actually working, then build up the <code>subprocess</code> command.</p>
</div>
<div class="post-text" itemprop="text">
<p>thank you, your first error guides me here and the solution solve mine too!</p>
<p>for permission error, <code>f = open('output', 'w+')</code>, change it into <code>f = open(output+'output', 'w+')</code>. </p>
<p>or something else, but the way you are now using is having access to the installation directory of Python which normally in Program Files, and it probably needs administrator permission. </p>
<p>for sure, you could probably running python/your script as administrator to pass permission error though</p>
</div>
<span class="comment-copy">I don't know Fortran, but does it support the forward slashes <code>/</code> in windows paths like Python ? You might have to convert the forward slashes to backslashes in your command line.</span>
<span class="comment-copy">I would also encourage you to use <code>subprocess.run()</code> instead of the legacy <code>subprocess.Popen()</code> <a href="https://docs.python.org/3/library/subprocess.html#subprocess.run" rel="nofollow noreferrer">docs.python.org/3/library/subprocess.html#subprocess.run</a></span>
<span class="comment-copy">I have tried both but not getting result.. can you please explain with code example.</span>
<span class="comment-copy">Thanks but I am still getting same error. I have edit my code and error above.</span>
<span class="comment-copy">I have updated my script as per your suggestion but still getting same error. I have edit my question <code>Edit -2 </code></span>
<span class="comment-copy">answer updated again</span>
<span class="comment-copy">Still not getting output. Please check above edit question and suggest me</span>
