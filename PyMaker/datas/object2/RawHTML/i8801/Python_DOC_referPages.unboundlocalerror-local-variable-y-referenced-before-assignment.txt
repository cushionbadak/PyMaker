<div class="post-text" itemprop="text">
<p>I have below code on list comprehension.</p>
<pre><code>x = 2
y = 3

[x*y for x in range(x) for y in range(y)]
</code></pre>
<p>This is giving me below error</p>
<pre><code>Traceback (most recent call last):
  File "&lt;pyshell#35&gt;", line 1, in &lt;module&gt;
    [x*y for x in range(x) for y in range(y)]
  File "&lt;pyshell#35&gt;", line 1, in &lt;listcomp&gt;
    [x*y for x in range(x) for y in range(y)]
UnboundLocalError: local variable 'y' referenced before assignment
</code></pre>
<p>However, below code works.</p>
<pre><code>[x*y for x in range(x)]
[0, 5]
</code></pre>
<p>Is there any scoping rule for the second <code>for</code> loop in list comprehension?</p>
<p>I am using Python 3.6.</p>
</div>
<div class="post-text" itemprop="text">
<p>Good question,however this code works well in <code>Python2.x</code>,and it will throw <code>UnboundLocalError</code> in <code>Python3.x</code>.</p>
<blockquote>
<p>It can be a surprise to get the <strong>UnboundLocalError</strong> in previously
  working code when it is modified by adding an assignment statement
  somewhere in the body of a function.</p>
</blockquote>
<p>This is because when you make an assignment to a variable in a <strong>scope</strong>, that variable becomes <strong>local to that scope and shadows any similarly named variable in the outer scope</strong>. Since it assigns a new value to x, the compiler recognizes it as a <strong>local variable</strong>. Thus the earlier variable attempts to print the uninitialized local variable and an error results.</p>
<p>See more details from <a href="https://docs.python.org/3/faq/programming.html#why-am-i-getting-an-unboundlocalerror-when-the-variable-has-a-value" rel="nofollow noreferrer">Why am I getting an UnboundLocalError when the variable has a value?</a>.</p>
</div>
<span class="comment-copy">@Chris_Rands: the possible duplicate post does not talk about UnboundLocalError and scoping rule for list comprehension.</span>
<span class="comment-copy">Ok that means for loop does have a local scope in list comprehension? As per my understanding for loop does not create any local scope when created at module level.</span>
