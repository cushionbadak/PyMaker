<div class="post-text" itemprop="text">
<p>I have this current code to unzip the contents of <code>archive</code> to <code>extract_dir</code>. However, I cannot figure out how to get the extracted file path &amp; name of the extracted file.</p>
<pre><code>if archive.endswith((".zip")):
    zip_ref = zipfile.ZipFile(archive, 'r')
    zip_ref.extract(extract_dir)
    zip_ref.close()
</code></pre>
<p>For example, if the archive is called <code>test.zip</code> and ZipFile extracts the contents <code>test.exe</code> I want get <code>C:/windows/users/admin/downloads/test.exe</code> in to a variable?</p>
<p>EDIT: Sorry I wasn't clear, in the source code for <a href="https://hg.python.org/cpython/file/2.7/Lib/zipfile.py#l1089" rel="nofollow noreferrer">zipfile</a> targetpath is returned I am wondering how I can get this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Here is the solution, I can't accept the answer for 2 days though.</p>
<pre><code>if archive.endswith((".zip")):
    print "example.jpg"
    zip_ref = zipfile.ZipFile(archive, 'r')
    extracted = zip_ref.namelist()
    zip_ref.extractall(extract_dir)
    zip_ref.close()
    extracted_file = os.path.join(extract_dir, extracted[0])
</code></pre>
</div>
<span class="comment-copy">What if there are multiple files in the zip?</span>
<span class="comment-copy">That's not a zipfile issue. If you extracted files to a specific location (and you obviously know the location), and you want to get the files from there, you'll have to e.g. <code>os.walk</code> in that dir to get all files into a data structure.</span>
<span class="comment-copy">If you don't supply a <code>path</code> arg to <code>ZipFile.extract</code> the archive members are extracted to the current working dir. You can get the list of archive members by name with <a href="https://docs.python.org/3/library/zipfile.html#zipfile.ZipFile.namelist" rel="nofollow noreferrer"><code>zip_ref.namelist()</code></a>.</span>
<span class="comment-copy">@WillemVanOnsem then I would use extractall but that isn't a problem right now.</span>
<span class="comment-copy">@PM2Ring I'll try using that i was just trying to do it a bit cleaner by using the <code>targetpath</code> the is is returned to the extract function in zipfile</span>
