<div class="post-text" itemprop="text">
<pre><code>from scapy.all import *


pkts = rdpcap("lalalao.pcap")

for p in pkts:
##  print p.time


        if IP in p: #if packet has IP layer
                    src_ip = p[IP].src
                    dest_ip = p[IP].dst
                    print src_ip

                    f = open('IP_src.txt', 'a+')
                    for ip in src_ip:
                            f.writelines(ip)

                    f.close()
</code></pre>
<p>How to write each ip in a different line of the text file? The code is not working!</p>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/io.html#io.IOBase.writelines" rel="nofollow noreferrer"><code>writelines</code></a> does not add newline.</p>
<blockquote>
<p>Write a list of lines to the stream. <strong>Line separators
  are not added</strong>, so it is usual for each of the lines provided to have a
  line separator at the end.</p>
</blockquote>
<hr/>
<p>Use <a href="https://docs.python.org/2/reference/simple_stmts.html#the-print-statement" rel="nofollow noreferrer"><code>print</code> statement</a> (<a href="https://docs.python.org/3/library/functions.html#print" rel="nofollow noreferrer"><code>print</code> function</a> in Python 3.x) which write newline at the end of the string:</p>
<pre><code>with open('IP_src.txt', 'a+') as f:
    for ip in src_ip:
        print &gt;&gt;f, ip         # Python 2.x
        # print(ip, file=f)   # Python 3.x
</code></pre>
<p>Or append the line manually:</p>
<pre><code>with open('IP_src.txt', 'a+') as f:
    for ip in src_ip:
        f.write(ip + '\n')
</code></pre>
</div>
