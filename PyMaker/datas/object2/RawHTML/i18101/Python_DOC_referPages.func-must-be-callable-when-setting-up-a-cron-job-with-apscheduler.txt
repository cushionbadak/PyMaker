<div class="post-text" itemprop="text">
<p>My intent is to have a random message from a list tweeted once a week on a random day at a random time between 2am and 6am. I'm using APScheduler:</p>
<pre><code>sched.add_cron_job(postTweet(messages[random.randint(0, len(messages))]), day_of_week="0-6/6", hour='2-6/3')
</code></pre>
<p>I'm getting the error:</p>
<pre><code>Traceback (most recent call last):
    File "/app/.heroku/python/lib/python2.7/site-packages/apscheduler/scheduler.py", line 379, in add_cron_job
        sched.add_cron_job(postTweet(messages[random.randint(0, len(messages))]), day_of_week="0-6/6", hour='2-6/3')
        options.pop('coalesce', self.coalesce), **options)
    File "/app/.heroku/python/lib/python2.7/site-packages/apscheduler/job.py", line 47, in __init__
        raise TypeError('func must be callable')
    TypeError: func must be callable
        return self.add_job(trigger, func, args, kwargs, **options)
</code></pre>
<p>I'm not sure what the error means, much less how to fix it. Any enlightenment of what to look into would be greatly appreciated. </p>
<p>EDIT:</p>
<p>The code for postTweet:</p>
<pre><code>def postTweet(message):
    log = open('log', 'a')
    log.write("\nMessage being tweeted: %s \n" % message)
    print "Message being tweeted: %s" % message
    twitter.statuses.update(status=message)
    log.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Your <code>func</code> isn't a function, just like it says. You are <em>calling</em> <code>PostTweet</code> and passing the result (probably a string or <code>None</code>, but definitely not a function) to <code>add_cron_job</code>. That dog won't hunt, monsignor. Stick a <code>lambda:</code> in front of it:</p>
<pre><code>sched.add_cron_job(lambda: postTweet(messages[random.randint(0, len(messages))]),
                   day_of_week="0-6/6", hour='2-6/3')
</code></pre>
<p>This creates a function that can be called at a later time, rather than executing it <em>before</em> the job is added.</p>
</div>
<div class="post-text" itemprop="text">
<p>I know I'm late but want to help others like me.</p>
<p>You can pass the payload using the args as </p>
<pre><code>scheduler.add_job(postTweet, day_of_week="0-6/6", hour='2-6/3' args='Your Payload as dict')
</code></pre>
</div>
<span class="comment-copy">A few side notes: First, <code>random.randint(0, len(messages))</code> includes <code>len(messages)</code> as a possible value, so it can raise an <code>IndexError</code>. As the docs for <a href="http://docs.python.org/3/library/random.html#random.randrange" rel="nofollow noreferrer"><code>randint</code></a> imply, you almost certainly want <code>random.randrange(len(messages))</code>. But really, if the only reason you're picking a random number is to use as an index, you just want <code>random.choice(messages)</code>.</span>
<span class="comment-copy">Thanks for the tip!</span>
<span class="comment-copy">This makes sense to me and I changed my code accordingly and redeployed. However I'm not getting another error that I don't understand:  Exception in thread APScheduler (most likely raised during interpreter shutdown): File "/app/.heroku/python/lib/python2.7/threading.py", line 810, in __bootstrap_inner Traceback (most recent call last): File "/app/.heroku/python/lib/python2.7/threading.py", line 354, in wait File "/app/.heroku/python/lib/python2.7/threading.py", line 620, in wait ile "/app/.heroku/python/lib/python2.7/threading.py", line 763, in run</span>
<span class="comment-copy">&lt;type 'exceptions.TypeError'&gt;: 'NoneType' object is not callable File "/app/.heroku/python/lib/python2.7/site-packages/apscheduler/scheduler.py", line 589, in _main_loop</span>
<span class="comment-copy">@Kayra: Each question should be a single questionâ€”something that will be useful to future searchers with a similar problem. If kindall has solved your problem, and you now have a new one, accept this answer, then create a new question.</span>
