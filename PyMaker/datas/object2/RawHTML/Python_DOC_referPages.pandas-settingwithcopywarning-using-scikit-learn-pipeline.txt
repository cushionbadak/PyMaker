<div class="post-text" itemprop="text">
<p>I'm using very simple code :</p>
<pre><code>simplePipe = Pipeline([
('string_fix', StringFix()),
])
class StringFix(BaseEstimator, TransformerMixin):
    def __init__(self):
        pass

    def fit(self, X, y = None):
        return self

    def transform(self, X, y = None):
        print('Removing NANs.')
        # next 2 lines will throw the SettingWithCopyWarning 
        X.loc[:, 'f1'] = 'testing'
        X.loc[:, 'f1'].replace(np.nan, '', inplace = True)
        # this line doesn't throw the warning but it is expected not 
        # modifying the dataframe.
        X.loc[:, 'f1'].replace(np.nan, '', inplace = False)
        return X
</code></pre>
<p>Interestingly (or not), when I execute this :</p>
<pre><code>trainSetDF = simplePipe.fit_transform(inputDF[:4])
</code></pre>
<p>It warns with </p>
<pre><code>A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead
</code></pre>
<p>But not when I execute directly outside of the scikit learn Pipeline :</p>
<pre><code>inputDF.loc[0:4, 'f1'] = 'testing'
</code></pre>
<p>Am I missing something here? I've spent a fair amount of time trying to understand <a href="http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#indexing-view-versus-copy" rel="nofollow noreferrer">why this warning is</a>. And now that I get it, I fixed some code but regardless of what I seem to be doing inside the Pipeline, I consistently get this warning. Is the Pipeline itself doing stuff I don't want? Even if I remove the "return X" which could do things I don't know like copy an array or something, I still get this warning.</p>
<p>Any ideas on what I might be doing wrong?</p>
</div>
<div class="post-text" itemprop="text">
<p><code>trainSetDF = simplePipe.fit_transform(inputDF.iloc[:4][:])</code></p>
</div>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/20625582/how-to-deal-with-settingwithcopywarning-in-pandas">How to deal with SettingWithCopyWarning in Pandas?</a></span>
<span class="comment-copy">Wish it was a duplicate but I can't see it being one since the .loc[index, col] works outside of the scikit learn pipeline but not inside of it... :(</span>
<span class="comment-copy">Here you set <code>inplace=False</code>, hence you need to assign the result to something. That's why it doesn't modify <code>X</code>.          <code>X.loc[:, 'f1'].replace(np.nan, '', inplace = False)  # NO WARN BUT                                                              # DOES NOT ALTER X</code></span>
<span class="comment-copy">Thanks but let me clarify my question/issue. It is around <code>inplace = True</code> or the direct assignment (<code>X.loc[:, 'f1'] = 'testing'</code>) throwing both s a warning. This is what I'm not getting... and when I run the same line outside of the Pipeline, it works without a warning.</span>
<span class="comment-copy">I believe the problem is in the way you input your dataframe as an argument to the function. Try the solution I posted</span>
<span class="comment-copy">you're awesome, Gio! :) thanks a ton!</span>
<span class="comment-copy">no prob, don't forget to upvote/mark the answer as correct =)</span>
<span class="comment-copy">my reputation is still too low so that my vote can show :( but I did mark it correct and upvote it! Just need a bump of 2 in my reputation, hopefully soon.</span>
