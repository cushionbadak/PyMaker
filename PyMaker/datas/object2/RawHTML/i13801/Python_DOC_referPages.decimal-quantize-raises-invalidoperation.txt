<div class="post-text" itemprop="text">
<p>looking at <code>Decimal</code> i tried to convert <code>pi</code> to various precisions. i can call <code>pi.quantize()</code> with the first two options below but it raises an <code>InvalidOperation</code> with the third option. the precision of <code>pi</code> is nowhere near that...</p>
<pre><code>from decimal import Decimal

pi  = Decimal('3.1415926535897932384626433832795028841971693993751058209749445'
              '923078164062862089986280348253421170679')
print(pi) # prints same as the string above

# just print formatted
print('{:1.7f}'.format(pi))

print(pi.quantize(Decimal('1.0')))     # 3.1
print(pi.quantize(Decimal('1.00')))    # 3.14
print(pi.quantize(Decimal('1.000')))   # raises InvalidOperation
</code></pre>
<p>what is happening here? have i misunderstood what this function should do? why does this exception occur at <code>1.000</code> and not before/after?</p>
<p>the same exception happens with <code>'0.001'</code> as argument for <code>quantize</code>.</p>
</div>
<div class="post-text" itemprop="text">
<p>Per <a href="https://docs.python.org/3/library/decimal.html#decimal.Decimal.quantize" rel="noreferrer">the documentation</a>:</p>
<blockquote>
<p>...if the length of the coefficient after the quantize operation would be
  greater than precision, then an <code>InvalidOperation</code> is signaled.</p>
</blockquote>
<p>Therefore your precision must be set to <code>3</code>; to check this, try:</p>
<pre><code>from decimal import Decimal, getcontext

print(getcontext().prec)
</code></pre>
<p>You should read through the documentation on <a href="https://docs.python.org/3/library/decimal.html#context-objects" rel="noreferrer">contexts</a> to understand what they're for and how to use them. For example, you could try:</p>
<pre><code>from decimal import Context, Decimal, getcontext

...

print(pi.quantize(Decimal('1.000'), Context(prec=4))) 
</code></pre>
</div>
<span class="comment-copy">Could not replicate - works fine for me on Python 3.4.3 on Yosemite.</span>
<span class="comment-copy"><code>python3 3.4.0-0ubuntu2 amd64</code> on <code>ubuntu 14.04.2</code>. hmmm...</span>
<span class="comment-copy">That's not how this works. <b>The answer</b> is there <i>"for future reference"</i>.</span>
<span class="comment-copy">oh, you are right. i <b>did</b> check <code>DefaultContext</code>; there the precision was 12; but you statement prints 3. thanks! the fix is <code>ctx = getcontext(); ctx.prec = 12</code>, right?</span>
<span class="comment-copy">@hiroprotagonist there are various options; I've added another to my answer. Again, read up on contexts to figure out what will work best for you.</span>
