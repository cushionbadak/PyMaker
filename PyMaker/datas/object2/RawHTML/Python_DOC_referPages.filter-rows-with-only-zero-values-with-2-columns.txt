<div class="post-text" itemprop="text">
<p><strong>Sample DF:</strong></p>
<pre><code>ID   Name        Price     Amount      Fit_Test
1    Apple         10      15        Super_Fit
2    Apple         10      0          Super_Fit
3    Apple         10      0          Super_Fit
4    Orange        12      20          Not_Fit
5    Orange        12      0          Not_Fit
6    Banana        15      17          Medium_Fit
7    Banana        15      0         Medium_Fit
8    Pineapple     25      19          Medium_Fit
9    Pineapple     25      18          Medium_Fit
10   Cherry        30      56         Super_Fit
11   XXX           50      0          Medium_Fit
12   XXX           50      0          Medium_Fit
</code></pre>
<p><strong>Expected DF:</strong></p>
<pre><code>    ID   Name        Price     Amount           Fit_Test
1    Apple         10           15              Super_Fit
2    Apple         10           0               Super_Fit
3    Apple         10           0               Super_Fit
4    Orange        12           20              Not_Fit

6    Banana        15           17              Medium_Fit

8    Pineapple     25           19              Medium_Fit
9    Pineapple     25           18              Medium_Fit
10   Cherry        30           56              Super_Fit
11   XXX           50            0          Medium_Fit
12   XXX           50             0          Medium_Fit
</code></pre>
<p><strong>Problem Statement:</strong></p>
<p>I want to <code>group-by</code> by <code>Name</code> and <code>Price</code> and then filter based on <code>Amount</code> with <code>Fit_Test</code> as conditional column.</p>
<ol>
<li><p>If Fit_Test is <code>Super_Fit</code> then don't the no operation is needed. <strong>(Rows 1,2,3 and 10 is same in Input and Expected DF)</strong></p></li>
<li><p>If within a <code>Name</code> and <code>Price</code> conditions and Fit_Test is not <code>Super_Fit</code>, check if it has a <code>Amount</code> as <code>0</code> then and only then remove that row <strong>(ID 4,5,6,7 and in Expected 5 &amp; 7 are deleted)</strong></p></li>
<li><p>If within a <code>Name</code> and <code>Price</code> conditions &amp; Fit_Test is not <code>Super_Fit</code> if contract amount has values greater than zero then <strong>don't</strong> remove any rows <strong>(Rows 8 &amp; 9 is same in Input and Expected DF)</strong></p></li>
<li><p>If within a <code>Name</code> and <code>Price</code> conditions &amp; Fit_Test is not <code>Super_Fit</code> if contract amount has all values equal to zero then <strong>don't</strong> remove any rows <strong>(Rows 11 &amp; 12 is same in Input and Expected DF)</strong></p></li>
</ol>
<p>I can do solution where it removes all zero but no help with conditional column</p>
</div>
<div class="post-text" itemprop="text">
<p>You can chain 2 conditions - compare <code>Fit_Test</code> and check if all <code>True</code>s per groups by <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.transform.html" rel="nofollow noreferrer"><code>GroupBy.transform</code></a> and <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.core.groupby.GroupBy.all.html" rel="nofollow noreferrer"><code>GroupBy.all</code></a> and for second compare for not equal:</p>
<pre><code>m1 = df['Fit_Test'].eq('Super_Fit').groupby([df['Name'],df['Price']]).transform('all')
m2 = df['Amount'].ne(0)

df = df[m1 | m2]
print (df)
   ID       Name  Price  Amount    Fit_Test
0   1      Apple     10      15   Super_Fit
1   2      Apple     10       0   Super_Fit
2   3      Apple     10       0   Super_Fit
3   4     Orange     12      20     Not_Fit
5   6     Banana     15      17  Medium_Fit
7   8  Pineapple     25      19  Medium_Fit
8   9  Pineapple     25      18  Medium_Fit
9  10     Cherry     30      56   Super_Fit
</code></pre>
</div>
<span class="comment-copy">It is not working I think because when I do <code>type(df['Amount'][0])</code> it is coming as <code>str</code>. Should I change this to float/numeric to work ?</span>
<span class="comment-copy">@RahulAgarwal - How working if change <code>m2 = df['Amount'].ne(0)</code> to <code>m2 = df['Amount'].ne('0')</code> ?</span>
<span class="comment-copy">Or use <code>df['Amount'] = pd.to_numeric(df['Amount'])</code></span>
<span class="comment-copy">In <code>m2</code> if instead of not equal to zero, I have to compare and see the greatest value within a group...how will it change ?</span>
<span class="comment-copy">@RahulAgarwal - do you think <code>m2 = df['Amount'].eq(df.groupby(['Name', 'Price'])['Amount'].transform('max'))</code> ?</span>
