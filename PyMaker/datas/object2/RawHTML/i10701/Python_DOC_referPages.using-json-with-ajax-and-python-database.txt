<div class="post-text" itemprop="text">
<p>I am new to python and am trying to access the db though python and return some results in a JSON array using AJAX.<br/>
I test it by returning a JSON list and alerting it using js. it works when I don't use the db connection but as soon as I add it the js alert stops too. the db connection seems to work properly when I run the file <code>getSchedule.py</code>. the db connection is in a separate file <code>webairdb.py</code><br/>
Can someone please try to help me figure out whats wrong?</p>
<h3>getSchedule.py</h3>
<pre><code>#!D:/Programming/Software/python3.4.4/python
import sys, json,cgi, cgitb, mysql.connector, webairdb

cgitb.enable()
fs = cgi.FieldStorage()

sys.stdout.write("Content-Type: application/json")

sys.stdout.write("\n")
sys.stdout.write("\n")

conn = webairdb.getConnection()
conn.close()

listr = [11111]

sys.stdout.write(json.dumps(listr))
sys.stdout.write("\n")

sys.stdout.close()
</code></pre>
<h3>webairdb.py</h3>
<pre><code>#!D:/Programming/Software/python3.4.4/python
import cgi, cgitb, imp, mysql.connector

host ="localhost"
db = "webair"
user = "root"
password = ""

def getConnection():
    conn =   mysql.connector.connect(user=user,password=password,host=host,database=db)
    if conn.is_connected():
        print("aaaqqqq")
    return conn
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>In <strong>webairdb.py</strong> you write to <code>sys.stdout</code> (that is what <code>print</code> does) - putting effectively breaking the json output. (You might want to have a look at the output by pressing F12 in your browser)</p>
<p>So just remove it and either write to <code>sys.stderr</code> or use <a href="https://docs.python.org/3/howto/logging.html#logging-basic-tutorial" rel="nofollow">logging</a> instead.</p>
<p>You should also consider using <a href="https://docs.python.org/3/library/wsgiref.html" rel="nofollow">wsgi</a> instead of cgi which makes things a bit easier (no need to care about printing at all) or a framework like <a href="http://bottlepy.org" rel="nofollow">bottle</a> or <a href="http://cherrypy.org/" rel="nofollow">cherrypy</a>.</p>
</div>
<span class="comment-copy">Thanx a lot. I was asked to do this without using any frameworks.</span>
