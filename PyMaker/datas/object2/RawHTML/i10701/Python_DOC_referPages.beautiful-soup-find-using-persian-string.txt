<div class="post-text" itemprop="text">
<p>I want to find all elements containing a string using Beautiful Soup in Python.</p>
<p>It works when I use non-Persian characters, but not when I use Persian characters.</p>
<pre><code>from bs4 import BeautifulSoup
QUERY = 'رشته فارسی'
URL = 'http://www.example.com'
headers = {
  'User-Agent': "Mozilla/5.0 . . . "
}
request = urllib2.Request(URL, headers=headers)
response = urllib2.urlopen(request)
response_content = response.read().decode('utf8')
soup = BeautifulSoup(response_content, 'html.parser')
fetched = soup.find_all(text=QUERY)
print(fetched)
</code></pre>
<p>For the code above, the output is <code>[]</code>, but it works if I use ASCII in the query.</p>
<p>Is there any UTF-8 conversion or something to solve it :) ?</p>
</div>
<div class="post-text" itemprop="text">
<pre class="lang-py prettyprint-override"><code>    #-*- coding: utf-8 -*-
    import urllib2
    from bs4 import BeautifulSoup
    QUERY = 'خدمات'
    URL = 'https://bayan.ir/service/bayan/'
    headers = {
          'User-Agent': "Mozilla/5.0 . . . "
    }
    request = urllib2.Request(URL, headers=headers)
    response = urllib2.urlopen(request)
    response_content = response.read()
    soup = BeautifulSoup(response_content, 'html.parser')
    fetched = soup.find_all(string=QUERY)
    print(fetched)
</code></pre>
<p>It works!</p>
</div>
<span class="comment-copy">You need to match the encoding on the page</span>
<span class="comment-copy">@PadraicCunningham how can I do it ?</span>
<span class="comment-copy">shouldn't you use utf-8 or UTF-8 instead of utf8 ?</span>
<span class="comment-copy">You are using Python 3, right? I dont know persian but have you tried <a href="https://docs.python.org/3/library/unicodedata.html#unicodedata.normalize" rel="nofollow noreferrer">normalizing</a> <code>QUERY</code> and <code>response_content</code>? Just because 2 strings look the same, they dont have to consist of the same codepoints (they dont have to look the same for the computer).</span>
<span class="comment-copy">When you <code>print(repr(QUERY))</code> what do you see?</span>
<span class="comment-copy"><b>you must send exact string</b> check <a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/#the-string-argument" rel="nofollow noreferrer">BeautifulSoup</a></span>
