<div class="post-text" itemprop="text">
<p>How can I get <code>argparse</code> to parse an option with two arguments, which might exist multiple times? Like this:</p>
<pre><code>$ cmd --repo origin here --repo other there --repo upstream url3
</code></pre>
<p>And the parsed arguments should be accessible for example like this:</p>
<pre><code>args.repo = [('origin', 'here'), ('other', 'there'), ('upstream', 'url3')]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>import argparse
parser = argparse.ArgumentParser()
parser.add_argument('--repo', nargs=2, action='append')
parser.parse_args('--repo origin here --repo other there'.split())
</code></pre>
<p>Result:</p>
<pre><code>Namespace(repo=[['origin', 'here'], ['other', 'there']])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You should use append action.</p>
<p>From argparse documentation:</p>
<p><code>append</code> - This stores a list, and appends each argument value to the list. This is useful to allow an option to be specified multiple times. </p>
<p>Example usage:</p>
<pre><code>&gt;&gt;&gt; parser = argparse.ArgumentParser()
&gt;&gt;&gt; parser.add_argument('--foo', nargs='*', action='append')
&gt;&gt;&gt; parser.parse_args('--foo 1 2 --foo 3 4'.split())

Namespace(foo=[['1', '2'], ['3', '4']])
</code></pre>
<p>Source: <a href="https://docs.python.org/3/library/argparse.html#action" rel="nofollow">https://docs.python.org/3/library/argparse.html#action</a></p>
<p>You might also want to take a look at docopt project, which is by me the best Python argument parser package:</p>
<ul>
<li><a href="http://docopt.org" rel="nofollow">http://docopt.org</a></li>
<li><a href="https://pypi.python.org/pypi/docopt" rel="nofollow">https://pypi.python.org/pypi/docopt</a></li>
</ul>
</div>
