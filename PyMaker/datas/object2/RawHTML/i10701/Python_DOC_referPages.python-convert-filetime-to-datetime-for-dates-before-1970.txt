<div class="post-text" itemprop="text">
<p>I need to convert filetime to datetime. I am using this code <a href="http://reliablybroken.com/b/wp-content/filetimes.py/%22filetime.py%22" rel="nofollow noreferrer">filetime.py</a>, from <a href="https://stackoverflow.com/questions/3694487/python-initialize-a-datetime-object-with-seconds-since-epoch/%22here2%22">here</a> as mentioned in this thread <a href="https://stackoverflow.com/questions/6408077/datetime-to-filetime-python">Datetime to filetime (Python)</a>.  </p>
<p>In the code </p>
<pre><code>EPOCH_AS_FILETIME = 116444736000000000  # January 1, 1970 as MS file time
HUNDREDS_OF_NANOSECONDS = 10000000

def filetime_to_dt(ft):
    """Converts a Microsoft filetime number to a Python datetime. The new datetime object is time zone-naive but is equivalent to tzinfo=utc.

    &gt;&gt;&gt; filetime_to_dt(116444736000000000)
    datetime.datetime(1970, 1, 1, 0, 0)
    """
    # Get seconds and remainder in terms of Unix epoch
    (s, ns100) = divmod(ft - EPOCH_AS_FILETIME, HUNDREDS_OF_NANOSECONDS)
    # Convert to datetime object
    dt = datetime.utcfromtimestamp(s)
    # Add remainder in as microseconds. Python 3.2 requires an integer
    dt = dt.replace(microsecond=(ns100 // 10))
    return dt
</code></pre>
<p><code>datetime.utcfromtimestamp</code> does not take negative value on windows system, so I can't convert filetime before Jan 1st 1970. But I can convert dates before 1970 on Mac using the exact same code (reason <a href="https://stackoverflow.com/questions/3694487/python-initialize-a-datetime-object-with-seconds-since-epoch/%22here2%22">here</a>). Is there any workaround for windows? </p>
</div>
<div class="post-text" itemprop="text">
<p>By adding a <code>timedelta</code> to a reference date you can use any date formula you'd like. <code>timedelta</code> is allowed to be positive or negative.</p>
<pre><code>def filetime_to_dt(ft):
    us = (ft - EPOCH_AS_FILETIME) // 10
    return datetime(1970, 1, 1) + timedelta(microseconds = us)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/datetime.html#datetime.datetime.utcfromtimestamp" rel="nofollow">According to docs</a>, you have to use: </p>
<pre><code>dt = datetime.fromtimestamp(s, datetime.timezone.utc)
</code></pre>
<p>instead of:</p>
<pre><code>dt = datetime.utcfromtimestamp(s)
</code></pre>
</div>
<span class="comment-copy">So all you mean is that you want to convert some epoch time in normal date time right?</span>
<span class="comment-copy">sorry, I am using <code>import datetime datetime.timezone.utc</code> give the error "AttributeError: 'module' object has no attribute 'timezone' ". Why is that?</span>
<span class="comment-copy">@Echo: Maybe you are not using Python 3?</span>
<span class="comment-copy">I am using Python 2</span>
