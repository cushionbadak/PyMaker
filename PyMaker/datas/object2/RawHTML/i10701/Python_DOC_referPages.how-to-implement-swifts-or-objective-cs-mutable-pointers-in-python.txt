<div class="post-text" itemprop="text">
<p>The following function requires a "mutable pointer". How do I represent that in Python?</p>
<p>Swift:</p>
<pre><code>func CGPDFDocumentGetVersion(
  _ document: CGPDFDocument?,
  _ majorVersion: UnsafeMutablePointer&lt;Int32&gt;,
  _ minorVersion: UnsafeMutablePointer&lt;Int32&gt;
)
</code></pre>
<p>Objective-C:</p>
<pre><code>void CGPDFDocumentGetVersion (
  CGPDFDocumentRef document,
  int *majorVersion,
  int *minorVersion
);
</code></pre>
<p>Seems a bit mad that the function returns values in this way, nonetheless.</p>
<p>I've tried just supplying variables, already assigned to empty values, but I get a segmentation fault. If the variables are undefined, I get:</p>
<pre class="lang-none prettyprint-override"><code>NameError: name 'x' is not defined
</code></pre>
<p>Here's some code that causes a Sgmentation fault. It's very easy to get these if CoreGraphics doesn't like the input.</p>
<pre><code>file = "/path/to/file.pdf"
pdf = CGPDFDocumentCreateWithProvider(CGDataProviderCreateWithFilename(file))
x = None
y = None
version = CGPDFDocumentGetVersion(pdf, x, y)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You don't need mutable pointers at all.  There are two common uses for pointers to <code>int</code> (or similar storage) in C-like code, and Python provides better ways to do both.</p>
<h2>Case 1:  Multiple return values</h2>
<p>A C-like function can't return more than one value without defining a new <code>struct</code> and allocating memory for it.  That's tedious enough the job is often foisted off onto the calling function, which provides pointers to the storage <em>it</em> has allocated in advance.</p>
<p>In Python, you'd just return an object... in your case, a <code>tuple</code> or <a href="https://docs.python.org/3/library/collections.html#collections.namedtuple" rel="nofollow"><code>namedtuple</code></a>:</p>
<pre><code>import collections

Version = collections.namedtuple(
  'Version',
  ('major', 'minor'),
  )

class PDFDocument:

    def __init__(self, ...):
        # Figure out major and minor version numbers, then...
        self.version = Version(major, minor)

pdf_doc = PDFDocument(...)
major, minor = pdf_doc.version
...
</code></pre>
<h2>Case 2: Announcing Errors</h2>
<p>A C-like function that needs to signal that an error has occurred will typically return some "illegal" value.  If there <em>is</em> no such value it can use, an alternative is to take a pointer to some storage the caller owns, where it will scribble its exit status on its way out.</p>
<p>In Python, you'd just <code>raise</code> an exception, which is better in almost every way.</p>
</div>
<span class="comment-copy">can you provide your code in python?</span>
<span class="comment-copy">How are you getting a <i>segmentation fault</i> from Python code?  Please <a href="https://stackoverflow.com/posts/38950942/edit">edit</a> your question to provide us a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a>.</span>
<span class="comment-copy">You're assigning <code>None</code> to <code>pdf_doc</code> (the output of <code>CGPDFDocumentCreateWithProvider</code>... whatever that is).  But this is far from what your question originally asked.  You were originally trying to translate an Objective-C construct --- mutable pointers --- into Python.  Now (it looks like) you're trying to work with some Python package that already exists.  So either <a href="https://stackoverflow.com/posts/38950942/edit">edit</a> your question so that there is a single, coherent, specific question --- with enough relevant code provided so we can figure out what you're doing --- or ask your new question as... well, a new question.</span>
<span class="comment-copy">The package is OS X CoreGraphics. Are you saying the last line of the code gives pdf_doc the value None? All I'm trying to do is get the version number of a PDF document, using the method described in ObjC and Swift above. But the pointers flummoxed me.</span>
<span class="comment-copy">Please don't replace answered questions with another, different question. Please post a <i>new</i> question post instead.</span>
<span class="comment-copy">Thanks for this. I'm not sure what replaces the dots after "self," though. I'll add my code to the question, because formatting in Comments is rubbish.</span>
<span class="comment-copy">@benwiggy:  The ellipses represent whatever you think would create a useful <code>PDFDocument</code> class.</span>
<span class="comment-copy">@Kevin-J-Chase I have no idea what that might be. I've tried a number of things: object attributes, assigned variables, CoreGraphics object names, and I keep getting the same error.</span>
<span class="comment-copy">I still don't understand how the PDF class is supposed to work in relation to the original code.</span>
