<div class="post-text" itemprop="text">
<p>I want to use Python to monitor a website that uses HTTPS.
The problem is that the certificate on the website is invalid.
I don't care about that, I just want to know that the website is running.</p>
<p>My working code looks like this:</p>
<pre><code>from urllib.request import Request, urlopen
from urllib.error import URLError, HTTPError
req = Request("https://somedomain.com")

try:
    response = urlopen(req)
except HTTPError as e:
    print('server couldn\'t fulfill the request')
    print('error code: ', e.code)
except URLError as e:
        print(e.args)       
else:
    print ('website ok')
</code></pre>
<p>that ends in URLError being called. The error code is 645.</p>
<pre><code>C:\python&gt;python monitor443.py
(SSLError(1, '[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:645)'),)
</code></pre>
<p>So, I'm trying to except code 645 as OK. I've tried this:</p>
<pre><code>from urllib.request import Request, urlopen
from urllib.error import URLError, HTTPError
req = Request("https://somedomain.com")

try:
    response = urlopen(req)
except HTTPError as e:
    print('server couldn\'t fulfill the request')
    print('error code: ', e.code)
except URLError as e:
        if e.code == 645:
            print("ok")
        print(e.args)       
else:
    print ('website ok')
</code></pre>
<p>but get this error:</p>
<pre><code>Traceback (most recent call last):
  File "monitor443.py", line 11, in &lt;module&gt;
    if e.code == 645:
AttributeError: 'URLError' object has no attribute 'code'
</code></pre>
<p>how do I add this exception?</p>
</div>
<div class="post-text" itemprop="text">
<p>Please have a look at the great <code>requests</code> package. It will simplify your life when doing http communication. See <a href="http://requests.readthedocs.io/en/master/" rel="nofollow">http://requests.readthedocs.io/en/master/</a>.</p>
<pre><code>pip install requests
</code></pre>
<p>To skip certificate check, you would do something like this (note the <code>verify</code> parameter!):</p>
<pre><code>requests.get('https://kennethreitz.com', verify=False)
&lt;Response [200]&gt;
</code></pre>
<p>See the full documentation <a href="http://docs.python-requests.org/en/master/user/advanced/" rel="nofollow">here</a>.</p>
<p>HTH</p>
</div>
<div class="post-text" itemprop="text">
<p>I couldn't install the SLL library (egg_info error).
This is what I ended up doing</p>
<pre><code>from urllib.request import Request, urlopen
from urllib.error import URLError, HTTPError

def sendEmail(r):    
    #send notification
    print('send notify')

req = Request("https://somedomain.com")

try:
    response = urlopen(req)
except HTTPError as e:
    print('server couldn\'t fulfill the request')
    print('error code: ', e.code)
    sendEmail('server couldn\'t fulfill the request')
except URLError as e:
        theReason=str(e.reason)
        #[SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:645)
        if theReason.find('CERTIFICATE_VERIFY_FAILED') == -1:
            sendEmail(theReason)
        else:
            print('website ok')         
else:
    print('website ok')
</code></pre>
</div>
<span class="comment-copy"><a href="http://stackoverflow.com/q/38773209/344286"><code>URLError</code> is a subclass of OSError</a> might it be found in <a href="https://docs.python.org/3/library/exceptions.html#OSError.errno" rel="nofollow noreferrer"><code>e.errno</code></a>?</span>
<span class="comment-copy">e.errno returns "none"</span>
<span class="comment-copy">Also... 645 isn't the errorno, that's the line of C source that the error occurred on, AFAIK.</span>
<span class="comment-copy">Can you not just catch the <a href="https://docs.python.org/dev/library/ssl.html#ssl.SSLError" rel="nofollow noreferrer">SSLError</a>?</span>
