<div class="post-text" itemprop="text">
<p>I am trying to run this code:</p>
<pre><code>import xlrd
import os.path
import xlsxwriter

with open("arrays.xlsx", "a") as my_file:
    workbook = xlsxwriter.Workbook(my_file)
    worksheet = workbook.add_worksheet()
    array = [1, 2, 3, 4, 5]
    row = 0
    for col, data in enumerate(array):
        worksheet.write_column(row, 0, array)

workbook.close()
</code></pre>
<p>But when I run it, I get the following error:</p>
<pre class="lang-none prettyprint-override"><code>Traceback (most recent call last):
File "C:\Users\hp\Anaconda3\lib\zipfile.py", line 1649, in __del__
self.close()
File "C:\Users\hp\Anaconda3\lib\zipfile.py", line 1666, in close
self.fp.seek(self.start_dir)
ValueError: I/O operation on closed file.
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>With <a href="https://docs.python.org/3/reference/compound_stmts.html#with" rel="nofollow noreferrer"><code>with</code></a> you don't actually need to close the file. </p>
<blockquote>
<p>The <code>with</code> statement is used to wrap the execution of a block with
  methods defined by a context manager (see section <a href="https://docs.python.org/3/reference/datamodel.html#context-managers" rel="nofollow noreferrer">With Statement
  Context Managers</a>). This allows common <a href="https://docs.python.org/3/reference/compound_stmts.html#except" rel="nofollow noreferrer"><code>try...except...finally</code></a> usage
  patterns to be encapsulated for convenient reuse.</p>
</blockquote>
<p>The implicit finally block which is hidden here will close the file for you. Just remove your explicit close and you will be fine.</p>
</div>
<span class="comment-copy">It looks like you are trying to append to an xlsx file with XlsxWriter. However you can't append to a binary Excel file and XlsxWriter doesn't support rewriting files. Try OpenPyXL.</span>
<span class="comment-copy">Did you try my answer?</span>
<span class="comment-copy">@e4c5  Yes Sir, it works. Thank you.</span>
<span class="comment-copy">Okay sure, Sir. I was unaware of this. Thanks for telling me.</span>
<span class="comment-copy">It shows this error Sir- Exception: Exception caught in workbook destructor. Explicit close() may be required for workbook.</span>
<span class="comment-copy">in that case what you should take out is the with block :-)</span>
<span class="comment-copy">@NILESHSUTHAR: I would try moving the <code>workbook.close()</code> so it's at the end of the <code>with</code> block (as opposed to not using a <code>with</code>, which is a very good practice).</span>
