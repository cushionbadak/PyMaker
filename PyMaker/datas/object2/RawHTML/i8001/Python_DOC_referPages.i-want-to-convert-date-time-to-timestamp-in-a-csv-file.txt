<div class="post-text" itemprop="text">
<p>I want to convert datetime to timestamp in a csv file. The datetime format is in the 8th column of my csv file. Please help. Thanks in advance.
This is what i have so far.</p>
<p>This is pollution data(pollution.csv)The last column is in datetime format</p>
<p>ozone,particullate_matter,carbon_monoxide,sulfure_dioxide,nitrogen_dioxide,longitude,latitude,datetime</p>
<pre><code>101,94,49,44,87,10.104986076057457,56.23172069428216,2014-08-01 00:05:00
106,97,48,47,86,10.104986076057457,56.23172069428216,2014-08-01 00:10:00
107,95,49,42,85,10.104986076057457,56.23172069428216,2014-08-01 00:15:00
103,90,51,44,87,10.104986076057457,56.23172069428216,2014-08-01 00:20:00
105,94,49,39,82,10.104986076057457,56.23172069428216,2014-08-01 00:25:00
106,92,48,42,77,10.104986076057457,56.23172069428216,2014-08-01 00:30:00
110,87,50,40,81,10.104986076057457,56.23172069428216,2014-08-01 00:35:00
106,91,52,36,82,10.104986076057457,56.23172069428216,2014-08-01 00:40:00
106,88,50,40,85,10.104986076057457,56.23172069428216,2014-08-01 00:45:00
</code></pre>
<p>I want to convert the last column to a set of integer values,i.e, Timestamp.</p>
<p>I want my pollution.csv to look like I've shown below.</p>
<p>ozone,particullate_matter,carbon_monoxide,sulfure_dioxide,nitrogen_dioxide,longitude,latitude,datetime</p>
<pre><code>101,94,49,44,87,10.104986076057457,56.23172069428216,1406831700.0
106,97,48,47,86,10.104986076057457,56.23172069428216,1406832000.0
107,95,49,42,85,10.104986076057457,56.23172069428216,1406832300.0
103,90,51,44,87,10.104986076057457,56.23172069428216,1406832600.0
105,94,49,39,82,10.104986076057457,56.23172069428216,1406832900.0
106,92,48,42,77,10.104986076057457,56.23172069428216,1406833200.0
110,87,50,40,81,10.104986076057457,56.23172069428216,1406833500.0
106,91,52,36,82,10.104986076057457,56.23172069428216,1406833800.0
106,88,50,40,85,10.104986076057457,56.23172069428216,1406834100.0
</code></pre>
<p>I want to convert the datetime into timestamp.</p>
<p>What i have done so far</p>
<pre><code>  import time
   t = '2014-08-01 00:05:00'
   ts = time.strptime(t, '%Y-%m-%d  %H:%M:%S')
   timestamp = time.mktime(ts)
   print(timestamp)
</code></pre>
<p>and i was able to get a timestamp value.</p>
<p>My timezone - Wed May 17 16:47:20 IST 2017 ( Indian Standard Time )</p>
</div>
<div class="post-text" itemprop="text">
<p>Try this:</p>
<pre><code>$ awk 'BEGIN{FS=OFS=","} NR&gt;1{$NF=mktime(gensub(/[-:]/," ","g",$NF))}1' file
ozone,particullate_matter,carbon_monoxide,sulfure_dioxide,nitrogen_dioxide,longitude,latitude,datetime
101,94,49,44,87,10.104986076057457,56.23172069428216,1406869500
106,97,48,47,86,10.104986076057457,56.23172069428216,1406869800
107,95,49,42,85,10.104986076057457,56.23172069428216,1406870100
103,90,51,44,87,10.104986076057457,56.23172069428216,1406870400
105,94,49,39,82,10.104986076057457,56.23172069428216,1406870700
106,92,48,42,77,10.104986076057457,56.23172069428216,1406871000
110,87,50,40,81,10.104986076057457,56.23172069428216,1406871300
106,91,52,36,82,10.104986076057457,56.23172069428216,1406871600
106,88,50,40,85,10.104986076057457,56.23172069428216,1406871900
</code></pre>
<p>The above uses GNU awk for mktime() and gensub(). You can add a ".0" at the end of each value if you like but that seems pointless - you'll never actually get a meaningful value in there since all your input is at seconds resolution. The different between this and your expected output is almost certainly due to the timezone the script is run in.</p>
</div>
<div class="post-text" itemprop="text">
<p>What you want is to convert a date string to a timestamp:</p>
<pre><code>import datetime

dt = datetime.datetime.strptime("2014-10-28 19:00:09", "%Y-%m-%d %H:%M:%S")
print(dt.timestamp())
</code></pre>
<p>You get:</p>
<pre><code>1414522809.0
</code></pre>
<p>To read a CSV file, consult the documentation: <a href="https://docs.python.org/3/library/csv.html#csv.reader" rel="nofollow noreferrer">csv</a></p>
<p>Here is an example:</p>
<pre><code>import io
import csv

with open("your_file.csv", mode="r", encoding="utf-8") as fd:
    reader = csv.reader(fd)
    header = next(iter(reader))
    for row in reader:
        print(row[-1])
</code></pre>
<p>You get:</p>
<pre><code>2014-08-01 00:05:00
2014-08-01 00:10:00
2014-08-01 00:15:00
2014-08-01 00:20:00
2014-08-01 00:25:00
2014-08-01 00:30:00
2014-08-01 00:35:00
2014-08-01 00:40:00
2014-08-01 00:45:00
</code></pre>
</div>
<span class="comment-copy">If you have a problem you can post what you've tried with a clear explanation of what isn't working and provide a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a>. I suggest reading <a href="http://stackoverflow.com/help/how-to-ask">How to Ask</a> a good question. Also, be sure to take the <a href="https://stackoverflow.com/tour">tour</a></span>
<span class="comment-copy">I am extremely sorry sir. This is my first time asking a question here. I have corrected the values.</span>
<span class="comment-copy">Thanks a ton sir !! this worked perfectly :). Thank you for your patience in answering my question.</span>
<span class="comment-copy">Thankyou so much ! But i am working on a csv file. I want to convert the whole column into a timestamp. I am new to this concept. Please help.</span>
<span class="comment-copy">Please, read the official doc. You can also consult this site: <a href="https://pymotw.com/3/csv/index.html" rel="nofollow noreferrer">pymotw.com/3/csv/index.html</a></span>
<span class="comment-copy">Thankyou very much :) !</span>
