<div class="post-text" itemprop="text">
<p>I want to download a zip file from a link. The link points to a zip file which I can download to local storage. Now I want to download it in pythonanywhere, which is a cloud python environment</p>
<p>However, it return error <code>zipfile.BadZipfile: File is not a zip file</code></p>
<pre><code>import requests, zipfile, StringIO

r = requests.get('https://www.url', stream=True)
z = zipfile.ZipFile(StringIO.StringIO(r.content))
z.extractall("/home/bybye/shinv")
</code></pre>
<p>How to download it successfully?</p>
</div>
<div class="post-text" itemprop="text">
<p>Are you using Python 3? If you are you need to replace StringIO with ByteIO</p>
<pre><code>import requests, zipfile, io
r = requests.get(zip_file_url)
z = zipfile.ZipFile(io.BytesIO(r.content))
z.extractall()
</code></pre>
<p><a href="https://docs.python.org/3/library/io.html" rel="nofollow noreferrer">Release notes</a></p>
</div>
<span class="comment-copy">Obvious question: how do you know that the file at <code>www.url</code> is a zip file?</span>
<span class="comment-copy">I download it into my PC manually</span>
<span class="comment-copy">Could you add the output of <code>$ file www.url</code> ?</span>
<span class="comment-copy">@malat where I should add <code>$ file www.url</code>?</span>
<span class="comment-copy">From your terminal where you downloaded <code>www.url</code></span>
<span class="comment-copy">I am in python 2.7</span>
<span class="comment-copy">Can you try it with BytesIO instead of StringIO?</span>
<span class="comment-copy">test it but return <code>zipfile.BadZipfile: File is not a zip file</code></span>
<span class="comment-copy">the actual link is here but it require a login <code>https://www.shareinvestor.com/prices/price_download_zip_file.zip?type=history_daily&amp;date=20170517&amp;market=bursa</code>. I have login via selenium before the code above</span>
<span class="comment-copy">Have you dropped the stream=True from your code? If you are streaming the file you'll need to iterate over the the response because it will be chunked.</span>
