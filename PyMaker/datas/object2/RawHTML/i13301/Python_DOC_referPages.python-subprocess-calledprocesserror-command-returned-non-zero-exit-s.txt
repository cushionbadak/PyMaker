<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/27920837/subprocess-check-output-returned-non-zero-exit-status-1">Subprocess check_output returned non-zero exit status 1</a>
<span class="question-originals-answer-count">
                    2 answers
                </span>
</li>
</ul>
</div>
<p>Executing the following script...</p>
<pre><code>import socket                   
import sys                          

from collections import OrderedDict
from subprocess import check_output
from threading import Thread    
</code></pre>
<p>[...]</p>
<pre><code>class IpCheck(Thread):  

    RECEIVED_PACKAGES_RE = re.compile(r'(\d+) received')

    def __init__(self, ip):                         
        Thread.__init__(self)
        self.ip = ip
        self.result = None

    def run(self):                          
        match = self.RECEIVED_PACKAGES_RE.search(
            check_output(['ping', '-q', '-c2', '-W1', self.ip])
        )

        successful_ping_count = int(match.group(1)) if match else 0

        if successful_ping_count == 0:
            self.result = 'no response'
        elif successful_ping_count == 1:
            self.result = 'alive, but 50% package loss'
        elif successful_ping_count == 2:
            self.result = check_snmp(self.ip)
        else:
            assert False

[...]
</code></pre>
<p>... results in an error:</p>
<blockquote>
<p>CalledProcessError: Command '[ping', '-q', '-c2', '-W1', '10.81.3.80 ']'   returned non-zero exit status 1</p>
</blockquote>
<p>Adding "stderr = STDOUT" in <code>check_output</code> did not produce any useful feedback.  </p>
<p>How can I obtain more information regarding the error so that I can troubleshoot it?</p>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/subprocess.html#subprocess.check_output">subprocess.check_output</a> raises <a href="https://docs.python.org/3/library/subprocess.html#subprocess.CalledProcessError">CalledProcessError</a> on non-zero exit code, and <code>ping</code> returns non-zero exit code if something is wrong (e.g. unknown domain name, or site is down, or site has ICMP blocked for some reason, or your Internet connection is down).</p>
<p>If you want to examine both output and exit code, use <a href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen">subprocess.Popen</a>:</p>
<pre><code>import subprocess
import sys

site = sys.argv[1]
ping_count = 4
process = subprocess.Popen(['ping', site, '-c', str(ping_count)],
                           stdout=subprocess.PIPE,
                           stderr=subprocess.STDOUT)
returncode = process.wait()
print('ping returned {0}'.format(returncode))
print(process.stdout.read())
</code></pre>
<p>Examples:</p>
<pre><code>$ python ping.py google.com         &lt;-- ping successful
ping returned 0
PING google.com (195.64.213.27) 56(84) bytes of data.
64 bytes from cache.google.com (195.64.213.27): icmp_seq=1 ttl=57 time=59.8 ms
64 bytes from cache.google.com (195.64.213.27): icmp_seq=2 ttl=57 time=2.43 ms
64 bytes from cache.google.com (195.64.213.27): icmp_seq=3 ttl=57 time=77.0 ms
64 bytes from cache.google.com (195.64.213.27): icmp_seq=4 ttl=57 time=43.8 ms

--- google.com ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3004ms
rtt min/avg/max/mdev = 2.439/45.802/77.096/27.658 ms

$ python ping.py asdasdas.com       &lt;-- DNS resolved, but site is down
ping returned 1
PING asdasdas.com (69.172.201.208) 56(84) bytes of data.

--- asdasdas.com ping statistics ---
4 packets transmitted, 0 received, 100% packet loss, time 3024ms

$ python ping.py asdasdasdasda.com  &lt;-- DNS failed
ping returned 2
ping: unknown host asdasdasdasda.com
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>As your error message said, ping finished with non zero exit status.  It might mean that e.g. the IP address provided is not reachable or you passed in wrong parameters. </p>
<p>From <code>ping</code> man page (<a href="http://linux.die.net/man/8/ping" rel="nofollow">http://linux.die.net/man/8/ping</a>):</p>
<blockquote>
<p>If ping does not receive any reply packets at all it will exit with code 1. If a packet count and deadline are both specified, and fewer than count packets are received by the time the deadline has arrived, it will also exit with code 1. On other error it exits with code 2. Otherwise it exits with code 0. This makes it possible to use the exit code to see if a host is alive or not.</p>
</blockquote>
<p>You can try to catch <code>CalledProcessError</code> and see what it contains in <code>output</code>. 
Have a look here <a href="https://docs.python.org/2/library/subprocess.html#subprocess.check_output" rel="nofollow">https://docs.python.org/2/library/subprocess.html#subprocess.check_output</a></p>
</div>
