<div class="post-text" itemprop="text">
<p>I have this code. Its not the entire code because its a Blender addon with many lines that are unrelated to sockets so I give here only the part that deals with the sockets which I kept isolated from the rest of the program. </p>
<p>If you want to see the entire code, it can be found here</p>
<p><a href="http://pastebin.com/iqN7tr8E" rel="nofollow">http://pastebin.com/iqN7tr8E</a></p>
<pre><code>def create_thread():

    global threadSocket,listening
    threadSocket = threading.Thread(name='threadSocket', target= socket_listen)
    listening = True
    create_socket_connection()
    threadSocket.start()


def socket_listen():
    global receivedSocket,listening, receivedData,socketServer, socketMessages, pherror
    socketServer.listen(5)

    while listening:
        (receivedSocket , adreess) = socketServer.accept()
        receivedData = (receivedSocket.recv(1024)).decode("utf-8")[:-2]

        socketMessages.append(receivedData)
        receivedSocket.sendall('Hello from Blender!\n')
        receivedSocket.close()




def create_socket_connection():
    global socketServer
    socketServer = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    socketServer.bind(('127.0.0.1',4000))
</code></pre>
<p>I am using telnet to test the socket with telnet 127.0.0.1 4000, telnet can send the data but never receives any. As you can see my socket is blocking inside its own thread so it does not block the entire programs execution. I assume that sendall tries to send everything and for some reason it cannot connect back to telnet for sending . Am I doing something wrong here ? </p>
</div>
<div class="post-text" itemprop="text">
<p>Following line will raises error, because there's no <code>socketMessages</code> defined according to the given code.</p>
<pre><code>socketMessages.append(receivedData)
</code></pre>
<p>exception in above line will prevent the excution of next line (<code>sendall</code>).</p>
<p>To solve the problem, define the <code>socketMessages</code> as a list or remove the above line.</p>
<hr/>
<p><strong>UPDATE</strong> after seeing OP's comment:</p>
<p><a href="https://docs.python.org/3/library/socket.html#socket.socket.sendall" rel="nofollow"><code>socket.sendall</code></a> accepts byte string (<code>str</code> in Python 2.x, <code>bytes</code> in Python 3.x). In Python 3.x, you should use bytes literal as follow.</p>
<pre><code>receivedSocket.sendall(b'Hello from Blender!\n')
</code></pre>
</div>
<span class="comment-copy">I am not giving away the entire code because its a Blender addon with a lot of code in it, socketMessages is defined and that is not the problem . Its a list that I use to append string I receive from socket. You can comment that line if you want but that is not my problem, since this part I have tested and it works. My problems is solely sendall not sending anything. By testing I mean that I have tested the code without receivedSocket.sendall('Hello from Blender!\n') and it works without any problem.</span>
<span class="comment-copy">@Kilon, Make sure that other threads does not chagne the global variables. (especially <code>receivedSocket</code>, <code>receivedData</code>).</span>
<span class="comment-copy">I added a link to full code inside the question. The only thing that the other "thread" is affecting in term of globals is socketMessages and pherror.I call it "thread" because its not really a python thread but a Blender modal operator with a short timer. Probably its C thread of some kind. In any case neither receivedSocket or receivedData are either accessed or modified. In any case as I said the code is tested and it worked before putting the sendall so I doubt this is where my problem is. Also as I said I still have no issues receiving data. The issue is ONLY sending data.</span>
<span class="comment-copy">unfortunately it was me being stupid again. This is a python 3 app and I was viewing the python 2 docs. Apparently in python 2 sendall sends strings in python 3 send all sends bytes so the correct is receivedSocket.sendall(b'Hello from Blender!\n'). Really stupid mistake I know and I try to avoid but it wont be the first nor the last :D Thanks all for helping me I really appreciate it, upvotes for everyone and answer accepted :)</span>
<span class="comment-copy">@Kilon, Thank you for the feedback. I updated the answer and added <code>python-3.x</code> tag to the question accordingly.</span>
