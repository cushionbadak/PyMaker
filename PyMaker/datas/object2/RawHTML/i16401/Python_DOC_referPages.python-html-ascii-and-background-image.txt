<div class="post-text" itemprop="text">
<p>I'm trying to create a python script that displays a <code>external-link-icon.gif</code> as a background for a web page and using a suitable font, print all of the printable characters in the ASCII character set. We can specify a font like Times New Roman, Palatino, Georgia, Lucida Grande, or Helvetica. The printable characters start have decimal numbers from 33–126 and 128–4000. and we do not need 127.</p>
<p>I thought everything is right but this script isn't working. Pretty sure the background part I did in incorrect and I'm not sure if I'm using the the correct tags or if I'm missing some tags, but I think I did the ASCII part right.</p>
<pre><code>#!/usr/local/bin/python3

import base64
import binascii
import cgi
import sys

print('Content-type: text/html\n')

content = []
#back = []
external_link_bytes = open('external-link-icon.gif','rb').read()

# Create the base64 encoded images
external_link = base64.b64encode(external_link_bytes)
external_link = external_link.decode('ascii')
#back = '&lt;style&gt;body {background:url(data:image/gif;base64,%s)}&lt;/style&gt;' % external_link

for i in range(33,127):
    content.append('&lt;div class="unicode-char"&gt;')
    char = cgi.escape(chr(i)).encode("ascii", "xmlcharrefreplace")
    content.append(char.decode())
    content.append('&lt;div class="clearfix"&gt;&lt;/div&gt;&lt;sub style="font-size: 12px"&gt;{sub_number}&lt;/sub&gt;'.format(sub_number = i))
    content.append('&lt;/div&gt;')
for i in range(128,256):
    content.append('&lt;div class="unicode-char"&gt;')
    char = cgi.escape(chr(i)).encode("ascii", "xmlcharrefreplace")
    content.append(char.decode())
    content.append('&lt;sub style="font-size: 12px"&gt;{}&lt;/sub&gt;'.format(i))
    content.append('&lt;/div&gt;')
for i in range(257,4000):
    content.append('&lt;div class="unicode-char"&gt;')
    char = cgi.escape(chr(i)).encode("ascii", "xmlcharrefreplace")
    content.append(char.decode())
    content.append('&lt;sub style="font-size: 12px"&gt;{}&lt;/sub&gt;'.format(i))
    content.append('&lt;/div&gt;')
content = "\n".join(content)
</code></pre>
<p>UPDATED: added this to the script because i needed to make the ascii display in a 12 row column and making it a certian font and font size but doesn't work again. pretty sure im doing this wrong as my professor didn't go deeply into it and didn't gave us very much examples.</p>
<pre><code>html = '&lt;!doctype html&gt;'
html += '&lt;html&gt;'
html += '&lt;head&gt;'
html += '&lt;meta charset="utf-8"&gt;'
html += '&lt;title&gt;Lab 5.1.cgi&lt;/title&gt;'
html += '&lt;style&gt;'
html += body {font-family: "WenQuanYi", "Arial Unicode MS", "GNU Unifont", Code2000, Arial, "Lucida Grande", sans-serif; background:url(data:image/gif;base64, external_link)};
html += '&lt;/style&gt;'
html += '&lt;/head&gt;'
html += '&lt;body&gt;'
html += '&lt;div class="row"&gt;'
html += '&lt;div class="twelve columns"&gt;'
html += '&lt;div class="globalWrapper"&gt;'
html += '&lt;div style="font-size:16px"&gt;'
html += '&lt;/div&gt;'
html += '&lt;div&gt;&lt;strong&gt;lab5.1.cgi&lt;/strong&gt;'
html += '&lt;h1 class="title"&gt;Arial Unicode MS&lt;/h1&gt;'
html += '&lt;h2 class="small"&gt;Printable Characters: 32&amp;ndash;126, 128 &amp;ndash; 4000&lt;/h2&gt;'
html += '&lt;div class="unicode-char"&gt;'
html += content
html += '&lt;/div&gt;'
html += '&lt;/div&gt;'
html += '&lt;/div&gt;'
html += '&lt;/body&gt;'
html += '&lt;/html&gt;'
print (html)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>First of all: add the <a href="https://docs.python.org/3/library/cgitb.html" rel="nofollow"><code>cgitb</code> traceback manager</a> to your script so that any errors are output to your browser still:</p>
<pre><code>import cgitb
cgitb.enable()
</code></pre>
<p>Now, if your CGI setup is otherwise correct to at least <em>run</em> your script, you'll get error feedback in the browser.</p>
<p>Your <code>back</code> assignment is not valid Python:</p>
<pre><code>back = &lt;style&gt;body {background:url(data:image/gif;base64,external_link)}&lt;/style&gt;
</code></pre>
<p>You'll need to use string formatting here:</p>
<pre><code>external_link = external_link.decode('ascii')
back = '&lt;style&gt;body {background:url(data:image/gif;base64,%s)}&lt;/style&gt;' % external_link
</code></pre>
<p>The <code>base64.b64encode()</code> result is a <code>bytes</code> value so it needs to be decoded to a <code>str</code> value first.</p>
<p>Depending on how the CGI server handles the current working directory, it could be that the <code>external-link-icon.gif</code> file is not found. You can guard against that by using the script file location as a starting point to load files in the same directory:</p>
<pre><code>import os

here = os.path.dirname(os.path.abspath(__file__))
icon_file = os.path.join(here, 'external-link-icon.gif')
with open(icon_file, 'rb') as infile:
    external_link_bytes = infile.read()
</code></pre>
</div>
<span class="comment-copy">You'd better use something like <a href="http://www.yattag.org" rel="nofollow noreferrer">yattag</a> to build the html.</span>
<span class="comment-copy">never heard of it so i looked it up, looks rly useful, but since my professor never taught us how to do this, im guessing he wants us to do it the old fashion way lol. thank you though, i learned something new</span>
<span class="comment-copy">@user3804711: the handling of <code>back</code> is was the only obvious error I can find.</span>
<span class="comment-copy">@user3804711: consider adding <code>import cgitb</code>, and <code>cgitb.enable()</code> to your script (at the top) so that you at least get an error message in the browser. It is possible that what is the current working directory is not what you expect and thus the <code>external-link-icon.gif</code> file is not found.</span>
<span class="comment-copy">thought i'd test if the background .gif was the problem but just stripping away the part of the script that gets all the ascii from 33–126 and 128–4000, so basically all the for loops and the content list. and it works so it must be somewhere within the content list or those loops</span>
<span class="comment-copy">@user3804711: then build that back up in chunks; it worked for me when I tried your code.</span>
<span class="comment-copy">O you got it to work how did u do it. I dont understand what you mean by back up in chunks</span>
