<div class="post-text" itemprop="text">
<p>I am trying to save output from a module to CSV file and I got an error when I ran the following code, which is a part of a module:</p>
<pre><code>base_keys = ['path', 'rDATE', 'cDate', 'cik', 'risk', 'word_count']
outFile = open('c:\\Users\\ahn_133\\Desktop\\Python Project\\MinkAhn_completed2.csv','wb')
dWriter = csv.DictWriter(outFile, fieldnames=base_keys)
dWriter.writerow(headerDict)
</code></pre>
<p>Here is the error message (base_keys are the headings.)</p>
<pre><code>return self.writer.writerow(self._dict_to_list(rowdict))
TypeError: 'str' does not support the buffer interface
</code></pre>
<p>I dont' even understand what the error message is about. I use Python 3.3 and Windows 7.</p>
<p>Thanks for your time.</p>
</div>
<div class="post-text" itemprop="text">
<p>Opening a file in binary mode to write csv data to doesn't work in Python 3, simply put. What you want is to open in text mode and either use the default encoding or specify one yourself, i.e., your code should be written like:</p>
<pre><code>import csv
k = ['hi']
out = open('bleh.csv', 'w', newline='', encoding='utf8') # mode could be 'wt' for extra-clarity
writer = csv.DictWriter(out, k)
writer.writerow({'hi': 'hey'})
</code></pre>
<p>Now, due to a <a href="http://bugs.python.org/issue7198" rel="noreferrer">bug</a>, you also need to specify <code>newline=''</code> when opening this file for writing the CSV output.</p>
</div>
<span class="comment-copy">Show more of your code, especially the definition of <code>_dict_to_list</code>.</span>
<span class="comment-copy">Python3 uses bytes instead of strings in many cases where encoding comes into play. Try encoding/decoding where appropriate.</span>
<span class="comment-copy">@NedBatchelder It’s <a href="http://docs.python.org/3/library/csv.html#csv.DictWriter" rel="nofollow noreferrer">library code</a>…</span>
<span class="comment-copy">How to encode it?</span>
<span class="comment-copy">Then I'll give you the First Rule of Debugging: When In Doubt, Print More Out.   What value is <code>_dict_to_list</code> returning?  If it's well-named, it's a list, but maybe it isn't.</span>
<span class="comment-copy"><a href="http://bugs.python.org/issue7198" rel="nofollow noreferrer">the bug</a> was about code examples for csv.writer in csv docs lacking <code>newline=''</code> in Python 3. The bug is not the cause.</span>
<span class="comment-copy">I'm not following you @J.F.Sebastian, are you implying that <code>newline=''</code> doesn't affect Python 3, or that it doesn't affect when using <code>csv.DicWriter</code>, or something else ? This certainly wasn't the problem in OP's code because he couldn't even write to the file (because he opened in binary mode), but it would be the next bug.</span>
<span class="comment-copy">look at <a href="http://hg.python.org/cpython/rev/9201455f950b" rel="nofollow noreferrer">the patch that fixes the bug</a>. It is a documentation bug, no code in cvs is changed due to this bug. Your answer implies that there is some bug in csv module itself (the code).</span>
<span class="comment-copy">I've seen it. While my answer never said it was a bug in the code (and only that it was a bug) we can get into this new argument. But I'm not seeing the importance of discussing this.</span>
