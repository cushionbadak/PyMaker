<div class="post-text" itemprop="text">
<p>I have written a simple python program that takes user input, with the use of input(). There are some different commands available.</p>
<p>I want to make sure that all available commands function as intended and that the program catches invalid commands. Since there are quite a few different commands, this is very time-consuming to do manually (i.e., start the program, and enter all commands, one by one). (I have separate test functions for the actual execution of all commands, but I'm struggling to find a nice way to test this functionality together with the input() loop.)</p>
<p><strong>How can I automate the process of giving (predetermined) user inputs, without messing up the rest of the code?</strong> In addition to using this to test the program, it would also serve as an example to the user, in order to see the possible usage of the program.</p>
<p>My current solution is that I have two versions of the main() function, which is basically just an infinite loop that takes inputs until an exit command is given. The first version, "main()", is the version intended for use and takes inputs from input(), until the user decides to quit. The second version, "main_test()" is only used for testing, and takes the inputs from a predetermined list, specified in the code. This does the job, but I do not want the main_test() code in the final version. I also do not want to "pollute" main() by adding things only used for testing.</p>
<pre><code>def main():
    while True:
        user_input = input()
        ...
def main_test():
    test_input = [...]
    test_iter = 0
    while True:
        user_input = test_input[test_iter]
        test_iter += 1
        ...
</code></pre>
<p>I have not been able to find a nice way to do this in python, although I'm sure there must be a smart way. I'd prefer a way that does not need any additional imports. But if there is a nice way to do it with additional imports, I'm all ears.</p>
<p>Anyway, striking out with python, my next thought was to specify the commands in a Makefile, where I would start the program and feed the program text input, emulating the user. The main benefit of this is that I would only need the "main()" function, and I would not have to change anything in the python code. The disadvantage is that the example/test is specified outside of the *.py files, which may confuse the user.</p>
</div>
<div class="post-text" itemprop="text">
<p>If you are looking to confirm that X input results in Y output, then what you are looking for is called <strong>unit testing</strong>; this methodology allows you to define functions that assess the result of your function against your expected results.</p>
<p>Module options:<br/>
- <a href="https://docs.pytest.org/en/latest/getting-started.html#getstarted" rel="nofollow noreferrer">pytest</a><br/>
- <a href="https://docs.python.org/3/library/unittest.html" rel="nofollow noreferrer">unittest</a></p>
</div>
<div class="post-text" itemprop="text">
<p>First of all, I would like to point out that there are many methods for testing your code and some are better practice than others, while each one can be preferred by the programmer for different reasons. You should study how to test your code using the existing ways. Depending on the structure of your code, patterns that can be exploited, and your implementation principles that you follow (dependency injections, mvc, mvvm, etc).</p>
<p>As for your specific case, I would recommend to unittest your fraction of the code that uses the user input and define a collection of cases with predefined outputs that your can assert. Then, use the same code (maybe add cases) whenever you edit this fraction, in order to be sure that your program continues to work fluently.</p>
<p>Using Python's <a href="https://docs.python.org/3.7/library/unittest.html" rel="nofollow noreferrer">Unittest</a> package you can implement a nice script that checks your code consistently and incorporate it to your project. See also <a href="https://en.wikipedia.org/wiki/Unit_testing" rel="nofollow noreferrer">Wikipedia</a> page about <em>unit testing</em> to learn more about the principles you have to follow. You can also check <a href="https://www.tensorflow.org/api_guides/python/test" rel="nofollow noreferrer">Tensorflow's testing page</a> for directions on how to incorporate this kind of testing 
in a bigger project, and use these ideas in yours.</p>
<p>Good luck!</p>
</div>
<div class="post-text" itemprop="text">
<p>The answer from here should work if you don't mind importing unittest, <a href="https://stackoverflow.com/questions/21046717/python-mocking-raw-input-in-unittests">python mocking raw input in unittests</a>.</p>
<p>The main_test() part can then be removed from you projects and taken care of in the testing script. The "return_values" then correspond to you mock inputs.</p>
</div>
<span class="comment-copy">Thanks for your input. I'm currently using pytest for my tests. The problem is that I don't know how to use pytest to write a proper test for this one. I basically want to run main(), and then give inputs, but I'm at a loss how to do this. I'll have a closer look at pytest, if it has some functionality I can use.</span>
<span class="comment-copy">Thanks for your input. I managed to solve my problem in a similar way as suggested in the answer you linked. I used the mocking as done in <a href="https://code-maven.com/mocking-input-and-output-for-python-testing" rel="nofollow noreferrer">code-maven.com/mocking-input-and-output-for-python-testing</a>. Basically, the test function temporarily redefines input() to take values from a predefined list. This was exactly what I was looking for.</span>
