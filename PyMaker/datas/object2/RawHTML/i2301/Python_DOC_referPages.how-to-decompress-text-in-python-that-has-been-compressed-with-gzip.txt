<div class="post-text" itemprop="text">
<p>How can you decompress a string of text in Python 3, that has been compressed with gzip and converted to base 64?</p>
<p>For example, the text:</p>
<p><strong>EgAAAB+LCAAAAAAABAALycgsVgCi4vzcVAWFktSKEgC9n1/fEgAAAA==</strong></p>
<p>Should convert to:</p>
<p><strong>This is some  text</strong></p>
<p>The following <code>C#</code> code successfully does this:</p>
<pre><code>var gzBuffer = Convert.FromBase64String(compressedText);

using (var ms = new MemoryStream()) {
    int msgLength = BitConverter.ToInt32(gzBuffer, 0);
    ms.Write(gzBuffer, 4, gzBuffer.Length - 4);

    var buffer = new byte[msgLength];

    ms.Position = 0;
    using (var zip = new GZipStream(ms, CompressionMode.Decompress)) {
        zip.Read(buffer, 0, buffer.Length);
    }

    return Encoding.UTF8.GetString(buffer);
}
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use the <code>gzip</code> and <code>base64</code> modules.</p>
<pre><code>&gt;&gt;&gt; import gzip
&gt;&gt;&gt; import base64

&gt;&gt;&gt; s = 'EgAAAB+LCAAAAAAABAALycgsVgCi4vzcVAWFktSKEgC9n1/fEgAAAA=='
&gt;&gt;&gt; gz = base64.b64decode(s)
&gt;&gt;&gt; gz
b'\x12\x00\x00\x00\x1f\x8b\x08\x00\x00\x00\x00\x00\x04\x00\x0b\xc9\xc8,V\x00\xa2\xe2\xfc\xdcT\x05\x85\x92\xd4\x8a\x12\x00\xbd\x9f_\xdf\x12\x00\x00\x00'

# If you need the length
import struct
# Unpacks binary encoded 4 byte integer (assume native byte order)
# Only select first four bytes with [:4] slice
&gt;&gt;&gt; struct.unpack('i', gz[:4])[0]
18

# Skip length value with [4:] slice
&gt;&gt;&gt; gzip.decompress(gz[4:]).decode('UTF8')
'This is some  text'
</code></pre>
</div>
<span class="comment-copy">Thanks. Whenever I use base64 and then zlib.decompress I am getting Error -3 while decompressing data: incorrect header check</span>
<span class="comment-copy">Rad about <a href="https://docs.python.org/3/library/base64.html#module-base64" rel="nofollow noreferrer">module-base64</a> and <a href="https://docs.python.org/3/library/gzip.html#module-gzip" rel="nofollow noreferrer">module-gzip</a></span>
<span class="comment-copy">Thanks. What is the 4 byte integer that needs to be skipped? That seems to have been my problem when trying to work it out.</span>
<span class="comment-copy">Is the binary encoded length of the text.</span>
<span class="comment-copy">Is that already in the initial text or was it intoduced by base64.b64decode(...)?</span>
<span class="comment-copy">It was already part of the string</span>
