<div class="post-text" itemprop="text">
<p>I am extremely new to Python. I have a huge dataframe that contains two variables in list format. It has a dimension of 1416631 x 2.</p>
<p>I am trying to extract the first element of the list to create another variable. However, the current code has been running for over an hour to no avail.</p>
<p>Here is a snippet of the dataframe <code>MH</code> with two variables, <code>col</code> and <code>PMID</code> (which is currently empty):</p>
<pre><code>col                             PMID
[1, Aged, Adult, Child]
[53, Humans, Kidney Injury]
[22, Diagnostic Imaging, Aged]
</code></pre>
<p>This is what I want it to look like (2 variables: <code>PMID</code> and <code>col</code>):</p>
<pre><code>col                             PMID
[Aged, Adult, Child]            1
[Humans, Kidney Injury]         53
[Diagnostic Imaging, Aged]      22
</code></pre>
<p>Here is my code:</p>
<pre><code># extract PMID
for index, row in MH.iterrows():
    MH["PMID"][index] = MH["col"][index][0]
</code></pre>
<p>This code works on a smaller dataframe, but doesn't stop running on my larger dataframe.</p>
<p>Please advise. Thanks</p>
</div>
<div class="post-text" itemprop="text">
<p>Here is one way:</p>
<pre><code>import pandas as pd

df = pd.DataFrame({'col': [[1, 'Aged', 'Adult', 'Child'],
                           [53, 'Humans', 'Kidney Injury'],
                           [22, 'Diagnostic Imaging', 'Aged']]})

df['PMID'], df['col'] = list(zip(*df['col'].apply(lambda x: (x[:1][0], x[1:])).values))

#                           col  PMID
# 0        [Aged, Adult, Child]     1
# 1     [Humans, Kidney Injury]    53
# 2  [Diagnostic Imaging, Aged]    22
</code></pre>
<p><strong>Explanation</strong></p>
<ul>
<li><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.apply.html" rel="nofollow noreferrer"><code>pd.Series.apply</code></a> allows you to apply any function, including an anonymous <a href="https://stackoverflow.com/questions/890128/why-are-python-lambdas-useful"><code>lambda</code></a> function on series.</li>
<li>The <a href="https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences" rel="nofollow noreferrer">tuple</a> <code>(x[:1][0], x[1:])</code> splits your column of lists into the format you specified.</li>
<li><a href="https://stackoverflow.com/a/2921872/9209546"><code>zip(*x.values)</code></a> unpacks an array of tuples into an array of 2 columns, which are assigned to columns "PMID" and "col".</li>
</ul>
</div>
<span class="comment-copy">wow. what an elegant solution and extremely fast! it ran within 1 minute! wow. may I bother you with what the syntax means? for instance, what do <code>zip</code> and <code>*</code> and <code>lambda x</code> do?</span>
<span class="comment-copy">@sweetmusicality, good questions! I've added some links to my explanation to help you.</span>
