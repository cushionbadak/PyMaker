<div class="post-text" itemprop="text">
<p>I need your help with my code. I have converted from <code>time.struct_time</code> to <code>datetime</code> object. Now I would like to convert it back to <code>time.struct_time</code> object after I have added to the next day date. </p>
<p>When I try this:</p>
<pre><code>half_hour_date = '23/02/2018 23:00PM'
epg_time_1 = time.strptime(half_hour_date, '%d/%m/%Y %I:%M%p')

#convert from time_struct_time object to datetime
date_format = datetime.datetime.fromtimestamp(time.mktime(epg_time_1))
half_hour = date_format + datetime.timedelta(days = self.program_day)

#convert from datetime to time_struct_time object
epg_time_1 = time.strptime(half_hour, '%d/%m/%Y %I:%M%p')
</code></pre>
<p>It give me an error: <strong>TypeError: expected string or buffer</strong></p>
<p>The error are jumping on this line:</p>
<pre><code>epg_time_1 = time.strptime(half_hour, '%d/%m/%Y %I:%M%p')
</code></pre>
<p>Here is the datetime object for <code>half_hour</code>:</p>
<pre><code>2018-02-23 23:00:00
</code></pre>
<p>Here is what I am trying to achieve:</p>
<pre><code>time.struct_time(tm_year=2018, tm_mon=2, tm_mday=23, tm_hour=23, tm_min=00, tm_sec=0, tm_wday=3, tm_yday=53, tm_isdst=-1)
</code></pre>
<p>Can you please help me how I can correct the error to allow me to convert it to <code>time.struct_time</code> object?</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>&gt;&gt;&gt; import datetime
... import time
... 
... fmt = '%d/%m/%Y %H:%M%p'
... 
... half_hour_date = '23/02/2018 23:00PM'
... 
... date_format = datetime.datetime.strptime(half_hour_date, fmt)
... half_hour = date_format + datetime.timedelta(days=2)  # self.program_day)
... 
... # convert from datetime to time_struct_time object
... epg_time_1 = time.struct_time(half_hour.timetuple())
&gt;&gt;&gt; epg_time_1
time.struct_time(tm_year=2018, tm_mon=2, tm_mday=25, tm_hour=23, tm_min=0, tm_sec=0, tm_wday=6, tm_yday=56, tm_isdst=-1)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>There is no 23:00PM. Change it to 11:00PM.</p>
<h3>[Update]</h3>
<p>As you mentioned, the error came out from the second line. When I run the first two lines with Python 3.6, the result was</p>
<blockquote>
<p>ValueError: time data '23/02/2018 23:00PM' does not match format '%d/%m/%Y %I:%M%p'</p>
</blockquote>
<p>It means that there is a problem in "23:00PM" so I suggested to change it to "11:00PM". Or you can use "%H" instead of "%I" (as Patrick Haugh suggested in the comment).</p>
<p>P.S. I could not give full answer because of mobile device. Sorry for that.</p>
</div>
<span class="comment-copy">Maybe put in a string instead of a datetime?</span>
<span class="comment-copy">Can you please show me an example how I could do this?</span>
<span class="comment-copy">Why not just use <a href="https://docs.python.org/3/library/datetime.html#datetime.datetime.strptime" rel="nofollow noreferrer"><code>datetime.strptime</code></a> to create the <code>datetime</code> object directly from the string?</span>
<span class="comment-copy">Thank you very much for this, I can see it have now resolved the problem</span>
<span class="comment-copy">@KnightRider Glad to help!</span>
<span class="comment-copy">Huh? cant you post an answer of what I am asking for?</span>
<span class="comment-copy">The problem here comes from the incorrect hour directive <code>%I</code>.  <code>%I</code> is for 12 hour clocks, <code>%H</code> is for 24 hour clocks as outlined <a href="https://docs.python.org/3/library/time.html#time.strftime" rel="nofollow noreferrer">here</a>.</span>
<span class="comment-copy">@Patrick Good point!</span>
