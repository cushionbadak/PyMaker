<div class="post-text" itemprop="text">
<p>I want to do a lot of boring C# code replacements automatically through a python script. I read all lines of the file, transform them, truncate the whole file, write new strings and close it.</p>
<pre><code>f = open(file, 'r+')
text = f.readlines()
# some changes
f.truncate(0)
for line in text:
    f.write(line)
f.close()
</code></pre>
<p>All my changes are written. But some strange characters in the beginning of the file appear. I don't know how to avoid them. Even if I open with <code>encoding='utf-8-sig'</code> it doesn't help.</p>
<p>I tried truncate whole file besides the 1st line like this:</p>
<pre><code>import sys
f.truncate(sys.getsizeof(text[0]))
for index in range(1, len(text), 1):
    f.write(text[index])
</code></pre>
<p>But in this case more than 1st line is writing instead of only first line.</p>
<p><strong>EDIT</strong>
I tried this:</p>
<pre><code>f.truncate(len(text[0]))
for index in range(1, len(text), 1):
    f.write(text[index])
</code></pre>
<p>And the first line has written correct but next one with the same issue. So I think this characters from the end of the file and I try to write after them.</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>f=open(file, 'r+')
text = f.readlines() # After reading all the lines, the pointer is at the end of the file.
# some changes
f.seek(0) # To bring the pointer back to the starting of the file.
f.truncate() # Don't pass any value in truncate() as it means number of bytes to be truncated by default size of file.
for line in text:
    f.write(line)
f.close()
</code></pre>
<p>Check out this <a href="https://www.tutorialspoint.com/python/file_truncate.htm" rel="nofollow noreferrer">Link</a> for more details.</p>
</div>
<span class="comment-copy">Do they look like <a href="https://en.m.wikipedia.org/wiki/Byte_order_mark" rel="nofollow noreferrer">en.m.wikipedia.org/wiki/Byte_order_mark</a> ?</span>
<span class="comment-copy">No, in Visual Studio they look like spaces but affect code correctness</span>
<span class="comment-copy">Oh yes, it works fine! Thank you! Am I right that these symbols from end of file and I write right after them?</span>
<span class="comment-copy">You are at the end of the file and when you call <code>f.truncate(0)</code> it means <code>truncate 0 byte from the file</code> which doesn't do anything there. Even I don't know why you see those characters.</span>
<span class="comment-copy">FYI, on Windows, <code>open</code> defaults to ANSI, which depends on the system locale. If the file is UTF-8, the <code>utf-8-sig</code> encoding is the most compatible with Windows tools, since many expect a UTF-8 BOM. Note that in this case when you <code>seek(0)</code> it resets the file's internal state, so the next write will include the required BOM.</span>
<span class="comment-copy">I actually don't know much about <code>encoding</code> just few names and definition, it would be a great help if you could share a link so that the answer can be optimized or it becomes better.</span>
<span class="comment-copy">Python 3 <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer"><code>open</code></a> has an <code>encoding</code> parameter, which defaults to the encoding returned by <a href="https://docs.python.org/3/library/locale.html#locale.getpreferredencoding" rel="nofollow noreferrer"><code>locale.getpreferredencoding</code></a>. On Windows, this will be a <a href="https://docs.python.org/3/library/codecs.html#standard-encodings" rel="nofollow noreferrer">standard encoding</a> for the system's ANSI codepage (e.g. "cp1252" for Western Europe and America).</span>
