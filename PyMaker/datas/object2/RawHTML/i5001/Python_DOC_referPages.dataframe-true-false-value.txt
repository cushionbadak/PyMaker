<div class="post-text" itemprop="text">
<p>I have this currently that works</p>
<pre><code>df['AStrategy'] = df['Areturn'][df['BUY'] == True]
df['BStrategy'] = df['Breturn'][df['SELL'] == True]
</code></pre>
<p>I wanted to add a condition where I will only Sell when Buy is false as per below, but it did not work</p>
<pre><code>df['AStrategy'] = df['Areturn'][df['BUY'] == True]
df['BStrategy'] = df['Breturn'][df['SELL'] == True &amp; df['BUY'] == False]

ValueError: The truth value of a Series is ambiguous. Use a.empty, a.bool(), a.item(), a.any() or a.all().
</code></pre>
<p>Why does it not work?</p>
<p>Any kind advise please? Thank you</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>df['BStrategy'] = df['Breturn'][(df['SELL'] == True) &amp; (df['BUY'] == False)]
</code></pre>
<p>It should work, to apply more than one filter you need brackets</p>
</div>
<div class="post-text" itemprop="text">
<p>If you are only checking True/False you can simply do this:</p>
<pre><code>df['BStrategy'] = df['Breturn'][df['SELL'] &amp; ~df['BUY']]
</code></pre>
<hr/>
<h2>Your problem</h2>
<p>Is explained by <a href="https://docs.python.org/3/reference/expressions.html#operator-precedence" rel="nofollow noreferrer">Python's Operator precedence</a>.</p>
<p>Yours doesn't work because of: <code>==</code> has less proprity than <code>&amp;</code>. However <code>()</code> has highest priority and thus enclosing your statement works.</p>
<p>The solution I gave you works because of: ~x having higher priority than <code>&amp;</code>.</p>
<hr/>
<h2>Example</h2>
<pre><code>import pandas as pd
import numpy as np

np.random.seed(1234)

df = pd.DataFrame({
    'SELL':np.random.choice([True,False],6),
    'BUY':np.random.choice([True,False],6),
    'Breturn':np.random.randint(10,size=6),
})

df['BStrategy'] = df['Breturn'][df['SELL'] &amp; ~df['BUY']]

print(df)
</code></pre>
<p>Returns:</p>
<pre><code>     BUY  Breturn   SELL  BStrategy
0   True        6  False        NaN
1  False        8  False        NaN
2  False        0   True        0.0
3  False        5  False        NaN
4  False        0   True        0.0
5  False        9   True        9.0
</code></pre>
</div>
<span class="comment-copy">You need to add parentheses for individual conditions I think.</span>
<span class="comment-copy">Yes, like <code>df['BStrategy'] = df['Breturn'][(df['SELL'] == True) &amp; (df['BUY'] == False)]</code></span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/29461185/filtering-pandas-dataframe-using-or-statement">Filtering Pandas Dataframe using OR statement</a></span>
<span class="comment-copy">Thank you guys, adding the parentheses works.. I didnt know that and spend quite some time thinking why it didnt... thank you so much</span>
