<div class="post-text" itemprop="text">
<p>How am I able to extract the source IP relevant for "main.mp3" mount point from the below xml source     </p>
<p>My current code gets the first on the list which happens to be for the listen.mp3 mount point, however I would like the extraction to be bound to a particular mount point</p>
<p><strong>Code that extracts the source IP:</strong></p>
<pre><code>SERVER = 'http://localhost:8382/admin/stats.xml'
authinfo = urllib2.HTTPPasswordMgrWithDefaultRealm()
authinfo.add_password(None, SERVER, 'xxxxxx', 'xxxxxxx')
page = 'http://localhost:8382/admin/stats.xml'
handler = urllib2.HTTPBasicAuthHandler(authinfo)
myopener = urllib2.build_opener(handler)
opened = urllib2.install_opener(myopener)
output = urllib2.urlopen(page)
soup = BeautifulSoup(output.read(), "lxml")
print "source ip: ",soup.select('source_ip')[0].text
</code></pre>
<p><strong>xml source of the link:</strong></p>
<blockquote>
<pre><code>&lt;icestats&gt;
&lt;admin&gt;ossama@hotmail.com&lt;/admin&gt;
&lt;client_connections&gt;580473&lt;/client_connections&gt;
&lt;clients&gt;32&lt;/clients&gt;
&lt;connections&gt;1217611&lt;/connections&gt;
&lt;file_connections&gt;220&lt;/file_connections&gt;
&lt;host&gt;localhost&lt;/host&gt;
&lt;listener_connections&gt;374451&lt;/listener_connections&gt;
&lt;listeners&gt;29&lt;/listeners&gt;
&lt;location&gt;Australia&lt;/location&gt;
&lt;server_id&gt;Icecast 2.4.2&lt;/server_id&gt;
&lt;server_start&gt;Thu, 15 Feb 2018 21:17:23 +1100&lt;/server_start&gt;
&lt;server_start_iso8601&gt;2018-02-15T21:17:23+1100&lt;/server_start_iso8601&gt;
&lt;source_client_connections&gt;99&lt;/source_client_connections&gt;
&lt;source_relay_connections&gt;0&lt;/source_relay_connections&gt;
&lt;source_total_connections&gt;99&lt;/source_total_connections&gt;
&lt;sources&gt;2&lt;/sources&gt;
&lt;stats&gt;0&lt;/stats&gt;
&lt;stats_connections&gt;0&lt;/stats_connections&gt;
&lt;source mount="/listen.mp3"&gt;
&lt;audio_info&gt;channels=2;samplerate=44100;bitrate=64&lt;/audio_info&gt;
&lt;channels&gt;2&lt;/channels&gt;
&lt;genre&gt;Islamic Talk&lt;/genre&gt;
&lt;listener_peak&gt;52&lt;/listener_peak&gt;
&lt;listeners&gt;29&lt;/listeners&gt;
&lt;listenurl&gt;http://localhost:8382/listen.mp3&lt;/listenurl&gt;
&lt;max_listeners&gt;unlimited&lt;/max_listeners&gt;
&lt;public&gt;1&lt;/public&gt;
&lt;samplerate&gt;44100&lt;/samplerate&gt;
&lt;server_description&gt;Qkradio Station Australia&lt;/server_description&gt;
&lt;server_name&gt;listen.mp3&lt;/server_name&gt;
&lt;server_type&gt;audio/mpeg&lt;/server_type&gt;
&lt;slow_listeners&gt;220&lt;/slow_listeners&gt;
&lt;source_ip&gt;127.0.0.1&lt;/source_ip&gt;
&lt;stream_start&gt;Mon, 19 Feb 2018 23:08:01 +1100&lt;/stream_start&gt;
&lt;stream_start_iso8601&gt;2018-02-19T23:08:01+1100&lt;/stream_start_iso8601&gt;
&lt;title&gt;ibtihal.mp3 - 1&lt;/title&gt;
&lt;total_bytes_read&gt;634036021&lt;/total_bytes_read&gt;
&lt;total_bytes_sent&gt;13637049457&lt;/total_bytes_sent&gt;
&lt;user_agent&gt;Liquidsoap/1.3.3 (Unix; OCaml 4.02.3)&lt;/user_agent&gt;
&lt;/source&gt;
&lt;source mount="/main.mp3"&gt;
&lt;audio_info&gt;bitrate=170&lt;/audio_info&gt;
&lt;bitrate&gt;170&lt;/bitrate&gt;
&lt;genre&gt;Islam&lt;/genre&gt;
&lt;listener_peak&gt;2&lt;/listener_peak&gt;
&lt;listeners&gt;1&lt;/listeners&gt;
&lt;listenurl&gt;http://localhost:8382/main.mp3&lt;/listenurl&gt;
&lt;max_listeners&gt;unlimited&lt;/max_listeners&gt;
&lt;public&gt;1&lt;/public&gt;
&lt;server_description&gt;Quran Kareem Radio&lt;/server_description&gt;
&lt;server_name&gt;Quran Kareem Radio&lt;/server_name&gt;
&lt;server_type&gt;audio/mpeg&lt;/server_type&gt;
&lt;server_url&gt;http://qkradio.com.au&lt;/server_url&gt;
&lt;slow_listeners&gt;1&lt;/slow_listeners&gt;
&lt;source_ip&gt;60.241.175.9&lt;/source_ip&gt;
&lt;stream_start&gt;Tue, 20 Feb 2018 00:56:23 +1100&lt;/stream_start&gt;
&lt;stream_start_iso8601&gt;2018-02-20T00:56:23+1100&lt;/stream_start_iso8601&gt;
&lt;total_bytes_read&gt;582030204&lt;/total_bytes_read&gt;
&lt;total_bytes_sent&gt;588819584&lt;/total_bytes_sent&gt;
&lt;user_agent&gt;instreamer&lt;/user_agent&gt;
&lt;/source&gt;
&lt;/icestats&gt;
</code></pre>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>You could select the container 'source' tags and collect 'source_ip' tags on each of them, so each IP will be relevant to a mount poin.  </p>
<pre><code>soup = BeautifulSoup(xml, "lxml")
for mount in soup.select('source[mount]'):
    print "mount point: ", mount['mount']
    print "source ip: ", mount.select_one('source_ip').text
</code></pre>
<p>Or you could create a dictionary and select IP by mount point, eg,  </p>
<pre><code>data = {
    mount['mount']: mount.select_one('source_ip').text 
    for mount in soup.select('source[mount]')
}
print data['/listen.mp3']
</code></pre>
<p>If you want to select the IP from a specific point only, just select the 'source_ip' tag on that node.</p>
<pre><code>ip = soup.select_one('source[mount=/main.mp3] source_ip').text
print "source ip:", ip
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I have pasted your XML data into excercise.xml file, and it should work fine with python 3.x</p>
<pre><code>import os
import xml.etree.ElementTree as ET
filename = 'excercise.xml'
cwd = os.getcwd()
fullFile = os.path.abspath(os.path.join(cwd,filename))
tree = ET.parse(fullFile)
root = tree.getroot()

#Below code will get Child tag and Child attributes
for child in root:
    if (child.tag) == "source" and (child.attrib['mount'] == "/main.mp3") :
        for element in child:
            if element.tag == "source_ip":
                print(element.text)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="https://docs.python.org/3/library/xml.etree.elementtree.html" rel="nofollow noreferrer">ElementTree</a>, ships with Python.</p>
<pre><code>import xml.etree.ElementTree as ET
tree = ET.fromstring(xml)

for s in tree.iter('source'):
    print(s.attrib) # dictionary with all attributes
    print(s.text) # there might also be text
    print(s.get('mount')) # this is the info you want
    print(s.attrib['mount']) # or like this
</code></pre>
</div>
<span class="comment-copy">did you try xpath?</span>
<span class="comment-copy">not familiar...</span>
<span class="comment-copy"><a href="https://www.w3schools.com/xml/xml_xpath.asp" rel="nofollow noreferrer">w3schools.com/xml/xml_xpath.asp</a></span>
