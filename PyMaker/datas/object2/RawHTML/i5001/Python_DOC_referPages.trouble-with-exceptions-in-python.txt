<div class="post-text" itemprop="text">
<p>I am learning about exceptions in  python and I am having trouble with some code. the following code is:</p>
<pre><code>try:
    txt = open("C:\\Users\\Draco\\OneDrive\\Documents\\textfile.txt","r")
    try:
        txt.write("This is a test. Normal service will shortly resume!")
    finally:
        print("Content written to file successfully. Have a nice day.")
        txt.close()
except IOError:
    print("Error: unable to write the file. Check permissions")
</code></pre>
<p>Now when I execute the code I get the following to two lines:
Content written to file successfully. Have a nice day.
Error: unable to write the file. Check permissions</p>
<p>The issues I am having is that because the error, in this case being the "r" which should be "w" I should only get the message Error: unable to write the file. Check permissions. But I am getting both error and the success messages and I am unsure why</p>
</div>
<div class="post-text" itemprop="text">
<p>I'll break it down one by one for you.</p>
<ol>
<li><p>Try block opened</p>
<pre><code>try:
</code></pre></li>
<li><p>File opened with read privileges.</p>
<pre><code>txt = open("C:\\Users\\Draco\\OneDrive\\Documents\\textfile.txt","r")
</code></pre></li>
<li><p>Try block opened, exception occurred when you wrote since you wrote to a readonly file object.</p>
<pre><code>try:
    txt.write("This is a test. Normal service will shortly resume!")
</code></pre></li>
<li><p>Since you have an inner try block, the nested finally is the first block executed.</p>
<pre><code>finally:
</code></pre></li>
<li><p>Printing success even though the file write failed. </p>
<pre><code>print("Content written to file successfully. Have a nice day.")
</code></pre></li>
<li><p>Closing the file, works fine</p>
<pre><code>txt.close()
</code></pre></li>
<li><p>Exception handler, now the exception is handled.</p>
<pre><code>except IOError:
    print("Error: unable to write the file. Check permissions")
</code></pre></li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p><code>finally</code> <a href="https://docs.python.org/3/tutorial/errors.html#defining-clean-up-actions" rel="nofollow noreferrer">always executes</a>:</p>
<blockquote>
<p>A finally clause is always executed before leaving the try statement,
  whether an exception has occurred or not.</p>
</blockquote>
<p>The process you are seeing:</p>
<ol>
<li>Your script will not error on <code>txt = open(loc, 'r')</code> because at the stage it is not
writing any data.</li>
<li>When it moves on to <code>txt.write</code> it errors and moves to <code>finally</code>,
for the reason given above.</li>
<li>Since you have met an <code>IOError</code>, you will also see the message
defined in your <code>except</code> clause.</li>
</ol>
</div>
<span class="comment-copy">Why are you printing the success message in the <code>finally</code> block?</span>
<span class="comment-copy">Check out this <a href="https://www.programiz.com/python-programming/methods/built-in/open" rel="nofollow noreferrer">link</a> You have to follow this format: `open("path_to_file", mode = 'r')</span>
<span class="comment-copy">Your success message is in a <code>finally</code> block. The whole purpose of a <code>finally</code> block is that it is <b>always executed</b>.</span>
