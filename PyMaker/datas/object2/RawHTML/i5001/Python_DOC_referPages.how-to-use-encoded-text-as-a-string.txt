<div class="post-text" itemprop="text">
<p>I want to write an encoded text to a file using Python 3.6, the issue is that I want to write it as a string and not as bytes.</p>
<pre><code>text = open(file, 'r').read()
enc = text.encode(encoding)  # for example: "utf-32"
f = open(new_file, 'w')
f.write(str(enc)[2:-1])
f.close()
</code></pre>
<p>The problem is, I still get the file content as bytes (e.g. the '\n' remains the same instead of become a new row).</p>
<p>I also tried to use: </p>
<pre><code>enc.decode(encoding)
</code></pre>
<p>but it's just returning me back the old text I had in the first place.</p>
<p>any ideas how can I improve this piece of code?</p>
<p>Thanks.</p>
</div>
<div class="post-text" itemprop="text">
<p>The problem you have here is that you <code>encode</code> into <code>utf-32</code> bytes object and then cast it back into a string object without specifying an encoding.  The default is <code>utf-8</code>, so you've just converted using the wrong encoding.  If you pass the same encoding to <a href="https://docs.python.org/3/library/stdtypes.html#str" rel="nofollow noreferrer"><code>str</code></a> then it should work.</p>
<p>Better yet, don't call <code>str</code> at all when writing out - if you already have a bytes object, it's not necessary.</p>
<p>This concept generally trips up a lot of people.  I suggest reading the explanation <a href="https://eli.thegreenplace.net/2012/01/30/the-bytesstr-dichotomy-in-python-3" rel="nofollow noreferrer">here</a> to help wrap your head around how and why we do the string/bytes conversions.  A good rule of thumb - string types inside your python, and decode to string from bytes as data comes in, encode from string to bytes as it goes out.</p>
</div>
<span class="comment-copy">You can open the file like <code>open(file, 'r', encoding="your_encoding")</code> then while you apply <code>read()</code> the result will be a binary object you can decode it using <code>decode("utf32")</code></span>
<span class="comment-copy">When I open the file as mentioned, I cannot apply either <code>read()</code> or <code>decode(encoding)</code></span>
