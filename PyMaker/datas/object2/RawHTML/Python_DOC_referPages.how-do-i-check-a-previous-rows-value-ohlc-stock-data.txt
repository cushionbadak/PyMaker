<div class="post-text" itemprop="text">
<p>I'm trying to do data-mine a stock data frame where the signal generated is in this format:</p>
<pre><code>Signal = (stratdf['High'].shift() &gt; (stratdf['Open'].shift()))
</code></pre>
<p>How do I code to check the previous row's value and compare it to the corresponding rows value (example: 1 bar ago &gt; 10 bars ago) with the Signal being executed the next day (or row) after the logic is true?</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>&gt;&gt;&gt; import pandas as pd
&gt;&gt;&gt; df = pd.DataFrame([[4, 5, 9, 7, 10], [5, 4, 11, 8, 9]]).T
&gt;&gt;&gt; df.columns = ['High', 'Open']
&gt;&gt;&gt; df
   High  Open
0     4     5
1     5     4
2     9    11
3     7     8
4    10     9
&gt;&gt;&gt; df['pre_high'] = df['High'].shift(1)
&gt;&gt;&gt; df
   High  Open  pre_high
0     4     5       NaN
1     5     4       4.0
2     9    11       5.0
3     7     8       9.0
4    10     9       7.0
</code></pre>
<p>Now if you want to check where the <code>pre_high</code> is greater than the <code>current open</code>, then you can do the following:</p>
<pre><code>&gt;&gt;&gt; df['Signal'] = df['High'].shift(1) &gt; df['Open']
&gt;&gt;&gt; df
   High  Open  pre_high  Signal
0     4     5       NaN   False
1     5     4       4.0   False
2     9    11       5.0   False
3     7     8       9.0    True
4    10     9       7.0   False
</code></pre>
</div>
<span class="comment-copy">can you share your expected output?</span>
