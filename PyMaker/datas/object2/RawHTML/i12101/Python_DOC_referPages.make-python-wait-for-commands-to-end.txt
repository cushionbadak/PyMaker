<div class="post-text" itemprop="text">
<p>I have a python program which dynamically move and rename files into a hadoop cluster. The files usually range from 10mb(parsed) up to 1.5gb (raw data). For the move commands to finish it can take a while and from what I can tell python races through them and none of the move commands get to finish. What is the proper way to have python wait for previous commands. I store the commands in a variable and pass it to os.system. The relevant code is </p>
<pre><code>os.system(moverawfile)
os.system(renamerawfile)
os.system(moveparsedfile)
os.system(renameparsedfile)
</code></pre>
<p>I know rename commands  are done basically instantaneously. Am I not supposed to use os.system? How do i ensure that python will wait for each command to finish before moving onto the next one. </p>
</div>
<div class="post-text" itemprop="text">
<p>I would suggest that you use run from subprocess as per Python documentation. It waits for your command to complete before returning. </p>
</div>
<span class="comment-copy">What is your exact code? <code>os.system</code> does not return until the command it spawns exits.</span>
<span class="comment-copy">You should be using <a href="https://docs.python.org/2/library/subprocess.html" rel="nofollow noreferrer"><code>subprocess</code></a> anyways. You can have an exception thrown on a command error, for example.</span>
<span class="comment-copy">os.system just calls <a href="http://linux.die.net/man/3/system" rel="nofollow noreferrer"><code>system(3)</code></a>, and that waits for the command to complete.</span>
<span class="comment-copy">hadoop fs -put rawjsondata.txt /home/hadoop/project/March/raw/rawjsondata.txt thats the entirety of "moverawfile"</span>
<span class="comment-copy">Some methods in <code>subprocess</code> wait -- others don't. . .</span>
<span class="comment-copy">whats the proper syntax of subprocess?</span>
<span class="comment-copy"><code>os.system</code> already waits; if it's behaving asynchronously with <code>os.system</code>, <code>subprocess</code> won't fix that (even though it's a good idea in general).</span>
<span class="comment-copy">@Sam: For <a href="https://stackoverflow.com/questions/35738065/make-python-wait-for-commands-to-end#comment59150293_35738065">your example command</a>, you'd do something like <code>subprocess.check_call(['hadoop', 'fs', '-put', localfilepath, remotefilepath])</code> (I'm assuming the file paths are in variables somewhere). Use plain <a href="https://docs.python.org/3/library/subprocess.html#subprocess.call" rel="nofollow noreferrer"><code>subprocess.call</code></a> if you don't want it to raise an exception.</span>
