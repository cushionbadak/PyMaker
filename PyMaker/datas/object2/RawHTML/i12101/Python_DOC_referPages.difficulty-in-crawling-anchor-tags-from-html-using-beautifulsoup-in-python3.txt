<div class="post-text" itemprop="text">
<p>I am trying to extract the href's from the web page of an institution.
I have to extract the dept codes for further crawling activity.
and I have written following code:</p>
<pre><code>import requests
import re
import urllib
from bs4 import BeautifulSoup

codesurl="http://www.iitkgp.ac.in/academics/?page=acadunits"
response = requests.get(codesurl)
# print(response.content)
soup=BeautifulSoup(response.content)
# print(soup.prettify())
p = re.compile('page=acadunits*')
p1 = re.compile('&lt;a href=.*page=acadunits*')

links=soup.find_all("a")
print(links)
for link in links:
    # if p1.match(link):
        print("%s" %(link)) 
</code></pre>
<p>But I am not getting all the href's for example :</p>
<pre><code>&lt;a href="?page=acadunits&amp;amp;&amp;amp;dept=ME"&gt;Mechanical Engineering&lt;/a&gt;
&lt;a href="?page=acadunits&amp;amp;&amp;amp;dept=MD"&gt;Medical Science &amp;amp; Technology&lt;/a&gt;
&lt;a href="?page=acadunits&amp;amp;&amp;amp;dept=MT"&gt;Metallurgical &amp;amp; Materials Engineering&lt;/a&gt;
</code></pre>
<p>and many more
Can somebody help me with this.This is first time I am crawling. 
you can also look at the website.I need to extract dept code from url</p>
<pre><code>dept=ME
dept=MT
dept=MD
</code></pre>
<p>My web page contains:</p>
<pre><code>    &lt;div class="tab_container"&gt;
&lt;div id="tab1" class="tab_content" style="display: block;"&gt;
&lt;h3&gt;&lt;/h3&gt;
    &lt;!--Content--&gt;
    &lt;img src="./Indian Institute of Technology Kharagpur_files/academicunits.jpg"&gt;
    &lt;br&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=AE"&gt;Aerospace Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=AG"&gt;Agricultural &amp;amp; Food Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=AR"&gt;Architecture &amp;amp; Regional Planning&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=BT"&gt;Biotechnology&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=CH"&gt;Chemical Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=CM"&gt;Chemistry&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=CE"&gt;Civil Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=CS"&gt;Computer Science &amp;amp; Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=CR"&gt;Cryogenic Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=ED"&gt;Center for Educational Technology&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=EE"&gt;Electrical Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=EC"&gt; Electronics &amp;amp; Electrical Communication Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=GS"&gt;G S Sanyal School of Telecommunications&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=MG"&gt;Geology &amp;amp; Geophysics&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=HS"&gt;Humanities &amp;amp; Social Sciences&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=IM"&gt;Industrial &amp;amp; Systems Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=IT"&gt;Information Technology&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=MS"&gt;Materials Science&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=MM"&gt;Mathematics&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=ME"&gt;Mechanical Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=MD"&gt;Medical Science &amp;amp; Technology&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=MT"&gt;Metallurgical &amp;amp; Materials Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=MI"&gt;Mining Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=NA"&gt;Ocean Engineering &amp;amp; Naval Architecture&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=N2"&gt;Oceans, Rivers, Atmosphere and Land Sciences&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=MP"&gt;Physics&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=PK"&gt;P K Sinha Centre for Bio Energy&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=RJ"&gt;Rajendra Mishra School of Engineering Entrepreneurship&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=RG"&gt;Rajiv Gandhi School of Intellectual Property Law&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=ID"&gt;Ranbir and Chitra Gupta School of Infrastructure Design and Management&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=RE"&gt;Reliability Engineering Centre&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=RT"&gt;Rubber Technology Centre&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=RD"&gt;Rural Development Centre&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=BS"&gt;School of Bioscience&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=ES"&gt;School of Energy Science &amp;amp; Engineering&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=EF"&gt;School of Environmental Science and Technology&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=NT"&gt;School of Nano-Science and Technology&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=WM"&gt;School of Water Resources&lt;/a&gt;&lt;br&gt;
        &lt;a href="http://www.iitkgp.ac.in/academics/?page=acadunits&amp;amp;&amp;amp;dept=SM"&gt;Vinod Gupta School of Management&lt;/a&gt;&lt;br&gt;
    &lt;br&gt;&lt;br&gt;

   &lt;!--Content--&gt;
    &lt;/div&gt;
</code></pre>
<p>but when I do :</p>
<pre><code>codesurl="http://www.iitkgp.ac.in/academics/?page=acadunits"
response = requests.get(codesurl)
soup=BeautifulSoup(response.text)
</code></pre>
<p>soup does not show these href's
can someone suggest how to extract these href tags??</p>
</div>
<div class="post-text" itemprop="text">
<p>First of all, the department links are loaded dynamically with a GET request to <a href="http://www.iitkgp.ac.in/academics/academic.php" rel="nofollow">this URL</a>.</p>
<p>Then, the idea would be to find all links where <code>href</code> attribute value is matching a specific <a href="http://www.crummy.com/software/BeautifulSoup/bs4/doc/#a-regular-expression" rel="nofollow">pattern</a> and then use this pattern to extract the department codes. Working code:</p>
<pre><code>import re

import requests
from bs4 import BeautifulSoup

codesurl = "http://www.iitkgp.ac.in/academics/academic.php"
response = requests.get(codesurl)
soup = BeautifulSoup(response.content, "lxml")

pattern = re.compile(r"dept=([A-Z]+)")
links = soup.find_all("a", href=pattern)

for link in links:
    print(pattern.search(link["href"]).group(1))
</code></pre>
<p>Prints:</p>
<pre><code>AE
AG
AR
...
NT
WM
SM
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The best way to do this is using <a href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.parse_qs" rel="nofollow"><code>parse_qs</code></a> from the <code>urllib.parse</code> module.</p>
<pre><code>for link in links:
    qs = parse_qs(link.get('href'))
    print('dept', qs['dept'][0])
</code></pre>
<p>or using <a href="https://docs.python.org/3/library/stdtypes.html?highlight=rpartition#str.rpartition" rel="nofollow"><code>rpartition</code></a></p>
<pre><code>for link in links:
    print(link.get('href').rpartition('&amp;&amp;')[-1])
</code></pre>
</div>
