<div class="post-text" itemprop="text">
<p><a href="http://i.stack.imgur.com/Mio0N.png" rel="nofollow">Excel Image 1</a></p>
<p><a href="http://i.stack.imgur.com/5oUDi.png" rel="nofollow">Excel Image 2</a></p>
<p>Please look at the "Excel Image 1" to start.</p>
<p>I am using python to pull those first two columns, and storing them in their own separate array. What I want to do is add the values of column B if the value in column are the same. For ex: if the value in column A is "0", then add -200 and 400 and get 200 because "0" is in row 1 and row 2 of column A.</p>
<p>After the addition as shown in "Excel Image 2", store the new values of both the Column in their own separate arrays, so I can use them for later calculations.</p>
<pre><code>import xlrd
excel = '/Users/Bob/Desktop/'

wb1 = xlrd.open_workbook(excel + 'assignment.xlsx')
sh1 = wb1.sheet_by_index(0)

colA,colB = [],[]
for a in range(0,sh1.nrows):
    colA.append(int(sh1.cell(a,0).value))
    colB.append(int(sh1.cell(a,1).value))
print(colA)
print(colB)

for i in colA:
    if i == 0:
        add = colB[0] + colB[1]
print(add)
</code></pre>
<p>I want a code that adds those values in column B irrespective of how many number or number of same values are given in column A.</p>
<p>Current output:</p>
<pre><code>[0, 0, 1, 2, 2, 2, 3, 3, 4, 4]
[-200, 400, 30, 600, -70, 10, 20, -90, 40, 40]
</code></pre>
<p>Expected output:</p>
<pre><code>[0, 1, 2, 3, 4]
[200, 30, 540, 70, 80]
</code></pre>
<p>Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="https://docs.python.org/3/library/itertools.html#itertools.groupby" rel="nofollow"><code>itertools.groupby()</code></a>:</p>
<pre><code>from itertools import groupby
import xlrd
excel = '/Users/Bob/Desktop/'

wb1 = xlrd.open_workbook(excel + 'assignment.xlsx')
sh1 = wb1.sheet_by_index(0)

sheet_rows = [sh1.row(r) for r in range(0, sh1.nrows)]
groups = groupby(sheet_rows, lambda row: row[1])

key_list = []
sum_list = []
for key, group in groups:
    key_list.append(key)
    sum_list.append(sum(group))

print(key_list)
print(sum_list)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I'd use the row_values method, instead. This is called with the row number and the column number (zero-based). For example to get the first row in a list do this:</p>
<pre><code>first_row = sh1.row_values(0)
[0.0, -200.0]
</code></pre>
<p>Slice the list to get values from specific columns. Such as:</p>
<pre><code>sh1.row_values(0)[1]
-200.0
</code></pre>
<p>I started by keeping track of the values in the first column (<code>curr_key</code>) and running a cumulative sum for a given key—<code>cum_sum</code>. When the key changes, I just update append the <code>cum_sum</code> to <code>sum_list</code> and update <code>curr_key</code> and <code>cum_sum</code>. The last thing to do is to append the last value in the cumulative sum.</p>
<pre><code>curr_key = sh1.row_values(0)[0]
cum_sum = sh1.row_values(0)[1]
sum_list = []
for a in range(1,sh1.nrows):
    if sh1.row_values(a)[0] == curr_key:
        cum_sum += sh1.row_values(a)[1]
        curr_key = sh1.row_values(a)[0]
    else:
        sum_list.append(cum_sum)
        curr_key = sh1.row_values(a)[0]
        cum_sum = sh1.row_values(a)[1]
sum_list.append(cum_sum)
</code></pre>
<p>This yields the following in <code>sum_list</code>:</p>
<pre><code>[200.0, 30.0, 540.0, -70.0, 80.0]
</code></pre>
<p>BTW, your second file has 70.0 instead of -70.0 in row 3.</p>
<p>After some thought I realized a better way was to use a dictionary (similar in concept to @Austin Hastings answer, but without the <code>groupby</code>).</p>
<pre><code>key_vals = [x for x in sh1.col_values(0)]
int_vals = [y for y in sh1.col_values(1)]
sum_list = {}
for i,value in enumerate(key_vals):
    if str(value) not in sum_list:
        sum_list[str(value)] = int_vals[i]
    else:
        sum_list[str(value)] += int_vals[i]
for key in sorted(sum_list):
    print('{}, {}'.format(key, sum_list[key]))
</code></pre>
<p>This yields:</p>
<pre><code>0.0, 200.0
1.0, 30.0
2.0, 540.0
3.0, -70.0
4.0, 80.0
</code></pre>
</div>
<span class="comment-copy">could you please help me with the question on the following link: <a href="http://stackoverflow.com/questions/35763589/python-excel-compare-the-given-value-with-the-summed-value" title="python excel compare the given value with the summed value">stackoverflow.com/questions/35763589/…</a></span>
<span class="comment-copy">What about the [0,1,2,3,4] ? How do I get that to print?</span>
<span class="comment-copy">You could just keep track of the <code>curr_key</code> values in another list by appending the value just before you change the key in the <code>else</code> part of the `if'.</span>
<span class="comment-copy">Could you please add it to the code. I am confused.</span>
<span class="comment-copy">I got it. Thanks!</span>
<span class="comment-copy">....could you please help me with the question on the following link:  <a href="http://stackoverflow.com/questions/35763589/python-excel-compare-the-given-value-with-the-summed-value" title="python excel compare the given value with the summed value">stackoverflow.com/questions/35763589/…</a></span>
