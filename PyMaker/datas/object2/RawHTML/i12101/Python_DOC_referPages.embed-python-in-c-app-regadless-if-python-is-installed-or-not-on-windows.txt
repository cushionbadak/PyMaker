<div class="post-text" itemprop="text">
<p>I have an app that runs user scripts, using the example on the python site, I can embed python 3.5</p>
<p>The problem is not so much embeding the code, but rather if/or what version of Python the user might have installed.</p>
<pre><code>#include &lt;Python.h&gt;

int
main(int argc, char *argv[])
{
  Py_SetProgramName(argv[0]);  /* optional but recommended */
  Py_Initialize();
  PyRun_SimpleString("from time import time,ctime\n"
                     "print 'Today is',ctime(time())\n");
  Py_Finalize();
  return 0;
}
</code></pre>
<p>This assumes that the user has Python 3.5 installed, if they have something else installed, the embeded scripts might not work.</p>
<p>Or even worse the app itself will not load.</p>
<p>If they do not have Python installed at all, then the call to <em>Py_Initialize();</em> will just crash the app.</p>
<p>So I have a couple of questions, how can I include Python in my app, regardless if they have python installed or not?</p>
<p>Or, how can I test what version of Python they have installed so I do not try and call <em>Py_Initialize();</em> if they don't have it installed or they don't have the correct one</p>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p>...how can I test what version of Python they have installed...</p>
</blockquote>
<p>See <a href="https://docs.python.org/3/c-api/init.html?highlight=getversion#c.Py_GetVersion" rel="nofollow">Py_GetVersion</a>.</p>
<blockquote>
<p>...how can I include Python in my app, regardless if they have python installed or not?</p>
</blockquote>
<p>For complete embedding, there's a a guide: <a href="http://christian.hofstaedtler.name/blog/2013/01/embedding-python-on-win32.html" rel="nofollow">Statically Embedding Python on Windows</a>. In general, you just have to copy the Python DLL + standard libraries folder into your application folder and change search paths (see <a href="https://docs.python.org/3/c-api/init.html#c.Py_SetPath" rel="nofollow">Py_SetPath</a> &amp; <a href="https://docs.python.org/3/c-api/init.html#c.Py_SetPythonHome" rel="nofollow">Py_SetPythonHome</a>) before initialization.</p>
</div>
<span class="comment-copy">For Python 3.5 there's an <a href="https://www.python.org/ftp/python/3.5.1/python-3.5.1-embed-amd64.zip" rel="nofollow noreferrer">embeddable package</a> that has everything you'll need -- the DLLs and extension modules (including vcruntime140.dll), a zipped copy of the pre-compiled (.pyc) standard library, and a pyvenv.cfg file that defines <code>applocal = true</code>.</span>
<span class="comment-copy">It's dependent on the universal CRT update, <a href="https://support.microsoft.com/en-us/kb/2999226" rel="nofollow noreferrer">kb2999226</a>. Also, 3.5 dropped support for Windows XP, which may be a problem for the OP's application.</span>
