<div class="post-text" itemprop="text">
<p>I get this message:</p>
<pre class="lang-none prettyprint-override"><code>RemovedInDjango19Warning: MergeDict is deprecated, use dict.update() instead.
</code></pre>
<p>Current code:</p>
<pre><code>return MergeDict(dict_a, dict_b)
</code></pre>
<p>This is no solution, since <code>dict_a</code> gets modified:</p>
<pre><code>return dict_a.update(dict_b) #1
</code></pre>
<p>Moreover <code>dict_a</code> is an instance of a custom class which does not support copying (it is lazy and creates items on the fly depending on the key), so I cannot simply do:</p>
<pre><code>new=dict()
new.update(dict_a)
new.update(dict_b)
return new
</code></pre>
<p>How do I replace <code>MergeDict</code>?</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.python.org/3/library/collections.html#collections.ChainMap" rel="nofollow"><code>collections.ChainMap</code></a>. It does the same thing as <code>MergeDict</code>: keeps a list of mappings and accesses them in order.</p>
<p>However it's generally simpler to just actually perform the merge of the dictionaries. It probably isn't impossible to add copying support to your custom class and just update it.</p>
</div>
<span class="comment-copy">How this is different from the code OP gives? The problem is that dict_a is lazy.</span>
<span class="comment-copy">@guettli Use <code>ChainMap</code> then.</span>
<span class="comment-copy">@guettli I just edited the answer.</span>
<span class="comment-copy">@Bakuriu thank you for your answer. ChainMap works great. For all those people fixed on Python2.7: On pypi there is a backport available: <a href="https://pypi.python.org/pypi/chainmap/" rel="nofollow noreferrer">pypi.python.org/pypi/chainmap</a></span>
