<div class="post-text" itemprop="text">
<p>I'm trying to export a binary matrix to excel..
I'm using what I've learned from <a href="https://stackoverflow.com/questions/25307848/write-list-of-lists-to-excel-file-using-xlwt">Write list of lists to excel file using xlwt</a></p>
<p>and I'm getting an size error
well, I have a binary matrix 2221x9947 and the following code:</p>
<pre><code>def wrapper(fn, *args, **kwargs):
    def wrapped():
        return fn(*args, **kwargs)
    return wrapped

def int_to_str_matriz(matriz):
    for i in xrange(len(matriz)):
        for j in xrange(len(matriz[i])):
            matriz[i][j] = str(matriz[i][j])
    return matriz

def escreve_matriz_xml(rows, sheet):
    for i, row in enumerate(rows):
        for j, col in enumerate(row):
            sheet.write(i, j, col)

def exportar_matriz(matriz):
    book = xlwt.Workbook()
    name = "matrizbinaria.xls"
    sheet1 = book.add_sheet("teste", cell_overwrite_ok=True)
    exportar = wrapper(escreve_matriz_xml(matriz, sheet1))
    book.save(name)
    book.save(TemporaryFile())
</code></pre>
<p>I first use <code>mb = int_to_str_matriz(matriz)</code> to convert the <em>ints</em> on the matrix to <em>str</em>, then I pass the new matrix to <code>exportar_matriz(mb)</code></p>
<p>I'm trying with this, and get</p>
<pre><code>ValueError: column index(256) not an int in range(256)
</code></pre>
<p>and if I try the other option that it's given on the topic I quoted, using</p>
<pre><code>def escreve_matriz_xml(rows, sheet):
    rows = [', '.join(row) for row in rows]
    for i, strrow in enumerate(rows):
        sheet.write(i, 0, strrow)
</code></pre>
<p>It works, the problem is that it is not useful this way, because I need to each column to have the (0,1), so I can analyze the data..
any solutions?
I tried without the str convertion and gets the same error...</p>
</div>
<div class="post-text" itemprop="text">
<p>You won't be able to do this using <code>xlwt</code>. Instead, consider exporting to <code>.csv</code> format (either using a library such as <a href="https://docs.python.org/3/library/csv.html" rel="nofollow"><code>csv</code></a>, <a href="http://www.numpy.org/" rel="nofollow"><code>numpy</code></a>, or <a href="http://pandas.pydata.org/" rel="nofollow"><code>pandas</code></a>, or without the aid of a library).</p>
<p>The <code>.xls</code> (Excel 2003) file type is limited to 65536 rows and <a href="https://support.microsoft.com/en-us/kb/272729" rel="nofollow">256 columns</a>, so there is no way you can export your 2221 by 9947 matrix using <code>xlwt</code> (unless you transform it into a different shape first). This restriction was removed on later file types such as <code>.xlsx</code> (Excel 2007), but the <code>xlwt</code> library does not currently support this format.</p>
</div>
<span class="comment-copy">your first error is a limitation in xlwt: <a href="http://stackoverflow.com/questions/7658513/python-xlwt-more-than-256-columns" title="python xlwt more than 256 columns">stackoverflow.com/questions/7658513/â€¦</a></span>
