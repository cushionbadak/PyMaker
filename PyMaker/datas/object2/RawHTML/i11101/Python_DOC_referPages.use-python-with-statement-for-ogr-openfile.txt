<div class="post-text" itemprop="text">
<p>Is it possible to use the Python <a href="https://docs.python.org/3/tutorial/inputoutput.html#methods-of-file-objects" rel="nofollow">"with"</a> statement with the ogr.open(file) function?</p>
<p>For example, I would like to do something like:</p>
<pre><code>with ogr.open(file) as ds:
</code></pre>
<p>At the moment, I can only get the following to work:</p>
<pre><code>try:
    ds = ogr.open(file)
    ...

except:
    del ds
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>According to the documentation, it appears that you cannot use <code>with ogr.Open(file)</code> ...</p>
<p>A Python object that you use in a <code>with</code> statement needs to have methods <code>__enter__</code> and <code>__exit__</code> to set up and take down a context used inside the <code>with</code> block. <a href="http://effbot.org/zone/python-with-statement.htm" rel="nofollow">Here's an explanation</a>.</p>
<p>According to the <a href="http://gdal.org/python/osgeo.ogr.Driver-class.html" rel="nofollow">Documentation for OGR Open</a>, these <code>__enter__</code> and <code>__exit__</code> methods are not defined for the DataSource object returned by <code>Open</code> so you cannot use the result from <code>ogr.Open</code> as the subject of a <code>with</code> statement.</p>
<p>So it looks like you'll have to use your <code>try</code>/<code>except</code> combination (although a <code>try</code>/<code>finally</code> combination might be better).</p>
</div>
<span class="comment-copy">What do you expect to do with <code>with</code> ? Call <code>ds.close()</code> at the end ?</span>
<span class="comment-copy">The ds (DataSource) object does not have a close() attribute.  Without using a try - finally combination (or try - except) I find that my interpreter keeps a lock on the opened ds (DataSource) even if I have the "del ds" in the script.</span>
<span class="comment-copy">Thank you, your explanation helps me to understand why I can't use it.  It would help preventing software from keeping lock's on files after a script has been executed.</span>
