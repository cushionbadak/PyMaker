<div class="post-text" itemprop="text">
<p>I am new to Python and while experimenting with operators, I came across this:</p>
<pre><code>&gt;&gt;&gt; 7.0 / 3
2.3333333333333335
</code></pre>
<p>Shouldn't the result be 2.3333333333333333 or maybe 2.3333333333333334. Why is it rounding the number in such a way?</p>
<p>Also, with regard to floor division in Python 2.7 my results were:</p>
<pre><code>&gt;&gt;&gt; 5 / 2
2
&gt;&gt;&gt; 5 // 2
2
&gt;&gt;&gt; 5.0 / 2
2.5
&gt;&gt;&gt; 5.0 // 2
2.0
</code></pre>
<p>So my observation is that floor division returns the integer quotient even in case of floating numbers, while normal division return the decimal value. Is this true?</p>
</div>
<div class="post-text" itemprop="text">
<p>Take a look at this <a href="http://0.30000000000000004.com" rel="nofollow">0.30000000000000004.com</a></p>
<blockquote>
<p>Your language isn't broken, it's doing floating point math. Computers can only natively store integers, so they need some way of representing decimal numbers. This representation comes with some degree of inaccuracy. That's why, more often than not, .1 + .2 != .3.</p>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p>Shouldn't the result be 2.3333333333333333 or maybe 2.3333333333333334. Why is it rounding the number in such a way?</p>
</blockquote>
<p>The key is the number is being rounded twice.</p>
<p>The first rounding is part of the division operation, rounding the number to the nearest double-precision floating point value. This is a binary operation not a decimal one.</p>
<p>The second rounding is part of converting the floating point number to a decimal representation for display. It is <em>possible</em> to represent the exact value of any binary fraction in decimal, but it is usually not desirable as in most applications doing so will simply result in many digits of false-precision. Python instead outputs the shortest decimal approximation that will round-trip to the correct floating point value.</p>
<p>We can better see what is going on by using the Fraction and Decimal types, unlike converting directly to a string converting a floating point number to a Fraction or Decimal will give the exact value. We can also use the Fraction type to determine the error in our calculation.</p>
<pre><code>&gt;&gt;&gt; from fractions import Fraction
&gt;&gt;&gt; from decimal import Decimal
&gt;&gt;&gt; 7.0 / 3
2.3333333333333335
&gt;&gt;&gt; Decimal(7.0 / 3)
Decimal('2.333333333333333481363069950020872056484222412109375')
&gt;&gt;&gt; Fraction(7.0 / 3)
Fraction(5254199565265579, 2251799813685248)
&gt;&gt;&gt; Fraction(7,3) - Fraction(7.0 / 3)
</code></pre>
<p>Fraction(-1, 6755399441055744)</p>
<p>The conversion via type Decimal shows us the exact value of the floating point number and demonstrates the many digits of false-precision that typically result from exact conversion of a floating point value to decimal.</p>
<p>The conversion to a Fraction is also interesting, the denominator is 2251799813685248 which is equivalent to 2<sup>51</sup>. This makes perfect sense, a Double precision floating point has 53 effective bits of mantissa and we need two of those for the integral part of the result leaving 51 for the fractional part.</p>
<p>The error in our floating point calculation is 1/6755399441055744 or â…“ * 2<sup>-51</sup>. This error is less than half our precision step of 2<sup>-51</sup> so the answer was indeed correctly rounded to a double precision floating point value.</p>
</div>
<span class="comment-copy">See <a href="http://docs.python.org/3/tutorial/floatingpoint.html" rel="nofollow noreferrer">Floating Point Arithmetic: Issues and Limitations</a> and/or <a href="http://floating-point-gui.de/" rel="nofollow noreferrer">What Every Programmer Should Know About Floating-Point Arithmetic</a>.</span>
<span class="comment-copy">And for further reading, see this <a href="https://docs.python.org/3/library/decimal.html" rel="nofollow noreferrer">docs.python.org/3/library/decimal.html</a>.</span>
<span class="comment-copy">Also, Python 3's division operator changed a little bit since Python 2: <a href="http://python3porting.com/differences.html#integer-division" rel="nofollow noreferrer">python3porting.com/differences.html#integer-division</a></span>
<span class="comment-copy">When you display a floating point number it has to be converted from a bit-pattern to a text string.  That's a lot of work and there are different ways to do that.  What you see is not necessarily how the number is stored internally.  Also, for fun, see the difference between the output as you show it and <code>print 7.0/3</code>.  There are also differences between python 2 and 3.</span>
