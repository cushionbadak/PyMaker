<div class="post-text" itemprop="text">
<p>I am trying to pivot my dataframe so I can make a document matrix but I am running into some errors with I try to pivot my dataframe. Here is my original dataframe before I try to mess with it. </p>
<pre><code>tidy_filter1 = pd.DataFrame(df_tweetText["text"].str.split(expand = True).stack().reset_index())
tidy_filter = pd.DataFrame(tidy_filter1,index = tidy_format1["id"])
tidy_filter = tidy_filter1.rename(index = tidy_filter["id"], columns = {"level_1": "num",0:"word"})
tidy_filter1["level_1"] = tidy_filter1.groupby("id").cumcount()
tidy_filter = tidy_filter.drop(columns = ["id"])
tidy_filter = tidy_filter.rename(index = tidy_format1["id"])

id                    num    word
1104159474368024599    0    repmiketurner
1104159474368024599    1    time
1104159474368024599    2    michael
1104159474368024599    3    cohen
1104159474368024599    4    told
1104159474368024599    5    truth
1104159474368024599    6    pled
1104159474368024599    7    guilty
1104159474368024599    8    also
1104159474368024599    9    said
1104159474368024599    10    collusion
</code></pre>
<p>Now when I try to run this code below is where it breaks.</p>
<pre><code>df_freq = tidy_filter.pivot_table(values='word', index=tidy_filter.index, columns='word', aggfunc=pd.Series.count)
</code></pre>
<p>The error gives me <em>KeyError: 'word'</em> which I don't understand. I tried to replace the values/columns with <em>tidy_filter['word]</em> but that did not work. </p>
<p>**Edit: I am looking for this output </p>
<pre><code>id                   repmiketurner michael cohen told truth pled guilty also said collusion
1104159474368024599         1         1       1     1   1     1     1      1   1       1
1104155456019357703        0          0       0     1   1     0     0      1   0       0
</code></pre>
<p>**Edit2: I so when I type in tidy_filter['word'] it gives me a different KeyError: 'repmiketurner'</p>
</div>
<div class="post-text" itemprop="text">
<p>I think your <code>pivot_table</code> command had to be changed - you had the arguments for <code>columns</code> and <code>values</code> interchanged. You just needed to use <code>columns='word'</code> and <code>values='num'</code>.</p>
<p>This is what worked for me</p>
<pre><code>df_freq = tidy_filter.pivot_table(columns='word',
                                    index=tidy_filter.index,
                                    values='num',
                                    aggfunc=pd.Series.count)

# Put pivot table columns in order of unique values of the 'word' column
word_unique = tidy_filter['word'].unique().tolist()
df_freq = df_freq[word_unique]

print(df_freq)
word                 repmiketurner  time  michael  cohen  told  truth  pled  guilty  also  said  collusion
id                                                                                                        
1104159474368024599              1     1        1      1     1      1     1       1     1     1          1
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I think you are looking for <code>pd.crosstab</code></p>
<pre><code>pd.crosstab(df.id,df.word)
</code></pre>
</div>
<span class="comment-copy">What is your expected output  ?</span>
<span class="comment-copy">why are your <code>values</code> and <code>columns</code> pointing to the same field?</span>
<span class="comment-copy">@Wen-Ben I just made an edit with desired output. Basically for every tweet(id) I want to show the number of occurrences a word has</span>
<span class="comment-copy">@AlexS1 I just updated my question with a sample output. I the reason why I use words twice is I want for each tweet to give me a number of word occurances in each tweet.</span>
<span class="comment-copy">That was perfect! Those bits gave me the desired output! Thanks!</span>
<span class="comment-copy">So I have crosstab a shot and it does work, but I might have too many tweets because my document matrix is very large and messy to look at.</span>
