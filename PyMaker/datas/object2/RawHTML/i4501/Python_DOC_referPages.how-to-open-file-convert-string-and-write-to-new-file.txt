<div class="post-text" itemprop="text">
<p>I am trying to open a text file, remove certain words that have a ] after them, and then write the new contents to a new file. With the following code, <code>new_content</code> contains what I need, and a new file is created, but it's empty. I cannot figure out why. I've tried indenting differently and passing in an encoding type, with no luck. Any help greatly appreciated.</p>
<pre><code>import glob
import os
import nltk, re, pprint
from nltk import word_tokenize, sent_tokenize
import pandas
import string
import collections

path = "/pathtofiles"

for file in glob.glob(os.path.join(path, '*.txt')):
    if file.endswith(".txt"):
        f = open(file, 'r')
        flines = f.readlines()
        for line in flines: 
            content = line.split() 

            for word in content:
                if word.endswith(']'):
                    content.remove(word)

            new_content = ' '.join(content)

            f2 = open((file.rsplit( ".", 1 )[ 0 ] ) + "_preprocessed.txt", "w")
            f2.write(new_content)
            f.close
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This should work @firefly. Happy to answer questions if you have them.</p>
<pre><code>import glob
import os

path = "/pathtofiles"

for file in glob.glob(os.path.join(path, '*.txt')):
    if file.endswith(".txt"):
        with open(file, 'r') as f:
            flines = f.readlines()
            new_content = []
            for line in flines: 
                content = line.split() 

                new_content_line = []

                for word in content:
                    if not word.endswith(']'):
                        new_content_line.append(word)

                new_content.append(' '.join(new_content_line))

            f2 = open((file.rsplit( ".", 1 )[ 0 ] ) + "_preprocessed.txt", "w")
            f2.write('\n'.join(new_content))
            f.close
            f2.close
</code></pre>
</div>
<span class="comment-copy"><code>for word in content:                 if word.endswith(']'):                     content.remove(word)</code> that's removing while iterating: <i>bad</i></span>
<span class="comment-copy"><code>f.close</code> does nothing, and indentation is wrong.</span>
<span class="comment-copy"><code>if file.endswith(".txt")</code> is guaranteed to be always true because of the globbing your performed.</span>
<span class="comment-copy">you're not closing <code>f2</code> at all</span>
<span class="comment-copy">You should open the file for writing with mode 'a'. See: <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer">docs.python.org/3/library/functions.html#open</a>. Or make a list of words and then use <code>writelines</code></span>
<span class="comment-copy">Are you sure about the <code>mode="w"</code>?</span>
<span class="comment-copy">works on my machine ¯_(ツ)_/¯. AFAIK the difference between w and a is simply creating a new file vs appending. OP seemed to indicate wanting a new file each time so <code>w</code> makes more sense to me</span>
<span class="comment-copy">Thank you @PeterDolan! I understand what this is doing and why it's better. However the file is still blank for me! I was working on a mac and have tried it on windows too. Is there something else I could be doing wrong?</span>
<span class="comment-copy">So for some reason in the end this worked for some finals but not all...by adding <code>encoding = 'utf-8'</code> after <code>r</code> and <code>w</code> it worked for all files.</span>
<span class="comment-copy">Interesting, maybe there are some weird characters in your files. Glad to hear its working though -- any other questions?</span>
