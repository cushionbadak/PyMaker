<div class="post-text" itemprop="text">
<p>Is there a way to get the string representation of an object on disk without loading the object into memory? I thought of calling <code>repr()</code> on the file object returned from calling <code>open()</code> on the object but that returns the class/mode of the file object <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer">per documentation</a>. </p>
<pre><code>import os
import pickle
import tempfile
import datetime
from copy import copy

class Model:
    def __init__(self, identifier):
        self.identifier = identifier
        self.creation_date = datetime.datetime.now()
    def __repr__(self):
        return '{0} created on {1}'.format(self.identifier, self.creation_date)

identifier = 'identifier'
model1 = Model(identifier)
model2 = copy(model1)

with tempfile.TemporaryDirectory() as directory:
    with open(os.path.join(directory, identifier), 'wb') as f:
        # persist model and delete from RAM
        pickle.dump(model2, f)
        del model2

    with open(os.path.join(directory, identifier), 'rb') as f:
        print('is model stale: {}'.format(repr(model1) != repr(f)))
        print('Disk model: {}'.format(repr(f)))
        print('RAM model: {}'.format(repr(model1)))
</code></pre>
<p>I'd like to return the string representation of <code>model2</code> (i.e. <code>identifier created on &lt;creation_date&gt;</code>) without actually loading <code>model2</code> into memory.</p>
<p>Do share another workaround you may have used to accomplish a similar purpose. </p>
<p>Thanks.</p>
<ul>
<li>MacOS</li>
<li>Python 3.6.4</li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>If you serialize your object as JSON rather than binary .pickle, you can manipulate or filter the text directly without deserializing it.  See <a href="https://stackoverflow.com/questions/3768895/how-to-make-a-class-json-serializable">How to make a class JSON serializable</a> for some nice examples (particularly the jsonpickle and .toJSON answers).</p>
</div>
<div class="post-text" itemprop="text">
<p>I wrote an lazy pickle loader many years ago <a href="https://github.com/wavii/listy-django-cache/blob/master/listy/on_demand_pickle.py" rel="nofollow noreferrer">here</a>. You could pickle a <code>((id, creation_date), model)</code> and then just deserialize that first tuple.</p>
</div>
<span class="comment-copy">No there isn't any way.</span>
<span class="comment-copy">How could that possibly work? The <code>__repr__</code> method needs to acces properties of the object, where is it supposed to get them from if the object isn't loaded into memory?</span>
<span class="comment-copy">Couldn't you just embed the <code>identifier/creation_date</code> info in the file-name?</span>
<span class="comment-copy">Good thought @ekhumoro. In our process, we'd like to avoid having the timestamp on the model name itself.</span>
<span class="comment-copy">@sedeh. Or use a non-compressed archive (e.g. <a href="https://docs.python.org/3/library/tarfile.html#module-tarfile" rel="nofollow noreferrer">tar</a>) which contains the pickle plus a small file containing the relevant info.</span>
