<div class="post-text" itemprop="text">
<p>I am trying to multiply very large floats by very large integers in Python and am noticing small inaccuracies.
For example:</p>
<pre><code>a = 45310630.0
b = 1023473145

c = int(a * b)
print(c)
</code></pre>
<p>The answer I am getting is 
46374212988031352 but I know the answer should be 46374212988031350. When I change variable "a" to an integer, the multiplication is performed correctly. However, since "a" comes from a division (and might not be a whole number), I can't simply convert it to an integer.</p>
</div>
<div class="post-text" itemprop="text">
<p>If you use <a href="https://docs.python.org/3/library/fractions.html#fractions.Fraction" rel="nofollow noreferrer"><code>fractions.Fraction</code></a> you can handle larger numbers accurately, at the cost of some efficiency:</p>
<pre><code>from fractions import Fraction
a = Fraction(45310630.0)
b = Fraction(1023473145)

c = int(a * b)
print(c)
</code></pre>
<p>Output:</p>
<pre><code>46374212988031350
</code></pre>
<p>Some timings:</p>
<pre><code>In [2]: a = Fraction(45310630.0)
   ...: b = Fraction(1023473145)
   ...:

In [3]: %timeit int(a * b)
3.92 µs ± 21.9 ns per loop (mean ± std. dev. of 7 runs, 100000 loops each)

In [4]: a = 45310630.0
   ...: b = 1023473145
   ...:

In [5]: %timeit int(a * b)
479 ns ± 13.9 ns per loop (mean ± std. dev. of 7 runs, 1000000 loops each)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The reason that <code>c</code> is incorrect is <a href="https://docs.python.org/3.6/tutorial/floatingpoint.html" rel="nofollow noreferrer">due to how Python and other languages perform floating point math</a>.</p>
<p>To circumvent this issue, you can use the <code>fraction</code> and <code>decimal</code> modules included in the standard library:</p>
<pre class="lang-py prettyprint-override"><code>&gt;&gt;&gt; a = 45310630.0
&gt;&gt;&gt; b = 1023473145
&gt;&gt;&gt; expected = 46374212988031350
&gt;&gt;&gt; int(a * b) == expected
False

&gt;&gt;&gt; from decimal import Decimal
&gt;&gt;&gt; dec_a = Decimal.from_float(a)
&gt;&gt;&gt; dec_b = Decimal.from_float(b)
&gt;&gt;&gt; int(dec_a * dec_b) == expected
True

&gt;&gt;&gt; from fraction import Fraction
&gt;&gt;&gt; frac_a = Fraction.from_float(a)
&gt;&gt;&gt; frac_b = Fraction.from_float(b)
&gt;&gt;&gt; int(frac_a * frac_b) == expected
True
</code></pre>
</div>
