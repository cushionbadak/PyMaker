<div class="post-text" itemprop="text">
<p>I have this file:<a href="https://1drv.ms/u/s!AizscpxS0QM4hJo5SnYOHAcjng-jww" rel="nofollow noreferrer">https://1drv.ms/u/s!AizscpxS0QM4hJo5SnYOHAcjng-jww</a></p>
<p>i need, for every section like this to get RoleName,Attachedmanagedpolicies,and Principal.service</p>
<pre><code>{
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17", 
                "Statement": [
                    {
                        "Action": "sts:AssumeRole", 
                        "Effect": "Allow", 
                        "Condition": {
                            "StringEquals": {
                                "sts:ExternalId": "elasticbeanstalk"
                            }
                        }, 
                        "Principal": {
                            "Service": "elasticbeanstalk.amazonaws.com"
                        }
                    }
                ]
            }, 
            "RoleId": "AROAIT4PC25PD2WNFJ3VY", 
            "CreateDate": "2018-02-12T12:07:23Z", 
            "InstanceProfileList": [], 
            "RoleName": "aws-elasticbeanstalk-service-role", 
            "Path": "/", 
            "AttachedManagedPolicies": [
                {
                    "PolicyName": "AWSElasticBeanstalkEnhancedHealth", 
                    "PolicyArn": "arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkEnhancedHealth"
                }, 
                {
                    "PolicyName": "AWSElasticBeanstalkService", 
                    "PolicyArn": "arn:aws:iam::aws:policy/service-role/AWSElasticBeanstalkService"
                }
            ], 
            "RolePolicyList": [], 
            "Arn": "arn:aws:iam::279052847476:role/aws-elasticbeanstalk-service-role"
        }, 
        {
            "AssumeRolePolicyDocument": {
                "Version": "2012-10-17", 
                "Statement": [
                    {
                        "Action": "sts:AssumeRoleWithSAML", 
                        "Effect": "Allow", 
                        "Condition": {
                            "StringEquals": {
                                "SAML:aud": "https://signin.aws.amazon.com/saml"
                            }
                        }, 
                        "Principal": {
                            "Federated": "arn:aws:iam::279052847476:saml-provider/LastPass"
                        }
                    }
                ]
            }, 
            "RoleId": "AROAJHBMP2FAGOIMMTEKS", 
            "CreateDate": "2017-05-23T22:01:09Z", 
            "InstanceProfileList": [], 
            "RoleName": "AWSAccCorpAdmin", 
            "Path": "/", 
            "AttachedManagedPolicies": [
                {
                    "PolicyName": "AdministratorAccess", 
                    "PolicyArn": "arn:aws:iam::aws:policy/AdministratorAccess"
                }
            ], 
            "RolePolicyList": [], 
            "Arn": "arn:aws:iam::279052847476:role/AWSAccCorpAdmin"
        }, 
</code></pre>
<p>and to get output like below:</p>
<p>"aws-elasticbeanstalk-service-role","AWSElasticBeanstalkEnhancedHealth--AWSElasticBeanstalkService","elasticbeanstalk.amazonaws.com"</p>
<pre><code>-- is separator between AttachedManagedPolicies, some roles has multiple policies
</code></pre>
<p>so far i have this:</p>
<pre><code>import json

json_data=open('./output.json')
data = json.load(json_data)
print data
json_data.close()

sys.stdout = open('./out.json','wt')

for i in range (0, len (data['RoleDetailList'])):
   print data['RoleDetailList'][i]['AssumeRolePolicyDocument']
</code></pre>
<p>one line output matching section posted above:</p>
<pre><code>{u'Version': u'2012-10-17', u'Statement': [{u'Action': u'sts:AssumeRole', u'Effect': u'Allow', u'Principal': {u'Service': u'elasticbeanstalk.amazonaws.com'}}]}
</code></pre>
<p>RoleName and Attachedmanagedpolicies are missing, how to get those data ?</p>
</div>
<div class="post-text" itemprop="text">
<p>Working code (may be helpful to someone):</p>
<pre><code>#!/usr/bin/python

import json


def get_user_group_service(element):
    s = ''
    for e in element['AssumeRolePolicyDocument']['Statement']:
        p = e['Principal']
        if 'Federated' in p:
            s += p['Federated']
        if 'Service' in p:
            obj = p['Service']
            if type(obj) is str:
                s += obj  # element is string
            else:
                s += '--'.join(obj)  # element is array of strings
        if 'AWS' in p:
            s += p['AWS']
    return s


def get_policies(element):
    list = []
    if 'PolicyName' in element.keys():
        list.append(element['PolicyName'])
    for policy in element['AttachedManagedPolicies']:
        list.append(policy['PolicyName'])
    if len(element['RolePolicyList']) &gt; 0:
        list.append(element['RolePolicyList'][0]['PolicyName'])
    return '--'.join(list)


def main():
    with open('output.json') as file:
        data = json.load(file)

    with open('roleassign.csv', 'wt') as file:
        file.write('Role,Policy,User/Group/Service\n')
        for element in data['RoleDetailList']:
            s = element['RoleName'] + ',' + get_policies(element) + ',' + get_user_group_service(element)
            file.write(s + '\n')


main()
</code></pre>
</div>
<span class="comment-copy">yes it is possible</span>
<span class="comment-copy">Thanks @codekaizer, can you please show me how, i'm begginer in python ?</span>
<span class="comment-copy">read this: <a href="https://docs.python.org/3/library/json.html#json.loads" rel="nofollow noreferrer"><code>json.loads()</code></a> and <a href="https://docs.python.org/3/library/urllib.request.html#urllib.request.urlopen" rel="nofollow noreferrer"><code>urllib.requests</code></a></span>
