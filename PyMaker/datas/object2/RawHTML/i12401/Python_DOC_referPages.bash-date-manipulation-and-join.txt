<div class="post-text" itemprop="text">
<p>I have two CSV files that I would like to merge using the <code>DATE</code> (CSV 1) and <code>pickup_datetime</code> (CSV 2).</p>
<p><strong>CSV 1: Weather.csv (45KB ~ 365 rows)</strong></p>
<pre><code>head -3 Weather.csv 
STATION,STATION_NAME,ELEVATION,LATITUDE,LONGITUDE,DATE,PRCP,SNWD,SNOW,TMAX,TMIN,AWND,WDF2,WSF2
GHCND:USW00094728,NEW YORK CENTRAL PARK OBS BELVEDERE TOWER NY US,39.6,40.77889,-73.96917,20130101,0,0,0,44,-33,31,310,67
GHCND:USW00094728,NEW YORK CENTRAL PARK OBS BELVEDERE TOWER NY US,39.6,40.77889,-73.96917,20130102,0,0,0,6,-56,26,310,67
</code></pre>
<p><strong>CSV 2: Final_Data_1.csv (250MB ~ 1.5M rows)</strong></p>
<pre><code>head -3 final_data_1.csv 
medallion,hack_license,vendor_id_x,rate_code,store_and_fwd_flag,pickup_datetime,dropoff_datetime,passenger_count,trip_time_in_secs,trip_distance,pickup_longitude,pickup_latitude,dropoff_longitude,dropoff_latitude,vendor_id_y,payment_type,fare_amount,surcharge,mta_tax,tip_amount,tolls_amount,total_amount
DFD2202EE08F7A8DC9A57B02ACB81FE2,51EE87E3205C985EF8431D850C786310,CMT,1,N,2013-01-01 23:54:15,2013-01-01 23:58:20,2,244,0.7,-73.974602,40.759945,-73.984734,40.759388,CMT,CSH,5.0,0.5,0.5,0.0,0.0,6.0
237F49C3ECC11F5024B254268F054384,93C363DDF8ED9385D65FAD07CE3F5F07,CMT,1,N,2013-01-01 07:35:47,2013-01-01 07:46:00,1,612,2.3,-73.98850999999999,40.774307,-73.981094,40.755325,CMT,CSH,10.0,0.0,0.5,0.0,0.0,10.5
</code></pre>
<p>How do I manipulate the date column in both CSV files and merge it to get one file with columns of <code>Final_Data_1.csv</code> coming before <code>Weather.csv</code>?</p>
</div>
<div class="post-text" itemprop="text">
<p>You definitely don't want to be using Bash, a good way in Python would be to use pandas, something like this:</p>
<pre><code>import pandas as pd
df1 = pd.read_csv('weather.csv')
df2 = pd.read_csv('final.csv')
#format the date columns so they match up
df3 = pd.merge(df2,df1, on='date_formatted')
</code></pre>
</div>
<span class="comment-copy">How would you find out which line of FinalData is to be merged into which of Weather? So, which is the id to link them together?</span>
<span class="comment-copy">Since you are using the Python tag, have you tried the Python csv module?  <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">docs.python.org/3/library/csv.html</a></span>
<span class="comment-copy">Well, final_data will have approximately 50,000 rows for 2013-01-01. So it needs to replicate the corresponding values in weather.csv into the final_data.</span>
