<div class="post-text" itemprop="text">
<p>I have a messy dataset. Each row has 8 words scattered in 196 columns. the task is to find the column containing the word in each row.Example: the word 'Paid' can be in any of the 196 columns, but we know it's there. We need to know which column it's in. Thanks for your assistance.</p>
</div>
<div class="post-text" itemprop="text">
<p>I think <code>eq</code> + <code>idxmax</code> is simplest here for a few words and exact matches with the guarantee that it's there. Since it's only 8 words, perhaps just a list comprehension and concatenate the results:</p>
<h3>Sample Data:</h3>
<pre><code>import pandas as pd
import numpy as np

np.random.seed(123)
l = ['']*192 + ['paid', 'foo', 'bar', 'baz']
df = pd.DataFrame([np.random.choice(l, replace=False, size=196)
                   for i in range(5)])
</code></pre>
<h3>Code:</h3>
<pre><code>pd.concat([df.eq(word).idxmax(1).rename(word) for word in ['paid', 'foo', 'bar', 'baz']], 
          axis=1)

#   paid  foo  bar  baz
#0   112  167  184  142
#1   186   93   17  173
#2    56  142  179   67
#3    15   78   38   79
#4   116   84   18   61
</code></pre>
<hr/>
<p>If you only need to check columns [4:196] use <code>df.iloc[:, 4:197].eq(word)</code> instead of checking every column</p>
</div>
<span class="comment-copy">for the other data , is it blank or some kind of number ï¼Ÿ</span>
<span class="comment-copy">Welcome to SO! I think it would be easier for us to help you if you provided a small example table to better illustrate your question. For more information, please read our guide on writing a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a>.</span>
<span class="comment-copy">Each row has 200 columns. Columns 4:196 have either NaN or one of the 8 words.</span>
<span class="comment-copy">Thank you for the welcome Niayesh! an example table sounds like a great idea! I will post one tomorrow when I get on the computer.</span>
<span class="comment-copy">@LeeJack the otheo columns are just garbage that I don't need and values can be replaced. I just can't drop them because each column has one of the words potentnally in one or more of the rows.</span>
<span class="comment-copy">Thank you @ALollz that's exactly what I was looking for!</span>
