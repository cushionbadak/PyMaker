<div class="post-text" itemprop="text">
<p>I have a few records outputting in my pandas data frame as <code>NaT</code>.</p>
<p><em>i.e.</em> <code>Date_Refused_Final_Something_of_ICP=NaT,</code> </p>
<p>And it seems to disrupt my script. I would simply like to skip these few records found as Nat, and continue with the rest of the records/script.</p>
<p>Below is the complete relevant code:</p>
<pre><code>def get_excel_data(self):
    """Places excel data into pandas dataframe"""
    excel_data = pandas.read_excel(self.find_file())

    columns = pandas.DataFrame(columns=excel_data.columns.tolist())
    excel_data = pandas.concat([excel_data, columns])

    excel_data.columns = excel_data.columns.str.strip()
    excel_data.columns = excel_data.columns.str.replace("/", "_")
    excel_data.columns = excel_data.columns.str.replace(" ", "_")

    num_valid_records = 0

    for row in excel_data.itertuples():
        mrn = row.MRN

        if mrn in ("", " ", "N/A", None) or math.isnan(mrn):
            print(f"Invalid record: {row}")
            excel_data = excel_data.drop(excel_data.index[row.Index])
        else:
            num_valid_records += 1

    print(f"Processing #{num_valid_records} records")

    return self.clean_data_frame(excel_data)

def clean_data_frame(self, data_frame):
    """Cleans up dataframes"""
    for col in data_frame.columns:
        if "date" in col.lower():
            data_frame[col] = pandas.to_datetime(data_frame[col],
                                                 errors='coerce', infer_datetime_format=True)
            data_frame[col] = data_frame[col].dt.date
    data_frame['MRN'] = data_frame['MRN'].astype(int).astype(str)

    return data_frame

def get_mapping_data(self):
    map_data = pandas.read_excel(config.MAPPING_DOC, sheet_name='main')
    columns = pandas.DataFrame(columns=map_data.columns.tolist())
    return pandas.concat([map_data, columns])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I'm not sure where you're encountering this, but you can simply put <code>continue</code> when it finds this:</p>
<pre><code>if mrn in ("", " ", "N/A", None) or math.isnan(mrn):
            print(f"Invalid record: {row}")
            continue  # &lt;--- if it encounters any of the conditions above, it skips and goes to the next row in your excel_data
</code></pre>
</div>
<span class="comment-copy">Where within your loops will it find this <code>NaT</code>?</span>
<span class="comment-copy">That is good to know; I appreciate your candor</span>
<span class="comment-copy">Woah, woah; what if I don't want to skip the entire ROW, if encountered; but rather just the cell!?</span>
<span class="comment-copy">try changing the <code>continue</code> to <code>pass</code>. I'm not sure if that'll cause an error further in the code. I guess my question then would be is if you're putting this into a dataframe, there would need to be some value in that cell. I'm guess I'm just having trouble since I don;t know what your input excel file looks like, and what you want as your output dataframe to look like. Is it possible to share that?</span>
