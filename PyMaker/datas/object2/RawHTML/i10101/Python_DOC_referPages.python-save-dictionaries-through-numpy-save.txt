<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/10075661/how-to-save-dictionaries-and-arrays-in-the-same-archive-with-numpy-savez">How to save dictionaries and arrays in the same archive (with numpy.savez)</a>
<span class="question-originals-answer-count">
                    3 answers
                </span>
</li>
</ul>
</div>
<p>I have a large data set (millions of rows) in memory, in the form of <strong>numpy arrays</strong> and <strong>dictionaries</strong>. </p>
<p>Once this data is constructed I want to store them into files; 
so, later I can load these files into memory quickly, without reconstructing this data from the scratch once again.</p>
<p><strong>np.save</strong> and <strong>np.load</strong> functions does the job smoothly for numpy arrays.<br/>
But I am facing problems with dict objects. </p>
<p>See below sample. d2 is the dictionary which was loaded from the file. <strong>See #out[28] it has been loaded into d2 as a numpy array, not as a dict.</strong> So further dict operations such as get are not working.</p>
<p>Is there a way to load the data from the file as dict (instead of numpy array) ?</p>
<pre><code>In [25]: d1={'key1':[5,10], 'key2':[50,100]}

In [26]: np.save("d1.npy", d1)

In [27]: d2=np.load("d1.npy")

In [28]: d2
Out[28]: array({'key2': [50, 100], 'key1': [5, 10]}, dtype=object)

In [30]: d1.get('key1')  #original dict before saving into file
Out[30]: [5, 10]

In [31]: d2.get('key2')  #dictionary loaded from the file
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
&lt;ipython-input-31-23e02e45bf22&gt; in &lt;module&gt;()
----&gt; 1 d2.get('key2')

AttributeError: 'numpy.ndarray' object has no attribute 'get'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>It's a structured array. Use <code>d2.item()</code> to retrieve the actual dict object first:</p>
<pre><code>import numpy as np

d1={'key1':[5,10], 'key2':[50,100]}
np.save("d1.npy", d1)
d2=np.load("d1.npy")
print d1.get('key1')
print d2.item().get('key2')
</code></pre>
<p>result: </p>
<pre><code>[5, 10]
[50, 100]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/pickle.html" rel="nofollow">pickle</a> module can be used. Example code:</p>
<pre><code>from six.moves import cPickle as pickle #for performance
from __future__ import print_function
import numpy as np

def save_dict(di_, filename_):
    with open(filename_, 'wb') as f:
        pickle.dump(di_, f)

def load_dict(filename_):
    with open(filename_, 'rb') as f:
        ret_di = pickle.load(f)
    return ret_di

if __name__ == '__main__':
    g_data = {
        'm':np.random.rand(4,4),
        'n':np.random.rand(2,2,2)
    }
    save_dict(g_data, './data.pkl')
    g_data2 = load_dict('./data.pkl')
    print(g_data['m'] == g_data2['m'])
    print(g_data['n'] == g_data2['n'])
</code></pre>
<p>You may also save multiple python objects in a single pickled file. Each <code>pickle.load</code> call will load a single object in that case.</p>
</div>
<span class="comment-copy">any reason you're not using <a href="https://docs.python.org/2.7/library/pickle.html" rel="nofollow noreferrer">pickle</a> for the dictionaries?</span>
<span class="comment-copy"><code>with open('file.pkl', 'wb') as f: pickle.dump(your_dict, f)</code> should do the job.</span>
<span class="comment-copy"><a href="http://stackoverflow.com/questions/10075661/how-to-save-dictionaries-and-arrays-in-the-same-archive-with-numpy-savez">This post</a>  answers my questions perfectly. Thanks for pointing in the right direction. For an immediate fix I am doing <code>d2=load("d1.npy").flat[0]</code> as suggested in the comments. I will try porting to pickle anyway.</span>
<span class="comment-copy">d2.item() works perfectly. Thanks.</span>
<span class="comment-copy">Also d2.flat[0] works, as mentioned in <a href="http://stackoverflow.com/questions/10075661/how-to-save-dictionaries-and-arrays-in-the-same-archive-with-numpy-savez">this post</a></span>
<span class="comment-copy">@ramu yes, note that you can accept an answer that you find useful for your question, by clicking on the check mark of the answer.  In this case other people who might be looking for the same problem will find the answer that worked for you quickly.</span>
<span class="comment-copy">even , <code>d2.any().get('key1')</code> or <code>d2.all().get('key1')</code> works</span>
<span class="comment-copy">@SanjayPoongunran, thanks, for my kind of wierd behaviour of numpy, only your solution works :)</span>
