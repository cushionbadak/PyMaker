<div class="post-text" itemprop="text">
<p>I'm modifying our pacific time zone filter to include a time option. I don't want the time component to be shown if midnight. The only import thus far we are using is dateutil.parser. Any pointers on best solution would be appreciated! Thanks.</p>
<pre><code>def to_pacific_date_str(timestamp, format='%Y-%m-%d', time=False):
    pacific_timestamp = timestamp

    if time:
        format='%Y-%m-%d %H:%M' # 2016-10-03 00:00
    if timestamp.tzname() is None:
        # setting timezone lost when pulled from DB
        utc_timestamp = timestamp.replace(tzinfo=pytz.utc)
        # always converting to pacific timezone
        pacific_timestamp = utc_timestamp.astimezone(pytz.timezone('US/Pacific'))
    return pacific_timestamp.strftime(format)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I believe the best thing to do would be to just take the <code>time()</code> from the <code>datetime</code> before passing it, then compare that to <code>datetime.time(0, 0)</code>.</p>
<pre><code>import pytz
import datetime

def to_pacific_date_str(timestamp, date_fmt='%Y-%m-%d', time=False):
    pacific_timestamp = timestamp

    if timestamp.tzinfo is None:
        # setting timezone lost when pulled from DB
        utc_timestamp = timestamp.replace(tzinfo=pytz.utc)
        # always converting to pacific timezone
        pacific_timestamp = utc_timestamp.astimezone(pytz.timezone('US/Pacific'))

    if time and pacific_timestamp.time() != datetime.time(0, 0):
        date_fmt = '%Y-%m-%d %H:%M' # 2016-10-03 00:00

    return pacific_timestamp.strftime(date_fmt)
</code></pre>
<p>Note that I've changed <code>format</code> to <code>date_fmt</code>, because <a href="https://docs.python.org/3/library/functions.html#format" rel="nofollow"><code>format()</code> is already a builtin</a>. Also, from a design standpoint, it's probably not a great idea to have <code>time</code> override the specified format string, so maybe change the "add time" portion to be <code>date_fmt = date_fmt + ' %H:%M'</code>.</p>
<p>Demonstration:</p>
<pre><code>&gt;&gt;&gt; PST = pytz.timezone('US/Pacific')
&gt;&gt;&gt; to_pacific_date_str(PST.localize(datetime.datetime(2015, 4, 1, 0, 0)), time=True)
'2015-04-01'

&gt;&gt;&gt; PST = pytz.timezone('US/Pacific')
&gt;&gt;&gt; to_pacific_date_str(PST.localize(datetime.datetime(2015, 4, 1, 2, 0)), time=True)
'2015-04-01 02:00'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Alternatively you can use the <code>.hour</code>, <code>.minute</code> and <code>.second</code> attributes of the datetime object. Like this:</p>
<pre><code>from datetime import datetime as dt
from pytz import timezone

now = dt.now(timezone('US/Pacific'))
midnight = now.hour == 0 and now.minute == 0 and now.second == 0
</code></pre>
<p><code>midnight</code> is a boolean indicating if it is midnight in the US/Pacific timezone.</p>
</div>
<div class="post-text" itemprop="text">
<p>To check if the time is midnight:</p>
<pre><code>from datetime import datetime
def checkIfMidnight():
    now = datetime.now()
    seconds_since_midnight = (now - now.replace(hour=0, minute=0, second=0, microsecond=0)).total_seconds()
    return seconds_since_midnight == 0
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I am not sure if this is the solution you are/were looking for but personally I use simple comparison:</p>
<pre><code>import datetime   
...
time == datetime.time(hour=0, minute=0, second=0, microsecond=0)
</code></pre>
<p>where <em>time</em> is TimeObject (datetime.time)</p>
</div>
<span class="comment-copy">I think you may want to check if <code>timestamp.tzinfo</code> is <code>None</code>, not <code>tzname()</code>.</span>
<span class="comment-copy">Thank you this worked great! Just what I was looking for.</span>
<span class="comment-copy">I need to know if the date string I am passing to the filter is midnight such as:</span>
<span class="comment-copy">Sorry it won't let me edit the above sentence which accidentally got entered. As I was saying I need to pass an existing date/time from our d/b to this filter that displays in a jinja template so it would be something like {{item.sold_on|checkIfMidnight(time=True)}}</span>
<span class="comment-copy">I did it again... so time=True was telling the pacific time filter to include the time when it is returned to the template. So in some cases we want to show the time with the date and other times we just want the date to display in the jinja template hence the filter. The next issue is when we do want to include the time we only want to include the time if it is not midnight. Thanks!</span>
