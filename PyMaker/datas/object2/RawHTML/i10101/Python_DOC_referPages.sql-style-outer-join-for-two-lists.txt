<div class="post-text" itemprop="text">
<p>I have data from a platform that records a users events - whether answers to polls, or clickstream data. I am trying to bring together a number of related datasets, each of which has a session_id column.</p>
<p>Each dataset began as a csv that was read in as a series of nested lists. Not every session will have a user answering a question, or completing certain actions, so each dataset will <em>not</em> contain an entry for every session -- however, every session exists in at least one of the datasets.</p>
<p>assume there are 5 sessions recorded:</p>
<p><strong>e.g. dataset 1:</strong></p>
<p>SessionID |a | b | c | d </p>
<hr/>
<p>1  |  x | x | x | x</p>
<hr/>
<p>2  |  x | x | x | x</p>
<hr/>
<p>5  |  x | x | x | x</p>
<hr/>
<p><strong>e.g. dataset 2:</strong></p>
<p>SessionID |e | f | g | h </p>
<hr/>
<p>1  |  x | x | x | x</p>
<hr/>
<p>3  |  x | x | x | x</p>
<hr/>
<p>5  |  x | x | x | x</p>
<hr/>
<p><strong>e.g. dataset 3:</strong></p>
<p>SessionID |i | j | k | l </p>
<hr/>
<p>2  |  x | x | x | x</p>
<hr/>
<p>3  |  x | x | x | x</p>
<hr/>
<p>4  |  x | x | x | x</p>
<hr/>
<p>How would I construct this:</p>
<p>SessionID |a | b | c | d | e | f | h | i |j | k | l</p>
<hr/>
<p>1  |  x | x | x | x | x | x | x | x | - | - | - | -</p>
<hr/>
<p>2  |  x | x | x | x | - | - | - | - | x | x | x | x</p>
<hr/>
<p>3  | - | - | - | - | x | x | x | x | x | x | x | x</p>
<hr/>
<p>4  | - | - | - | - | - | - | - | - | x | x | x | x</p>
<hr/>
<p>5  |  x | x | x | x | x | x | x | x | - | - | - | -</p>
<hr/>
<p>By far the easiest way to do this is to import each csv into pandas:</p>
<pre><code>merged_df = pd.merge(dataset1, dataset2, how = 'outer', on="sessionID")
pd.merge(merged_df, dataset3, how = 'outer', on="sessionID")
</code></pre>
<p>however the requirements are that I not use any external libraries.</p>
<p>I'm struggling to find a workable logic to detect gaps in the sessionID, and then pad the lists with null data so the three lists would be simply added together.</p>
<p>Any ideas?</p>
</div>
<div class="post-text" itemprop="text">
<p>How do you define "external libraries"? Does <a href="https://docs.python.org/3/library/sqlite3.html" rel="nofollow">sqlite3</a> qualify as external or internal? </p>
<ol>
<li><p>If it doesn't and you want to think about the problem in terms of relational operations, you could slam your tables into a sqlite3 file and take it from there.</p></li>
<li><p>If the number of datasets is finite, you could create a class Session, containing a dictionary where each column (a to j) would be a key. If you are proficient, you could use the __getattr__ function to use a "dot" notation when you need it. For the "table", I would simply use a dictionary, with the key as the id, then fill up your dictionary in three steps (dataset1, dataset2, dataset3). In this way you wouldn't have to worry about gaps.</p></li>
</ol>
</div>
<span class="comment-copy">sqlite3 seems to be working well. Thanks!</span>
