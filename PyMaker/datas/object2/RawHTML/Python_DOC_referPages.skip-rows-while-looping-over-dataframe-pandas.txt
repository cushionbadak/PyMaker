<div class="post-text" itemprop="text">
<p>I am struggling with the following and do not seem to find any solution online.</p>
<p>I have a for loop over a dataframe. This loop is supposed to do the following: if the content of column 'reversal' == 1, populate 'action' column with 1, skip 125 rows, populate the next 126th row of 'action' with -1, and continue repeating the loop from the next row. If column 'reversal'!=1, continue with the loop without populating 'action'. </p>
<h2>Issue 1 I have is that, when I write 'index = index + 126', for some reason python does not understand that it needs to skip the 126 rows.`</h2>
<h2>Issue 2 is that, when I add a condition to avoid to have the action column longer than the reversal column, that condition does not work (see code comments).</h2>
<pre><code>#creating the on/off signal column
df_zinc['action'] = 0

#creating the loop
for index,row in df_zinc.iterrows():
    if row.reversal == 1:
        df_zinc.loc[index,'action'] = 1
        if index&lt;len(df_zinc.index)-126:             #the purpose of this condition is to not have the action column longer than the reversal column. Thuogh, it appears not to be working
            df_zinc.loc[index+126, 'action'] = -1
        index= index + 127
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>import numpy as np
import pandas as pd
reversal=np.eye(126,dtype=int)
reversal=reversal.reshape(-1)
data=pd.DataFrame({"reverse":reversal})
data['action']=0
for index in range(len(data)):
    if data.loc[index,"reverse"] == 1:
        data.loc[index,'action'] = 1
        if index&lt;len(data.index)-126:            
            data.loc[index+126, 'action'] = -1
        index= index + 127
</code></pre>
<p>You can try this</p>
</div>
<div class="post-text" itemprop="text">
<p>don't use itterrows() if you can use indexing.</p>
<p>try this:</p>
<pre><code>#creating the on/off signal column
# df_zinc['action'] = 0
#
count = 0
# #creating the loop
for index in df_zinc.index:
    if index &lt; count:
        continue
    if df_zinc.at[index , 'reversal'] == 1:
        df_zinc.at[index , 'action'] = 1
        if index &lt; len(df_zinc)-126:             #the purpose of this condition is to not have the action column longer than the reversal column. Thuogh, it appears not to be working
            df_zinc.at[index+126, 'action'] = -1
        count = index + 127
</code></pre>
</div>
