<div class="post-text" itemprop="text">
<p>Are there any existing tools for side effects/purity analysis in Python, similar to <a href="http://jppa.sourceforge.net">http://jppa.sourceforge.net</a> in Java?</p>
</div>
<div class="post-text" itemprop="text">
<p>I don't know of any that exist, but here are some general approaches to making one:</p>
<ul>
<li><p>Analysing source files as text - using regular expressions to find things that show a function definitely <em>isn't</em> pure - e.g. the <code>global</code> keyword. For practical purposes, most decently written functions that only have a <code>return</code> statement in the body are likely to be pure. On the other hand, if a function <em>doesn't</em> have a <code>return</code> statement, it is either useless, or impure.</p></li>
<li><p>Analysing functions in a source file as code. If testing a function in isolation produces a <code>NameError</code>, you know that it is either impure (because it doesn't have access to variables at a higher level), or has a mistake in it (referring to a variable before it is defined or some such), however the latter case should be covered by normal testing. The inspect module's function <a href="http://docs.python.org/3/library/inspect.html#inspect.isfunction" rel="nofollow noreferrer">isfunction</a> may be useful if you want to do this.</p>
<p>For each function you test, if it has a relatively small domain (e.g. one input that can either be 1, 2, 3 or 4) then you could exhaustively test all possible inputs, and get a certain answer this way. If it has a limited, or finite but large domain (e.g. all the real numbers between 0 and 1000 (infinite but limited), or all the integers between -12345 and 67890) then you could try sampling a selection of inputs in that domain, and use that to get a probability of purity. However, this approach may not be very useful, as the domain of the function is unlikely to be specified, so you may only be able to check it if you wrote the function, in which case you may not need to analyse it anyway.</p></li>
<li><p>Doing something clever, possibly in combination with the above techniques. For instance, making a neural network, with the input as the text of a function, and the output as the likelihood of it being pure. You could then train the network on examples of functions you know to be pure or impure, and then use it on functions of unknown purity.</p></li>
</ul>
<p>Edit:
I came back to this question after someone downvoted with new knowledge! The <code>ast</code> module should make it relatively easy to write your own analysis tool like this, as it allows you access to the abstract syntax tree of code. It should be fairly easy to walk through this tree and see if there is anything preventing purity. This is a much better approach than analysing source files as text, and I might have a go at it at some point.
Finally, <a href="https://stackoverflow.com/questions/20569142/is-there-any-way-to-prevent-side-effects-in-python">this</a> question might also be useful, and also <a href="https://stackoverflow.com/questions/10509916/enforcing-side-effects-in-python">this</a> one, which is basically a duplicate of this question.</p>
</div>
<span class="comment-copy">If you think that tool questions should not be closed, then vote to re-open.</span>
