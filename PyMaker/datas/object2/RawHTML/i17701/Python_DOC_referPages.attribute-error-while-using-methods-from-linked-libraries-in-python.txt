<div class="post-text" itemprop="text">
<p>I'm trying to use some C++ method in my python code and I'm using <code>ctypes</code> library. I have wrote a simple C++ code using a simple <code>main</code> with no arguments and another simple method named <code>printArgs</code> which takes an argument of type <code>char *</code>. I also have wrote a simple python code to import these two methods. I made two linked libraries(one <code>.so</code> and one <code>.a</code> because I'm using Debian) with this command:</p>
<pre><code>g++ -o hello.so -shared -fPIC hello.cpp 
</code></pre>
<p>And then used <code>export LD_LIBRARY_PATH=/the/path/to/the/linked/libraries/directory</code>.</p>
<p>There is no problem in getting the <code>main</code> method, bu when I'm trying to get <code>printArgs</code> I get <code>AttributeError</code>. Here's the C++ code:</p>
<pre><code>#include &lt;iostream&gt;
using namespace std;

int printArgs(char * args_array){
    for (int i = 0; i &lt; 5; i++){
        cout&lt;&lt;i&lt;&lt;"- "&lt;&lt;args_array[i]&lt;&lt;"\n";
    }
    return 0;
}

int main(){
    cout&lt;&lt;"Hello\n";
    return 0;
}
</code></pre>
<p>Here's the Python code:</p>
<pre><code>from ctypes import *
helloInCPP_lib = cdll.LoadLibrary("hello.a")
print helloInCPP_lib
helloInCPPMain = helloInCPP_lib.main
print helloInCPPMain
helloInCPPPrint = helloInCPP_lib.printArgs
print helloInCPPPrint
</code></pre>
<p>I get this output:</p>
<pre><code>&lt;CDLL 'hello.a', handle 9c45488 at b73d1e6c&gt;
&lt;_FuncPtr object at 0xb73e67e4&gt;
Traceback (most recent call last):
    File "testHelloInCPP.py", line 9, in &lt;module&gt;
        helloInCPPPrint = helloInCPP_lib.printArgs(None)
    File "/usr/lib/python2.6/ctypes/__init__.py", line 366, in __getattr__
        func = self.__getitem__(name)
    File "/usr/lib/python2.6/ctypes/__init__.py", line 371, in __getitem__
        func = self._FuncPtr((name_or_ordinal, self))
AttributeError: /etc/linked_libraries/hello.a: undefined symbol: printArgs
</code></pre>
<p>I also tried <code>cdll.LoadLibrary("hello.so")</code> and/or <code>helloInCPPPrint = helloInCPP_lib.printArgs(None)</code>; got the same error in both conditions. Any idea?</p>
<p>I'm using Debian 32 bit on a VMWare Workstation and Python 2.6. </p>
</div>
<div class="post-text" itemprop="text">
<p>Declare the <code>printArgs</code> using <a href="http://www.tldp.org/HOWTO/C++-dlopen/thesolution.html" rel="nofollow"><code>extern "C"</code></a>:</p>
<pre><code>#include &lt;iostream&gt;
using namespace std;

extern "C" {
    int printArgs(char * args_array);
}

int printArgs(char * args_array){
    for (int i = 0; i &lt; 5; i++){
        cout&lt;&lt;i&lt;&lt;"- "&lt;&lt;args_array[i]&lt;&lt;"\n";
    }
}

int main(){
    cout&lt;&lt;"Hello\n";
}
</code></pre>
<hr/>
<p>BTW, you should pass a string (c_char_p), not <code>None</code>:</p>
<pre><code>...
helloInCPPPrint = helloInCPP_lib.printArgs
helloInCPPPrint.argtypes = [c_char_p]
print helloInCPPPrint("ABCDE")
</code></pre>
<p>About <code>argtypes</code>, see <a href="http://docs.python.org/3/library/ctypes.html#specifying-the-required-argument-types-function-prototypes" rel="nofollow">Specifying the required argument types (function prototypes)</a>.</p>
</div>
<span class="comment-copy">I have got <code>Segmentation fault</code> for <code>printArgs</code>.</span>
<span class="comment-copy">@ZeinabAbbasi, What did you pass to <code>printArg</code> ? <code>None</code> ??</span>
<span class="comment-copy">@ZeinabAbbasi, I updated the answer with slightly modified Python code. Check it out.</span>
<span class="comment-copy">Thank you, that was the answer.</span>
<span class="comment-copy">@ZeinabAbbasi, See <a href="http://docs.python.org/3/library/ctypes.html#ctypes._FuncPtr.restype" rel="nofollow noreferrer"><code>restype</code></a>  and <a href="http://docs.python.org/3/library/ctypes.html#return-types" rel="nofollow noreferrer">Return types</a>.</span>
