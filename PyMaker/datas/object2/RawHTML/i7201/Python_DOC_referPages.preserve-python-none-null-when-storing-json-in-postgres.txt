<div class="post-text" itemprop="text">
<p>I have a PostgreSQL database table that has a JSON datatype column. When I store JSON strings in the database, <code>None</code> is not preserved. This can be reproduced with this code snippet:</p>
<pre><code>import json,psycopg2

dictionary = {}
dictionary[None] = 0

conn = psycopg2.connect("host='localhost' dbname='testdb' user='postgres' 
password='postgres'")
cursor = conn.cursor()

cursor.execute("""INSERT INTO testtable (json_column) VALUES (%s)""", 
(json.dumps(dictionary), ))
cursor.execute("""SELECT json_column FROM testtable""")
result = cursor.fetchall()[0][0].keys()[0]

print result
print type(result)
if result is None:
    print 'result is None'
else:
    print 'result is not None'
</code></pre>
<p>The output of this Python code is:</p>
<pre><code>drew@debian:~/python$ python test.py
null
&lt;type 'unicode'&gt;
result is not None
drew@debian:~/python$
</code></pre>
<p>How can I store <code>None</code> as a key in the JSON column? The JSON object also has keys for <code>'None'</code> and <code>'null'</code>, so the value stored must be <code>None</code> or <code>null</code>.</p>
</div>
<div class="post-text" itemprop="text">
<p>From <a href="https://tools.ietf.org/html/rfc7159.html#section-4" rel="nofollow noreferrer">RFC 7159</a>:</p>
<blockquote>
<p>An object structure is represented as a pair of curly brackets
  surrounding zero or more name/value pairs (or members).  <strong>A name is a
  string.</strong></p>
</blockquote>
<p>And from the <a href="https://docs.python.org/3/library/json.html#json.dumps" rel="nofollow noreferrer">Python docs</a>:</p>
<blockquote>
<p>Keys in key/value pairs of JSON are always of the type str. <strong>When a
  dictionary is converted into JSON, all the keys of the dictionary are
  coerced to strings.</strong></p>
</blockquote>
<p>JSON <strong>does not have any concept of non-string dict keys</strong>. If you want those, you don't want JSON. The closest you'll get with JSON is detecting the string <code>None</code> gets converted to and hoping that you never need to actually use the string <code>'null'</code> as a dict key.</p>
</div>
<span class="comment-copy">You're doing it wrong. You should use a <a href="https://stackoverflow.com/questions/45150617/adding-dict-object-to-postgresql">JSON <i>column type</i> in PostgreSQL</a>...</span>
<span class="comment-copy">You can't have <code>None</code> (or <code>null</code>, the JSON equivalent) be a key in a JSON object. Your dict simply isn't compatible with the JSON format.</span>
<span class="comment-copy">Is there another dictionary-like datatype that can handle non-string keys?</span>
<span class="comment-copy">@Drew: You may be interested in <a href="https://en.wikipedia.org/wiki/YAML" rel="nofollow noreferrer">YAML</a>.</span>
