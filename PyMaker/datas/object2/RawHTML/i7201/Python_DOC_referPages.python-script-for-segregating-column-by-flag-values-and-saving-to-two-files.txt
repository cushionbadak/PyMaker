<div class="post-text" itemprop="text">
<p>I have a data file containing four columns. </p>
<p>test.txt file :</p>
<p>id | addr  | value | flag|</p>
<p>:--|:----- |-------|-----|</p>
<p>300|  275  |   5   |  0  |</p>
<p>300|  766  |  15   |  1   </p>
<p>300|  276  |   3   |  1  </p>
<p>300|  248  |   6   |  1</p>
<p>300|  267  |   11  |  1 </p>
<p>508|205    |   12  |  0</p>
<p>508|201    |   12  |  1</p>
<p>301|32     |   3   |  0</p>
<p>301|44     |   4   |  1</p>
<p>301|32     |   2   |   0</p>
<p>I need to segregate the second column values based on the flag value of the fourth column and save those to two separate files.</p>
<p>required output:
file:1 </p>
<h2>id  |  addr(f=0)</h2>
<p>300 |  275<br/>
508 |  205<br/>
301 |  32<br/>
file:2</p>
<h2>id  | addr(f=1)</h2>
<p>300 |766<br/>
300 |276<br/>
300 |248<br/>
300 |267<br/>
508 |201<br/>
301 |44</p>
<p>I am very new to python and so far I have done the following. </p>
<pre><code>import sys

if len(sys.argv) &lt; 2:
    sys.stderr.write("Usage: {0} filename\n".format(sys.argv[0]))
    sys.exit()

fn = sys.argv[1]
sys.stderr.write("reading " + fn + "...\n")

# Initialize dictionaries (or hash id)
list_id = {}

fin = open(fn,"r")
for line in fin:
    line = line.rstrip()
    f = line.split("|")
    id = f[0]
    addr = f[1]
    flag = f[3]

fin.close()
</code></pre>
<p>Need your suggestion to complete the program.
Thanks in advance for your kind help. </p>
<p>The real glimpse of Data :</p>
<p><a href="https://i.stack.imgur.com/5oyl8.jpg" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/5oyl8.jpg"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>this is a variant using the <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer"><code>csv</code> module</a>:</p>
<pre><code>from csv import reader, writer

with open('test.txt', 'r') as file:
    rows = reader(file, delimiter='|', skipinitialspace=True)
    with open('file1.txt', 'w') as file1, open('file2.txt', 'w') as file2:
        writer1 = writer(file1, delimiter='|')
        writer2 = writer(file2, delimiter='|')
        for row in rows:

            try:
                flag = int(row[3])
            except IndexError:
                # row does has less than 4 elements, next row!
                print('row too short!', row)
                continue
            except ValueError:
                # if this is not an integer, next row!
                print('row[3] not an int!', row[3])
                continue

            if flag == 0:
                writer1.writerow(row[:2])  # write the first 2 entries only
            elif flag == 1:
                writer2.writerow(row[:2])
            else:
                print('flag not in (0, 1)!', flag)
</code></pre>
<hr/>
<p>for your updated (and different from the original) input, changing the reader to</p>
<pre><code>rows = reader(file, delimiter=' ', skipinitialspace=True)
</code></pre>
<p>should work.</p>
</div>
<div class="post-text" itemprop="text">
<p>All you need is the if-else now.</p>
<pre><code>to_write = id + "\t" + addr

if flag == 0:
    # write out the "to_write" to file number 1
elif flag == 1:
    # write out the "to_write" to file number 2
</code></pre>
</div>
<span class="comment-copy">it would be really helpful if you also add an expected output to the question :), could you?</span>
<span class="comment-copy">@DamianLattenero He already did.</span>
<span class="comment-copy">Also, your input text looks like it has the pipe character <code>|</code> as a separator, but you use a tab <code>\t</code> in your code. Can you update either the input or the code, or specify that the text file is a TSV file?</span>
<span class="comment-copy">@Bit haha that's true, I didn't understood sorry</span>
<span class="comment-copy">Thank you for your quick reply. I am getting the following error:  Traceback (most recent call last):   File "C:\Users\mithu\Desktop\test\ex01 - Copy.py", line 14, in &lt;module&gt;     flag = int(row[3]) IndexError: list index out of range</span>
<span class="comment-copy">yeah, noticed the empty lines in your input file. should be fixed now.</span>
<span class="comment-copy">Great !! after the edit in the code for the index error the code worked perfectly! Genius ! Thanks a  lot!</span>
<span class="comment-copy">Hey, sorry to get back to you again on this! The code worked well for the above input. but after testing it to a bigger test file it stopped working again. there is no error and file1 and file2 is generated, but no sorted output inside the file.It also stopped working on the old test data as well !!!!! Your suggestion requested.</span>
<span class="comment-copy">70279  442 1700000000000 0  70280  70280 5000000000 1 70281  70281 5000000000 1 70288  70288 5000000000 0 70288  70288 5000000000 1 Consider above as the new test data... Do I have to change the delimiter in the previous code?- Thanks</span>
<span class="comment-copy">Please assist me to understand with some code and a bit of explanation.  Thanks a ton!</span>
