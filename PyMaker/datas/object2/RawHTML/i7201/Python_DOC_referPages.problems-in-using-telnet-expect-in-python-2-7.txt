<div class="post-text" itemprop="text">
<p>I am trying to telnet to remote server and trying to get the response back.</p>
<p>I was using <code>telnet.read_until</code> earlier to match whether prompt/pattern appeared or not but read_until returns everything even if there is no match. I thought of using <code>telnet.expect</code> but i am getting error</p>
<p>Below is the code</p>
<pre><code>com = re.compile("\#") # is the prompt
tn.write("somecommand" + "\n")
res = tn.expect(com, 10)
</code></pre>
<p>Error I am getting is </p>
<pre><code>  File "reg.txt", line 23, in login
    res = tn.expect(com, 10)
  File "C:\Python27\lib\telnetlib.py", line 593, in expect
    list = list[:]
TypeError: '_sre.SRE_Pattern' object is not subscriptable
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><code>telnetlib.expect()</code> requires <code>list</code> as first argument, you are giving a <code>SRE_pattern</code>.</p>
<p>From <a href="https://docs.python.org/3/library/telnetlib.html#telnetlib.Telnet.expect" rel="nofollow noreferrer">telnetlib documentation</a>:</p>
<blockquote>
<p>Telnet.expect(list, timeout=None)</p>
<p>Read until one from a list of a regular expressions matches.</p>
<p>The first argument is a list of regular expressions, either compiled (regex objects) or uncompiled (byte strings). The optional second argument is a timeout, in seconds; the default is to block indefinitely.</p>
<p>[...]</p>
</blockquote>
<hr/>
<pre><code>com = re.compile("\#") # is the prompt
tn.write("somecommand" + "\n")
res = tn.expect([com], 10)
</code></pre>
<p>Should works (<em>the diff is <code>expect([com])</code> instead of <code>expect(com)</code></em>).</p>
</div>
<span class="comment-copy">Thanks. Its working</span>
