<div class="post-text" itemprop="text">
<p>Here i need to parse the xml and get the values. I need to get attribute element  like 'personid =01' which i couldnt get in this code. And also i need to fetch the grand children node values also. here it is for "SIBLING" and its name tags.BUt i cant hard code it as sibling and fetch the value. And top of all i need to handle multiple attributes and join them to form a unique key which will come as a column in the final table.   </p>
<pre><code>import xml.dom
import xml.dom.minidom

doc = xml.dom.minidom.parseString('''
&lt;root&gt;
   &lt;person id="01"&gt; 
      &lt;name&gt; abc&lt;/name&gt; 
      &lt;age&gt;32&lt;/age&gt;
      &lt;address&gt;addr123&lt;/address&gt;
      &lt;siblings&gt;
        &lt;name&gt;&lt;/name&gt;
      &lt;/siblings&gt;
   &lt;/person&gt;
   &lt;person id="02"&gt;
      &lt;name&gt; def&lt;/name&gt;
      &lt;age&gt;22&lt;/age&gt;
      &lt;address&gt;addr456&lt;/address&gt;
      &lt;siblings&gt;
        &lt;name&gt;&lt;/name&gt;
        &lt;name&gt;&lt;/name&gt;
      &lt;/siblings&gt;
   &lt;/person&gt;
&lt;/root&gt;

''')

innerlist=[]
outerlist=[]
def innerHtml(root):
    text = '' 
    nodes = [ root ]
    while not nodes==[]:
        node = nodes.pop()
        if node.nodeType==xml.dom.Node.TEXT_NODE:
            text += node.wholeText
        else:
            nodes.extend(node.childNodes)
    return text

for statusNode in doc.getElementsByTagName('person'):
    for childNode in statusNode.childNodes:
        if childNode.nodeType==xml.dom.Node.ELEMENT_NODE:
           if innerHtml(childNode).strip() != '':
              innerlist.append(childNode.nodeName+" "+innerHtml(childNode).strip())
    outerlist.append(innerlist)
    innerlist=[]
#print(outerlist) 

attrlist = []
nodes = doc.getElementsByTagName('person')
for node in nodes:
    if 'id' in node.attributes:
        #print(node.attributes['id'].value)
        attrlist.append(node.attributes['id'].value)
#print(attrlist)

dictionary = dict(zip(attrlist, outerlist))
print(dictionary) 
</code></pre>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p><strong>Comment</strong>:  i have stored it in a dictnorary. <code>{'01': ['name abc', 'age 32', 'address addr123'], '02': ['name def', 'age 22', 'address addr456']}</code>.</p>
</blockquote>
<p>You can't write suche a <code>dict</code> to CSV!  </p>
<pre><code>ValueError: dict contains fields not in fieldnames: '01' 
</code></pre>
<p>Do you <strong>REALY</strong> want to convert to <strong>CSV</strong>?<br/>
Read about <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">CSV File Reading and Writing</a></p>
<blockquote>
<p><strong>Comment</strong>: Here i need to get sibiling tag also as another innerlist.  </p>
</blockquote>
<p>CSV dosn't support such <em><strong>innerlist</strong></em>?<br/>
Edit your Question and show expected CSV Output!</p>
<hr/>
<blockquote>
<p><strong>Question</strong>: xml to csv conversion</p>
</blockquote>
<p>Solution with <code>xml.etree.ElementTree</code>.</p>
<blockquote>
<p><strong>Note</strong>: Don't understand how you want to handle <em><strong>grand children node values</strong></em>.<br/>
  Write it as List of <code>dict</code> in one Column.</p>
</blockquote>
<pre><code>import csv
import xml.etree.ElementTree as ET
root = ET.fromstring(doc)

fieldnames = None
with open('doc.csv', 'w') as fh:
    for p in root.findall('person'):
        person = {'_id':p.attrib['id']}
        for element in p:
            if len(element) &gt;= 1:
                person[element.tag] = []
                for sub_e in element:
                    person[element.tag].append({sub_e.tag:sub_e.text})
            else:
                person[element.tag] = element.text

        if not fieldnames:
            fieldnames = sorted(person)
            w = csv.DictWriter(fh, fieldnames=fieldnames)
            w.writeheader()

        w.writerow(person)
</code></pre>
<blockquote>
<p><strong>Output</strong>:</p>
<pre><code>_id,address,age,name,siblings
01,addr123,32, abc,[{'name': 'sib1'}]
02,addr456,, def,"[{'name': 'sib2'}, {'name': 'sib3'}]"
</code></pre>
</blockquote>
<p><strong><em>Tested with Python: 3.4.2</em></strong></p>
</div>
<span class="comment-copy">I got output like below. And i have made few changes in above code. where personid is used as a unique key to identify its value. i have stored it in a dictnorary.   {'01': ['name abc', 'age 32', 'address addr123'], '02': ['name def', 'age 22', 'address addr456']}  . Here i need to get sibiling tag also as another innerlist.</span>
<span class="comment-copy">in above code i have skipped giving the values to "sibling" name attribute. If "sibling name" tag is empty my code will not append it. But if sibling tag has values it must append as a inner list. Under the unique key "personid". I have used .strip() to avoid empty spaces.Constrain is if values are there it should display. if values are not there then it should not display. For me its not displayiong since values are not there. but if values are there its should display.</span>
<span class="comment-copy">Pls try to correct in my code itslf without changing the complete code. If possible. Thanks.</span>
