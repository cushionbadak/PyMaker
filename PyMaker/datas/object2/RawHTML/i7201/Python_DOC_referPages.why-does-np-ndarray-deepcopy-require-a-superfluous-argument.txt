<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/42846309/python-numpy-deepcopy-typeerror">Python: Numpy __deepcopy__ TypeError</a>
<span class="question-originals-answer-count">
                    3 answers
                </span>
</li>
</ul>
</div>
<p>The duplicate will answer <code>what</code>, but will not adequately answer <code>why</code> or why it is not mentioned in the docs even though it is required. Read on for more... </p>
<hr/>
<p>There are two ways of making a deep copy of a numpy array. One way is using <code>copy.deepcopy</code> from the <code>copy</code> module. The other way is to call <code>array.__deepcopy__</code> directly.</p>
<p>From the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.__deepcopy__.html" rel="nofollow noreferrer">docs</a>:</p>
<blockquote>
<pre><code>ndarray.__deepcopy__() → Deep copy of array.
</code></pre>
<p>Used if <code>copy.deepcopy</code> is called on an array.</p>
</blockquote>
<p>The docs hint that the right way to call this function is without any argument. However....</p>
<pre><code>In [47]: x
Out[47]: 
array([[1, 1],
       [2, 2]])

In [48]: x.__deepcopy__()
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
&lt;ipython-input-48-00c3b8eda618&gt; in &lt;module&gt;()
----&gt; 1 x.__deepcopy__()

TypeError: __deepcopy__() takes exactly 1 argument (0 given)
</code></pre>
<p>A <code>TypeError</code> is returned! But...</p>
<pre><code>In [51]: x.__deepcopy__(None)
Out[51]: 
array([[1, 1],
       [2, 2]])
</code></pre>
<p>And even...</p>
<pre><code>In [52]: x.__deepcopy__([12345, 'blah blah'])
Out[52]: 
array([[1, 1],
       [2, 2]])
</code></pre>
<p>It appears this function requires an argument but that argument supposedly has no bearing on the returned copy. </p>
<p>This argument is not mentioned in the documentation. Is it a doc bug? Why is it even passed in if it is ignored?</p>
</div>
<div class="post-text" itemprop="text">
<p>Python requires the <code>__deepcopy__()</code> method to take one argument <code>memo</code> (<a href="https://docs.python.org/3/library/copy.html" rel="nofollow noreferrer">docs</a>):</p>
<blockquote>
<p>In order for a class to define its own copy implementation, it can define special methods <code>__copy__()</code> and <code>__deepcopy__()</code>. The former is called to implement the shallow copy operation; no additional arguments are passed. The latter is called to implement the deep copy operation; <strong>it is passed one argument, the memo dictionary</strong>. If the <code>__deepcopy__()</code> implementation needs to make a deep copy of a component, it should call the <code>deepcopy()</code> function with the component as first argument and the memo dictionary as second argument.</p>
</blockquote>
<p>Its purpose is to </p>
<blockquote>
<p>keeping a “memo” dictionary of objects already copied during the current copying pass</p>
</blockquote>
<p>This prevents recursive loops during copying if objects contain reference cycles.</p>
<p>I guess numpy does not need to use that argument because an array normally does not hold recursive references to other Python objects, so it is simply ignored.</p>
</div>
<span class="comment-copy">Ah, nice. So you would consider this lack of mention a documentation bug?</span>
<span class="comment-copy">No, since I don't think you are supposed to call <code>__whatever__</code> functions directly during normal use.</span>
