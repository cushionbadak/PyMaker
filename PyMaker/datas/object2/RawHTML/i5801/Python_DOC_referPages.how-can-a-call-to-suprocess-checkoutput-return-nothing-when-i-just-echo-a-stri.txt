<div class="post-text" itemprop="text">
<p>In python, I try to run some command but I can't get it work, to sum up here is a script that should execute four simple commands via subproscess, store theirs respective outputs and then display them.</p>
<pre><code>#!/usr/bin/python
import subprocess

output_1 = None
output_2 = None
output_3 = None
output_4 = None

print "Start"
try:
    output_1 = subprocess.check_output(["ls", "-al"], shell=True, stderr=subprocess.STDOUT)
    output_2 = subprocess.check_output(["echo", "'Hi'"], shell=True, stderr=subprocess.STDOUT)
    output_3 = subprocess.check_output(["echo", "\"Hi\""], shell=True, stderr=subprocess.STDOUT)
    output_4 = subprocess.check_output(["echo", "Hi"], shell=True, stderr=subprocess.STDOUT)
except subprocess.CalledProcessError as ex:
    print "Command '%s' return exit code %s:\n\n%s" % (ex.cmd, ex.returncode, ex.output)

print "Out 1: '%s'" % output_1
print "Out 2: '%s'" % output_2
print "Out 3: '%s'" % output_3
print "Out 4: '%s'" % output_4
</code></pre>
<p>I do not undestand why there is no 'Hi' in my outputs... Here is the output I get:</p>
<pre><code>Start
Out 1: '
test
undefined10_error.png
undefined20_error.png
undefined35_error.png
undefined40_error.png
'
Out 2: '
'
Out 3: '
'
Out 4: '
'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>By passing the <code>shell=True</code> argument, <a href="https://docs.python.org/3/library/subprocess.html" rel="nofollow noreferrer">you are telling the interpreter to execute the command as a single string</a>. This means that the first argument needs to be a string. If you look at the output of your first command you'll notice that you're not getting the flags <code>am</code>, but just a standard <code>ls</code>.</p>
<p>If you want to use <code>shell=True</code>, pass the argument as a str: </p>
<pre><code>&gt; subprocess.check_output("echo 'Hello World!'", shell=True, stderr=subprocess.STDOUT)
b'Hello World!\n'
</code></pre>
<p>If you're planning on using variables, you'll need to escape them yourself with <a href="https://docs.python.org/3/library/shlex.html#shlex.quote" rel="nofollow noreferrer">shelex.quote</a>. </p>
<p>To use a local variable:</p>
<pre><code>&gt;&gt;&gt; import shlex
&gt;&gt;&gt; local_variable = 'Hi \'world"'
&gt;&gt;&gt; command = 'echo {}'.format(shlex.quote(local_variable))
&gt;&gt;&gt; subprocess.check_output(command,shell=True, stderr=subprocess.STDOUT)
b'Hi \'world"\n'
</code></pre>
</div>
<span class="comment-copy">You specified <code>shell=True</code> but passed a list of args.</span>
<span class="comment-copy">@Blurp Thanks. It works. But could you provide some more info what are the difference between <code>shell=True</code> and <code>shell=False</code>. Even form <a href="https://docs.python.org/2/library/subprocess.html#using-the-subprocess-module" rel="nofollow noreferrer">the actual doc</a> I do not understand well why my example didn't worked.</span>
<span class="comment-copy">Plus, what if I want to give this echo a variable that I know is defined ?</span>
<span class="comment-copy">What about a variable defined in the command line ? Like doing <code>echo  "$MY_VAR"</code> but from python. <code>subprocess.check_output("echo \"$BASE_URL\"", shell=True, stderr=subprocess.STDOUT)</code> return nothing</span>
<span class="comment-copy">I've a variable called <code>SKUNK_IP</code>. I just tried this: <code>&gt;&gt;&gt; subprocess.check_output('echo $SKUNK_IP', shell=True, stderr=subprocess.STDOUT)</code> I received:  <code>b'127.0.0.1\n'</code>. This makes me think your <code>BASE_URL</code> is not an environment variable</span>
<span class="comment-copy">Yes, that's it. Thx a lot for your help</span>
