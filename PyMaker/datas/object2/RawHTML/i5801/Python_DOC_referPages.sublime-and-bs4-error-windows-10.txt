<div class="post-text" itemprop="text">
<p>I have created a virtualenv (i named it scrape), i activated it and i have installed packages and beautifulsoup4. I am trying to make sublime text 3 to work (ie show build results) within a virtualenv. I created a new build system like this:</p>
<pre><code>{
    "cmd": ["C:/Users//User1/Desktop/scrape/Scripts/python.exe", "-u","$file"],
    "file_regex": "^[ ]*File \"(...*?)\", line ([0-9]*)",
    "selector": "source.python"
}
</code></pre>
<p>Then i run this code (i know that Betfair has an API,but this is not the point here):</p>
<pre><code>import requests
from bs4 import BeautifulSoup

url = requests.get("https://www.betfair.com/")

print(url.status_code)

bs_4 = BeautifulSoup(url.text, "html.parser")

print(bs_4.prettify())
</code></pre>
<p>When i run the above with Powershell and virualenv activated, i am getting "200" and then all the html data (ie as ti is supposed to be). When i run inside sublime text, i am only getting "200" inside the build results panel, with no any html data. The fact that i am getting "200" means that my build system works ok, but why aren't the html results shown? Note that i am not getting any error.</p>
<p>Now, if i change the url from <a href="https://betfair.com" rel="nofollow noreferrer">https://betfair.com</a> to  <a href="https://ubet.com.cy/sports" rel="nofollow noreferrer">https://ubet.com.cy/sports</a> (that contains some Greek characters), everything works ok if i do it in Powershell (ie i am getting "200" plus the html data.</p>
<pre><code>import requests
from bs4 import BeautifulSoup

url = requests.get("https://ubet.com.cy/sports")

print(url.status_code)

bs_4 = BeautifulSoup(url.text, "html.parser")

print(bs_4.prettify())
</code></pre>
<p>If however i do it in sublime text, i am getting the "200" plus the following error:</p>
<pre><code>File "C:\Users\User1\Desktop\scrape\lib\encodings\cp1252.py", line 19, in encode
    return codecs.charmap_encode(input,self.errors,encoding_table)[0]
UnicodeEncodeError: 'charmap' codec can't encode character '\x93' in position 6074: character maps to &lt;undefined&gt;
</code></pre>
<p>This is line 19:</p>
<pre><code>17class IncrementalEncoder(codecs.IncrementalEncoder):
18    def encode(self, input, final=False):
19        return codecs.charmap_encode(input,self.errors,encoding_table)[0]
</code></pre>
<p>In general, what i am looking for is a solution to have sublime text to work like if i run python inside Powershell (as it looks that everytime i will be coming across a new error). Is there something you can help me with.</p>
<p>Many thanks.</p>
</div>
<div class="post-text" itemprop="text">
<p>This is indeed a Sublime Text specific problem. Sublime Text has this <a href="http://docs.sublimetext.info/en/latest/reference/build_systems/exec.html#exec-command-arguments" rel="nofollow noreferrer"><code>env</code> dictionary</a> that is going to update environment variables before executing Python.</p>
<blockquote>
<p>Dictionary of environment variables to be merged with the current process’ before passing them to cmd.</p>
<p>Use this option, for example, to add or modify environment variables without modifying your system’s settings.</p>
</blockquote>
<p>Go to Tools -&gt; Build System -&gt; New Build System and set the <a href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONIOENCODING" rel="nofollow noreferrer"><code>PYTHONIOENCODING</code></a> to <code>utf8</code>:</p>
<pre><code>"env": {"PYTHONIOENCODING": "utf8"},
</code></pre>
<p>See more at:</p>
<ul>
<li><a href="https://stackoverflow.com/questions/39576308/printing-utf-8-in-python-3-using-sublime-text-3">printing UTF-8 in Python 3 using Sublime Text 3</a></li>
<li><a href="https://stackoverflow.com/questions/42648808/unicode-encode-error-in-sublime-text-3-console">Unicode Encode Error in Sublime Text 3 console</a></li>
</ul>
</div>
