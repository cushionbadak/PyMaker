<div class="post-text" itemprop="text">
<p>I'm having trouble getting a multi-line sql query to format correctly using replacement values (%s). Any help in getting the function to iterate through a list of <code>planName</code>, and <code>planData</code> would be helpful!</p>
<pre><code># importing the libraries
import numpy as np
import pandas as pd
from sqlalchemy import create_engine

#creating the sql engine
engine = create_engine('insert engine creds here')

# creating the plan and plan_data dictionary
dict = {'plan1': 0, 'plan2':, 1}

#creating the function
def plan_usage(planName, planData):
    query = pd.read_sql_query(r'''
        select *
        from blah 
        where (planName = %s and plan_data = %s)''', engine)
</code></pre>
<p>My goal would be to have the code run the query for <code>plan1</code>, save the results to a dataframe, then run the query for <code>plan2</code> and save the results to  another dataframe.</p>
</div>
<div class="post-text" itemprop="text">
<p>Haven't tried myself but maybe you should use <a href="https://docs.python.org/3/whatsnew/3.6.html#pep-498-formatted-string-literals" rel="nofollow noreferrer">f strings</a></p>
<pre><code>def plan_usage(planName, planData):
    query = pd.read_sql_query(fr'''
        select *
        from blah 
        where (planName = {planName} and plan_data = {planData})''', engine)
</code></pre>
</div>
<span class="comment-copy"><code>%</code> formatting doesn't work with triple-quoted strings</span>
<span class="comment-copy">@rottencandy It does actually. But those are DB-API placeholders and the %-operator should not be used here any way. Instead params should be passed as a sequence to <a href="https://pandas.pydata.org/pandas-docs/version/0.21/generated/pandas.read_sql_query.html" rel="nofollow noreferrer"><code>pandas.read_sql_query()</code></a> using the <code>params=</code> keyword argument.</span>
<span class="comment-copy">Related <a href="https://stackoverflow.com/questions/24408557/pandas-read-sql-with-parameters" title="pandas read sql with parameters">stackoverflow.com/questions/24408557/â€¦</a></span>
<span class="comment-copy">String formatting values to SQL queries is a terrible practice.</span>
