<div class="post-text" itemprop="text">
<p>How would one pass an image from PIL to cv2 without having to save and reload it?</p>
<pre><code>import cv2
import numpy as np
from PIL import Image

img = Image.open('path/to/pic.jpg')
#modify picture using PIL
img.save('path/to/pic.jpg')
img = cv2.imread("pic.jpg")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use a <a href="https://docs.python.org/3/library/tempfile.html" rel="nofollow noreferrer">tempfile</a></p>
<p>Untested code:</p>
<pre><code>temp_file = TemporaryFile()
with open('path/to/pic.jpg', 'wb') as f:
   temp_file.write(f)
   temp_file.seek(0)

pil_img = Image.open(temp_file)
cv_img = cv2.imread(temp_file)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can access the <strong>bytes</strong> and construct your numpy array (cv2 is internally using numpy too to store their data).</p>
<pre><code>def imageToNumpy():
    with Image.open('dark.jpg') as img:         
        nparray = np.fromstring(img.tobytes(), dtype=np.uint8)
        nparray = nparray.reshape((img.size[1], img.size[0], img.layers))  
    return nparray


cv2.imwrite("testme.png", imageToNumpy() )
</code></pre>
</div>
