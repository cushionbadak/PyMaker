<div class="post-text" itemprop="text">
<p>I am trying to write a piece of code that will recursively iterate through the subdirectories of a specific directory and stop only when reaching files with a '.nii' extension, appending these files to a list called images - a form of a breadth first search. Whenever I run this code, however, I keep receiving [Errno 20] Not a directory: '/Volumes/ARLO/ADNI/.DS_Store'</p>
<p>*/Volumes/ARLO/ADNI is the folder I wish to traverse through</p>
<p>*I am doing this in Mac using the Spyder IDE from Anaconda because it is the only way I can use the numpy and nibabel libraries, which will become important later</p>
<p>*I have already checked that this folder directly contains only other folders and not files</p>
<pre><code>#preprocessing all the MCIc files
import os
#import nibabel as nib
#import numpy as np

def pwd():
    cmd = 'pwd'
    os.system(cmd)
    print(os.getcwd())

#Part 1
os.chdir('/Volumes/ARLO')
images = [] #creating an empty list to store MRI images
os.chdir('/Volumes/ARLO/ADNI')
list_sample = [] #just an empty list for an earlier version of 
#the program

#Part 2
#function to recursively iterate through folder of raw MRI 
#images and extract them into a list
#breadth first search
def extract(dir):
    #dir = dir.replace('.DS_Store', '')
    lyst = os.listdir(dir) #DS issue
    for item in lyst:
        if 'nii' not in item: #if item is not a .nii file, if 
#item is another folder
            newpath = dir + '/' + item
            #os.chdir(newpath) #DS issue
            extract(newpath)
        else: #if item is the desired file type, append it to 
#the list images
            images.append(item)

#Part 3           
adni = os.getcwd() #big folder I want to traverse
#print(adni) #adni is a string containing the path to the ADNI 
#folder w/ all the images
#print(os.listdir(adni)) this also works, prints the actual list
"""adni = adni + '/' + '005_S_0222' 
os.chdir(adni)
print(os.listdir(adni))""" #one iteration of the recursion, 
#works
extract(adni)
print(images)      
</code></pre>
<p>With every iteration, I wish to traverse further into the nested folders by appending the folder name to the growing path, and part 3 of the code works, i.e. I know that a single iteration works. Why does <code>os</code> keep adding the '.DS_Store' part to my directories in the <code>extract()</code> function? How can I correct my code so that the breadth first traversal can work? This folder contains hundreds of MRI images, I cannot do it without automation. </p>
<p>Thank you. </p>
</div>
<div class="post-text" itemprop="text">
<p>The <a href="https://en.wikipedia.org/wiki/.DS_Store" rel="nofollow noreferrer"><code>.DS_Store</code></a> files are not being created by the <code>os</code> module, but by the Finder (or, I think, sometimes Spotlight). They're where macOS stores things like the view options and icon layout for each directory on your system.</p>
<p>And they've probably always been there. The reason you didn't see them when you looked is that files that start with a <code>.</code> are "hidden by convention" on Unix, including macOS. Finder won't show them unless you ask it to show hidden files; <code>ls</code> won't show them unless you pass the <code>-a</code> flag; etc.</p>
<p>So, that's your core problem:</p>
<blockquote>
<p>I have already checked that this folder directly contains only other folders and not files</p>
</blockquote>
<p>â€¦ is wrong. The folder <em>does</em> contain at least one regular file; <code>.DS_Store</code>.</p>
<p>So, what can you do about that?</p>
<p>You could add special handling for <code>.DS_Store</code>. </p>
<p>But a better solution is probably to just check each file to see if it's a file or directory, by calling <a href="https://docs.python.org/3/library/os.path.html#os.path.isdir" rel="nofollow noreferrer"><code>os.path.isdir</code></a> on it.</p>
<p>Or, even better, use <a href="https://docs.python.org/3/library/os.html#os.scandir" rel="nofollow noreferrer"><code>os.scandir</code></a> instead of <code>listdir</code>, which gives you entries with more information than just the name, so you don't need to make extra calls like <code>isdir</code>.</p>
<p>Or, best of all, just throw out this code and use <a href="https://docs.python.org/3/library/os.html#os.walk" rel="nofollow noreferrer"><code>os.walk</code></a> to recursively visit every file in every directory underneath your top-level directory.</p>
</div>
<span class="comment-copy">"I have already checked that this folder directly contains only other folders and not files." How did you check? Files starting with a <code>.</code>, like <code>.DS_Store</code>, are not shown by <code>ls</code> unless you pass the <code>-a</code> flag, and are not shown in Finder unless you enable hidden files. Also, the <code>os</code> module doesn't create these files, Finder does (or sometimes Spotlight, I think).</span>
<span class="comment-copy">Also, why are you trying to build the equivalent of <code>os.walk</code> yourself (but more complicated, and handling fewer edge cases) instead of just using <code>os.walk</code>?</span>
<span class="comment-copy">@abarnert I was in fact using Finder to see these files. Thank you for letting me know about hidden files. Additionally, I only just familiarized myself with the basics of the <code>os</code> module and did not know about <code>os.walk</code></span>
<span class="comment-copy">Thank you very much for identifying the problem for me. I did try <code>os.walk</code> but that only returns the isolated filenames, and if I need to extract the MRI images, I need the entire file paths of all these images. Do you have any tips as to how I can get these?</span>
<span class="comment-copy">@arnavlohe15 The short version is: <code>pathname = os.path.join(root, filename)</code>, but just look at the docs for <code>os.walk</code>; all of the examples show how to do it.</span>
