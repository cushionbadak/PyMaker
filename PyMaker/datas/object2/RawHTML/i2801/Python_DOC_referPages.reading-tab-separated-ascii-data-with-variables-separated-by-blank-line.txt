<div class="post-text" itemprop="text">
<p>I have an annoying dataset I need to modify with python that is in ASCII, with a 6 line header and then a bunch of lines of data (2 million lines). The format is like this:</p>
<pre><code>2014     2     5  1200     0    29   349   277
2  32463.0020  32463.0020      1.0000   -145.5000      0.0000      0.0000
50.0000   -107.0000
1000   975   950   925   900   875   850   825   800   775   750   725
700   650   600   550   500   450   400   350   300   275   250   225
200   175   150   125   100
-6.63661    -6.63661    -6.76161    -6.76161    -6.83974    -6.55849    -6.55849    -6.12099
-5.93349    -5.90224    -5.73036    -5.55849    -5.71474    -5.60536    -5.71474    -5.71474
-5.76161    -5.76161    -5.83974    -5.83974    -5.83974    -5.73036    -5.60536    -5.51161
-5.32411    -5.35536    -5.19911    -5.18349    -4.87099    -4.57411    -4.23036    -3.74599
-3.76161    -3.76161    -3.91786    -3.91786    -4.30849    -4.43349    -5.10536    -6.37099

-5.79286    -5.91786    -6.32/411    -6.82411    -6.82411    -6.71474    -6.58974    -6.58974
-6.48036    -6.48036    -6.30849    -6.02724    -6.10536    -5.21474    -5.01161    -4.48036
-4.60536    -4.51161    -4.44911    -4.69911    -4.77724    -4.99599    -5.43349    -5.43349
-5.41786    -5.27724    -5.27724    -6.01161    -5.43349    -6.15224    -5.44911    -4.69911
-3.71474    -2.40224    -3.48036    -4.12099    -4.69911    -5.16786    -6.08974    -4.74599
</code></pre>
<p>The first 6 lines are the header info, then there's a huge block of values for one variable, then a line break, and then the values for the next variable.</p>
<p>I need to modify one of the variables in the data file, but not the other (the modification is as simple as adding an integer to each value), but I'm struggling trying to figure out how to read in this file with each block of data as one array or list of values in python. Most of the resources I've found online assumes each column is a separate variable. Is there a quick and easy way to do this in python? I figured I'd check here first before doing things the hard way myself.</p>
<p>Thanks! </p>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/tutorial/classes.html#generators" rel="nofollow noreferrer">Generators</a> are often a good solution for managing complicated iteration.</p>
<p>This generator reads the data file, skips the first six header lines, then outputs a list of the values in each block, assuming that the blocks are separated by empty lines.</p>
<p>This generator outputs the values as strings, as it's not clear how <code>-6.32/411</code> ought to be handled; it's not difficult modify the generator to produce the types that you want.</p>
<pre><code>def extract(path_to_file):
    with open(path_to_file) as f:
        values = []
        for idx, line in enumerate(f):
            if idx &lt; 6:
                # Ignore header lines
                continue
            if line.strip():
                # Add the values in this line to the current
                # values list.
                values.extend(line.split())
            else:
                # Blank line, so output values and
                # clear the list.
                yield values
                del values[:]
        # Yield the final set of values, assuming
        # the last line of the file is not blank.
        yield values


values = extract('data.dat')
for item in values:
    print(item)
</code></pre>
<p>Output:</p>
<pre><code>['-6.63661', '-6.63661', '-6.76161', '-6.76161', '-6.83974', '-6.55849', '-6.55849', '-6.12099', '-5.93349', '-5.90224', '-5.73036', '-5.55849', '-5.71474', '-5.60536', '-5.71474', '-5.71474', '-5.76161', '-5.76161', '-5.83974', '-5.83974', '-5.83974', '-5.73036', '-5.60536', '-5.51161', '-5.32411', '-5.35536', '-5.19911', '-5.18349', '-4.87099', '-4.57411', '-4.23036', '-3.74599', '-3.76161', '-3.76161', '-3.91786', '-3.91786', '-4.30849', '-4.43349', '-5.10536', '-6.37099']
['-5.79286', '-5.91786', '-6.32/411', '-6.82411', '-6.82411', '-6.71474', '-6.58974', '-6.58974', '-6.48036', '-6.48036', '-6.30849', '-6.02724', '-6.10536', '-5.21474', '-5.01161', '-4.48036', '-4.60536', '-4.51161', '-4.44911', '-4.69911', '-4.77724', '-4.99599', '-5.43349', '-5.43349', '-5.41786', '-5.27724', '-5.27724', '-6.01161', '-5.43349', '-6.15224', '-5.44911', '-4.69911', '-3.71474', '-2.40224', '-3.48036', '-4.12099', '-4.69911', '-5.16786', '-6.08974', '-4.74599']
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>A pure Python method that assumes the data file is .txt: </p>
<pre><code>with open ("data.txt","r") as file_obj:
    data = file_obj.read().splitlines(True)

    variable_array = []
    for data_line in range (6, 11):
        data_line = data[data_line].split("    ")
        for item in data_line:
            item = item.strip()
            variable_array.append (item)

print (variable_array)
</code></pre>
<p>This results in an array of the <strong>first block only</strong>, with each variable being its own element:</p>
<pre><code>['-6.63661', '-6.63661', '-6.76161', '-6.76161', '-6.83974', '-6.55849', '-6.55849', 
'-6.12099', '-5.93349', '-5.90224', '-5.73036', '-5.55849', '-5.71474', '-5.60536', 
'-5.71474', '-5.71474', '-5.76161', '-5.76161', '-5.83974', '-5.83974', '-5.83974', 
'-5.73036', '-5.60536', '-5.51161', '-5.32411', '-5.35536', '-5.19911', '-5.18349', 
'-4.87099', '-4.57411', '-4.23036', '-3.74599', '-3.76161', '-3.76161', '-3.91786', 
'-3.91786', '-4.30849', '-4.43349', '-5.10536', '-6.37099']
</code></pre>
<p>The line:</p>
<pre><code>for data_line in range (6, 11):
</code></pre>
<p>uses 6 and 11 to define the range of lines in which the first block occurs - this would be fairly easy to alter if the pattern of data blocks is entirely continuous all the way until the end of the file. You could read a block, alter the block, read the next block, alter that and so on and so forth.</p>
<p>There are far more efficient methods (see aydow's answer), however this method is pure python and has no external dependencies at all. It's a matter of preference if you're not too concerned about efficiency. </p>
</div>
<span class="comment-copy">This looks like exactly what I need. Thanks!</span>
<span class="comment-copy">Is there a away to change <code>for data_line in range (6,11):</code> to be more generic, and to look for an empty line? There are millions of lines in the data file and I'm not sure where the "breaks" are between blocks.</span>
