<div class="post-text" itemprop="text">
<p>I want to delete top and bottom lines in multiple csv files in a folder at once. Then delete the second line after that. My code works well with one file but i have 1000s of files to go through and i cannot specify each file name. How can i modify this to make it work?</p>
<pre><code>#Remove top and bottom lines from all files 
lines = open('My/local/Drive/*.csv').readlines()
open('My/local/Drive/*.csv', 'w').writelines(lines[2:-4]);

#Remove 2nd line from all files
lines = []
with open('My/local/Drive/*.csv', 'r') as f:
    lines = f.readlines()
with open('My/local/Drive/*.csv', 'w') as f:
    f.writelines(lines[:1] + lines[2:]);
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><strong><em>&gt;&gt;&gt;TAKE A BACKUP OF YOUR FILES BEFORE RUNNING THIS&lt;&lt;&lt;</em></strong></p>
<p>You can use the following code, where you define path following your needs.</p>
<pre><code>import glob

path='.'
for filename in glob.iglob(path+'/*.csv'):
  with open(filename, 'r') as f:
    lines = f.read().split("\n")
    f.close()
    if len(lines) &gt;= 7:
      lines = lines[2:-5]
      lines = lines[:1] + lines[2:]
      o = open(filename, 'w')
      for line in lines:
        o.write(line+'\n')
      o.close()
</code></pre>
<p><strong>in my target folder (2 csv files):</strong></p>
<pre><code>$ ls *.csv
input1.csv  input2.csv
</code></pre>
<p><strong>file1:</strong></p>
<pre><code>to delete1
to delete2
ID;TAG;GROUP
todelete;B00;AB0
niub12617500;B01;AB4
niub16371500;B01;AB3
todelete;B00;AB0
todelete;B00;AB0
todelete;B00;AB0
todelete;B00;AB0
</code></pre>
<p><strong>file2:</strong></p>
<pre><code>to delete1
to delete2
ID;TAG;GROUP
todelete;B00;AB0
niub12677500;B00;AB2
niub16377500;B01;AB0
todelete;B00;AB0
todelete;B00;AB0
todelete;B00;AB0
</code></pre>
<p>After execution:</p>
<pre><code>$ cat input1.csv
ID;TAG;GROUP
niub12617500;B01;AB4
niub16371500;B01;AB3
$ cat input2.csv
ID;TAG;GROUP
niub12677500;B00;AB2
niub16377500;B01;AB0
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Well, you can try and list all files in a directory (having a folder with all your <em>.csv</em> files is a great option here!).
This will list you ALL files:</p>
<pre><code>import os
for filename in os.listdir(os.getcwd()):
</code></pre>
<p>Or you can just list the <em>.csv</em> files!</p>
<pre><code>import glob
for filename in glob.glob('*.txt'):
</code></pre>
<p>Having that, you can do whatever you need to delete those files! </p>
<p>Check <a href="https://stackoverflow.com/questions/18262293/how-to-open-every-file-in-a-folder">this</a> out if you need more insight on listing and operating with that! </p>
<p>Dividing your problem in small problems, everything has an easier solution: <strong>how to open every file in a folder</strong></p>
</div>
<span class="comment-copy">Are you working on a unix env?</span>
<span class="comment-copy">Windows environment</span>
<span class="comment-copy">could you specify exactly what are the lines you want to remove/keep?</span>
<span class="comment-copy">I am removing the first two lines before the header, the line after the header and the last four lines in the dataset.</span>
<span class="comment-copy">if it were linux I would have solved it in 1 command line, anyway I have answered ;-)</span>
<span class="comment-copy">This works. Thank you.</span>
<span class="comment-copy">@enufeffizy: if you are satisfied by my answer, can you vote up and accept? Thank you</span>
<span class="comment-copy">@enufeffizy  If we have answered your question, could you please accept an answer/upvote as detailed in: <a href="https://stackoverflow.com/help/someone-answers">stackoverflow.com/help/someone-answers</a></span>
