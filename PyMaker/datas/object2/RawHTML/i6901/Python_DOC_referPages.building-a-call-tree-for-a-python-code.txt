<div class="post-text" itemprop="text">
<p>I've been given a Python code, together with the  modules it imports. I would like to build a tree indicating which function calls what other functions. How can I do that?</p>
</div>
<div class="post-text" itemprop="text">
<p>you can use the <a href="https://docs.python.org/3/library/ast.html" rel="nofollow noreferrer"><code>ast</code></a> (abstract syntax tree) module from the python standard library</p>
<pre><code># foo.py
def func(x):
    print('hello')
</code></pre>
<p>parsing the file using <code>ast.parse</code>:</p>
<pre><code>import ast
tree = ast.parse(open('foo.py').read())
print(ast.dump(tree))  # dumps the whole tree

# get the function from the tree body (i.e. from the file's content)
func = tree.body[0]

# get the function argument names
arguments = [a.arg for a in func.args.args]
print('the functions is: %s(%s)' % (func.name, ', '.join(arguments)))
</code></pre>
<p>outputs:</p>
<pre><code>"Module(body=[FunctionDef(name='func', args=arguments(args=[arg(arg='x', annotation=None)], vararg=None, kwonlyargs=[], kw_defaults=[], kwarg=None, defaults=[]), body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Str(s='hello')], keywords=[]))], decorator_list=[], returns=None)])"

the functions is: func(x)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You should begin from the main function of the program and at the first layer link all functions that are called from the main this would provide a start point and then you can link all the functions below it.</p>
</div>
<span class="comment-copy">Why the close vote? Months ago I asked a similar question for the <code>r</code> language and it was deemed fit for this site: <a href="https://stackoverflow.com/questions/44198599/build-a-file-diagram-for-an-r-code" title="build a file diagram for an r code">stackoverflow.com/questions/44198599/…</a></span>
<span class="comment-copy">Uh, the close votes actually :) I guess I'll have to ask on SO Meta</span>
<span class="comment-copy">Close voters believe that your question is too broad (is it not?). You've also said that you're "looking for a module or tool which can do this automatically", which means your question is also <a href="http://stackoverflow.com/help/on-topic">off-topic</a> for Stack Overflow.</span>
<span class="comment-copy">@vaultah you're wrong on both points. Questions extremely similar to this one have been asked on Stack Overflow, received many answers, and some are also highly voted: <a href="https://stackoverflow.com/questions/4544784/how-can-you-get-the-call-tree-with-python-profilers" title="how can you get the call tree with python profilers">stackoverflow.com/questions/4544784/…</a> <a href="https://stackoverflow.com/questions/27269604/generate-function-calls-tree-from-multiple-python-files" title="generate function calls tree from multiple python files">stackoverflow.com/questions/27269604/…</a> <a href="https://stackoverflow.com/questions/13963321/build-a-call-graph-in-python-including-modules-and-functions" title="build a call graph in python including modules and functions">stackoverflow.com/questions/13963321/…</a> so actually the most meaningful reason to close my question is that's a duplicate :-)</span>
<span class="comment-copy">That does not make me wrong. Questions like yours don't fit the current guidelines of Stack Overflow, but they were maybe acceptable several years ago. Also, the number of answers and the question score is irrelevant when assessing whether it is on-topic. Ask on Meta SO, if you're so inclined.</span>
<span class="comment-copy">Looks interesting! I'm not sure how to use it, though. If tomorrow I modify my question adding a minimal example, could you show me how to use <code>ast</code> to build the corresponding call tree?</span>
<span class="comment-copy">Hmm, the output seems too verbose to be of any help. It seems to include also all the statements inside each function, not just the calls. On a code thousand lines long, with numerous dependencies,  I don't think it will generate usable output. Is it possible to limit the output to the function calls? Tomorrow I'll add a minimal example, with input and desired output.</span>
<span class="comment-copy">the <code>ast.dump(tree)</code> only prints nicely the tree for debugging proposes. you can access the tree members and attributes. I added example of getting the function name and arguments</span>
