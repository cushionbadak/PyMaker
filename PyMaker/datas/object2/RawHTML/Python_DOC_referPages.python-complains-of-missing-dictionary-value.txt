<div class="post-text" itemprop="text">
<p>I built a script using Python that lists all aws instances in an account.</p>
<p>The script works, except when it encounters an instance that doesn't have any tags.</p>
<p>I tried to account for that using these lines:</p>
<pre><code># Test for the existance of tags
if instance['Tags']:
    tags = instance['Tags']
    try:
        for tag in tags:
            if tag["Key"] == "Name":
                name = tag["Value"]
    except ValueError:
        print("No tags on instance ",instance["InstanceId"])
</code></pre>
<p>And yet the error persists:</p>
<pre><code>Traceback (most recent call last):
  File ".\aws_ec2_list_instances.py", line 180, in &lt;module&gt;
    loop_regions()
  File ".\aws_ec2_list_instances.py", line 90, in loop_regions
    if instance['Tags']:
KeyError: 'Tags'
</code></pre>
<p>If I comment out all the lines pertaining to Tags, and set a static value for 'name' the script works perfecty! However I do need to grab the name tag.</p>
<p>This is the json representation of an instance: <a href="https://pastebin.com/Vym3tZTj" rel="nofollow noreferrer">ec2_instance_json</a></p>
<p>What am I doing wrong? How can I correctly create an exception if the Tags don't exist?</p>
</div>
<div class="post-text" itemprop="text">
<p>In a Boolean setting, <code>instance['Tags']</code> is true if the <em>value</em> is true, not if the key exists. You want <code>if 'Tags' in instance:</code> instead.</p>
</div>
<span class="comment-copy">That was it. Thanks!</span>
