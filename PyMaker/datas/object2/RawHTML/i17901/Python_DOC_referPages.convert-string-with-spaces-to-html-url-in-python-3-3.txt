<div class="post-text" itemprop="text">
<p>I'm trying to convert a YQL string with spaces to html code. </p>
<p>Here's the YQL string I'm using:</p>
<pre><code>select * from yahoo.finance.historicaldata where symbol in ("MSFT", "AAPL") and startDate = "2010-10-01" and endDate = "2010-10-05"
</code></pre>
<p>Here's the url code that needs to come out:</p>
<pre><code>http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.historicaldata%20where%20symbol%20in%20(%22MSFT%22%2C%20%22AAPL%22)%20and%20startDate%20%3D%20%222010-10-01%22%20and%20endDate%20%3D%20%222010-10-05%22&amp;format=json&amp;diagnostics=true&amp;env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&amp;callback=
</code></pre>
<p>I've been trying to do this with <em>urllib.parse.urlencode</em> but have not had any luck.</p>
<p>I can get up to "<a href="http://query.yahooapis.com/v1/public/yql" rel="nofollow">http://query.yahooapis.com/v1/public/yql</a>?" but afterwards it starts to break down. Is there a pythonesque way to do this that I'm just missing?</p>
<p>Thank you!</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>import urllib

url_start = "http://query.yahooapis.com/v1/public/yql?q="
url_end = "&amp;format=json&amp;diagnostics=true&amp;env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&amp;callback="
</code></pre>
<p>you can encode the string as a dict like this:</p>
<pre><code>d = {'select * from yahoo.finance.historicaldata where symbol in ("MSFT", "AAPL") and startDate':'"2010-10-01"', 'and endDate':'"2010-10-05"'}

encode_url = urllib.urlencode(d)

#output is:
'select+%2A+from+yahoo.finance.historicaldata+where+symbol+in+%28%22MSFT%22%2C+%22AAPL%22%29+and+startDate=%222010-10-01%22&amp;and+endDate=%222010-10-05%22'

url = url_start + encode_url + url_end
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>&gt;&gt;&gt; import urllib
&gt;&gt;&gt; urllib.quote('http://www.example.com/déjà-vu/example two.html')
'http%3A//www.example.com/d%C3%A9j%C3%A0-vu/example%20two.html'
</code></pre>
</div>
<span class="comment-copy"><a href="http://docs.python.org/3/library/urllib.html" rel="nofollow noreferrer"><code>urllib</code></a> is a package with nothing in it in Python 3.x. You probably want <a href="http://docs.python.org/3/library/urllib.parse.html" rel="nofollow noreferrer"><code>urllib.parse</code></a>.</span>
<span class="comment-copy">I don't think this works. I tried combining your three strings and the page gives an error. The URL I provide gives actual data.</span>
<span class="comment-copy">I think abarnet is right. It seems urllib was split into parts for python3.x, and I wasn't aware. However, if urllib.parse has a urlencode method, that should do the same job, if applied like above.. quote_plus method also might work with urllib.parse, I would try that.</span>
<span class="comment-copy">As I mentioned above. If I copy your three string outputs into one large string, that still doesn't work, so I don't think it's a urllib.parse issue.</span>
