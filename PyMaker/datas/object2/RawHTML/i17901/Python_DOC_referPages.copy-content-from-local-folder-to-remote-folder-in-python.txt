<div class="post-text" itemprop="text">
<p>I am trying to copy files from  a local folder to a remote windows share using python. So the main requirement is to move files from source folder (which keeps changing) to a Remote Share:</p>
<p>Not sure what I am doing wrong but below is what I have tried to so far:</p>
<pre><code># Move the archive file to DVD Burner Box
 destPath = '\\\\10.10.10.10\\DestFolder\\'
 destFolder = destPath + ('%s_%s\\') %(id1,id2)
 srcArchFolderPath = '.\\prepared\\%s_%s\\' %(id1,id2)
 srcArchFiles = os.listdir(srcArchFolderPath)

try:
    os.makedirs(destFolder)
except OSError:
    pass

shutil.copytree (srcArchFiles,destFolder,ignore=None)
</code></pre>
<p>The sourceFolderPath keeps changing on every run with different input. </p>
<p>Ex: it can be .\prepared\1_2 or .\prepared\2_3 which will keep changing on every script run. </p>
<p>If I print srcArchFiles it shows list of the folders which exists in  srcArchFolderPath succesfully. Also os.makedirs(destFolder) creates a folder succesfully on the remote share location. But the files copy is failing and not sure why it's failing, I belive I am not doing something right with shutil. </p>
<p>Following is the error I am seeing:
File "C:\Python26\lib\shutil.py", line 140, in copytree
names = os.listdir(src)
TypeError: coercing to Unicode: need string or buffer, list found</p>
<p>Any help in correcting this is much appreciated. </p>
</div>
<div class="post-text" itemprop="text">
<p><code>srcArchFiles</code> is a list of folders. <a href="http://docs.python.org/3/library/shutil.html#shutil.copytree" rel="nofollow"><code>shutil.copytree</code></a> needs one folder as the first parameter.</p>
<p>You have to use a loop to copy each folder.</p>
<pre><code>for foldername in srcArchFiles:
    shutil.copytree (foldername, destFolder, ignore=None)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I've found a good solution here: <a href="http://code.activestate.com/recipes/577945-execute-remote-commands-on-windows-like-psexec/" rel="nofollow">Execute remote commands on windows like psexec (Python recipe)</a></p>
</div>
<span class="comment-copy">could you choose a protocol like scp to transfer and use a library like paramiko_scp?</span>
<span class="comment-copy">Thanks for the input @Matthias. I tried making the change by appending the     for foldername in srcArchFiles: How, ever it ends up giving below error: WindowsError: [Error 183] Cannot create a file when that file already exists: '\ \\\10.10.10.10\\DestFolder\\id1_id2\\' I have also commented out the os.mkdirs part so that the folder doesn't get created.</span>
<span class="comment-copy">I think I figured it out. I added        if os.path.exists(destFolder)         shutil.rmtree(destFolder)  Thanks again for showing right direction. +1</span>
