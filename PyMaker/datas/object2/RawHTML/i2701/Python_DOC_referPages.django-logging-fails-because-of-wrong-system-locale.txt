<div class="post-text" itemprop="text">
<p>I have a Django app, which fails to log with the error <code>UnicodeEncodeError: 'ascii' codec can't encode character</code>.  The problem is that the system locale is the CentOS default locale, which is ASCII. The admins don't want to change the system-wide locale on their servers, saying that the apps should be able to run in a clean environment. </p>
<p>We circumvented the problem for the Django apps themselves by adding this to the uwsgi.ini:</p>
<pre><code>env = LANG=en_US.UTF-8
env = LANGUAGE=en_US.en
env = LC_ALL=en_US.UTF-8
</code></pre>
<p>However, uwsgi.ini has no effect on the code run as a django management command, and we have a lot of work done in those. </p>
<p>What could be the best way to fix that?</p>
<p><strong>UPD</strong>: We also tried setting the locale in the <code>settings.py</code> file, but that didn't help.</p>
</div>
<div class="post-text" itemprop="text">
<p>Try setting the default encoding in the <code>sitecustomize.py</code> module inside the <code>site-packages</code> folder of your Python distribution. This module is <a href="https://docs.python.org/3/library/site.html" rel="nofollow noreferrer">loaded by Python</a> when it starts up and arbitrary site-specific customizations can be placed in here.</p>
<p><strong>sitecustomize.py</strong></p>
<pre><code>import sys
sys.setdefaultencoding('UTF8')
</code></pre>
<p>You may need to create the module if it doesn't already exist.</p>
</div>
