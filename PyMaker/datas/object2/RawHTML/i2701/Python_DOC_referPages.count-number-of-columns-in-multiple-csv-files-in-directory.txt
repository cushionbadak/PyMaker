<div class="post-text" itemprop="text">
<p>I have a directory that contains a large number of CSV files (more than 1000). I am using python pandas library to count the number of columns in each CSV file.</p>
<p>But the problem is that the separator used in some of CSV file is not  only<code>"," but "|" and ";"</code></p>
<p>How to tackle this problem:</p>
<pre><code>import pandas as pd
import csv
import os
from collections import OrderedDict

path="C:\\Users\\Username\\Documents\\Sample_Data_August10\\outbound"

files=os.listdir(path)

col_count_dict=OrderedDict() 
for file in files:
    df=pd.read_csv(os.path.join(path,file),error_bad_lines=False,sep=",|;|\|",engine='python')

    col_count_dict[file]=len(df.columns)
</code></pre>
<p>I am storing it as a dictionary.</p>
<p>I am getting an error like: </p>
<p><code>Error could possibly be due to quotes being ignored when a multi-char delimiter is used</code></p>
<p>I have used <code>sep=None</code>, but that didn't work.</p>
<p><b> Edit </b> :<br/>
<strong>One of the csv is like this</strong> :
<code>Number|CommentText|CreationDate|Detail|EventDate|ProfileLocale_ISO|Event_Number|Message_Number|ProfileInformation_Number|Substitute_UserNo|User_UserNo
</code>
<br/>
<strong>Second one is like:</strong>
<code>Number,Description</code></p>
<p>I can't reveal the data. I have just given the column name as the data is sensitive. </p>
<h3>Update</h3>
<p>After a little bit of tweaking and using print status to figure out using the code of andrey-portnoy, I came to know that csv sniffer was identifying the delimiter for "|" as "e" so using an if statement I changed it back to "|". Now it is giving me correct output.<br/>
Also in place of <code>read()</code> , I used <code>readline()</code> . in following line of code in Andrey's answer : <code>dialect = csv.Sniffer().sniff(csvfile.read(1024))</code>
<br/>
But the problem remains unsolved. I was able to figure out this after a lot of inspection but every time I may not be correct to guess and this can lead to error. 
<br/> 
Any help will be awaited.</p>
</div>
<div class="post-text" itemprop="text">
<p>By specifying the separator as <code>sep=",|;|\|"</code>, you make that whole string a separator. </p>
<p>Instead, you want to use the <a href="https://docs.python.org/3/library/csv.html#csv.Sniffer" rel="nofollow noreferrer">Sniffer</a> from the <code>csv</code> module to detect the CSV dialect used in each file, in particular the delimiter.</p>
<p>For example, for a single file <code>example.csv</code>:</p>
<pre><code>import csv
with open('example.csv', newline='') as csvfile:
    dialect = csv.Sniffer().sniff(csvfile.read(1024))
sep = dialect.delimiter

df = pd.read_csv('example.csv', sep=sep)
</code></pre>
<p>Don't enable the Python engine by default, as it is much slower.</p>
</div>
<span class="comment-copy">Hey @Atif. Have you tried running this without using  sep= At all? Pandas does a pretty good job of working out the delimiter for you. So... “df=pd.read_csv(os.path.join(path,file),error_bad_lines=False,engine='python’)”</span>
<span class="comment-copy">@ChrisA , No it doesn't work. It gives columns count as 1 even though it is not 1  for separator having "|"</span>
<span class="comment-copy">I tried this but I am getting an error as : <code>raise Error, "Could not determine delimiter" _csv.Error: Could not determine delimiter</code></span>
<span class="comment-copy">@Atif Can you include a couple lines from the CSV file?</span>
<span class="comment-copy">I have added some info in edit . please check it ,</span>
<span class="comment-copy">@Atif What happens if you run <code>pd.read_csv(file, sep='|')</code> on the file with <code>|</code> as the separator?</span>
<span class="comment-copy">I tried to print the <code>sep</code> to see if it is catching the separator correctly and found that for the "|"  delimited file it is giving <code>sep</code> as "e" . That's why it is failing.</span>
