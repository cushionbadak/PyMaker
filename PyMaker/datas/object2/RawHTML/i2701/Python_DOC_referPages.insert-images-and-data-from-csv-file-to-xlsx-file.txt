<div class="post-text" itemprop="text">
<p>hello guys I am new to Python and I have a problem that I hope you can help me with that.</p>
<p>I am using a Raspberry Pi to take photos and then save them to specific file, and also I have a data inside a csv file, what I want to do is to take the images from that folder and save them to specific cell also same for the data. 
Let's say image no 1 save with data in row1 col1. The problem is, I don't know how many data going to be inside the csv file and how many image, but the number of images always same as number of data inside the csv file. My codes     as shown:</p>
<pre><code>import xlsxwriter
import csv

csvFile = open('k1.csv')
csvfileReader = csv.reader(csvFile)

for row in csvfileReader:
workbook = xlsxwriter.Workbook('k.xlsx')
worksheet = workbook.add_worksheet('sheet1')
worksheet.set_column('B:B', 10)
worksheet.set_column('A:A', 15)
worksheet.write('A1',row[0] )
worksheet.write('B1',row[1] )
worksheet.write('C1',row[2] )
worksheet.write('A10',row[0] )
worksheet.write('B10',row[1] )
worksheet.write('C10',row[2] )

worksheet.insert_image('D1', "1.png" , {'x_scale': 0.3, 'y_scale': 0.3})
worksheet.insert_image('D10', "2.png", {'x_scale': 0.3, 'y_scale': 0.3})

workbook.close()
</code></pre>
<p>The result I get is shown below:
<a href="https://i.stack.imgur.com/iozpP.png" rel="nofollow noreferrer"><img alt="here is my results" src="https://i.stack.imgur.com/iozpP.png"/></a></p>
<p>I want to know how to insert more images and data to the xlsx file if i have more that 30 images and names(data)</p>
</div>
<div class="post-text" itemprop="text">
<p>Rather than using <code>A1</code> notation, you can specify a row and column number (zero indexed) in the <code>.write()</code> function. Adding Python's <a href="https://docs.python.org/3/library/functions.html?highlight=enumerate#enumerate" rel="nofollow noreferrer"><code>enumerate()</code></a> function, it would provide you with a counter <code>rowy</code> that you can use as the row number. </p>
<p>It assumes that your <code>k1.csv</code> file looks like:</p>
<pre class="lang-none prettyprint-override"><code>Image 1,trki,present
Image 2,Tgjkt,present
Image 3,Abcd,not present
</code></pre>
<p>It will read each line from this file and put it into a different row in the XLSX file. In your example you have the rows spaced out every 9th row, so <code>* 9</code> is multiplied by the row number being used, you can remove this if you want consecutive rows.</p>
<pre><code>import xlsxwriter
import csv

workbook = xlsxwriter.Workbook('k.xlsx')
worksheet = workbook.add_worksheet('sheet1')

worksheet.set_column('A:A', 15)
worksheet.set_column('B:B', 10)

with open('k1.csv', newline='') as csv_file:
    csv_reader = csv.reader(csv_file)

    for rowy, row in enumerate(csv_reader):
        worksheet.write(rowy * 9, 0, row[0])
        worksheet.write(rowy * 9, 1, row[1] )
        worksheet.write(rowy * 9, 2, row[2] )
        worksheet.insert_image(rowy * 9, 3, "1.png" , {'x_scale': 0.3, 'y_scale': 0.3})

workbook.close()            
</code></pre>
<p>If you are still using Python 2.x, change this line:        </p>
<pre><code>with open('k1.csv', 'rb') as csv_file:
</code></pre>
<p>Note: If the script is run again, it will overwrite the existing <code>k.xlsx</code> with a new file. It will not append new information to the end. So if your CSV file only contains one line, it would appear that it only writes to the first line.</p>
<p>To append new information each time the script is run, you would need to read the existing file in, determine the last used row number and then write new items from this point onwards. The <code>xlsxwriter</code> library cannot do this, it can only write new files. You would need to use the <code>openpyxl</code> library to do this.</p>
</div>
<span class="comment-copy">Please <a href="https://stackoverflow.com/posts/52019176/edit">edit</a> your question to show a few lines (in text format) of the CSV file you are trying to read in. Also, which version of Python are you using?</span>
<span class="comment-copy">thank you mister Martin Evans but do you know how can i write data in different cell each time  if i am using a while loop or for loop</span>
<span class="comment-copy">This uses a <code>for</code> loop to read from your CSV file. <code>row</code> contains the contents of one row at a time, and <code>rowy</code> gives you a counter starting at <code>0</code> for the first row and counting up. I used <code>* 9</code> as you image seems to show your rows spaced out. If you remove the <code>* 9</code> it would write each row consecutively.</span>
