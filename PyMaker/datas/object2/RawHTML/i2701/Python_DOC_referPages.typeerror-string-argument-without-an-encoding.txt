<div class="post-text" itemprop="text">
<p>I want to upload compressed gzip of Json into Google Storage.</p>
<p>I have this code:</p>
<pre><code>import datalab.storage as storage
import gzip
path = prefix + '/orders_newline.json.gz'
storage.Bucket('orders').item(path).write_to(gzip.compress(bytes(create_jsonlines(source)),encoding='utf8'), 'application/json')
</code></pre>
<p>The <code>create_jsonlines(source)</code> is a function that returns Json Newline Delimited.</p>
<p>Running this code gives:</p>
<pre><code>TypeError: string argument without an encoding
</code></pre>
<p>The <a href="https://docs.python.org/3/library/functions.html#func-bytes" rel="nofollow noreferrer">Python docs</a> says the format is: <code>bytes([source[, encoding[, errors]]])</code> I'm not sure I understand it as there is no example of how to use it.</p>
<p>I tried also </p>
<pre><code>bytes([(create_jsonlines(source))[,encoding='utf8']])
</code></pre>
<p>This gives :</p>
<pre><code>SyntaxError: invalid syntax
</code></pre>
<p>I'm running Python 3.5</p>
</div>
<div class="post-text" itemprop="text">
<p>You are not using the <code>bytes</code> function correctly. Check this:</p>
<pre><code>&gt;&gt;&gt; a = "hi"
&gt;&gt;&gt; bytes(a,encoding='utf8')
b'hi'
</code></pre>
<p>You can try:</p>
<pre><code>bytes((create_jsonlines(source)),encoding='utf8')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Probably you are only one step away from the answer.   </p>
<p>See <a href="https://docs.python.org/3.1/library/functions.html#bytearray" rel="nofollow noreferrer">bytesarray()</a> and <a href="https://docs.python.org/3.1/library/functions.html#bytes" rel="nofollow noreferrer">bytes</a> for the function usage.(May need to change python version of the document)</p>
<p>And it says </p>
<pre><code>The optional source parameter can be used to initialize the array in a few different ways:
If it is a string, you must also give the encoding (and optionally, errors) parameters; bytearray() then converts the string to bytes using str.encode().
If it is an integer, the array will have that size and will be initialized with null bytes.
If it is an object conforming to the buffer interface, a read-only buffer of the object will be used to initialize the bytes array.
If it is an iterable, it must be an iterable of integers in the range 0 &lt;= x &lt; 256, which are used as the initial contents of the array.
</code></pre>
<p>Notice that square bracket indicates that parameters can be omitted, not array type of python language.</p>
<p>So you should use <code>bytes(create_jsonlines(source), encoding='utf8')</code></p>
</div>
