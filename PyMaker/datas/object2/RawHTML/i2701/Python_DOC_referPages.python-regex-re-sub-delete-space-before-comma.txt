<div class="post-text" itemprop="text">
<p>I am trying to make a little text clean program and I've made a sequence of re.subs for this goal. This is the messy string that I'm trying to clean: </p>
<p>'when I try this , the comma    does not get moved to the left ,whereas the full-stop does .also , the first letter of the new sentence gets capitalized ideally .'</p>
<pre><code>import csv, re
with open('spaties.csv', 'r', newline='') as readFile:
reader = csv.reader(readFile)

    with open('spaties3.csv', 'w', newline='') as new_file:
    writer = csv.writer(new_file)

    for line in reader:
        writer.writerow(line)

        #delete duplicate spaces
        ver1 = [re.sub("\s+", " ", x) for x in line]
        writer.writerow(ver1)

        #insert space after .
        ver2 = [re.sub(r'(?&lt;=[.])(?=[^\s])', r' ', x) for x in ver1]
        writer.writerow(ver2)

        #sentence start with uppercase
        ver3 = [re.sub(r'(\.\s[a-z])', lambda pat: pat.group(1).upper(), x) for x in ver2]
        writer.writerow(ver3)

        ver4 = [re.sub("ipv", "i.p.v.", x) for x in ver3]
        writer.writerow(ver4)

        #remove space before .
        ver5 = [re.sub(r'\s([?.!"](?:\s|$))', r'\1', x) for x in ver4]
        writer.writerow(ver5)

        #first letter uppercase
        ver6 = [re.sub(r'(^[a-z])', lambda pat: pat.group(1).upper(), x) for x in ver5]
        writer.writerow(ver6)

        #insert space after ,
        ver7 = [re.sub(r'(?&lt;=[,])(?=[^\s])', r' ', x) for x in ver6]
        writer.writerow(ver7)

        #remove space before ,
        ver8 = [re.sub(r'\s([?,!"](?:\s|$))', r'\1', x) for x in ver7]
        writer.writerow(ver8)

    new_file.close()
</code></pre>
<p>This is the final piece of output I get:</p>
<p>'When I try this , the comma does not get moved to the left ,Whereas the full-stop does. Also , the first letter of the new sentence gets capitalized ideally.'</p>
<p>So it did move the duplicate spaces correctly, capitalized the first letter of the sentence, but:</p>
<ul>
<li>it did not insert a space after the commas (ver7)</li>
<li>nor did it remove the space before the commas (ver8). </li>
<li>Also, it has capitalized Whereas. </li>
</ul>
<p>The comma issue puzzles me because ver 7 and 8 are exactly the same as ver 2 and 5.</p>
<p>Thanks in advance!</p>
</div>
<div class="post-text" itemprop="text">
<p>I think you're overcomplicating things. You can remove all spaces before a full-stop, comma, question mark or exclamation point and insert one after them with this regex:</p>
<pre><code>\s*([.,!?])\s*
</code></pre>
<p>which simply looks for one of <code>.,!?</code> surrounded by some number (which may be 0) of spaces on either side and then replace that with <code>\1</code> (<code>\1</code> followed by a space), thus removing any spaces before and replacing any spaces afterwards with a single space.</p>
<p><a href="https://regex101.com/r/4KvuNe/4" rel="nofollow noreferrer">Demo at regex101</a></p>
</div>
<span class="comment-copy">thanks for your reply. Looks good, the only thing that I noticed about this is that it replaces the [.,!?] characters with a sort of question mark in brackets in terminal. In the csv it looks like a []. Why could that be?</span>
<span class="comment-copy">Probably you are replacing with an invalid character instead of an empty string. I'm guessing you put <code>'\1'</code> which produces a control-A character.</span>
<span class="comment-copy">@tripleee thanks for that. I've edited the answer to hopefully make it clearer what the replace string is.</span>
<span class="comment-copy">thanks both. Of all the characters in the brackets, only the comma doesn't work. Could this have to do with the delimiter being a comma in the csv file?</span>
<span class="comment-copy">@robbah yes - that could be it. If commas are not being replaced, it would seem that the string you are attempting to clean up is being split on the commas and so there are none in the values being processed. Perhaps you need to change the <a href="https://docs.python.org/3/library/csv.html#csv-fmt-params" rel="nofollow noreferrer">quotechar</a> to make sure the string ends up in a single value in line.</span>
