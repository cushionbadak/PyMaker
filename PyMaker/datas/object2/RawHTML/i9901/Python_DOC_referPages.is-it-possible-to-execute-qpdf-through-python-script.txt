<div class="post-text" itemprop="text">
<p>I'm working on a python script that processes PDF files, though some of them contain encryption that restricts usage to only printing, which I have to manually remove before I can process them.</p>
<p>For that I have been manually using <a href="http://qpdf.sourceforge.net/" rel="nofollow noreferrer">QPDF</a> to remove these restrictions on individual PDF files before running the script (the commands for qpdf are pretty simple...inside the command prompt -&gt; qpdf --decrypt input.pdf output.pdf)</p>
<p>My question is - rather than doing this bit manually, is it possible to execute the QPDF executable file within my Python script and run the command? I haven't been able to find any python modules specifically to control QPDF so I am not holding much hope.</p>
</div>
<div class="post-text" itemprop="text">
<p>Thanks to <a href="https://stackoverflow.com/users/1832058/furas">furas</a> for pointing me in the right direction.</p>
<p>This is how I did it in Windows 10:</p>
<ol>
<li>Download <a href="http://qpdf.sourceforge.net/" rel="nofollow noreferrer">QPDF</a>, extract the folder and save somewhere on your PC. I put the folder in C:\qpdf-5.1.2. Inside the folder is bin\qpdf.exe.</li>
<li>Set an environment variable to C:\qpdf-5.1.2\bin. To set an environment variable in Windows 10, go to System Properties &gt; Advanced &gt; Environment Variables. With PATH highlighted, click Edit, then click New and paste in the path to the directory in point 2.</li>
</ol>
<p>Once that is set up, you can reference 'qpdf' in the command prompt and in Python.</p>
<pre><code>import subprocess
subprocess.run(["qpdf", "--decrypt", "C:/qpdf-5.1.2/bin/input.pdf", "C:/qpdf-5.1.2/bin/output.pdf"])
</code></pre>
</div>
<span class="comment-copy">use <a href="https://docs.python.org/3/library/subprocess.html" rel="nofollow noreferrer">subprocess</a> module to run any external program. ie. <code>subprocess.run(["qpdf", "--decrypt", "input.pdf", "output.pdf"]) </code></span>
<span class="comment-copy">Possible duplicate of <a href="http://stackoverflow.com/questions/89228/calling-an-external-command-in-python">Calling an external command in Python</a></span>
<span class="comment-copy">Python wrapper for qpdf: <a href="https://github.com/pikepdf/pikepdf" rel="nofollow noreferrer">github.com/pikepdf/pikepdf</a></span>
