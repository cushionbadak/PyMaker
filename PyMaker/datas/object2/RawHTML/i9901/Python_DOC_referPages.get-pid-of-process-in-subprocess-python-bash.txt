<div class="post-text" itemprop="text">
<p>I need to find pid of proccess started in bash script with another program. I use sshpass to enter the password, sshpass start ssh client and that client open sshtunnel to server.
Here is examples:</p>
<pre><code>start_tunnel.sh
#!/bin/bash
exec sshpass -p 'passw' ssh -D :port user@$server -o StrictHostKeyChecking=no -f -N
exit
</code></pre>
<p>And I start it with <code>subrocess.Popen</code>:</p>
<pre><code>proc = subprocess.Popen('start_tunnel.sh')
</code></pre>
<p>The script start just fine, it normally finish and return 0, I can get it PID, but is it possible to get the PID of started sshclient?</p>
</div>
<div class="post-text" itemprop="text">
<p>By default <code>proc.pid</code> will return the PID of the shell (ie the parent process). What you're looking for is the PID of the child process (sshpass).</p>
<p>So set <code>shell=False</code> in <code>subprocess.Popen</code>. <a href="https://docs.python.org/3/library/subprocess.html#subprocess.Popen.pid" rel="nofollow noreferrer">Documentation is here</a>.</p>
</div>
<div class="post-text" itemprop="text">
<p>Just call the <code>sshpass</code> directly from <code>Popen</code> and pass in the <code>shell=False</code> option. Then the direct child will the be the <code>sshpass</code> subprocess. No need for a shell wrapper. </p>
</div>
<div class="post-text" itemprop="text">
<p>Using <code>subprocess.Popen</code> I would simply call the <code>shell=false</code> option. </p>
</div>
<span class="comment-copy">Thanks for unswers guys, if I do this, I get sshpass PID, but is it possible to get PID of sshclient proccess, which spawned by sshpass proccess?</span>
