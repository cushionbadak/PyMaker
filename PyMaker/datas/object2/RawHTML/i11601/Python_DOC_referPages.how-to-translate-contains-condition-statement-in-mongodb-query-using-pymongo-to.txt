<div class="post-text" itemprop="text">
<p>I'm trying to load Mongodb data into pandas dataframe. Can somebody help me to correctly translate the following query part (contains condition) to use it within python:</p>
<pre><code>{ "Url": /.*certain_string.*/i }
</code></pre>
<p>Right now I load everything and then remove the extras by the following command:</p>
<pre><code>df = df[df['Url'].str.contains('certain_string')] 
</code></pre>
<p>but with this approach I load a lot of extra data for no reason.</p>
<p>Thank you very much!  </p>
</div>
<div class="post-text" itemprop="text">
<p>You need to use the <a href="https://docs.python.org/3/library/re.html" rel="nofollow"><code>re</code></a> module to first compile your regex, then use the <a href="https://docs.mongodb.org/manual/reference/operator/query/regex/" rel="nofollow"><code>$regex</code></a> operator.</p>
<pre><code>import re

pat = re.compile(r'*.certain_string.*', re.I)
db.collection.find({'Url': {'$regex': pat}})
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Pandas groupby(), filter(), agg(), apply(), etc. are your friends.</p>
<p>See the <a href="http://pandas.pydata.org/pandas-docs/stable/groupby.html#filtration" rel="nofollow">filtration</a> and <a href="http://pandas.pydata.org/pandas-docs/stable/groupby.html#transformation" rel="nofollow">transformation</a> (the latter more so) in Group By:split-apply-combine Pandas documentation. Use a regular expression for the filter parameter.</p>
</div>
<div class="post-text" itemprop="text">
<p>With a big help from joao, Sean and google, I found a solution for my question:</p>
<p>import re</p>
<p>pat = re.compile(r'.<em>\Qcertain_string\E.</em>') </p>
<p>db.collection.find({'Url': {'$regex': pat}})</p>
</div>
<span class="comment-copy"><a href="https://docs.mongodb.org/manual/reference/operator/query/regex/" rel="nofollow noreferrer">docs.mongodb.org/manual/reference/operator/query/regex</a></span>
<span class="comment-copy">I can certainly use those friends, but before that I don't want to load into pandas dataframe millions of records from Mongodb. I just want to improve the query part</span>
<span class="comment-copy">Then select a subset of the the MongoDB data using regex as joao suggests. I was approaching this as a Pandas question, but if you don't ever want the data to ever enter into the dataframe (rather than post processing) then what you're asking is a MongoDB question.</span>
<span class="comment-copy">Your "pat" variable did not work at all. Compare the answers. I really appreciate and used your help, but had to completely change the pat variable. It won't work for anyone who has a similar issue.</span>
<span class="comment-copy">What do you mean by <i>it didn't work</i>? you put a placeholder in your question and I used it in my answer. This is how we do it here.</span>
<span class="comment-copy">You are right, I accept your answer. Sorry, I am completely novice here. The problem is that pymongo query syntax is different than mongodb query and that's what I was asking</span>
