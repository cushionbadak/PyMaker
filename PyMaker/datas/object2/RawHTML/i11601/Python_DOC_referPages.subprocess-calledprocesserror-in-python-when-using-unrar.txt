<div class="post-text" itemprop="text">
<p>Python IDLE shows an error when I am trying to extract files using winrar(UnRAR.exe): </p>
<pre><code>"Traceback (most recent call last):
  File "&lt;pyshell#32&gt;", line 1, in &lt;module&gt;
    response=subprocess.check_output(['"C:\\Users\\B74Z3\\Desktop\\Test\\UnRAR.exe" e -p123 "C:\\Users\\B74Z3\\Desktop\\Test\\Test.rar"'], shell=True)
  File "C:\Program Files\Python 3.5\lib\subprocess.py", line 629, in check_output
    **kwargs).stdout
  File "C:\Program Files\Python 3.5\lib\subprocess.py", line 711, in run
    output=stdout, stderr=stderr)
subprocess.CalledProcessError: Command '['"C:\\Users\\B74Z3\\Desktop\\Test\\UnRAR.exe" e -p123 "C:\\Users\\B74Z3\\Desktop\\Test\\Test.rar"']' returned non-zero exit status 1"
</code></pre>
<hr/>
<p>What is the problem with the Code:</p>
<pre><code>import subprocess
response=subprocess.check_output(['"C:\\Users\\B74Z3\\Desktop\\Test\\UnRAR.exe" e -p123 "C:\\Users\\B74Z3\\Desktop\\Test\\Test.rar"'], shell=True)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I'd comment on this, but I don't have enough reputation to do so.</p>
<p>Try running the command without the shell interface, that is, </p>
<pre><code>response=subprocess.check_output(["""C:\Users\B74Z3\Desktop\Test\UnRAR.exe""", "e", "-p123', """C:\Users\B74Z3\Desktop\Test\Test.rar"""])
</code></pre>
<p>I've also remove the complexity of adding additional backslashes from your command by using triple quotes. This is almost more precise in that you know exactly what command and arguments is being run.</p>
<p>Also on windows the shell=True is not needed unless you're running a shell built in command, <a href="https://docs.python.org/3/library/subprocess.html#popen-constructor" rel="nofollow">https://docs.python.org/3/library/subprocess.html#popen-constructor</a>: </p>
<blockquote>
<p>On Windows with shell=True, the COMSPEC environment variable specifies the default shell. The only time you need to specify shell=True on Windows is when the command you wish to execute is built into the shell (e.g. dir or copy). You do not need shell=True to run a batch file or console-based executable.</p>
</blockquote>
</div>
<span class="comment-copy">Does calling Unrar with exactly the same parameters work when you call it from the command line?</span>
<span class="comment-copy">I'm putting my money on NO.</span>
<span class="comment-copy">Yes! it works in cmd very well</span>
<span class="comment-copy">Does this work? <code>response=subprocess.check_output(["C:/Users/B74Z3/Desktop/Test/UnRAR.exe", "e", "-p123", "C:/Users/B74Z3/Desktop/Test/Test.rar"])</code></span>
<span class="comment-copy">@AvijitNaskar: how do you know that it works? what is the result of <code>echo Exit Code is %errorlevel%</code> immediately after the <code>unrar</code> command in cmd? If it is zero then copy-paste the <i>exact</i> command into your Python script and run it from the same directory. Repeat cmd command, to make sure that you can run it without an error twice (check <code>%errorlevel%</code>)</span>
<span class="comment-copy">The Code is right actually that is the problem concerning with the user privileges as the code is trying to extract the files in \system32\ folder . But, thanks all of you for spending your valuable time to answering this question</span>
