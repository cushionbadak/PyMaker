<div class="post-text" itemprop="text">
<p>I am creating a django webserver that allows the user to run some "executables" on a local machine and to analyse their output through a webpage. </p>
<p>I have previously used a Celery tasks queue in order to run "executables" in similar situations. However, after reading up on Python <a href="https://docs.python.org/3/library/concurrent.futures.html">concurrent.futures</a>, I am beginning to wonder if I should use <code>ThreadPoolExecutor</code>, or <code>ProcessPoolExecutor</code> (or <code>ThreadPoolExecutor</code> inside a <code>ProcessPoolExecutor</code> :D) instead?</p>
<p>Googling I could only find <a href="https://www.reddit.com/r/learnpython/comments/3ql075/python_web_framework_for_cpu_intensive_processes/">one relevant question</a> comparing Celery to Tornado, and it steered to using Tornado alone.</p>
<p>So should I use Celery or a <code>PoolExecutor</code> for my simple webserver, and why?</p>
</div>
<div class="post-text" itemprop="text">
<p>You need to use celery if:</p>
<ol>
<li>You want to scale easily and independently from your webserver</li>
<li>You want a way to monitor your task and retry them if they fail</li>
<li>You want to create more advanced task execution patterns (ex. chain them)</li>
</ol>
<p>In addition to this is a very mature library with side projects that helps you also on UI presentation side, have a look at <a href="http://policystat.github.io/jobtastic/" rel="noreferrer">Jobtastic</a>.</p>
<p>If you don't need any of the listed point and you just need to execute this task without caring to much about status and without particular needs of scalability than just keep it simple.</p>
<p>About using <code>ThreadPoolExecutor</code> or <code>ProcessPoolExecutor</code> just keep in mind that the second will be able to receive and return only pickable objects and that the first will spawn child thread attached to your main process (probably your webserver if you are not using it inside another detached process) so the approach of mix them can make sense depending on the details of your implementation.</p>
</div>
<span class="comment-copy">I have done this in my code earlier and i can say its possible. There are multiple processpoolexecutors within which thread pool executors run. The only problem I see is that the CPU usage starts hitting the roof on high load which is well managed by celery</span>
