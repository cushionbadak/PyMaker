<div class="post-text" itemprop="text">
<p>I'm doing a simple object marshalling thing that goes between a simple RESTful API to a peewee-managed data store.  However, this pattern keeps on coming up (<code>form</code> being the output of <code>cgi.FieldStorage()</code>):</p>
<pre><code>if form.getfirst('From'): msg.msg_from=form.getfirst('From')
if form.getfirst('To'): msg.msg_to=form.getfirst('To')
if form.getfirst('Body'): msg.msg_body=form.getfirst('Body')
</code></pre>
<p>This is, of course, crufty and hard to maintain. What I'd much rather do is have something like this:</p>
<pre><code>keyMapping = { 'From': 'msg_from',
               'To': 'msg_to',
               'Body': 'msg_body' }
for k, v in keyMapping:
    if form.getfirst(k): msg.SET_FIELD_VALUE(v, form.getfirst(k))
</code></pre>
<p>Obviously it's the SET_FIELD_VALUE that I'm unable to find.  I know how I can do it using <code>eval</code> but I'd rather avoid that, obviously, and I realize that the actual pattern might actually involve some form of field reference or reflection API or the like instead, but I'm unable to find anything about how one would do that either.</p>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="http://docs.python.org/3/library/functions.html#setattr" rel="nofollow"><code>setattr</code></a>:</p>
<pre><code>keyMapping = { 'From': 'msg_from',
               'To': 'msg_to',
               'Body': 'msg_body' }
for k, v in keyMapping.items():
    if form.getfirst(k):
        setattr(msg, v, form.getfirst(k))
</code></pre>
<p>BTW, you should use <code>items()</code> or <code>iteritesm()</code>. Otherwise, iterating dictiaonary yields keys only.</p>
<hr/>
<p>Example usage of <code>setattr</code>:</p>
<pre><code>&gt;&gt;&gt; class Klass:
...     def __init__(self):
...         self.a = 1
...         self.b = 2
...
&gt;&gt;&gt; x = Klass()
&gt;&gt;&gt; setattr(x, 'a', 3)
&gt;&gt;&gt; x.a
3
</code></pre>
</div>
<span class="comment-copy">Thanks, that works simply. I guess I really need to reread the Python docs yet again...</span>
