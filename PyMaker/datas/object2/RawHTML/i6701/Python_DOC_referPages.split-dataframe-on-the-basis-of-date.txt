<div class="post-text" itemprop="text">
<p>I am trying to split a dataframe into two based on date. This has been solved for a related problem here: <a href="https://stackoverflow.com/questions/37532098/split-dataframe-into-two-on-the-basis-of-date">Split dataframe into two on the basis of date</a></p>
<p>My dataframe looks like this:</p>
<pre><code>               abcde     col_b
2008-04-10  0.041913  0.227050
2008-04-11  0.041372  0.228116
2008-04-12  0.040835  0.229199
2008-04-13  0.040300  0.230301
2008-04-14  0.039770  0.231421
</code></pre>
<p>How do I split it based on date (say before 2008-04-12 and after)? When I try this:</p>
<pre><code>df.loc[pd.to_datetime(df.index) &lt;= split_date]
</code></pre>
<p>where <code>split_date</code> is <code>datetime.date(2008-04-12)</code>, I get this error:</p>
<pre><code>*** TypeError: &lt;class 'datetime.date'&gt; type object 2008-04-12
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>from your code</p>
<blockquote>
<p>where split_date is datetime.date(2008-04-12), I get this error   </p>
</blockquote>
<p>here <code>datetime.date()</code> takes argument as format <code>2008,4,12</code> <a href="https://docs.python.org/3/library/datetime.html" rel="nofollow noreferrer">for more</a>. so you should write</p>
<pre><code>split_date = datetime.date(2008,4,12)
</code></pre>
<p>and as you sample input the first column has no name so you can follow to access the first column like this</p>
<pre><code>df[(pd.to_datetime(df[df.columns[0]]) &lt; split_date)]
</code></pre>
<p>else you give the column name as <code>"date"</code> or whatever you want</p>
<pre><code>df[(pd.to_datetime(df["date"]) &lt; split_date)]
</code></pre>
<p>and lastly </p>
<p><code>TypeError: &lt;class 'datetime.date'&gt; type object 2008-04-12</code></p>
<p>This is occurred basically you try this <code>datetime object</code> to the series of <code>df</code></p>
<p><a href="https://stackoverflow.com/questions/22898824/filtering-pandas-dataframes-on-dates">for more</a></p>
</div>
<div class="post-text" itemprop="text">
<p>Here is a solution:
Add the label "Date" to the data file for the first column.</p>
<pre><code>import pandas as pd
df = pd.read_csv('data.csv')

split_date ='2008-04-12'
df_training = df.loc[df['Date'] &lt;= split_date]
df_test = df.loc[df['Date'] &gt; split_date]
print df_test
</code></pre>
<p>When you do a comparision such as</p>
<pre><code>df.loc[pd.to_datetime(df.index) &lt;= split_date]
</code></pre>
<p>both sides must be of same type.</p>
</div>
<span class="comment-copy">While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href="/review/low-quality-posts/17338394">From Review</a></span>
<span class="comment-copy">Some explanation would be nice.</span>
<span class="comment-copy">(@Lundin and @ Sergio),Thanks for good suggestion and I will keep in mind for all next approaches.</span>
