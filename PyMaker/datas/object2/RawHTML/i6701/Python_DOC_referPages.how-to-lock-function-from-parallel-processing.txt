<div class="post-text" itemprop="text">
<p>I allowed 2 processes in celery and in each process 
There is a requirement for calling API request 
And it should not call at the same time. API server blocks concurrent request.
Can I lock that function if it is running in one process?</p>
<pre><code>def getlocaionadress(geocode):
    address = get_address_from_db(geocode)
    if not address:
        address = fetchaddress(geocode)

def fetchaddress(geocode):
    address = sent_api_request(geocode)
    return address
</code></pre>
<p>I need to lock fetchaddress function if it is already called in one process.
How can I achieve this?
Is there any alternate mechanism to avoid parallel calling of API request running in multiple processes.
I am using celery==3.1.14, python 2.7</p>
</div>
<div class="post-text" itemprop="text">
<p>You could coordinate with a <a href="https://docs.python.org/3/library/multiprocessing.html#multiprocessing.Lock" rel="nofollow noreferrer">Lock</a>.</p>
<p>Are you maybe saying you're not sure how to <a href="http://simeonfranklin.com/blog/2012/jul/1/python-decorators-in-12-steps/#_9_decorators" rel="nofollow noreferrer">wrap</a> a function with a Lock <a href="https://realpython.com/blog/python/primer-on-python-decorators/#real-world-examples" rel="nofollow noreferrer">decorator</a>?</p>
</div>
