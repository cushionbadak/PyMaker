<div class="post-text" itemprop="text">
<p>In python 3, how would one increment a 16 byte array like so? 0x00000000000000000000000000000000 -&gt; 0x00000000000000000000000000000001</p>
<pre><code>import base64
import Crypto
from Crypto.Cipher import AES

def incr(): 
    k = b'\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x00\x00\x00'
    x = b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'
    obj = AES.new(k,1)
    ciphertext = obj.encrypt(bytes(x))
    # while the leftmost byte of ciphertext produced by AES isn't 0x00
    while ciphertext[:-7] != b'\x00': 
        # increment x somehow 
        x += 1 # obviously doesn't work
        ciphertext = obj.encrypt(bytes(x))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you need to increment a byte string, it's easier to convert it to a number instead. Integers have a handy <a href="https://docs.python.org/3/library/stdtypes.html#int.to_bytes" rel="nofollow noreferrer"><code>to_bytes</code></a> method that you can use to convert <code>x</code> to a byte string:</p>
<pre><code>&gt;&gt;&gt; (1).to_bytes(16, 'big')
b'\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01'
</code></pre>
<p>Using this method, your code would look like this:</p>
<pre><code>def incr(): 
    k = b'\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x01\x01\x00\x00\x00'
    x = 0
    obj = AES.new(k, 1)
    ciphertext = obj.encrypt(x.to_bytes(16, 'big'))
    # while the leftmost byte of ciphertext produced by AES isn't 0x00
    while ciphertext[:-7] != b'\x00': 
        # increment x somehow 
        x += 1 # obviously works!
        ciphertext = obj.encrypt(x.to_bytes(16, 'big'))
</code></pre>
</div>
<span class="comment-copy">Could you clarify what the bytes represent? Perhaps a big-endian unsigned 128 bit integer?</span>
<span class="comment-copy">@JanneKarila yes sorry, they're 128 bits</span>
<span class="comment-copy">Maybe, you can try this: <a href="https://stackoverflow.com/questions/16271320/python-efficient-bytearray-incrementation">Python : efficient bytearray incrementation</a>, But doesn't support bigint</span>
