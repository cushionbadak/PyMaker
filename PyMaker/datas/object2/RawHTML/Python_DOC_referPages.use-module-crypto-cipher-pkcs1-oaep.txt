<div class="post-text" itemprop="text">
<p>I am trying to RSA encryption in Python. So I have a public/private key being generated, encrypting the message using the public key and writing the ciphertext to a text file. The code I am using is as follows:</p>
<pre><code>from Crypto.PublicKey import RSA
from Crypto import Random
import ast

random_generator = Random.new().read
key = RSA.generate(1024, random_generator)  

publickey = key.publickey()  

encrypted = publickey.encrypt('encrypt this message', 32)

print('encrypted message:', encrypted)
f = open('encryption.txt', 'w')
f.write(str(encrypted))
f.close()

f = open('encryption.txt', 'r')
message = f.read()

decrypted = key.decrypt(ast.literal_eval(str(encrypted)))

print('decrypted', decrypted)

f = open('encryption.txt', 'w')
f.write(str(message))
f.write(str(decrypted))
f.close()
</code></pre>
<p>But now when I run the application, I get the following error:</p>
<pre><code>Traceback (most recent call last):
  File "C:/Users/RedCode/PycharmProjects/AdvancedApps/Encryption/RSA Example.py", line 10, in &lt;module&gt;
    encrypted = publickey.encrypt('encrypt this message', 32)
  File "C:\Users\RedCode\AppData\Local\Programs\Python\Python36-32\lib\site-packages\Crypto\PublicKey\RSA.py", line 390, in encrypt
    raise NotImplementedError("Use module Crypto.Cipher.PKCS1_OAEP instead")
NotImplementedError: Use module Crypto.Cipher.PKCS1_OAEP instead
</code></pre>
<p>No matter how I try implementing <code>Crypto.Cipher.PKCS1_OAEP</code>, the error persists. I have tried import <code>Crypto.Cipher.PKCS1_OAEP</code>, <code>from Crypto.Cipher.PKCS1_OAEP import RSA</code>, <code>from Crypto.Cipher.PKCS1_OAEP import Random</code>, <code>from Crypto.Cipher.PKCS1_OAEP import ast</code>, and <code>import Crypto.Cipher</code> and none of those helped. </p>
<p>I tried <code>from Crypto.Cipher.PKCS1_OAEP import RSA</code> but then the error was:</p>
<pre><code>Traceback (most recent call last):
  File "C:/Users/RedCode/PycharmProjects/AdvancedApps/Encryption/RSA Example.py", line 3, in &lt;module&gt;
    from Crypto.Cipher.PKCS1_OAEP import RSA
ImportError: cannot import name 'RSA'
</code></pre>
<p>I checked my files and I do have the RSA package. </p>
<p>How can I correct this issue?</p>
</div>
<div class="post-text" itemprop="text">
<p>You need to create an instance of PKCS1_OAEP using new, and use that to encrypt/decrypt your message.</p>
<pre><code>from Crypto.Cipher import PKCS1_OAEP

encryptor = PKCS1_OAEP.new(publickey)
encrypted = encryptor.encrypt(b'encrypt this message')
</code></pre>
<p>and the same for decryption</p>
<pre><code>decryptor = PKCS1_OAEP.new(key)
decrypted = decryptor.decrypt(ast.literal_eval(str(encrypted)))
</code></pre>
</div>
<span class="comment-copy">I'm missing <code>import Crypto.Cipher</code> and <code>from Crypto.Cipher import PKCS1_OAEP</code> from your list of tries, did you try those as well?</span>
<span class="comment-copy">@MaartenBodewes I just tried it now and still did not work. I updated my question with these attempts.</span>
<span class="comment-copy">That worked perfectly, thanks!</span>
