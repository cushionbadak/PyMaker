<div class="post-text" itemprop="text">
<p>I learned how to customize Stanford NER (Named Entity Recognizer) in Java from here:</p>
<p><a href="http://nlp.stanford.edu/software/crf-faq.shtml#a" rel="nofollow noreferrer">http://nlp.stanford.edu/software/crf-faq.shtml#a</a></p>
<p>But I am developing my project with Python and here I need to train my classier with some custom entities.</p>
<p>I searched a lot for a solution but could not find any. Any idea? If it is not possible, is there any other way to train my classifier with custom entities, i.e, with nltk or others in python?</p>
<p><strong>EDIT: Code addition</strong> 
This is what I did to set up and test Stanford NER which worked nicely:</p>
<pre><code>from nltk.tag.stanford import StanfordNERTagger
path_to_model = "C:\..\stanford-ner-2016-10-31\classifiers\english.all.3class.distsim.crf.ser"
path_to_jar = "C:\..\stanford-ner-2016-10-31\stanford-ner.jar"
nertagger=StanfordNERTagger(path_to_model, path_to_jar)
query="Show  me the best eye doctor in Munich"
print(nertagger.tag(query.split()))
</code></pre>
<p>This code worked successfully. Then, I downloaded the sample austen.prop file and both jane-austen-emma-ch1.tsv and jane-austen-emma-ch2.tsv file and put it in a custom folder in NerTragger library folder. I modified the jane-austen-emma-ch1.tsv file with my custom entity tags. The code of austen.prop file has link to jane-austen-emma-ch1.tsv file. Now, I modified the above code as follow but it is not working:</p>
<pre><code>from nltk.tag.stanford import StanfordNERTagger
path_to_model = "C:\..\stanford-ner-2016-10-31\custom/austen.prop"
path_to_jar = "C:\..\stanford-ner-2016-10-31\stanford-ner.jar"
nertagger=StanfordNERTagger(path_to_model, path_to_jar)
query="Show  me the best eye doctor in Munich"
print(nertagger.tag(query.split()))
</code></pre>
<p>But this code is producing the following error:</p>
<pre><code>Exception in thread "main" edu.stanford.nlp.io.RuntimeIOException: java.io.StreamCorruptedException: invalid stream header: 236C6F63
    raise OSError('Java command failed : ' + str(cmd))
    at edu.stanford.nlp.ie.AbstractSequenceClassifier.loadClassifierNoExceptions(AbstractSequenceClassifier.java:1507)
    at edu.stanford.nlp.ie.crf.CRFClassifier.main(CRFClassifier.java:3017)
Caused by: java.io.StreamCorruptedException: invalid stream header: 236C6F63
OSError: Java command failed : ['C:\\Program Files\\Java\\jdk1.8.0_111\\bin\\java.exe', '-mx1000m', '-cp', 'C:/Users/HP/Desktop/Downloads1/Compressed/stanford-ner-2016-10-31/stanford-ner-2016-10-31\\stanford-ner-3.7.0-javadoc.jar;C:/Users/HP/Desktop/Downloads1/Compressed/stanford-ner-2016-10-31/stanford-ner-2016-10-31\\stanford-ner-3.7.0-sources.jar;C:/Users/HP/Desktop/Downloads1/Compressed/stanford-ner-2016-10-31/stanford-ner-2016-10-31\\stanford-ner-3.7.0.jar;C:/Users/HP/Desktop/Downloads1/Compressed/stanford-ner-2016-10-31/stanford-ner-2016-10-31\\stanford-ner.jar;C:/Users/HP/Desktop/Downloads1/Compressed/stanford-ner-2016-10-31/stanford-ner-2016-10-31\\lib\\joda-time.jar;C:/Users/HP/Desktop/Downloads1/Compressed/stanford-ner-2016-10-31/stanford-ner-2016-10-31\\lib\\jollyday-0.4.9.jar;C:/Users/HP/Desktop/Downloads1/Compressed/stanford-ner-2016-10-31/stanford-ner-2016-10-31\\lib\\stanford-ner-resources.jar', 'edu.stanford.nlp.ie.crf.CRFClassifier', '-loadClassifier', 'C:/Users/HP/Desktop/Downloads1/Compressed/stanford-ner-2016-10-31/stanford-ner-2016-10-31/custom/austen.prop', '-textFile', 'C:\\Users\\HP\\AppData\\Local\\Temp\\tmppk8_741f', '-outputFormat', 'slashTags', '-tokenizerFactory', 'edu.stanford.nlp.process.WhitespaceTokenizer', '-tokenizerOptions', '"tokenizeNLs=false"', '-encoding', 'utf8']
    at java.io.ObjectInputStream.readStreamHeader(ObjectInputStream.java:808)
    at java.io.ObjectInputStream.&lt;init&gt;(ObjectInputStream.java:301)
    at edu.stanford.nlp.ie.AbstractSequenceClassifier.loadClassifier(AbstractSequenceClassifier.java:1462)
    at edu.stanford.nlp.ie.AbstractSequenceClassifier.loadClassifier(AbstractSequenceClassifier.java:1494)
    at edu.stanford.nlp.ie.AbstractSequenceClassifier.loadClassifierNoExceptions(AbstractSequenceClassifier.java:1505)
    ... 1 more
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The Stanford NER classifier is a java program. The NLTK's module is only an interface to the java executable. So you train a model exactly as you did before (or as you saw done in the link you provide). </p>
<p>In your code, you are confusing the training of a model with its use to chunk new text. The <code>.prop</code> file contains instructions for training a new model; it is not itself a model. This is what I recommend:</p>
<ol>
<li><p>Forget about python/nltk for the moment, and train a new model from the Windows command line (CMD prompt or whatever): Follow the how-to you mention in your question, to generate a serialized model (<code>.ser</code> file) named <code>ner-model.ser.gz</code> or whatever you decide to call it from your <code>.prop</code> file.</p></li>
<li><p>In your python code, set the <code>path_to_model</code> variable to point to the <code>.ser</code> file you generated in step 1. </p></li>
</ol>
<p>If you really want to control the training process from python, you could use the <a href="https://docs.python.org/3/library/subprocess.html" rel="nofollow noreferrer">subprocess</a> module to issue the appropriate command line commands. But it sounds like you don't really need this; just try to understand what these steps do so that you can carry them out properly.</p>
</div>
<span class="comment-copy">It's pretty clear that the problem is confusion about the difference between training and using a model. Please see my updated answer.</span>
<span class="comment-copy">@Newbie23, Can you tell me whole procedure/steps to train my own NER model? Please help me. I'm very new with this.</span>
<span class="comment-copy">I tried to setup the classifier as I normally do in NER. But when I used the properties file as suggested in the tutorial instead of the crf.ser.gz file, it shows a Java command failed error.  st = StanfordNERTagger('C:/Users/HP/Desktop/Downloads1/Compressed/stanford-ner-2016-10-31/stanford-ner-2016-10-31/custom/austen.prop','C:/Users/HP/Desktop/Downloads1/Compressed/stanford-ner-2016-10-31/stanford-ner-2016-10-31/stanford-ner.jar') query="Show  me the best eye doctor in Munich" print(st.tag(query.split()))</span>
<span class="comment-copy">Can you please help me regards this?</span>
<span class="comment-copy">Please edit <b>your question</b> to explain what you've done, and the problem you are having. Include the full error trace along with the commands you showed in your comment. Then I, or someone else, may be able to help.</span>
<span class="comment-copy">Essentially, yes. There's no "jave command line" as far as I know: you run it from the Windows CMD prompt or perhaps via your IDE. (Python has nothing to do with this). The point is that you must execute such a command to create the <code>.ser</code> file, then use the <code>.ser</code> file from python (which actually launches the java program behind the scenes) to tag.</span>
<span class="comment-copy">Welcome. Glad I could help.</span>
