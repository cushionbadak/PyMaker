<div class="post-text" itemprop="text">
<p>My current professor is using Python 2.7 for examples in class, but other professors that I will be taking classes from in the future have suggested I use Python 3.5. I am trying to convert my current Professor's examples from 2.7 to 3.5. Right now I'm having an issue with the urllib2 package, which I understand has been split in Python 3.</p>
<p>The original code in the iPython notebook looks like this :</p>
<pre><code>import csv
import urllib2

data_url = 'http://archive.ics.uci.edu/ml/machine-learning-    databases/adult/adult.data'
response = urllib2.urlopen(data_url)

myreader = csv.reader(response)
for i in range(5):
    row = next(myreader)
   print ','.join(row)
</code></pre>
<p>Which I have converted to:</p>
<pre><code>import csv
import urllib.request

data_url = 'http://archive.ics.uci.edu/ml/machine-learning-  databases/adult/adult.data'
response = urllib.request.urlopen(data_url)
myreader = csv.reader(response)
for i in range(5):
    row = next(myreader)
    print(','.join(row))
</code></pre>
<p>But that leaves me with the error:</p>
<pre><code>Error                                     Traceback (most recent call last)
&lt;ipython-input-19-20da479e256f&gt; in &lt;module&gt;()
      7 myreader = csv.reader(response)
      8 for i in range(5):
----&gt; 9     row = next(myreader)
     10     print(','.join(row))

Error: iterator should return strings, not bytes (did you open the file in text mode?)
</code></pre>
<p>I'm unsure how to proceed from here. Any ideas?</p>
</div>
<div class="post-text" itemprop="text">
<p>Wrap <code>response</code> with another iterator which decode bytes to string and yield the strings:</p>
<pre><code>import csv
import urllib.request

def decode_iter(it):
    # iterate line by line
    for line in it:
        # convert bytes to string  using `bytes.decode`
        yield line.decode()

data_url = 'http://archive.ics.uci.edu/ml/machine-learning-databases/adult/adult.data'
response = urllib.request.urlopen(data_url)
myreader = csv.reader(decode_iter(response))
for i in range(5):
    row = next(myreader)
    print(','.join(row))
</code></pre>
<p><strong>UPDATE</strong></p>
<p>Instead of <code>decode_iter</code>, you can use <a href="https://docs.python.org/3/library/codecs.html#codecs.iterdecode" rel="nofollow noreferrer"><code>codecs.iter_decode</code></a>:</p>
<pre><code>import csv
import codecs
import urllib.request

data_url = 'http://archive.ics.uci.edu/ml/machine-learning-databases/adult/adult.data'
response = urllib.request.urlopen(data_url)
myreader = csv.reader(codecs.iterdecode(response, 'utf-8'))
for i in range(5):
    row = next(myreader)
    print(','.join(row))
</code></pre>
</div>
<span class="comment-copy">Would you consider using <a href="http://docs.python-requests.org/en/master/" rel="nofollow noreferrer"><code>requests</code></a> package?</span>
<span class="comment-copy">You have to convert the <code>bytes</code> returned by the <code>urlopen</code> to <code>str</code>. <code>.decode()</code> does this. Take a look at: <a href="http://stackoverflow.com/questions/6224052/what-is-the-difference-between-a-string-and-a-byte-string" title="what is the difference between a string and a byte string">stackoverflow.com/questions/6224052/â€¦</a>.</span>
<span class="comment-copy">Possible duplicate of <a href="http://stackoverflow.com/questions/18897029/read-csv-file-from-url-into-python-3-x-csv-error-iterator-should-return-str">Read .csv file from URL into Python 3.x - _csv.Error: iterator should return strings, not bytes (did you open the file in text mode?)</a></span>
<span class="comment-copy">what is the default for <code>.decode()</code>? <code>'utf-8'</code>?</span>
<span class="comment-copy">@Ev.Kounis, In Python 3.x, <code>utf-8</code>. See <a href="http://docs.python.org/library/stdtypes#bytes.decode" rel="nofollow noreferrer">docs.python.org/library/stdtypes#bytes.decode</a></span>
