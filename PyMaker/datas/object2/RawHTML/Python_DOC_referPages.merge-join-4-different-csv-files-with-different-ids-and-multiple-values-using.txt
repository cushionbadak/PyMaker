<div class="post-text" itemprop="text">
<p>I've 4 different CSV files that I want to merge (join).
The main file contains all columns and an identifier (join column) for one of the other files is included.   </p>
<p>For example The main file contains:</p>
<pre><code>Name           | Address             | ID_1  | ID_2        | ID_3
Ruth D. Batie  | 4962 Hill Street    | 1_001 | NaN         | 3_004
Kelley C. Rice | 1074 Tipple Road    | NaN   | 2_002       | NaN
Gary P. Kirby  | 1520 Robinson Court | 1_004 | 2_002;2_004 | 3_004
</code></pre>
<p>File lookup 1 contains:</p>
<pre><code>ID_1  | Monthly_MB
1_001 | 1557
1_002 | 1024
1_003 | 500
1_004 | 24
</code></pre>
<p>File lookup 2 contains:</p>
<pre><code>ID_2  | platform
2_001 | ios
2_002 | android
2_003 | ios
2_004 | ios
</code></pre>
<p>File lookup 3 contains:</p>
<pre><code>ID_3  | Device
3_001 | T31
3_002 | IN265
3_003 | AG_Flair
3_004 | BOOST2
</code></pre>
<p>I'd like to end up with this:</p>
<pre><code>Name           | Address             | ID_1  | ID_2        | ID_3
Ruth D. Batie  | 4962 Hill Street    | 1557  | NaN         | BOOST2
Kelley C. Rice | 1074 Tipple Road    | NaN   | android     | NaN
Gary P. Kirby  | 1520 Robinson Court | 24    | android;ios | BOOST2 
</code></pre>
<p>Some of my code :</p>
<pre><code>result = pd.merge(df_main,
                 df_1[['ID_1', 'Monthly_MB']],
                 df_2[['ID_2', 'platform']],
                 df_3[['ID_3', 'Device']],
                 on=' ??')
result.head()
</code></pre>
<p>Then I get lost on the inner join part (on='') because there are different columns to join and one column contains two values (can even be more than 2) separated by a semicolon;</p>
<pre><code>Gary P. Kirby  | 1520 Robinson Court | 1_004 | 2_002;2_004 | 3_004
</code></pre>
<p>I'm quite new to Pandas, so any help is much appreciated.</p>
</div>
<div class="post-text" itemprop="text">
<p>I suggest create dictionary with all lookup files first with <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.set_index.html" rel="nofollow noreferrer"><code>DataFrame.set_index</code></a> and <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.to_dict.html" rel="nofollow noreferrer"><code>Series.to_dict</code></a>:</p>
<pre><code>d = {'ID_1' : df2.set_index('ID_1')['Monthly_MB'].to_dict(),
     'ID_2' : df3.set_index('ID_2')['platform'].to_dict(),
     'ID_3' : df4.set_index('ID_3')['Device'].to_dict()}
</code></pre>
<p>Then loop by all keys of dictionaries and use list comprehension - first split values by <code>;</code> if strings, map by dictionary and <code>join</code> back by <code>;</code>:</p>
<pre><code>for c in d.keys():
    f = lambda x: ';'.join(str(d[c].get(y, '')) for y in x.split(';')) 
                                                if isinstance(x, str) 
                                                else x
    df1[c] = df1[c].apply(f)

print (df1)
             Name              Address  ID_1         ID_2    ID_3
0  Ruth D. Batie   4962 Hill Street     1557  NaN          BOOST2
1  Kelley C. Rice  1074 Tipple Road     NaN   android      NaN   
2  Gary P. Kirby   1520 Robinson Court  24    android;ios  BOOST2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use something like the code below to match/replace the values.
Add an if statement for detecting cells with multiple values and split the values with semicolon:</p>
<pre><code>for i in df_main['ID_1']:
    df_main.loc[df_main['ID_1']==i , 'ID_1'] = df_1.loc[df_1['ID_1']==i , 'Monthly_MB']
</code></pre>
</div>
<span class="comment-copy">Many thanks Jezrael. Is it also possible when the lookup files have more than 2 columns? I assume that I can't use the dictionary.</span>
<span class="comment-copy">@JohnDoe - Can you modify data? Not sure if understand. Or better is create new question, but it is up to you.</span>
<span class="comment-copy">I'll create a new question. Many thanks.</span>
<span class="comment-copy">@JohnDoe - Super, good idea.</span>
<span class="comment-copy">Can you please explain this more in detail?</span>
