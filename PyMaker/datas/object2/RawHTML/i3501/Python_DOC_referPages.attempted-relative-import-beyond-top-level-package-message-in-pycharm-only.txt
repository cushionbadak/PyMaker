<div class="post-text" itemprop="text">
<p>UPDATE: if I change the name of the <code>select</code> module (in which the import error occurs) to <code>select1</code>, the problem goes away! WHAT the?</p>
<p>First off: everything works fine when I try to import my package from the command line, or run pytest in the project directory.</p>
<p>But in PyCharm I'm getting the "attempted relative import beyond top-level package" problem when I try to run my tests, and ONLY while in PyCharm. I can't figure out why.</p>
<p>I have even deleted and re-cloned the repository and the problem still occurs.</p>
<p>Here is the <a href="https://github.com/Ricyteach/candejar/tree/select.by_shape" rel="nofollow noreferrer">link</a> to the problem branch.</p>
<p>And here is the tb:</p>
<pre><code>Testing started at 4:02 PM ...
C:\Users\ricky\AppData\Local\Programs\Python\Python37\python.exe "C:\Program Files\JetBrains\PyCharm Community Edition 2018.1.2\helpers\pycharm\_jb_pytest_runner.py" --path C:/Users/ricky/PycharmProjects/candejar/tests
Traceback (most recent call last):
  File "C:\Program Files\JetBrains\PyCharm Community Edition 2018.1.2\helpers\pycharm\_jb_pytest_runner.py", line 10, in &lt;module&gt;
    from pkg_resources import iter_entry_points
  File "C:\Users\ricky\AppData\Local\Programs\Python\Python37\lib\site-packages\pkg_resources\__init__.py", line 36, in &lt;module&gt;
    import email.parser
  File "C:\Users\ricky\AppData\Local\Programs\Python\Python37\lib\email\parser.py", line 12, in &lt;module&gt;
    from email.feedparser import FeedParser, BytesFeedParser
  File "C:\Users\ricky\AppData\Local\Programs\Python\Python37\lib\email\feedparser.py", line 27, in &lt;module&gt;
    from email._policybase import compat32
  File "C:\Users\ricky\AppData\Local\Programs\Python\Python37\lib\email\_policybase.py", line 9, in &lt;module&gt;
    from email.utils import _has_surrogates
  File "C:\Users\ricky\AppData\Local\Programs\Python\Python37\lib\email\utils.py", line 29, in &lt;module&gt;
    import socket
  File "C:\Users\ricky\AppData\Local\Programs\Python\Python37\lib\socket.py", line 52, in &lt;module&gt;
    import os, sys, io, selectors
  File "C:\Users\ricky\AppData\Local\Programs\Python\Python37\lib\selectors.py", line 12, in &lt;module&gt;
    import select
  File "C:\Users\ricky\PycharmProjects\candejar\candejar\select.py", line 24, in &lt;module&gt;
    from . import exc
ImportError: attempted relative import with no known parent package

Process finished with exit code 1
</code></pre>
<p>I'm sure there is something simple going on here but I just can't figure it out. NOTE: I'm using Python 3.7 RC 1.</p>
<p>The <code>sys.path</code> in pycharm and the command line come out to be the same, except pycharm also includes the pycharm project main package directory (which for some reason appears <em>twice</em>).</p>
</div>
<div class="post-text" itemprop="text">
<p>I was able to solve this by deleting the <code>.idea</code> directory from the cloned repository and re-opening PyCharm. I still don't know what was wrong, but it is fixed now. Very weird.</p>
<p>UPDATE: it has something to do with the following line in the project <code>.iml</code> file in the <code>.idea</code> folder:</p>
<pre><code>&lt;sourceFolder url="file://$MODULE_DIR$/candejar" isTestSource="false" /&gt;
</code></pre>
<p>Removing that xml code solves the issue. But I do not know why, and I don't know how it got there in the first place (I do not recall messing around with any of my settings prior to this error).</p>
</div>
<span class="comment-copy">Check if your <code>sys.path</code> is different when running from console and from PyCharm.</span>
<span class="comment-copy">@Norrius the <code>sys.path</code> lists are identical except the pycharm project includes the project main package directory at the end. an empty string also appears at the front of the command line version.</span>
<span class="comment-copy">As to the edit: <a href="https://docs.python.org/3/library/select.html" rel="nofollow noreferrer"><code>select</code></a> is a standard module in Python, which might affect imports.</span>
<span class="comment-copy">@Norrius huh- i didn't know that it was part of the stdlib. but it was working fine before. and now i have deleted the <code>.idea</code> directory and that seems to have fixed it.</span>
