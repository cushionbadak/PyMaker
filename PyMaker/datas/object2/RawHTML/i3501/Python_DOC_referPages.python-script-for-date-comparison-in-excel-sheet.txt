<div class="post-text" itemprop="text">
<p>I am a beginner, please help me with the program logic to create a python script using pandas for the following.</p>
<p>I have a excel sheet with 5 columns and many rows containing the details of expiring ssl certs. <strong>Fourth column has the date of expiry.</strong></p>
<p>I need to write a <strong><em>Python script to check date in each cell of 4th column and if the date is within 60 days time frame from today I need to copy the entire row to a new sheet</em></strong>, like wise need to append all the rows which are in this time frame and mail this new spreadsheet. </p>
</div>
<div class="post-text" itemprop="text">
<p>To open sheet <code>sheetname</code> from <code>excel_path</code> use </p>
<pre><code>df = pd.read_excel(excel_path, sheetname=sheetname)
</code></pre>
<p>Consider the dataframe:</p>
<pre><code>df = pd.DataFrame({"a": [1,2,3,4,5,6],
                   "b": [7,8,9,0,1,2],
                   "c": [3,4,5,6,7,8],
                   "date": ["2018-01-01", "2018-02-02", "2018-03-03",
                            "2018-04-04", "2018-05-05", "2018-06-06"]})
&gt;   a   b   c   date
0   1   7   3   2018-01-01
1   2   8   4   2018-02-02
2   3   9   5   2018-03-03
3   4   0   6   2018-04-04
4   5   1   7   2018-05-05
5   6   2   8   2018-06-06
</code></pre>
<p>First, convert <code>date</code> column to <code>datetime</code> dtype with necessary <a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior" rel="nofollow noreferrer">format</a>:</p>
<pre><code>df["date"] = pd.to_datetime(df["date"], format="%Y-%m-%d")
</code></pre>
<p>Get differences between items in <code>df["date"]</code> and today and filter them:</p>
<pre><code>days_threshold = 60
filtered_ix = (pd.Timestamp("now") - df["date"]).dt.days &lt; days_threshold
</code></pre>
<p>Select filtered rows from dataframe using <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.loc.html" rel="nofollow noreferrer"><code>.loc</code></a></p>
<pre><code>filtered_df = df.loc[filtered_ix]
</code></pre>
<p>To save filtered rows to Excel on sheet <code>output_sheet</code> with filepath <code>output_path</code> use <code>df.to_excel</code>:</p>
<pre><code>filtered_df.to_excel(output_path, sheet_name=output_sheet, index=False)
</code></pre>
</div>
<span class="comment-copy">What did you try so far?</span>
<span class="comment-copy">Thanks a lot for this logic koPytok  I have constructed the program but I get this error. <b>AttributeError: 'DatetimeProperties' object has no attribute 'days'</b></span>
<span class="comment-copy">Show me the line with error</span>
<span class="comment-copy">FilteredList=(pd.Timestamp("now")-df["ValidityEndDate"].dt.days &lt; ExpiryLimit)</span>
<span class="comment-copy">AttributeError: 'DatetimeProperties' object has no attribute 'days'</span>
<span class="comment-copy">Remove last <code>) </code> and add <code>) </code> between <code>["ValidityEndDate"] </code> and <code>.dt</code>: <code>["ValidityEndDate"]).dt</code></span>
