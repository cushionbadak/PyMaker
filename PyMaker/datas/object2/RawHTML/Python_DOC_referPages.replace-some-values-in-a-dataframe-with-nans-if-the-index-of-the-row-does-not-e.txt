<div class="post-text" itemprop="text">
<p>I have a really large dataframe similar to this:</p>
<pre><code>     CustomerId   Latitude   Longitude     
0.        a        x1         y1
1.        a        x2         y2
2.        b        x3         y3
3.        c        x4         y4
</code></pre>
<p>And I have a second dataframe that corresponds to a sample of the first one, like this: </p>
<pre><code>     CustomerId   Latitude   Longitude     
0.        a         x1         y1
3.        c         x4         y4
</code></pre>
<p>My goal is to get a new dataframe just like the original, but with NaN's instead of  the coordinates of the rows with indexes that don't exist on the second dataframe. This is the result I would need:</p>
<pre><code>     CustomerId   Latitude   Longitude     
0.        a        x1         y1
1.        a        NaN        NaN
2.        b        NaN        NaN
3.        c        x4         y4
</code></pre>
<p>I am new to Python and I haven't found any question like this one. Anybody has an idea of how to solve it?</p>
</div>
<div class="post-text" itemprop="text">
<p>First we create a mask with <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.isin.html" rel="nofollow noreferrer"><code>pandas.DataFrame.isin</code></a></p>
<p>After that we use <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html" rel="nofollow noreferrer"><code>np.where</code></a> and ask for the opposite with <code>~</code></p>
<pre><code>mask = df.CustomerId.isin(df2.CustomerId)

df['Latitude']  = np.where(~mask, np.NaN, df['Latitude'])
df['Longitude'] = np.where(~mask, np.NaN, df['Longitude'])

print(df)
    CustomerId Latitude Longitude
0.0          a       x1        y1
1.0          a       x2        y2
2.0          b      NaN       NaN
3.0          c       x4        y4
</code></pre>
<p><strong>Explanation</strong>:<br/>
<code>np.where</code> works as following: <code>np.where(condition, value if true, value if false)</code></p>
</div>
<span class="comment-copy">Is <code>Customer</code> a column or your index?</span>
<span class="comment-copy">It's the first column, I edited the question because it wasn't clear. Thanks for pointing it out!</span>
<span class="comment-copy">Thanks, your expected output is not correct now, could you edit that aswell? See my answer</span>
