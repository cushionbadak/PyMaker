<div class="post-text" itemprop="text">
<p>I have a column of dates in my dataframe and I'd like to get the last day of the month from the dates
example, if the date is '2017-01-25' I want to get '2017-01-31'
I suppose I can get the month and year number from the dates and use monthrange to figure out the last day of the month but I'm looking for a one line code  </p>
</div>
<div class="post-text" itemprop="text">
<p>If you have a date <code>d</code> then the simplest way is to use the <a href="https://docs.python.org/3/library/calendar.html" rel="nofollow noreferrer"><code>calendar</code></a> module to find the number of days in the month:</p>
<pre><code>datetime.date(d.year, d.month, calendar.monthrange(d.year, d.month)[-1])
</code></pre>
<p>Alternatively, using only <code>datetime</code>, we just find the first day of the next month and then remove a day:</p>
<pre><code>datetime.date(d.year + d.month // 12, 
              d.month % 12 + 1, 1) - datetime.timedelta(1)
</code></pre>
<p>You might find the logic clearer if expressed as:</p>
<pre><code>datetime.date(d.year + (d.month == 12), 
              (d.month + 1 if d.month &lt; 12 else 1), 1) - datetime.timedelta(1)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Finding the last date of a month with</p>
<pre><code>year, month = 2017, 2
pd.date_range('{}-{}'.format(year, month), periods=1, freq='M')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I get the first of the month and minus  one day to get the last day of the month.
ccyymmdd = str((pd.Period(datetime.today().replace(day=1), 'D') - 1).strftime("%C%y-%m-%d")) </p>
</div>
<span class="comment-copy">Since you mention dataframes, I'm assuming you're using pandas?   Because if so, this question is basically a dupe of <a href="http://stackoverflow.com/questions/18233107/pandas-convert-datetime-to-end-of-month">this</a>: you can do <code>df['column_with_dates'] + pd.offsets.MonthEnd()</code>.</span>
<span class="comment-copy">Hi, welcome to StackOverflow. In my view this logic is already covered by one of the options in the accepted answer. If you disagree, please edit your answer to explain why.</span>
