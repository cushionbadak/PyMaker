<div class="post-text" itemprop="text">
<p>I am trying to populate a nested dictionary, but are having trouble since I am fairly new to python (also to Stack Overflow).</p>
<p>I have a txt file with paths to photos and I would like to populate the splits from it to a nested dictionary. An example of the text file looks like this:</p>
<pre><code>/photos/Bob_January_W1_001.png
/photos/Alice_April_W2_003.png
</code></pre>
<p>Where Bob is the user, January is the month, W1 the week and 001 the nr of the photo. Etc.</p>
<p>I would like to populate a nested dictionary in the following structure (based on what I have read):</p>
<pre><code>{'Bob': {'January': {'W1': 001, 002, 003}, {'W2': 001, 002,003}}, 'February': {'W3': 001, 002}}  #And so on for other keys as well
</code></pre>
<p>So far I have only managed to sort the numbers to a user, like this:</p>
<pre><code>sorteddict = {}
with open('validation_labels.txt','r') as f:
    for line in f:
        split = line.split('_')
        user = split[1]
        month = split[2]
        week = split[3]
        image = split[4]

        if action_class in clipframe:
            sorteddict[user].append(image)
        else:
            sorteddict[user] = [image]
</code></pre>
<p>But now I want the nested structure I described. I started by initializing my nested dict, like this <code>nesteddict[user][month][week].append(image)</code>, but I recieve <code>KeyError: 'Bob'</code>. I also understand that I am going to need a lot more if statements and conditions. But I don't know where to begin.        </p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <em>nested</em> sets of <a href="https://docs.python.org/3/library/collections.html#collections.defaultdict" rel="nofollow noreferrer"><code>collections.defaultdict</code></a> to build your data:</p>
<pre><code>from collections import defaultdict

dct = defaultdict(lambda: defaultdict(lambda: defaultdict(list)))

with open('validation_labels.txt','r') as f:
    for line in f:
        line = line.strip('/photo/')
        user, month, week, image = line.split('_')
        dct[user][month][week].append(image)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I have done something like this before:</p>
<pre><code>temp = sorteddict
for key in keys[:-1]:
    if key not in temp:
        temp[key] = {}
    temp = temp[key]
temp[keys[-1]] = value
</code></pre>
<p>So, your keys would need to be in a list (the <code>keys</code> list) and the value that you want at the end of that key chain is in <code>value</code></p>
</div>
<span class="comment-copy">Use <code>collections.defaultdict</code>.</span>
<span class="comment-copy">You can use <code>get()</code> with default values, eg : <code>nesteddict.get('Bob', {})</code></span>
