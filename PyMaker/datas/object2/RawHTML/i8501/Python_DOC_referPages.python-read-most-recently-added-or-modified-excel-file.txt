<div class="post-text" itemprop="text">
<p>When we deal with repetitive tasks, e.g. you have a weekly process that get an excel file in the same format, but different numbers. How do we ask Python to only read the most recently added or modified file in the folder (assuming the folder is used to keep all the historical files)? </p>
<p>Of course we can assign a excel file name and use pandas or other libraries to read it. But since I do NOT need to import the previous file, and I do NOT want to open the .py file to update the excel file name, I hope to find a way to automate the process.</p>
</div>
<div class="post-text" itemprop="text">
<p>Read the modification time of a file using <a href="https://docs.python.org/3/library/os.path.html#os.path.getmtime" rel="nofollow noreferrer">os.path.getmtime</a>.</p>
<pre><code>import os                                                                   
import glob             

excel_folder = 'C:/Users/ThisOne/ExcelStuff/'

# glob.glob returns all paths matching the pattern.
excel_files = list(glob.glob(os.path.join(excel_folder, '*.xls*')))

mod_dates = [os.path.getmtime(f) for f in excel_files]

# sort by mod_dates.
file_date = zip(excel_files, mod_dates).sort(key=lambda d: d[1])

newest_file_path = file_date[0][1]
</code></pre>
<p>A good response to a similar question <a href="https://stackoverflow.com/a/39501288/4322543">here</a>.</p>
</div>
<span class="comment-copy">What have you tried so far? The <code>os</code> module, for example, provides a variety of tools for interrogating folders and files.</span>
<span class="comment-copy"><a href="http://stackoverflow.com/q/237079/953482">How to get file creation &amp; modification date/times in Python?</a> may be of use to you.</span>
<span class="comment-copy">Possible duplicate of <a href="http://stackoverflow.com/questions/237079/how-to-get-file-creation-modification-date-times-in-python">How to get file creation &amp; modification date/times in Python?</a></span>
