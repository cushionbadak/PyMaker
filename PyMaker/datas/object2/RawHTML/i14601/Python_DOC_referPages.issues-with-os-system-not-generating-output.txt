<div class="post-text" itemprop="text">
<p>When I run the program I get everything up to <code>q</code> outputted as it should be, but the .mafft that should be created by <code>q</code> is coming back empty. Edit: I forgot to ask the actual question. What am I doing wrong here? Is it some syntax I am unaware of?</p>
<pre><code>#!/usr/bin/python
import sys
import os
import math

data = sys.argv[2]
b = sys.argv[1]

bfile = open(b, "r")
for barcode in bfile:
        barcode = barcode.strip()
        print "barcode: %s" %barcode
        outfname = "%s.%s.fasta" % (data, barcode)
        print outfname
        outf = open(outfname,"w")
        handle = open(data, "r")
        for line in handle:
                linearr = line.split()
                sid = linearr[0]
                seq = linearr[1]
                potential_barcode = seq[0:len(barcode)]
                if potential_barcode == barcode:
                        outseq = line.replace(potential_barcode, "", 1)
                        newseq = outseq.split(' ',1)[-1].strip()
                        sys.stdout.write(newseq)
                        outf.write("&gt;%s\n%s\n" % (sid,newseq))
        gamma = outfname + ".mafft"
        delta = gamma + ".stock"

        q =  "mafft %s &gt; %s" % (outfname, gamma)
        os.system(q)

        qq = "fasta_to_stockholm %s &gt; %s" % (gamma, delta)
        os.system(qq)

        qqq = "quicktree -out m %s" % (delta)
        os.system(qqq)

        handle.close()
        outf.close()
bfile.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>It has nothing to do with using <code>os.system()</code> instead of <code>subprocess</code>.
The problem is that you are not closing the <code>outfname</code> file before running the program.  Move the closes to <strong>before</strong> the <code>os.system()</code> call:</p>
<pre><code>    handle.close()
    outf.close()

    gamma = outfname + ".mafft"
    delta = gamma + ".stock"

    q =  "mafft %s &gt; %s" % (outfname, gamma)
    os.system(q)
</code></pre>
<p>The input file to <code>mafft</code> (<code>outfname</code>) is empty because the buffers have not been flushed, you are "suffering from buffering".</p>
<p>I would consider what everyone has said about using <code>subprocess</code>, but <em>after</em> you get this working!  Only change one thing at a time!</p>
</div>
<span class="comment-copy">Use subprocess and redirect to a file object</span>
<span class="comment-copy">@PadraicCunningham   So instead of os.system() use subprocess()?</span>
<span class="comment-copy">No.  <a href="http://docs.python.org/3/library/subprocess.html" rel="nofollow noreferrer">Read the manual</a>.</span>
<span class="comment-copy">It is not  a literal swap, the code will be different but it is the correct way to do it</span>
<span class="comment-copy">If the .mafft is being created, then the shell is running.   I don't think its an issue with <code>os.system</code> but with your mafft program.  Did you check the return code from <code>os.system()</code>?</span>
<span class="comment-copy">The changes you suggested are working perfectly. I have run into a bit of a snag with one of the stockholm translations but I just fixed it by clearing the old files. Thank you!</span>
