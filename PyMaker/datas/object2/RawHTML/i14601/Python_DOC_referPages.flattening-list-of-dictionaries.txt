<div class="post-text" itemprop="text">
<p>I have a list of dictionaries, which may or may not have similar keys, and I want to flatten the list into a single dictionary, with a list type for values.</p>
<p>An example of this as follows:</p>
<pre><code>data =  [{'category': u'Non-profit organization', 'categories': [u'Theater',
      u'Bar', u'Concert Venue']}, {'category': u'Non-profit organization', 
      'categories': [u'Business Services', u'College &amp; University']}]
</code></pre>
<p>This should become the following:</p>
<pre><code>print result
result = {'category': [u'Non-profit organization', u'Non-profit 
      organization'], 'categories': [u'Theater', u'Bar', u'Concert Venue',       
      u'Business Services', u'College &amp; University']]}
</code></pre>
<p>As you can see, anything that is a string value in the initial data should be added as a value within a list. Anything that is held in list type in the initial dictionary should be added it its key, but to create a flattened list.</p>
<p>Clearly a simple solution is to <code>for loop</code> through it all and append values, but am looking for a simpler solution.</p>
</div>
<div class="post-text" itemprop="text">
<p>Use a <a href="https://docs.python.org/3/library/collections.html#collections.defaultdict" rel="nofollow"><code>defaultdict(list)</code></a>:</p>
<pre><code>from collections import defaultdict

res = defaultdict(list)
for dic in data:
    for key, value in dic.items():
        old_value = res[key]
        if isinstance(value, list):
            old_value.extend(value)
        else:
            old_value.append(value)

        # alternatively:
        old_value += [value] if not isinstance(value, list) else value
</code></pre>
<p>The reasoning is: in the end you want all values to be <code>list</code>s. The difference is that values that originally where lists should be joined together (and <code>list.extend</code> does that) while other values should be inserted in a new list (as in <code>list.append</code>).</p>
<hr/>
<p>Also, there is no built-in method nor class in the <code>collections</code> module that does this automatically, so I believe the above is probably "optimal" as far as code dimension, readability and efficiency are considered.</p>
</div>
<div class="post-text" itemprop="text">
<p>In additional previous answer (sorry, I haven't enough reputation to write a comment) you need to check if value in <code>res</code> otherwise you will have repeat values:</p>
<pre><code>{'category': [u'Non-profit organization', u'Non-profit organization'], 'categories': [u'Theater', u'Bar', u'Concert Venue', u'Business Services', u'College &amp; University']}
</code></pre>
<p>twice <code>u'Non-profit organization'</code></p>
</div>
<span class="comment-copy">Thanks - I was thinking along this, but wondered if there was something even simpler. Just as an improvement, by stating the defaultdict, we have no reason to assign the old_val variable, as we can directly extend and append to the dictionart</span>
<span class="comment-copy">thanks - I actually want repeats, so good spot!</span>
