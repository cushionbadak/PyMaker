<div class="post-text" itemprop="text">
<p>Based on this tutorial : <a href="https://openpyxl.readthedocs.org/en/latest/usage.html" rel="nofollow">LINK</a> we have this structure:</p>
<pre><code>from openpyxl import Workbook
from openpyxl.compat import range

wb = Workbook()
ws = wb.active

for row in range(1,3):
    ws.append(range(100))

wb.save(finename ='mtest2.xlsx')
</code></pre>
<p>This returns below error for <code>ws.append(range(100))</code>:</p>
<pre><code>TypeError: list_or_dict must be a list or a dict 
</code></pre>
<p>What is the problem?</p>
</div>
<div class="post-text" itemprop="text">
<p>Evidently the argument to <code>ws.append</code> must be either a dictionary or a list. Presumably you're using Python 3.x, where <a href="https://docs.python.org/3/whatsnew/3.0.html#views-and-iterators-instead-of-lists" rel="nofollow"><code>range</code> no longer returns a list</a> (it now behaves like Python 2.x's <code>xrange</code>).</p>
<p>The simplest fix is to explicitly convert the <code>range</code> into a <code>list</code>:</p>
<pre><code>for row in range(1, 3):
    ws.append(list(range(100)))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>As @jonrsharpe notes, you cannot use range like this. A range in Python is essentially for looping over only. You can convert it to a list: <code>list(range(100))</code> if you really need the values explicitly.</p>
</div>
<span class="comment-copy">Which part don't you understand? Presumably you're using Python 3.x, where <a href="https://docs.python.org/3/whatsnew/3.0.html#views-and-iterators-instead-of-lists" rel="nofollow noreferrer"><code>range</code> doesn't return a <code>list</code></a>, hence the message you're being given. Try <code>list(range(100))</code>.</span>
<span class="comment-copy">Thank you. please add your answer.</span>
<span class="comment-copy">@CharlieClark looking at <a href="http://openpyxl.readthedocs.org/en/stable/api/openpyxl.worksheet.html?highlight=append#openpyxl.worksheet.worksheet.Worksheet.append" rel="nofollow noreferrer">the documentation</a>, it even notes that <i>iterable</i> includes <i>range</i>, but then finally adds that this would be a <code>TypeError</code>. In fact the <a href="http://openpyxl.readthedocs.org/en/stable/_modules/openpyxl/worksheet/worksheet.html#Worksheet.append" rel="nofollow noreferrer">source code</a> seems to handle <code>range</code>, so now I'm confused - is this a different version?</span>
<span class="comment-copy">Thank you for answer, but <code>range(1,3)</code> doesn't work! for every value of first element of range, it starts from first row. Why!?</span>
<span class="comment-copy">@user2991243 from the code provided, I can't tell. You're not actually using <code>row</code> in the example, so it might as well read <code>for _ in range(2):</code>. Note that indices in Python are zero-based, that might be something to do with it.</span>
<span class="comment-copy">"A range in Python is essentially for looping over only." True-ish in Python 3, not in Python 2, where the range function returns an actual list object.</span>
