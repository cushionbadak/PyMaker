<div class="post-text" itemprop="text">
<p>I am capturing a packet from the network and trying to parser it into my python program and display the source MAC, destination MAC and Protocol each packet in it consists of. </p>
<p>Error occurred in last line: "print("Protocol:",str[protocol],"Time to live:",str[timetolive])"</p>
<p>My code:</p>
<pre><code>#!usr/bin/python

import pcapy

from struct import*

pcap_file=pcapy.open_offline("single.pcap")

count=1

while count:
    print("Packet #:",count)

    count=count+1
    (header,payload)=pcap_file.next()

    l2hdr=payload[:14]
    l2data=unpack("!6s6sH",l2hdr)

    srcmac="%.2x:%.2x:%.2x:%.2x:%.2x:%.2x:" %(ord(l2hdr[0]),ord(l2hdr[1]),ord(l2hdr[2]),ord(l2hdr[3]),ord(l2hdr[4]),ord(l2hdr[5]))
    dstmac="%.2x:%.2x:%.2x:%.2x:%.2x:%.2x:" %(ord(l2hdr[6]),ord(l2hdr[7]),ord(l2hdr[8]),ord(l2hdr[9]),ord(l2hdr[10]),ord(l2hdr[11]))

    print("source MAC:",srcmac,"Destination MAC:",dstmac)

    ipheader=unpack('!BBHHHBBH4s4s',payload[14:34])
    timetolive=ipheader[5]
    protocol=ipheader[6]

    print("Protocol:",str[protocol],"Time to live:",str[timetolive])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Seeems like you are using <code>[]</code> instead of <code>()</code> for <code>str</code> function,</p>
<p>use <code>str(protocol)</code>, <code>str(timetolive)</code>; check <a href="https://docs.python.org/3/library/stdtypes.html#str" rel="nofollow noreferrer">str</a>, modify code to <code>str(protocol.encode())</code>, <code>str(timetolive.encode())</code> for python3 compatibility.</p>
</div>
<div class="post-text" itemprop="text">
<p>Change the last line to:</p>
<pre><code>print("Protocol:",str(protocol),"Time to live:",str(timetolive))
</code></pre>
<p>You are trying to access the <code>str</code> function with square brackets, which isn't going to work. </p>
</div>
<span class="comment-copy">Please elaborate and style the code bit into code style</span>
<span class="comment-copy">@AlexFung I am capturing a packet from the network and trying to parser it into my python program and display the source MAC, destination MAC and Protocol each packet in it consists of..... However this is the complete code that I have written:</span>
<span class="comment-copy">@PrashuPratik please include what you said in the comment in your question as well.also, fix the code tag.</span>
<span class="comment-copy">@PrashuPratik include traceback including line where error occured</span>
<span class="comment-copy">@sideffect0 Yes done that... can you please tell me how to rectify the error?</span>
<span class="comment-copy">thank you for pointing out the general mistake that I had made in the code. However, I am getting another struct.error in line "   l2data=unpack("!6s6sH",l2hdr)   " .....the error states that "unpack requires a string argument of length 14" ......What should I change the value from 6s6sH to, to make the length 14? @sideffect0</span>
<span class="comment-copy">@PrashuPratik include this in question so that others can answer or create another question</span>
