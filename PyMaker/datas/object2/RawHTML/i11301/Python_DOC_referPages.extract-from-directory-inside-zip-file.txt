<div class="post-text" itemprop="text">
<p>My existing code (a section) is loacted at the bottom of this post.</p>
<p>What I would like to do is extract all of the files from a directory <em>inside</em> of a zip file. Not the whole contents of a zip file, just the files in a directory (<code>/theme_files/</code>) that's inside of a zip. I have already imported the neccesary libraries.</p>
<p>Extract the files from <code>[filename].tpk/theme_files</code> into <code>./workspace/[output]/</code></p>
<p>(<code>.tpk</code> = <code>.zip</code>)</p>
<pre><code>theme_zip = zipfile.ZipFile(current_dir + "/themes/" + theme_name + ".tpk", 'r')
theme_zip.extractall(output_dir)
theme_zip.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>for item in (f for f in theme_zip.filelist if 'theme_files/' in f.filename):
    theme_zip.extract(item, output_dir)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You could use <a href="https://docs.python.org/3/library/zipfile.html#zipfile.ZipFile.extractall" rel="nofollow noreferrer"><code>ZipFile.extractall()</code></a> and set the <code>path</code> and <code>members</code> args using a list comprehension on the filenames returned from <a href="https://docs.python.org/3/library/zipfile.html#zipfile.ZipFile.namelist" rel="nofollow noreferrer"><code>ZipFile.namelist()</code></a>:</p>
<pre><code>import zipfile 

output_dir = './workspace/[output]/'
file = current_dir + "/themes/" + theme_name + ".tpk"

with zipfile.ZipFile(file, 'r') as f:
    files = [n for n in f.namelist() 
                   if n.startswith('/theme_files/') and not n.endswith('/')]
    f.extractall(path=output_dir , members=files)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Search the file names in the specific subfolders with regex. + Extract them file by file:</p>
<pre><code>with open('&lt;file-name&gt;.zip', 'rb') as f:
    zf = zipfile.ZipFile(f)
    for file in [m.group() for m in (re.search(r'/theme/(.+)', file) for file in file_list) if m]:
        zf.extract(file)
</code></pre>
</div>
<span class="comment-copy">This only works to copy the <code>theme_files</code> folder into the output. any idea how to extract the content of <code>theme_files</code> into the output?</span>
<span class="comment-copy">It should extract the folder and everything it contains. Is that not happening for you?</span>
<span class="comment-copy">Nope. It extracts the whole folder and puts it in <code>output_dir</code></span>
