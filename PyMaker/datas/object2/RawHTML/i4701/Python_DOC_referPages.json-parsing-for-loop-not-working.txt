<div class="post-text" itemprop="text">
<p>I am trying to parse below json file (data.json) &amp; also trying to handle exception when I get an empty response (data_empty.json) without any data_block key.</p>
<p>The check_key &amp; for loop seems to be not doing anything, but the print commands works.</p>
<p>--data.json </p>
<pre><code>{
  "response": {
    "numFound": 1,
    "data_block": [
      {
        "Number": "11097",
        "ID": -61000,
        "Version": "18",
        "Sequence": [
          "1",
          "2",
          "3"
        ],
        "Status": [
          "Booked",
          "Canceled",
          "Canceled"
        ],
        "Name": "abc",
        "EmailAddress": "abc@test.com"
      },
      {
        "Number": "00001",
        "ID": -1000,
        "Version": "1",
        "Sequence": [
          "1"
        ],
        "Status": [
          "Booked"
        ],
        "Name": "xyz",
        "EmailAddress": "xyz@test.com"
      }

    ]
  }
}
</code></pre>
<p>--data_empty.json</p>
<pre><code>{
  "response": {
    "numFound": 0,
    "data_block": []
  }
}
</code></pre>
<p>I have below code to parse the json (data.json) , only the print works but I am not able to get the for loop work.</p>
<pre><code>import json
from pprint import pprint
import csv

data = json.load(open('data.json'))
#data = json.load(open('data_empty.json'))
#pprint(data)

output_file_name = 'api_rspns.csv'


#create out file
f = open(output_file_name,'w')
writer = csv.writer(f,delimiter = '~')
headers = ['ORDER_NBR','ORDER_STATUS','EMAIL']
writer.writerow(headers)


print(data['response']['data_block'][0]['Number'])
print(data['response']['data_block'][0]['Status'])
print(data['response']['data_block'][0]['EmailAddress'])

print(data['response']['data_block'][1]['Number'])
print(data['response']['data_block'][1]['Status'])
print(data['response']['data_block'][1]['EmailAddress'])


#check for KeyError ,only parse if ['data_block'] present
try:
    check_key = data['response']['data_block'][0]
except KeyError:
    #continue

    for trip in check_key:
        row = []
        row.append(trip['Number'])
        #row.append(trip["Status"])
        writer.writerow(row)
f.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Below code works now (with an empty response as well), thank you for help</p>
<pre><code>#check for KeyError ,only parse if ['data_block'] present
#try:
#    check_key = data['response']['data_block'][0]
#except KeyError:
    #continue

for trip in data['response']['data_block']:
    row = []
    row.append(trip['Number'])
    row.append(trip["Status"])
    writer.writerow(row)
f.close()
</code></pre>
</div>
<span class="comment-copy">I think it's because you have the <code>for trip in check_key:</code> loop indented to the same level as the <code>#continue</code> under the <code>except KeyError:</code> clause. Try un-indenting it one level so it's at the same level as the <code>try/except</code>. Off topic, but you should really learn how to use the <a href="https://docs.python.org/3/reference/compound_stmts.html#with" rel="nofollow noreferrer"><code>with</code></a> statement for file handling because it will automatically close open files for you, even when there's an error.</span>
