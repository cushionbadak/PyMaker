<div class="post-text" itemprop="text">
<p>I'm trying capture all the text across multiple lines of text using Python's regex package. The text I have is, as you'll notice it's SQL. Why that's relevant is that I want to capture everything between the "SELECT" phrase and the "FROM" phrase. In the example below I've got 3 items, column1,column2,sum(column3) but I could have many more. 
Also, I only know that I will likely have a <code>\n</code> or a <code>\r</code> but I don't know if it will be one or more. </p>
<pre><code>SELECT
a11.Column1
, a12.Column2
,SUM(Column3)
FROM DB.MyFactTable a11
LEFT OUTER JOIN DB.MyDimTable_1 a12 ON 
(a11.k1 = a12.k1 AND a11.k2 = a12.k2 AND a12.k3 = a11.k3)
LEFT OUTER JOIN DB.MyDimTable_2 a13 ON 
(a11.k1 = a12.k2 AND a11.k4 = a12.k4 AND a12.k5 = a11.k5)
WHERE a11.Column_N IN (X1, X2, X3, X4)
GROUP BY 1,2
</code></pre>
<p>My regex thus far has been </p>
<pre><code>rgx_pat = (?&lt;=SELECT)(\s)*.*\n.*
result = re.findall(rgx_pat,my_sql_above,re.MULTILINE)
</code></pre>
<p>Thanks in advance for the help. </p>
</div>
<div class="post-text" itemprop="text">
<p>I think your problem is just that you don't know about the <a href="https://docs.python.org/3/library/re.html#re.DOTALL" rel="nofollow noreferrer"><code>DOTALL</code></a> flag.</p>
<p>If you're trying to find a bunch of anything including newlines, you don't need to try to figure out a query involving everything-but-newlines plus newlines, just use <code>DOTALL</code> and now <code>.</code> means anything including newlines.</p>
<p>So:</p>
<pre><code>query = '''SELECT
a11.Column1
, a12.Column2
,SUM(Column3)
FROM DB.MyFactTable a11
LEFT OUTER JOIN DB.MyDimTable_1 a12 ON 
(a11.k1 = a12.k1 AND a11.k2 = a12.k2 AND a12.k3 = a11.k3)
LEFT OUTER JOIN DB.MyDimTable_2 a13 ON 
(a11.k1 = a12.k2 AND a11.k4 = a12.k4 AND a12.k5 = a11.k5)
WHERE a11.Column_N IN (X1, X2, X3, X4)
GROUP BY 1,2
'''

rgx_pat = re.compile(r'SELECT\s(.*?)\sFROM', re.DOTALL)
result = rgx_pat.findall(query)
</code></pre>
<p>And now <code>result</code> will be:</p>
<pre><code>['a11.Column1\n, a12.Column2\n,SUM(Column3)']
</code></pre>
<p>I'm not sure whether you want <code>.*?</code> or <code>.*</code>, and whether you want to enforce whitespace after <code>SELECT</code> and before <code>FROM</code>, so I guessed at what you're trying to do.</p>
</div>
<span class="comment-copy">Why not just <code>SELECT(.*)FROM</code> with <code>re.DOTALL</code>? Or maybe <code>SELECT(.*?)FROM</code>, and maybe you want to require some whitespace around the keywords, etc., but whichever one you want, hard to get simpler than that.</span>
<span class="comment-copy">If you have multiple selets in your file the <code>re.DOTALL</code> needs to be guareded with a negative lookahead of <code>SELECT</code> so in does not capture from first to last (or maybe <code>(.*?)</code>) would work as well).</span>
<span class="comment-copy">@PatrickArtner You don't need negative lookahead if you want to switch the greediness, just use <code>?</code>.</span>
<span class="comment-copy">Thanks guys for the input. How did I miss that? This was super helpful.</span>
<span class="comment-copy">For novices, or people who just donâ€™t use regex that often and have to refresh themselves each time, <code>MULTILINE</code> sure sounds like what you need more than <code>DOTALL</code>, until you read the descriptions carefully or play with them in an interactive tester.</span>
<span class="comment-copy">Thank you @abarnert this is exactly what I was looking for. This was extremely helpful.</span>
