<div class="post-text" itemprop="text">
<p>Well i have a question that i feel i've been answered several times, from what i found here. However, as a newbie, i can't really understand how to perform a really basic operation.</p>
<p>Here's the thing :</p>
<ul>
<li><p>i have an <code>.xls</code> and when i use xlrd to get a value i'm just using 
<code>sh.cell(0,0)</code> (assuming that sh is my sheet);</p></li>
<li><p>if what is in the cell is a string i get something like <code>text:u'MyName'</code> and i only want to keep the string <code>'MyName'</code>;</p></li>
<li><p>if what is in the cell is a number i get something like <code>number:201.0</code> and i only want to keep the integer <code>201</code>.</p></li>
</ul>
<p>If anyone can indicate me what i should to only extract the value, formatted as i want, thank you.</p>
</div>
<div class="post-text" itemprop="text">
<p>sh.cell(x, y) returns an instance of the class Cell.  When you print sh.cell(x,y) you are returning the <strong>repr</strong> function of the class (so it prints type:value).</p>
<p>you should try:</p>
<pre><code>cell = sh.cell(x,y)
print(cell.value)
</code></pre>
<p>I cannot test this since I don't have xlrd but, I think it will work given the documentation: <a href="https://secure.simplistix.co.uk/svn/xlrd/trunk/xlrd/doc/xlrd.html#sheet.Cell-class">https://secure.simplistix.co.uk/svn/xlrd/trunk/xlrd/doc/xlrd.html#sheet.Cell-class</a></p>
</div>
<div class="post-text" itemprop="text">
<p>You can also just extract values using xlrd rather than getting the full Excel cell returned:</p>
<pre><code>book = xlrd.open_workbook('example.xls')
first_sheet = book.sheet_by_index(0)
print first_sheet.row_values(0)
</code></pre>
<p>Gets you the values of the first row in the first sheet.  </p>
<p>You can use slices with the row_values (and similarly for columns).  So to get values from an entire sheet:</p>
<pre><code>cells = []
for i in range(first_sheet.nrows):
    cells.append(first_sheet.row_values(rowx=i,start_colx=0,end_colx=None))
</code></pre>
<p>There may be more elegant ways of using xlrd - but that worked for me.  </p>
</div>
<div class="post-text" itemprop="text">
<p>The correct answer to this is to simply use the <code>Cell.value</code> function. This will return a number or a Unicode string depending on what the cell contains.</p>
</div>
<div class="post-text" itemprop="text">
<p>This will give you the value of the contents of a cell in Excel.</p>
<pre><code>    var = sh.cell(x,y)
    print var.value
</code></pre>
<p>But the type of this data is still 'unicode'. To convert into a string (ascii):</p>
<pre><code>    var.value.encode('ascii','ignore')
</code></pre>
</div>
<span class="comment-copy">also, it will return the unicode version of the string in the value attribute, so you will probably need to decode that if you want just 'MyName' depending on what you want to do with u'MyName'.</span>
<span class="comment-copy">Thank you a lot. It works!</span>
<span class="comment-copy">@comamitc: If you've got unicode and you want bytes, you <i>encode</i>, not <i>decode</i>. But for many things it probably makes more sense to use unicode.</span>
<span class="comment-copy">@ThomasK: correct you are!  I cannot edit my type-o in comments though.</span>
<span class="comment-copy">thank you, it works for me +1</span>
