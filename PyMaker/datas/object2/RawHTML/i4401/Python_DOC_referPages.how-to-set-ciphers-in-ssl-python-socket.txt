<div class="post-text" itemprop="text">
<p>I want to create my own list of ciphersuites using the cipher strings. The following code works if I put only one string in the <code>set_ciphers</code> function. But I want a customized list of ciphers. There is other format like: <code>ALL:!COMPLEMENTOFDEFAULT:!eNULL</code> but this does not do the purpose I need. I have a customized list of different ciphers that I can not combine using the second format. </p>
<pre><code>import socket, ssl
import pprint

context = ssl.create_default_context()

cipher = ['DHE-RSA-AES128-SHA', 'DHE-RSA-AES256-SHA', 'ECDHE-ECDSA-AES128-GCM-SHA256']
context.set_ciphers(cipher)

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

domain = 'google.com'

sslSocket = context.wrap_socket(s, server_hostname = domain)

sslSocket.connect((domain, 443))
sslSocket.close()
print('closed')
</code></pre>
<p>The function <code>set_ciphers</code> can be found <a href="https://docs.python.org/3/library/ssl.html#ssl.SSLContext.set_ciphers" rel="nofollow noreferrer">here</a>.</p>
</div>
<div class="post-text" itemprop="text">
<p>I could include more than one cipher simple by separating the ciphers with <code>:</code> and send all the ciphers as one string.</p>
<pre><code>cipher = 'DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA:ECDHE-ECDSA-AES128-GCM-SHA256'
context.set_ciphers(cipher)
</code></pre>
<p>This way, the client offers all the ciphers. You can make sure from this by calling <code>context.get_ciphers()</code> and you will see only the ciphers you inserted using <code>set_cipher</code>. </p>
</div>
<div class="post-text" itemprop="text">
<p>Even if <code>ssl.SSLContext.get_ciphers()</code> returns the ciphers in a friendly format (a list of dictionaries), the other way around, things don't work quite the same.</p>
<p>According to <a href="https://docs.python.org/3/library/ssl.html#ssl.SSLContext.set_ciphers" rel="nofollow noreferrer">[Python 3]: SSLContext.<strong>set_ciphers</strong>(<em>ciphers</em>)</a>:</p>
<blockquote>
<p>Set the available ciphers for sockets created with this context. It should be a string in the <a href="https://wiki.openssl.org/index.php/Manual:Ciphers(1)#CIPHER_LIST_FORMAT" rel="nofollow noreferrer">OpenSSL cipher list format</a>.</p>
</blockquote>
<p>Following <a href="https://www.openssl.org/docs/manmaster/man1/ciphers.html#CIPHER-LIST-FORMAT" rel="nofollow noreferrer">[OpenSSL]: CIPHER LIST FORMAT</a>:</p>
<blockquote>
<p>The cipher list consists of <strong>one or more cipher strings separated by colons</strong>. Commas or spaces are also acceptable separators but colons are normally used.</p>
</blockquote>
<p>Therefore, strings like <em>'DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA:ECDHE-ECDSA-AES128-GCM-SHA256'</em> are to be used.</p>
</div>
