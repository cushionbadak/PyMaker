<div class="post-text" itemprop="text">
<p>I am working with Flask, WTForms and Flask-WTF to save a file but the file is always store as an empty file. It doesn't show any error.</p>
<p><strong>Form:</strong></p>
<pre><code>from flask_wtf import FlaskForm
from flask_wtf.file import FileField
from wtforms import StringField, SubmitField

class UserForm(FlaskForm):
    username = StringField('u', validators=[InputRequired()])
    email = StringField('e', validators=[InputRequired()])
    password = StringField('c', validators=[InputRequired()])
    signature = FileField('s')
    save = SubmitField('a')
</code></pre>
<p><strong>Flask Route / Function:</strong></p>
<pre><code>@bp.route('/manage/user', methods=['GET', 'POST'])
@login_required
def manage_user():
    form = UserForm()
    action = 'create'

    try:        
        if form.validate_on_submit():
            if form.save.data:
                print('request.method', request.method)
                print('request.args', request.args)
                print('request.form', request.form)
                print('request.files', request.files)
                # archivo = request.files['signature']
                # archivo = request.files.items()[0]
                archivo = form.signature.data
                print(type(archivo))
                if archivo:
                    image_data = archivo.read()
                    basedir = os.path.abspath(os.path.dirname(__file__))
                    filename = secure_filename(form.username.data+'.png')
                    full_dir = os.path.join(basedir, '..\\static\\img', filename)
                    print(sys.getsizeof(archivo))
                    archivo.save(full_dir) 
                return redirect(url_for('main.manage'))
    except Exception as e:
        print(e)

    return render_template('manage_user.html', title=('Admon'), form=form, action=action)
</code></pre>
<p><strong>HTML</strong></p>
<pre><code>&lt;form action="" method="POST" role="form" class="form-horizontal" enctype="multipart/form-data"&gt;
    {{ form.csrf_token() }}
    &lt;div class="form-group"&gt;
        &lt;label class="control-label col-sm-3"&gt;Firma&lt;/label&gt;
        &lt;div class="col-sm-6"&gt;
            {% if action=='create' %}
            &lt;!-- Other fields --&gt;
            {{ form.signature(placeholder="Firma", type="file", class="form-control", accept="image/*", required="True") }}
            &lt;img id="firmaimg" src="{{ url_for('static', filename='img/firma130x50_dummy.png') }}" alt="Firma" /&gt;
            {{ form.save(class="btn btn-success btn-md") }}
            {% endif %}
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/form&gt;
</code></pre>
<p>The print statements show this: 
<a href="https://i.stack.imgur.com/V4Vkc.png" rel="nofollow noreferrer"><img alt="Print results" src="https://i.stack.imgur.com/V4Vkc.png"/></a></p>
<p>The order of the prints is:</p>
<ol>
<li>Request method </li>
<li>Request Arguments </li>
<li>Request Form </li>
<li>Request Files </li>
<li>Type of archivo variable </li>
</ol>
<p>Size of archivo is always 32, it doesn't matter what image I upload, is always 32, so from that point is already empty, haven't figure out why is coming empty. I'm following the examples.</p>
<p><a href="https://flask-wtf.readthedocs.io/en/latest/form.html" rel="nofollow noreferrer">https://flask-wtf.readthedocs.io/en/latest/form.html</a></p>
</div>
<div class="post-text" itemprop="text">
<p>Firstly, the size of your file is always 32 because sys.getsizeof() returns the amount of memory in bytes Python uses for that object, as explained in the <a href="https://docs.python.org/3/library/sys.html#sys.getsizeof" rel="nofollow noreferrer">docs</a>.</p>
<p>To print the actual file size you can use:</p>
<pre><code>os.path.getsize('path')
</code></pre>
<p>Using it, you should see that the printed file size is effectively 0.</p>
<p>Secondly, by removing:</p>
<pre><code>image_data = archivio.read()
</code></pre>
<p>you should be able to successfully save the file in the desired location.</p>
<p>I'm not sure what you are trying to accomplish with archivio.read().</p>
</div>
<span class="comment-copy">ok, for the first part, the size, does that give me the size of the bytes object? Or is it the size of the element in the local directory?</span>
<span class="comment-copy">The second part, Thank you SO much. I was just testing a lot of things and that always stayed there. You saved my life.</span>
