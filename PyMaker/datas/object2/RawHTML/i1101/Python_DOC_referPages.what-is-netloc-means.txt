<div class="post-text" itemprop="text">
<p>I'm learning to make login function with <strong>Flask-login</strong>, and I'm facing with this code in my tutorial that I'm following:</p>
<pre><code>@app.route('/login', methods = ['GET', 'POST'])
def login():
    if current_user.is_authenticated:
        return redirect(url_for('index'))
    form = LoginForm()
    if form.validate_on_submit():
        user = User.query.filter_by(username=form.username.data).first()
        if user is None or not user.check_password(form.password.data):
            flash('Invalid username or password')
            return redirect(url_for('login'))
        login_user(user, remember=form.remember_me.data)
        next_page = request.args.get('next')
        if not next_page or url_parse(next_page).netloc != '': # what is it means in this line..?
            next_page = url_for('index')
        return redirect(next_page)
    return render_template('login.html', title='Sign In', form=form)
</code></pre>
<p>But I'm not sure what's the code above that I commented means..?, especially in <strong>netloc</strong> word, what is that..?, I know that is stand for <strong>network locality</strong>, but what is the purpose on that line..?</p>
</div>
<div class="post-text" itemprop="text">
<p>From <a href="https://tools.ietf.org/html/rfc1808.html#section-2.1" rel="nofollow noreferrer"><code>RFC 1808, Section 2.1</code></a>, every URL should follow a specific format:</p>
<pre><code>&lt;scheme&gt;://&lt;netloc&gt;/&lt;path&gt;;&lt;params&gt;?&lt;query&gt;#&lt;fragment&gt;
</code></pre>
<p>The <strong>netloc is what the first level domain (FLD) represents</strong>, which comes before the path, and after the scheme. For example you have the following URL:</p>
<pre><code>http://www.example.com/index?search=src
</code></pre>
<p>Here, <code>www.example.com</code> is your <strong>netloc</strong>, while <code>index</code> is the path, <code>search</code> is the query parameter, and <code>src</code> is the value being passed along the parameter <code>search</code>.</p>
<p>Now coming to your code, the <code>if</code> statement checks whether or not the <code>next_page</code> exists and whether the <code>next_page</code> has a netloc so that the user could be redirected to <code>index</code> (default) page of your site.</p>
</div>
<span class="comment-copy">Although the function you are calling is from werkzeug. You can probably look to the standard library for the definition of netloc. See <a href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlparse" rel="nofollow noreferrer">urllib.parse.urlparse</a>. netloc is the name of the server (ip address or host name).</span>
