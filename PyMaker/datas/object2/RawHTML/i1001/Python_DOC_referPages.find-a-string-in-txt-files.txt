<div class="post-text" itemprop="text">
<p>I need to find all names of files that contain the string "TeNam":</p>
<pre><code>import os
import sys

def find_value(fname):
    value = 0
    with open(fname, encoding='cp866') as fn:
        try:
            for i in fn:
                if 'TeNam' in i:
                    print(fname)
        except IndexError:
            pass
    return {fname}

def main():
    dirname = ('H:\1\3')
    os.chdir(dirname)
    res = {}
    for i in os.listdir(dirname):
        res.update(find_value(i))
    print('Filename is: ')

if __name__ == "__main__":
    main()
</code></pre>
<p>But, there's an error:</p>
<pre><code>C:\Users\Anton\AppData\Local\Programs\Python\Python36-32\python.exe "C:/Users/Anton/PycharmProjects/Работа с файловой системой/Перебор файлов из папки.py"
Traceback (most recent call last):
  File "C:/Users/Anton/PycharmProjects/Работа с файловой системой/Перебор файлов из папки.py", line 21, in &lt;module&gt;
    main()
  File "C:/Users/Anton/PycharmProjects/Работа с файловой системой/Перебор файлов из папки.py", line 18, in main
    res.update(find_value(i))
ValueError: dictionary update sequence element #0 has length 35; 2 is required

Process finished with exit code 1
</code></pre>
<p>Could you help me with code?</p>
</div>
<div class="post-text" itemprop="text">
<p><em>find_value</em> returns a <em>set</em> (<a href="https://docs.python.org/3/tutorial/datastructures.html#sets" rel="nofollow noreferrer">[Python 3]: Sets</a>).</p>
<p><em>res</em> is a <strong><em>dictionary</em></strong> (<strong>not</strong> the empty <em>set</em> - as I think you intended). Its <em>update</em> method (<a href="https://docs.python.org/3/library/stdtypes.html#dict.update" rel="nofollow noreferrer">[Python 3]: <strong>update</strong>(<em>[other]</em>)</a>) doesn't work with the provided <em>set</em> (well, unless its <em>string</em> element has a length of 2).</p>
<p>Example:</p>
<blockquote>
<pre><code>&gt;&gt;&gt; d = {}
&gt;&gt;&gt; type(d)
&lt;class 'dict'&gt;
&gt;&gt;&gt; t = {"abc"}
&gt;&gt;&gt; type(t)
&lt;class 'set'&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; d.update(t)
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
ValueError: dictionary update sequence element #0 has length 3; 2 is required
&gt;&gt;&gt;
&gt;&gt;&gt; d = set()
&gt;&gt;&gt; d.update(t)
&gt;&gt;&gt; d
{'abc'}
&gt;&gt;&gt; type(d)
&lt;class 'set'&gt;
</code></pre>
</blockquote>
<p>As seen from above, the fix would be to properly initialize <em>res</em> (as a <em>set</em>):</p>
<pre><code>res = set()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Split to 3 parts:</p>
<ol>
<li>Check each file</li>
<li>Check the entire dir</li>
<li>Call (2) and get results.</li>
</ol>
<p>Something like:</p>
<pre><code>def is_file_match(file_name, match_word="bla"):
   try:
        with open(file__name_path) as f:
            file_lines = f.readlines()
            return any(match_word in l for l in file_lines) # with case sensitivity
    except OSError:
         return false

def get_all_files(dir_name):
      return filter(is_file_match, os.listdir(dir_name)

res = get_all_files(requested_dir)
</code></pre>
</div>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/14302248/dictionary-update-sequence-element-0-has-length-3-2-is-required">dictionary update sequence element #0 has length 3; 2 is required</a></span>
