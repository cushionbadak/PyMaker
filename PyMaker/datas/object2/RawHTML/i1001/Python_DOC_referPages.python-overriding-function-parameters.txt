<div class="post-text" itemprop="text">
<p>Writing a cli function that should do the following:</p>
<p>In case, the function parameters are not set (I get them from docopt),
I would like to look them up from environment.
The following does not work due to fast loading in functions:</p>
<pre><code>def my_function(a=None, b=None, c=None):
    for v in ("a", "b", "c"):
        if vars()[v] is None:
            locals()[v] = getenv("env_{}".format(v).upper())
    do_something_with(a, b, c)
</code></pre>
<p>What would be the pythonic way to achieve this?</p>
</div>
<div class="post-text" itemprop="text">
<p>You can do this easily with keyword arguments:</p>
<pre><code>def my_function(**kwargs):
    for var in ('a', 'b', 'c'):
        if kwargs.get(var) is None:
            kwargs[var] = getenv("env_{}".format(v).upper())
    do_something_with(**kwargs)
</code></pre>
<p>If you want to keep the signature, you can create a decorator (<code>functools.wraps</code> takes care of aligning the signatures):</p>
<pre><code>def defaults_from_env(function):
    @functools.wraps(function)
    def wrapper(**kwargs):
        for var in kwargs:
            if kwargs.get(var) is None:
                kwargs[var] = getenv("env_{}".format(var).upper())
        return function(**kwargs)
    return wrapper


@defaults_from_env
def my_function(a=None, b=None, c=None):
    print(a, b, c)
</code></pre>
<p>However, this forces you to name all parameters when calling the decorated <code>my_function</code> (i.e. <code>a=.., b=.., c=..</code>). To avoid this, you could use <a href="https://docs.python.org/3/library/inspect.html#introspecting-callables-with-the-signature-object" rel="nofollow noreferrer"><code>inspect.signature</code></a> to bind the parameters in the wrapper; this would allow you to get the name and value of all parameters, both <code>*arg</code> and <code>**kwarg</code>.</p>
</div>
<span class="comment-copy">Thanks, thought about that. Unfortunately with kwargs I have no control over function params that are passed to the function and i would need to write:  1. a validator (to prevent parameters that are not allowed to be passed) 2. some extra parameter hinting for my ide, 3. I am not able to pass parameters by order</span>
