<div class="post-text" itemprop="text">
<p>This script is a simple while True loop that checks a voltage value and writes a log file. However, I am not able to get the voltage value written in the log.</p>
<p>Simple log files with a text string and date / timestamp work fine but the write fails when I try to use the variable name.</p>
<pre><code>ina3221 = SDL_Pi_INA3221.SDL_Pi_INA3221(addr=0x40)

LIPO_BATTERY_CHANNEL = 1

busvoltage1 = ina3221.getBusVoltage_V(LIPO_BATTERY_CHANNEL)

while True:

    if busvoltage1 &lt;= 3.70:

        with open("/&lt;path&gt;/voltagecheck.log", "a") as f:
                f.write("battery voltage below threshold: " + busvoltage1 + "\n")
                f.write("timestamp: " + time.asctime() + "\n")
                f.write("-------------------------------------------" + "\n")
                f.close()
    else:

        time.sleep(3600)
</code></pre>
<p>I've also tried:</p>
<pre><code>with open("/&lt;path&gt;/voltagecheck.log", "a") as f:
        f.write("battery voltage below threshold: " + str(busvoltage1) + "\n")
        f.write("timestamp: " + time.asctime() + "\n")
        f.write("-------------------------------------------" + "\n")
        f.close()
</code></pre>
<p>Without trying to add the busvoltage1 value to the log, the log is created and the timestamp line works fine. </p>
<p>With the busvoltage1 value, the log is created but nothing is written.</p>
<p>When running this in the terminal, the errors for "str(busvoltage1)" and just the plain "busvoltage1" are:</p>
<p>ValueError: I/O operation on closed file</p>
<p>and</p>
<p>TypeError: cannot concatenate 'str' and 'float' objects</p>
</div>
<div class="post-text" itemprop="text">
<p>The value needs to be formatted as a string before f.write is used.</p>
<p>Added <code>v = str(busvoltage1)</code> and then referenced <code>v</code> in f.write: <code>f.write(battery voltage below threshold: " + v + "\n")</code></p>
<p>This is referenced in the 5th example of 7.2.1 here: <a href="https://docs.python.org/3/tutorial/inputoutput.html#reading-and-writing-files" rel="nofollow noreferrer">https://docs.python.org/3/tutorial/inputoutput.html#reading-and-writing-files</a>. Thanks @PatrickArtner</p>
</div>
<span class="comment-copy"><code>v</code> != <code>f</code>. I'm missing something here, why do you use <code>as v</code>?</span>
<span class="comment-copy">your code is wrongly indented - please fix it</span>
<span class="comment-copy">This will throw an error that <code>f</code> is not defined. Either you have a typo in your question, or you're writing to a completely different file than you think you are. This code cannot behave as you describe.</span>
<span class="comment-copy">@PatrickArtner thank you, your link helped. I was having trouble sifting through python documentation.  I assigned <code>v = str(busvoltage1)</code> then was able to use <code>f.write(battery voltage below threshold: " + v + "\n")</code></span>
<span class="comment-copy">You can not accept comments - only answers. The question is kindof easy to solve so I just commented to get you on the right track to solve it yourself. if you like you can create an answer yourself in the box below and accept it in 2 days - but there are so many "string formatting gone wrong" questions on SO already that I am not sure it will benefit from another one. Maybe copy the links over from my comment for anybody that finds your selfanswer.</span>
