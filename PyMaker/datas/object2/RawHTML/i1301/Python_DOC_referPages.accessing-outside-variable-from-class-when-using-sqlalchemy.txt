<div class="post-text" itemprop="text">
<p>In the following code snippet:</p>
<pre><code>from flask_sqlalchemy import SQLAlchemy

db = SQLAlchemy()

class Flight(db.Model):
    __tablename__ = "flights"
    id = db.Column(db.Integer, primary_key=True)
    origin = db.Column(db.String, nullable=False)
    destination = db.Column(db.String, nullable=False)
    duration = db.Column(db.Integer, nullable=False)

    def add_passenger(self, name):
        p = Passenger(name=name, flight_id=self.id)
        db.session.add(p)
        db.session.commit()
</code></pre>
<p>why <code>db</code> inside the class can be used as global variable without <code>global</code>? I checked <a href="https://docs.python.org/3/faq/programming.html#what-are-the-rules-for-local-and-global-variables-in-python" rel="nofollow noreferrer">python doc</a> and found:</p>
<blockquote>
<p>In Python, variables that are only referenced inside a function are implicitly global.</p>
</blockquote>
<p>I wonder does this rule apply here? Because <code>db</code> is not only referenced but modified in <code>add_passenger</code> method.</p>
</div>
<div class="post-text" itemprop="text">
<p>You are not assigning anything to the variable <code>db</code> inside any functions. </p>
<p><code>add_passenger</code> is only calling a method. It alters only internal state, not the reference itself. </p>
<p>If you did </p>
<pre><code>db = SQLAlchemy() 
</code></pre>
<p>inside a function then you'd need to use <code>global</code>, otherwise, you'd just get another variable called <code>db</code> at the local scope and using it would not have any effect on the global <code>db</code> object.</p>
</div>
<span class="comment-copy">You are not assigning anything to the variable <code>db</code> inside any functions. <code>add_passenger</code> is only calling a method. It alters only internal state, not the reference itself. If you did <code>db = SQLAlchemy()</code> inside a function then you'd need <code>global</code>.</span>
<span class="comment-copy">That makes sense, thanks!</span>
