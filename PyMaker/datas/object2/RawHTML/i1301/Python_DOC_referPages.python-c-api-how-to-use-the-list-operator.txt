<div class="post-text" itemprop="text">
<p>I have defined a python-type using <code>PyTypeObject</code> etc… and I have defined a <code>.tp_str</code> to support the <code>str(myObj)</code> feature… because my type has also a <strong>[list]</strong> like behavior… I would like to support the <code>list(myObj)</code> feature too. my problem is that I miss a <code>.tp_list</code> entry to support this.</p>
<p>my question… how can I do this?</p>
<p>thanks</p>
</div>
<div class="post-text" itemprop="text">
<p>There's no <code>__list__</code> hook at Python level either. Like implementing the same behavior at Python level, you have to make instances of your class iterable. <code>list(yourobj)</code> will then iterate over your object to gather elements into a list.</p>
<p>The C-level slots corresponding to <code>__iter__</code> and <code>__next__</code> are <a href="https://docs.python.org/3/c-api/typeobj.html#c.PyTypeObject.tp_iter" rel="nofollow noreferrer"><code>tp_iter</code></a> and <a href="https://docs.python.org/3/c-api/typeobj.html#c.PyTypeObject.tp_iternext" rel="nofollow noreferrer"><code>tp_iternext</code></a>, and they work pretty much like <code>__iter__</code> and <code>__next__</code> do. If you haven't written an iterator class manually before, I suggest doing it in Python for practice before doing it in C (and remember that the iterator should be a different object from your list-like object).</p>
<p>Aside from iteration, you should also implement the <a href="https://docs.python.org/3/c-api/typeobj.html#c.tp_as_sequence" rel="nofollow noreferrer">sequence protocol</a> if your object really is supposed to be list-like.</p>
</div>
