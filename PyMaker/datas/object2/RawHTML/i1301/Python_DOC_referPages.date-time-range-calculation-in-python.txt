<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/9044084/efficient-date-range-overlap-calculation-in-python">Efficient date range overlap calculation in python?</a>
<span class="question-originals-answer-count">
                    5 answers
                </span>
</li>
</ul>
</div>
<p>So I am creating a booking system where a room can only be booked once during a date/time-range</p>
<p>Let's Say the room is already booked on the following date/time</p>
<p><strong>2018-12-10 09:00:00 - 2018-12-10 10:00:00</strong></p>
<p>and this is my python code to determine wether the room is booked already within a time-range when trying to book the room again.</p>
<pre><code>start_date_time = form.start_date_time.data #The Start Time Input
end_date_time = form.end_date_time.data #The End Time Input
exists = 0 #A variable to add to if the time is within range already

for b in fetchBookingByRoomID(room_id): #A function to get the times already booked storing the results in "b" variable

            if start_date_time &gt;= b[2] and start_date_time &lt;= b[3]: 
                exists = exists + 1

            if end_date_time &gt;= b[2] and end_date_time &lt;= b[3]:
                exists = exists + 1 
if exists &lt;= 0:
     #BOOK THE ROOM
else:
     #ERROR : Time Slot already being used
</code></pre>
<p>By doing this i'm managing to detect an overlapping booking if the start time is greater than the already booked start time and if the end time is smaller than the end time of another booking. But If I for example try to book the following:</p>
<p><strong>2018-12-10 08:00:00 - 2018-12-10 12:00:00</strong></p>
<p>It will let me book the room and doesn't detect that there is already a booking during that period because the start time to be booked is less than the start time already booked and the end time to be booked is larger than the end time already booked, so this means that both of the IF statements are not being met and so the code proceeds on creating the booking.</p>
<p>What I want to achieve is that if there is a booking already smaller than the range entered which is still with the range to be booked, it won't let me create the booking.</p>
<p>Can someone please help me figure out the logic?
Thanks</p>
<p>The post was marked as a duplicate, but unfortunately the other question is not the same because he is comparing days and here I need to compare times. Also in the other question duplicates are allowed and they are not in my case.</p>
</div>
<div class="post-text" itemprop="text">
<p>Extract time from datetime and then compare</p>
<pre><code>start_time =start_date_time.strftime('%H:%M:%S')
</code></pre>
<p>Similarly change <code>start_end_time</code> ,<code>b[2]</code> and <code>b[3]</code></p>
</div>
<span class="comment-copy">Show us a <code>b</code> sample.</span>
<span class="comment-copy"><code>start_date_time &gt;= str(b[2])</code>,  is <code>b[2]</code> a <code>datetime</code> object casted to a <code>str</code>?</span>
<span class="comment-copy">Convert both the user input (<code>start_date_time</code> , <code>end_date_time</code> ) and <code>b</code> to a <code>datetime</code> object and u should be all set.</span>
<span class="comment-copy">You're comparing <a href="https://docs.python.org/3.1/library/string.html" rel="nofollow noreferrer"><code>strings</code></a>, not <a href="https://docs.python.org/3/library/datetime.html" rel="nofollow noreferrer"><code>datetime</code></a> objects.</span>
<span class="comment-copy"><b><i>Yes, I get your point and I've converted them to date-time objects, but the problem I have is still the same even if I am not using strings</i></b> -Try the proposed solution, you still get any errors,  come back an tell us exactly which one. A coder's life is 95% debugging and 5% coffee...</span>
