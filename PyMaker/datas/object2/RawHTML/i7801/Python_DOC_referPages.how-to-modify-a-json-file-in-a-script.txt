<div class="post-text" itemprop="text">
<p>I am trying to edit Chrome's preferences using command line. The file is a JSON file and I want to edit the data below:</p>
<pre><code>{"browser":{"last_redirect_origin":""}}
</code></pre>
<p>to</p>
<pre><code>{"browser":{"enabled_labs_experiments":["ssl-version-max@2"],"last_redirect_origin":""}}
</code></pre>
<p>I was using sed command earlier to accomplish this but want to know how this can be done using python. This was the command I was using:</p>
<pre><code>sed -i '.bak' -e 's|\(\"browser\"\):{\(\".*origin\":\"\"\)}|\1:{\"enabled_labs_experiments\":[\"ssl-version-max@2\"],\2}|' ~/Library/Application\ Support/Google/Chrome/Local\ State
</code></pre>
<p>The reason I can't use <code>jq</code> is that it is not native to macs and will need installation. I am not able to understand how to do this with python.</p>
<p>I will really appreciate it if someone could help me with this or point me in the right direction.</p>
<p><strong>EDIT</strong></p>
<p>This is what my python script looks like:</p>
<pre><code>import json
jsonData = json.loads(open('/Users/username/Library/Application Support/Google/Chrome/Local state').read())
if 'enabled_labs_experiments' in jsonData['browser']:
    if 'ssl-version-max@2' in jsonData['browser']['enabled_labs_experiments']:
        print('Exist')
    else:
        jsonData['browser']['enabled_labs_experiments'] = ['ssl-version-max@2']
        print('Added')
</code></pre>
<p>After the changes are made, I would like to commit the changes to the file.</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>import json
with open(path_to_json_file) as f:
    data = f.read()
d = json.loads(data)
d["browser"]["enabled_labs_experiments"] = ["ssl-version-max@2"]
with open(path_to_json_file, 'w') as f:
    f.write(json.dumps(d))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Why are you using regex why are you not using the built in <a href="https://docs.python.org/3/library/json.html" rel="nofollow noreferrer">json</a> module in python?</p>
<pre><code>import json
d = json.loads(path_to_your_file)
d["browser"]["enabled_labs_experiments"] = ["ssl-version-max@2"]
</code></pre>
</div>
<span class="comment-copy">don't use 'open(filename.read())'. Use with context instead. see my answer.</span>
<span class="comment-copy">@Rahul Thank you! it does exactly what I need. However, it changes the formatting a bit. Is there a way to keep the formatting intact? Here is the file if you would like to take a look: <a href="https://drive.google.com/file/d/0B38bjAmXWElZM3VqUkFadldndlk/view?usp=sharing" rel="nofollow noreferrer">drive.google.com/file/d/0B38bjAmXWElZM3VqUkFadldndlk/â€¦</a></span>
<span class="comment-copy">@lucidroid to add to this answer, the json module also has functions to write to to new files (and thus obviously edit the file too) - have a read of the docs page e4c5 linked to.</span>
<span class="comment-copy">@e4c5 That was when I was trying to achieve it in a bash script. Now I am trying to achieve the same in a python script.</span>
<span class="comment-copy">Well then here is the answer :)</span>
<span class="comment-copy">@e4c5 Thank you :) Added my python script to the post. Not really sure what's wrong here.</span>
<span class="comment-copy">Sorry you asked a question and I asnwered that and so did the other user. Now your edit makes it a completely different question.  So you should really post it as a different question.</span>
