<div class="post-text" itemprop="text">
<p>I have a csv file with non-ascii text (Chinese characters) that is something like this:</p>
<pre class="lang-none prettyprint-override"><code>id,name1,category,name2,name3  
cn,北京,capital,北京,北京  
cn,南京,city,南京,南京  
jp,東京,capital,東京,江戸
</code></pre>
<p>I'm trying to write this file into a particular format, where the names are group by the category like this:</p>
<pre class="lang-none prettyprint-override"><code>"A list of capitals are:  
北京(cn)  
北京(cn)  
北京(cn)  
東京(jp)  
東京(jp)  
江戸(jp) 

A list of cities are:  
南京(cn)  
南京(cn)  
南京(cn)"
</code></pre>
<p>In other words, the output would be like:  </p>
<pre class="lang-none prettyprint-override"><code>A list of $category values are
$name1 $id
$name2 $id
$name3 $id
</code></pre>
<p>I got up to creating a dictionary with the category as key and the names are values but when I try to write this dictionary, the text is not displayed properly.</p>
<p>This is my code:  </p>
<pre class="lang-none prettyprint-override"><code>import csv  
cases = {}  
with open('filename.csv', mode='rU') as f:  
reader = csv.reader(f, delimiter=',')  
for n, row in enumerate(reader):  
if not n:  
    #Skip header row (n = 0).  
    continue  
id,name1,category,name2,name3 = row  
if category not in cases:  
    cases[category] = list()  
cases[category].append((name2,name3))  
print(cases)  
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><strong>Update:</strong></p>
<p>To sort by column 3:</p>
<pre><code>tail -n +2 test | sort -k2 | awk -F, '{print $2" "$1}'
</code></pre>
<hr/>
<p>Python is really cool but IMHO there are some things concerning encodings (binary/utf-8/etc) like in <code>os.walk</code> which are not so cool.</p>
<p>Since we're in the <code>unix world</code> here is a solution using <code>awk</code> which might just do the job in a oneliner out of the box.</p>
<p>Assuming your csv file is called <code>test</code> and the first line in it is the table header:</p>
<pre><code>cat test | awk -F "," '{if (NR&gt;1){print $2" "$1}}'
</code></pre>
<p>input test:</p>
<pre><code>id,name1,category,name2,name3  
cn,北京,capital,北京,北京  
cn,南京,city,南京,南京  
jp,東京,capital,東京,江戸
</code></pre>
<p>output:</p>
<pre><code>北京 cn
南京 cn
東京 jp
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Here we go, <strong><em>Python</em></strong> solution:</p>
<pre><code>import collections, csv

with open('yourfile.csv', encoding='utf-8') as csvfile:
    reader = csv.DictReader(csvfile)
    d = collections.defaultdict(list)  # dictionary-like object
    for row in reader:
        for i in range(1,4):    # iterating through `name` fields
            d[row['category']].append("%s(%s)" % (row['name' + str(i)], row['id']))

print(dict(d))
</code></pre>
<p>The output:</p>
<pre><code>{'capital': ['北京(cn)', '北京(cn)', '北京(cn)', '東京(jp)', '東京(jp)', '江戸(jp)'], 'city': ['南京(cn)', '南京(cn)', '南京(cn)']}
</code></pre>
<hr/>
<p><a href="https://docs.python.org/3.6/library/csv.html?highlight=csvreader#csv.DictReader" rel="nofollow noreferrer">https://docs.python.org/3.6/library/csv.html?highlight=csvreader#csv.DictReader</a>
<a href="https://docs.python.org/3/library/collections.html#collections.defaultdict" rel="nofollow noreferrer">https://docs.python.org/3/library/collections.html#collections.defaultdict</a></p>
</div>
<span class="comment-copy">Should be moved to stackoverflow, because it's about Python.</span>
<span class="comment-copy">Thank you so much for the quick response!! My issue is that I also want to group the names by category (column #3) and then create a formatted file..</span>
<span class="comment-copy">updated my answer</span>
<span class="comment-copy">Thanks so much. I got encoding is not a valid argument using your code... I'm updating the question with my current code which prints out the dictionary but does not display the characters properly.</span>
<span class="comment-copy">@user221873, it works fine with your input example. Tested on Python 3.5</span>
<span class="comment-copy">Thanks!! I'm using python 2.7, perhaps that's why we see a difference??</span>
