<div class="post-text" itemprop="text">
<p>Consider the following example:</p>
<pre><code>import pandas as pd
from pandas import DataFrame
import statsmodels.formula.api as smf
df = DataFrame({'a': [1,2,3], 'b': [2,3,4]})
df2 = DataFrame({'177sdays': [1,2,3], 'b': [2,3,4]})
</code></pre>
<p>Then 
    <code>smf.ols('a ~ b', df)
     smf.ols('177sdays ~ b', df2)</code></p>
<p>And the first work and the second does not. The only difference seems to be the presence of numerical characters in the variable name. Why is this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Apparently, <code>statsmodels</code> uses a library called <code>patsy</code> to interpret the formulas passed to <code>ols</code>. From the <a href="http://patsy.readthedocs.io/en/latest/formulas.html" rel="nofollow noreferrer">docs</a>, an expression of the form:</p>
<pre><code>y ~ a + a:b + np.log(x)
</code></pre>
<p>will construct a patsy object of the form:</p>
<pre><code>ModelDesc([Term([EvalFactor("y")])],
      [Term([]),
       Term([EvalFactor("a")]),
       Term([EvalFactor("a"), EvalFactor("b")]),
       Term([EvalFactor("np.log(x)")])])
</code></pre>
<p><a href="http://patsy.readthedocs.io/en/latest/API-reference.html#patsy.EvalFactor" rel="nofollow noreferrer"><code>EvalFactor</code></a> then "executes arbitrary Python code." Thus your variable names must be valid Python <a href="https://docs.python.org/3/reference/lexical_analysis.html#identifiers" rel="nofollow noreferrer">identifiers</a>. I.e. 
the uppercase and lowercase letters A through Z, the underscore _ and, except for the first character, the digits 0 through 9. </p>
</div>
<span class="comment-copy">In particular it generates error invalid syntax!</span>
<span class="comment-copy">... valid python names cannot begin with numbers. Perhaps under the hood there is an eval in statsmodels. Try prefixing with underscore.</span>
<span class="comment-copy"><code>Q</code> can "quote" arbitrary variable names <a href="http://patsy.readthedocs.io/en/latest/builtins-reference.html#patsy.builtins.Q" rel="nofollow noreferrer">patsy.readthedocs.io/en/latest/â€¦</a></span>
<span class="comment-copy">@Josef what if there is a variable named Q which conflicts with the Q function?</span>
<span class="comment-copy">Thanks! This was very clear.</span>
<span class="comment-copy">This was super helpful.  Otherwise it's a "gotcha" with an utterly vague error message.  Thanks!</span>
