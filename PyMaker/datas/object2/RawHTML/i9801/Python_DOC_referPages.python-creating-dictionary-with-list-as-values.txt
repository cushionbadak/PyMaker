<div class="post-text" itemprop="text">
<p>I have a bind file in below format</p>
<pre><code>BIND REQ conn=8349228 op=0 msgID=1 version=3 type=SIMPLE dn="uid=test1,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349229 op=0 msgID=1 version=3 type=SIMPLE dn="uid=test1,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349230 op=0 msgID=1 version=3 type=SIMPLE dn="uid=xdev,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349231 op=0 msgID=1 version=3 type=SIMPLE dn="uid=xdev,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349232 op=0 msgID=1 version=3 type=SIMPLE dn="uid=COVESEOS,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349233 op=0 msgID=1 version=3 type=SIMPLE dn="uid=xdev,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349235 op=0 msgID=1 version=3 type=SIMPLE dn="uid=xdev,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349234 op=0 msgID=1 version=3 type=SIMPLE dn="uid=COVESEOS,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349236 op=0 msgID=1 version=3 type=SIMPLE dn="uid=COVESEOS,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349237 op=0 msgID=1 version=3 type=SIMPLE dn="uid=xdev,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349238 op=0 msgID=1 version=3 type=SIMPLE dn="uid=xdev,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349239 op=0 msgID=1 version=3 type=SIMPLE dn="uid=COVESEOS,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349240 op=0 msgID=1 version=3 type=SIMPLE dn="uid=xdev,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349241 op=0 msgID=1 version=3 type=SIMPLE dn="uid=xdev,ou=Users,ou=Internal,o=example"
BIND REQ conn=8349242 op=0 msgID=1 version=3 type=SIMPLE dn="uid=xdev,ou=Users,ou=Internal,o=example"`
</code></pre>
<p>Now what i am trying to do is create a dictionary of the format <code>{'uid' : [connections ids]}</code>, for example like below</p>
<pre><code>{'test1' : [8349228,8349229,...],
 'xdev' : [8349230,8349231,...],
 ...so on  }`
</code></pre>
<p>Can someone please guide me on this !! Any help is much appreciated.</p>
</div>
<div class="post-text" itemprop="text">
<p>These would be the steps:</p>
<pre><code>Create empty dictionary 
Loop through lines in input file 
    Find values of `uid` and `conn` (easiest way using regex)
    Check if current `uid` exists in dictionary 
        It doesn't, create new entry with current `uid` as key and empty list as value.
    Append `conn` to list associated to `uid` key
</code></pre>
<h3>Add key&amp;value to dict</h3>
<p>For adding keys &amp; values to dict, You should use:</p>
<pre><code>if somekey not in dict1.keys():
    dict1[somekey] = []
dict1[somekey].append(somevalue)
</code></pre>
<p>You shouldn't use any "external" lists, just ones created inside dictionary.</p>
</div>
<div class="post-text" itemprop="text">
<p>This method should do it. When you read the file, call this method and it will return a dict in the format you specified.</p>
<pre><code>import re
def input_to_dict(inp):  # inp = input from text file
    for line in inp.split("\n"):
        pattern = re.compile("uid=([A-Za-z0-9]{1,}),")
        id_pattern = re.compile("conn=([0-9]{1,})")
        name = pattern.search(line).group(1)
        c_id =id_pattern.search(line).group(1)
        if name in d.keys():
            d[name].append(c_id)
        else:
            d[name] = [c_id]
    return d
</code></pre>
<p>Example usage: </p>
<pre><code>with open("file.txt", "r") as file:
    lines = file.readlines()
    d = input_to_dict(lines)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>As comments suggested you can use <a href="https://docs.python.org/3/library/collections.html#collections.defaultdict" rel="nofollow noreferrer"><code>defaultdict</code></a> with <code>list</code> default value. Then just run regular expression for each line in file and capture uid &amp; connection id to two groups which are added to result:</p>
<pre><code>import re
from collections import defaultdict

res = defaultdict(list)
with open('log.txt') as f:
    for line in f:
        m = re.search('conn=([\w]*).*uid=([^,]*)', line)
        conn_id, uid = m.group(1, 2)
        res[uid].append(conn_id)

print(res)
</code></pre>
<p>Output:</p>
<pre><code>defaultdict(&lt;type 'list'&gt;, {
   'test1': ['8349228', '8349229'], 
   'xdev': ['8349230', '8349231', '8349233', '8349235', '8349237', '8349238', '8349240', '8349241', '8349242'], 
   'COVESEOS': ['8349232', '8349234', '8349236', '8349239']
})
</code></pre>
</div>
<span class="comment-copy">hi first create a regex for matching all the requred value then create a dict using uid if that key exist update the list and if a newone create new key for the dict</span>
<span class="comment-copy">use <code>defaultdict</code> from collections  <code>d = defaultdict(list)</code> where are you stuck ?</span>
<span class="comment-copy">I already created te regex for matching the required pattern,for the 1st time i'm able to create the dict with key as uid and values by appending conn id to list.The problem is if a uid appears again how do i append its value to list again..&amp; since there are lot of uids i can't create dynamic lists.</span>
<span class="comment-copy">This is my code <code>import re dict1={} conid=[]  fh = open("C:\\test", "r") for line in fh:     if re.search("BIND REQ", line):         conid.append(line.split()[4])         dict1[line.split()[-1].split(",")[0]] = conid fh.close()  print(len(dict1['dn="uid=test1']))</code> the output of print is no.of.lines in entire file but i want the number of lines having that uid</span>
<span class="comment-copy">Can you please look at my code i posted above, i was thinking on exactly same lines but somehow was confused.</span>
<span class="comment-copy">I've added explanation on how to add keys&amp;values to dict.</span>
