<div class="post-text" itemprop="text">
<p>I am trying to send a wav file through a socket.</p>
<p>I get the error:</p>
<pre><code>TypeError: must be string or buffer, not instance
</code></pre>
<hr/>
<pre><code>waveFile = wave.open(WAVE_OUTPUT_FILENAME, 'rb')
my_socket.sendall(waveFile)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The <code>wave</code> doesn't give you general file I/O. It is used for getting media properties.</p>
<p>You could use just normal open/close, read/write.</p>
<p><strong>sender.py:</strong></p>
<pre><code>import socket

(HOST,PORT)=('localhost',19123)
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM); s.connect((HOST,PORT))

with open('input', 'rb') as f:
  for l in f: s.sendall(l)
s.close()
</code></pre>
<p><strong>receiver.py:</strong></p>
<pre><code>import socket

(HOST,PORT) = ('localhost',19123)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.bind((HOST, PORT)); s.listen(1); conn, addr = s.accept()

with open('output','wb') as f:
  while True:
    l = conn.recv(1024)
    if not l: break
    f.write(l)
s.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Try <a href="https://docs.python.org/3/library/socket.html#socket.socket.sendfile" rel="nofollow noreferrer"><code>socket.<strong>sendfile</strong>(<em>file</em>, <em>offset=0</em>, <em>count=None</em>)</code></a>.</p>
<blockquote>
<p>Send a file until EOF is reached by using high-performance <a href="https://docs.python.org/3/library/os.html#os.sendfile" rel="nofollow noreferrer"><code>os.sendfile</code></a> â€¦</p>
</blockquote>
<p>And you don't want to open the file with <code>wave.open(...)</code> as you are sending raw binary data.</p>
<p>So you would do:</p>
<pre><code>with open(WAVE_OUTPUT_FILENAME, 'rb') as wave_file:
    my_socket.sendfile(wave_file)
</code></pre>
</div>
<span class="comment-copy">the code i wrote above, my_socket.send(),wavefile=open(...).read()</span>
<span class="comment-copy">clients code: 'while data:     alldata+=data     data=client_socket.recv(1024) voice=open("voice.p",'wb') voice.write(alldata)' raises me the error-wave.Error: file does not start with RIFF id</span>
<span class="comment-copy">I changed <code>send</code> to <code>sendall</code>. The former is not guaranteed to send all bytes (and needs to be retried with remaining bytes). The latter sends all bytes. It doesn't need retries.</span>
<span class="comment-copy">On the client side, don't do string operations, like <code>alldata+=data;</code>. I don't think they are safe on byte arrays.</span>
<span class="comment-copy">so what should i do on the client side?</span>
<span class="comment-copy">@user4719989, added code for a complete sender and receiver combination.</span>
<span class="comment-copy">it is raising me the error error-AttributeError: '_socketobject' object has no attribute 'sendfile'</span>
<span class="comment-copy">i am using windows ir its matter</span>
<span class="comment-copy">socket.sendfile() doesn't exit in Python 2.7.</span>
