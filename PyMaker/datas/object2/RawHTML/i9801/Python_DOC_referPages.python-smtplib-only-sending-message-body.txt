<div class="post-text" itemprop="text">
<p>Using Python, I wrote a simple timer that sends an email when the timer reaches 0. But the only part of the message being sent is the body. The sender address, recipient address, and subject are not being sent. Here is the code:</p>
<pre><code>#Coffee timer
import smtplib

#Set timer for 00:03:00
from time import sleep
for i in range(0,180):
print(180 - i),
sleep(1)
print("Coffee is ready")

print("Sending E-mail")

SUBJECT = 'Coffee timer'
msg = '\nCoffee is ready'
TO = 'email-B@email.com'
FROM = 'email-A@email.com'

server = smtplib.SMTP('192.168.1.8')
server.sendmail(FROM, TO, msg, SUBJECT)
server.quit()

print("Done") 
</code></pre>
<p>Can anyone explain why this is happening/what I can do to resolve it?</p>
</div>
<div class="post-text" itemprop="text">
<p>Before passing the message to <a href="https://docs.python.org/3/library/smtplib.html#smtplib.SMTP.sendmail" rel="nofollow noreferrer"><code>.sendmail()</code></a>, you must format the message as an "RFC822" message. (It is named that after the original and now obsolete version of the <a href="https://en.wikipedia.org/wiki/Email#Internet_Message_Format" rel="nofollow noreferrer">Internet email message format</a> standard. The current version of that standard is <a href="https://tools.ietf.org/html/rfc5322" rel="nofollow noreferrer">RFC5322</a>.)</p>
<p>An easy way to create RFC822 messages is to use Python's <a href="https://docs.python.org/3/library/email.message.html" rel="nofollow noreferrer"><code>email.message</code></a> type heirarchy. In your case, the subclass <a href="https://docs.python.org/3/library/email.mime.html#email.mime.text.MIMEText" rel="nofollow noreferrer"><code>email.mime.text.MIMEText</code></a> will do nicely.</p>
<p>Try this:</p>
<pre><code>#Coffee timer
import smtplib
from email.mime.text import MIMEText

print("Coffee is ready")

print("Sending E-mail")

SUBJECT = 'Coffee timer'
msg = 'Coffee is ready'
TO = 'email-B@email.com'
FROM = 'email-A@email.com'

msg = MIMEText(msg)
msg['Subject'] = SUBJECT
msg['To'] = TO
msg['From'] = FROM

server = smtplib.SMTP('192.168.1.8')
server.sendmail(FROM, TO, msg.as_string())
server.quit()

print("Done")
</code></pre>
<p>As a convenient alternative to <code>.sendmail()</code>, you can use <a href="https://docs.python.org/3/library/smtplib.html#smtplib.SMTP.send_message" rel="nofollow noreferrer"><code>.send_message()</code></a>, like so:</p>
<pre><code># Exactly the same code as above, until we get to smtplib:
server = smtplib.SMTP('192.168.1.8')
server.send_message(msg)
server.quit()
</code></pre>
</div>
