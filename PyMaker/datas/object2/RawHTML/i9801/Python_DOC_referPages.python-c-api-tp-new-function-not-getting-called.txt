<div class="post-text" itemprop="text">
<p>I am developing a new Python data type using type objects. I used the "Defining New Types page for Python 2.7.12" as a guide and was able to adapt the examples on that page to my specific needs. I am able to create my new data type and add it to a Python module. When I run things from Python, I can create a new object like this.</p>
<pre><code>x = MyNewType()
</code></pre>
<p>In this case, my <code>tp_new</code> function is called and I am able to fill in the default data items the way I want. However, if I try to do the same thing in C++ by calling <code>PyObject_New()</code>, my <code>tp_new</code> function doesn't get called. As a workaround I can call <code>PyObject_SetAttrString()</code> on each data member with no problem. I see the same issue with my <code>tp_init</code> function, where calling <code>PyObject_Init()</code> does not result in my <code>tp_init</code> function getting called. I've spent the better part of a day trying to track this thing down with no luck. Any help would be appreciated.</p>
</div>
<div class="post-text" itemprop="text">
<p>The best way is to <a href="https://docs.python.org/3/c-api/object.html#c.PyObject_Call" rel="nofollow noreferrer">call</a> the class object, just like in Python itself.</p>
<p>Credit: I just learnt it from <a href="https://stackoverflow.com/a/4163055/6059640">this</a> answer.</p>
</div>
