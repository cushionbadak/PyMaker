<div class="post-text" itemprop="text">
<p>I've got a piece of code that extracts coordinates from a KML file.  It works beautifully and prints to the screen the way I'd want it to print to a CSV file.  However, when I attempt to write it to a CSV file, the resulting file is empty.  </p>
<p>I've tried both the method below and the standard text output method using <code>.write</code> and <code>.writerows</code>.  All have the same result.</p>
<p>Here is the KML I'm using: </p>
<pre class="lang-xml prettyprint-override"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;kml xmlns="http://www.opengis.net/kml/2.2" xmlns:gx="http://www.google.com/kml/ext/2.2" xmlns:kml="http://www.opengis.net/kml/2.2" xmlns:atom="http://www.w3.org/2005/Atom"&gt;
&lt;Document&gt;
    &lt;name&gt;Test3.kml&lt;/name&gt;
    &lt;Style id="s_ylw-pushpin"&gt;
        &lt;IconStyle&gt;
            &lt;scale&gt;1.1&lt;/scale&gt;
            &lt;Icon&gt;
                &lt;href&gt;http://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png&lt;/href&gt;
            &lt;/Icon&gt;
            &lt;hotSpot x="20" y="2" xunits="pixels" yunits="pixels"/&gt;
        &lt;/IconStyle&gt;
    &lt;/Style&gt;
    &lt;Style id="s_ylw-pushpin_hl"&gt;
        &lt;IconStyle&gt;
            &lt;scale&gt;1.3&lt;/scale&gt;
            &lt;Icon&gt;
                &lt;href&gt;http://maps.google.com/mapfiles/kml/pushpin/ylw-pushpin.png&lt;/href&gt;
            &lt;/Icon&gt;
            &lt;hotSpot x="20" y="2" xunits="pixels" yunits="pixels"/&gt;
        &lt;/IconStyle&gt;
    &lt;/Style&gt;
    &lt;StyleMap id="m_ylw-pushpin"&gt;
        &lt;Pair&gt;
            &lt;key&gt;normal&lt;/key&gt;
            &lt;styleUrl&gt;#s_ylw-pushpin&lt;/styleUrl&gt;
        &lt;/Pair&gt;
        &lt;Pair&gt;
            &lt;key&gt;highlight&lt;/key&gt;
            &lt;styleUrl&gt;#s_ylw-pushpin_hl&lt;/styleUrl&gt;
        &lt;/Pair&gt;
    &lt;/StyleMap&gt;
    &lt;Placemark&gt;
        &lt;name&gt;Untitled&lt;/name&gt;
        &lt;styleUrl&gt;#m_ylw-pushpin&lt;/styleUrl&gt;
        &lt;LineString&gt;
            &lt;tessellate&gt;1&lt;/tessellate&gt;
            &lt;coordinates&gt;
                -117.2983479390361,33.27144940863937,0 -117.2979479084534,33.27158154479859,0 -117.2974695164833,33.27172038778199,0 -117.2975027748323,33.27194103134417,0 -117.297514618297,33.27194834552386,0 -117.2979065026131,33.27210103585357,0 -117.2980671096438,33.27197757139673,0 -117.2980506390891,33.27176546338881,0 -117.2983889177018,33.27174732829762,0 -117.2985056013534,33.27196820309105,0 -117.2984607071796,33.27217535203514,0 -117.2982982520078,33.2722451382993,0 -117.2982714656408,33.2722496045722,0 -117.297926137081,33.27225329696987,0 -117.2979181624345,33.27225324047765,0 -117.297660871735,33.27222714260547,0 -117.2976362532899,33.2722186164706,0 -117.2974159727989,33.27218328409937,0 -117.2974081729552,33.27218350960742,0 -117.2970860609136,33.27208829299941,0 -117.2968393500826,33.27207716108421,0 -117.2967459496535,33.27216774204006,0 -117.2966603938058,33.27233920748802,0 -117.2969907889174,33.27237357387524,0 -117.2970232333844,33.27237306198914,0 -117.2973444433226,33.27239693646774,0 -117.297751764355,33.27242613992279,0 -117.2981731050047,33.27243373303686,0 -117.2981813185804,33.27243372905114,0 -117.2985617246156,33.2723816290589,0 -117.2987498163436,33.27248971415388,0 -117.2987694564539,33.27262188734785,0 -117.2985436721398,33.27267540671544,0 -117.2985270445518,33.27267612619851,0 -117.2981490803383,33.27268345629938,0 -117.2981145841072,33.2726829556605,0 -117.2977420026904,33.27265933276826,0 -117.2977334907908,33.27265936075214,0 -117.2977079525845,33.27265943947727,0 -117.297690884793,33.27265933069783,0 -117.2973143742666,33.2726410594433,0 -117.2972972842265,33.27263660852098,0 -117.2972803621663,33.27263663588342,0 -117.2969673713573,33.27262125275644,0 -117.296756583612,33.27260864705382,0 -117.2965634725893,33.27264899681126,0 -117.2965301429721,33.27279607660442,0 -117.296929900768,33.27282274189361,0 -117.2972917056901,33.27281884120617,0 -117.2975482260676,33.27280094439733,0 -117.2979485409129,33.27281652227333,0 -117.2983940432828,33.2728392485114,0 -117.2987809571886,33.27284381722371,0 
            &lt;/coordinates&gt;
        &lt;/LineString&gt;
    &lt;/Placemark&gt;
&lt;/Document&gt;
&lt;/kml&gt;
</code></pre>
<p>And the code:</p>
<pre><code>from xml.dom import minidom
import csv

xmldoc = minidom.parse("Test.kml")

kml = xmldoc.getElementsByTagName("kml")[0]

document = kml.getElementsByTagName("Document")[0]

placemarks = document.getElementsByTagName("Placemark")

for placemark in placemarks:
    coords = placemark.getElementsByTagName("coordinates")[0].firstChild.data

    list = coords.split(",")
    for items in list:
        item = items.split(",")
        for allitems in item:
            latlon = allitems.replace("0 ","")
            latlon = latlon.strip()
            print(latlon) # &lt;-- Printing to the screen works fine
            with open("Output.csv", "w") as output:
                writer = csv.writer(output, delimiter='\n')
                writer.writerow(latlon)
</code></pre>
<p>****SOLVED****
Final working solution is this:</p>
<pre><code>with open("Output.csv", "w") as text_file:             # open the file first
    #writer = csv.writer(output, delimiter='\n')     # and get ready to write

    for placemark in placemarks:
        coords = placemark.getElementsByTagName("coordinates")[0].firstChild.data

        list = coords.split(",")
        for items in list:
            item = items.split(",")
            for allitems in item:
                latlon = allitems.replace("0 ","")
                latlon = latlon.strip()
                print(latlon) # &lt;-- Printing to the screen works fine
                text_file.write(latlon + '\n')     # Write the row to the already-open file
</code></pre>
<p>I abandoned the csv method and went with a text file output, just renaming to csv.  I end up with the result I need.  Thanks to all that contributed.</p>
</div>
<div class="post-text" itemprop="text">
<p>The <code>with</code> and <code>writer=</code> should be happening once, at the beginning of your loop.  As it is now, you are re-creating the file for each item, throwing away the last item.  </p>
<pre><code>with open("Output.csv", "w") as output:             # open the file first
    writer = csv.writer(output, delimiter='\n')     # and get ready to write

    for placemark in placemarks:
        coords = placemark.getElementsByTagName("coordinates")[0].firstChild.data

        list = coords.split(",")
        for items in list:
            item = items.split(",")
            for allitems in item:
                latlon = allitems.replace("0 ","")
                latlon = latlon.strip()
                print(latlon) # &lt;-- Printing to the screen works fine
                writer.writerow([latlon])     # Write the row to the already-open file
                       # EDIT 2 ^      ^
</code></pre>
<p><strong>Edit</strong> Now there may be another issue: it looks like <code>latlon</code> is a string, but <a href="https://docs.python.org/3/library/csv.html#writer-objects" rel="nofollow noreferrer"><code>writerow</code></a> expects a list of items, and fills in the commas between the items automatically.  You might want <code>print(latlon + ',', file=output)</code> instead of <code>writer.writerow</code> depending on your specific use case.</p>
<p><strong>Edit 2</strong> Use <code>[latlon]</code> instead of <code>latlon</code> to get the whole line on one row instead of one character per row.  The brackets make it a list of one item rather than a string, which behaves in this context like a list of its characters, one at a time.</p>
</div>
<span class="comment-copy">You realise you're repeatedly re-opening the file in (over)<code>w</code>rite mode every time through the loop?</span>
<span class="comment-copy">jonrsharpe and Oliver W.  Believe it or not, I had it rearranged a few different ways before ending up here.  You're both right about opening the file only once.  Obvious mistake.</span>
<span class="comment-copy"><i>"Code to follow after the edit"</i> - instead could you finish the answer before clicking Post?</span>
<span class="comment-copy">But then they wouldn't have had the first answer.  ;)</span>
<span class="comment-copy">@cxw This ultimately got me where I needed to be.  Thank you.  Your example, as is, put every character of each item in the list on a new line.  Also, print(latlon + ',', file=output) resulted in invalid syntax error, highlighting the "="</span>
