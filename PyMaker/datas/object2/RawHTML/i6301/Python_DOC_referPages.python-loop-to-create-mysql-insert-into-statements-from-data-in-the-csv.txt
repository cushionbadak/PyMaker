<div class="post-text" itemprop="text">
<p>I need to write a python code that converts all the entries of a CSV to a mySQL insert into statement through a loop. I have csv files with about 6 million entries. </p>
<p>This code below can probably read a row.. Has some syntactically errors though. Can't really pin point as I don't have a background in coding.</p>
<pre><code>file = open('physician_data.csv','r')
for row in file:
    header_string = row
header_list = list(header_string.split(','))
number_of_columns = len(header_list)
insert_into_query= INSERT INTO physician_data (%s)
for i in range(number_of_columns):
    if i != number_of_columns-1:
        insert_into_query+="%s," %(header_list[i])
    else:
        # no comma after last column
        insert_into_query += "%s)" %(header_list[i])

print(insert_into_query)
file.close
</code></pre>
<p>Can someone tell me how to make this work?</p>
</div>
<div class="post-text" itemprop="text">
<p>Please include error messages when you describe a problem (<a href="https://stackoverflow.com/help/mcve">https://stackoverflow.com/help/mcve</a>).</p>
<p>You may find the documentation for the <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">CSV library</a> quite helpful.</p>
<p>Use quotes where appropriate, e.g. <code>insert_into_query = "INSERT..."</code></p>
<p>Call the close function like this: <code>file.close()</code></p>
</div>
<span class="comment-copy">The error is traceback, bad operand. It seems that my syntax is wrong.</span>
