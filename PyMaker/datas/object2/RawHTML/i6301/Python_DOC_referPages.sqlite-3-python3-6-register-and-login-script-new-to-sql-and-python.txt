<div class="post-text" itemprop="text">
<p>I'm trying to write a dead simple login and register script for python 3.6. However, i can't get rid of this bug... Every time i register, there are no error, but when i run it again, and use the same username, it doesnt display the message about it already existing...
I cant get it to output the entire DB too just so i can see what is in there (using <code>c.fetchall()</code>)</p>
<p>Here's the code...</p>
<pre><code>import sqlite3 as sql, os

def dirCheck():

    exDir=False

    for count in os.listdir():
        if count == 'sql':
            exDir=True
    if exDir == False:
        os.mkdir('sql')



dirCheck()


cnct=sql.connect('./sql/usrAcc.db')
c=cnct.cursor()


def newTable():
    c.execute('CREATE TABLE IF NOT EXISTS users(username TEXT, password TEXT)')


newTable()

f=False
t=True
valid=f
taken=f





def credsWrite(username, password):
    c.execute('INSERT INTO users(username, password) VALUES (?, ?)',
              (username, password))
    cnct.commit()
    for row in c.fetchall():
        print(row)
    c.close
    cnct.close



def userReg():
    global valid, taken

    print(fancy[1])
    while not valid:
        print(fancy[3])
        username=str(input('&gt;&gt;  '))
        for row in c.fetchall():
            if str(username) == str(row[0]):
                print('Sorry, but that username has already been taken...\nPlease enter another\n&gt;  ')
                taken=True
        if not taken:
            print(fancy[4])
            password=str(input('&gt;&gt;  '))
            valid=True
        credsWrite(username,password)

fancy=["""
 ================
| SQL LOGIN TEST |
 ================
 ""","""
 ==========
| REGISTER |
 ==========
 ""","""
 =======
| LOGIN |
 =======
 ""","""
 ================
| ENTER USERNAME |
 ================
 ""","""
 ================
| ENTER PASSWORD |
 ================
"""]


def startUp():
    print(fancy[0])
    chosen=False
    while not chosen:
        opt=int(input('\n Please choose one of the options below:\n\n-&gt; Register for a new account [1]\n-&gt; Login to an existing account [2]\n\nPlease type a number...\n\n&gt;&gt;  '))
        if opt==1:
            userReg()
            chosen=True
        elif opt==2:
            login()
            chosen=True
        else:
            print('\n\nPLEASE TYPE EITHER 1 OR 2...\n ')


if __name__ == "__main__":
    startUp()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You are executing <code>fetchall()</code> without having actually executed any code.</p>
<p>Where you have</p>
<pre><code>for row in c.fetchall():
</code></pre>
<p>you are only looking through just the cursor object, which hasn't looked for anything yet.</p>
<p>To use <code>fetchall</code> for this, you need to add a <code>SELECT</code> statement. For instance, I changed your code by adding one line and changing one line and it ran (although there's another syntax error that arises):</p>
<pre><code>all_users = c.execute('SELECT * FROM users')
for row in all_users.fetchall():
</code></pre>
<p>(The other syntax error is that you are trying to write the creds regardless of whether the username was valid.)</p>
<hr/>
<p>Note: Something else you should consider:</p>
<p>Instead of looping through the results of <code>fetchall</code> you could just search for whether a username already exists in your SQL. This would also allow the next part to just be an <code>else</code>.</p>
<pre><code>username=str(input('&gt;&gt;  '))
taken = c.execute('SELECT username FROM users WHERE username=?', (username,))
if taken:
    print('Sorry, but that username has already been taken...\nPlease enter another\n&gt;  ')
</code></pre>
<p>The <code>(username,)</code> is a parameter (described early in the <a href="https://docs.python.org/3/library/sqlite3.html" rel="nofollow noreferrer">python docs for sqlite3</a>). You should always use parameters when using value from users to avoid <a href="https://xkcd.com/327/" rel="nofollow noreferrer">SQL injection</a>. It is in parentheses with a comma to make it a tuple.</p>
</div>
