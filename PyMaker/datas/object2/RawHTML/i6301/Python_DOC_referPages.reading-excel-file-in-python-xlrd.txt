<div class="post-text" itemprop="text">
<p>I'm really struggling to read an excel file in Python which is something I need to be able to do for coursework that I have set and I have found a method of doing it using xlrd however, I cannot get it work. I used cmd to install xlrd (pip install xlrd) and it was successful however, I am still unable to read Excel sheets into Python and I am unsure as to why it is not working, below is my code:</p>
<pre><code>import xlrd

file_location = "C:/Users/Sean/Desktop/DADSA 17-18 COURSEWORK A MALE PLAYERS.csv"

workbook = xlrd.open_workbook(file_location)
</code></pre>
<p>Now every tutorial that I have watched this method has worked however, when I try to do it I get an error:</p>
<pre><code>"Traceback (most recent call last):
  File "C:\Users\Sean\Desktop\Data Structures Assignment 1\Tennis.py", line 3, in &lt;module&gt;
  workbook = xlrd.open_workbook(file_location)
  File "C:\Users\Sean\lib\site-packages\xlrd\__init__.py", line 162, in open_workbook
ragged_rows=ragged_rows,
  File "C:\Users\Sean\lib\site-packages\xlrd\book.py", line 91, in open_workbook_xls
  biff_version = bk.getbof(XL_WORKBOOK_GLOBALS)
  File "C:\Users\Sean\lib\site-packages\xlrd\book.py", line 1271, in getbof
  bof_error('Expected BOF record; found %r' % self.mem[savpos:savpos+8])
  File "C:\Users\Sean\lib\site-packages\xlrd\book.py", line 1265, in bof_error
  raise XLRDError('Unsupported format, or corrupt file: ' + msg)
  xlrd.biffh.XLRDError: Unsupported format, or corrupt file: Expected BOF      record; found b'MP01\r\nMP'"
</code></pre>
<p>Any help on this would be greatly appreciated,</p>
<p>Cheers</p>
</div>
<div class="post-text" itemprop="text">
<p>Just to add to my comment I thought I would show some basic code to use the csv module to iterate over rows, also, pythons csv module documentation can be found here: <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">https://docs.python.org/3/library/csv.html</a></p>
<pre><code>import csv
import xlrd

file_location = "C:/Users/Sean/Desktop/DADSA 17-18 COURSEWORK A MALE PLAYERS.csv"

if file_location.endswith(".csv"):
    with open(file_location) as fp:
        for row in csv.reader(fp):
            # do something with rows
elif file_location.endswith((".xls", ".xlsx")):
    workbook = xlrd.open_workbook(file_location)
    # do something with workbook
</code></pre>
</div>
<span class="comment-copy">It looks like your filepath is a .csv as opposed to a .xlsx or .xls, is this a problem for xlrd? would you rather open a .csv with the csv module?</span>
<span class="comment-copy">Oh yeah you could possibly be right! Keen eye mate I'll see if I can figure that out how to use the csv module</span>
<span class="comment-copy">@new_to_coding <code>xlrd</code> cannot read csvs, you're right.</span>
<span class="comment-copy">You're an absolute hero man, been pulling my hair out over why it hasn't been working. Just tried it and it works! really appreciate the help :)</span>
<span class="comment-copy">@SeanCampbell no problem, glad I helped someone, don't forget to accept the answer if you're happy it solves your problem, I wouldn't ask but it gives me points for my work :P</span>
