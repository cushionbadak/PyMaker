<div class="post-text" itemprop="text">
<p>I'm currently running a program in VBA which calls Python to execute a script. The script downloads from SQL then runs an algorithm to produce output which is subsequently consumed by VBA (I'm doing it this way since my GUI is in Excel and my final output is an Excel table).</p>
<p>I'm running the Python part via shellscript as below:</p>
<pre><code>Public Const PythonPath = "D:\Anaconda2\Python.exe "

Set ShellScript = VBA.CreateObject("WScript.Shell")
Filename = """I:\SQL Downloader_v4.2.py"""
ShellScript.Run (PythonPath &amp; Filename), windowStyle, waitOnReturn
</code></pre>
<p>This then launches a Python application which requires a username and password to access an SQL database. Python is set up to accept username and password via raw_input within the script. How would I send username and password from VBA to Python in this method or is there a better way than doing via raw_input?</p>
</div>
<div class="post-text" itemprop="text">
<p>You could send username and password using command line arguments. </p>
<p>Your VBA code would looks like so:</p>
<pre><code>Public Const PythonPath = "D:\Anaconda2\Python.exe "

Set ShellScript = VBA.CreateObject("WScript.Shell")
Filename = """I:\SQL Downloader_v4.2.py"""
ShellScript.Run (PythonPath &amp; Filename &amp; username &amp; password), windowStyle, waitOnReturn
</code></pre>
<p>In the python script you can parse first the arguments with getopt:</p>
<pre><code>import sys

if sys.argv &lt; 3:
    print('Missing username and/or password')
    print('Usage: SQL_Downloader_v4.2.py USERNAME PASSWORD')
    exit(1)
username = sys.argv[1]
password = sys.argv[2]

...
</code></pre>
<p>There are two modules in the Python standard library for more advanced parsing of command line arguments: <a href="https://docs.python.org/3/library/getopt.html" rel="nofollow noreferrer">getopt</a> and <a href="https://docs.python.org/3/library/argparse.html" rel="nofollow noreferrer">argparse</a>.</p>
</div>
<span class="comment-copy">Have a look at xlwings, it is purpose built for this kind of thing</span>
