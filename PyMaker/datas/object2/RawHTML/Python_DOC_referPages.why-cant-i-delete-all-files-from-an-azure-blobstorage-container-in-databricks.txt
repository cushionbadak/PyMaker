<div class="post-text" itemprop="text">
<p>I want to remove all files from a blobstorage container using: </p>
<blockquote>
<p>dbutils.fs.rm</p>
</blockquote>
<p>Pointing to one specific file like this works fine:</p>
<pre><code>dbutils.fs.rm("/mnt/inbox/InvLog.txt", True)
</code></pre>
<p>But I want to delete <em>all</em> content of the container. I have tried the following without success:</p>
<pre><code>dbutils.fs.rm("/mnt/inbox/*.txt", True)
dbutils.fs.rm("/mnt/inbox/", True)
dbutils.fs.rm("/mnt/inbox", True)
dbutils.fs.rm("/mnt/inbox/*.*", True)
</code></pre>
<p>any suggestions?</p>
<p>update: tried ZF007 suggestion %fs rm -r mnt/inbox but it throws error:</p>
<blockquote>
<p>java.lang.NullPointerException</p>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>As you can see in the example given <a href="https://docs.azuredatabricks.net/user-guide/dbfs-databricks-file-system.html" rel="nofollow noreferrer">here</a> you can use <code>dbutils.fs.rm("/mnt/inbox/InvLog.txt", True)</code> in a single file method.</p>
<p>The example on the webpage gives you below for a single file:</p>
<pre><code>dbutils.fs.rm("/foobar/baz.txt")
</code></pre>
<p>Removing files under the folder foobar is done like this:</p>
<pre><code> %fs rm -r foobar
</code></pre>
<p>In your case use:</p>
<pre><code>%fs rm -r mnt/inbox
</code></pre>
<p>Keep in mind the folder-annotation differences between linux, Windows and OSX systems.</p>
<p>Update:</p>
<p>You can try the following non-elegant short-cut solution to circumvent your stated java exception:</p>
<pre><code>import os
import ...snippet... # yours to fill in here what else you need to import.

files_processed = 0
files_path = [os.path.abspath(x) for x in os.listdir()]

print (files_path) # your filepath might need cleaning for it can be accepted. It prints here all found files.

for item in files_path:
    if os.path.isfile(item) == True:
        dbutils.fs.rm(item, True)
        files_processed +=1
    else:
        print ('skipped folder: %s', item)

print ("job done", ' : ', file_processed)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I found that the command </p>
<pre><code>%fs rm -r /mnt/inbox/test
</code></pre>
<p>only works on a <em>folder</em>. not on files directly in a container so in above code, 
<em>inbox</em> is the container and <em>test</em> is the folder. then it works. files need to be in a <em>folder</em>. </p>
</div>
<span class="comment-copy">Try also the non-elegant update :-)</span>
<span class="comment-copy">It doesn't seem to work. It throws error: java.lang.NullPointerException</span>
<span class="comment-copy">... good the read you tried. I'm not an expert on azure-databricks but recommend you update your question with your finding underneath your current provide question text. Use for example bullet name "Update 1:" and state your error in a the yellow box with using "&gt;" sign.</span>
<span class="comment-copy">Your second suggestions returns "Job done" but unfortunately files are not being deleted.</span>
<span class="comment-copy">You might need to check if your filepath is correct so its accepted. See code/comment in script for check.</span>
<span class="comment-copy">not sure what you mean. can you elaborate?</span>
