<div class="post-text" itemprop="text">
<p>I use Try Catch Else Finally block to create this function.</p>
<p>Here is my code:</p>
<pre><code>def read_a_file():
    """
    &gt;&gt;&gt; out = read_a_file() #while the file is not there
    The file is not there.
    We did something.
    &gt;&gt;&gt; print(out)
    None
    &gt;&gt;&gt; Path('myfile.txt').touch()
    &gt;&gt;&gt; out = read_a_file() #while the file is there
    The file is there!
    We did something.
    &gt;&gt;&gt; type(out)
    &lt;class '_io.TextIOWrapper'&gt;
    &gt;&gt;&gt; out.close()
    &gt;&gt;&gt; os.remove("myfile.txt")
    """
    try:
        file_handle = open('myfile.txt', 'r')
        return file_handle
    except FileNotFoundError:
        print('The file is not there.')
        return None
    else:
        print('The file is there!')
    finally:
        print('We did something.')
</code></pre>
<p>However, when I run the doctest, the print statement never work in except and else block. Only the print statement in finally block is working.</p>
<p>I got this as result, which is not what I wanted.</p>
<pre><code>&gt;&gt;&gt; out = read_a_file() #while the file is not there
We did something.
</code></pre>
<p>Help!!! How to solve this issue?</p>
<p>You have to import these packages</p>
<pre><code>import pandas as pd
from functools import reduce
from pathlib import Path
import os
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This has nothing to do with <code>doctest</code>.  The behavior is expected because, when you <code>return</code>, the <code>else:</code> clause is <em>not</em> executed.  From <a href="https://docs.python.org/3/reference/compound_stmts.html#the-try-statement" rel="nofollow noreferrer">the docs</a>:</p>
<blockquote>
<p>The optional else clause is executed if and when control flows off the end of the try clause. [2]</p>
<p>...</p>
<p>[2] Currently, control “flows off the end” except in the case of an exception or the execution of a return, continue, or break statement.</p>
</blockquote>
<p>So if you want <code>The file is there!</code>to appear if and only if no exception is raised, lose the <code>else:</code> clause and move</p>
<pre><code>print('The file is there!')
</code></pre>
<p>above</p>
<pre><code>return file_handle
</code></pre>
</div>
<span class="comment-copy">I can't reproduce this using Python 3.6.3</span>
<span class="comment-copy">Sounds to me like the file <i>is</i> there, perhaps because a previous doctest failed before it would have deleted the file.</span>
<span class="comment-copy">I ran your code on python 3.6.0 it works as expected</span>
<span class="comment-copy">Does this help: <a href="https://stackoverflow.com/questions/855759/python-try-else?rq=1">stackoverflow.com/questions/855759/python-try-else?rq=1</a></span>
<span class="comment-copy">Surely you mean move <code>print('The file is there!')</code> to above <code>return file_handle</code> in the try-clause? Better to show how the code should look.</span>
<span class="comment-copy">Yup!  Thanks - I'll edit.</span>
