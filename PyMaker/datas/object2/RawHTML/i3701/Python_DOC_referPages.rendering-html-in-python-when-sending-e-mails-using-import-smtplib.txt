<div class="post-text" itemprop="text">
<p>I am trying to send an e-mail using import smtplib. And I want it to render the html and send it in an e-mail. Unfortunately it currently just sends the html code in the e-mail. Any suggestion would be much appreciated. </p>
<p>My Code is below:</p>
<pre><code>import smtplib
import pandas as pd

DEFAULT_EMAIL_SERVER = "x"
TO = ["y@x.com"]
FROM = "z@x.com"
SUBJECT = "TEST"
table = pd.read_excel('abc.xlsm')

body = '&lt;html&gt;&lt;body&gt;' + table.to_html() + '&lt;/body&gt;&lt;/html&gt;'
        TEXT = body


message = """From: %s\r\nTo: %s\r\nSubject: %s\r\n\

            %s
            """ % (FROM, ", ".join(TO), SUBJECT, TEXT)


server = smtplib.SMTP(x)
server.sendmail(FROM, TO, message)
server.quit()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use the <a href="https://docs.python.org/3/library/email.mime.html#email.mime.text.MIMEText" rel="nofollow noreferrer"><code>MIMEText</code></a> object from <code>email.mime.text</code> to create an email that specifies it's content as HTML.</p>
<pre><code>from email.mime.text import MIMEText

message = '&lt;html&gt;&lt;body&gt; &lt;b&gt;hello world&lt;/b&gt; &lt;/body&gt;&lt;/html&gt;'

my_email = MIMEText(message, "html")
my_email["From"] = "me@email.com"
my_email["To"] = "you@other.org"
my_email["Subject"] = "Hello!"

server = smtplib.SMTP(my_server)
server.sendmail(from_email, to_email, my_email.as_string())
</code></pre>
<p>This handles the formatting of the email header for you. <code>.as_string()</code> produces:</p>
<pre><code>Content-Type: text/html; charset="us-ascii"
MIME-Version: 1.0
Content-Transfer-Encoding: 7bit
From: me@email.com
To: you@other.org
Subject: Hello!

&lt;html&gt;&lt;body&gt; &lt;b&gt;hello world&lt;/b&gt; &lt;/body&gt;&lt;/html&gt;
</code></pre>
</div>
<span class="comment-copy">I can play around with it to get the formatting of the table to be in html now, but I cant get the from to and subject to work. Are you sure it should be server.sendmail(from_email, to_email, my_email.as_string()) ?</span>
<span class="comment-copy">@Imccann, I did make some edits after I posted the answer. Did you see those?</span>
<span class="comment-copy">ah yes got it to work now. Why do I need to add Content-Type: text/html; charset="us-ascii" to your message string:</span>
<span class="comment-copy">Hi this worked well!</span>
