<div class="post-text" itemprop="text">
<p>I need to print headers and data rows to a CSV file. Here is my code:</p>
<pre><code>import csv

import sys

  with open(r'C:\Users\testuser\Desktop\raw_inpuy.csv','rb') as csvfile:

        reader=csv.reader(csvfile,delimiter=',')
        first=True
        data={}
        for row in reader:
            if first:
                 first= False
                   continue
            if not int(row[1]) in data:
                 data[int(row[1])]=[]
               data[int(row[1])].append(float(row[3]))


    with open (r'C:\Users\testuser\Desktop\outcome.csv','wb') as f_out:
        outwriter=csv.writer(f_out,delimiter=',')
       f_out.write(";".join(['Size','S1','S2','S3','S4']))
       for item in data:
        row=[item]
        row.extend(data[item])
        f_out.write(";".join(map(str,row)))
</code></pre>
<p>I get this error:</p>
<pre><code>**ERROR Expected a character buffer obj**
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You should feed <code>writer.write</code> with an <code>str</code> not a <code>list</code>:</p>
<pre><code> writer.write(";".join(['Size','S1','S2','S3','S4']))
</code></pre>
<p>also:</p>
<pre><code> writer.write(";".join(map(str, row)))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Instead of trying to build your own CSV records, let the <code>csv</code> module handle it. Like this:</p>
<pre><code>import csv

data = [[10, 'foo', 'bar', 'blue', 'green'],
        [20, 'bar', 'foo', 'blue', 'green'],
        [30, 'ba', 'bar', 'red', 'white']]

with open (r'C:\Users\testuser\Desktop\outcome.csv','w') as file:
  writer = csv.writer(file)
  writer.writerow(['Size','S1','S2','S3','S4'])
  for row in data:
    writer.writerow(row)
</code></pre>
</div>
<span class="comment-copy">You need to use <code>csv.writer</code> to create a <a href="https://docs.python.org/3/library/csv.html#csv.writer" rel="nofollow noreferrer"><i>writer object</i></a></span>
<span class="comment-copy">No! you can't just rewrite the question completely based on first answers. rollback, accept an answer and ask another question!</span>
<span class="comment-copy">New error for the last line is: 'sequence item 0: expected string, int found' what I am writing to the csv consists of strings and integers</span>
<span class="comment-copy">try: <code>writer.write(";".join(map(str, row)))</code></span>
