<div class="post-text" itemprop="text">
<p>When running this code the results change as expected since a set is unordered: </p>
<pre><code>my_set_1 = {'a','b','c',}
print([i for i in my_set_1])
</code></pre>
<p>That is, multiple runs would give different lists, e.g.</p>
<pre><code>['a', 'c', 'b']
['b', 'a', 'c']
['a', 'c', 'b']
['c', 'b', 'a']
</code></pre>
<p>etc.</p>
<p>(<strong>Note:</strong> You might be getting the same result instead, if you don't have <code>PYTHONHASHSEED=random</code>, as suggested in the comments. Also, if you are using the console to replicate it, make sure you <kbd>Rerun</kbd> the console every time you run the code.)</p>
<hr/>
<p>However, when placing the above code in a for loop the results are rather surprising: </p>
<pre><code>for i in range(10):
    my_set_1 = {'a','b','c',}
    print([i for i in my_set_1])
# Prints: 
# ['a', 'c', 'b']
# ['a', 'c', 'b']
# ['a', 'c', 'b']
# ....
</code></pre>
<p>A single run of the for loop will print the same list. Rerunning the for loop can print a different list (e.g. <code>['c', 'b', 'a']</code>) but it will still be printed 10 times without changing. </p>
<p>Why doesn't it change?</p>
</div>
<div class="post-text" itemprop="text">
<p>@ReblochonMasque has a correct point: set is based on the hash table and if hashes calculated between runs are the same, you'll have the same order between runs. However such behaviour is vulnerable to <a href="https://stackoverflow.com/a/27522708/1377864">attacks</a>. </p>
<p>To prevent these attacks special variable <a href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONHASHSEED" rel="nofollow noreferrer"><code>PYTHONHASHSEED</code></a> was introduced. When it is set to <code>random</code> each run Python will generate different hashes for the same items. That's why you get different order.</p>
<p>To check this, you can run your program with <code>PYTHONHASHSEED</code> set to the same number. Order will be the same among runs.</p>
<pre><code>$ export PYTHONHASHSEED=random
$ python t.py
['a', 'b', 'c']
$ python t.py
['a', 'c', 'b']
$ python t.py
['c', 'b', 'a']
$ export PYTHONHASHSEED=4
$ python t.py
['a', 'b', 'c']
$ python t.py
['a', 'b', 'c']
$ python t.py
['a', 'b', 'c']
</code></pre>
<p>If you look at the <a href="https://docs.python.org/3/reference/datamodel.html#object.__hash__" rel="nofollow noreferrer"><code>object.__hash__()</code></a>. There is a note at the bottom (exactly about your case):</p>
<blockquote>
<p><strong>Note</strong> By default, the <code>__hash__()</code> values of <code>str</code>, <code>bytes</code> and <code>datetime</code> objects are "salted" with an unpredictable random value. Although they remain constant within an individual Python process, they are not predictable between repeated invocations of Python.</p>
</blockquote>
</div>
<div class="post-text" itemprop="text">
<p>You shall not expect that the order of a set will change; sets are unordered in a sense that the order is not an invariant i/e there is no guarantee that it will not change.</p>
<p>The implementation is in the form of a hash table (dictionary); as long as there are no collisions of keys, the order will likely not change, but there is no telling. It is also not possible to predict if or when that will occur.</p>
<p>Be careful with drawing conclusions from your experimentation: the results you get cannot be predicted and will depend on the state of your system at the moment you run. They also won't hold across platforms, versions of python, etc...</p>
</div>
<span class="comment-copy">My tests seem to show that set does keep order between runs (same items, unmodified), it just doesn't guarantee a specific order. Can not reproduce your first statement of set yielding different ordering across list comprehension runs.</span>
<span class="comment-copy">@ReutSharabani Are you running that code in the console? If so try this code inside a module and run the module.</span>
<span class="comment-copy">The order in set is arbitrary.</span>
<span class="comment-copy">Can you provide <b>one</b> piece of code that shows the problem?</span>
<span class="comment-copy">They don't have <code>PYTHONHASHSEED=random</code>, that's why they can't reproduce. Probably you can note it in your answer.</span>
