<div class="post-text" itemprop="text">
<p>Running this code in Python 3.4 from Python shell works just fine:</p>
<pre><code>from csv import reader

if __name__ == '__main__':
    filename = "valid.csv"

    with open(filename) as f:
        csvreader = reader(f)
        for keyword in csvreader:
            kw = keyword[0]
</code></pre>
<p>However, running it in Eclipse with Pydev 3.8 or 3.9 fails:</p>
<pre><code>pydev debugger: starting (pid: 64416)
Traceback (most recent call last):
  File "/Applications/eclipse/plugins/org.python.pydev_3.9.0.201411111611/pysrc/pydevd.py", line 2183, in &lt;module&gt;
    globals = debugger.run(setup['file'], None, None)
  File "/Applications/eclipse/plugins/org.python.pydev_3.9.0.201411111611/pysrc/pydevd.py", line 1622, in run
    pydev_imports.execfile(file, globals, locals)  # execute the script
  File "/Applications/eclipse/plugins/org.python.pydev_3.9.0.201411111611/pysrc/_pydev_imps/_pydev_execfile.py", line 18, in execfile
    exec(compile(contents+"\n", file, 'exec'), glob, loc) 
  File "/Users/antoinebrunel/src/test_pydev/test_pydev/test_pydev.py", line 14, in &lt;module&gt;
    for keyword in csvreader:
  File "/Users/antoinebrunel/.virtualenvs/seo3/lib/python3.4/encodings/ascii.py", line 26, in decode
    return codecs.ascii_decode(input, self.errors)[0]
UnicodeDecodeError: 'ascii' codec can't decode byte 0xc3 in position 5: ordinal not in range(128)
</code></pre>
<p>In order for the code to run, replace:</p>
<pre><code>with open(filename, mode='rt') as f:
</code></pre>
<p>with:</p>
<pre><code>with open(filename, mode='rt', encoding='utf-8') as f:
</code></pre>
<p>Note 1: The file <em>valid.csv</em> contains any character with accent, for example:</p>
<pre><code>Ã 
</code></pre>
<p>Note 2: In Eclipse preferences &gt; workspace, text file encoding is set to utf-8</p>
<p>Reference
<a href="https://stackoverflow.com/questions/26744231/pydev-encoding-error-in-debug-after-update">This StackOverflow question</a> may be related</p>
</div>
<div class="post-text" itemprop="text">
<p>From the <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow"><code>open()</code> function</a> documentation:</p>
<blockquote>
<p><em>encoding</em> is the name of the encoding used to decode or encode the file. This should only be used in text mode. <strong>The default encoding is platform dependent (whatever <code>locale.getpreferredencoding()</code> returns)</strong>, but any encoding supported by Python can be used.</p>
</blockquote>
<p>Emphasis mine. You should not rely on the default encoding; evidently the PyDev environment has been set to a locale where ASCII is the default codec.</p>
<p>If you know up front that your CSV is encoded to UTF-8, explicitly set the codec when opening the file, and do not assume that the system on which you are running this has been configured with UTF-8 as the preferred text data codec.</p>
</div>
<span class="comment-copy">Are you saying you already solved this? If so, put the answer part in a <i>answer post</i> below. Or is there still an actual question left here?</span>
<span class="comment-copy">This is still a question, it is not solved yet, a ticket #497 was also opened on <a href="https://sw-brainwy.rhcloud.com/tracker/PyDev/" rel="nofollow noreferrer">Pydev Brainwy tracker</a> and apparently this will be resolved for the next release.</span>
<span class="comment-copy">1- Maybe it's better to explicitly set encoding. However, in Eclipse, if the workspace text encoding setting is defined to utf-8, this setting should be used instead of ascii ... 2- Why does it fail in Eclipse and not when running it in Python or in python shell?</span>
<span class="comment-copy">@antoinet: the workspace text encoding has nothing do to with the default locale in Python code. What system are you running this on (what OS?). Clearly Eclipse is altering the environment; on POSIX systems for example it depends on the <code>LANG</code> variable what locale is being picked.</span>
<span class="comment-copy">@MartinPieters I'm using OSX 10.9.5. Either Pydev should use the same encoding as the Python interpreter, or there should be a setting in Eclipse to define the default encoding within pydev. Pydev developers are planning to resolve it by the next release (Ticket #497). Best!</span>
<span class="comment-copy">@antoinet: yes, Pydev should probably echo your system wide settings. Take into account though that the default can be changed <i>from shell to shell too</i>. Your code should never rely on the default, really.</span>
