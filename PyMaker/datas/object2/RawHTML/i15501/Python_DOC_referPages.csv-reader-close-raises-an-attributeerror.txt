<div class="post-text" itemprop="text">
<p>With the below code I get the error:</p>
<pre><code>PermissionError: [WinError 32] The process cannot access the file because it is being used by another process: 'Student Data.csv'
</code></pre>
<p>BUT if i add <code>r.close()</code> it returns me with the error:</p>
<pre><code>AttributeError: '_csv.reader' object has no attribute 'close'
</code></pre>
<p>The code for the keypad is 2580 and the CSV is in the format of </p>
<pre><code>bakerg,ict,George Baker,11HM,NORMAL
</code></pre>
<p>Code:</p>
<pre><code>from tkinter import *
import csv
import os
login = "bakerg"

def upgradetoadmin():
    global masterpassword
    masterpassword = []
    def one():
        masterpassword.append("1")
        arraycheck()
    def two():
        masterpassword.append("2")
        arraycheck()
    def three():
        masterpassword.append("3")
        arraycheck()
    def four():
        masterpassword.append("4")
        arraycheck()
    def five():
        masterpassword.append("5")
        arraycheck()
    def six():
        masterpassword.append("6")
        arraycheck()
    def seven():
        masterpassword.append("7")
        arraycheck()
    def eight():
        masterpassword.append("8")
        arraycheck()
    def nine():
        masterpassword.append("9")
        arraycheck()
    def zero():
        masterpassword.append("0")
        arraycheck()
    def clear():
        global masterpassword
        masterpassword = []
    def arraycheck():
        global masterpassword
        if len(masterpassword) == 4:
            if masterpassword == ['2','5','8','0']:
                print("Success")
                r = csv.reader(open('Student Data.csv'))
                lines = [l for l in r]
                print(lines)
                i = 0
                for item in lines:
                    if item[0] == login:
                        print(item)
                        print("YAY")
                        item[4] = "ADMIN"
                        print(item)
                        os.remove('Student Data.csv')
                        writer = csv.writer(open('Student Data.csv', 'w'))
                        writer.writerows(lines)

                print(login + " is now an admin")
            else:
                print("Invalid Code")
            masterpassword = []

    keypadwindow = Tk()
    keypadwindow.iconbitmap("hXYTZdJy.ico")
    keypadwindow.title("ADMIN UPGRADER")
    Button(keypadwindow, text="1", height = 4, width = 10, command = one).grid(column = 0, row = 0)
    Button(keypadwindow, text="2", height = 4, width = 10, command = two).grid(column = 1, row = 0)
    Button(keypadwindow, text="3", height = 4, width = 10, command = three).grid(column = 2, row = 0)
    Button(keypadwindow, text="4", height = 4, width = 10, command = four).grid(column = 0, row = 1)
    Button(keypadwindow, text="5", height = 4, width = 10, command = five).grid(column = 1, row = 1)
    Button(keypadwindow, text="6", height = 4, width = 10, command = six).grid(column = 2, row = 1)
    Button(keypadwindow, text="7", height = 4, width = 10, command = seven).grid(column = 0, row = 2)
    Button(keypadwindow, text="8", height = 4, width = 10, command = eight).grid(column = 1, row = 2)
    Button(keypadwindow, text="9", height = 4, width = 10, command = nine).grid(column = 2, row = 2)
    Button(keypadwindow, text="0", height = 4, width = 10, command = zero).grid(column = 1, row = 3)
    Button(keypadwindow, text="CLEAR", height = 4, width = 10, command = clear).grid(column = 2, row = 3)
    keypadwindow.mainloop()

upgradetoadmin()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><code>csv.reader</code> does not have a <code>close</code> method (or any other normal methods for that matter).  Instead, it takes a file object as its argument and iterates over it, yielding the lines one-by-one.</p>
<p>You should be calling <code>close()</code> on the file object itself:</p>
<pre><code>my_file = open('Student Data.csv')
r = csv.reader(my_file)
...
my_file.close()
</code></pre>
<p>Of course, a <a href="https://docs.python.org/3/reference/compound_stmts.html#the-with-statement">with-statement</a> will do this for you automatically:</p>
<pre><code>with open('Student Data.csv') as my_file:
    r = csv.reader(my_file)
    ...
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You need to close the <code>file</code> object returned by <code>open</code> not the <code>csv.reader</code>.</p>
<p>Use a <a href="https://docs.python.org/3.4/reference/compound_stmts.html#the-with-statement" rel="nofollow"><code>with</code></a> block to close the file for you:</p>
<pre><code>with open('Student Data.csv') as f:
    r = csv.reader(f)
    # ...
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I think you should have this:</p>
<pre><code>                f = open('Student Data.csv', 'w')
                writer = csv.writer(f)
                writer.writerows(lines)
                f.close() 
</code></pre>
</div>
<span class="comment-copy">Thanks, real help!! :D</span>
