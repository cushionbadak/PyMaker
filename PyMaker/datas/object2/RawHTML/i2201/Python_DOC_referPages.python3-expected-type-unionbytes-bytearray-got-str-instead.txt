<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/37974199/writing-to-io-bytesio-in-csv-fails-in-python3">Writing to io.BytesIO in csv fails in python3</a>
<span class="question-originals-answer-count">
                    1 answer
                </span>
</li>
</ul>
</div>
<p>I have a stable working project with python. It's running on python 2.7. I upgraded it to python 3.x. So, it's not working on Python3.</p>
<p>The logic is writing values to csv file.</p>
<p>Broken code is that:</p>
<pre><code>csv = io.BytesIO()

csv.write('fiscalYear\t'
                      'VKN\t'
                      'recordPeriod\t'
                      'enteredBy\t'
                      'entredDate\t'
                      'entryNumber\t'
                      'entryComment\t'
                      'batchID\t'
                      'batchDescription\t'
                      'totalDebit\t'
                      'totalCredit\t'
                      'amountOriginalExchangeRate\t'
                      'amountOriginalExchangeRateSource\t'
                      'amountOriginalExchangeRateComment\n'
            )

return csv.getvalue()
</code></pre>
<p>My problem is that:</p>
<pre><code>Expected type 'union[bytes, bytearray], got 'str' instead
</code></pre>
<p>Python log error: </p>
<pre><code>TypeError: a bytes-like object is required, not 'str'
</code></pre>
<p>I need your help!</p>
</div>
<div class="post-text" itemprop="text">
<p>You are writing a string (Unicode) to a BytesIO object.  You should probably switch your BytesIO to a StringIO.  If you truly want bytes, you can convert your Unicode strings to bytes using their <code>encode()</code> method, passing your preferred encoding scheme (e.g. <code>'utf-8'</code>).</p>
</div>
<div class="post-text" itemprop="text">
<p>As the error message says, you should pass binary data, not strings. Instead of</p>
<pre><code>csv.write(my_text)
</code></pre>
<p>write</p>
<pre><code>csv.write(my_text.encode())
</code></pre>
<p>to convert it to binary.</p>
</div>
<span class="comment-copy"><a href="https://docs.python.org/3/howto/pyporting.html#text-versus-binary-data" rel="nofollow noreferrer">docs.python.org/3/howto/pyporting.html#text-versus-binary-data</a></span>
