<div class="post-text" itemprop="text">
<p>I want to replace a parameter value from the URL using the following code. After replacing the value of parameter I get the following data in variable <strong>query_dict</strong> </p>
<pre><code>{
    'part': ['snippet,replies'],
    'allThreadsRelatedToChannelId': ['UCBqUbOUyAsTB7Xc7xQAHWZA'],
    'maxResults': ['100'],
    'pageToken': 'QURTSl9pMGhfWTZoU3dPX2dNendrSUZqRU1IVk5mTmVvVkpxT2c3dkJBbzdNME80SldsWnY0dHFYck9raUpxT0dqRm9pZ2k4Smo1Q2ZKSE5NWmZLWEVkcm5acC1paU9HUFpUaTlKdVljYjFqOUx5YzVVQzA4bmlSYkVxOGNISDVWY0E2ZmVuMVN5TFB6bWx2MGc=',
    'key': my_key
}
</code></pre>
<p>When I try to build url using unparse method it gives the following error</p>
<blockquote>
<p>not enough values to unpack (expected 7, got 6).</p>
</blockquote>
<p>What's wrong? Following is the current code</p>
<pre><code>r = urllib.request.urlopen(url)
a=r.read().decode('utf-8')
data =json.loads(a)
parts = urlparse(url)
query_dict = parse_qs(parts.query) 
query_dict['pageToken'] = data['nextPageToken']
build_url=urllib.parse.urlunparse(query_dict)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><code>urlunparse()</code> is the inverse of the <a href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlparse" rel="nofollow noreferrer"><code>urllib.parse.urlparse()</code> function</a> and deals with completely different information. It is not the function to use to create a new query string from your dictionary.</p>
<p>The proper inverse is the <a href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlencode" rel="nofollow noreferrer"><code>urllib.parse.urlencode()</code> function</a>, use that instead, with the <code>doseq</code> parameter set to <code>True</code> to handle the lists returned by <code>urlparse()</code>. See the <a href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.parse_qs" rel="nofollow noreferrer"><code>urlparse()</code> function documentation</a>:</p>
<blockquote>
<p>Use the <code>urllib.parse.urlencode()</code> function (with the <code>doseq</code> parameter set to <code>True</code>) to convert such dictionaries into query strings.</p>
</blockquote>
<p>You can then pass the resulting string back to <code>urlunparse</code> (together with the other <code>parts</code> minus the query string), or use the <a href="https://docs.python.org/3/library/collections.html#collections.somenamedtuple._replace" rel="nofollow noreferrer">namedtuple <code>_replace()</code> method</a> to create an updated <a href="https://docs.python.org/3/library/urllib.parse.html#structured-parse-results" rel="nofollow noreferrer">URL parse result object</a>, which has a <a href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urllib.parse.SplitResult.geturl" rel="nofollow noreferrer"><code>.geturl()</code> method</a>:</p>
<pre><code>from urllib.parse import urlparse, parse_qs, urlencode

parts = urlparse(url)
query_dict = parse_qs(parts.query) 
query_dict['pageToken'] = data['nextPageToken']
build_url = parts._replace(query=urlencode(query_dict), True).geturl()
</code></pre>
</div>
<span class="comment-copy"><a href="https://docs.python.org/3/library/urllib.parse.html#urllib.parse.urlunparse" rel="nofollow noreferrer"><code>urlunparse</code></a> takes a six-item iterable as argument. You are passing a dictionary.</span>
<span class="comment-copy">I note that the sample <code>query_dict</code> you include in your question has no <code>nextPageToken</code> key, so you'd get a key error there. The dictionary also has 5 keys, not 6, so your exception would state that it <code>(expected 7, got 5)</code>.</span>
<span class="comment-copy">great help @Martijn. I tried this but the resultant URL is not properly build I have the following URL url="<a href="https://www.googleapis.com/youtube/v3/commentThreads?part=snippet%2Creplies&amp;allThreadsRelatedToChannelId=UCBqUbOUyAsTB7Xc7xQAHWZA&amp;maxResults=100&amp;pageToken=QURTSl9pMmtEczg4MHVORVFQMXB5RVg2Q1Qxd1BLak9zQ1JjNDBpUWJfZ2NhdWV5R3pId0ZZbkFVcXhGSTdUc3d6bERrRk9nOU1vZnBTZGl5VV9kWm8wdjVfUmZGeWNsWTBnMy16My03ZXZfcWdKcWlRbmRJRG5lQUdLQlBjUXJPYTA%3D&amp;key=mykey" rel="nofollow noreferrer">googleapis.com/youtube/v3/â€¦</a>";</span>
<span class="comment-copy">@anil: anything wrong in that URL will have resulted from the <i>inputs</i>, not the code in my answer.</span>
<span class="comment-copy">anil: not that I can tell what might be wrong with it, because I don't have the original input string either. Please use backticks (<code>`</code>) around strings you want to communicate as literals.</span>
<span class="comment-copy"><code>url="https://www.googleapis.com/youtube/v3/commentThreads?part=snippet%2Creplies&amp;allThreadsRelatedToChannelId=UCBqUbOUyAsTB7Xc7xQAHWZA&amp;maxResults=100&amp;pageToken=QURTSl9pMmtEczg4MHVORVFQMXB5RVg2Q1Qxd1BLak9zQ1JjNDBpUWJfZ2NhdWV5R3pId0ZZbkFVcXhGSTdUc3d6bERrRk9nOU1vZnBTZGl5VV9kWm8wdjVfUmZGeWNsWTBnMy16My03ZXZfcWdKcWlRbmRJRG5lQUdLQlBjUXJPYTA%3D&amp;key=AIzaSyCNveCCr3exzqIZDUHhqgFVF3ujuy5plgA"; </code></span>
<span class="comment-copy">@anil: you <i>could</i> make matters much easier by using a dummy URL instead and explaining how that is not giving you the correct result. Such as <code>url = 'http://example.org/foo?part=bar&amp;key=spam'</code>, and go from there. That leaves out a whole lot of text that we <i>don't need here</i> to diagnose your issue.</span>
