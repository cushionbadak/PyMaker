<div class="post-text" itemprop="text">
<p>I created a <code>Python 3</code> script using the <code>BeautifulSoup</code> library. What it does, is going to the <code>duckduckgo</code> search engine using the following url: <code>https://duckduckgo.com/?q=searchterm</code> and then, it will display to me all the websites in the first page.</p>
<p>Here is the code and it is working perfectly:</p>
<pre><code>import requests
from bs4 import BeautifulSoup

r = requests.get('https://duckduckgo.com/html/?q=test')
soup = BeautifulSoup(r.text, 'html.parser')
results = soup.find_all('a', attrs={'class':'result__a'})

i = 0
while i &lt; len(results):
    link = results[i]
    url = link['href']
    print(url)
    i = i + 1
</code></pre>
<p>The thing is, I am not getting the urls in the proper format (example: <a href="https://www.google.com" rel="nofollow noreferrer">https://www.google.com</a>). Instead, I am getting all my urls in the format of a search query.</p>
<p>Here is what I mean when I search <code>test</code> on duckduckgo:</p>
<pre><code>/l/?kh=-1&amp;uddg=https%3A%2F%2Fduckduckgo.com%2Fy.js%3Fu3%3Dhttps%253A%252F%252Fr.search.yahoo.com%252Fcbclk%252FdWU9MEQwQzVENEZDNDU0NDlEMyZ1dD0xNTM4MzE4MTI3MzE5JnVvPTc3NTg0MzM1OTYxMTUyJmx0PTImZXM9ZVBGTU9iWUdQUy42cVdRVQ%252D%252D%252FRV%253D2%252FRE%253D1538346927%252FRO%253D10%252FRU%253Dhttps%25253a%25252f%25252fwww.bing.com%25252faclick%25253fld%25253dd3peyDLOVSWraifG78tpZ1GjVUCUzCMDkx%252DfJrFXeY2IfiXIwUmngX%252DYKvZWQ6q7hPHC_3kc%252DzBWS1SE015Or2c3CncFMVc9OjVV5OyB2kJqXdRsOzRnaCGy8gYCPuival0gLe7WCkfk_%252DAVKTWmYxranfh02ficTC7i6oC38n2q9U9KPe%252526u%25253dhttps%2525253a%2525252f%2525252fwww.dotdrugconsortium.com%2525252f%2525253futm_source%2525253dbing%25252526utm_medium%2525253dcpc%25252526utm_campaign%2525253dadcenter%25252526utm_term%2525253ddottest%252526rlid%25253d590f68ae34ff126ed0e3331eebd0c4fb%252FRK%253D2%252FRS%253DeKe3rY19jdg9vb_ayBSboMzPU1g%252D%26ad_provider%3Dyhs%26vqd%3D3%2D12729109948094676568590283448597440227%2D122882305188756590950269013545136161936
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.merriam%2Dwebster.com%2Fdictionary%2Ftest
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.speedtest.net%2F
/l/?kh=-1&amp;uddg=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FTest
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.dictionary.com%2Fbrowse%2Ftest
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.thefreedictionary.com%2Ftest
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.16personalities.com%2F
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.speakeasy.net%2Fspeedtest%2F
/l/?kh=-1&amp;uddg=http%3A%2F%2Fwww.humanmetrics.com%2Fcgi%2Dwin%2Fjtypes2.asp
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.typingtest.com%2F%3Fab
/l/?kh=-1&amp;uddg=https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FTest_cricket
/l/?kh=-1&amp;uddg=https%3A%2F%2Fged.com%2F
/l/?kh=-1&amp;uddg=http%3A%2F%2Fspeedtest.xfinity.com%2F
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.16personalities.com%2Ffree%2Dpersonality%2Dtest
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.merriam%2Dwebster.com%2Fthesaurus%2Ftest
/l/?kh=-1&amp;uddg=http%3A%2F%2Ftest%2Dipv6.com%2F
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.thesaurus.com%2Fbrowse%2Ftest
/l/?kh=-1&amp;uddg=http%3A%2F%2Fspeedtest.att.com%2Fspeedtest%2F
/l/?kh=-1&amp;uddg=http%3A%2F%2Fspeedtest.googlefiber.net%2F
/l/?kh=-1&amp;uddg=http%3A%2F%2Ftest.salesforce.com%2F
/l/?kh=-1&amp;uddg=https%3A%2F%2Fmy.uscis.gov%2Fprep%2Ftest%2Fcivics
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.tests.com%2F
/l/?kh=-1&amp;uddg=https%3A%2F%2Fen.wiktionary.org%2Fwiki%2FTest
/l/?kh=-1&amp;uddg=https%3A%2F%2Ftestmy.net%2F
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.google.com%2F
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.queendom.com%2Ftests%2Findex.htm
/l/?kh=-1&amp;uddg=http%3A%2F%2Fwww.yourdictionary.com%2Ftest
/l/?kh=-1&amp;uddg=http%3A%2F%2Fwww.testout.com%2F
/l/?kh=-1&amp;uddg=https%3A%2F%2Fimplicit.harvard.edu%2Fimplicit%2Ftakeatest.html
/l/?kh=-1&amp;uddg=http%3A%2F%2Fwww.act.org%2Fcontent%2Fact%2Fen%2Fproducts%2Dand%2Dservices%2Fthe%2Dact.html
/l/?kh=-1&amp;uddg=https%3A%2F%2Fwww.ets.org%2Fgre%2F
</code></pre>
<p>I would like to know if there is a way to display all these urls in the standard format.</p>
<p>Edit: This is not a duplication from my other topic, since in the last one I was told that the library PyCurl won't get me what i want (It wasn't able to catch the javascript code in the urls). Here my code is working but the output that I got isn't what I am expecting.</p>
</div>
<div class="post-text" itemprop="text">
<p>Python's <a href="https://docs.python.org/3/library/urllib.parse.html?highlight=urlparse#module-urllib.parse" rel="nofollow noreferrer"><code>urllib.parse</code></a> library can help you as follows:</p>
<pre><code>from bs4 import BeautifulSoup
import urllib.parse
import requests

r = requests.get('https://duckduckgo.com/html/?q=test')
soup = BeautifulSoup(r.text, 'html.parser')
results = soup.find_all('a', attrs={'class':'result__a'}, href=True)

for link in results:
    url = link['href']
    o = urllib.parse.urlparse(url)
    d = urllib.parse.parse_qs(o.query)
    print(d['uddg'][0])
</code></pre>
<p>This would display something starting:</p>
<pre class="lang-none prettyprint-override"><code>http://www.speedtest.net/
https://www.merriam-webster.com/dictionary/test
https://en.wikipedia.org/wiki/Test
https://www.thefreedictionary.com/test
https://www.dictionary.com/browse/test
</code></pre>
<p>First use <a href="https://docs.python.org/3/library/urllib.parse.html?highlight=urlparse#urllib.parse.urlparse" rel="nofollow noreferrer"><code>urlparse()</code></a> to get the path components. From this take the <code>query</code> string and pass it to <a href="https://docs.python.org/3/library/urllib.parse.html?highlight=urlparse#urllib.parse.parse_qs" rel="nofollow noreferrer"><code>parse_qs()</code></a> to further process it. You can then extract the link using the <code>uddg</code> name.</p>
</div>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/52550953/pycurl-javascript">Pycurl javascript</a></span>
<span class="comment-copy">The question is different since I found out that what I wanted is impossible with the library PyCurl, I changed libraries completely. If it's against the charts I don't mind updating the other link (I'm not very familiar with the forums rules). And I'm sorry if I did cause any trouble. Plus, here the question is completely different since my code is working but the output is not exactly what I was expecting.</span>
<span class="comment-copy">it's not about using any library, it's about scraping instead of using API, which is readily available as i pointed out.</span>
<span class="comment-copy">I really don't have any problem with the duckduckgo API. But sadly, this is a small college project and my teacher insists on using web scrapping. So the duckduckgo api isn't really an option. Plus, my code is already fully working but the format of the output isn't what I want.</span>
<span class="comment-copy">Thank you so much this is working like a charm!</span>
<span class="comment-copy">Awesome solution!!</span>
