<div class="post-text" itemprop="text">
<p>I'm trying to create a table in PostgreSQL using python psycopg2.
So when I execute: create_table(location) it makes the location table.
I've looked at various tutorials around the web. but I just can't get it to work, any ideas?</p>
<pre><code>import psycopg2

def create_table(table_name):
    try:
        conn = psycopg2.connect("dbname=db host=localhost user=user password=pw")
    except:
        print("I am unable to connect to the database") 

    cur = conn.cursor()
    try:
        cur.execute('''
        CREATE TABLE public.s% (
                id serial NOT NULL,
                x double precision,
                y double precision,
                z double precision,
                geom geometry, 
                dist double precision,
                CONSTRAINT test21_pkey PRIMARY KEY (id))
                ''')
    except:
        print("Error!")

    conn.commit()
    conn.close()
    cur.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The <code>s%</code> in your original code looks like an attempt at <a href="https://docs.python.org/3/library/stdtypes.html#printf-style-string-formatting" rel="nofollow noreferrer">%-formatting</a>, though the conversion specifier should be <code>%s</code> and you do not actually format the string. Since you are using <code>psycopg2</code> you should use the <a href="http://initd.org/psycopg/docs/sql.html" rel="nofollow noreferrer">SQL string composition</a> tools offered by it:</p>
<pre><code>from psycopg2 import sql

stmt = sql.SQL('''CREATE TABLE public.{} (
    id serial NOT NULL,
    x double precision,
    y double precision,
    z double precision,
    geom geometry, 
    dist double precision,
    CONSTRAINT test21_pkey PRIMARY KEY (id))
    ''')

cur.execute(stmt.format(sql.Identifier(table_name)))
</code></pre>
<p>Note that <code>stmt.format()</code> is not <code>str.format()</code>, but <a href="http://initd.org/psycopg/docs/sql.html#psycopg2.sql.SQL.format" rel="nofollow noreferrer"><code>SQL.format()</code></a>. This handles quoting the identifier correctly, if necessary.</p>
</div>
<div class="post-text" itemprop="text">
<p>Try the below,</p>
<pre><code>try:
        cur.execute('
        CREATE TABLE public.{} (
                id serial NOT NULL,
                x double precision,
                y double precision,
                z double precision,
                geom geometry, 
                dist double precision,
                CONSTRAINT test21_pkey PRIMARY KEY (id))
                '.format(table_name))
</code></pre>
</div>
<span class="comment-copy">Just edited now. Thanks for the comments.</span>
