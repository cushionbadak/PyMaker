<div class="post-text" itemprop="text">
<p>Before installing Visual Studio 2017, all my python files were successfully running using py (or py3) in PowerShell, Git Bash, and Cygwin Terminal, but not CMD.exe or MSYS:</p>
<pre><code>py myscript.py
</code></pre>
<p>This executable was installed directly by the Python 3.7 installer, and I configured the path variables for it.</p>
<p>After installing VS 2017, Microsoft inserted the path to their VS-specific copy of py.exe, <code>C:\Windows\py.exe</code> into the system <code>PATH</code> variable. This copy of python does nothing when run directly, and will not respond to <code>exit()</code> command to terminate its thread, and scripts do nothing when passed into it. Literally nothing works, not even <code>print()</code> statements.</p>
<p>In Visual Studio, after opening the "Solution Explorer" window and right clicking on script.py and clicking <code>Start without Debugging</code>, nothing happens.</p>
<p>If I click <code>Start with Debugging</code>, then it changes the view to a debugging mode, and "runs" the program (the pause and stop buttons are showing), but no execution window shows up. The Output panel automatically selects "Debug" and there is no output to see there. The "autos" and "locals" panels are not populated, indicating that nothing is actually running.</p>
<p>I don't want a work-around. I know I could delete this entry from PATH, but the official Python installation may not be compatible with VS 2017 or might lack integrations. I want to know why Microsoft's copy of <code>py.exe</code> fails at everything and what their official fix is for this problem.</p>
</div>
<div class="post-text" itemprop="text">
<p><em>This isn't really a proper answer, because I'm not sure about how it relates to the problem you're having with respect to Visual Studio 2017 and PowerShell—but since you asked me to post it as though it was one, I'm doing so.</em></p>
<hr/>
<p>Microsoft didn't install the <code>C:\Windows\py.exe</code> executable, the Python installer did.</p>
<p>Also note, it's not a Python interpreter, it's a command-line "launcher" utility that looks for special shebang (<code>#!</code> prefixed) comments at the beginning of script files. It makes running Python scripts on Windows work somewhat like it does on Linux—and helps when you have more than one Python version (such as both 2.x and 3.x) installed on your system.</p>
<p>See the following about using Python on Windows in the <a href="https://docs.python.org/3/using/windows.html?#python-launcher-for-windows" rel="nofollow noreferrer">Python documentation</a>. Also see Vinay Sajip's (the author) version control repository for the <a href="https://bitbucket.org/vinay.sajip/pylauncher/overview" rel="nofollow noreferrer">pylauncher project</a> which is where it originated.</p>
<p>As I said in the preface, I'm not sure how all this relates to your problem, but feel that understanding how things normally work may help you resolve the issue.</p>
<p>Hope you found it insightful...</p>
</div>
<div class="post-text" itemprop="text">
<p>Visual Studio 2017 uses PowerShell as its shell / execution environment.</p>
<p>The problem is due to some issue in PowerShell adopting the properties of Cygwin's execution environment including the virtual path.</p>
<p>The problem randomly went away. One second, PowerShell is reporting its working directory as <code>/cygdrive/c/folder/to/working/directory</code> and acting exactly like Cygwin Terminal. The next time I ran PowerShell, it functioned correctly, returning this kind of output to <code>pwd</code>:</p>
<pre><code>PS C:\WINDOWS\system32&gt; pwd

Path
---- 
C:\WINDOWS\system32
</code></pre>
<p>This problem is a combination of two problems. The first one has to do with py.exe not recognizing Cygwin as an interactive shell, as explained in <a href="https://stackoverflow.com/a/9549255/1710956">this answer</a>.</p>
<p>The second has to do with PowerShell adopting Cygwin's execution environment. Not sure how this happens, or why it suddenly stopped happening.</p>
</div>
<span class="comment-copy"><code>py.exe</code> isn't a Python interpreter, it's a "launcher" that looks for special shebang (<code>#!</code>) comments at the beginning of scripts. See this <a href="https://docs.python.org/3/using/windows.html?#python-launcher-for-windows" rel="nofollow noreferrer">documention</a>. Also see the <a href="https://bitbucket.org/vinay.sajip/pylauncher/overview" rel="nofollow noreferrer">pylauncher project</a>.</span>
<span class="comment-copy">@martineau can you write that as an answer to the question?</span>
