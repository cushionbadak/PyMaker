<div class="post-text" itemprop="text">
<p>Trying to implement Logistic Regression in Python:</p>
<p>Below is the Cost Function:</p>
<pre><code>def costFunction(theta_array):
   m = len(X1)
   theta_matrix = np.transpose(np.mat(theta_array))

   H_x = 1 / (1 + np.exp(-X_matrix * theta_matrix))
   J_theta = ((sum(np.multiply((-Y_matrix), np.log(H_x)) - np.multiply((1 - Y_matrix), np.log(1 - H_x)))) / m )[0, 0]

   return J_theta
</code></pre>
<p>Below is the Gradient Function:</p>
<pre><code>def gradientDesc(theta_tuple):
   theta_matrix = np.transpose(np.mat(theta_tuple))

   H_x = 1 / (1 + np.exp(-X_matrix * theta_matrix))
   G_theta0 = (sum(np.multiply(H_x - Y_matrix, X_matrix[:, 0])) / m)[0, 0]
   G_theta1 = (sum(np.multiply(H_x - Y_matrix, X_matrix[:, 1])) / m)[0, 0]
   G_theta2 = (sum(np.multiply(H_x - Y_matrix, X_matrix[:, 2])) / m)[0, 0]


   return np.array((G_theta0, G_theta1, G_theta2))
</code></pre>
<p>Then I run the optimize.fmin_bfgs function, as below:</p>
<pre><code>initial_theta = np.zeros((3, 1))
theta_tuple = (0, 0, 0)

theta_optimize = op.fmin_bfgs(costFunction, initial_theta, gradientDesc, args = (theta_tuple))
</code></pre>
<p>Then I got the error below:</p>
<pre><code>**TypeError: gradientDesc() takes exactly 1 argument (4 given)**
</code></pre>
<p>Could anyone tell me how to fix?   :)     Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>For the <code>args</code> parameter you should specify a single-item tuple (also known as a <a href="https://docs.python.org/3/tutorial/datastructures.html#tuples-and-sequences" rel="nofollow noreferrer">singleton</a>) with a comma instead; otherwise the parentheses do nothing more than grouping the expression.</p>
<p>Change:</p>
<pre><code>theta_optimize = op.fmin_bfgs(costFunction, initial_theta, gradientDesc, args = (theta_tuple))
</code></pre>
<p>to:</p>
<pre><code>theta_optimize = op.fmin_bfgs(costFunction, initial_theta, gradientDesc, args = (theta_tuple,))
</code></pre>
<p>Also, your <code>gradientDesc</code> should accept an additional parameter per the <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.fmin_bfgs.html" rel="nofollow noreferrer">documentation</a>.</p>
<p>Change:</p>
<pre><code>def gradientDesc(theta_tuple):
</code></pre>
<p>to:</p>
<pre><code>def gradientDesc(x, theta_tuple):
</code></pre>
</div>
<span class="comment-copy">Now, there's still error. This time it is TypeError: gradientDesc() takes exactly 1 argument (2 given),   instead of (4 given)          :(</span>
<span class="comment-copy">Please see my updated answer.</span>
