<div class="post-text" itemprop="text">
<p>I have 1000 records that I would like to loop through in chunks of 100 and write to multiple files. The below code creates the same set of data in all the files. </p>
<pre><code>conn = cx_Oracle.connect('username/password@db')
curs = conn.cursor()
curs.execute('SELECT * FROM TABLE ORDER BY CREATION_TIME')
result = curs.fetchmany(100)
items = [dict(zip([key[0] for key in curs.description], row)) for row in result]
for i in range(10):
    with open('C:\\Users\\Output%i.json' % i, 'w') as outfile:
        json.dump({'items': items}, outfile, sort_keys=True, indent=1, ensure_ascii=False, default=default)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You need to call <code>curs.fetchmany()</code> in a loop, not put a loop after fetching 100 rows.</p>
<pre><code>i = 0
while True:
    result = curs.fetchmany(100)
    if len(result) == 0:
        break:
    items = [dict(zip([key[0] for key in curs.description], row)) for row in result]
    with open('C:\\Users\\Output%i.json' % i, 'w') as outfile:
        json.dump({'items': items}, outfile, sort_keys=True, indent=1, ensure_ascii=False, default=default)
    i += 1
</code></pre>
</div>
<span class="comment-copy">And your question is?</span>
<span class="comment-copy">how would i loop it in such a way that the data is chunked in 100's in multiple files until there are no more rows.</span>
<span class="comment-copy">something like <a href="https://stackoverflow.com/a/42818751/7540911">this</a>?</span>
<span class="comment-copy">What is <code>for i in range(10):</code> for? Why are you splitting 100 rows by 10?</span>
<span class="comment-copy">You are only fetching once, so of course you are writing the same data over and over.</span>
