<div class="post-text" itemprop="text">
<p>I have a file with roughly 10m lines. Each line is most likely unique, but I'm sorting the file by column 1 then 2 then 3. </p>
<pre><code>Column 1 = CODE
Column 2 = DATE
Column 3 = AMOUNT
</code></pre>
<p>I only want to keep the first line until the next date and so on. Below is an example of what I have and what I need the output to be.</p>
<pre><code>Original:  
COL1   COL2         COL3  
ABA    2019-01-01   100  
ABA    2019-01-01   111  
ABA    2019-01-02   140  
ABA    2019-01-02   150  
ABA    2019-01-03   200  
ABA    2019-01-03   220  

Ouptut needed:  
COL1   COL2         COL3  
ABA    2019-01-01   100  
ABA    2019-01-02   140  
ABA    2019-01-03   200  
</code></pre>
<p>Anyone able to help me.  Have tried</p>
<p><code>a.drop_duplicates(subset[data.columns[0],data.columns[1],data.columns[2]], keep='first')</code></p>
</div>
<div class="post-text" itemprop="text">
<p>Your solution is almost correct. This version is a modified version:</p>
<pre><code>&gt;&gt; a.drop_duplicates(subset = [a.columns[0],a.columns[1]], keep='first')
</code></pre>
<p>That produces:</p>
<pre><code>    COL1    COL2        COL3
0   ABA     2019-01-01  100
2   ABA     2019-01-02  140
4   ABA     2019-01-03  200
</code></pre>
<p>Explaining the modifications:</p>
<ol>
<li><em>subset</em> is a named parameter, as you can see on the documentation of <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.drop_duplicates.html" rel="nofollow noreferrer">drop_duplicates</a>;</li>
<li>if column 3 can vary, it shouldn't be present on the subset parameter. The duplicate should consider the first 2 columns;</li>
<li>the names you used in the code are not consistent, naming a and data for apparently the same object;</li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p>try groupby and then first:</p>
<pre><code>a.groupby([data.columns[0],data.columns[1]], as_index=False).first()
</code></pre>
</div>
<span class="comment-copy">What is <code>a</code>?  What was wrong with what you tried?</span>
