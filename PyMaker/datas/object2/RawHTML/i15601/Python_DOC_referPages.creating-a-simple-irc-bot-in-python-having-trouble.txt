<div class="post-text" itemprop="text">
<p>So a few hours ago I decided to try my hands on sockets with python and build a simple irc bot. So far I'm having some trouble getting it connected to the server. I get the following erros:</p>
<pre><code>b":irc.ku.cx 439 * :Please wait while we process your connection.\r\n:irc.ku.cx NOTICE AUTH :*** Couldn't look up your hostname (cached)\r\n"
b':irc.ku.cx NOTICE AUTH :*** Checking Ident\r\n'
b':irc.ku.cx NOTICE AUTH :*** No Ident response\r\n'
</code></pre>
<p>After that it stalls out. But about a minute of it running I suddenly get an endless amount of <code>b""</code>, each in a new line (probably something to do with the while loop in the code). This is my code:</p>
<pre><code>import socket

server = 'irc.rizon.net'
channel = '#linux'
nick = 'MyBot'
port = 6667

ircsock = socket.socket()
ircsock.connect((server, port))

ircsock.send(bytes('"NICK " + nick', 'UTF-8'))
ircsock.send(bytes('"USER " + nick + " " + nick + " " + nick + " :" + nick', 'UTF-8'))

while True:
    data = ircsock.recv(2048)
    print (data)

    if data.find(b"PING") != -1:
        ircsock.send(b"PONG :" + data.split(':')[1])
</code></pre>
<p>Thanks for any help you guys can provide.</p>
</div>
<div class="post-text" itemprop="text">
<p>As icktoofay said, there are extra quotes in your code. Also, in IRC you need to add a line break (<code>\r\n</code>) to the end of every command.</p>
<p>Replace these lines:</p>
<pre><code>ircsock.send(bytes('"NICK " + nick', 'UTF-8'))
ircsock.send(bytes('"USER " + nick + " " + nick + " " + nick + " :" + nick', 'UTF-8'))
</code></pre>
<p>with</p>
<pre><code>ircsock.send(bytes("NICK " + nick + "\r\n", 'UTF-8'))
ircsock.send(bytes("USER " + nick + " " + nick + " " + nick + " :" + nick + "\r\n", 'UTF-8'))
</code></pre>
<p>and it should work.</p>
<p>By the way, I recommend using <a href="https://docs.python.org/3/library/socket.html#socket.socket.makefile" rel="nofollow"><code>socket.makefile()</code></a> instead, which handles buffering and encoding for you. Here's your code modified to use the file interface:</p>
<pre><code>import socket

server = 'irc.rizon.net'
channel = '#linux'
nick = 'MyBot'
port = 6667

ircsock = socket.socket()
ircsock.connect((server, port))

handle = ircsock.makefile(mode='rw', buffering=1, encoding='utf-8', newline='\r\n')

print('NICK', nick, file=handle)
print('USER', nick, nick, nick, ':'+nick, file=handle)

for line in handle:
    line = line.strip()
    print(line)

    if "PING" in line:
        print("PONG :" + line.split(':')[1], file=handle)
</code></pre>
<p>Here, I use the <code>print</code> function which inserts spaces and newlines automatically.</p>
</div>
<span class="comment-copy">possible duplicate of <a href="http://stackoverflow.com/questions/1100840/irc-python-bot-best-way">IRC Python Bot: Best Way</a></span>
<span class="comment-copy">You quoted one too many times. Remove the single quotes in the <code>send</code> call.</span>
<span class="comment-copy">You were correct, I forgot to add a linebreak after every send() command. It works well enough. Unfortunately using makefile() results in the same error with it stalling at <code>No Ident response</code> and then automatically closing the link because <code>Registration Timed Out</code>. I tried copying your example verbatim and same error.</span>
<span class="comment-copy">"No ident response" is normal. It means there's no <a href="https://en.wikipedia.org/wiki/Ident_protocol" rel="nofollow noreferrer">ident server</a> running on your machine, but you should still be able to connect without one. As for your second problem, <a href="http://stackoverflow.com/questions/323189/irc-bot-error-registration-timeout">this question</a> might help.</span>
<span class="comment-copy">According to that link you sent, the problem was solved by sending <code>'\r\n'</code>. But aren't I already sending that via <code>print</code> by default?</span>
<span class="comment-copy">I found the problem. The socket uses block buffering by default, and since we never queue enough data to fill the buffer the messages are never sent. The solution is to add <code>buffering=1</code> to the <code>makefile()</code> call, which changes it to line buffering instead.</span>
<span class="comment-copy">Awesome, that worked. Thank you very much for your help.</span>
