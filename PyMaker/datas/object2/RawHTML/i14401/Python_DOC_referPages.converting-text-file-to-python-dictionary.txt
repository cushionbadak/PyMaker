<div class="post-text" itemprop="text">
<p>I am having issues converting a text file to a python dictionary. Fortunately, the text file has a ":" that divides my future key with its value. For example, every row is structured like this "-Project Manager: John Caldwell". Id like to loop through a directory that contains numerous text files. In the process id like to strip away a '-' that each row has. Here is the code that i have so far:</p>
<pre><code>import sys, traceback,os, csv, itertools
from collections import defaultdict

def get_metadata(filepath):
    d = defaultdict(list)
    for files in filepath:
        if files.endswith(".txt"):
            with open(files,'r') as in_file:
                for line in in_file:
                    k,v = line.strip('-').split(':')
                    d[k].append(v)

    return d

root_directory = get_metadata("C:\Random")
print root_directory
</code></pre>
<p>This is what i get when i run the script</p>
<pre><code>defaultdict(&lt;type 'list'&gt;, {})
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The problem is that <code>"C:\Random"</code> isn't a list of files, it's just a string. So, <code>for files in filepath</code> gives you <code>'C'</code>, then <code>':'</code>, then <code>'\'</code>, and so on. None of those end in <code>.txt</code>, so you don't open any files or do anything else.</p>
<p>What you want is probably <a href="https://docs.python.org/3/library/os.html#os.listdir" rel="nofollow"><code>for files in os.listdir(filepath):</code></a>.</p>
<p>Or, if you want to open all files in that directory or any subdirectories (recursively), use <a href="https://docs.python.org/3/library/os.html#os.walk" rel="nofollow"><code>walk</code></a> (see the linked docs for sample code).</p>
<p>As bgporter points out, if the only reason you're calling <code>listdir</code> is to then check each filename against a pattern, you may want to use <a href="https://docs.python.org/3/library/glob.html#glob.glob" rel="nofollow"><code>for files in glob.glob(os.path.join(filepath, '*.txt')):</code></a> to skip the need for the <code>if</code> test.</p>
</div>
<span class="comment-copy">As a side note, don't use unescaped backslashes in non-raw string literals.  You happen to get away with it here, but try it with <code>"C:\random"</code> and you'll get a nasty surprise. You can use a raw string (<code>r"C:\Random"</code>), escape your backslashes (<code>"C:\\Random"</code>), or (except in rare cases) use forward slashes instead (<code>"C:/Random"</code>).</span>
<span class="comment-copy">Also, your values are going to end up with newlines on the end. You may want <code>line.rstrip().lstrip('-').split(':')</code> or similar to take care of that.</span>
<span class="comment-copy">@abarnert I am getting this as an error:  ValueError: need more than 1 value to unpack</span>
<span class="comment-copy">The <code>ValueError</code> looks like a new problem that you'll want to create a new question for if you can't solve it yourself. But I'll give 50/50 odds that the problem is just that you have blank lines somewhere in the file (maybe just one at the end), and trying to <code>split</code> a blank line into <code>k</code> and <code>v</code> is obviously going to fail. You can handle that by checking for empty lines (<code>if strippedline: k, v = strippedline.split(':')</code>), or by using a <code>try</code>/<code>except</code>, or a couple other ways, depending on whether you just want to silently ignore empty lines, or anything unexpected, orâ€¦</span>
<span class="comment-copy">One more thing: you may want to <code>strip</code> the <code>v</code> and maybe <code>k</code> values as well; otherwise, you're going to end up with a project manager named <code>" John Caldwell"</code> instead of <code>"John Caldwell"</code>.</span>
<span class="comment-copy">...or use <code>glob.glob()</code> to just get a list of the .txt files that are of interest...</span>
<span class="comment-copy">@bgporter: Good point; added to the answer. Thanks.</span>
<span class="comment-copy">Great feedback! Id assume the part where i convert txt to dictionary is correct? Its giving me a ValueError ValueError: need more than 1 value to unpack</span>
<span class="comment-copy">@user40720: The rest of it looks fine. For the <code>ValueError</code> see my comment on the question.</span>
