<div class="post-text" itemprop="text">
<p>When I try reading a value from this key, the proper value of this key is not returned, but instead I get a different key path's value?</p>
<pre><code>import _winreg as wreg
key = wreg.OpenKey(wreg.HKEY_LOCAL_MACHINE, "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run")
print(wreg.EnumValue(key, 0))
</code></pre>
<p>And the output:</p>
<pre><code>('SunJavaUpdateSched', u'"C:\\Program Files (x86)\\Common Files\\Java\\Java Update\\jusched.exe"', 1)
</code></pre>
<p>But this value is not part of the key I used? This value is not located at this key I should of got a different value.
I searched of where the value is located of the incorrect value on RegEdit and its located at</p>
<pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Run
</code></pre>
<p>When I use command prompt</p>
<pre><code>REG QUERY HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
</code></pre>
<p>And I get the proper output...</p>
<pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
IgfxTray    REG_SZ    "C:\Windows\system32\igfxtray.exe"
HotKeysCmds    REG_SZ    "C:\Windows\system32\hkcmd.exe"
Persistence    REG_SZ    "C:\Windows\system32\igfxpers.exe"
</code></pre>
<p>Then I would try using os.popen on python...</p>
<pre><code>import os
buff = os.popen("REG QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run")
print(buff.read())
</code></pre>
<p>And the output</p>
<pre><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
SunJavaUpdateSched    REG_SZ    "C:\Program Files (x86)\Common Files\Java\Java Update\jusched.exe"
</code></pre>
<p>Why are these different? How can I get the correct value using <code>_winreg</code>?</p>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p>On WOW64, 32-bit applications view a registry tree that is separate from the registry tree that 64-bit applications view. Registry reflection copies specific registry keys and values between the two views.</p>
</blockquote>
<p>You should disable registry <a href="https://docs.python.org/3/library/winreg.html#winreg.DisableReflectionKey" rel="nofollow">reflection</a>.</p>
<pre><code>_winreg.DisableReflectionKey()
# Do stuff ...
# ...
# ...
_winreg.EnableReflectionKey()
</code></pre>
</div>
<span class="comment-copy">Probably has something to do with <a href="https://msdn.microsoft.com/en-us/library/aa384129%28v=VS.85%29.aspx" rel="nofollow noreferrer">Alternate Registry Views</a> because you're running 32-bit Python on a 64-bit version of the OS. This is mentioned in the <code>_winreg</code> <a href="https://docs.python.org/2/library/_winreg.html#bit-specific" rel="nofollow noreferrer">documentation</a>.</span>
<span class="comment-copy">How did you set the value?</span>
<span class="comment-copy">@vks These key values are auto-installed, I just want to retrieve them.</span>
<span class="comment-copy">Can you try via <code>wreg.OpenKeyEx</code></span>
<span class="comment-copy">@vks Tried, same result</span>
<span class="comment-copy">I tried using <code>.DisableReflectionKey()</code> with the argument of my <code>key</code> and it didn't work. I also tried it with the argument '<code>.HKEY_LOCAL_MACHINE</code> and it also did not work, they both returned the <code>('SunJavaUpdateSched', ...,1)</code> which is the 32-bit value I'm assuming.</span>
<span class="comment-copy">What does _winreg.QueryReflectionKey(...) return after trying with both those arguments?</span>
<span class="comment-copy">@Eric Both True.</span>
