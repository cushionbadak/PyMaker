<div class="post-text" itemprop="text">
<p>I'm using the <a href="https://pypi.python.org/pypi/ImageHash" rel="nofollow">ImageHash</a> module to get hashes of images. I have this code:</p>
<pre><code>hashSize = 8
imghash3 = []
image = "pic1.jpg"

imghash1 = imagehash.phash(Image.open(image))
print(imghash1)
&gt;&gt;&gt;d1d1f1f3f3737373
imghash2 = str(imagehash.phash(Image.open(image), hashSize))
print(imghash2)
&gt;&gt;&gt;11b97c7eb158ac
imghash3.append(bin( int(imghash2, 16))[2:].zfill(64))
print(imghash3)
&gt;&gt;&gt;['0000000000010001101110010111110001111110101100010101100010101100']
</code></pre>
<p>So <code>imagehash1</code> is the basic usage of the module. </p>
<p>Now what I don't understand is what kind of transformation the <code>hashSize</code> made to the original string in <code>imagehash2</code> and how the 3rd function convert the <code>imagehash2</code> into a 64 bit string.</p>
</div>
<div class="post-text" itemprop="text">
<p>During <code>phash</code> computation original image is resized. <code>hashSize</code> parameter basically controls height and width of resized image.  </p>
<p>Algorithm can be found  <a href="http://www.hackerfactor.com/blog/index.php?/archives/432-Looks-Like-It.html" rel="nofollow noreferrer">here</a>. Implementation of the first step (reduce size):</p>
<pre><code>image = image.convert("L").resize((hash_size, hash_size), Image.ANTIALIAS)
</code></pre>
<p>See sources of <a href="https://github.com/JohannesBuchner/imagehash/blob/master/imagehash/__init__.py#L116" rel="nofollow noreferrer"><code>imagehash.phash</code></a></p>
<hr/>
<p>Lets see what the line <code>imghash3.append(bin( int(imghash2, 16))[2:].zfill(64))</code> does.</p>
<pre><code>In [16]: imghash2 = '11b97c7eb158ac'
</code></pre>
<p>First of all it converts hexadecimal string into integer</p>
<pre><code>In [17]: int(imghash2, 16)
Out[17]: 4989018956716204
</code></pre>
<p>The builtin <a href="https://docs.python.org/3/library/functions.html#bin" rel="nofollow noreferrer"><code>bin</code></a> function is applied to convert the integer into a binary string</p>
<pre><code>In [18]: bin( int(imghash2, 16))
Out[18]: '0b10001101110010111110001111110101100010101100010101100'
</code></pre>
<p>Drops first two characters using <a href="https://stackoverflow.com/a/509295/471899">list slice</a></p>
<pre><code>In [19]: bin( int(imghash2, 16))[2:]
Out[19]: '10001101110010111110001111110101100010101100010101100'
</code></pre>
<p><a href="https://docs.python.org/3/library/stdtypes.html?highlight=zfill#str.zfill" rel="nofollow noreferrer">Adds <code>0</code></a> on the left side to make a string of 64 characters total </p>
<pre><code>In [20]: bin( int(imghash2, 16))[2:].zfill(64)
Out[20]: '0000000000010001101110010111110001111110101100010101100010101100'
</code></pre>
</div>
<span class="comment-copy"><i>"this line"</i> is what line? Please don't write a meaningless title like that and then even make it wrong by posting more than a line.</span>
<span class="comment-copy">I'm sorry but I didn't really know how to describe it. Can you suggest me a more clear title?</span>
