<div class="post-text" itemprop="text">
<p>I am struggling with a problem which is explained below. I am sharing incomplete python script also which does not work for this problem. I would be grateful if get support or instruction for my script.</p>
<p>my tab delimited file look like this:</p>
<pre><code>+   5     1364182    TTGC
-   5     1364204    GATG
+   1     9372980    TTCA
-   1     9373028    GGAA
+   2     14029383   ACCA
-   2     14029437   ACCA
-   1     19815169   AGTT
-   1     19815254   CCGT
+   4     13475195   AGCA
-   4     13475251   TCTC
-   5     64182      TTGC
-   5     64204      GATG
+   1     9372980    TTCA
-   1     9373028    GGAA
+   2     14029383   ACCA
-   2     14029586   ACCT
</code></pre>
<p>I my trying to remove the whole rows on the basis of first column (which is + and -) if it duplicates consecutively except the first match. The output should look like:</p>
<pre><code>+   5     1364182    TTGC
-   5     1364204    GATG
+   1     9372980    TTCA
-   1     9373028    GGAA
+   2     14029383   ACCA
-   2     14029437   ACCA
+   4     13475195   AGCA
-   4     13475251   TCTC
+   1     9372980    TTCA
-   1     9373028    GGAA
+   2     14029383   ACCA
-   2     14029586   ACCT
</code></pre>
<p>Script:</p>
<pre><code>#!/usr/bin/python

gff = raw_input("Enter the gff file: ")
gff_file = open(gff, "r")
f1 = open("f1", "w")

for line in gff_file:
        line = line.rstrip()
        line = line.split("\t")
        x = line[0]
        for line1 in gff_file:
                line1 = line1.rstrip()
                line1 = line1.split("\t")
                y = next(line1[0])
                if x != y:
                        f1.write(x + line1[0]+"\n")
</code></pre>
<p>I am unable to compare first column entry with consecutive same column entry.
The file is very large so one liner is not working.</p>
</div>
<div class="post-text" itemprop="text">
<p>if this is not a programming exercise and you just want to clean the data, switch to <code>awk</code>.  It's not even a one-liner.</p>
<pre><code>$ awk 'p!=$1{p=$1; print}' file

+   5     1364182    TTGC
-   5     1364204    GATG
+   1     9372980    TTCA
-   1     9373028    GGAA
+   2     14029383   ACCA
-   2     14029437   ACCA
+   4     13475195   AGCA
-   4     13475251   TCTC
+   1     9372980    TTCA
-   1     9373028    GGAA
+   2     14029383   ACCA
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If I understand correctly, you're basically grouping by clusters of the first symbol (<code>+</code> or <code>-</code>), and you want to keep only the first.  This is a good use case for <a href="https://docs.python.org/3/library/itertools.html#itertools.groupby" rel="nofollow"><code>itertools.groupby</code></a>:</p>
<pre><code>from itertools import groupby

with open("data.gff") as fp_in, open("data_reduced.gff","w") as fp_out:
    grouped = groupby(fp_in, key=lambda x: x.split("\t")[0])
    for key, group in grouped:
        fp_out.write(next(group))
</code></pre>
<p><code>groupby</code> accepts an iterable (here the input file <code>fp_in</code>) and a key function, which I'm passing as <code>lambda x: x.split("\t")[0]</code>, meaning "take the line, split it by tabs, and give me the first element".</p>
<p>It yields pairs containing a key (which here will be <code>+</code> or <code>-</code>) and an iterator over all the elements of the group -- in this case, the contiguous groups of lines starting with the same sign.  We select the first with <code>next(group)</code> and write it out. </p>
</div>
<div class="post-text" itemprop="text">
<p>This should do the trick:</p>
<pre><code>consec_lines = False
x = None
for line in gff_file:
    line = line.rstrip()
    line = line.split("\t")
    if line[0] == x:
        consec_lines = True
        continue
    x = line[0]
    consec_lines = False
    for i in line+"\n":
        f1.write(i)
</code></pre>
</div>
<span class="comment-copy">Can you elaborate more! Your example is not readily understandable!</span>
<span class="comment-copy">What are you trying to achieve with <code>y = next(line1[0])</code>?</span>
<span class="comment-copy">Why would you remove <code>-   1     19815169   AGTT</code>?</span>
<span class="comment-copy">Actually he is removing <code>-   1     19815169   AGTT</code> and <code>-   1     19815254   CCGT</code>!</span>
<span class="comment-copy">@Dataman I have edited the example please have a look</span>
