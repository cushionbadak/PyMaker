<div class="post-text" itemprop="text">
<p>How can i create a HTTP session and save the packets of it?
i have got this code:</p>
<p>import logging
logging.getLogger("scapy.runtime").setLevel(logging.ERROR)</p>
<p>from scapy.all import *</p>
<p>get='GET / HTTP/1.0\n\n'</p>
<p>ip=IP(dst="www.google.com")</p>
<p>port=RandNum(1024,65535)</p>
<p>SYN=ip/TCP(sport=port, dport=80, flags="S", seq=42)</p>
<p>SYNACK=sr1(SYN)</p>
<p>ACK=ip/TCP(sport=SYNACK.dport, dport=80, flags="A", seq=SYNACK.ack, ack=SYNACK.seq + 1) / get</p>
<p>reply,error=sr(ACK)</p>
<p>but in my code i don't want to send any packets just to get the answer(simulate the situation of the sending functions of SYNACK=sr1(SYN) and reply,error=sr(ACK) without really using them)..
i want to simulate the session between two ips(with their ports) and with the payload and then save everything as packets as cap file.. how can i do this?</p>
</div>
<div class="post-text" itemprop="text">
<p>The jargon you're looking for is 'mocking'. Later versions of python unit testing have <a href="https://docs.python.org/3/library/unittest.mock.html" rel="nofollow">unittest.mock</a> and there are also external libraries available that can pretend to be external sources like files, databases and websites that allow you to test your code.</p>
</div>
<span class="comment-copy">what should i write instead of SYNACK=sr1(SYN)?</span>
