<div class="post-text" itemprop="text">
<p>I am trying to select specific columns from a large tab-delimited CSV file and output only certain columns to a new CSV file. Furthermore, I want to recode the data as this happens. If the cell has a value of 0 then just output 0. However, if the cell has a value of greater than 0, then just output 1 (i.e., all values greater than 0 are coded as 1).</p>
<p>Here's what I have so far:</p>
<pre><code>import csv

outputFile = open('output.csv', 'wb')
outputWriter = csv.writer(outputFile)
included_cols = range(9,2844)

with open('source.txt', 'rb') as f:
    reader = csv.reader(f, delimiter='\t')
    for row in reader:
        content = list(row[i] for i in included_cols)
        outputWriter.writerow(content)
</code></pre>
<p>The first issue I am having is that I want to also take from column 6. I wasn't sure how to write column 6 and then columns 9-2844.</p>
<p>Second, I wasn't sure how to do the recoding on the fly as I write the new CSV.</p>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p>I wasn't sure how to write column 6 and then columns 9-2844.</p>
</blockquote>
<pre><code>included_cols = [6] + list(range(9,2844))
</code></pre>
<p>This works because <a href="https://docs.python.org/3/library/stdtypes.html#common-sequence-operations" rel="nofollow">you can add two lists together</a>. Note that in Python3, <a href="https://docs.python.org/3/library/functions.html#func-range" rel="nofollow"><code>range</code></a> doesn't return a list, so we have to coerce it.</p>
<blockquote>
<p>I wasn't sure how to do the recoding on the fly</p>
</blockquote>
<pre><code>content = list((1 if row[i] &gt; 0 else 0) for i in included_cols)
</code></pre>
<p>This works because of the <a href="https://docs.python.org/3/reference/expressions.html#conditional-expressions" rel="nofollow">conditional expression</a>: <code>1 if row[i] &gt; 0 else 0</code>. The general form <code>A if cond else B</code> evaluates to either <code>A</code> or <code>B</code>, depending upon the condition. </p>
<p>Another form, which I think is <a href="http://www.urbandictionary.com/define.php?term=too+smart+by+half" rel="nofollow">"too clever by half"</a> is <code>content = list((row[i] and 1) for i in included_cols)</code>. This works because the <a href="https://docs.python.org/3/reference/expressions.html#boolean-operations" rel="nofollow"><code>and</code> operator</a> always returns one or the other of its inputs.</p>
</div>
<div class="post-text" itemprop="text">
<p>This should work:</p>
<pre><code>import csv

outputFile = open('output.csv', 'wb')
outputWriter = csv.writer(outputFile)
included_cols = [5] + range(8,2844) # you can just merge two lists

with open('source.txt', 'rb') as f:
    reader = csv.reader(f, delimiter='\t')
    outputWriter.writerow(reader[0]) # write header row unchanged
    for row in reader[1:]: # skip header row
        content = [int(row[i]) if i == 5 else (0 if int(row[i]) == 0 else 1) for i in included_cols]
        outputWriter.writerow(content)
</code></pre>
</div>
<span class="comment-copy">As with the answer above, that seems to recode the entire row to a '1'. I was looking to recode just the single cell to a '1'.</span>
<span class="comment-copy">Shouldn't that be <code>included_cols = [5] + range(8, 2844)</code> since the first column is at index 0 in the list?</span>
<span class="comment-copy">As with the other code, that seems to recode the entire row to a '1'. I was looking to recode just the single cell to a '1'.</span>
<span class="comment-copy">Are items in row already converted to integers or are they just strings representing a number? In case they are strings I added conversion to int. Without the conversion comparison of string with 0 will always evaluate to false.</span>
<span class="comment-copy">Shouldn't that be <code>included_cols = [5] + range(8, 2844)</code> since the first column is at index 0 in the list?</span>
<span class="comment-copy">@user2676699 yes you are correct.   That seems to have worked, but I had to remove the header otherwise it would try to test that as well. How do I write the header first but skip it for the testing? Also, I realized that I just want to write column 5 without trying to transform it. How can I do that?</span>
<span class="comment-copy">@matt  read and write the header outside the loop.  If that doesn't make sense, ask a new question about that and I can answer that with some code I just wrote that does the same thing</span>
