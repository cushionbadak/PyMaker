<div class="post-text" itemprop="text">
<p>I am learning cherrypy framework for my python development.I created a database,inserted some data and now I want to retrieve it and show it in the browser.Data is created in the sqlite database but when displaying the data it simply shows for loop instead of printing the data in the browser.</p>
<pre><code>import sqlite3
import cherrypy

class simple_db(object):
    @cherrypy.expose
    def index(self):
        db = sqlite3.connect('picnic.db')
        c = db.cursor()
        c.execute("SELECT item,quant FROM picnic")
        data = c.fetchone()
        c.close() 
        output = open("data.html")
        return output


if __name__ == '__main__':

    cherrypy.config.update("app.conf")
    cherrypy.quickstart(simple_db())
</code></pre>
<p>My html file,</p>
<pre><code>    &lt;h1&gt;Things to bring to our picnic&lt;/h1&gt;
    &lt;head&gt;
    &lt;style&gt;
    table {
        border-collapse: collapse;
    }
    &lt;/style&gt;
    &lt;/head&gt;
    &lt;table border=1&gt;
    &lt;tr&gt;&lt;th&gt;Item&lt;/th&gt;&lt;th&gt;Quantity&lt;/th&gt;&lt;/tr&gt;
    % for row in data: 
        &lt;tr&gt;
        % for col in row: 
            &lt;td&gt;{{col}}&lt;/td&gt;
        % endfor 
        &lt;/tr&gt;
    % endfor
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Your HTML file is in fact a template (it looks like you're using <a href="http://www.makotemplates.org/" rel="nofollow">Mako</a>) which needs to be rendered.</p>
<p>Currently your code is simply opening the template file and returning the file object. This causes cherrypy to return the contents of that file verbatim.</p>
<p>Assuming that you have installed mako the simplest way to render the template is like this:</p>
<pre><code>import sqlite3
import cherrypy
from mako.template import Template

class simple_db(object):
    @cherrypy.expose
    def index(self):
        db = sqlite3.connect('picnic.db')
        c = db.cursor()
        c.execute("SELECT item,quant FROM picnic")
        data = c.fetchall()
        c.close() 
        return Template(filename='data.html').render(data=data)

if __name__ == '__main__':
    cherrypy.config.update("app.conf")
    cherrypy.quickstart(simple_db())
</code></pre>
<p>Note that <code>c.fetchall()</code> should be used instead of <code>fetchone()</code>.</p>
<p>Also there was an error in the template where <code>col</code> is not being referenced correctly. It should be</p>
<pre><code>        &lt;td&gt;${col}&lt;/td&gt;
</code></pre>
<p>not</p>
<pre><code>        &lt;td&gt;{{col}}&lt;/td&gt;
</code></pre>
<p>This is a very simple example. There may be more convenient ways to handle rendering of your templates, e.g. template lookups, so you should read the <a href="http://docs.makotemplates.org/en/latest/index.html" rel="nofollow">Mako documentation</a>.</p>
</div>
<span class="comment-copy">Thanks this solved my problem,Can u explain what is meant by <b>name='__main</b>'?</span>
<span class="comment-copy">@Bhanukiran: no problem. You can find out about <code>__main__</code> in the <a href="https://docs.python.org/3/library/__main__.html#module-__main__" rel="nofollow noreferrer">documentation</a>.</span>
