<div class="post-text" itemprop="text">
<p>so i need to get the time for the UK from an NTP server. Found stuff online however any time I try out the code, I Always get a return date time, the same as my computer. I changed the time on my computer tom confirm this, and i always get that, so its not coming from the NTP server. Code is below, any help is appreciated</p>
<pre><code>import ntplib
from time import ctime
c = ntplib.NTPClient()
response = c.request('uk.pool.ntp.org', version=3)
response.offset
print (ctime(response.tx_time))
print (ntplib.ref_id_to_text(response.ref_id))

x = ntplib.NTPClient()
print ((x.request('ch.pool.ntp.org').tx_time))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The timestamps returned as call to the NTP server returns time in seconds.
ctime() provides datetime format based on local machine's timezone settings by default. Thus, for uk timezone you need to convert tx_time using that timezone. python's in-built <a href="https://docs.python.org/3/library/datetime.html" rel="nofollow noreferrer">datetime</a> module contains function for this purpose</p>
<pre><code>        import ntplib
        from datetime import datetime, timezone
        c = ntplib.NTPClient()
        # Provide the respective ntp server ip in below function
        response = c.request('uk.pool.ntp.org', version=3)
        response.offset 
        # UTC timezone used here, for working with different timezones you can use [pytz library][1]
        print (datetime.fromtimestamp(response.tx_time, timezone.utc))


  [1]: http://pytz.sourceforge.net/
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The following function is working well using python 3:</p>
<pre><code>def GetNTPDateTime(server):
    try:
        ntpDate = None
        client = ntplib.NTPClient()
        response = client.request(server, version=3)
        response.offset
        ntpDate = ctime(response.tx_time)
        print (ntpDate)
    except Exception as e:
        print (e)
    return datetime.datetime.strptime(ntpDate, "%a %b %d %H:%M:%S %Y")
</code></pre>
</div>
