<div class="post-text" itemprop="text">
<p>I have a fasta file like this:
test_fasta.fasta</p>
<pre><code>&gt;XXKHH_1
AAAAATTTCTGGGCCCC
&gt;YYYXXKHH_1
TTAAAAATTTCTGGGCCCCGGGAAAAAA
&gt;TTDTT_11
TTTGGGAATTAAACCCT
&gt;ID_2SS
TTTGGGAATTAAACCCT
&gt;YKHH_1
TTAAAAATTTCTGGGCCCCGGGAAAAAA
&gt;YKHSH_1S
TTAAAAATTTCTGGGCCCCGGGAAAAAA
</code></pre>
<p>I want to get the count of duplicated sequences and append the total counts for each sequence in the file (sorted from the most to least) and get the result as shown below:</p>
<pre><code>&gt;YYYXXKHH_1_counts3
TTAAAAATTTCTGGGCCCCGGGAAAAAA
&gt;TTDTT_11_counts2
TTTGGGAATTAAACCCT
&gt;XXKHH_1_counts1
AAAAATTTCTGGGCCCC
</code></pre>
<p>I have this code which finds the duplicated sequences and joins theirs ids together, but instead of joining them together, I just want the counts for duplicates appended in the id as shown above in results. </p>
<pre><code>from Bio import SeqIO
from collections import defaultdict

dedup_records = defaultdict(list)
for record in SeqIO.parse("test_fasta.fasta", "fasta"):
    # Use the sequence as the key and then have a list of id's as the value
    dedup_records[str(record.seq)].append(record.id)
with open("Output.fasta", 'w') as output:
    for seq, ids in dedup_records.items():
        # Join the ids and write them out as the fasta
        output.write("&gt;{}\n".format('|'.join(ids)))
        output.write(seq + "\n")
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Since you already have the IDs of each duplicating record in the <code>ids</code> list in your output loop, you can simply output the first ID (which you apparently want, per your expected output), followed by the length of the <code>ids</code> list:</p>
<pre><code>for seq, ids in sorted(dedup_records.items(), key=lambda t: len(t[1]), reverse=True):
    output.write("&gt;{}_counts{}\n".format(ids[0], len(ids)))
    output.write(seq + "\n")
</code></pre>
</div>
