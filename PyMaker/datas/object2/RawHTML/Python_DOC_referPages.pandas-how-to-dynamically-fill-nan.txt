<div class="post-text" itemprop="text">
<p>I have a dataset with lots of NaN values, and I would like to fill it based on other column's value. Here is an example.</p>
<pre><code>  Ind Init Desc
   1   A   Apple
   2   A   Apple
   3   A   NaN
   4   B   NaN
   5   B   Banana
   6   B   Banana
   7   C   Cherry
   8   C   NaN
   9   C   Cherry
   10  D   NaN
   11  D   NaN
   12  D   NaN
   13  A   NaN
   14  A   NaN
   15  A   Apple
</code></pre>
<p>I cannot just simply use <code>df.fillna('apple')</code> because it has to be dynamic. I also cannot use neither of <code>(method='ffill')</code> and <code>(method='bfill')</code> because, in case of A, it should be <code>ffill</code>, and in case of B, it should be <code>bfill</code>. Also in case of D, it should be saying 'No fruit description available!'</p>
<p>You may assume there is no missing Init, and there is only one fruit description per one unique Init.</p>
<p>What would be the best way to handle this case?</p>
</div>
<div class="post-text" itemprop="text">
<p>you can use something like:</p>
<pre><code>df['Desc1']=(df.groupby('Init')['Desc'].apply
         (lambda x: x.ffill().bfill()).fillna('No fruit description available!'))
print(df)

    Ind Init    Desc                            Desc1
0     1    A   Apple                            Apple
1     2    A   Apple                            Apple
2     3    A     NaN                            Apple
3     4    B     NaN                           Banana
4     5    B  Banana                           Banana
5     6    B  Banana                           Banana
6     7    C  Cherry                           Cherry
7     8    C     NaN                           Cherry
8     9    C  Cherry                           Cherry
9    10    D     NaN  No fruit description available!
10   11    D     NaN  No fruit description available!
11   12    D     NaN  No fruit description available!
12   13    A     NaN                            Apple
13   14    A     NaN                            Apple
14   15    A   Apple                            Apple
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Something like this?</p>
<pre><code>mapping_dict = {'A': 'Apple', 'B': 'Banana', 'C':'Cherry', 'D':'no fruit description available'}
df['Desc'] = df['Init'].map(mapping_dict)
</code></pre>
</div>
<span class="comment-copy">You have an <code>Init=C</code> which is NaN too, but no rule there.</span>
<span class="comment-copy">Thank you, it works perfect!</span>
<span class="comment-copy">@NicholasHuh pleasure..!! upvoted the question for a well asked one. !!</span>
