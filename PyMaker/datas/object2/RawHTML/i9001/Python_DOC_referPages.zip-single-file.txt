<div class="post-text" itemprop="text">
<p>I am trying to zip a single file in python. For whatever reason, I'm having a hard time getting down the syntax. What I am trying to do is keep the original file and create a new zipped file of the original (like what a Mac or Windows would do if you archive a file).</p>
<p>Here is what I have so far:</p>
<pre><code>import zipfile

myfilepath = '/tmp/%s' % self.file_name
myzippath = myfilepath.replace('.xml', '.zip')

zipfile.ZipFile(myzippath, 'w').write(open(myfilepath).read()) # does not zip the file properly
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The correct way to zip file is:</p>
<pre><code>zipfile.ZipFile('hello.zip', mode='w').write("hello.csv")
# assume your xxx.py under the same dir with hello.csv
</code></pre>
<p>The python official doc <a href="https://docs.python.org/3/library/zipfile.html#zipfile.ZipFile.write" rel="nofollow noreferrer">says</a>:</p>
<blockquote>
<p><strong><code>ZipFile.write(filename, arcname=None, compress_type=None)</code></strong></p>
<p>Write the file named filename to the archive, giving it the archive name arcname</p>
</blockquote>
<p>You pass <code>open(filename).read()</code> into <code>write()</code>. <code>open(filename).read()</code> is a single string that contains the whole content of file <code>filename</code>, it would throw <code>FileNotFoundError</code> because it is trying to find a file named with the string content.</p>
</div>
<div class="post-text" itemprop="text">
<p>Since you also want to specify the directory try using <code>os.chdir</code>:</p>
<pre><code>#!/usr/bin/python

from zipfile import ZipFile
import os

os.chdir('/path/of/target/and/destination')
ZipFile('archive.zip', 'w').write('original_file.txt')
</code></pre>
<ul>
<li><a href="https://docs.python.org/2/library/zipfile.html" rel="nofollow noreferrer">Python zipfile : Work with Zip archives</a></li>
<li><a href="https://docs.python.org/2/library/os.html" rel="nofollow noreferrer">Python Miscellaneous operating system interfaces</a></li>
</ul>
</div>
<div class="post-text" itemprop="text">
<p>If the file to be zipped (<code>filename</code>) is in a different directory called <code>pathname</code>, you should use the <code>arcname</code> parameter. Otherwise, it will recreate the full folder hierarchy to the file folder. </p>
<pre><code>from zipfile import ZipFile
import os

with ZipFile(zip_file, 'w') as zipf:
    zipf.write(os.path.join(pathname,filename), arcname=filename)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Try calling zipfile.close() afterwards?</p>
<pre><code>   from zipfile import ZipFile
   zipf = ZipFile("main.zip","w", zipfile.ZIP_DEFLATED)
   zipf.write("main.json")

   zipf.close()
</code></pre>
</div>
<span class="comment-copy">what error do you get?</span>
<span class="comment-copy"><a href="https://docs.python.org/2/library/zipfile.html#zipfile.ZipFile.write" rel="nofollow noreferrer"><code>zipfile.write()</code></a> takes the name of an existing file as the first argument, you are passing the file's contents as the filename. You either want to pass the name of the source file (along with <code>arcname=</code>) or you are looking for <a href="https://docs.python.org/2/library/zipfile.html#zipfile.ZipFile.writestr" rel="nofollow noreferrer"><code>writestr()</code></a>.</span>
<span class="comment-copy"><code>ZipFile.write(filename, arcname=None, compress_type=None)</code> Write the file named filename to the archive, giving it the archive name arcname</span>
<span class="comment-copy">In order to "properly" zip the file, you might need to add <code>compress_type=zipfile.ZIP_DEFLATED</code> as zipfile default compression is <code>ZIP_STORED</code> which doesn't yield reduction in compressed file size.</span>
<span class="comment-copy">Valid values of <code>compress_type</code> are <code>zipfile.ZIP_STORED</code> (uncompressed), <code>zipfile.ZIP_DEFLATED</code> (standard ZIP), and <code>zipfile.ZIP_BZIP2</code> and <code>zipfile.ZIP_LZMA</code> which are self explanatory.</span>
