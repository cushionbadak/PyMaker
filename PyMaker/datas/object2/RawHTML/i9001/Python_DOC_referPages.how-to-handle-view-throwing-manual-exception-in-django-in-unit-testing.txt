<div class="post-text" itemprop="text">
<p>I have made a django application and am writing tests for it.
In one of my views I'm manually throwing an exception:</p>
<p><code>raise Http404('Not authorised')</code></p>
<p>While writing test for that using django's built-in test framework(based on unittest).</p>
<p>TL;DR: Is there way to write test such that it makes sure that the view is indeed returning <code>Http404</code>. ( <code>assertEqual(response.status_code, 404</code> doesn't work)</p>
</div>
<div class="post-text" itemprop="text">
<p>This should work:</p>
<pre><code>resp = self.client.get(url)
self.assertEqual(resp.status_code, 404)
</code></pre>
<p>Run your tests via:</p>
<pre><code>python manage.py test
</code></pre>
<p>If it does not, recheck your code and supply an error message.</p>
</div>
<div class="post-text" itemprop="text">
<p>If self.assertEqual doesn't work you could try it with a with tag as shown here
<a href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertRaises" rel="nofollow noreferrer">assertRaises(exception, callable, *args, **kwds)</a></p>
<pre><code>with self.assertRaises(Http404):
    // your logic here
</code></pre>
<p>For example. I have a function that will return an order or raise a HTTP 404 response</p>
<pre><code>from django.http import Http404

def test_get_order_with_method_404(self):
    client = MyPaymentClient("super_secret_key")
    with self.assertRaises(Http404):
        client.get_order_with_method("payment_id", "payment_method")
</code></pre>
<p>You could also do it with get_object_or_404</p>
<p>Example:</p>
<pre><code>from django.http import Http404
from django.shortcuts import get_object_or_404

with self.assertRaises(Http404):
    get_object_or_404(MyModel, some_argument="MyCriteria")
</code></pre>
<p>Well i guess you get the point. Hope this helps you out!</p>
</div>
<span class="comment-copy">Did you try using <a href="https://docs.python.org/3/library/unittest.html#unittest.TestCase.assertRaises" rel="nofollow noreferrer"><code>assertRaises</code></a>? Also could you show your test code?</span>
<span class="comment-copy">Will check out assertRaises! thanks @shiplu.mokadd.im</span>
<span class="comment-copy">"doesn't work" is not clear enough. Please paste the full traceback</span>
<span class="comment-copy">Yeah, this doesn't work. <code>assertEqual</code> doesn't work.</span>
