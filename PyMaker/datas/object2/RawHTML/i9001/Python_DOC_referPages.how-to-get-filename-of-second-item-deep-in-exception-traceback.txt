<div class="post-text" itemprop="text">
<p>If I have a traceback such as:</p>
<pre><code> Traceback (most recent call last):
  File "...\overall_input.py", line 5, in setup_data
    MODULE1.function_name()
  File "...\MODULE1.py", line 5, in function_name
    value = 1/0
</code></pre>
<p>How do I get the name of the second file deep - i.e. <code>MODULE1.py</code>?</p>
<p>For reference, I know I can get the first file (i.e. <code>overall_input.py</code>) by capturing the exception and then using: </p>
<pre><code>exc_type, exc_obj, exc_tb = sys.exc_info()
fname = os.path.split(exc_tb.tb_frame.f_code.co_filename)[1]
</code></pre>
<p>as described in the answer <a href="https://stackoverflow.com/questions/1278705/python-when-i-catch-an-exception-how-do-i-get-the-type-file-and-line-number">Python When I catch an exception, how do I get the type, file, and line number?</a> .</p>
</div>
<div class="post-text" itemprop="text">
<p>You need to access the same attributes after going towards the frame that raised the exception by using <code>tb_next</code> on <code>exc_tb</code>: </p>
<pre><code>exc_tb.tb_next.tb_frame.f_code.co_filename
</code></pre>
<p><code>tb_next</code> is another <code>traceback</code> object that contains identical attributes as the previous; it's just a chain which you can follow until you reach the level you need.</p>
<hr/>
<p>Even though I've never used it, I'm certain the <a href="https://docs.python.org/3/library/traceback.html" rel="nofollow noreferrer"><code>traceback</code> module</a> would be quite handy if you're doing weird things with them.</p>
</div>
