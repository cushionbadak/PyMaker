<div class="post-text" itemprop="text">
<p>I'm trying to get a python script to read the contents of a text file and if it's 21 turn on a LED but if it's 20 turn it off. The script also prints out the contents of the text file on the screen.</p>
<p>The contents print out works all ok but the LED does not turn on.</p>
<pre><code>import wiringpi2
import time

wiringpi2.wiringPiSetupGpio()
wiringpi2.pinMode(17,1)

while 1:
    fh=open("test1.txt","r")
    print fh.read() 
    line = fh.read()
    fh.close()
    if line == "21":
        wiringpi2.digitalWrite(17,1)
    elif line == "20":
        wiringpi2.digitalWrite(17,0)
    time.sleep(2)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<pre><code>print fh.read() 
</code></pre>
<p>reads the entire contents of the file, leaving the file cursor at the end of the file, so when you do </p>
<pre><code>line = fh.read()
</code></pre>
<p>there's nothing left to read.</p>
<p>Change this:</p>
<pre><code>fh=open("test1.txt","r")
print fh.read() 
line = fh.read()
fh.close()
</code></pre>
<p>to this:</p>
<pre><code>fh=open("test1.txt","r")
line = fh.read()
print line 
fh.close()
</code></pre>
<p>I can't test this code, since I don't have a Raspberry Pi, but that code will ensure that <code>line</code> contains the entire contents of the text file. That might not actually be desirable: if the file contains <em>any</em> whitespace, eg blank spaces or newlines, then your <code>if ... else</code> tests won't behave like you want. You can fix that by doing </p>
<pre><code>line = line.strip() 
</code></pre>
<p>after <code>line = fh.read()</code></p>
<p>The <code>.strip</code> method strips off any leading or trailing whitespace. You can also pass it an argument to tell it what to strip, see <a href="https://docs.python.org/3/library/stdtypes.html#str.strip" rel="nofollow">the docs</a> for details.</p>
</div>
<span class="comment-copy">I think closing the file before <code>if</code> is causing the problem</span>
<span class="comment-copy">Also you might want to use a <a href="http://preshing.com/20110920/the-python-with-statement-by-example/" rel="nofollow noreferrer">contextmanager</a> to read the file.</span>
<span class="comment-copy">I have tried with this taken out and still does not work</span>
<span class="comment-copy">That works thank you, I can now move on with my learning</span>
