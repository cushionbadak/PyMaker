<div class="post-text" itemprop="text">
<p>I am currently conducting a data scraping project with Python 3 and am attempting to write the scraped data to a CSV file. My current process to do it is this:</p>
<pre><code>import csv

outputFile = csv.writer(open('myFilepath', 'w'))
outputFile.writerow(['header1', 'header2'...])
for each in data:
     scrapedData = scrap(each)
     outputFile.writerow([scrapedData.get('header1', 'header 1 NA'), ...])
</code></pre>
<p>Once this script is finished, however, the CSV file is blank. If I just run:</p>
<pre><code>import csv

outputFile = csv.writer(open('myFilepath', 'w'))
outputFile.writerow(['header1', 'header2'...])
</code></pre>
<p>a CSV file is produced containing the headers:</p>
<pre><code>header1,header2,..
</code></pre>
<p>If I just scrape 1 in <code>data</code>, for example:</p>
<pre><code>outputFile.writerow(['header1', 'header2'...])
scrapedData = scrap(data[0])
outputFile.writerow([scrapedData.get('header1', 'header 1 NA'), ...])
</code></pre>
<p>a CSV file will be created including both the headers and the data for <code>data[0]</code>:</p>
<pre><code>header1,header2,..
header1 data for data[0], header1 data for data[0]
</code></pre>
<p>Why is this the case?</p>
</div>
<div class="post-text" itemprop="text">
<p>When you open a file with <code>w</code>, it erases the previous data </p>
<blockquote>
<p>From the docs</p>
<blockquote>
<p>w: open for writing, truncating the file first</p>
</blockquote>
</blockquote>
<p>So when you open the file after writing scrape data with <code>w</code>, you just get a blank file and then you write the header on it so you only see the header. Try replacing <code>w</code> with <code>a</code>. So the new call to open the file would look like </p>
<p><code>outputFile = csv.writer(open('myFilepath', 'a'))</code></p>
<p>You can fine more information about the modes to open the file <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer">here</a></p>
<p>Ref: <a href="https://stackoverflow.com/questions/4706499/how-do-you-append-to-a-file">How do you append to a file?</a></p>
<p><strong>Edit after DYZ's comment:</strong></p>
<p>You should also be closing the file after you are done appending. I would suggest using the file like the:</p>
<pre><code>with open('path/to/file', 'a') as file:
    outputFile = csv.writer(file)
    # Do your work with the file
</code></pre>
<p>This way you don't have to worry about remembering to close it. Once the code exists the <code>with</code> block, the file will be closed.</p>
</div>
<div class="post-text" itemprop="text">
<p>I would use Pandas for this:</p>
<pre><code>import pandas as pd
headers = ['header1', 'header2', ...]
scraped_df = pd.DataFrame(data, columns=headers)
scraped_df.to_csv('filepath.csv')
</code></pre>
<p>Here I'm assuming your <code>data</code> object is a list of lists.</p>
</div>
<span class="comment-copy">Try using a context manager. You are never closing your file, so it might not be flushing. A context manager should always be used when working with files, anyway.</span>
<span class="comment-copy">You have to close the file after you finished writing into it.</span>
<span class="comment-copy">The OP is not appending to the file. They open it just once. The problem is with them not closing the file.</span>
<span class="comment-copy">I will update the answer. Good catch. OP still needs to be using the correct mode otherwise the problem would still exist.</span>
