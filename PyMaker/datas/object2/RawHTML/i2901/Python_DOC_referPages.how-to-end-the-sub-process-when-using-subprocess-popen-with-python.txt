<div class="post-text" itemprop="text">
<p>I use a script to run two script. the code like this:</p>
<pre><code>import subprocess

subprocess.Popen("python a.py", shell=True)
subprocess.Popen("python b.py", shell=True)
</code></pre>
<p>but if I end the main script, the sub process of a.py and b.py are still runing. How to solve it?</p>
<p>added:</p>
<p>the a.py and b.py is two server scripts. When I end the main script using ctrl+c,and the two servers is not end up.So how to end the all process when I end the main script?</p>
</div>
<div class="post-text" itemprop="text">
<p>By killing the processes.</p>
<pre><code>import subprocess

p1 = subprocess.Popen("python a.py", shell=True)
p2 = subprocess.Popen("python b.py", shell=True)

# ... do things ...

p1.kill()
p2.kill()
</code></pre>
<p>You can also automate this with the <a href="https://docs.python.org/3/library/atexit.html" rel="nofollow noreferrer">atexit</a> module:</p>
<pre><code>import subprocess
import atexit

p1 = subprocess.Popen("python a.py", shell=True)
p2 = subprocess.Popen("python b.py", shell=True)
atexit.register(p1.kill)  # register for killing
atexit.register(p2.kill)

# ... do things ...
</code></pre>
</div>
<span class="comment-copy">Try popen(“kill $!”, shell=True) though that would only kill last one and the answer below is better</span>
<span class="comment-copy">You do not need <code>shell=True</code>, you are only introducing a security risk with that. Just do <code>Popen(['python', 'a.py'])</code>. <code>shell=True</code> is useful only when you are using some shell feature (e.g. pipes/redirection/built-ins/expansions etc) and even most of those can actually be avoided. If you are just running an executable do not specify <code>shell=True</code>.</span>
<span class="comment-copy">Have any reason to start a new python interpretor instead of simply calling <code>import a.py</code> or at least <code>compile</code> and <code>exec</code>?</span>
<span class="comment-copy">@GiacomoAlzetta If I using shell=False, it give me an error:No such file or directory: 'python a.py'.</span>
<span class="comment-copy">@XiaXuehai You should use <code>Popen(["python", "a.py"])</code> not <code>Popen("python a.py")</code>. Or if you don't want to manually write the least do : <code>import shlex</code> and then <code>Popen(shlex.split("python a.py")))</code></span>
<span class="comment-copy">THX, but the a.py and b.py is two server scripts. When I end the main script using ctrl+c,and the two servers is not end up.So can you tell me how to end the all process when I end the main script?</span>
<span class="comment-copy">Have solved.add p1.wait()</span>
