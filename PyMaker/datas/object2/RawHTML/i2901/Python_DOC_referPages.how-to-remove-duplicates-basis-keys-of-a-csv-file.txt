<div class="post-text" itemprop="text">
<p>i have a csv while has data structure like this image:
<a href="https://i.stack.imgur.com/HQtSO.jpg" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/HQtSO.jpg"/></a></p>
<p>Now i want to remove duplicates from area column but condition is that it should be key based. Meaning 1 key cannot have duplicates Area. Area can be duplicate in other keys but not in same key.</p>
<p>I am trying to create it but not getting the logic behind:</p>
<p>These are my codes:</p>
<pre><code>import csv
OUTPUT_FILE = 'Desired_format.csv'
filename = "optionsbook.csv"
sublist = []
with open("./"+ filename, "r") as file,open(OUTPUT_FILE, 'w') as f_out:
    reader = csv.DictReader(file)
    for line in reader:
        line["key"] = line["bhk"],line["Area"],line["Property_Type"]
        if line["Area"] in line:
            continue
        else:
            sublist.append(line["key"])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="http://toolz.readthedocs.io/en/latest/api.html#toolz.itertoolz.unique" rel="nofollow noreferrer"><code>toolz.unique</code></a>. If you don't have access to this library, you can use the identical <code>unique_everseen</code> <a href="https://docs.python.org/3/library/itertools.html#itertools-recipes" rel="nofollow noreferrer">recipe</a> from the <code>itertools</code> docs.</p>
<p>Here's a demo:</p>
<pre><code>from io import StringIO
import csv
from toolz import unique

x = StringIO("""key,Area,SomeField
12345,53.5,THIS
12345,56.1,IS
12345,76.0,A
67572,35.7,MINIMAL
67572,76.1,EXAMPLE""")

# replace x with open('file.csv', 'r')
with x as fin:
    reader = unique(csv.DictReader(fin), lambda x: x['key'])
    res = list(reader)

print(res)

[OrderedDict([('key', '12345'), ('Area', '53.5'), ('SomeField', 'THIS')]),
 OrderedDict([('key', '67572'), ('Area', '35.7'), ('SomeField', 'MINIMAL')])]
</code></pre>
</div>
<span class="comment-copy">Oh yes... It it what i am looking for. Thank you so much.</span>
