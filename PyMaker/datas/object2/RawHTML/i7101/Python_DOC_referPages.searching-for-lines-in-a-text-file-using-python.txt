<div class="post-text" itemprop="text">
<p>I am trying to search string in a txt file. Here is a sample txt file. I am working with:</p>
<pre><code>abc
def
ghi
centre
jkl
mno
pqr
123
456
</code></pre>
<p>I am trying to match the lines in the file and if a match is found then exit the program if a match is not found then add the line to the file:</p>
<p>I have the following code that I am working with: my issue is it works correctly if I try to match "abc" in the file, but say if I try to match "pqr" I see my second if block is also executed.</p>
<p>Following is the code I have so far.</p>
<pre><code>#!/usr/bin/python

new_data = raw_input("Enter txt:")    
file_name = "test.txt"

with open(file_name, "r") as F:
    data = F.readlines()

for num, line in enumerate(data, start=1):
    if line.strip() == new_data:
        print "exists {} {}".format(new_data, num)
        break

    if line.strip() != new_data:
        print "new data {} to be entered into line {}".format(new_data, num)

     else:
         print "break"
</code></pre>
<p>Following is the output i get if i try to match say "123" from the file:</p>
<pre><code>Enter txt:123
new data 123 to be entered into line 1
new data 123 to be entered into line 2
new data 123 to be entered into line 3
new data 123 to be entered into line 4
new data 123 to be entered into line 5
new data 123 to be entered into line 6
new data 123 to be entered into line 7
exists 123 8
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>IIUC, you want the second block to execute only if the data does not exist. Well, try this:</p>
<pre><code>for num, line in enumerate(data, start=1):
    if line.strip() == new_data:
        print "exists {} {}".format(new_data, num)
        break
else:
    print "new data {} to be entered into line {}".format(new_data, num)
</code></pre>
<p>You can take advantage of the <code>for...else</code> syntax. The <code>else</code> is executed if the loop does not <code>break</code>, i.e., if the data does not exist in the file.</p>
</div>
<div class="post-text" itemprop="text">
<p>The problem with your code is that if the <code>new_data</code> is not found in iteration your 2nd if condition prints <code>new data to be entered</code> even if it exists in the subsequent iteration, only the the first data <code>abc</code> will give desired result as the iteration starts from there.</p>
<p>One good solution is already given by @COLDSPEED .</p>
<p>Another basic approach could be this:</p>
<pre><code>for num, line in enumerate(data, start=1):
    if line.strip() == new_data:
        flag = 1
        print("exists {} {}".format(new_data, num))
        break
    else:
        flag = 0

if flag == 0:
    print("new data {} to be entered into line {}".format(new_data, num))
</code></pre>
<p>It will iterate through the whole data and if the <code>new_data</code> is found it will set the <code>flag</code> to be 1 and will break, else it will set the <code>flag</code> to be 0 and will print <code>new data to be entered</code></p>
<p>Hope this help :)</p>
</div>
<span class="comment-copy">if a line is not found where will be the new line be inserted?</span>
<span class="comment-copy">nice one. for else is a bit confusing, gonna read some more about this.</span>
<span class="comment-copy">@zig Indeed. It is a useful tool, and underrated too. You can look up more here: <a href="https://docs.python.org/3/tutorial/controlflow.html#break-and-continue-statements-and-else-clauses-on-loops" rel="nofollow noreferrer">docs.python.org/3/tutorial/â€¦</a>. Also, please consider marking accepted if it works!</span>
