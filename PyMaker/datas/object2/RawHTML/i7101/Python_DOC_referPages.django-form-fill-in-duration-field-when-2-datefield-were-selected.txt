<div class="post-text" itemprop="text">
<p>I have a form for employee to apply leaves, how can I make by selecting the start date and end date field in the form it will calculate the duration in days. How can I do the calculation in view.py?</p>
<p>Any help is much appreciated</p>
<p>Below is my code :</p>
<p>model.py :</p>
<pre><code>class Leave(models.Model):
    employee = models.ForeignKey(Employee, on_delete=models.CASCADE, related_name='+')
    start_date = models.DateField()
    end_date = models.DateField()
    duration = models.FloatField()
</code></pre>
<p>form.py : </p>
<pre><code>class LeavesDetailForm(forms.ModelForm):
    class Meta:
        model = Leave
        fields = ('employee','start_date', 'end_date', 'duration',)

        widgets = {'start_date': forms.DateInput(attrs={'type': 'date'}),
                   'end_date': forms.DateInput(attrs={'type': 'date'}),
                   'employee': forms.HiddenInput()}
</code></pre>
<p>view.py :</p>
<pre><code>def my_leaves_view(request):
    form = LeavesDetailForm(request.POST or None)
    leaves_log = Leave.objects.all().filter(employee=request.user.profile.employee.id)
    for annual_field in leaves_log:
        annual_duration = annual_field.end_date - annual_field.start_date
    print(annual_duration)
    if form.is_valid():
        inst = form.save(commit=False)
        inst.save()
        return HttpResponseRedirect('my_leaves_content.html')
    context = {'form': form}
    return render(request, 'hrm/my_leaves/my_leaves_content.html', context)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>A subtraction of two dates gives you <a href="https://docs.python.org/3/library/datetime.html#timedelta-objects" rel="nofollow noreferrer"><code>datetime.timedelta</code></a>, so you can use the <code>days</code> attribute:</p>
<p><code>(annual_field.end_date - annual_field.start_date).days</code></p>
<p>For example:</p>
<pre><code>&gt;&gt;&gt; from datetime import date
&gt;&gt;&gt; date(year=2017, month=10, day=10) - date(year=2017, month=10, day=1)
datetime.timedelta(9)
&gt;&gt;&gt; (date(year=2017, month=10, day=10) - date(year=2017, month=10, day=1)).days
9
</code></pre>
<p>If you want to save this days:</p>
<pre><code>def my_leaves_view(request):
    # ...
    form = LeavesDetailForm(request.POST)
    if form.is_valid():
        inst = form.save(commit=False)
        inst.duration = (inst.end_date - inst.start_date).days
        inst.save()
        return HttpResponseRedirect('my_leaves_content.html')
    # ...
</code></pre>
</div>
<span class="comment-copy">Hello @Anton thanks for your reply, afterward, how can I save it in to the database from form view?</span>
<span class="comment-copy">@M.Izzat I added the sample code in the answer, please check.</span>
<span class="comment-copy">Hey thanks a lot Anton, this worked!</span>
