<div class="post-text" itemprop="text">
<p>I am using python3.4<br/>
The question refers to the <a href="https://docs.python.org/3/library/argparse.html" rel="nofollow noreferrer">https://docs.python.org/3/library/argparse.html</a> package  </p>
<p>If I want an arg <code>--with_extra_actions</code> to always acompany <code>--arg1</code> or <code>--arg2</code> and give an error message if one of those two is missing?  </p>
<p>Examples:<br/>
<code>command --arg1 --with_extra_actions</code>  That should work<br/>
<code>command --arg2 --with_extra_actions</code>  That should work<br/>
<code>command --with_extra_actions</code> That should fail with informative error.  </p>
<p>I am doing it right now in the code itself. No issue there, but is there an intrinsic way for the <code>argparse</code> lib to do this?  </p>
</div>
<div class="post-text" itemprop="text">
<p>You can do it using <a href="https://docs.python.org/3/library/argparse.html#argparse.ArgumentParser.add_mutually_exclusive_group" rel="nofollow noreferrer">add_mutually_exclusive_group</a>. Here example(test.py):</p>
<pre><code>import argparse
import sys


parser = argparse.ArgumentParser(prog='our_cmd')
# with_extra_actions is always required
parser.add_argument(
    '--with_extra_actions',
    required=True,
    action='store_false'
)

# only one argument from group is available
# group is required - one from possible arguments is required
group = parser.add_mutually_exclusive_group(required=True)
group.add_argument('--arg1', action='store_true')
group.add_argument('--arg2', action='store_true')

parser.parse_args(sys.argv[1:])
</code></pre>
<p>Now let's check our script:</p>
<pre><code>python test.py --with_extra_actions
usage: our_cmd [-h] --with_extra_actions (--arg1 | --arg2)
our_cmd: error: one of the arguments --arg1 --arg2 is required
</code></pre>
<p>Let's try with <code>arg1</code> and <code>arg2</code>:</p>
<pre><code>python test.py --arg1 --arg2 --with_extra_actions
usage: our_cmd [-h] --with_extra_actions (--arg1 | --arg2)
our_cmd: error: argument --arg2: not allowed with argument --arg1
</code></pre>
<p>Without any errors:</p>
<pre><code>python test.py --arg1 --with_extra_actions
python test.py --arg2 --with_extra_actions
</code></pre>
<p>Hope this helps.</p>
</div>
<span class="comment-copy">There's a mutually-exclusive grouping, but no mutually-inclusive one.  Subparsers work for some cases.  Otherwise, doing your own testing after parsing is your best option.</span>
<span class="comment-copy">Sometimes we can define <code>--arg1</code> to take several arguments, 2, '+', etc. Then we don't need define extra actions.</span>
