<div class="post-text" itemprop="text">
<p>I have a python script that was created by another set of people which sends a command to a layer 1 device that gives a feedback based on a connection if it's active or not.  However the script can only be executed one port at a time which makes it labor intensive to go through 24/48 ports.</p>
<p>Example:</p>
<pre><code>python portquery.py -status (name of device)-(port)
</code></pre>
<p>which it gives a feedback of "Connected" or "Not Connected" or "Port not found" (since this port does not exist on a switch for example).</p>
<p>So I got thinking was what if it were possible to just repeat that script with no port specified and it starts at Port 1 and stops when it gets the feedback "Port not found" which it saves the result into a file or some form of array and then so I can use that set for adding or modifying a vlan on the same switch with those "Not connected" ports.</p>
<p>For example:</p>
<pre><code>$ python repeatquery.py (name of device)
Port 1 - Connected
Port 2 - Not Connected
etc etc
Port 49 - Port not found
</code></pre>
<p>I honestly have no idea how to start on this or what this would be called since my work revolves around the hardware aspect of things.  I'm just trying to get ideas of where to look.  I've looked at repeat commands and the "Similar Questions" sidebar to the right.  I guess it's a bit of a convoluted concept that I'm looking at here perhaps?</p>
</div>
<div class="post-text" itemprop="text">
<p>Without the code, it is hard to show you exactly how to do it.  But probably in the code there is a function which does the query, and a place the function is called.  You could change the call to something like:</p>
<pre><code>for x in range(0, 47):
    do_the_function(x)
</code></pre>
<p>Or, you can write a small bash script which calls the python script 48 times.
Something along the lines of (I am not sure if  you need to number the ports from 0 to 47 or 1 to 8):</p>
<pre><code>#!/bin/bash
for number in {1..48}
do
python checkport.py number
done
</code></pre>
<p>Then you make the bash script executable. Say you called the script "checkallports.sh":</p>
<pre><code>&gt; chmod +x checkallports.sh
</code></pre>
<p>Then you can call it:</p>
<pre><code>&gt; ./checkallports.sh
</code></pre>
</div>
<span class="comment-copy">Have you taken a look at <code>portquery.py</code>?  Maybe you can duplicate what it does but in a loop - <a href="https://docs.python.org/3/tutorial/controlflow.html#for-statements" rel="nofollow noreferrer">docs.python.org/3/tutorial/controlflow.html#for-statements</a></span>
<span class="comment-copy">That's a start.  Thank you.  I'm wondering if it can be modified to include the device name which there's many devices with differing names.  ie: ./checkallports.sh switch001</span>
<span class="comment-copy">yes.  you would refer to the parameter as $1 in the script.  If you need more parameters, they are $2, $3, etc.</span>
