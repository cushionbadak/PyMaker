<div class="post-text" itemprop="text">
<p>I have a class updating a live value:</p>
<pre><code>class LiveUpdate():

    def __init__(self):

        self.x=0

        self.t1 = threading.Thread(target=self._refresh_value)
        self.t1.start()

    def _refresh_value(self):

        while True:
            self.x=self.x+1


updater=LiveUpdate()

@xw.func
def return_live_x():
    return updater.x
</code></pre>
<p>When I call return_live_x as an UDF , how do i get it to continuously return 1,2,3,4 etc in excel?</p>
</div>
<div class="post-text" itemprop="text">
<blockquote>
<p><strong>Question</strong>: ... its more about getting the UDF to auto refresh the value in excel </p>
</blockquote>
<p>UDF's are called if Excel decides to recalculate or Key pressed to do so manually.  </p>
<p>Don't know if it's possible to Start and Run a Python Script Forever in the Background using <code>xlwings</code>.</p>
<p>I could Imagin the follwoing, <strong>untested Code</strong>:  </p>
<blockquote>
<p><strong>Note</strong>: This Code could lead Excel to stall.</p>
</blockquote>
<pre><code>class LiveUpdate():
    def __init__(self, wb):
        self.wb = wb
        ...

    def _refresh_value(self):
        while True:
            self.x += 1
            self.wb.sheets[0].range('A1').value = self.x
            time.sleep(1)

@xw.func
def start_LiveUpdate():
    LiveUpdate(xw.Book.caller())
    return 'started'
</code></pre>
</div>
<span class="comment-copy">It's likely you will get <code>1000, 3000, 5000</code> on call of <code>return_live_x</code>. Read about <a href="https://docs.python.org/3/library/queue.html" rel="nofollow noreferrer">Queue</a>, consider the Example on this site.</span>
<span class="comment-copy">I dont mind getting 1,2,5,7,8 etc its more about getting the UDF to auto refresh the value in excel when self.x updates and return_live_x() is being used in excel</span>
<span class="comment-copy">you can get python to start and continuously update if you use optimzed_connection=True in the vba module.</span>
<span class="comment-copy">im more interested to see if i can get start_LiveUpdate to return the most up to date value of self.x</span>
