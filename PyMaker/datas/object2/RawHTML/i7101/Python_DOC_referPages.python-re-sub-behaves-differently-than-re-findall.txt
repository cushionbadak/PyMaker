<div class="post-text" itemprop="text">
<p>I'm stumped. I'm coding Python 3.6.2, using PyCharm as my IDE. The following script fragment illustrates my problem:</p>
<pre><code>def dosubst(m):
    return m.group() + "X"

line = r"set @message = formatmessage('%s %s', @arg1, @arg2);"
m = re.findall(r"@\w+\b", line, re.IGNORECASE)
print(m[0])  # prints "@message"
print(m[1])  # prints "@arg1"
print(m[2])  # prints "@arg2"

foo = re.sub(r"@\w+\b", dosubst, line, re.IGNORECASE)
print(foo)  # prints "set @messageX = formatmessage('%s %s', @arg1X, @arg2);"
</code></pre>
<p>You can see that <code>re.findall</code> finds three matches. However, <code>re.sub</code> only calls the <code>dosubst</code> function <strong>twice</strong>. If I change <code>@message</code> to <code>message</code> then <code>re.sub</code> still calls <code>dosubst</code> twice, but picks up <code>@arg1</code> and <code>@arg2</code>. Baffled. I thought it might be greedy vs. posessive, etc. but - changing <code>@message</code> to <code>message</code> and the resulting behavior negates that. Can anyone explain? I'm trying to do some basic text parsing of SQL to refactor message formatting for a large number of files. I use regexr.com to prototype most of the regex stuff I do and it also finds three occurrences of the pattern in the line. Thanks.</p>
</div>
<div class="post-text" itemprop="text">
<p>See <a href="https://docs.python.org/3/library/re.html#re.sub" rel="noreferrer">the documentation</a>.  The fourth argument to <code>re.sub</code> is <code>count</code>, not <code>flags</code>.  Since <code>re.IGNORECASE</code> happens to be 2, you are telling it to only do two substitutions.  Instead, pass <code>flags</code> by keyword:</p>
<pre><code>&gt;&gt;&gt; re.sub(r"@\w+\b", dosubst, line, flags=re.IGNORECASE)
"set @messageX = formatmessage('%s %s', @arg1X, @arg2X);"
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>By giving the fourth argument <code>count=0</code>. If you put the other positive numbers instead of <code>0</code> than it will replace the string exactly the same number of time. </p>
<pre><code>foo = re.sub(r"@\w+\b", dosubst, line, 0, re.IGNORECASE)
print(foo)
</code></pre>
<p>output:</p>
<pre><code>"set @MessageX = formatmessage('%s %s', @arg1X, @arg2X);"
</code></pre>
</div>
