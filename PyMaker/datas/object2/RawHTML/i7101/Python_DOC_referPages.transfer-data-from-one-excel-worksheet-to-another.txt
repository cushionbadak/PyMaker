<div class="post-text" itemprop="text">
<p><a href="https://i.stack.imgur.com/fkX8t.png" rel="nofollow noreferrer"><img alt="Input File" src="https://i.stack.imgur.com/fkX8t.png"/></a>
<a href="https://i.stack.imgur.com/p1ceU.png" rel="nofollow noreferrer"><img alt="Output File" src="https://i.stack.imgur.com/p1ceU.png"/></a></p>
<p>I have an excel file in which all data is listed in rows, I need to take this data and list it in column A of individual worksheets in a newly created workbook. I cannot quite get the syntax correct. Please Assist</p>
<pre><code>import openpyxl
import os
import time

wb = openpyxl.load_workbook('IP-Results.xlsx') #load input file
sheet = wb.get_sheet_by_name('IP-Results-32708') #get sheet from input file

wbOutput = openpyxl.Workbook() #open a new workbook
wbOutput.remove_sheet(wbOutput.get_sheet_by_name('Sheet')) #remove initial worksheet named 'sheet'

for cell in sheet['A']: #iterate through firewall names in column A and make those the title of the sheets in new workbook
    value = cell.value
    wbOutput.create_sheet(title=cell.value)



for rowOfCellObjects in sheet.iter_rows():
    for data in rowOfCellObjects:
        if data.value != None:
            for worksheet in wbOutput.get_sheet_names():
                worksheet.cell(row=1, column=1).value = data


wbOutput.save("Decom-" + time.strftime("%d-%m-%Y")+ ".xlsx")
</code></pre>
<p>This code gives me the following error:</p>
<p>c:\Python35\Scripts&gt;python decom.py
Traceback (most recent call last):
  File "decom.py", line 21, in 
    ws=worksheet.active
AttributeError: 'str' object has no attribute 'active'</p>
</div>
<div class="post-text" itemprop="text">
<p><code>wbOutput.get_sheet_names()</code> returns a <code>list</code> of strings.</p>
<p>To reference a worksheet object use <code>wbOutput.worksheets[0]</code></p>
<p><strong>Replace:</strong></p>
<p><code>for worksheet in wbOutput.get_sheet_names():</code> </p>
<p>;with</p>
<p><code>for worksheet in wbOutput.worksheets:</code></p>
</div>
<span class="comment-copy">Can you please post <code>get_sheet_names()</code> function.</span>
<span class="comment-copy">All of my code is there.</span>
<span class="comment-copy">Note a problem, I just looked up the reference and replied with a possible solution.</span>
<span class="comment-copy">Convert it to a <code>csv</code> then use python <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">csv</a> to read, manipulate and write to a new csv. After you are done convert the new csv back to an excel workbook.</span>
<span class="comment-copy">So, my code now looks like:  for rowOfCellObjects in sheet.iter_rows(): 	for data in rowOfCellObjects: 		if data.value != None: 			for worksheet in wbOutput.worksheets: 				worksheet.cell(row=1, column=1).value = data</span>
<span class="comment-copy">I get this error:   c:\Python35\Scripts&gt;python decom.py Traceback (most recent call last):   File "decom.py", line 21, in &lt;module&gt;     worksheet.cell(row=1, column=1).value = data   File "C:\Python35\lib\site-packages\openpyxl\cell\cell.py", line 294, in value      self._bind_value(value)   File "C:\Python35\lib\site-packages\openpyxl\cell\cell.py", line 201, in _bind _value     raise ValueError("Cannot convert {0!r} to Excel".format(value)) ValueError: Cannot convert &lt;Cell 'IP-Results-32708'.A1&gt; to Excel</span>
<span class="comment-copy">Hi, this looks like a new issue. Feel free to create a new thread, and set this one as answered, as I believe the original error is now gone, for others with similar errors in your original post.</span>
