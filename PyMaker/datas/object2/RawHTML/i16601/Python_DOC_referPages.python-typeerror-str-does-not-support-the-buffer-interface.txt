<div class="post-text" itemprop="text">
<p>I have the below code that was working fine and then started throwing this error. I have a csv file that I am trying to write one row to. While other solutions involve converting things to a byte string first, since I'm working with a csv, I'm not sure I can do that.</p>
<p><strong>Code:</strong></p>
<pre><code>def saveFile():
    with open('data.csv','wb') as out:
        csv_out=csv.writer(out)
        csv_out.writerow(['Domain:','Mail Server:','TLS:','# of Employees:','Verified:'])
        for row in root.pt.get_rows():
            #csv_out.writerow(row)
            print (row)
</code></pre>
<p><strong>Error:</strong></p>
<pre><code>Traceback (most recent call last):
  File "C:\Python34\lib\tkinter\__init__.py", line 1487, in __call__
    return self.func(*args)
  File "C:/Users/kylec/Desktop/DataMotion/Python/MailChecker.py", line 93, in saveFile
    csv_out.writerow(['Domain:','Mail Server:','TLS:','# of Employees:','Verified:'])
TypeError: 'str' does not support the buffer interface
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>In Python 3, the <code>csv</code> module expects you to give it a file in <em>text mode</em>:</p>
<pre><code>with open('data.csv', 'w', newline='') as out:
</code></pre>
<p>The <code>newline=''</code> argument gives the <code>csv</code> module control over how newlines are written (the reason why in Python 2 you opened the file in binary mode).</p>
<p>From the <a href="https://docs.python.org/3/library/csv.html#csv.writer" rel="nofollow"><code>csv.writer()</code> documentation</a>:</p>
<blockquote>
<p>If <em>csvfile</em> is a file object, it should be opened with <code>newline=''</code>.</p>
<p>[...]</p>
<p>If <code>newline=''</code> is not specified, newlines embedded inside quoted fields will not be interpreted correctly, and on platforms that use <code>\r\n</code> linendings on write an extra <code>\r</code> will be added. It should always be safe to specify <code>newline=''</code>, since the csv module does its own (<em>universal</em>) newline handling. </p>
</blockquote>
<p>Because you gave the module a binary-mode file, you can only write <em><code>bytes</code> data</em> to it.</p>
</div>
<span class="comment-copy">Just so I know, isn't that what wb is for?</span>
<span class="comment-copy">@Kyle: in <i>Python 2</i> you'd have to open the file in binary mode, yes. But this isn't Python 2.</span>
<span class="comment-copy">Right, I got it, thanks for the help.</span>
