<div class="post-text" itemprop="text">
<p>I've been trying to get a NetSuite Restlet to work with Python 3.3 using <code>urllib</code>, but I can't seem to get the authorization to take and continually return a <code>urllib.error.HTTPError: HTTP Error 401: Authorization Required</code> error. </p>
<p>Where am I going wrong with authentication? </p>
<p>My test code is as follows:</p>
<pre><code>import urllib.request

url = 'https://rest.netsuite.com/app/site/hosting/restlet.nl?script=123&amp;deploy=15&amp;recordtype=salesorder&amp;id=123456789'

authorization = 'NLAuth nlauth_account=111111,nlauth_email=email@email.com,nlauth_signature=password,nlauth_role=3' 

req = urllib.request.Request(url)
req.add_header('Authorization', authorization)
req.add_header('Content-Type','application/json')
req.add_header('Accept','*/*')
response = urllib.request.urlopen(req)
the_page = response.read()
</code></pre>
<p>For reference, NetSuite's REST help was used to build the authorization string as well as the Python docs on urllib located <a href="http://docs.python.org/3/howto/urllib2.html" rel="nofollow">here</a></p>
<p>--EDIT--</p>
<p>The header that is passed (and works) via REST Console appears as follows: </p>
<pre><code>Accept: application/json
Authorization: NLAuth nlauth_account=111111,nlauth_email=user@email.com,nlauth_signature=password,nlauth_role=3
Connection: keep-alive
Content-Type: application/xml
Origin: chrome-extension: //rest-console-id
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/29.0.1547.66 Safari/537.36
</code></pre>
<p>headers output from Python appear as: </p>
<pre><code>{'Content-type': 'application/xml', 'Accept': 'application/json', 'Authorization': 'NLAuth nlauth_account=111111,nlauth_email=email@email.com,nlauth_signature=password,nlauth_role=3'}
</code></pre>
<p>still not sure why it's not working....</p>
</div>
<div class="post-text" itemprop="text">
<p>Issue was NetSuite related (an issue with roles): Code below yeilds a proper response: </p>
<pre><code>import urllib.request
try:   
    url = 'https://rest.netsuite.com/app/site/hosting/restlet.nl?script=787&amp;deploy=1&amp;recordtype=salesorder&amp;id=8111437'
    authorization = 'NLAuth nlauth_account=111111,nlauth_email=email@email.com,nlauth_signature=password,nlauth_role=correctRole' 
    req = urllib.request.Request(url)
    req.add_header('Authorization', authorization)
    req.add_header('Content-Type','application/xml')
    req.add_header('Accept','application/json')  
    response = urllib.request.urlopen(req)
    print(response.read())
except IOError as e:
    print("EXCEPTION OCCURRED--------------------")
    print("I/O error: {0}".format(e))
    print(e.headers)
    print(e.headers['www-authenticate'])
</code></pre>
<p>In my case, the original role did not have access to the record. The confusion was I was expecting an error of  </p>
<pre><code>error code: INVALID_ROLE
error message:Your role does not give you permission to view this page.
</code></pre>
<p>to be returned, not an authentication required which made me suspect the header was missing data. </p>
</div>
