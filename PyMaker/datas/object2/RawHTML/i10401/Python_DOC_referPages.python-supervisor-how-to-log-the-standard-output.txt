<div class="post-text" itemprop="text">
<p>I'm not expert about python, could someone explain where is the problem?</p>
<p>I'd like to collect the stdout through supervisor 
<a href="http://supervisord.org/" rel="nofollow">http://supervisord.org/</a></p>
<p>I've made 3 different scripts that print output, for bash and PHP I can collect the output, without problems, python doesn't work.</p>
<p>php_test.sh</p>
<pre><code>#!/usr/bin/php
&lt;?php
    for($i=0;$i&lt;100000;$i++){
        sleep(5);
        echo 'test';
    }
?&gt;
</code></pre>
<p>bash_test.sh</p>
<pre><code>#!/bin/bash
for i in `seq 1 100000`; do
    sleep 5
    echo item: $i
done
</code></pre>
<p>python_test.sh ( with differents tests to print output )</p>
<pre><code>#!/usr/bin/python3
import time
import sys
from contextlib import redirect_stdout

for num in range(0,100000):
    time.sleep(5)
    print("test!")
    sys.stdout.write("test")
    with redirect_stdout(sys.stderr):
        print("test")
</code></pre>
<p>My supervisor config files</p>
<p>bash</p>
<pre><code>[program:bash_test]
process_name=bash_test
command=/home/user/bash_test.sh
stdout_logfile=/home/user/bash_test_output.log
stdout_logfile_maxbytes=0
</code></pre>
<p>php</p>
<pre><code>[program:php_test]
process_name=php_test
command=/home/user/php_test.sh
stdout_logfile=/home/user/php_test_output.log
stdout_logfile_maxbytes=0
</code></pre>
<p>python</p>
<pre><code>[program:python_test]
process_name=python_test
command=/home/user/python_test.sh
stdout_logfile=/home/user/python_test_output.log
stdout_logfile_maxbytes=0
</code></pre>
<p>Thank so much for the help.
It's driving me crazy ;[</p>
</div>
<div class="post-text" itemprop="text">
<p>ok...python output is buffered,
use this after print</p>
<pre><code>sys.stdout.flush()
</code></pre>
<p>or ( python 3 )</p>
<pre><code>print(something, flush=True)
</code></pre>
<p>or better </p>
<pre><code>import logging
logging.warning('Watch out!')
</code></pre>
<p><a href="https://docs.python.org/3/howto/logging.html" rel="noreferrer">https://docs.python.org/3/howto/logging.html</a></p>
</div>
<div class="post-text" itemprop="text">
<p>You can also install a stdout friendly version using <code>pip install supervisor-stdout
</code>. Find the usage instructions <a href="https://github.com/coderanger/supervisor-stdout" rel="nofollow noreferrer">here</a>.</p>
<p>UPDATE:
you can also update your <code>supervisord.conf</code> to point the output to stdout.  </p>
<pre><code>[program:worker2]
command=bash yourscript.sh
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
</code></pre>
</div>
<span class="comment-copy">Neither of the two output work?</span>
<span class="comment-copy">PHP and BASH work fine, Python doesn't print anything.  If I execute the script with <code>python3 ./python_test.sh</code> I can see the output in the console but not in the supervisor logs ;(</span>
