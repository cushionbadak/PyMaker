<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/23296356/why-does-this-code-raise-csv-error">Why does this code raise csv.Error?</a>
<span class="question-originals-answer-count">
                    1 answer
                </span>
</li>
</ul>
</div>
<p>This is my code:</p>
<pre><code>with open('myData', 'a') as f:
    if count1 == 1:
        df.to_csv(f,index=False, quoting=3 )
    else:
        df.to_csv(f,index=False, quoting=3 , header = False)


Error: need to escape, but no escapechar set
</code></pre>
<p>How can I solve this issue? I think I need to change quoting to None and quote character to '"'. Am I going in the right direction?</p>
<p>This is the complete traceback:</p>
<pre><code>---------------------------------------------------------------------------
Error                                     Traceback (most recent call last)
&lt;ipython-input-22-7b964e5d0ae8&gt; in &lt;module&gt;()
 27         action.perform()
 28         html = browser.page_source
---&gt; 29         ScrapePage(html)

&lt;ipython-input-20-1d50d699fe76&gt; in ScrapePage(html)
 56     with open('myData', 'a') as f:
 57         if count1 == 1:
---&gt; 58             df.to_csv(f,index=False, quoting=3 )
 59         else:
 60             df.to_csv(f,index=False, quoting=3 , header = False)

C:\Anaconda2\lib\site-packages\pandas\core\frame.pyc in to_csv(self, path_or_buf, sep,
na_rep, float_format, columns, header, index, index_label, mode, encoding, compression,
quoting, quotechar, line_terminator, chunksize, tupleize_cols, date_format, doublequote,
escapechar, decimal, **kwds)

1330                                      escapechar=escapechar,
1331                                      decimal=decimal)
-&gt; 1332         formatter.save()
1333 
1334         if path_or_buf is None:

C:\Anaconda2\lib\site-packages\pandas\core\format.pyc in save(self)
1504 
1505             else:
-&gt; 1506                 self._save()
1507 
1508         finally:

C:\Anaconda2\lib\site-packages\pandas\core\format.pyc in _save(self)
1604                 break
1605 
-&gt; 1606             self._save_chunk(start_i, end_i)
1607 
1608     def _save_chunk(self, start_i, end_i):

C:\Anaconda2\lib\site-packages\pandas\core\format.pyc in _save_chunk(self, start_i, end_i)
1631                                         quoting=self.quoting)
1632 
-&gt; 1633         lib.write_csv_rows(self.data, ix, self.nlevels, self.cols, self.writer)
1634 
1635 # from collections import namedtuple

pandas\lib.pyx in pandas.lib.write_csv_rows (pandas\lib.c:19840)()

Error: need to escape, but no escapechar set
</code></pre>
<p>The reason for writing to csv in <code>if: else:</code> is because I have to write multiple dataframes to the same file. I am using a count to check whether its the first write or not. </p>
</div>
<div class="post-text" itemprop="text">
<p>The option <code>quoting=3</code> is equivalent to <code>quoting=csv.QUOTE_NONE</code>. It is an instruction never to quote fields. If any of the fields contain the delimiter (a comma) then the comma will have to be escaped. However there is no escapechar set, and this raises an error. <a href="https://docs.python.org/3/library/csv.html#csv.QUOTE_ALL" rel="nofollow">Documentation for csv quote constants</a></p>
<p>You can set an escapechar <code>df.to_csv(f,index=False, quoting=3, escapechar=r'\')</code> for example, to use a backslash to escape any commas that appear, or you can use a different value for quoting. <code>quoting=csv.QUOTE_MINIMAL</code> (or <code>quoting=0</code>) will use quotes around only those fields that require them.</p>
<p>To give a concrete example, suppose you have a dataframe with two rows and two columns:</p>
<pre><code>2015   "eggs and spam"
2016   "eggs, bacon and spam"
</code></pre>
<p>As a csv file with <code>quoting=0</code> you get (quote marks used around the field containing a comma)</p>
<pre><code>2015,eggs and spam
2016,"eggs, bacon and spam"
</code></pre>
<p>With <code>quoting=3, escapechar=r"\"</code> you get: ("\" used to escape the comma)</p>
<pre><code>2015,eggs and spam
2016,eggs\, bacon and spam
</code></pre>
<p>But with <code>quoting=3</code> and no escapechar you get an error.</p>
<p>The best solution would be to use <code>quoting=0</code></p>
</div>
<span class="comment-copy">Please provide full traceback.</span>
<span class="comment-copy">Are you using pandas?  Can you show the complete traceback -- it is much preferable to picking out a phrase</span>
<span class="comment-copy">I still dont understand why I need to give an escape character and what will that do? Can you please elaborate a bit more?</span>
<span class="comment-copy">I've inserted some examples. You need an escapechar because one of your fields contains a comma or a quote.</span>
<span class="comment-copy"><i>"The best solution would be to use quoting=0"</i> that is very rarely the best solution for the exact same reason that you try to work around: quotes might then need to be escaped themselves when reading the file in again (or at least one has to pay attention that there are quotes in the input file and read them accordingly).</span>
