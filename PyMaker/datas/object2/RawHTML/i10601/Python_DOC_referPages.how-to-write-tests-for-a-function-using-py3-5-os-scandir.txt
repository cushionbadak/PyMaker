<div class="post-text" itemprop="text">
<p>How to write tests to a function using the newly added to build-ins of python 3.5 <code>os.scandir()</code>?
Is there a helper to mock a <code>DirEntry</code> objects?</p>
<p>Any suggestions on how to mock <code>os.scandir()</code> of an empty folder and a folder with few 2 files for example?</p>
</div>
<div class="post-text" itemprop="text">
<p>As suggested, my solution involves <code>@mock.patch()</code> decorator.
My test became something like:</p>
<pre><code>from django.test import TestCase, mock
from my_app.scan_files import my_method_that_return_count_of_files

mock_one_file = mock.MagicMock(return_value = ['one_file', ])

class MyMethodThatReturnCountOfFilesfilesTestCase(TestCase):
    @mock.patch('os.scandir', mock_one_file)
    def test_get_one(self):
        """ Test it receives 1 (one) file """
        files_count = my_method_that_return_count_of_files('/anything/')
        self.assertEqual(files_count, 1)
</code></pre>
</div>
<span class="comment-copy">I think you are looking for <a href="https://docs.python.org/3/library/unittest.mock.html#unittest.mock.patch" rel="nofollow noreferrer">mock.patch()</a> decorator</span>
