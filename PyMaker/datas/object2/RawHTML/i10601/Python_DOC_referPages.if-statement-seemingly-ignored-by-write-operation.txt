<div class="post-text" itemprop="text">
<p>What I am trying to do here is write the latitude and longitude of the sighting of a pokemon to a text file if it doesn't already exist. Since I am using an infinite loop, I added an if-state that prevents an already existent pair of coordinates to be added.
Note that I also have a list Coordinates that stores the same information. The list works as no repeats are added.(By checking) However, the text file has the same coordinates appended over and over again even though it theoretically shouldn't as it is contained within the same if-block as the list.</p>
<pre><code>import requests

pokemon_url = 'https://pogo.appx.hk/top'

while True:
    response = requests.get(pokemon_url)
    response.raise_for_status()

    pokemon = response.json()[0:]

    Sighting = 0
    Coordinates = [None] * 100

    for num in range(len(pokemon)):
        if pokemon[num]['pokemon_name'] == 'Aerodactyl':
            Lat = pokemon[num]['latitude']
            Long = pokemon[num]['longitude']
            if (Lat, Long) not in Coordinates:
                Coordinates[Sighting] = (Lat, Long)
                file = open("aerodactyl.txt", "a")
                file.write(str(Lat) + "," + str(Long) + "\n")
                file.close()
                Sighting += 1
</code></pre>
<p>For clarity purposes, this is the output
<a href="https://i.stack.imgur.com/O47r6.png" rel="nofollow noreferrer"><img alt="For clarity purposes, this is the output" src="https://i.stack.imgur.com/O47r6.png"/></a></p>
</div>
<div class="post-text" itemprop="text">
<p>You need to put your <code>Sighting</code> and <code>Coordinates</code> variables outside of the <code>while</code> loop if you do not want them to reset on every iteration.</p>
<p>However, there are a lot more things wrong with the code. Without trying it, here's what I spot:</p>
<ol>
<li>You have no exit condition for the <code>while</code> loop. Please don't do this to the poor website. You'll essentially be spamming requests.</li>
<li><code>file.close</code> should be <code>file.close()</code>, but overall you should only need to open the file once, not on every single iteration of the loop. Open it once, and close once you're done (assuming you will add an exit condition).</li>
<li>Slicing from <code>0</code> (<code>response.json()[0:]</code>) is unnecessary. By default the list starts at index 0. This may be a convoluted way to get a new list, but that seems unnecessary here.</li>
<li><code>Coordinates</code> should not be a hard-coded list of 100 <code>None</code>s. Just use a <a href="https://docs.python.org/3/library/stdtypes.html#set" rel="nofollow"><code>set</code></a> to track existing coordinates.</li>
<li>Get rid of <code>Sighting</code> altogether. It doesn't make sense if you're re-issuing the request over and over again. If you want to iterate through the pok√©mon from one response, use <a href="https://docs.python.org/3/library/functions.html#enumerate" rel="nofollow"><code>enumerate</code></a> if you need the index.</li>
<li>It's generally good practice to use <a href="https://en.wikipedia.org/wiki/Snake_case" rel="nofollow">snake case</a> for Python variables.</li>
</ol>
</div>
<div class="post-text" itemprop="text">
<p>Try this:</p>
<pre><code>#!/usr/bin/env python

import urllib2
import json

pokemon_url = 'https://pogo.appx.hk/top'

pokemon = urllib2.urlopen(pokemon_url)

pokeset = json.load(pokemon)

Coordinates = [None] * 100

for num in range(len(pokeset)):
    if pokeset[num]['pokemon_name'] == 'Aerodactyl':
        Lat = pokeset[num]['latitude']
        Long = pokeset[num]['longitude']
        if (Lat, Long) not in Coordinates:
            Coordinates.append((Lat, Long))
            file = open("aerodactyl.txt", "a")
            file.write(str(Lat) + "," + str(Long) + "\n")
            file.close
</code></pre>
</div>
<span class="comment-copy">this code is totally messed up. the <code>while True</code> loop will never exit, and you forgot to add a pair of parentheses after the <code>file.close</code> call.</span>
<span class="comment-copy">Is the <code>for</code> loop supposed to be inside the <code>while</code> loop?</span>
<span class="comment-copy">I'd recommend a <code>set()</code> for coordinates instead of a list.</span>
<span class="comment-copy">Thanks, I have added the parentheses after the 'file.close' call. The reason for the 'while' loop is that I am trying to scrap data from a website that continuously changes.</span>
<span class="comment-copy">You're emptying <code>Coordinates</code> before the <code>for</code> loop, so it forgets all the coordinates from previous iterations, even though you've written them to the file.</span>
<span class="comment-copy">The reason he closes the file each time is because of the infinite loop. He ends the loop by pressing Ctl-c.</span>
<span class="comment-copy">Thank you. I do realize that this is terrible coding, but I was just learning to scrap data from webpages.</span>
<span class="comment-copy">@ShermanSze You're welcome - we're all here to learn :)</span>
