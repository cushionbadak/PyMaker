<div class="post-text" itemprop="text">
<p>I like to read in a list of ASCII files (utf-8) with the csv reader.
For error handling i like to detect if a user has seleted by accident a file which cannot be read.
The source is like this:</p>
<pre><code>    for File in Filenames:
    print ('... processing file :',File)
    with open(File, 'r') as csvfile:
        Reader = csv.reader(csvfile, delimiter = ';')           
        for Line in Reader:
            print(Line)
</code></pre>
<p>I the user selects e.g. file which is GZIPed i got the message:</p>
<p>(result, consumed) = self._buffer_decode(data, self.errors, final)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte</p>
<p>Which in the first place is ok, but the script crashes.
I didn't found out how to capture the error and force the script to jump to the next file in the list. I found a lot of about dialects and other codecs, but my task is not to read the wrong file by just changing the codec.</p>
<p>Many thanks for any comment!</p>
</div>
<div class="post-text" itemprop="text">
<p>How about this:    </p>
<pre><code>for File in Filenames:
    print ('... processing file :',File)
    with open(File, 'r') as csvfile:
        try:
            Reader = csv.reader(csvfile, delimiter = ';')           
            for Line in Reader:
                print(Line)
        except UnicodeDecodeError as e:
            print("File {:} cannot be read. Skipping...".format(csvfile))
            continue
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use exception handling - <a href="https://docs.python.org/3/tutorial/errors.html" rel="nofollow">https://docs.python.org/3/tutorial/errors.html</a></p>
<p>Your code would then look like:</p>
<pre><code>for File in Filenames:
    print ('... processing file :',File)
    try:
        with open(File, 'r', encoding='utf-8') as csvfile:
            Reader = csv.reader(csvfile, delimiter = ';')           
            for Line in Reader:
                print(Line)
    except UnicodeDecodeError:
         pass
</code></pre>
<p>It's good practice to include the encoding you expect when you open the file. If you put the same script on a Windows box, the default encoding would not be "utf-8".</p>
</div>
<span class="comment-copy">do you really have to wrap the <code>with</code> in the <code>try</code> too? Can it through an error as well?</span>
<span class="comment-copy">IIRC, it's the TextWrapper of <code>open()</code> that throws the UnicodeDecodeError.</span>
<span class="comment-copy">Thanks a lot for that!</span>
