<div class="post-text" itemprop="text">
<p>How often does sys.stderr flush its buffer, and is this standard among different environments?</p>
<pre><code>&gt;&gt;&gt; import sys
&gt;&gt;&gt; sys.__stderr__
&lt;open file '&lt;stderr&gt;', mode 'w' at 0x2b4fcb7ac270&gt;
</code></pre>
<p>I see that it is just a standard file type, but I don't know what value of <a href="http://docs.python.org/2/library/functions.html#open" rel="noreferrer"><em>buffering</em></a> it's supposed to be. <code>dir()</code> does not seem to yield any useful information either.</p>
</div>
<div class="post-text" itemprop="text">
<p>On Python 2, I can't find where in the documentation <code>sys.stderr</code>'s buffering is specified. I'd expect the same behaviour as  <a href="https://stackoverflow.com/a/3746795/4279"><code>stderr</code> in C that is unbuffered</a> <a href="http://msdn.microsoft.com/en-us/library/c565h7xx.aspx" rel="nofollow noreferrer">(except Windows)</a> and I don't know whether c99 standard mandates it. <a href="http://pubs.opengroup.org/onlinepubs/9699919799/functions/stdin.html" rel="nofollow noreferrer">The standard error stream is not fully buffered</a> in POSIX. <a href="http://docs.python.org/2/using/cmdline.html#cmdoption-u" rel="nofollow noreferrer"><code>-u</code> option forces standard streams to be unbuffered</a> in Python 2.</p>
<p><a href="http://docs.python.org/3/library/sys.html#sys.stderr" rel="nofollow noreferrer">On Python 3</a>:</p>
<blockquote>
<p>When interactive, standard streams are line-buffered. Otherwise, they
  are block-buffered like regular text files. You can override this
  value with the <code>-u</code> command-line option.</p>
</blockquote>
<p><a href="http://docs.python.org/3/using/cmdline.html#cmdoption-u" rel="nofollow noreferrer"><code>-u</code> command-line option</a>:</p>
<blockquote>
<p>Force the binary layer of the stdout and stderr streams (which is
  available as their <code>buffer</code> attribute) to be unbuffered. The text I/O
  layer will still be line-buffered if writing to the console, or
  block-buffered if redirected to a non-interactive file.</p>
</blockquote>
</div>
<span class="comment-copy">stderr, independent of <code>sys.stderr</code>, is usually unbuffered.</span>
<span class="comment-copy">Just came across a use case where stderr is buffered and it causes problems:  <code>docker run -d -p 8000:8000 ubuntu python3 -m http.server</code> runs a python HTTP server daemon. All output is to stderr and python will not flush it to <code>docker logs</code> without the <code>-u</code> flag given in the answer.</span>
