<div class="post-text" itemprop="text">
<p>When I use Python's <code>csv.DictWriter.writerows</code> on Windows, empty newlines are added between rows. How do I stop that? The code works fine on Linux.</p>
</div>
<div class="post-text" itemprop="text">
<ul>
<li><p>In Python 2: Open the file in binary mode, always; <code>csv.DictWriter()</code> writes <code>\r\n</code> line endings:</p>
<pre><code>with open(filename, 'ab') as outputfile:
    writer = csv.DictWriter(outputfile, fieldnames)
</code></pre>
<p>From the <a href="http://docs.python.org/2/library/csv.html#csv.writer"><code>csv.writer()</code> documentation</a>:</p>
<blockquote>
<p>If <em>csvfile</em> is a file object, it must be opened with the ‘b’ flag on platforms where that makes a difference. </p>
</blockquote></li>
<li><p>In Python 3: Open the file with <code>newline=''</code> so <code>csv.DictWriter()</code> can control the newlines written without translation:</p>
<pre><code>with open(filename, 'a', newline='') as outputfile:
    writer = csv.DictWriter(outputfile, fieldnames)
</code></pre>
<p>Again, quoting the relevant <a href="http://docs.python.org/3/library/csv.html#csv.writer"><code>csv.writer()</code> documenation</a>:</p>
<blockquote>
<p>If <em>csvfile</em> is a file object, it should be opened with <code>newline=''</code></p>
<p>[ ... ]</p>
<p>If <code>newline=''</code> is not specified, newlines embedded inside quoted fields will not be interpreted correctly, and on platforms that use <code>\r\n</code> linendings on write an extra <code>\r</code> will be added. It should always be safe to specify <code>newline=''</code>, since the csv module does its own (universal) newline handling.</p>
</blockquote></li>
</ul>
</div>
<span class="comment-copy">How are you opening the file to write to?</span>
<span class="comment-copy">open(filename, 'a+')</span>
<span class="comment-copy">Why the <code>+</code>; are you reading from it too?</span>
<span class="comment-copy">ah that was leftover from when I was reading while debugging</span>
