<div class="post-text" itemprop="text">
<p>In Filemanager (Linux and Windows) I can right click a file and see its properties. I would like to set them using Python. It seems complicated. With os.stat(file) I can retrieve standard file properties, but I can not set (custom) properties. There seems to be a solutions, for C# <a href="https://stackoverflow.com/questions/20949397/retrieve-metadata-column-feilds">Retrieve metadata column feilds</a> , and for VisualBasic <a href="https://stackoverflow.com/questions/3726043/how-do-i-add-a-custom-property-to-a-file-using-vbscript/3787416#3787416">How do I add a custom property to a file using VBScript</a> but I could not find anything for Python. Your help is much appreciated. Python is polymorphous, so I would expect :</p>
<pre><code> setattr(file, property_name, property_value) 
</code></pre>
<p>but this does not work.</p>
</div>
<div class="post-text" itemprop="text">
<p>Check out <a href="https://stackoverflow.com/a/4996407/2488942">this answer</a>.</p>
<p>With a few modules you can change e.g. the creation time by @Claudiu's solution:</p>
<pre><code>import pywintypes, win32file, win32con
def changeFileCreationTime(fname, newtime):
    wintime = pywintypes.Time(newtime)
    winfile = win32file.CreateFile(
        fname, win32con.GENERIC_WRITE,
        win32con.FILE_SHARE_READ | win32con.FILE_SHARE_WRITE | win32con.FILE_SHARE_DELETE,
        None, win32con.OPEN_EXISTING,
        win32con.FILE_ATTRIBUTE_NORMAL, None)

    win32file.SetFileTime(winfile, wintime, None, None)

    winfile.close()
</code></pre>
<p>pywin32, which includes pywintypes etc, is available from <a href="http://sourceforge.net/projects/pywin32/" rel="nofollow noreferrer">here</a>. I'm not sure if there is specific documentation for pywin32, but these types of modules are usually wrappers around the MS API, e.g. for VBA or C#. So it's often quite easy to find answers in the e.g. MS C# docs (based on my experience with office applications). This might help you to set any arbitrary file property.</p>
</div>
<div class="post-text" itemprop="text">
<p>Do not try to set metadata for files in Python. Because even if it would be possible, copying the file might lose the metadata, see <a href="http://docs.python.org/3/library/shutil.html#module-shutil" rel="nofollow">http://docs.python.org/3/library/shutil.html#module-shutil</a>  This mean using metadata will result to unpredictable results. Which is bad. Better something is not possible at all, then being unpredictable.</p>
<p>Work around :
I created an addition textfile meta.txt and archived these files using :</p>
<pre><code>shutil.make_archive
</code></pre>
<p>Not beautiful at all. But this archive file can be copied, without the change loosing metadata. When un-archived all metadata of the file are accessible.</p>
</div>
<span class="comment-copy">Could you provide an example of non-standard file properties that you would like to set?</span>
<span class="comment-copy">Description, version, valid,etc.  I am building a Sanity_check to check if all required resources, for a specific program, are met. It is a kind of log file, but the result can be read in the program again, and differences can be compared. The volume of files may be as large as of logfiles. A data file (pickle) have to have descriptive info, so the user knows he has the correct file for a specific kind of sanity_check.</span>
<span class="comment-copy">don't put the relevant info in the comments. <a href="https://stackoverflow.com/posts/22477034/edit">edit</a> your question instead</span>
<span class="comment-copy">Do you need to access properties that you do not create yourself?</span>
<span class="comment-copy">It would be useful, be not necessary.</span>
<span class="comment-copy">Thanks, but I need it for all os. If only a specific os is possible then I need Linux. I see I added, by mistake, a windows tag. I just removed the windows tag.</span>
<span class="comment-copy">No worries. I don't use Linux very often, but I believe it has many command line tools that might do what you want. E.g. 'touch' changes the last accessed date. You could run this from Python maybe</span>
<span class="comment-copy">It has, and I tried see <a href="http://askubuntu.com/questions/435981/viewing-custum-attributes-of-a-file-within-nautilus" title="viewing custum attributes of a file within nautilus">askubuntu.com/questions/435981/â€¦</a>  but without success. Most important I want to limit dependencies. Using a OLE object for just calling attr creates an undesired and unpredictable dependencies which are hard to maintain.</span>
