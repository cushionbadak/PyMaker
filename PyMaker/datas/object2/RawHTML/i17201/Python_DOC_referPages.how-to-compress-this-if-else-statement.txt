<div class="post-text" itemprop="text">
<pre><code>if word not in word_map.keys():
    set1 = set()
    set1.add(line_no)                
    word_map[word] = set1
else:
    set1 = set()
    set1.add(line_no)
    set1.update(word_map[word])
    word_map[word] = set1
</code></pre>
<p>Is there anyway I can compress this into not needing an if? I have to check if the key exists so I know if I need to add what is already in set key or not, if I just have</p>
<pre><code>set1.update(word_map[word])
</code></pre>
<p>And the key does not exist, it will error out.</p>
</div>
<div class="post-text" itemprop="text">
<p>First of all, you can compress it by removing duplicate code like this:</p>
<pre><code>set1 = set()
set1.add(line_no)
if word in word_map.keys():
    set1.update(word_map[word])
word_map[word] = set1
</code></pre>
<p>Then you should think about what <a href="http://docs.python.org/3/library/stdtypes.html#set.update" rel="nofollow"><code>set.update</code></a> does. It basically adds all the elements from one set into the current one. So you can reorder your code like this too:</p>
<pre><code>if word in word_map.keys():
    set1 = word_map[word]
else:
    set1 = set()
set1.add(line_no)
word_map[word] = set1
</code></pre>
<p>We can then make this simpler by using <a href="http://docs.python.org/3/library/stdtypes.html#dict.get" rel="nofollow"><code>dict.get</code></a> to remove the if completely:</p>
<pre><code>set1 = word_map.get(word, set())
set1.add(line_no)
word_map[word] = set1
</code></pre>
<p>And then, we can also use <a href="http://docs.python.org/3/library/stdtypes.html#dict.setdefault" rel="nofollow"><code>dict.setdefault</code></a> instead to make sure that we have a set, and just add to that directly:</p>
<pre><code>set1 = word_map.setdefault(word, set())
set1.add(line_no)
</code></pre>
<p>As we now use the set that’s inside the dictionary, we don’t need to write back its value to the dictionary (we have a reference). And we could even make it a single line then:</p>
<pre><code>word_map.setdefault(word, set()).add(line_no)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Perhaps you are looking for this:</p>
<pre><code>set1 = set()
set1.add(line_no)                
if word in word_map.keys():
    set1.update(word_map[word])
word_map[word] = set1
</code></pre>
<p>Although, on the assumption that <code>word_map</code> is a <code>dict</code>, the <code>if</code> should be written like this:</p>
<pre><code>if word in word_map:
</code></pre>
</div>
<span class="comment-copy">Yep, thanks, can't believe i didn't see that ..  Yes it is a dict.</span>
