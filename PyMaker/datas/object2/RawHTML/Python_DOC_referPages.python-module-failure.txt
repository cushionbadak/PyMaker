<div class="post-text" itemprop="text">
<p>I'm learning the Cassandra object mapper using Python, and I have the following small program that populates a database table.  This works just fine...</p>
<pre><code>from cassandra.cqlengine.connection import setup
from cassandra.cqlengine.management import sync_table
from cassandra.cqlengine.models import Model
from cassandra.cqlengine import columns
from uuid import uuid4

##import Courses

class Courses(Model):
    id = columns.UUID(primary_key = True)
    title  = columns.Text()
    duration = columns.Integer()

setup(['chelly', ], 'objectlake', protocol_version = 3)

# Create some courses to inflict on our hapless trainees

courses = [
    { 'title' : "Conflict of Interest" , 'duration' : 120 },
    { 'title' : "Resolving Conflict" ,   'duration' : 60 },
    { 'title' : "Time Cards" ,           'duration' : 30 },
    { 'title' : "PTO" ,                  'duration' : 30 },
    { 'title' : "Managing Upwards" ,     'duration' : 120 }
]

sync_table(Courses)

for course in courses:
    Courses.create(id = uuid4(), title = course['title'], duration = course['duration'])

print('Done-ish?')
</code></pre>
<p>But, if I comment the definition of the Courses class and uncomment the import, with this in Courses.py:</p>
<pre><code>from cassandra.cqlengine.models import Model
from cassandra.cqlengine import columns

class Courses(Model):
    id = columns.UUID(primary_key = True)
    title  = columns.Text()
    duration = columns.Integer()
</code></pre>
<p>I get an exception <code>ValueError: Models must be derived from base Model.</code> on the <code>sync_table</code> call.  I'm certain I've pooched moving the declaration of the class into the module, but can't find what I've done wrong.  I'm not sure why my object from the module isn't a Model.</p>
</div>
<div class="post-text" itemprop="text">
<p>When you do <code>import Courses</code>, the name <code>Courses</code> will refer to the <em>module</em> called <code>Courses</code>, and <em>not</em> the class <code>Courses</code> that happens to be inside this module.</p>
<p>The function you’re using requires that its argument be derived from a certain class, and the <em>module</em> <code>Courses</code> obviously doesn’t satisfy this condition.</p>
<p>You probably meant to import the <em>class</em> called <code>Courses</code> like this:</p>
<pre><code>from Courses import Courses
</code></pre>
</div>
<span class="comment-copy"><i>Groan!</i> Yes, that's it!  I was pretty certain it was something simple.</span>
