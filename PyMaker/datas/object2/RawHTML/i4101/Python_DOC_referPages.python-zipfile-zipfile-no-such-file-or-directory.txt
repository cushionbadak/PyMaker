<div class="post-text" itemprop="text">
<p>There is folder path:</p>
<pre><code>P:\\2018\\Archive\\
</code></pre>
<p>There are many zipfiles I want to create programmatically, but am starting with test. I will name this test zip file "CO_007_II.zip" and will attempt to create in above location:</p>
<pre><code>import zipfile as zp

with zp.ZipFile("P:\\2018\\Archive\\CO_007_II.zip",'w') as myzip:
    myzip.write(r"P:\2018\CO_007_II")
</code></pre>
<p>But I get error!</p>
<p>...     </p>
<pre><code>Traceback (most recent call last):
  File "&lt;interactive input&gt;", line 1, in &lt;module&gt;
  File "C:\Python27\ArcGIS10.2\lib\zipfile.py", line 752, in __init__
    self.fp = open(file, modeDict[mode])
IOError: [Errno 2] No such file or directory: 'P:\\2018\\Archive\\CO_007_II.zip'
</code></pre>
<p>Is this not method for creating new zipfile? I know file does not exist. Is why I am using 'w' mode, no?</p>
<p>This is documentation:</p>
<p><a href="https://docs.python.org/3/library/zipfile.html" rel="nofollow noreferrer">https://docs.python.org/3/library/zipfile.html</a></p>
<p>It says:</p>
<p>'w' to truncate and <strong><em>write a new file</em></strong></p>
<p>Example on documentation page:</p>
<pre><code>with ZipFile('spam.zip', 'w') as myzip:
    myzip.write('eggs.txt')
</code></pre>
<p>code worked two days ago to create new zip file but did not add folder. Today nothing works! Why not? All paths valid. How do I create new zip file with python and add folders to it?</p>
</div>
<div class="post-text" itemprop="text">
<p>The only way this could be reproduced was to create a zipfile in a directory that does NOT exist yet. The only way to be sure (you cannot trust a file manager; only way to verify is to check from within the program itself) is to assign the desired path of the new zip file to a variable (e.g. path), and then call <code>isdir(dirname(path))</code>.  For example:</p>
<pre><code>from os.path import isdir
from os.path import dirname

target = "P:\\2018\\Archive\\CO_007_II.zip"
if not isdir(dirname(target)):
    print('cannot create zipfile because target does not exists')
else:
    # create the zipfile
</code></pre>
</div>
<span class="comment-copy">@metatoaster I see. I try -- path = "P:\\2018\\Archive\\" -- os.path.isdir(path) -- it returns false. And there is problem! Coworker added new folder to directory before archive! Still having problem though. Changed path name and did check. Returned "True" but now get this error: IOError: [Errno 22] invalid mode ('wb') or filename: ' P:\\2018\\Workspaces\\Archive\\CO_001_Model.zip'</span>
<span class="comment-copy">You may have a space before <code>P:</code>, check to be sure that isn't the case in your code.</span>
<span class="comment-copy">@metatoaster yes! right again. thank you. I don't know if this qualifies as answer but I will check it if you like to post one.</span>
