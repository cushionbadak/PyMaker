<div class="post-text" itemprop="text">
<p>I'm trying to build a script that scrapes Craigslist for a Mazda Miata. I'm getting an error with the function "extract_post_url" when it tries to request. Here is the tutorial that I'm trying to follow: 
<a href="https://github.com/vprusso/youtube_tutorials/blob/master/web_scraping_and_automation/selenium/craigstlist_scraper.py" rel="nofollow noreferrer">https://github.com/vprusso/youtube_tutorials/blob/master/web_scraping_and_automation/selenium/craigstlist_scraper.py</a></p>
<p>Here's the code so far: </p>
<pre><code>from selenium import webdriver
from selenium.webdriver.support.ui import WebDriverWait
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.common.by import By

from bs4 import BeautifulSoup
import urllib.request 

class CraigslistScaper(object): 
    def __init__(self,query,location,max_price,transmission): 
        self.query = query
#        self.sort=sort
        self.location = location
#        self.postal = postal
        self.max_price = max_price
        self.transmission = auto_transmission


#https://sfbay.craigslist.org/search/cta?query=mazda+miata&amp;sort=rel&amp;max_price=6000&amp;auto_transmission=1
        self.url = f"https://{location}.craigslist.org/search/cta?query={query}&amp;sort=rel&amp;max_price={max_price}&amp;auto_transmission={transmission}"

        self.driver = webdriver.Chrome('/Users/MyLaptop/Desktop/chromedriver')
        self.delay = 5

    def load_craigslist_url(self): 
        self.driver.get(self.url)
        try:
            wait = WebDriverWait(self.driver, self.delay)
            wait.until(EC.presence_of_element_located((By.ID,"searchform")))              
            print("page is ready")
        except TimeoutError: 
            print('Loading took too much time')

    def extract_post_titles(self): 
        all_posts = self.driver.find_elements_by_class_name('result-row')
        post_titles_list=[]
        for post in all_posts: 
            print(post.text)
            post_titles_list.append(post.text)

    def extract_post_urls(self): 
        url_list = []
#        req = Request(self.url)
        html_page = urllib.request.urlopen(self.url)
        soup = BeautifulSoup(html_page,'lxml')
        for link in soup.findAll("a ", {"class": "result-title hrdlnk"}):
            print(link["href"])
            url_list.append(["href"])
            return url_list

    def quit(self): 
        self.driver.close()

location = "sfbay" 
#postal = "94519" 
max_price = "5000"
#radius = "250"
auto_transmission = 1
query = "Mazda Miata"

scraper = CraigslistScaper(query,location,max_price,auto_transmission)        

scraper.load_craigslist_url()
scraper.extract_post_titles()
scraper.extract_post_urls()
scraper.quit()
</code></pre>
<p>Here's the error I am getting: </p>
<pre><code>File "&lt;ipython-input-2-edb38e647dc0&gt;", line 1, in &lt;module&gt;
    runfile('/Users/MyLaptop/.spyder-py3/CraigslistScraper', wdir='/Users/MohitAsthana/.spyder-py3')

  File "/anaconda3/lib/python3.6/site-packages/spyder/utils/site/sitecustomize.py", line 705, in runfile
    execfile(filename, namespace)

  File "/anaconda3/lib/python3.6/site-packages/spyder/utils/site/sitecustomize.py", line 102, in execfile
    exec(compile(f.read(), filename, 'exec'), namespace)

  File "/Users/MyLaptop/.spyder-py3/CraigslistScraper", line 73, in &lt;module&gt;
    scraper.extract_post_urls()

  File "/Users/MyLaptop/.spyder-py3/CraigslistScraper", line 52, in extract_post_urls
    html_page = urllib.request.urlopen(req)

  File "/anaconda3/lib/python3.6/urllib/request.py", line 223, in urlopen
    return opener.open(url, data, timeout)

  File "/anaconda3/lib/python3.6/urllib/request.py", line 532, in open
    response = meth(req, response)

  File "/anaconda3/lib/python3.6/urllib/request.py", line 642, in http_response
    'http', request, response, code, msg, hdrs)

  File "/anaconda3/lib/python3.6/urllib/request.py", line 570, in error
    return self._call_chain(*args)

  File "/anaconda3/lib/python3.6/urllib/request.py", line 504, in _call_chain
    result = func(*args)

  File "/anaconda3/lib/python3.6/urllib/request.py", line 650, in http_error_default
    raise HTTPError(req.full_url, code, msg, hdrs, fp)

HTTPError: Bad Request
</code></pre>
<p>Chrome opens up the right URL, but it's getting the error when I'm downloading the URL files. </p>
</div>
<div class="post-text" itemprop="text">
<p>2 issues with this line:</p>
<pre><code>self.url = f"https://{location}.craigslist.org/search/cta?query={query}&amp;sort=rel&amp;max_price={max_price}&amp;auto_transmission={transmission}"
</code></pre>
<ol>
<li><p>what type of string is f"blah" ? Prob a typo in this post but thought I'd point it out. </p></li>
<li><p><code>"https://{location}.craigslist.org/search/cta?query={query}&amp;sort=rel&amp;max_price={max_price}&amp;auto_transmission={transmission}"</code> is not a valid URL - at what point are you substituting your values (eg.: <code>self.transmission</code>) into that string? </p></li>
</ol>
<p>Replace the line with:</p>
<pre><code>self.url = "https://{}.craigslist.org/search/cta?query={}&amp;sort=rel&amp;max_price={}&amp;auto_transmission={}".format(self.location, self.query, self.max_price, self.transmission)
</code></pre>
<p>And see if that helps. If not - print the url instead of requesting it .</p>
</div>
<span class="comment-copy">Can you post the whole error?</span>
<span class="comment-copy">I replaced the self.url line with the line you typed in, it's still raising an HTTP: Bad Request error.  I created variables before running the code. "Query = Mazda Miata" etc, so I thought that would replace it. As to the f"blah", that's what the tutorial did, I was just following that.</span>
<span class="comment-copy">@DanielleM. See <a href="https://docs.python.org/3/whatsnew/3.6.html#pep-498-formatted-string-literals" rel="nofollow noreferrer">f-strings</a>, it's a nice new feature.</span>
<span class="comment-copy">@AmateurPythonLearner You have a space in your query. Either urlencode it or just replace with + eg <code>query = "Mazda+Miata"</code></span>
