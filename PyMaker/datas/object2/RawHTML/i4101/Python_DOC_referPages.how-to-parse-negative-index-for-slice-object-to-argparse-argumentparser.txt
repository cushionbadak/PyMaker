<div class="post-text" itemprop="text">
<p>I would like to give slice string as argument, see below</p>
<pre><code>import argparse

def _parse_slice(s):
    a = [int(e) if e.strip() else None for e in s.split(":")]
    return slice(*a)


if __name__ == '__main__':
    p = argparse.ArgumentParser()
    p.add_argument('-s', type=_parse_slice)
    args = p.parse_args()

    print(args.s)
</code></pre>
<p>It works fine with positive index, e.g., <code>-s 1:10</code>, <code>-s -5</code> (which gives rise to <code>slice[None, -5, None]</code>) is also fine, but errors out with negative index as first parameter, e.g., <code>-5:</code></p>
<pre><code>usage: slice-parse.py [-h] [-s S]
slice-parse.py: error: argument -s: expected one argument
</code></pre>
<p>How should I support negative index as first slice parameter?</p>
</div>
<div class="post-text" itemprop="text">
<p>Fortunately, <code>argparse</code> by default does understand the <code>=</code> token</p>
<pre><code>$ python slice-parse.py -s=-5:
slice(-5, None, None)
</code></pre>
<p>The reason why <code>-5</code> works directly as one might expect is due to <code>argparse</code> having <a href="https://docs.python.org/3/library/argparse.html#arguments-containing" rel="nofollow noreferrer">implemented some heuristics</a>, which are detailed in the linked documentation (basically <code>-5</code> looks like a number, <code>-5:</code> does not).</p>
<p>This issue is caused essentially by argparse treating all <code>-</code> (by default) as flags.  This can be redefined using <a href="https://docs.python.org/3/library/argparse.html#prefix-chars" rel="nofollow noreferrer"><code>prefix_chars</code></a>.</p>
</div>
<span class="comment-copy"><code>-s -5</code> works directly though</span>
<span class="comment-copy">@nos added more details as to why, and updated the answer for that <b>exact</b> use case even though it did not change the point...</span>
<span class="comment-copy">Thanks for all the information</span>
