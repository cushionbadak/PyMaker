<div class="post-text" itemprop="text">
<p>Got a CSV which I am selecting a random sample of 500 rows using the following code:</p>
<pre><code>import csv
import random

with open('Original.csv' , "rb") as source:
    lines = [line for line in source]

random_choice = random.sample(lines, 500);
</code></pre>
<p>what I'd like to do is update a column called [winner] if they exist within the sample and then save it back to a csv file but I have no idea how to achieve this...</p>
<p>There is a unique identifier in a column called [ID].</p>
<p>how would I go about doing this?</p>
</div>
<div class="post-text" itemprop="text">
<p>Starting with a CSV that looks like this:</p>
<pre><code>ID  something   winner
1   a   
2   b   
3   c   
4   a   
5   d   
6   a   
7   b   
8   e   
9   f   
10  g
</code></pre>
<p>You could use the following approach. The whole file is read in, rows are chosen by a randomly selected index, and written back out to the file.</p>
<pre><code>import csv
import random

# Read in the data
with open('example.csv', 'r') as infile:
    reader = csv.reader(infile)
    header = next(reader) # We want the headers, but not as part of the sample
    data = []
    for row in reader:
        data.append(row)

# Find the column called winner
winner_column_index = header.index('winner')

# Pick some random indices which will be used to generate the sample
all_indices = list(range(len(data)))

sampled_indices = random.sample(all_indices, 5)

# Add the winner column to those rows selected
for index in sampled_indices:
    data[index][winner_column_index] = 'Winner'

# Write the data back
with open('example_out.csv', 'w', newline='') as outfile:
    writer = csv.writer(outfile)
    writer.writerow(header) # Make sure we get the headers back in
    writer.writerows(data) # Write the rest of the data
</code></pre>
<p>This will give the following output:</p>
<pre><code>ID  something   winner
1   a   
2   b           Winner
3   c   
4   a           Winner
5   d   
6   a           Winner
7   b   
8   e   
9   f           Winner
10  g           Winner
</code></pre>
<p>EDIT: It turns out that having the first column of the CSV being called <code>ID</code> is not a good idea if you want to open with Excel. It then incorrectly thinks the file is in SYLK format.</p>
</div>
<div class="post-text" itemprop="text">
<p>First, why are you using csv and not a db? even an sqlite would be much easier (builtin - <code>import sqlite3</code>)</p>
<p>Second, you'll need to write the whole file again. I suggest you use your lines as lists and just update them (lists are like pointers so you can change the inner values and it will update)</p>
<p><code>lines=[list(line) for line in source]</code></p>
<p>and then
<code>
for choice in random_choice:
    choice[WINNER_INDEX]+=1
</code></p>
<p>and write the file </p>
</div>
<span class="comment-copy">Why are you not making use of the CSV module for reading the file initially?</span>
<span class="comment-copy">lack of experience... I've never written for python before but i've no reason to really write this in php this time round....</span>
<span class="comment-copy">Fair enough, I think you should spend some time reading though <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">the docs</a> because I think you're going to cause problems for yourself working without it. Can you please explain to me the criteria for updating the column? I'm not clear what "if they exist within the same" means. I'll have a go at putting an answer together</span>
<span class="comment-copy">So the idea is to update a column called winner, if they exist within the sample, and save this back into the original CSV or output it to a new CSV, either way, all the data needs to be presented in the output either with the updated value or without. (this would distinguish winners and loosers). I've updated the mistake on the question</span>
<span class="comment-copy">This is absolutely spot on for what I needed</span>
<span class="comment-copy">I've been provided the data as a CSV and must provide it back as a CSV.</span>
