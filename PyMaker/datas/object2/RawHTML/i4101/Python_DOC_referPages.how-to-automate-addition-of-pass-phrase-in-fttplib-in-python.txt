<div class="post-text" itemprop="text">
<p>I am trying to download files using ftps. I'm using ftplib in python. The issue is that on trying to establish connection, I always have to manually enter the passphrase for the key. How can I automate this ?</p>
<p>This curl command is working perfectly</p>
<pre><code>curl -k -la --ftp-method nocwd --ftp-ssl -u test_user:test_password --key my_key.key --cert my_cert.crt:cert_password ftp.mysite.com
</code></pre>
<p>But when I'm trying with python, I have to manually enter "cert_password"</p>
<pre><code>import ftplib
conn = ftplib.FTP_TLS(host='ftp.mysite.come', user='test_user', passwd='test_password', keyfile='my_key.key', certfile='my_cert.crt') 
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I didn't work with <em>ftplib</em>, but according to <a href="https://docs.python.org/3/library/ftplib.html#ftplib.FTP_TLS" rel="nofollow noreferrer">[Python]: <em>class</em> ftplib.<strong>FTP_TLS</strong>(<em>host='', user='', passwd='', acct='', keyfile=None, certfile=None, context=None, timeout=None, source_address=None</em>)</a>:</p>
<blockquote>
<p><em>keyfile</em> and <em>certfile</em> are a legacy alternative to <em>context</em> â€“ they can point to PEM-formatted private key and certificate chain files (respectively) for the SSL connection.</p>
</blockquote>
<p>Looking at <a href="https://docs.python.org/3/library/ssl.html#ssl-contexts" rel="nofollow noreferrer">[Python]: SSL Contexts</a>, you should do the connection in 2 steps:</p>
<pre><code>import ssl
import ftplib
ctx = ssl.SSLContext()
ctx.load_cert_chain("my_cert.crt", keyfile="my_key.key", password="cert_password")
conn = ftplib.FTP_TLS(host="ftp.mysite.come", user="test_user", passwd="test_password", context=ctx)
</code></pre>
</div>
<span class="comment-copy">What? Manually enter it where?</span>
<span class="comment-copy">In my python shell, as soon as I enter "conn = ftplib.FTP_TLS...", I get a prompt for entering the passphrase. On entering "cert_password" and hitting enter the connection is established.</span>
<span class="comment-copy">Do you need it in the shell? Could you just write it in a script and run that as needed?</span>
<span class="comment-copy">I wrote a script too but either way, I've to enter the passphrase to continue further.</span>
<span class="comment-copy">Thanks. Turns out I have been checking an outdated documentation.</span>
