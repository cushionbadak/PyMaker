<div class="post-text" itemprop="text">
<p>Im programming a client-server in python, and them when working are sending keepalive packets every second.</p>
<p>I need the client to read from my keyboard an action to send a special packet to the server, but when reading I can't stop sending keepalive packets, so if I read by standard way, it blocks and stops the keepalive packet sending.</p>
<p>The perfect behaviour would be to write in console while keepaliving, and when pressing "enter" process that text.</p>
<p>Any ideas please?</p>
<p>Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>Found it, using select.select I could do that, like this:</p>
<pre><code>selectList = [sktTCP,sys.stdin]
(read, write, exc) =  select.select(selectList, [], [], 0 )
</code></pre>
<p>I hope it'll help someone!</p>
</div>
<div class="post-text" itemprop="text">
<p>This is a threading issue basically. I would suggest looking into managing your network connections using <a href="https://twistedmatrix.com/trac/" rel="nofollow">Twisted</a>. It can work asynchronously, leaving you able to pick up key presses. </p>
</div>
<div class="post-text" itemprop="text">
<p>Another way to read user input on Unix without blocking (for too long) is to use an alarm:</p>
<pre><code>from signal import SIGALRM, alarm, signal

class Alarm(Exception):
    pass

def alarm_handler(*args):
    raise Alarm

def raw_input_alarm(prompt='', timeout=None):
    if timeout is None: # no timeout
        return raw_input(prompt)

    # set signal handler
    signal(SIGALRM, alarm_handler)
    alarm(timeout) # produce SIGALRM in `timeout` seconds
    try:
        return raw_input(prompt)
    except Alarm:
        return '' # timeout happened
    finally:
        alarm(0) # cancel alarm
</code></pre>
<h3>Example</h3>
<pre><code>print(repr(raw_input_alarm(timeout=1)))
</code></pre>
<p><code>alarm</code> expects integer number of seconds. If you want smaller timeout; see <a href="https://docs.python.org/3/library/signal.html#signal.setitimer" rel="nofollow"><code>signal.setitimer()</code></a>.</p>
</div>
<span class="comment-copy">Can you please share your code. It is bit hard to understand your question.</span>
<span class="comment-copy">you can't use <code>select</code> with <code>sys.stdin</code> on Windows unless it is a socket.</span>
<span class="comment-copy">btw, select is not always reliable with pipes. See <a href="http://cr.yp.to/unix/nonblock.html" rel="nofollow noreferrer">Non-blocking I/O</a></span>
<span class="comment-copy">The problem is that I can't use Twisted and other stuff related because of the requeriments of the project!</span>
