<div class="post-text" itemprop="text">
<p>I am trying to bind python3 in C++.</p>
<p>When using this:</p>
<pre><code>Py_SetProgramName(argv[0]);
</code></pre>
<p>it gives this error:</p>
<pre><code>error C2664: 'Py_SetProgramName' : cannot convert parameter 1 from 'char *' to 'wchar_t *'
</code></pre>
<p>Even though that's how the <a href="http://docs.python.org/3/extending/extending.html#the-module-s-method-table-and-initialization-function" rel="nofollow noreferrer">documentation example</a> shows to do it.</p>
<p>I also tried this:</p>
<pre><code>Py_SetProgramName((wchar_t*)argv[0]);
</code></pre>
<p>But apparently that's the <a href="https://stackoverflow.com/a/18246869/230623">wrong way</a> to do it.</p>
<p><strong>So how do I fix this, and is there any other good resources on binding Python 3 in C++?</strong></p>
</div>
<div class="post-text" itemprop="text">
<p>Try following:</p>
<pre><code>wchar_t progname[FILENAME_MAX + 1];
mbstowcs(progname, argv[0], strlen(argv[0]) + 1);
Py_SetProgramName(progname);
</code></pre>
<p><a href="http://www.cplusplus.com/reference/cstdlib/mbstowcs/" rel="nofollow">http://www.cplusplus.com/reference/cstdlib/mbstowcs/</a></p>
</div>
<div class="post-text" itemprop="text">
<p>The official way of converting from char to wchar_t is now :</p>
<pre><code>wchar_t *program = Py_DecodeLocale(argv[0], NULL);
Py_SetProgramName(program);
</code></pre>
<p>on a side note mbstowcs is not reliable on some platforms.</p>
<p>A quite good example of using python2/3 with c++ would be Panda3D. a c++ game engine scripted with python, that also provides a c++ module builder.</p>
</div>
<div class="post-text" itemprop="text">
<p>I suggest you look <a href="https://stackoverflow.com/questions/3074776/how-to-convert-char-array-to-wchar-t-array">at this question</a></p>
<p>The example documentation for the Python 3 API appears to have not been upgraded from Python 2 - the example you show is one of them (I have reported some of the others).</p>
<p>I have found no good documentation in this area.  Even the new (Python 3) editions of well-known Python books either cover this subject sparsely or have code errors (usually because the code comes from Py2).</p>
</div>
<span class="comment-copy">MAXPATHLEN is undefined, I hard-coded it to 255 which allows me to compile. It appears to work though just like my 'wrong' solution I have no way to test it just yet. +1</span>
<span class="comment-copy">Insert <code>#include &lt;sys/param.h&gt;</code> if you are using Unix.</span>
<span class="comment-copy">What about Windows?</span>
<span class="comment-copy">@Brae, I replaced <code>MAXPATHLEN</code> with <code>FILENAME_MAX</code>. It does not require header. (not tested in Windows).</span>
<span class="comment-copy">be warned mbstowcs is a real source of trouble of some platforms. One random example would be android api 19. Python3.7+ has now integrated official workarounds and unicode coercion see PEP 538/540.</span>
<span class="comment-copy">lol this question is 5 years old, and already had an answer</span>
<span class="comment-copy">sorry but i don't see any answer for "is there any other good resources on binding Python 3 in C++",  correcting wrongs like mbstowcs use is 4 months old ( python3.7+ ) and imho important for newcomers. also embedding python in C++ is not very well supported so question has no age.</span>
<span class="comment-copy">not saying you cant add to it, its just funny to me that its so old</span>
<span class="comment-copy">That's a pain, thanks for the link, it looks very similar to falsetru's answer.</span>
