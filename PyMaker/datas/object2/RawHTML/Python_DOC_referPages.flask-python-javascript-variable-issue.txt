<div class="post-text" itemprop="text">
<p>my flask code section that have issue
<strong>main.py</strong> </p>
<pre><code>from flask import Flask, render_template, url_for
import pandas as pd 
import json

app = Flask(__name__)


@app.route('/')
def home():
    df = pd.read_csv('test.csv')
    df = df.groupby('name')['marks'].sum()
    j = df.to_json(orient='index')
    return render_template("work.html",s=j)

if __name__ == "__main__":
    app.run(debug=True)
</code></pre>
<p>and i want to pass j into my javascript file that is look like that
<strong>work.js</strong></p>
<pre><code>//pie chart
var s = {{ j|safe }};
var keys = [];
   for(var k in s) keys.push(k);
var value = [];
   for (var k in s) value.push(s[k]);

var data = [{
  values: value,
  labels: keys,
  type: 'pie'
}];

var layout = {
  height: 400,
  width: 500
};
Plotly.newPlot('myDiv1', data);
</code></pre>
<p><strong>work.html</strong></p>
<pre><code>&lt;html&gt;
        &lt;head&gt;
        &lt;meta http-equiv="content-type" content="text/html; charset=UTF-8" /&gt;
        &lt;script src="https://cdn.plot.ly/plotly-latest.min.js"&gt;&lt;/script&gt;
        &lt;link rel="stylesheet" type="text/css" href="styles.css"&gt;
        &lt;/head&gt;
        &lt;body&gt;
        &lt;div class="navbar"&gt;&lt;span&gt;data representation with Plotly.js&lt;/span&gt;&lt;/div&gt;

        &lt;div class="wrapper"&gt;
            &lt;div id="myDiv1"&gt;&lt;/div&gt;
            &lt;script type="text/javascript" src={{ url_for('static', filename='work.js')}}&gt; 
            &lt;/script&gt;
        &lt;/div&gt;
        &lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>how to pass j variable in flask to s variable in javascript file that render with html page and show right content or say that no graph shown
Thank you</p>
</div>
<div class="post-text" itemprop="text">
<p>You can't do that. You have to return that json in your flask method and make an <a href="http://api.jquery.com/jquery.ajax/" rel="nofollow noreferrer">ajax request</a> from javascript.</p>
<pre><code>from flask import jsonify

@app.route('/')
def home():
    j = df.to_json(orient='index')
    return jsonify(j)
</code></pre>
<p>I don't know if flask has something like <code>JsonResponse</code> as django has. If yes you should use that like: <code>return JsonResponse(j)</code></p>
<pre><code>$.ajax({url: "your_url", success: function(result){
    //result is what you returned from flask
}});
</code></pre>
</div>
<span class="comment-copy">Can you add stack trace of the error? Also, are you sure that you don't have any caching issue?</span>
<span class="comment-copy">there's not much to go on here, but it appears that your <code>s</code> in the JS script is in fact a (JSON) string. Try <code>s = JSON.parse(s)</code> before the loops.</span>
<span class="comment-copy">oh, and you refer to wanting to "pass j into my javascript file" - only the <code>work.html</code> template get the <code>{{s|tojson}}</code> converted to the actual value. This will work if this is in a script tag in the template though (which is what I assumed when I first read your post).</span>
