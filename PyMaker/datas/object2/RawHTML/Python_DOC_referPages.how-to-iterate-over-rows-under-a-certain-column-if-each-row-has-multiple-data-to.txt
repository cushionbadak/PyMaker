<div class="post-text" itemprop="text">
<p>I have data like this given to me in an excel file, and I imported it into my program using pandas: 
<a href="https://i.stack.imgur.com/jqr3x.png" rel="nofollow noreferrer"><img alt="enter image description here" src="https://i.stack.imgur.com/jqr3x.png"/></a>
I need to iterate over every single data of every row in the column 'IPC' and count them by their first 4 characters(Ex. A61K038/51 =&gt; A61K). But most rows contain more than a single data and they are separated by semicolon.</p>
<p>My thought is to first iterate on the rows, and then iterate again on the row's data. I know how to do these things in other data type, but I'm new to pandas and pandas dataframe make things so much more complicated! Please help! Any guidance on the best way to do this would be much appreciated.</p>
<p>Edit: The first 20 rows</p>
<pre><code>                  Company Name                        ...                                                                        IPC
0   Phoenix Pharmacologics Inc                        ...                          A61K038/51;A61K038/21;A61K031/7076;A61K031/707...
1   Phoenix Pharmacologics Inc                        ...                                                      A61K038/46;C12N009/80
2   Phoenix Pharmacologics Inc                        ...                                                                 A61K038/43
3   Phoenix Pharmacologics Inc                        ...                                           A61K038/50;A61K045/06;A61K047/48
4   Phoenix Pharmacologics Inc                        ...                                                      A61K038/44;C12N009/06
5   Phoenix Pharmacologics Inc                        ...                                          C07K014/525;C12N009/78;C12N015/81
6   Phoenix Pharmacologics Inc                        ...                                                      A61K038/00;C12N009/06
7   Phoenix Pharmacologics Inc                        ...                                                                 C12Q001/68
8   Phoenix Pharmacologics Inc                        ...                                                      A61K038/50;C12N009/78
9   Phoenix Pharmacologics Inc                        ...                                C12N011/06;C12N009/96;C12N009/06;A61K038/44
10  Phoenix Pharmacologics Inc                        ...                                                                 C12N009/14
11  Phoenix Pharmacologics Inc                        ...                                C12N011/06;C12N009/06;C12N009/96;C12N011/08
12  Phoenix Pharmacologics Inc                        ...                                A61K038/00;A61K047/48;C12N009/78;C12N009/96
13  Phoenix Pharmacologics Inc                        ...                                                     A61K038/00;C07K014/525
14           Phytoceutica, Inc                        ...                          A61K036/539;A61P035/00;A61K036/484;A61K036/725...
15           Phytoceutica, Inc                        ...                                                                 A01N065/00
16           Phytoceutica, Inc                        ...                                                                 A61K036/00
17           Phytoceutica, Inc                        ...                                                      G01N033/48;G06F017/00
18           Phytoceutica, Inc                        ...                                C12Q001/68;C12Q001/68;G06F019/00;G06F019/00
19           Phytoceutica, Inc                        ...                                                                 G06F019/00
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>If you would like to count elements based on the first 4 characters, you could define a function to do that and then apply it to the dataframe like this:</p>
<pre><code>import numpy as np

df = pd.DataFrame({'IPC': ['A61K038/52;A61K038/21', 'A61K038/46;C12N009/80']})

def count_ipc(ipc):
    items = ipc.split(';')
    items = [val[:4] for val in items]  # extract first 4 elements
    values = np.unique(items)  # count unique elements with numpy
    return len(items)

df['cnt'] = df.apply(lambda row: count_ipc(row['IPC']), axis=1)
</code></pre>
<p>The result is:</p>
<pre><code>                 IPC  cnt
0  A61K038/52;A61K038/21    1
1  A61K038/46;C12N009/80    2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use pandas <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html" rel="nofollow noreferrer"><code>pandas.Series.str.split</code></a> and chain <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.len.html" rel="nofollow noreferrer"><code>pandas.Series.str.len</code></a> to it to get your result:</p>
<p><strong>Example data</strong></p>
<pre><code># Example dataframe
df = pd.DataFrame({'IPC':['A61K038/51;A61K038/21;A61k031', 'A80934;A758392']})
print(df)
                             IPC
0  A61K038/51;A61K038/21;A61k031
1                 A80934;A758392
</code></pre>
<p><strong>Apply split and len</strong></p>
<pre><code>df['count'] = df.IPC.str.split(';').str.len()
print(df)
                             IPC  count
0  A61K038/51;A61K038/21;A61k031      3
1                 A80934;A758392      2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>One with lambda</p>
<pre><code>df = pd.DataFrame({'IPC': ['A61K038/52;A61K038/21;A61K038', 'A61K038/46;C12N009/80']})

def counter(ipc):
    temp = ipc.split(';')
    first_4 = temp[0][:4]
    return sum(1 for i in temp if i.startswith(first_4) )

df['cnt']= df['IPC'].apply(counter)
</code></pre>
<p>Output</p>
<pre><code>                             IPC  cnt
0  A61K038/52;A61K038/21;A61K038    3
1          A61K038/46;C12N009/80    1
</code></pre>
</div>
<span class="comment-copy">Hi, thanks for your imminent reply! I'm sorry, I forgot to state that I need to count them by their first 4 characters. For example, A61K038/51;A61K038/21;A61K031/7076; all become A61K and I have to count the number of A61K.</span>
<span class="comment-copy">It doesn't work for me :(</span>
<span class="comment-copy">The code can run in my program but it does not count the IPC correctly.</span>
<span class="comment-copy">Hi, thanks for your reply! I'm sorry, I forgot to state that I need to count them by their first 4 characters. For example, A61K038/51;A61K038/21;C01K031/7076; become A61K and C01K and I have to count the number of A61K and C01K respectively.</span>
<span class="comment-copy">Per row? Or through the whole column?</span>
<span class="comment-copy">I need to count how many type of IPC is in the whole column (Ex. type = A61K, C01K, etc...), and count how many IPC per type a company has (Ex. Company A has 4 A61K, 2C01K).</span>
<span class="comment-copy">Could you add the top 20 rows in your question? Use: <code>print(df.head(20))</code>. You can copy and paste the output into your question by editting it.</span>
<span class="comment-copy">I added the top 20 rows.</span>
<span class="comment-copy">Hi, thanks for your reply! From what I saw, your code only count the A61K?</span>
<span class="comment-copy">@Alex I have already edited</span>
