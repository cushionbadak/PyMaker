<div class="post-text" itemprop="text">
<p>I have a bunch of google queries for which I would like to get the url for the first hit. </p>
<p>A piece of my code: </p>
<pre><code>import requests

query = 'hello world'
url = 'http://google.com/search?q=' + query
page= requests.get(url)
print(url)
</code></pre>
<p>Then what I would like to retrieve is the first google hit website, in this case, the Wikipedia page: <a href="https://en.wikipedia.org/wiki/%22Hello,_World!%22_program" rel="nofollow noreferrer">https://en.wikipedia.org/wiki/%22Hello,_World!%22_program</a></p>
<p>I have the rest of the code but I don't know how to retrieve the url.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use select_one to limit to first match. Use the class r to limit to results. It is faster to use class and type selectors than attribute which is why I use <code>r</code> and <code>a</code>.</p>
<pre><code>import requests
from bs4 import BeautifulSoup as bs
query = 'hello world'
url = 'http://google.com/search?q=' + query
page= requests.get(url)
soup = bs(page.content, 'lxml')
print(soup.select_one('.r a')['href'])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I would suggest using something like Beautiful Soup to target the HTML elements which contain the URL's of the results. Then, you can store the URL and do with it as you please.</p>
<pre><code>import requests
from bs4 import BeautifulSoup

query = 'hello world'
url = 'http://google.com/search?q=' + query
page = requests.get(url)
soup = BeautifulSoup(page.text, 'html.parser')

for link in soup.find_all('a'):
    print(link.get('href'))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use BeautifulSoup to find the web results, then find the first element that returns a href:</p>
<pre><code>import requests
import bs4

query = 'hello world'
url = 'http://google.com/search?q=' + query

headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.121 Safari/537.36'}
page= requests.get(url, headers=headers)

soup = bs4.BeautifulSoup(page.text, 'html.parser')

for elem in soup(text='Web results'):
    print (elem.find_next('a')['href'])
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>print (elem.find_next('a')['href'])


https://en.wikipedia.org/wiki/%22Hello,_World!%22_program
</code></pre>
</div>
<span class="comment-copy">What happens when you do what you're doing?</span>
<span class="comment-copy">Are you trying to get the link to the site or actual page content</span>
<span class="comment-copy">Hi, its quite close to what I would like to have. the output is now: &lt;a href="/url?q=<a href='https://nl.wikipedia.org/wiki/Hello_world_(programma)&amp;amp;sa=U&amp;amp;ved=0ahUKEwjXwK-OsovhAhULmhQKHd4jDM4QFggcMAI&amp;amp;usg=AOvVaw195CmdsPkdGUcxEI5Y6RiT"&gt;&lt;b&gt;Hello' rel="nofollow noreferrer">nl.wikipedia.org/wiki/…</a> world&lt;/b&gt; (programma) - Wikipedia&lt;/a&gt;. But I would like to have only the url: <a href="https://nl.wikipedia.org/wiki/Hello_world_(programma)" rel="nofollow noreferrer">nl.wikipedia.org/wiki/Hello_world_(programma)</a> (english one is also fine ofcourse). I tried find_all('a')['href'] but this didnt work</span>
<span class="comment-copy">oops. See edit.</span>
<span class="comment-copy">Thanks, this works! except for one example, where I am getting the second hit in google. very strange..</span>
<span class="comment-copy">Can you provide me the failing example please?</span>
<span class="comment-copy">It is for when I search for 'DE BRASSERIE MIRELL 2671GS WILHELMINAPLN 32 NAALDWYK tripadvisor', the result should be: <a href="https://www.tripadvisor.nl/Restaurant_Review-g227909-d749227-Reviews-Brasserie_Mirell-Naaldwijk_South_Holland_Province.html" rel="nofollow noreferrer">tripadvisor.nl/…</a> but I am getting a review about the breakfast: <a href="https://www.tripadvisor.nl/ShowUserReviews-g227909-d749227-r378667239-Brasserie_Mirell-Naaldwijk_South_Holland_Province.html" rel="nofollow noreferrer">tripadvisor.nl/…</a></span>
<span class="comment-copy">Hi, this code gives me a very long list of all the urls. I see which url I need, but how do I select this?</span>
<span class="comment-copy">Hi, When I use this print(soup(text='Web results')) is empty, so in the for loop nothing is printed. Do you know why?</span>
