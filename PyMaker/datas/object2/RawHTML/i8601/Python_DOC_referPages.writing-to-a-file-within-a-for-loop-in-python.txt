<div class="post-text" itemprop="text">
<p>Below is part of a script that I wrote which takes each item in a list, passes it to a function, stores the output of the function as a variable with a line break at the end and then writes the variable to a new line in a file. It also prints the variable to the console.</p>
<pre><code>for i in lane_list:
        out = count_genes(count, i, reader, total_genes) + '\n'
        count += 1
        outfile.write(out)
        print out
</code></pre>
<p>The script works but not in the way that I would expect. I can see the output being printed to the console as the script runs so I know the rate at which the script is running through the for loop and I assumed that python would write to the file at the same rate as it prints output to the console. What's odd is that for long periods of time nothing will be written to the file (I can see this by 'cating' the file in the console as the script's running) and then several hundred more lines will appear in the file at once. It's as if python is storing what it has to write to the file for a period of time and then writing all of it in one go. What was even more surprising is sometimes when I cat the file as the scripts running it will have written half of the last line but not all of it. </p>
<p>Can anyone explain to me why this is?</p>
</div>
<div class="post-text" itemprop="text">
<p>As @szymon mentioned, the file is buffered as it is written. If you want to see it being written 'live', use <code>open('/path/to/file'', 'w', 0)</code> where the <a href="https://docs.python.org/2/library/functions.html#open" rel="nofollow noreferrer">0 means unbuffered</a>. </p>
<p>For <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer">python3</a> use 1 for line buffered as unbuffered is only allowed for binary data.</p>
</div>
<span class="comment-copy">Read about flushing: <a href="http://stackoverflow.com/questions/3167494/how-often-does-python-flush-to-a-file" title="how often does python flush to a file">stackoverflow.com/questions/3167494/â€¦</a>. Also it maybe helpful to use <code>tail -f filename</code> to get live preview of file (if you are working on linux).</span>
<span class="comment-copy">Thanks all, is there any reason not to use this? Will it slow down for example?</span>
<span class="comment-copy">It can slow down - every time you save to the file it hits the disk (I/O operations). When buffer size is set, script hits the disk only when buffer is full (and flushes it).</span>
