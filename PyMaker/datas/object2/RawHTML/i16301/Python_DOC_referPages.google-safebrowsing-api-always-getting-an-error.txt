<div class="post-text" itemprop="text">
<p>I use google safe browsing API. So I tested this simple code:</p>
<pre><code>from safebrowsinglookup import SafebrowsinglookupClient

class TestMe:
    def testMe(self):
        self.key='my_Valid_Key_Here'        
        self.client=SafebrowsinglookupClient(self.key)
        self.response=self.client.lookup('http://www.google.com')
        print(self.response)

if __name__=="__main__":
    TM=TestMe()
    TM.testMe()
</code></pre>
<p>I always get this whatever the website I test: </p>
<blockquote>
<p>{'website_I_tried','error'}</p>
</blockquote>
<p>Note that I had to change some lines in the source code after I installed this API because it was written in Python 2 and I am using Python 3.4.1. How can I resolve this problem?</p>
<hr/>
<p>Update:</p>
<p>To understand why the above problem occured to me, I run this code:</p>
<pre><code>from safebrowsinglookup import SafebrowsinglookupClient  

class TestMe:
    def testMe(self):
        self.key = 'my_key_here'        
        self.client=SafebrowsinglookupClient(self.key,debug=1)
        urls = ['http://www.google.com/','http://addonrock.ru/Debugger.js/']        
        self.results = self.client.lookup(*urls)
        print(self.results['http://www.google.com/'])

if __name__ == "__main__":
    TM=TestMe()
    TM.testMe()
</code></pre>
<p>Now, I got this message:</p>
<pre><code>BODY:
2
http://www.google.com/
http://addonrock.ru/Debugger.js/


URL: https://sb-ssl.google.com/safebrowsing/api/lookup?client=python&amp;apikey=ABQIAAAAAU6Oj8JFgQpt0AXtnVwBYxQYl9AeQCxMD6irIIDtWpux_GHGQQ&amp;appver=0.1&amp;pver=3.0
Unexpected server response

name 'urllib2' is not defined
error
error
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://github.com/juliensobrier/google-safe-browsing-lookup-python" rel="nofollow">The library</a> doesn't support Python3.x. </p>
<p>In this case, you can either <a href="https://docs.python.org/3/howto/pyporting.html" rel="nofollow">make it support Python3</a> (there is also an <a href="https://github.com/juliensobrier/google-safe-browsing-lookup-python/pull/4" rel="nofollow">opened pull request</a> for Python3 Compatibility), or make the request to "Google Safebrowsing API" manually. </p>
<p>Here's an example using <a href="http://docs.python-requests.org/en/latest/" rel="nofollow"><code>requests</code></a>:</p>
<pre><code>import requests

key = 'your key here'
URL = "https://sb-ssl.google.com/safebrowsing/api/lookup?client=api&amp;apikey={key}&amp;appver=1.0&amp;pver=3.0&amp;url={url}"


def is_safe(key, url):
    response = requests.get(URL.format(key=key, url=url))
    return response.text != 'malware'


print(is_safe(key, 'http://addonrock.ru/Debugger.js/'))  # prints False
print(is_safe(key, 'http://google.com'))  # prints True
</code></pre>
<hr/>
<p>Just the same, but without third-party packages (using <a href="https://docs.python.org/3.0/library/urllib.request.html" rel="nofollow"><code>urllib.request</code></a>):</p>
<pre><code>from urllib.request import urlopen


key = 'your key here'
URL = "https://sb-ssl.google.com/safebrowsing/api/lookup?client=python&amp;apikey={key}&amp;appver=1.0&amp;pver=3.0&amp;url={url}"


def is_safe(key, url):
    response = urlopen(URL.format(key=key, url=url)).read().decode("utf8")
    return response != 'malware'


print(is_safe(key, 'http://addonrock.ru/Debugger.js/'))  # prints False
print(is_safe(key, 'http://google.com'))  # prints True
</code></pre>
</div>
<span class="comment-copy">The <code>KeyError</code> in the second case is occurring because <code>results</code> is a dict, not a list. Its keys are the websites you looked up, and you didn't look up any websites called 0 or 1.  In the first case, there's absolutely no way for us to tell what error occurred based on the info you've given us. Add <code>debug=1</code> to the SafebrosinglookupClient, and that should print out the actual errors encountered. Please post <b>complete</b> error messages, including tracebacks when possible, for all problems on SO. Otherwise there's no way for us to help you.</span>
<span class="comment-copy">@user3479224 Yes, thank you, that is one first error, i will try to fix it now, but I think i will still have the problem in an other way</span>
<span class="comment-copy">@user3479224 I update my second short code: I only get <code>error</code> as an output</span>
<span class="comment-copy">That's because you didn't add <code>debug=1</code> to the SafebrosinglookupClient contructor like I said.</span>
<span class="comment-copy">@user3479224 Sorry, I did what you said, you can see the full error on my question now. Thank you</span>
<span class="comment-copy">Thank you. I get a strange error however: ImportError: no module named requests`` even if i am using Python-3.4.1 (!)</span>
<span class="comment-copy">@Begueradj <code>requests</code> is a third-party, you need to install it first. Ok, let me rewrite it using only stdlib packages.</span>
<span class="comment-copy">Yes, Alexander, I bothered you with my comment while on the link of your answser it says I must install it. So i am installing it now and I will test again. Regards</span>
<span class="comment-copy">It is marverlous Alexandre ! ooof !!!!!!!!!! I am so happy. Thank you very much</span>
<span class="comment-copy">@Begueradj glad to help, I've added only-standard library version.</span>
