<div class="post-text" itemprop="text">
<p>I am working with Mask R CNN model using Tensorflow Object Detection API project (<a href="https://github.com/tensorflow/models/tree/r1.12.0/research/object_detection" rel="nofollow noreferrer">https://github.com/tensorflow/models/tree/r1.12.0/research/object_detection</a>). I stick to r1.12.0 release (but this is not a must but I do not think it influences my problem.) My plan is to modify some "static" parts of the model and export it again into the frozen graph format.</p>
<p>As a first step, I meant to regenerate the frozen graph from the checkpoints file and the <code>pipeline.config</code> using <code>export_inference_graph.py</code> script (<a href="https://github.com/tensorflow/models/blob/r1.12.0/research/object_detection/export_inference_graph.py" rel="nofollow noreferrer">https://github.com/tensorflow/models/blob/r1.12.0/research/object_detection/export_inference_graph.py</a>). I downloaded the inception V2 model (<a href="http://download.tensorflow.org/models/object_detection/mask_rcnn_inception_v2_coco_2018_01_28.tar.gz" rel="nofollow noreferrer">http://download.tensorflow.org/models/object_detection/mask_rcnn_inception_v2_coco_2018_01_28.tar.gz</a>) and executed the script using Tensorflow 1.12.0. It does the job and creates a frozen graph.</p>
<p>The issue is that if I compare the original frozen graph with the generated one, they are different. If I visualize them using Tensorboard there are obvious differences between them. Some nodes are missing, some nodes are different etc.</p>
<p>I have tried other models as well (normal Fast R CNN), I had the same issue always.</p>
<p>How can this be? How should I use the checkpoint files and the <code>pipeline.config</code> file to regenerate exactly the same frozen graph which is originally attached?</p>
</div>
<div class="post-text" itemprop="text">
<p>As far as I understood it, your steps of generating frozen graph is fine.</p>
<p>One thing about frozen graph is that optimizations can be performed on it, for example fuse some layers together. Optimization may cause your frozen graph to look different as different optimizations could be performed or non at all. But different frozen graph does not necessarily mean the graph is wrongly generated. </p>
<p><a href="https://medium.com/google-cloud/optimizing-tensorflow-models-for-serving-959080e9ddbf" rel="nofollow noreferrer">Here</a> is a tutorial on optimizations on frozen graph to make a faster serving model. Just listed here to show that there are several optimization options. </p>
<p>Here <a href="https://stackoverflow.com/questions/48441803/what-does-freezing-a-graph-in-tensorflow-mean">What does freezing a graph in TensorFlow mean?</a>  is another problem that is also kind of related to this problem. </p>
</div>
