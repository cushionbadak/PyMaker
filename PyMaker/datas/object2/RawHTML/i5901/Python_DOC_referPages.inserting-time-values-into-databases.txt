<div class="post-text" itemprop="text">
<p>I'm not sure why I get this error when I test this function. Can anyone please help me fix this?</p>
<p>time_file.readlines()
builtins.ValueError: I/O operation on closed file.</p>
<p>I want to create a table for the time and insert all the values listed below, like idx, date, start, end, duration into the table.</p>
<pre><code>def create_time_table(db, time_file):
    '''Time Table should be ID,Date,Start,End,Duration
    '''

    con = sqlite3.connect(db)
    cur = con. cursor()

    cur.execute('''DROP TABLE IF EXISTS Time''')

    # create the table
    cur.execute('''CREATE TABLE TIME(idTEXT, DateTEXT, StartTEXT, EndTEXT,
    DurationTEXT)''')


    # insert the rows
    time_file.readlines()
    for line in time_file:
        data = line.split(',')
        idx = data[0]
        date = data[1]
        start = data[2]
        end = data[3]
        duration = data[4]
        cur.execute('''INSERT INTO TIME VALUES(?, ?, ?, ?, ?)''',(idx, date, start, end, duration))
  if __name__ == '__main__':
 file2 = open('time.csv', 'r')
create_time_table("exams.db", file2)
file2.close()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>@bigd since we are in the same class lol... here is the solution.. Your mistake is how you are reading the file, it should be time_file.readline(), if you do time_file.readlines(), using sqliteonline, the table would not appear.</p>
<pre><code>def create_time_table(db, time_file):
'''Time Table should be ID,Date,Start,End,Duration
'''

con = sqlite3.connect(db)
cur = con. cursor()

cur.execute('''DROP TABLE IF EXISTS Time''')

# create the table
cur.execute('''CREATE TABLE Time(ID TEXT, Date TEXT, Start TEXT, End TEXT,
DurationTEXT)''')


# insert the rows
clock_file = open(time_file, 'r')
clock_file.readline()
for line in clock_file:
    data = line.strip().split(',')
    idx = data[0]
    date = data[1]
    start = data[2]
    end = data[3]
    duration = data[4]
    cur.execute('''INSERT INTO TIME VALUES(?, ?, ?, ?, ?)''',(idx, date, start, end, duration))

 # commit and close the cursor and connection
con.commit()
cur.close()
con.close()    


## Under if __name__ == '__main__': ##
create_time_table('exams.db', 'time.csv')
</code></pre>
</div>
<span class="comment-copy">That means the file was closed before you passed it into <code>create_time_table()</code>.</span>
<span class="comment-copy">So do I need to open it right before reading it?</span>
<span class="comment-copy">Not necessarily. You just need to make sure it's not closed when you try to read it. Can you add the code that calls <code>create_time_table()</code>...</span>
<span class="comment-copy">Check my edit. I have to close the file though afterwards.</span>
<span class="comment-copy">You should use <code>with open('time.csv') as f: create_time_table('exams.db', f)</code> <a href="https://docs.python.org/3/tutorial/inputoutput.html#reading-and-writing-files" rel="nofollow noreferrer">[docs</a>]. And you don't want to call <code>time_file.readlines()</code> because that will consume all the lines in the file without doing anything with them.</span>
<span class="comment-copy">DOn't we have to open the file as well in if main?</span>
<span class="comment-copy">time_file2 = open(time_file, 'r') builtins.TypeError: expected str, bytes or os.PathLike object, not _io.TextIOWrapper I get this error now.</span>
<span class="comment-copy">No, we do not have to open it in the main. Only thing the main should have is  db = 'exams.db' and functions names like create_location_table(). Copy and paste the code, it should work</span>
<span class="comment-copy">BUt it says open and close the file in the comments</span>
<span class="comment-copy">The file is already closed from this con.commit() cur.close() con.close()</span>
