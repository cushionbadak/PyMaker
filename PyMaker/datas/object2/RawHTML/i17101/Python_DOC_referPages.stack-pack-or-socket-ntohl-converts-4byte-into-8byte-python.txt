<div class="post-text" itemprop="text">
<p>I want to send requests to a Server, but somehow Python converts 4Byte values to 8 byte Values:</p>
<pre><code>struct.pack("H",  socket.ntohs(v1)) + struct.pack("?",  v2) +               struct.pack("?",  v3) + struct.pack("L", socket.ntohl(v5)) +   struct.pack("L", socket.ntohl(v6)) +  struct.pack("L", socket.ntohl(v7)) + struct.pack("L", socket.ntohl(v8)) + struct.pack("H", socket.ntohs(v9))
</code></pre>
<p>up to v5 everything works fine but after v5 i always get 8Byte values instead of 4Bytes.
Wireshark Capturing:
up 00 00 03 e8 everything works fine:</p>
<pre><code>0040  4d 65 01 00 00 00 01 00  00 01 01 00 00 03 e8 00   Me...... ........
0050  00 00 00 00 00 07 d0 00  00 00 00 00 00 0b b8 00   ........ ........
0060  00 00 00 00 00 0f a0 00  00 00 00 13 88 00 00 00   ........ ........
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Since you don't specify otherwise, you are using the native representation for your <code>long</code>s. Try adding the <code>=</code> specifier (native byte order, standard size):</p>
<pre><code>struct.pack("=H??LLLLH",  
            socket.ntohs(v1),
            v2,
            v3,
            socket.ntohl(v5),
            socket.ntohl(v6),
            socket.ntohl(v7),
            socket.ntohl(v8),
            socket.ntohs(v9))
</code></pre>
<p>References:</p>
<ul>
<li><a href="http://docs.python.org/3/library/struct.html#byte-order-size-and-alignment" rel="nofollow">http://docs.python.org/3/library/struct.html#byte-order-size-and-alignment</a></li>
<li><a href="http://docs.python.org/3/library/struct.html#format-characters" rel="nofollow">http://docs.python.org/3/library/struct.html#format-characters</a></li>
</ul>
</div>
<span class="comment-copy">What is <code>sizeof(unsigned long)</code> in a C program in your environment? Since you are using native sizes, that's what you're getting.</span>
<span class="comment-copy">wow works nice :) could you tell me what exactly the mistake was?</span>
<span class="comment-copy">@user3455512 You forgot the <code>=</code>.</span>
