<div class="post-text" itemprop="text">
<p>I am stack in something really simple, but I cannot find the right way. I have a dictionary like this one:</p>
<pre><code>mydic= {'a': {'mylist':[..,..,..]}, 'b': {'mylist':[..,..,..]}}
</code></pre>
<p>I am trying to iterate through <code>mylist</code> and create a new subdictionary with the results of a function.</p>
<pre><code>for i in mydic:
    for j in mydic[i]['mylist']:
         mydic[i]['thenewkey'][j] = myfunction(j)
</code></pre>
<p>The find dictionary would be like this:</p>
<pre><code>mydic= {'a': {'mylist':[..,..,..], 'thenewkey':{'..':'..', '..':'..'}}, 'b': {'mylist':[..,..,..],'thenewkey':{'..':'..', '..':'..'}}}
</code></pre>
<p>But when I run the code, I have a key error on <code>thenewkey</code>. Any idea?</p>
</div>
<div class="post-text" itemprop="text">
<p>You have to create first <code>mydic[i]['thenewkey']</code> before assigning to <code>mydic[i]['thenewkey'][j]</code>.</p>
</div>
<div class="post-text" itemprop="text">
<p>As already said, you have to create the <code>thenewkey</code> entry before you can add items to it, i.e. you'd have to add <code>mydic[i]['thenewkey'] = {}</code> to your outer loop. You <em>could</em> use a <a href="https://docs.python.org/3/library/collections.html#collections.defaultdict" rel="nofollow"><code>defaultdict(dict)</code></a> to make Python automatically insert missing entries, but since you have both <code>list</code> and <code>dict</code> entries, this does not seem like a good idea.</p>
<p>That said, using a <a href="https://docs.python.org/3/tutorial/datastructures.html#dictionaries" rel="nofollow">dictionary comprehension</a> makes it a bit shorter and IMHO much more readable:</p>
<pre><code>for i in mydic:
    mydic[i]['thenewkey'] = {j: myfunction(j) for j in mydic[i]['mylist']}
</code></pre>
</div>
<span class="comment-copy">Are you certain that the keys in <code>mylist</code> are appearing in <code>thenewkey</code>?</span>
<span class="comment-copy">Damn. I thought it happens automatically in the iteration. That's was the problem.</span>
<span class="comment-copy">Glad to help...</span>
