<div class="post-text" itemprop="text">
<p>I need to have my Python program access my C functions. So I used the <a href="https://docs.python.org/3/extending/embedding.html#extending-embedded-python" rel="nofollow">example from the documentation</a> to get started.</p>
<p>Unfortunately, its very slow and it takes up all of my memory.</p>
<p>I am using Windows 7 64bit, Python 3.4 and gcc (rubenvb-4.8.0) 4.8.0.</p>
<p>For completeness sake, here's the code from the documentation:</p>
<pre><code>#include &lt;Python.h&gt;

static int numargs=0;

static PyObject*
emb_numargs(PyObject *self, PyObject *args)
{
    if(!PyArg_ParseTuple(args, ":numargs"))
        return NULL;
    return PyLong_FromLong(numargs);
}

static PyMethodDef EmbMethods[] = {
    {"numargs", emb_numargs, METH_VARARGS,
     "Return the number of arguments received by the process."},
    {NULL, NULL, 0, NULL}
};

static PyModuleDef EmbModule = {
    PyModuleDef_HEAD_INIT, "emb", NULL, -1, EmbMethods,
    NULL, NULL, NULL, NULL
};

static PyObject*
PyInit_emb(void)
{
    return PyModule_Create(&amp;EmbModule);
}

int main()
{
    [...]
    numargs = argc;
    PyImport_AppendInittab("emb", &amp;PyInit_emb);

    Py_Initialize();
    pModule = PyImport_Import(pName);
    [...]
}
</code></pre>
<p>The python program has the following code:</p>
<pre><code>import emb
print("Number of arguments", emb.numargs())
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I spent 3 hours on this problem. I found the solution at <a href="https://forums.embarcadero.com/message.jspa?messageID=581594" rel="nofollow">this page</a>.</p>
<p>Apparently, you need to have the following defined:</p>
<pre><code>#define HAVE_SSIZE_T
</code></pre>
<p><a href="https://forums.embarcadero.com/message.jspa?messageID=581594" rel="nofollow">The page</a> said that "This ensures that the type Py_ssize_t becomes __int64 instead of int."</p>
</div>
