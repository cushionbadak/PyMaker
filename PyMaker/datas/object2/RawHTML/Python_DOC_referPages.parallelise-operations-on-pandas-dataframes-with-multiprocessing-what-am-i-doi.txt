<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/20360686/compulsory-usage-of-if-name-main-in-windows-while-using-multiprocessi">Compulsory usage of if __name__==“__main__” in windows while using multiprocessing [duplicate]</a>
<span class="question-originals-answer-count">
                    2 answers
                </span>
</li>
</ul>
</div>
<p>I am trying to find a way to parallelise certain operations on dataframes, especially those that cannot be vectorised.
I have tested the code below, taken from <a href="http://www.racketracer.com/2016/07/06/pandas-in-parallel/" rel="nofollow noreferrer">http://www.racketracer.com/2016/07/06/pandas-in-parallel/</a> , but it doesn't work. No error message - quite simply, nothing happens. Debugging it, it seems the code gets stuck at <code>df = pd.concat(pool.map(func, df_split))</code> , but without any error messages.</p>
<p>What am I doing wrong? </p>
<pre><code>import timeit
import pandas as pd
import numpy as np
import seaborn as sns
import multiprocessing
from multiprocessing import Pool

def parallelize_dataframe(df, func):
    df_split = np.array_split(df, num_partitions)
    pool = Pool(num_cores)
    df = pd.concat(pool.map(func, df_split))
    pool.close()
    pool.join()
    return df

def multiply_columns(data):
    data['length_of_word'] = data['species'].apply(lambda x: len(x))
    return data

num_partitions = 2 #number of partitions to split dataframe
num_cores = 2# multiprocessing.cpu_count() #number of cores on your machine

iris = pd.DataFrame(sns.load_dataset('iris'))
iris = parallelize_dataframe(iris, multiply_columns)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I needed to add</p>
<pre><code>if __name__ == "__main__":
</code></pre>
</div>
<span class="comment-copy">Is there a reason why you are not using e.g. <code>dask</code>?</span>
<span class="comment-copy">Please use the edit link on your question to add additional information. The Post Answer button should be used only for complete answers to the question. - <a href="/review/low-quality-posts/22519096">From Review</a></span>
<span class="comment-copy">I am not following. The complete answer to the question is that parallelize(dataframe) must be run only if <b>name=="__main</b>" , which is what I have written. I could have made it more explicit, but it seemed pretty obvious to me</span>
<span class="comment-copy">Please include the lines before and after this <code>if</code>-statement you want to include. <i>(Always think of your posts here as entries in a knowledge base, not just a chat)</i></span>
<span class="comment-copy">This looked more like a comment saying that you forgot to add something to your question. Anyways cheers!</span>
