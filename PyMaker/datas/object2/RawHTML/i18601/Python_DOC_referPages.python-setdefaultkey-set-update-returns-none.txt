<div class="post-text" itemprop="text">
<p>I'm having a problem with setdefault and unions not working like I expect them to.  My code looks like:</p>
<pre><code>

    #!/usr/bin/python3.3
    kanjidic = {
        '恕': {'radical':{'multi_radical': {'口心女'}}},
        '靛': {'radical':{'multi_radical': {'亠宀月疋二青土'}}},
    }
    k_rad = {}
    for k,v in kanjidic.items():
        if 'radical' in v and 'multi_radical' in v['radical']:
            print (k, set(v['radical']['multi_radical']))
            k_rad[k] = k_rad.setdefault(k, set()).update(
                set(v['radical']['multi_radical']))
        print('&gt;&gt;', k_rad[k])

</code></pre>
<p>The print output looks like:</p>
<pre>

    恕 {'口心女'}
    &gt;&gt; None
    靛 {'亠宀月疋二青土'}
    &gt;&gt; None

</pre>
<p>If I substitute the two lines below for setting k_rad:</p>
<pre><code>

    k_rad[k] = k_rad.setdefault(k, set())
    k_rad[k].update(set(v['radical']['multi_radical']))

</code></pre>
<p>My output looks like this:</p>
<pre>

    靛 {'亠宀月疋二青土'}
    &gt;&gt; {'亠宀月疋二青土'}
    恕 {'口心女'}
    &gt;&gt; {'口心女'}

</pre>
<p>If I understand setdefault, (which obviously I don't) the output should be the same,right?
What am I missing?  Why am is <code>dict.setupdate(key,set()).update(set(...))</code> returning None?</p>
<p><br/>
As pointed out below, the problem is that update returns None.  I really didn't understand 
how update and setdefault work together.  Since setdefault sets the dict to the default if
we're creating a new dict element and returning the the hash and update updates the element
I didn't need the assignment.  All I really needed was:</p>
<pre><code>

    for k,v in kanjidic.items():
        if 'radical' in v and 'multi_radical' in v['radical']:
            k_rad.setdefault(k, set()).update(v['radical']['multi_radical'])

</code></pre>
<p>Thanks for the assistance!</p>
</div>
<div class="post-text" itemprop="text">
<p><a href="http://docs.python.org/3/library/stdtypes.html#dict.setdefault" rel="nofollow"><code>dict.setdefault</code></a> returns a set in your case. And <a href="http://docs.python.org/3/library/stdtypes.html#dict.update" rel="nofollow"><code>set.update</code></a> is an in-place operation, which means it changes the original set and returns <strong>None</strong>. So if you assign the result to a variable you just assign it a <strong>None</strong>.</p>
</div>
<span class="comment-copy">It's not <code>setdefault</code>, <code>update</code> updates the set (returned by <code>setdefault</code>) in-place and returns None.</span>
<span class="comment-copy">Thank you.  And it is indeed an update.</span>
<span class="comment-copy">Is there a cleaner way to do this than setdefault/update?</span>
<span class="comment-copy">You may have a look at <a href="http://docs.python.org/3/library/collections.html#collections.defaultdict" rel="nofollow noreferrer">defaultdict</a>.</span>
<span class="comment-copy">I don't think this would work.  I don't know what I'm going to hit beforehand and I want to update a set so append won't work.</span>
