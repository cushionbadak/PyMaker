<div class="post-text" itemprop="text">
<p>I have a pandas df in the following format:</p>
<pre><code>Index | Article | Reference | Text

1 --------- 1 ------3, 4, 5 ------| xyz1

2 --------- 2 ------5, 9, 10 ----  | xyz2

3 ....
</code></pre>
<p>The references are to the other articles, and I would like to create a new df which displays each article and text next to the article and text it refers to. So for the example above:</p>
<pre><code>Index | Article1 | Text1 | Article2 | Text2 | 

1 --------- 1 ------ xyz1 -------3 ------- xyz3

2 --------- 1 ------ xyz1 -------4 ------- xyz4

3 --------- 1 ------ xyz1 -------5 ------- xyz5

4 --------- 2 ------ xyz2 -------5 ------- xyz5

5 --------- 2 ------ xyz2 -------9 ------- xyz9

6 --------- 2 ------ xyz2 -------10 ------ xyz10
</code></pre>
<p>The code below gives me an empty frame and I can't seem to find the issues.</p>
<pre><code>frame = pd.DataFrame(columns = ['Article1', 'Text1', 'Article2', 'Text2'])
frame.index = frame.index + 1

for x in range (1, len(df)):
    numbers = df['References'][x]
    numbers = list(map(int, numbers))
    for y in range (1, len(df)):
        if y in numbers:
            frame['Article1']= df['Article'][x]
            frame['Text1'] = df['Text'][x]
            frame['Article2'] = df['Article'][y]
            frame['Text2'] = df['Text'][y]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I believe need create new <code>DataFrame</code> by flattenting by <a href="https://docs.python.org/3/library/itertools.html#itertools.chain.from_iterable" rel="nofollow noreferrer"><code>chain.from_iterable</code></a> with splited values with repeating rows by <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.repeat.html" rel="nofollow noreferrer"><code>numpy.repeat</code></a> and for column <code>Text2</code> use <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.map.html" rel="nofollow noreferrer"><code>map</code></a> by <code>Series</code> created from original <code>DataFrame</code> with casting to <code>integer</code> for same <code>types</code>:</p>
<pre><code>print (df)
   Article Reference  Text
1        1   3, 4, 5  xyz1
2        2  5, 9, 10  xyz2
3        3   1, 2, 3  xyz3

from itertools import chain

s = df['Reference'].str.split(',\s+')
lens = s.str.len()
df1 = pd.DataFrame({
    'Article2' : list(chain.from_iterable(s)), 
    'Article1' : df['Article'].values.repeat(lens),
    'Text1' : df['Text'].values.repeat(lens),
}, columns=['Article1','Text1','Article2'])

df1['Text2'] = df1['Article2'].astype(int).map(df.set_index('Article')['Text'])
print (df1)
   Article1 Text1 Article2 Text2
0         1  xyz1        3  xyz3
1         1  xyz1        4   NaN
2         1  xyz1        5   NaN
3         2  xyz2        5   NaN
4         2  xyz2        9   NaN
5         2  xyz2       10   NaN
6         3  xyz3        1  xyz1
7         3  xyz3        2  xyz2
8         3  xyz3        3  xyz3
</code></pre>
</div>
