<div class="post-text" itemprop="text">
<p>I want to append the lines after the 3rd match of "config vdom" string. Unfortunately the script only consider the 1st match.</p>
<p>Original code:</p>
<pre><code>x = list()

def z():
with open('test.conf', 'r') as rf:
    for line in rf:
        if 'config vdom\n' in line:
            while True:
                line = (rf.__next__())
                if 'end\n' in line:
                    break
                x.append(line)
            with open('test.txt', 'w') as wf:
                wf.writelines(x)
            return
</code></pre>
<p>I'm planning to used the enumerate but doesn't sure how to apply it in adding the next line.</p>
<p>Enumerate line:</p>
<pre><code>z = [i for i, n in enumerate(y) if n == 'config vdom\n'][2]
print('Line', z, ':', y[z])
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>Line 10310 : config vdom
</code></pre>
<p>Sample Data:</p>
<pre><code>config vdom
config system global
    set admin-maintainer disable
    set admin-scp enable
 end
config vdom*
config system accprofile
    edit "prof_admin"
        set admingrp read-write
        set utmgrp read-write
        set vpngrp read-write
        set wanoptgrp read-write
        set wifi read-write
config vdom*
test sample data
end
</code></pre>
<p>expected Output: It should be the three line below will be added in the x list.</p>
<pre><code>config vdom*
test sample data
end
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>This should help. </p>
<pre><code>with open('test.txt', 'a') as wf:
    with open('test.conf', 'r') as rf:
        c = 0                 #Checkvalue
        for line in rf:
            if 'config vdom\n' in line:
                c += 1
                if c == 3:      #Check if 3rd "config vdom"
                    while True:
                        line = next(rf)
                        if 'end\n' in line:
                            break
                        wf.writelines(line)      #Write required content. 
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/itertools.html?highlight=itertools%20groupby#itertools.groupby" rel="nofollow noreferrer"><code>itertools.groupby</code></a> could help:</p>
<pre><code>from itertools import groupby
from io import StringIO

text = '''config vdom
config system global
    set admin-maintainer disable
    set admin-scp enable
 end
config vdom*
config system accprofile
    edit "prof_admin"
        set admingrp read-write
        set utmgrp read-write
        set vpngrp read-write
        set wanoptgrp read-write
        set wifi read-write
config vdom*
test sample data
end'''

count = 0
with StringIO(text) as file:
    for key, group in groupby(file, key=lambda x: 'config vdom' in x):
        if key is True:
            count += 1
        if count == 3 and key is False:
            with StringIO() as out_file:
                out_file.writelines(group)
                print(out_file.getvalue())
</code></pre>
<p>this prints (or writes to your file)</p>
<pre><code>test sample data
end
</code></pre>
<p>...is that your desired output?</p>
<p><code>key</code> will be <code>True</code> for every line where <code>'config vdom'</code> appears and false for all other lines. <code>group</code> collects all the lines until the value of <code>key</code> changes.</p>
<p>you'd need to replace all the <code>StringIO</code> parts with your desired files.</p>
</div>
<span class="comment-copy">Can you post a sample of your data?</span>
<span class="comment-copy">Add the sample now.</span>
<span class="comment-copy">Expected output <code>test sample data</code> ?</span>
