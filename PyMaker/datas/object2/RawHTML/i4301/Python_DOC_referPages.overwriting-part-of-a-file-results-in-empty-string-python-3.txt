<div class="post-text" itemprop="text">
<p><strong>EDIT: The solution was simply changing how I was opening the file (thanks Primusa), not how I was replacing the information.</strong></p>
<p>I am attempting to overwrite parts of a file, but my code does not work. When it runs, it completely erases everything in the file, leaving nothing behind.</p>
<p>Here is my code:</p>
<pre><code>for fname in store:
    with open(fname + ".txt", "w+") as f:
        for line in f:
            c = store[fname]
            x = (c-1)%len(line.split(","))
            y = m.floor((c-1)/len(line.split(",")))

            for n in range(y):
                f.readline()

            ldata = line.strip("\n").split(",")
            for i in range(len(ldata)):
                ldata[i] = int(ldata[i])

            if w == None:
                ldata[x] += 1
            elif w == True:
                ldata[x] += 2
            elif w == False:
                ldata[x] -= 1

            #s = line.find("\n") - 1
            #f.truncate(s)
            f.write(str(ldata) + "\n")
</code></pre>
<h1>Key:</h1>
<ul>
<li><code>fname</code>: a string variable corresponding to a file name without the file type.</li>
<li><code>store</code>: a dictionary containing file name keys as string and integer values.</li>
<li><code>f</code>: a file containing multiple lines of integer lists.</li>
<li><code>c</code>: an integer variable used to determine the integer to be accessed.</li>
<li><code>x</code> and <code>y</code>: variables with values set as the column and row (respectively) of the integer to be accessed in the file.</li>
<li><code>w</code>: a variable stored as either a boolean or <code>None</code>, used to determine whether the accessed integer should increase or decrease, and by how much.</li>
<li><code>s</code>: a currently unused integer variable used to truncate part of the file.</li>
</ul>
<h1>Example of use:</h1>
<p>Say I have a file <code>Foo.txt</code>, which has the following information stored in it:</p>
<blockquote>
<p>0,2,3,7</p>
<p>11,3,6,4</p>
</blockquote>
<p>I want to increase the "6" value by 2, so I run the code with <code>w</code> set to <code>True</code> and add <code>"Foo" : 7</code> to <code>store</code>, since "6" is the 7th number in the file (regardless of list length).</p>
<h3>What should happen:</h3>
<p><code>Foo.txt</code> is modified and now contains:</p>
<blockquote>
<p>0,2,3,7</p>
<p>11,3,8,4</p>
</blockquote>
<h3>What actually happens:</h3>
<p><code>Foo.txt</code> still exists, but now contains:</p>
<blockquote>
<p></p>
</blockquote>
<p>Which is to say it is empty.</p>
<p>What is wrong with my code? Am I handling the file incorrectly, the variable calculations, syntax, or something else entirely?</p>
</div>
<div class="post-text" itemprop="text">
<pre><code>with open(fname + ".txt", "w+") as f:
</code></pre>
<p>Opening a file in mode "w+" truncates the file, which means it deletes everything inside of it. All of the operations you do after this statement are on an empty file.</p>
<p>What I would suggest would be opening the file in read mode:</p>
<pre><code>with open(fname + ".txt", "r") as f:
</code></pre>
<p>Loading the file into memory, making your changes, and then opening the file in "w+" mode and putting the file back down.</p>
<p>Lets do this on the foo example:</p>
<pre><code>with open("foo.txt", 'r') as f: #open in read mode
    a = f.read().split(',') #breaking it apart so i can locate the 6th number easier
    a[6] = str(int(a[6]) + 2) #make my modifications
    a = ','.join(a) #convert it back to string
with open("foo.txt", 'w+') as f: #open in write and delete everything
    f.write(a) #write my modified version of the file
</code></pre>
<p>Note this is a very basic example so it doesn't take into account the newlines.</p>
</div>
<span class="comment-copy">Right there in <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer">the docs</a> - <code>'w' for writing (truncating the file if it already exists),</code></span>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/17140886/how-to-search-and-replace-text-in-a-file-using-python">How to search and replace text in a file using Python?</a></span>
<span class="comment-copy">Sorry, this is NOT a duplicate, especially as it has a completely different solution.</span>
<span class="comment-copy">Thank you, this will work just fine.</span>
