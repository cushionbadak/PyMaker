<div class="post-text" itemprop="text">
<p>How can I scrape the lat and lng from such a js block with Python + Beautiful Soup?</p>
<blockquote>
<p>Gmaps.map.markers =
  [{"id":6,"multi_system":"No","connectedProjects":null,"description":"Kaheawa Wind Project - Younicos<br/>Country :
  United States<br/>Technology Type : Electro-chemical<br/>Status :
  Operational","picture":"<a href="http://chart.apis.google.com/chart?chst=d_map_pin_letter&amp;chld=%E2%80%A2|FE7569" rel="nofollow noreferrer">http://chart.apis.google.com/chart?chst=d_map_pin_letter&amp;chld=%E2%80%A2|FE7569</a>","width":32,"height":32,"lat":20.7983626,"lng":-156.3319253}];</p>
</blockquote>
<p>Basic code (see <a href="https://stackoverflow.com/questions/49956645/beautifulsoup-getting-content-behind-multiple-div-levels">my last question</a>):</p>
<pre><code>import requests
from bs4 import BeautifulSoup

page = requests.get("https://www.energystorageexchange.org/projects/6") 
soup = BeautifulSoup(page.content, 'lxml')

coord = soup.findAll("Gmaps.map.markers")
</code></pre>
<p>Thanks for any answer.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use this approach. Get the <code>dict</code> data from that variable and parse it with the <code>json</code> module:</p>
<pre><code>import json

JS_BLOCK = """Gmaps.map.markers = [{"id":6,"multi_system":"No","connectedProjects":null,"description":"Kaheawa Wind Project - Younicos
Country : United States
Technology Type : Electro-chemical
Status : Operational","picture":"http://chart.apis.google.com/chart?chst=d_map_pin_letter&amp;chld=%E2%80%A2|FE7569","width":32,"height":32,"lat":20.7983626,"lng":-156.3319253}];"""

ini = JS_BLOCK.find("Gmaps.map.markers = [") + len("Gmaps.map.markers = [")
end = JS_BLOCK.find("}];") + 1

data = json.loads(JS_BLOCK[ini:end].replace('\n', ''))

print(data['lat'])
print(data['lng'])
</code></pre>
<p><strong>Output</strong>:</p>
<pre><code>20.7983626
-156.3319253
</code></pre>
<p>You can also try a <code>regex</code> approach to do this if you want.</p>
</div>
<div class="post-text" itemprop="text">
<p>Regex solution:</p>
<p><strong>Code:</strong></p>
<pre><code>import json
import re
import requests

url = 'https://www.energystorageexchange.org/projects/6'

r = requests.get(url)
html = r.text

markers_raw = re.search(
    r'Gmaps\.map\.markers'
    r'\s*=\s*'
    r'(.*);', html).group(1)

markers = json.loads(markers_raw)

import pprint
pprint.pprint(markers)
</code></pre>
<p><strong>Output:</strong></p>
<pre><code>[{'connectedProjects': None,
  'description': "&lt;a href='/projects/6'&gt;Kaheawa Wind Project - "
                 'Younicos&lt;/a&gt;&lt;br&gt;Country : United States&lt;br&gt;Technology Type : '
                 'Electro-chemical&lt;br&gt;Status : Operational',
  'height': 32,
  'id': 6,
  'lat': 20.7983626,
  'lng': -156.3319253,
  'multi_system': 'No',
  'picture': 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&amp;chld=%E2%80%A2|FE7569',
  'width': 32}]
</code></pre>
<p>If regular expressions are new to you, you can take a look <a href="https://docs.python.org/3/howto/regex.html" rel="nofollow noreferrer">here</a>.</p>
</div>
<span class="comment-copy">How can I replace JS_BLOCK with my webpage? Neither soup nor page / page.content are working!</span>
<span class="comment-copy">That is a total different question. If you can't parse it with beautifulsoup then try selenium</span>
<span class="comment-copy">Actually, you answered a totally different question :D OP even included the code when he tries to scrape it from the web ^^</span>
