<div class="post-text" itemprop="text">
<p>I want to display data from an xls file into an HTML table. I am using openpyxl to read data from xls file. I used HTML codes to create a table using HTML tags, but I am unable to put data inside the table using variables. I am able to print <code>sheet['A2']</code> and see the value from xls file. I have assigned this value to a variable <code>a2</code>. How can I print the value from this variable inside HTML. More specifically, how can I put the value of variable inside this tag: <code>&lt;tr&gt;&lt;td class="cell"&gt;{%sheet['A2']%}&lt;/td&gt; &lt;td class="cell"&gt;Cell 1.2&lt;/td&gt;&lt;/tr&gt;</code></p>
<pre><code>   import smtplib
   import openpyxl
   from email.mime.multipart import MIMEMultipart
   from email.mime.text import MIMEText
   from email.mime.base import MIMEBase
   from email import encoders

   def py_mail(SUBJECT, BODY, TO, FROM):
    """With this function we send out our html email"""


   book = 
   openpyxl.load_workbook('D:\download\DAILY_PROJECT_REPORT20180420.xlsx')
   sheet = book.active

   a2 = sheet['A2']



     # Record the MIME type text/html.
      HTML_BODY = MIMEText(BODY, 'html')

     if __name__ == "__main__":
 """Executes if the script is run as main script (for testing purposes)"""

     email_content = """
     &lt;head&gt;
     &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
      &lt;title&gt;html title&lt;/title&gt;
      &lt;style type="text/css" media="screen"&gt;
      table {
      border-collapse: collapse;
       }

      table, td, th {
      border: 1px solid black;
       border-collapse: collapse;
       border-spacing: 5px;
      }
     &lt;/style&gt;
     &lt;/head&gt;
     &lt;body&gt;

    &lt;table style="width:70%"&gt;
       &lt;tr&gt;
    &lt;th&gt; PREPAC &lt;/th&gt;
    &lt;th&gt; TEAM_STATUS &lt;/th&gt;
    &lt;th&gt; TOTAL &lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;&lt;td class="cell"&gt;{%sheet['A2']}%&lt;/td&gt;&lt;td class="cell"&gt;Cell 1.2&lt;/td&gt; 
     &lt;/tr&gt;
     &lt;tr&gt;&lt;td class="cell"&gt;Cell 2.1&lt;/td&gt;&lt;td class="cell"&gt;&lt;/td&gt;&lt;/tr&gt;

    &lt;/table&gt;

    &lt;/body&gt;
    """

     py_mail("Test email subject", email_content, TO, FROM)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>One way would be to use <a href="https://docs.python.org/3/library/string.html#formatstrings" rel="nofollow noreferrer">string formatting</a>:</p>
<pre><code>&gt;&gt;&gt; html = """&lt;td&gt;{}&lt;/td&gt;"""
&gt;&gt;&gt; s1A2 = 10
&gt;&gt;&gt; print(html.format(s1A2))
&lt;td&gt;10&lt;/td&gt;
</code></pre>
<p>Or using <a href="https://docs.python.org/3/reference/lexical_analysis.html#formatted-string-literals" rel="nofollow noreferrer">f-strings</a>:</p>
<pre><code>&gt;&gt;&gt; print(f"""&lt;td&gt;{s1A2}&lt;/td&gt;""")
&lt;td&gt;10&lt;/td&gt;
&gt;&gt;&gt;
</code></pre>
<p>Or use named replacement fields in the format string with a dictionary</p>
<pre><code>&gt;&gt;&gt; data = {'s1A2':10}
&gt;&gt;&gt; html = """&lt;td&gt;{s1A2:}&lt;/td&gt;"""
&gt;&gt;&gt; print(html.format(**data))
&lt;td&gt;10&lt;/td&gt;
&gt;&gt;&gt;
</code></pre>
<hr/>
<p>Your string:</p>
<pre><code>s = """&lt;tr&gt;&lt;td class="cell"&gt;{%sheet['A2']}%&lt;/td&gt;&lt;td class="cell"&gt;Cell 1.2&lt;/td&gt;"""
</code></pre>
<p>If using Python version 3.6+ use an f-string:</p>
<pre><code>print(f"""&lt;tr&gt;&lt;td class="cell"&gt;{sheet['A2']}%&lt;/td&gt;&lt;td class="cell"&gt;Cell 1.2&lt;/td&gt;"""
</code></pre>
<p>Or use traditional formatting;</p>
<pre><code>print("""&lt;tr&gt;&lt;td class="cell"&gt;{}%&lt;/td&gt;&lt;td class="cell"&gt;Cell 1.2&lt;/td&gt;""".format(sheet['A2']))
</code></pre>
</div>
<span class="comment-copy">hello, I tried your example, unfortunately, it is not working for me. could you kindly tell me how can I print(html.format(s1A2)) inside the variable email_content, i have tried multiple options, but nothing worked so far.</span>
<span class="comment-copy">@ShubhajitChanda did you look at any of the documentation I linked to in my answer?</span>
