<div class="post-text" itemprop="text">
<p>I have a folder (<strong>dataset_folder</strong>) that contains 10 *.tar files.
Here is my code to extract them in a specific path.</p>
<pre><code>listtar=glob.glob(dataset_folder+'/*.tar')
for file in listtar:
    tar=tarfile.open(file)
    tar.extractall(path=dataset_folder)
    tar.close()
</code></pre>
<p>Note that <strong>dataset_folder</strong> is under the current directory.
 <strong>I get an error</strong> </p>
<pre><code>ReadError: unexpected end of data
</code></pre>
<p><em>Note also that I can untar files manually without problems.</em></p>
</div>
<div class="post-text" itemprop="text">
<p>to handle corrupt files directly from Python, catch the relevant exception and skip the corrupt file:</p>
<pre><code>listtar=glob.glob(dataset_folder+'/*.tar')
for file in listtar:
    try:
        with tarfile.open(file) as tar:
            tar.extractall(path=dataset_folder)
    except tarfile.ReadError:
        print("File {} is corrupt".format(file))
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Sounds like one of the tar files is corrupt or of a format that tarfile can't handle</p>
<p><a href="https://docs.python.org/3/library/tarfile.html#tarfile.ReadError" rel="nofollow noreferrer">https://docs.python.org/3/library/tarfile.html#tarfile.ReadError</a></p>
<p>If you've got access to tar in a shell then try something like this, replacing "tmp" with your dataset folder.</p>
<pre><code>for i in tmp/*.tar; do tar -C tmp -xvf $i || echo "$i is a problem"; done
</code></pre>
</div>
<span class="comment-copy">" I can zip files manually without problems" you mean "untar manually" right ?</span>
<span class="comment-copy">@Jean-FrançoisFabre yes. It is corrected. Thanks</span>
<span class="comment-copy">are you getting an error for the first file or for <i>some</i> file?</span>
<span class="comment-copy">@Jean-FrançoisFabre, I tried the code manually (listtar[index] instead of x ) and for several index I get the same error.</span>
<span class="comment-copy">are you sure your .tar files are .tar files? some programs could recognize supported archives only by the magic number. Check the start of your files with an hex editor.</span>
<span class="comment-copy">It is a good script. Some videos are corrupted</span>
