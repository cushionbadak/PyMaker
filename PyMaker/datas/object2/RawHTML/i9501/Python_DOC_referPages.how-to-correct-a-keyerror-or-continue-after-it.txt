<div class="post-text" itemprop="text">
<p>I am using this code to follow a twitter account and if a specific word is tweeted it prints the text and the tweet id then deletes the tweet.  The code below works as in it finds the word 'hi' when tweeted, prints it and the id, and deletes the tweet. The problem is that immediately after it deletes the tweet I get the error- <code>KeyError 'text'</code> . and the script stops. I'm new to python and don't know much about dictionaries, exceptions, or KeyError.  How do I make an exception to ignore this error and continue or create a dictionary and additional code so no error happens? </p>
<pre><code>import time
from twython import TwythonStreamer
from twython import Twython



# Twitter application authentication
APP_KEY = ''
APP_SECRET = ''
OAUTH_TOKEN = ''
OAUTH_TOKEN_SECRET = ''


twitter = Twython(APP_KEY, APP_SECRET, OAUTH_TOKEN, OAUTH_TOKEN_SECRET)


# Setup callbacks from Twython Streamer
class TweetStreamer(TwythonStreamer):
        def on_success (self, data):
            if (data['text']) == ('hi'):
                print (data['text'])
                print (data['id'])
                time.sleep(2)
                twitter.destroy_status(id=data['id'])
                print ('Tweet was deleted')


        def on_error(self, status_code, data):
                print (status_code)


# Create streamer
try:
        stream = TweetStreamer(APP_KEY, APP_SECRET, OAUTH_TOKEN, OAUTH_TOKEN_SECRET)
        stream.statuses.filter(follow = '')

except KeyboardInterrupt:
        print ('Process manually stopped')
</code></pre>
<p>Full error:  </p>
<pre><code>Traceback (most recent call last):
  File "C:\Users\MainUser\Desktop\Python Scripts\twitterstreamuser.py", line 35, in &lt;module&gt;
    stream.statuses.filter(follow = '')
  File "C:\Users\MainUser\AppData\Local\Programs\Python\Python35-32\lib\site-packages\twython\streaming\types.py", line 66, in filter
    self.streamer._request(url, 'POST', params=params)
  File "C:\Users\MainUser\AppData\Local\Programs\Python\Python35-32\lib\site-packages\twython\streaming\api.py", line 154, in _request
    if self.on_success(data):  # pragma: no cover
  File "C:\Users\MainUser\Desktop\Python Scripts\twitterstreamuser.py", line 20, in on_success
    if (data['text']) == ('hi'):
KeyError: 'text'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You try to get <code>"text"</code> from <code>data</code> </p>
<pre><code>data["text"]
</code></pre>
<p>but <code>data</code> doesn't have key <code>"text"</code></p>
<p>You can check if <code>data</code> has key <code>"text"</code></p>
<pre><code>if 'text' in data:
   if data['text'] == 'hi':
       print(data['text'])
</code></pre>
<p>or shorter</p>
<pre><code>if 'text' in data and data['text'] == 'hi':
    print(data['text'])
</code></pre>
<p>or use <code>data.get("text")</code> (or <code>data.get("text", "default text")</code>) to get <code>"text"</code> or <code>"default text"</code> (or <code>None</code>)</p>
<pre><code>msg = data.get("text") # it gives data["text"] or `None`
if msg == 'hi':
   print(msg)
</code></pre>
</div>
<span class="comment-copy"><a href="https://docs.python.org/3/tutorial/errors.html" rel="nofollow noreferrer">docs.python.org/3/tutorial/errors.html</a></span>
<span class="comment-copy">always in question (not in comment) show full error message (Traceback) - there are other usefull information - ie. in which line you get this error.</span>
<span class="comment-copy"><code>KeyError 'text'</code> means you try to do <code>data['text']</code> but there is no <code>'text'</code> inside <code>data</code> - You can check <code>if "text" in data:</code></span>
<span class="comment-copy">Also consider <a href="https://docs.python.org/3/library/stdtypes.html#dict.get" rel="nofollow noreferrer"><code>.get(key)</code></a> and excplicit handling of <code>None</code>.</span>
<span class="comment-copy">Thanks for all the quick responses.  I have added the full error message to the post.</span>
<span class="comment-copy">Thank you furas! I finally got a minute to work on this again after the holiday.  I'm using the "shorter" version you suggested and it seems to be working with no issues.  Now I just need to let it run for a few days to see if it fails do to twitters api rate limits.  Hopefully not, but if so I wrote a different script that doesn't stream, but checks a user timeline.  Only problem with that one is I have to include an 11 second delay so it doesn't go over the twitter rate limits.  Hence me wanting to switch to a streaming method.     Again....thanks for the help!!</span>
