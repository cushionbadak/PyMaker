<div class="post-text" itemprop="text">
<p>I need to parse the below Json data using python and write to a csv file. Below I have included only 2 server names but my list is big. Please help with sample code to get the desired output.</p>
<p>Below is my json data in a file server_info.json:</p>
<pre><code>{
"dev-server":
    {
    "hoststatus":
        {
        "host_name":"dev-server",
        "current_state":"2",
        "last_time_up":"1482525184"
        },
    "servicestatus":
        {
        "/ Filesystem Check":
            {
            "host_name":"dev-server",
            "service_description":"/ Filesystem Check",
            "current_state":"1",
            "state_type":"1"
            },
        "/home Filesystem Check":
            {
            "host_name":"dev-server",
            "service_description":"/home Filesystem Check",
            "current_state":"2",
            "state_type":"2"
            }
        }
    },
"uat-server":
    {
    "hoststatus":
        {
        "host_name":"uat-server",
        "current_state":"0",
        "last_time_up":"1460000000"
        },
    "servicestatus":
        {
        "/ Filesystem Check":
            {
            "host_name":"uat-server",
            "service_description":"/ Filesystem Check",
            "current_state":"0",
            "state_type":"1"
            },
        "/home Filesystem Check":
            {
            "host_name":"uat-server",
            "service_description":"/home Filesystem Check",
            "current_state":"1",
            "state_type":"2"
            }
        }
    }
}
</code></pre>
<p>Expected Output:</p>
<p>output format: </p>
<pre><code>hoststatus.host_name,hoststatus.current_state,hoststatus.last_time_up
-------------------------------------------------------------
dev-server,2,1482525184
uat-server,0,1460000000
</code></pre>
<p>and</p>
<p>output format:</p>
<pre><code>servicestatus.host_name,servicestatus.service_description,servicestatus.current_state,servicestatus.state_type
--------------------------------------------------------------------------------
dev-server,/ Filesystem Check,1,1
dev-server,/home Filesystem Check,2,2
uat-server,/ Filesystem Check,0,1
uat-server,/home Filesystem Check,1,2
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Elaborating more on what Jean-Fracois Fabre mentioned, <code>json.load()</code> can be used to read a JSON file and parse into Python object representation of JSON. <code>json.loads()</code> does the same except that the input is a string instead of a file (see <a href="https://docs.python.org/3/library/json.html" rel="nofollow noreferrer">json</a> module for more details).</p>
<p>Bearing this in mind, say if you have your server logs in a file then you can start with the following:</p>
<pre><code>import json
file = open('logs.txt')
data = json.load(file) # now the JSON object is represented as Python dict
for key in data.keys(): # dev-server and uat-server are keys
    service_status = data[key]['servicestatus'] # this would give out the servicestatus
    host_status = data[key]['hoststatus'] # this would give out the hoststatus
</code></pre>
<p>With this, you could use <a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer"><code>csv</code></a> module to write it as CSV file in the format you desire.</p>
</div>
<div class="post-text" itemprop="text">
<p>A example by list comprehension.</p>
<pre><code>import json

d = json.loads(data)

print("\n".join([','.join((hstat['host_name'], hstat['current_state'], hstat['last_time_up']))
                 for g in d.values()
                 for k, hstat in g.items() if k == 'hoststatus']))

print("\n".join([','.join((v['host_name'], v['service_description'], v['current_state'], v['state_type']))
                 for g in d.values()
                 for k, sstat in g.items() if k == 'servicestatus'
                 for v in sstat.values()]))
</code></pre>
</div>
<span class="comment-copy">use <code>json.loads()</code> to get a python dict, then show us your attempts. this is a tedious code-writing task, better done by you.</span>
<span class="comment-copy">have you tried something or are you just asking us to do your work?</span>
<span class="comment-copy">Thank you Jean. I did have the code, was looking for how to read the server names as keys.</span>
<span class="comment-copy">I got it now and my code is working, keys()</span>
<span class="comment-copy">Thank you. This helps me.</span>
<span class="comment-copy">accepted the answer. Thank you</span>
<span class="comment-copy">this is giving me error: TypeError: expected string or buffer</span>
<span class="comment-copy">the solution provided by kuriouscoder is working for me. Thanks for your help too.</span>
