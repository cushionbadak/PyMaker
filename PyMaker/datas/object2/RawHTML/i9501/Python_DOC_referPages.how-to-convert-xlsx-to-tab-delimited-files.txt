<div class="post-text" itemprop="text">
<p>I have quite a lot of xlsx files which is a pain to convert them one by one to tab delimited files </p>
<p>I would like to know if there is any solution to do this by python. Here what I found and what tried to do with failure 
This I found and I tried the solution but did not work <a href="https://stackoverflow.com/questions/17798864/mass-convert-xls-and-xlsx-to-txt-tab-delimited-on-a-mac">Mass Convert .xls and .xlsx to .txt (Tab Delimited) on a Mac</a></p>
<p>I also tried to do it for one file to see how it works but with no success </p>
<pre><code>#!/usr/bin/python
import xlrd
import csv


def main():
    # I open the xlsx file 
    myfile = xlrd.open_workbook('myfile.xlsx')
    # I don't know the name of sheet
    mysheet = myfile.sheet_by_index(0)
    # I open the output csv
    myCsvfile = open('my.csv', 'wb')
    # I write the file into it
    wr = csv.writer(myCsvfile, delimiter="\t")
    for rownum in xrange(mysheet.nrows):
        wr.writerow(mysheet.row_values(rownum))
    myCsvfile.close()
if __name__ == '__main__':
   main()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>No real need for the main function. </p>
<p>And not sure about your indentation problems, but this is how I would write what you have. (And should work, according to first comment above)</p>
<pre><code>#!/usr/bin/python
import xlrd
import csv

# open the output csv
with open('my.csv', 'wb') as myCsvfile:
    # define a writer
    wr = csv.writer(myCsvfile, delimiter="\t")

    # open the xlsx file 
    myfile = xlrd.open_workbook('myfile.xlsx')
    # get a sheet
    mysheet = myfile.sheet_by_index(0)

    # write the rows
    for rownum in xrange(mysheet.nrows):
        wr.writerow(mysheet.row_values(rownum))
</code></pre>
</div>
<span class="comment-copy">apart from all wrong variable names, your program works fine.  what's your problem exactly? what's the error?</span>
<span class="comment-copy">@Jean-François Fabre can you modify my variable names in my question ? I am using Mac with python2.7</span>
<span class="comment-copy">@Jean-François Fabre there is no error, it just does not create any file</span>
<span class="comment-copy">Did you remember to run <code>main()</code>?</span>
<span class="comment-copy">quickfix: <code>def main():     # I open the xlsx file     myfile = xlrd.open_workbook('Classeur1.xlsx')     # I don't know the name of sheet     mysheet = myfile.sheet_by_index(0)     # I open the output csv     myCsvfile = open('my.csv', 'wb')     # I write the file into it     wr = csv.writer(myCsvfile, delimiter="\t")     for rownum in xrange(mysheet.nrows):         wr.writerow(mysheet.row_values(rownum))     myCsvfile.close()</code></span>
<span class="comment-copy">I am getting this error  <code>wr.writerow(mysheet.row_values(rownum)) UnicodeEncodeError: 'ascii' codec can't encode characters in position 131-132: ordinal not in range(128)</code>do you know why?</span>
<span class="comment-copy">I liked and accepted your answer but I would appreciate if you could modify it to give me .txt instead .csv , if possible</span>
<span class="comment-copy">Umm.. <code>open('my.txt', 'wb')</code>? File extensions are highly irrelevant to the problem</span>
<span class="comment-copy">OH MY GOD, I solved it , look at this , I only add rU to open file <code>open('data.txt','rU')</code> it works like a charm :-D :-D :-D  here i found info <a href="http://stackoverflow.com/questions/1785233/convert-r-text-to-n-so-readlines-works-as-intended" title="convert r text to n so readlines works as intended">stackoverflow.com/questions/1785233/…</a></span>
<span class="comment-copy">That mode is deprecated, so I'm sure it'll work for now. <a href="https://docs.python.org/3/library/functions.html#open" rel="nofollow noreferrer">docs.python.org/3/library/functions.html#open</a></span>
