<div class="post-text" itemprop="text">
<p>I am looping over all lines one by one using </p>
<pre><code>line = file.readline() 
</code></pre>
<p>Every line is now searched for a particular string(XYZ) - </p>
<pre><code>line.startswith('XYZ')
</code></pre>
<p>I am not able to figure out how to get to couple of lines behind relative to the line where match was found for the string <code>XYZ</code>.</p>
<p>I understand that this could be something trivial but couldn't make it.</p>
</div>
<div class="post-text" itemprop="text">
<p>You could use <a href="https://docs.python.org/3/library/collections.html#collections.deque" rel="nofollow"><code>collections.deque()</code></a> to cache previous 2 lines:</p>
<pre><code>#!/usr/bin/env python
import sys
from collections import deque

cached_lines = deque(maxlen=2) # keep 2 lines
for line in sys.stdin:
    if line.startswith('XYZ'):
        sys.stdout.writelines(cached_lines)
    cached_lines.append(line)
</code></pre>
<p>The advantage is that you don't need to read the whole file into memory.</p>
<h3>Example</h3>
<pre><code>$ python . &lt;input &gt;output 
</code></pre>
<h3>Input</h3>
<pre><code>XYZ 1
2
3
4
XYZ 5
XYZ 6
7
8
9
XYZ 10
11
12
</code></pre>
<h3>Output</h3>
<pre><code>3
4
4
XYZ 5
8
9
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>file.tell() gives current file pointer. And file.seek(pointer) sets the file pointer to given pointer. Like below code,</p>
<p>pointer = file.tell()</p>
<p>..</p>
<p>..</p>
<p>..</p>
<p>file.seek(pointer) </p>
</div>
<div class="post-text" itemprop="text">
<p>You need to save all readed lines or simply use <code>readlines</code> method.</p>
<pre><code>lines = file.readlines()
for i in range(0, len(lines)): 
    if lines[i].startswith("XYZ"):
        print lines[i-2]
        print lines[i-1]
</code></pre>
</div>
<span class="comment-copy">It's not trivial. Filesystems are not designed to read files backwards.</span>
<span class="comment-copy">related: <a href="http://stackoverflow.com/q/136168/4279">Get last n lines of a file with Python, similar to tail</a></span>
<span class="comment-copy">Perfect. thanks !</span>
