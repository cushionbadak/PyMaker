<div class="post-text" itemprop="text">
<p>I am trying to retrieve a list of columns per tablename</p>
<p>Let's say I have the following table</p>
<pre><code>('tableA', 'columnA', 1)
('tableA', 'columnB', 2)
('tableB', 'columnA', 1)
('tableB', 'columnB', 2)
('tableC', 'columnA', 1)
('tableD', 'columnA', 1)
</code></pre>
<p>how can I return a list grouped by the same tablename?
So it returns the following</p>
<pre><code>('tableA', 'columnA', 'columnB')
('tableB', 'columnA', 'columnB')
('tableC', 'columnA')
('tableD', 'columnA')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.python.org/3/library/itertools.html#itertools.groupby" rel="nofollow"><code>itertools.groupby</code></a> for this. Note that this requires the list to be sorted by table name first, but in your case it seems to be, anyway. Otherwise, sort it first.</p>
<pre><code>get_data_from_table.sort() # only if not already sorted
tables = [[key] + [g[1] for g in groups] 
          for (key, groups) in itertools.groupby(get_data_from_table, 
                                                 key=operator.itemgetter(0))]
</code></pre>
<p>Or use a dictionary (or <a href="https://docs.python.org/3/library/collections.html#collections.defaultdict" rel="nofollow"><code>defaultdict</code></a>), mapping table names to columns:</p>
<pre><code>d = collections.defaultdict(list)
for t, c, n in get_data_from_table:
    d[t].append(c)
tables = [[key] + values for key, values in d.items()]
</code></pre>
</div>
<span class="comment-copy">You need to give more details, like what type of database are you using?</span>
<span class="comment-copy">Did you try out some code over the same question? Any snippet?</span>
<span class="comment-copy">You can use dictionary with key as table</span>
<span class="comment-copy">i used pyodbc to create a list item for each row with the query: get_data_from_table = cursor.fetchall(). It returns a list like i posted in the original</span>
<span class="comment-copy">Perfect! thank you very much.</span>
