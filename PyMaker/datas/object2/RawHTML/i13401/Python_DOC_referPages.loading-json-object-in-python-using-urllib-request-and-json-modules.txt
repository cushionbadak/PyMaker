<div class="post-text" itemprop="text">
<p>I am having problems making the modules 'json' and 'urllib.request' work together in a simple Python script test. Using Python 3.5 and here is the code:</p>
<pre><code>import json
import urllib.request

urlData = "http://api.openweathermap.org/data/2.5/weather?q=Boras,SE"
webURL = urllib.request.urlopen(urlData)
print(webURL.read())
JSON_object = json.loads(webURL.read()) #this is the line that doesn't work
</code></pre>
<p>When running script through command line the error I am getting is "<strong>TypeError:the JSON object must be str, not 'bytes'</strong>". I am new to Python so there is most likely a very easy solution to is. Appreciate any help here. </p>
</div>
<div class="post-text" itemprop="text">
<p>Apart from forgetting to decode, you can only read the response <em>once</em>. Having called <code>.read()</code> already, the second call returns an empty string.</p>
<p>Call <code>.read()</code> just once, and <em>decode</em> the data to a string:</p>
<pre><code>data = webURL.read()
print(data)
encoding = webURL.info().get_content_charset('utf-8')
JSON_object = json.loads(data.decode(encoding))
</code></pre>
<p>The <a href="https://docs.python.org/3/library/email.message.html#email.message.EmailMessage.get_content_charset" rel="noreferrer"><code>response.info().get_content_charset()</code> call</a> tells you what characterset the server thinks is used.</p>
<p>Demo:</p>
<pre><code>&gt;&gt;&gt; import json
&gt;&gt;&gt; import urllib.request
&gt;&gt;&gt; urlData = "http://api.openweathermap.org/data/2.5/weather?q=Boras,SE"
&gt;&gt;&gt; webURL = urllib.request.urlopen(urlData)
&gt;&gt;&gt; data = webURL.read()
&gt;&gt;&gt; encoding = webURL.info().get_content_charset('utf-8')
&gt;&gt;&gt; json.loads(data.decode(encoding))
{'coord': {'lat': 57.72, 'lon': 12.94}, 'visibility': 10000, 'name': 'Boras', 'main': {'pressure': 1021, 'humidity': 71, 'temp_min': 285.15, 'temp': 286.39, 'temp_max': 288.15}, 'id': 2720501, 'weather': [{'id': 802, 'description': 'scattered clouds', 'icon': '03d', 'main': 'Clouds'}], 'wind': {'speed': 5.1, 'deg': 260}, 'sys': {'type': 1, 'country': 'SE', 'sunrise': 1443243685, 'id': 5384, 'message': 0.0132, 'sunset': 1443286590}, 'dt': 1443257400, 'cod': 200, 'base': 'stations', 'clouds': {'all': 40}}
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>As I study myself you just need to use <code>decode('utf-8')</code> function, then after use <code>json.load()</code> function to extract into json format.</p>
<pre><code>&gt;&gt;&gt; import json
&gt;&gt;&gt; import urllib.request

&gt;&gt;&gt; urlData = "http://api.openweathermap.org/data/2.5/weather?q=Boras,SE"
&gt;&gt;&gt; webURL = urllib.request.urlopen(urlData)
&gt;&gt;&gt; data = webURL.read()
&gt;&gt;&gt; JSON_object = json.loads(data.decode('utf-8'))
{'coord': {'lat': 57.72, 'lon': 12.94}, 'visibility': 10000, 'name': 'Boras', 'main': {'pressure': 1021, 'humidity': 71, 'temp_min': 285.15, 'temp': 286.39, 'temp_max': 288.15}, 'id': 2720501, 'weather': [{'id': 802, 'description': 'scattered clouds', 'icon': '03d', 'main': 'Clouds'}], 'wind': {'speed': 5.1, 'deg': 260}, 'sys': {'type': 1, 'country': 'SE', 'sunrise': 1443243685, 'id': 5384, 'message': 0.0132, 'sunset': 1443286590}, 'dt': 1443257400, 'cod': 200, 'base': 'stations', 'clouds': {'all': 40}}
</code></pre>
</div>
<span class="comment-copy">Thanks a bunch, works well now!</span>
