<div class="post-text" itemprop="text">
<p>Consider the following code:</p>
<pre><code>import argparse
parser = argparse.ArgumentParser()
parser.add_argument('-o', required=True, nargs=1)
parser.parse_args(['-h'])
</code></pre>
<p>Why am I getting the following output even if I said that <code>-o</code> is required?</p>
<pre><code>usage: test.py [-h] -o O

optional arguments:
  -h, --help  show this help message and exit
  -o O
</code></pre>
<p>I would expect the help text to say that <code>-o</code> is required. </p>
</div>
<div class="post-text" itemprop="text">
<p>This is <a href="http://bugs.python.org/issue9694" rel="nofollow">issue #9694 on the Python bug tracker</a>, as yet unfixed. You can read more there. Note that the usage line does correctly indicate that the switch is required (if it weren't, the usage line would read <code>usage: test.py [-h] [-o O]</code> instead of <code>usage: test.py [-h] -o O</code>).</p>
<p>For working around it, you can <a href="https://docs.python.org/3/library/argparse.html#argument-groups" rel="nofollow">use argument groups</a> which can be given a <code>title</code>. As the example shows at the linked page, this allows you to create groups with your choice of name instead of the default <code>positional arguments</code> and <code>optional arguments</code> groupings.</p>
</div>
<div class="post-text" itemprop="text">
<p>Generally the paradigm for <code>argparse</code> is that the required arguments are passed in positionally, and the arguments passed as options should be <em>optional</em>.  The <a href="https://docs.python.org/3/library/argparse.html#required" rel="nofollow">docs</a> even discourage setting the <code>required</code> flag, considering this 'bad form'.  </p>
<p>I can only suggest that the misleading help message generated is a minor shortcoming in argparse, you could possibly create a ticket for it on python's bug tracker.  </p>
<p>You can override the default usage message if it is crucial for you to have a <em>required option</em>.</p>
</div>
<div class="post-text" itemprop="text">
<p>The simple answer is that there isn't a 'required arguments' group.  The 2 default groups are labeled (for better or for worse)</p>
<pre><code>positional arguments
optional arguments
</code></pre>
<p>There are actually 4 'requirement' alternatives - normal optionals, normal positionals, required optionals, optional positionals.  If the names are confusing, stick with the first two. :) </p>
<pre><code>parser = argparse.ArgumentParser()
parser.add_argument('foo', help='a positional argument')
reqgroup=parser.add_argument_group('required arguments')
reqgroup.add_argument('-o', required=True, help='required optional')
parser.add_argument('-n',  help='normal optional')
parser.add_argument('bar',nargs='?', help='optional positional argument')
parser.print_help()
</code></pre>
<p>produces:</p>
<pre><code>usage: ipython3.5 [-h] -o O [-n N] foo [bar]

positional arguments:
  foo         a positional argument
  bar         optional positional argument

optional arguments:
  -h, --help  show this help message and exit
  -n N        normal optional

required arguments:
  -o O        required optional
</code></pre>
<p>These alternatives are symbolically shown in the usage line, without the (potentially) confusing labels.</p>
<p>For what it's worth, the distinction between 'optionals' and 'positionals' is deeply imbedded in the <code>argparse</code> code.  One kind is identified by a flag string ('-f','--foo'), the other is identified by position.  The fact that one or the other is 'required' is superficial.  The only thing that makes some <code>optionals</code> 'required' is a bit of error checking at the end of parsing.</p>
</div>
<span class="comment-copy">This is not what I wanted to ask about. The question is why it says it's optional, not required.</span>
<span class="comment-copy">I'm pretty sure the help flag is special-cased to ignore the rest of the arguments, because the expectation is that they don't matter since all you're going to do is print the help and then quit immediately.</span>
<span class="comment-copy">Still, the help screen is clearly wrong.</span>
<span class="comment-copy">Just as a recomendation <a href="https://github.com/docopt/docopt" rel="nofollow noreferrer">docopt</a> is a really nice library to build CLIs</span>
<span class="comment-copy">I'd say it doesn't show enough information, but not that it's wrong. It doesn't say that <code>-o</code> is optional... It just doesn't specify.</span>
<span class="comment-copy">The patch languishes, in part because no one has proposed a simple, well accepted, alternative pair of names.</span>
<span class="comment-copy">Could you elaborate on how to best change (parts of) the default usage message of an <code>ArgumentParser</code> object?</span>
