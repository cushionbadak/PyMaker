<div class="post-text" itemprop="text">
<p>I am trying to start solr through python script. There are three conditions:</p>
<p>1st when user doesnot provide port number and zookeeper instance.</p>
<p>command : <code>/home/user/solr-5.3.0/bin/solr start</code></p>
<p>This one works.</p>
<p>2nd when user provides only port number.</p>
<p>command : <code>/home/user/solr-5.3.0/bin/solr start -p 8898</code></p>
<p>This does not executes.</p>
<blockquote>
<p>ERROR: Port number is required when using the -p option!</p>
</blockquote>
<p>3rd when user provides both port number and zookeeper instance.</p>
<p>command :<code>/home/user/solr-5.3.0/bin/solr start -p 8898 -z localhost:2181</code></p>
<p>This also does not executes.</p>
<blockquote>
<p>ERROR: Port number is required when using the -p option!</p>
</blockquote>
<p>I am new to python scripting. I just need to write scripts for deploying it on servers. Is this the right way of doing it ? Are there any better ways to do it ?</p>
<p><strong>Code</strong> </p>
<pre><code>#!/usr/bin/env python


import os
import optparse
import subprocess


parser = optparse.OptionParser()
parser.add_option('-p', dest='port', help='Port(By Default it will start at 8983)',type=int)
parser.add_option('-z', dest='zk', help='zookeeper Server(By default it will take embedded zookeeper)')



(options, args) = parser.parse_args()


if options.port is None and options.zk is None:
subprocess.call(["/home/user/solr-5.3.0/bin/solr start"], shell=True)
elif options.zk is None:
subprocess.call(["/home/user/solr-5.3.0/bin/solr start -p ", str(options.port)], shell=True)
else :
subprocess.call(["/home/user/solr-5.3.0/bin/solr start -p", str(options.port), "-z", str(options.zk)], shell=True)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Corrected code:</p>
<pre><code>if options.port is None and options.zk is None:
    subprocess.call(["/home/user/solr-5.3.0/bin/solr", "start"])
elif options.zk is None:
    subprocess.call(["/home/user/solr-5.3.0/bin/solr", "start", "-p", str(options.port)])
else:
    subprocess.call(["/home/user/solr-5.3.0/bin/solr", "start", "-p", str(options.port), "-z", str(options.zk)])
</code></pre>
</div>
<span class="comment-copy">When you specify <code>shell=True</code>, you should just pass an entire string to <code>subprocess</code> rather than a list. See answers like <a href="http://stackoverflow.com/questions/25465700/python-subprocess-call-with-shell-false-not-working">this one</a> for more explanation.</span>
<span class="comment-copy"><code>shell=True</code> is mentioned multiple times in the <a href="https://docs.python.org/2/library/subprocess.html" rel="nofollow noreferrer">subprocess</a> documentation (or <a href="https://docs.python.org/3/library/subprocess.html" rel="nofollow noreferrer">python3's doc</a> if you prefer).</span>
<span class="comment-copy">ERROR: -p 8898 is not supported by this script</span>
<span class="comment-copy">Doesn't work throws the above error.</span>
<span class="comment-copy">@user-4870385, you can try to separate keys and arguments: <code>subprocess.call(["/home/user/solr-5.3.0/bin/solr", "start", "-p", str(options.port)])</code></span>
<span class="comment-copy">This works .thanks !!</span>
