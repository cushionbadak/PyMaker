<div class="post-text" itemprop="text">
<p>SAS.Planet is a Russian soft, written in Delphi, to download Satellite images from many servers (sasgis.org). It is great and I use it a lot, but it would be better if I could insert my own data to it. It stores data in a file named marks.sml, which is basically a xml file. An example of it goes:</p>
<pre><code>&lt;?xml version="1.0" standalone="yes"?&gt; 
&lt;DATAPACKET Version="2.0"&gt;&lt;METADATA&gt;&lt;FIELDS&gt;
&lt;FIELD attrname="id" fieldtype="i4" readonly="true" SUBTYPE="Autoinc"/&gt;
&lt;FIELD attrname="name" fieldtype="string" WIDTH="255"/&gt;
&lt;FIELD attrname="descr" fieldtype="bin.hex" SUBTYPE="Text"/&gt;
&lt;FIELD attrname="scale1" fieldtype="i4"/&gt;&lt;FIELD attrname="scale2" fieldtype="i4"/&gt;
&lt;FIELD attrname="lonlatarr" fieldtype="bin.hex" SUBTYPE="Binary"/&gt;
&lt;FIELD attrname="lonL" fieldtype="r8"/&gt;
&lt;FIELD attrname="latT" fieldtype="r8"/&gt;
&lt;FIELD attrname="LonR" fieldtype="r8"/&gt;
&lt;FIELD attrname="LatB" fieldtype="r8"/&gt;
&lt;FIELD attrname="color1" fieldtype="i4"/&gt;
&lt;FIELD attrname="color2" fieldtype="i4"/&gt;
&lt;FIELD attrname="visible" fieldtype="boolean"/&gt;
&lt;FIELD attrname="picname" fieldtype="string" WIDTH="255"/&gt;
&lt;FIELD attrname="categoryid" fieldtype="i4"/&gt;&lt;/FIELDS&gt;
&lt;PARAMS AUTOINCVALUE="3"/&gt;&lt;/METADATA&gt;&lt;ROWDATA&gt;
&lt;ROW id="1" name="Prueba1" descr="06/04/2015 9:48:56" scale1="2" scale2="0" lonlatarr="ANBXOtFZZY8FwABITxpq702zBMAgSCcJANBXOlGCU48FwABA1S48rk+zBMAgSCcJANBXOlEvPY8FwACo0VkXqlWzBMAgSCcJANBXOtGRPI8FwADYDRHFYGKzBMAgSCcJ" lonL="-71.69795087659068" latT="-44.826108606201" LonR="-71.61829999768443" LatB="-44.84607227245893" color1="-1493237760" color2="0" visible="TRUE" picname="" categoryid="1"/&gt;
&lt;ROW id="2" name="Prueba Polygon" descr="06/04/2015 10:16:25" scale1="2" scale2="0" lonlatarr="ANBXOtEeN48FwABAFiGe6lSzBMD89hIAANBXOlGPN48FwAAoQlXdQGKzBMD89hIAANBXOtELLI8FwACAC5X1IGKzBMD89hIAANBXOlEUK48FwACA1erKqlSzBMD89hIAANBXOtEeN48FwABAFiGe6lSzBMD89hIAANBXOtEeN48FwABAFiGe6lSzBMD89hIA" lonL="-71.6085152991981" latT="-44.83268277223885" LonR="-71.58413938367076" LatB="-44.84595056374432" color1="-1509949440" color2="872415231" visible="TRUE" picname="" categoryid="1"/&gt;
&lt;/ROWDATA&gt;&lt;/DATAPACKET&gt;
</code></pre>
<p>As you can see there is a tag named "ROW" in which are the "shapes". I tried to rewrite it for my own data, but the actual array of points is codified. Searching in the web I found that it is a Base64 encoding (Delphi). And I don't have a clue about it. I read a little about it, but is quit complex. My specific questions are:
- Could I make the Base64 encoding in any language? or have to use Delphi only?
- If so, does anyone have the code in python?</p>
<p>Thank you!</p>
</div>
<div class="post-text" itemprop="text">
<p>Decoding base64 data is quite simple.</p>
<pre><code>In [1]: import base64

In [2]: lonlatarr = base64.b64decode("ANBXOtFZZY8FwABITxpq702zBMAgSCcJANBXOlGCU48FwABA1S48rk+zBMAgSCcJANBXOlEvPY8FwACo0VkXqlWzBMAgSCcJANBXOtGRPI8FwADYDRHFYGKzBMAgSCcJ")

In [3]: len(lonlatarr)
Out[3]: 96

In [4]: lonlatarr[0:9]
Out[4]: b'\x00\xd0W:\xd1Ye\x8f\x05'
</code></pre>
<p>Interpreting what is <em>means</em> is more difficult.</p>
<p>Notice the regularity in the data:</p>
<pre><code>In [18]: lonlatarr[0:4], lonlatarr[24:28], lonlatarr[48:52]
Out[18]: (b'\x00\xd0W:', b'\x00\xd0W:', b'\x00\xd0W:')

In [19]: len(lonlatarr)
Out[19]: 96

In [20]: lonlatarr[41:48], lonlatarr[89:96]
Out[20]: (b"\xb3\x04\xc0 H'\t", b"\xb3\x04\xc0 H'\t")

In [21]: lonlatarr[17:24], lonlatarr[41:48], lonlatarr[89:96]
Out[21]: (b"\xb3\x04\xc0 H'\t", b"\xb3\x04\xc0 H'\t", b"\xb3\x04\xc0 H'\t")
</code></pre>
<p>A sequence begins with b'\x00\xd0W:' and ends with b"\xb3\x04\xc0 H'\t".
The data inbetween varies.
It could be that these mark the beginning and end of a longitude or latitude.
Or it could be that the beginning and end of the numbers are always the same because of their range and encoding.</p>
<p>Fortunately, the code for this program seems to be <a href="https://bitbucket.org/sas_team/sas.planet.src/src" rel="nofollow">available</a>.</p>
<p>Your file might have something to do with the <a href="https://bitbucket.org/sas_team/sas.planet.src/src/34172d26046b0303a7cb5c3813600f24ee39fa0c/Src/MarksDB/?at=default" rel="nofollow">MarksDB</a>? It's hard to tell.</p>
<p>It might be a good idea to contact the developers.</p>
</div>
<span class="comment-copy">Python provides the <a href="https://docs.python.org/3/library/base64.html" rel="nofollow noreferrer"><code>base64</code> module</a> for the encoding, but that's the easy part of the problem. You need to generate the proper binary data first. You'll probably want the <a href="https://docs.python.org/2/library/struct.html" rel="nofollow noreferrer"><code>struct</code> module</a> for that.</span>
<span class="comment-copy">I found the way to decode it, buy now I have a new problem, this is what I got: "\x00\xd0W:\xd1Ye\x8f\x05\xc0\x00HO\x1aj\xefM\xb3\x04\xc0 H'\t \x00\xd0W:Q\x82S\x8f\x05\xc0\x00@\xd5.&lt;\xaeO\xb3\x04\xc0 H'\t \x00\xd0W:Q/=\x8f\x05\xc0\x00\xa8\xd1Y\x17\xaaU\xb3\x04\xc0 H'\t \x00\xd0W:\xd1\x91&lt;\x8f\x05\xc0\x00\xd8\r\x11\xc5`b\xb3\x04\xc0 H'\t"  anyone has a clue about it?</span>
<span class="comment-copy">Thank you Mark, I saw your answer after my previous comment.</span>
<span class="comment-copy">A websearch would have told you all about base64.</span>
<span class="comment-copy">It seems to exceed for far my knowledge. If anyone could help with this, It would be great. Thanks</span>
