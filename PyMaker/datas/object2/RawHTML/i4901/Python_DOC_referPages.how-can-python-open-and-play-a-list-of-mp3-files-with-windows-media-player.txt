<div class="post-text" itemprop="text">
<p>I want to use Python to open and play a list of .mp3 files on Windows Media Player.  I have been able to open a single file with:</p>
<pre><code>os.startfile(path_to_file)
</code></pre>
<p>but I would like to open an entire playlist.  This would be akin to selecting all the files in a folder, right clicking and selecting 'Add to Windows Media Player list'.  I would envision something like:</p>
<pre><code>for i in range(NumberOfSongs): 
    os.startfile(Files[i])
</code></pre>
<p>but this simply cycles through the tracks until the last one and plays that track only.  Does anyone know how to use this function with a list of files or another function that would open media player and add a list of files to it?  </p>
</div>
<div class="post-text" itemprop="text">
<p><a href="https://docs.python.org/3/library/os.html#os.startfile" rel="nofollow noreferrer">os.startfile</a> is going to just open the file with the default associated program, akin to what happens when you double click it.  There is a couple things you can try.  </p>
<p>You can try to create a <code>.m3u</code> playlist file.  Iterate over the files and programmatically create it.  I recommend looking up the exact details, but they will look something like this:</p>
<pre><code>#EXTM3U
#EXTINF:1,Artist - Song title 1
D:\path\to\file\01 Song.mp3
#EXTINF:1,Artist - Song title 2
D:\path\to\file\02 Song.mp3
</code></pre>
<p>This file also has an associated program, so you can then open it with <code>os.startfile</code>.  The number after <code>EXTINF</code> is the length of the track in seconds.  It does not appear strictly necessary to have this correct as players I tried would display the correct time.  WMP did not seem to like a value of 0, though, so a value of at least 1 should probably be used.  The path can either be absolute or relative.</p>
<p>There is also <a href="https://en.wikipedia.org/wiki/M3U#M3U8" rel="nofollow noreferrer">.m3u8</a> which is the UTF-8 version if you need that.</p>
<hr/>
<p>The other option you have is to try to find the command to execute to add to the WMP playlist. <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/dd562624(v=vs.85).aspx" rel="nofollow noreferrer">This</a> appears to be the commands available for WMP.  You maybe want that <code>/Task NowPlaying</code> one? They do not have a full example of using it and not clear if you can mix that with opening a file.</p>
<p>Once you know the task and get that working from just the command line, you can try to execute it with something from the <a href="https://docs.python.org/3/library/subprocess.html" rel="nofollow noreferrer">subprocess</a> module.  Depending on your python version:</p>
<pre><code>import shlex
import subprocess
from subprocess import PIPE

command = 'wmplayer "c:\filename.wma"'
subprocess.run(shlex.split(command), stdout=PIPE, stderr=PIPE)
</code></pre>
<p>Don't quote me on those quotes as I do not exactly have the environment to run this, but should be something close to that.  You may or may not want the <code>stdout=PIPE, stderr=PIPE</code>.  That will capture the out and err output so you could print them if you wanted but can also be troublesome if the output is large.</p>
</div>
<span class="comment-copy">Thanks!  It turns out m3u files are super simple so I just created that and like you said, it opens in WMA and plays all the songs.</span>
<span class="comment-copy">@Casivio Welcome and glad to hear it!</span>
