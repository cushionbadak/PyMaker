<div class="post-text" itemprop="text">
<p>I have an interesting behavior happening with my program.</p>
<p>i have the following methods:</p>
<pre><code>def getMarket(self, Currency):
    return self.public_api('GetMarket/' + Currency + '_BTC')

def getBalance(self, Currency):
    self.api_params.clear()
    self.api_params['Currency'] = Currency
    return self.private_api('GetBalance')
</code></pre>
<hr/>
<pre><code>my_api = buyBot(API_KEY, API_SECRET)


pumpCoin = my_api.getMarket('OSC')
pumpRawRate = pumpCoin['Data']['High']
pumpRawQty = .02
pumpBuyRate = my_api.calculateBuy(pumpRawRate)
pumpQty = float(pumpRawQty)/float(pumpBuyRate)
pumpSellRate = pumpCoin['Data']['Low']

pumpSellCoin = my_api.getBalance('OSC')


pumpSellAmount = pumpSellCoin["Data"]["Total"]

print str(pumpRawRate) + '\n' + str(pumpBuyRate) + '\n' + str(pumpSellRate) + '\n' + str(pumpQty) + '\n' + str(pumpSellAmount)`
</code></pre>
<p>From section: <code>pumpCoin = my_api.getMarket('OSC')</code> to <code>pumpSellRate = pumpCoin['Data']['Low']</code>, i have no problems getting the information and working with it.</p>
<p>Problem seems to be starting with line: <code>pumpSellCoin = my_api.getBalance('OSC')</code> </p>
<p>I get the following Error message:</p>
<pre><code>  Traceback (most recent call last):
  File "C:\XXXXXX.py", line 92, in &lt;module&gt;
    pumpSellAmount = pumpSellCoin["Data"]["Total"]
TypeError: string indices must be integers, not str
</code></pre>
<p>if i run: <code>print (my_api.getBalance('OSC')</code>, i am able to see all the private API information that is retrieved by that call, however i am not sure why it is giving me a problem when i try to call 1 specific item in the stack.</p>
<p>Let me know if you need any more information on this.</p>
<p>Any help will be greatly appreciated.</p>
<p>I have looked at the other posts and so far i can't seem to figure out the exact cause.</p>
<p>This is the private_api code</p>
<pre><code>def private_api(self, meth):
    time.sleep(1)
    params = self.api_params
    url = self.apisite + meth
    nonce = str(int(time.time()))
    post_data = json.dumps(params)
    hash = hashlib.md5()
    hash.update(post_data)
    base64hash = base64.b64encode(hash.digest())
    sig = self.apikey + "POST" + urllib.quote_plus(url).lower() + nonce + base64hash
    hmacsig = base64.b64encode(hmac.new(base64.b64decode(self.apisecret), sig, hashlib.sha256).digest())
    hdr = "amx " + self.apikey + ":" + hmacsig + ":" + nonce
    headers = { 'Authorization': hdr, 'Content-Type':'application/json; charset=utf-8' }
    request = urllib2.Request(url, data=post_data, headers=headers)
    return urllib2.urlopen(request).read()
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Please add this to your code:</p>
<pre><code>print('pumpSellCoin', type(pumpSellCoin["Data"]), type(pumpSellCoin["Data"]["Total"]))
pumpSellAmount = pumpSellCoin["Data"]["Total"]
</code></pre>
<p>This will show you that one of your variables is a list or a string and not a dictionary and you need to access is using a number and not a name like <code>"Data"</code> or <code>"Total"</code></p>
<p>Try this example:</p>
<pre><code>test = 'abcde'
print(type(test))
print(test[0])
print(test[2:4])
print(test['whatever']) # this results in TypeError: string indices must be integers
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>if i run the program as follows:</p>
<pre><code>    my_api = buyBot(API_KEY, API_SECRET)


pumpCoin = my_api.getMarket('OSC')
pumpRawRate = pumpCoin['Data']['High']
pumpRawQty = .02
pumpBuyRate = my_api.calculateBuy(pumpRawRate)
pumpQty = float(pumpRawQty)/float(pumpBuyRate)
pumpSellRate = pumpCoin['Data']['Low']

pumpSellBal = my_api.getBalance('OSC')

print pumpSellBal


#print('pumpSellBal', type(pumpSellBal["Data"]), type(pumpSellBal["Data"]["Total"]))


#pumpSellAmount = pumpSellBal['Data']['Total']

print str(pumpRawRate) + '\n' + str(pumpBuyRate) + '\n' + str(pumpSellRate) + '\n' + str(pumpQty) #+ '\n' + str(pumpSellAmount)
</code></pre>
<p>i get the following results:</p>
<pre><code>{"Success":true,"Error":null,"Data":[{"CurrencyId":235,"Symbol":"OSC","Total":8561.03652012,"Available":0.00000000,"Unconfirmed":0.00000000,"HeldForTrades":8561.03652012,"PendingWithdraw":0.00000000,"Address":null,"Status":"OK","StatusMessage":null,"BaseAddress":null}]}
1.61e-06
2.415e-06
1.25e-06
8281.57349896
</code></pre>
<p>So i am definitely able to communicate back and forward, however the issue only seems to be when i try to work with a single piece of information from pumpSellBal = my_api.getBalance('OSC')</p>
</div>
<span class="comment-copy">What is <code>my_api.getBalance('OSC')</code>, and what is its type and structure?</span>
<span class="comment-copy"><a href="https://docs.python.org/3/tutorial/errors.html#handling-exceptions" rel="nofollow noreferrer">Catch the error</a> and inspect/print relevant data in the except suite.  Or just inspect/print <code>pumpSellCoin</code> prior to the offending line.  Is it what you expect it to be? The Traceback seems to imply that it is a string.</span>
<span class="comment-copy">The implementation of <code>self.private_api</code> is critical here, and you haven't provided it. We can't help you without a <a href="https://stackoverflow.com/help/mcve">Minimal, Complete, and Verifiable example</a>.</span>
<span class="comment-copy">This is the stack {     "Success":true,     "Error":null,     "Data":[             {                 "CurrencyId":1,                 "Symbol":"BTC",                 "Total":"10300",                 "Available":"6700.00000000",                 "Unconfirmed":"2.00000000",                 "HeldForTrades":"3400,00000000",                 "PendingWithdraw":"200.00000000",                 "Address":"Address", 		"BaseAddress": "Address",                 "Status":"OK",                 "StatusMessage":""             },             {                 ...             }            ] }</span>
<span class="comment-copy">Hi Joe.  I changed the variable to: pumpSellBal since that is what i am using, but i received the same error message. Traceback (most recent call last):   File "C:\XXXXX.py", line 92, in &lt;module&gt;     print('pumpSellBal', type(pumpSellBal["Data"]), type(pumpSellBal["Data"]["Total"])) TypeError: string indices must be integers, not str</span>
<span class="comment-copy">Please check the type of all variables and see if you are at some point applying a <code>['whatever']</code> to a string. This is what your error message indicates.</span>
<span class="comment-copy">i got the following modified to my code:   '{"Success":true,"Error":null,"Data":[{"CurrencyId":44,"Symbol":"OK","Total":0.00000000,"Available":0.00000000,"Unconfirmed":0.00000000,"HeldForTrades":0.00000000,"PendingWithdraw":0.00000000,"Address":null,"Status":"OK","StatusMessage":null,"BaseAddress":null}]}   &lt;type 'str'&gt; { Su  Traceback (most recent call last):   File "C:\XXX.py", line 110, in &lt;module&gt;     print(pumpSellBal['Data']) TypeError: string indices must be integers, not str'</span>
<span class="comment-copy">Thank you for your help.  I used your Test Code above to check what the difference between the pumpCoin = my_api.getMarket(coinP) &amp; pumpSellBal = my_api.getBalance(coinP) is and found the first one is a dictionary which is why it works with my code, and the second is a string.  I'll need to figure out how to call on the value i need from here.  Thank you again for your help</span>
