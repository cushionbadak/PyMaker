<div class="post-text" itemprop="text">
<p>In the below dataframe I have a list of values, how can we get the top 2 repeated from a list ?</p>
<p>DataFrame:</p>
<pre><code>user    pro
A   [AA,AA,AA,BB,CC,AA,AA,CC,CC,BB]
B   [AA, BB, EE,BB,BB,EE,AA,CC,BB,EE]
C   [EE,EE,EE,CC,CC,CC,CC,DD,DD,AA]
D   [DD,AA,AA,AA,AA,AA,BB,BB,BB]
</code></pre>
<p>Expected output:</p>
<pre><code>A   [AA,CC]
B   [BB,EE]
C   [CC,EE]
D   [AA,BB]
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use <a href="https://docs.python.org/3/library/collections.html#collections.Counter.most_common" rel="nofollow noreferrer"><code>collections.Counter.most_common</code></a>:</p>
<pre><code>from collections import Counter

df['new']  = df['pro'].apply(lambda x: [k for k, v in Counter(x).most_common(2)])
print (df)
  user                                       pro       new
0    A  [AA, AA, AA, BB, CC, AA, AA, CC, CC, BB]  [AA, CC]
1    B  [AA, BB, EE, BB, BB, EE, AA, CC, BB, EE]  [BB, EE]
2    C  [EE, EE, EE, CC, CC, CC, CC, DD, DD, AA]  [CC, EE]
3    D      [DD, AA, AA, AA, AA, AA, BB, BB, BB]  [AA, BB]
</code></pre>
<p>Thanks @jpp:</p>
<pre><code>df['common'] = [list(zip(*d.most_common(2)))[0] for d in df['pro'].map(Counter)]
</code></pre>
<p>Thanks @cᴏʟᴅsᴘᴇᴇᴅ:</p>
<pre><code>df['common'] = df.pro.map(lambda x: [k for k, v in Counter(x).most_common(2)])
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Not being aware about <a href="https://docs.python.org/3/library/collections.html#collections.Counter.most_common" rel="nofollow noreferrer">collections.Counter.most_common</a> I came up with:</p>
<pre><code>from collections import Counter
df['result'] = df['pro'].apply(lambda x: [i[0] for i in sorted(Counter(x).items(), key=lambda x: -x[1])[:2]])
</code></pre>
</div>
<span class="comment-copy">Are you using <code>pandas</code>?</span>
<span class="comment-copy">yes, Am using pandas</span>
<span class="comment-copy">Alternative syntax (if you're doing a list comprehension you might not want <code>apply</code> too): <code>df['common'] = [list(zip(*d.most_common(2)))[0] for d in df['pro'].map(Counter)]</code></span>
<span class="comment-copy">You could combine the two and do <code>df.pro.map(lambda x: [k for k, v in Counter(x).most_common(2)])</code></span>
