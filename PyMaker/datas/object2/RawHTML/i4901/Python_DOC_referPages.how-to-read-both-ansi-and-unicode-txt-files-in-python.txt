<div class="post-text" itemprop="text">
<p>I'm new to python and face a strange problem:</p>
<p>When I have 50 txt files in a directory, I want to read each .txt file and save its content in a unique variable like:</p>
<pre><code>**file = open(fcf[i], 'r')
text[i] = file.read()**
</code></pre>
<p>When I only read one file, it's ok:</p>
<pre><code>count = 0
for file_flag in fcf:
    if file_flag == 'feature.txt':
        file = open(fcf[count], 'r')
        features = file.read().split() # a list, word by word
    count = count+1
</code></pre>
<p>However, to read txt files in a loop, it's wrong: </p>
<p>Below is my code and a very strange error comes up,</p>
<pre><code>**text = np.zeros((np.shape(fcf)[0],1))
for flag in range(np.shape(fcf)[0]):
    file = open(fcf[flag], 'r')
    text = file.read() # string
    file.close()**

---------------------------------------------------------------------------
UnicodeDecodeError                        Traceback (most recent call last)
&lt;ipython-input-41-7e544d88ee9d&gt; in &lt;module&gt;()
      2 for flag in range(np.shape(fcf)[0]):
      3     file = open(fcf[flag], 'r')
----&gt; 4     text = file.read() # string
      5     file.close()

**UnicodeDecodeError: 'gbk' codec can't decode byte 0x94 in position 418: illegal multibyte sequence**
</code></pre>
<p><strong>Update:</strong></p>
<p>in a loop form:</p>
<pre><code>file = open(fcf[flag], 'r', encoding='UTF-8')
</code></pre>
<p>the error also occurs: </p>
<pre><code>UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 418: invalid start byte
</code></pre>
<p>Could anyone help me? Thank you very much!</p>
<p><strong>Update2:</strong> </p>
<p>It seems that in these .txt files, most of them are in Unicode, which is durable for python. I find that, in notepad, there are 2 .txt file in ANSI encoding, which leads to this problem.</p>
<p>How could I read both ANSI and Unicode together in python?</p>
<p><strong>Update3:</strong></p>
<p>Thanks everyone. This problem is fixed.</p>
<p>There are 2 reasons for this problem:</p>
<ol>
<li><p>some ANSI txt files are in overall UTF8 files.</p></li>
<li><p>some weird matches appears on ANSI encoding:</p></li>
</ol>
<p>didn’t - didn抰
weren’t - weren抰, etc. (‘n -&gt; 抰)
("Well - 揥ell)</p>
<p>although my PC is in English language totally, this problem still happens for ANSI txt. (manually modification is needed since notepad only change the encoding, not the above weird character...)</p>
<p>Hope it helps for other people facing the similar problem. Thx</p>
</div>
<div class="post-text" itemprop="text">
<p>You open your file in default text mode. When reading it, Python tries to decode it, using the default encoding for your platform, which seems to be 'gbk'.
Apparently, the file you're trying to read uses another encoding, which causes this error.</p>
<p>You have to indicate the encoding to use in <code>open</code>. If it is 'UTF-8', for example:</p>
<pre><code>file = open(fcf[flag], 'r', encoding='UTF-8')
</code></pre>
<p>If your file uses a different encoding, you must figure it out first, I don't know what is common in your part of the world. You can have a look at <a href="https://docs.python.org/3/library/codecs.html#standard-encodings" rel="nofollow noreferrer">the list of standard encodings</a>.</p>
<p>For chinese, the listed encodings are 'gb2312', 'gb18030', 'hz', you could try with these ones. </p>
</div>
<span class="comment-copy">Possible duplicate of <a href="https://stackoverflow.com/questions/4545661/unicodedecodeerror-when-redirecting-to-file">UnicodeDecodeError when redirecting to file</a>? Also many more related questions just when <a href="https://stackoverflow.com/search?q=UnicodeDecodeError">searching the site</a>.</span>
<span class="comment-copy">hi Kevin, the link you offers looks confusing... could you help me more?</span>
<span class="comment-copy">Try <code>open(fcf[flag], 'r', encoding='UTF-8')</code>. <a href="https://stackoverflow.com/a/20994462/8811872">Source</a></span>
<span class="comment-copy">Thanks Kevin! a similar error comes up again. I update more details on the question. When I read a single txt file, it's ok. It gives me an error when I use a loop to read multiple files.</span>
<span class="comment-copy">You need some way to determine the encoding. Do the UTF8 files all have a BOM?</span>
<span class="comment-copy">Thank you Thierry! the same problem appearsT _ T   could you figure out why?   UnicodeDecodeError: 'utf-8' codec can't decode byte 0x94 in position 418: invalid start byte;</span>
<span class="comment-copy">Your file is not encoded in UTF8 either, check the updated answer.</span>
<span class="comment-copy">Thanks Thierry! My PC is totally in English and all txt are in English. I find that 2 files among the directory are in ANSI encoding, which gives the error.  how could I read ANSI... the error says "unknown encoding: ANSI" T_T</span>
