<div class="post-text" itemprop="text">
<p>I have some python code that I've been tasked with unit testing that had different branches for different OS's. For example:</p>
<pre><code>if sys.platform == 'win32':
    #DoSomething

if sys.platform == 'linux2':
    #DoSomethingElse
</code></pre>
<p>I want to unit test both paths. Is there some way to temporarily change the sys.platform?</p>
<p>Please let me know if I can provide any more information.</p>
</div>
<div class="post-text" itemprop="text">
<p>Well, you could simply do <code>sys.platform = 'win32'</code>, but it is quite ugly solution so instead try the <a href="https://docs.python.org/3/library/unittest.mock.html" rel="nofollow noreferrer"><code>mock</code></a> module (it has been ported to python2 too).</p>
<pre><code>&gt;&gt;&gt; # in the test's setup code
&gt;&gt;&gt; from unittest import mock  # or just "import mock"
&gt;&gt;&gt; sys = mock.MagicMock()
&gt;&gt;&gt; sys.configure_mock(platform='win32')
&gt;&gt;&gt;
&gt;&gt;&gt; sys.platform
&gt;&gt;&gt; 'win32'
</code></pre>
<p>This way of course you will have to create separate test cases for the operating systems.</p>
<p>If you want to test it on 'real' OSs, use a Continuous Integration (CI) software. They can be configured to run tests on different operating systems.  </p>
</div>
<span class="comment-copy">Suppose you do find a way to spoof the platform. If you're testing on Windows, wouldn't the <code>linux2</code> unit tests fail anyway, because they depend on the behavior of an OS you're not using?</span>
<span class="comment-copy">Not in this case. The testing that actually deals with the operations is done elsewhere.</span>
