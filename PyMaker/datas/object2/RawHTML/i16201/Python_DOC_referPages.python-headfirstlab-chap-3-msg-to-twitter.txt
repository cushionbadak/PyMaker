<div class="post-text" itemprop="text">
<pre><code>import urllib.request 
import time 

def send_to_twitter(msg):
    password_manager = urllib.request.HTTPPasswordMgr()
    password_manager.add_password("Twitter API", "http://twitter.com/statuses", "*****", "*****")
    http_handler = urllib.request.HTTPBasicAuthHandler(password_manager)
    page_opener = urllib.request.build_opener(http_handler)
    urllib.request.install_opener(page_opener)
    params = urllib.parse.urlencode( {'status': msg} )
    resp = urllib.request.urlopen("http://twitter.com/statuses/update.json", params)
    resp.read()

def get_price():
    page = urllib.request.urlopen("file:///C:/Users/Troll/Documents/lol/Chap%202/offlineV.html")
    text = page.read().decode("utf8")
#finder og assigner index for '&gt;$'
    where = text.find('&gt;$')
#sop-start of price // eop-end of price
    sop = where + 2
    eop = sop + 4
    return float(text[sop:eop])

price_now = input("Do you want to see the price now (Y/N)?")

if price_now == "Y":
    send_to_twitter(get_price())
else:
    price = 99.99
    while price &gt; 4.74:
        time.sleep(15)
        price = get_price()
    send_to_twitter("Buy!")
</code></pre>
<p><em>Error</em></p>
<pre><code>Traceback (most recent call last):
  File "C:\Users\Troll\Documents\lol\Chap 3\chap3.py", line 27, in &lt;module&gt;
    send_to_twitter(get_price())
  File "C:\Users\Troll\Documents\lol\Chap 3\chap3.py", line 11, in send_to_twitter
    resp = urllib.request.urlopen("http://twitter.com/statuses/update.json", params)
  File "C:\Python34\lib\urllib\request.py", line 153, in urlopen
    return opener.open(url, data, timeout)
  File "C:\Python34\lib\urllib\request.py", line 453, in open
    req = meth(req)
  File "C:\Python34\lib\urllib\request.py", line 1120, in do_request_
    raise TypeError(msg)
TypeError: POST data should be bytes or an iterable of bytes. It cannot be of type str.
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>You need to:</p>
<ul>
<li>Convert the output of <code>urlencode()</code> to bytes before sending to <code>urlopen()</code>.</li>
<li>Decode the response accordingly</li>
</ul>
<p>So the code looks like:</p>
<pre><code>def send_to_twitter(msg):
    password_manager = urllib.request.HTTPPasswordMgr()
    password_manager.add_password("Twitter API", "http://twitter.com/statuses", "*****", "*****")
    http_handler = urllib.request.HTTPBasicAuthHandler(password_manager)
    page_opener = urllib.request.build_opener(http_handler)
    urllib.request.install_opener(page_opener)

    params = urllib.parse.urlencode( {'status': msg} )
    params = params.encode('utf-8') # Encode with utf-8

    resp = urllib.request.urlopen("http://twitter.com/statuses/update.json", params)
    resp.read().decode('utf-8') # Decode using utf-8
</code></pre>
<p><a href="https://docs.python.org/3/library/urllib.request.html#urllib-examples" rel="nofollow">Check</a> how to correctly do <code>POST</code> using <code>urllib</code></p>
</div>
<span class="comment-copy">I suppose the twitter API has changed since the chapter was written. You can easily verify it yourself by just opening the url used in your sample code: <a href="http://twitter.com/statuses/update.json" rel="nofollow noreferrer">twitter.com/statuses/update.json</a></span>
