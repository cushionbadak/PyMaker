<div class="post-text" itemprop="text">
<p>I would like to convert columns to subcolumns.</p>
<p>Supposing that data is like;</p>
<pre><code>    Q1  Q2:Q21  Q2:Q22 Q2:Q23 Q3:Q31 Q3:Q32
0  yes   green    blue  green    bus    car
1   no     red  orange   blue    car   bike
2  yes   green  yellow  black    car   walk
3  yes  yellow   green  brown    bus   walk
4   no   green   green    red    car    bus
</code></pre>
<p>After reshaping the columns, I would like to have;</p>
<pre><code>    Q1              Q2               Q3
    Q1     Q21     Q22    Q23    Q31    Q32
0  yes   green    blue  green    bus    car
1   no     red  orange   blue    car   bike
2  yes   green  yellow  black    car   walk
3  yes  yellow   green  brown    bus   walk
4   no   green   green    red    car    bus
</code></pre>
<p>Here, what I tried;</p>
<pre><code>import pandas as pd
survey = pd.read_csv('survey.csv')
# first column names
survey_cols = [col.split(':')[0] for col in survey.columns]
# unique column names
survey_ucols = []
for e in survey_cols:
    if e not in survey_ucols:
        survey_ucols.append(e)
# second column names, subcolumns
survey_subcols = []
for col in survey_ucols:
    survey_subcols.append([subcol.split(':')[-1] for subcol in survey.columns if col in subcol])
# create new df
tuples = list(zip(survey_ucols,survey_subcols))
cols = pd.MultiIndex.from_tuples(tuples, names=['mainQ', 'subQ'])
survey_new = pd.DataFrame(survey, columns=cols)
</code></pre>
<p>Thanks in advance</p>
</div>
<div class="post-text" itemprop="text">
<p>You can create helper DataFrame with <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Index.to_series.html" rel="nofollow noreferrer"><code>Index.to_series</code></a> and <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.split.html" rel="nofollow noreferrer"><code>Series.str.split</code></a>, so possible forward filling missing values per rows by <code>ffill</code>, last assign back <a href="http://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.MultiIndex.from_arrays.html" rel="nofollow noreferrer"><code>MultiIndex.from_arrays</code></a>:</p>
<pre><code>df = survey.columns.to_series().str.split(':', expand=True).ffill(axis=1)
survey.columns = pd.MultiIndex.from_arrays([df[0].tolist(), df[1].tolist()])
#simplified
#survey.columns = [df[0].tolist(), df[1].tolist()]
print (survey)
    Q1      Q2                  Q3      
    Q1     Q21     Q22    Q23  Q31   Q32
0  yes   green    blue  green  bus   car
1   no     red  orange   blue  car  bike
2  yes   green  yellow  black  car  walk
3  yes  yellow   green  brown  bus  walk
4   no   green   green    red  car   bus
</code></pre>
<p><strong>Detail</strong>:</p>
<pre><code>print (df)
         0    1
Q1      Q1   Q1
Q2:Q21  Q2  Q21
Q2:Q22  Q2  Q22
Q2:Q23  Q2  Q23
Q3:Q31  Q3  Q31
Q3:Q32  Q3  Q32
</code></pre>
</div>
<span class="comment-copy">If my answer was helpful, don't forget accept it. To mark an answer as accepted, click on the check mark beside the answer to toggle it from hollow to green (<a href="https://meta.stackexchange.com/a/5235">see screenshot</a>). Thank you.</span>
<span class="comment-copy">@yatu - Thank you :)</span>
