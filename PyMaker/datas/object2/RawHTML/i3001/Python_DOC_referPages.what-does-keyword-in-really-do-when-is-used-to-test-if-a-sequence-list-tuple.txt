<div class="post-text" itemprop="text">
<p>given the following code:</p>
<pre><code>numbers= [1,2,3,1,2,4,5]
if 5 in numbers:
    .................
</code></pre>
<p>we can notice we have a list(<code>numbers</code>) with 7 items and I want to know if the keyword <code>in</code> behind the scene do a loop for find a match in the list</p>
</div>
<div class="post-text" itemprop="text">
<p>For container types in general, this is documented under <a href="https://docs.python.org/3/reference/datamodel.html#object.__contains__" rel="nofollow noreferrer"><code>__contains__</code></a> in the data model chapter and <a href="https://docs.python.org/3/reference/expressions.html#membership-test-details" rel="nofollow noreferrer">Membership test operations</a> in the expressions chapter.</p>
<p>When you write this:</p>
<pre><code>x in s
</code></pre>
<p>… what Python does is effectively (slightly oversimplified):</p>
<pre><code>try:
    return s.__contains__(x)
except AttributeError:
    for value in s:
        if value == x:
            return True
    return False
</code></pre>
<p>So, any type that defines a <code>__contains__</code> method can do whatever it wants; any type that doesn't, Python automatically loops over it as an iterable. (Which in turn calls <code>s.__iter__</code> if present, the old-style sequence API with <code>s.__getitem__</code> if not.)</p>
<hr/>
<p>For the builtin sequence types <code>list</code> and <code>tuple</code>, the behavior is defined under <a href="https://docs.python.org/3/library/stdtypes.html#sequence-types-list-tuple-range" rel="nofollow noreferrer">Sequence Types — <code>list</code>, <code>tuple</code>, <code>range</code></a> and (again) <a href="https://docs.python.org/3/reference/expressions.html#membership-test-details" rel="nofollow noreferrer">Membership test operations</a>:</p>
<blockquote>
<p><code>True</code> if an item of <code>s</code> is equal to <code>x</code>, else <code>False</code></p>
</blockquote>
<p>… which is exactly the same as the fallback behavior.</p>
<p>Semantically:</p>
<blockquote>
<p>For container types such as <code>list</code>, <code>tuple</code>, <code>set</code>, <code>frozenset</code>, <code>dict</code>, or <code>collections.deque</code>, the expression <code>x in y</code> is equivalent to <code>any(x is e or x == e for e in y)</code>.</p>
</blockquote>
<p>Fpr <code>list</code> and <code>tuple</code>, this is in fact implemented by looping over all of the elements, and it's hard to imagine how it could be implemented otherwise. (In CPython, it's slightly faster because it can do the loop directly over the underlying array, instead of using an iterator, but it's still linear time.)</p>
<p>However, some other builtin types do something smarter. For example:</p>
<ul>
<li><code>range</code> does the closed-form arithmetic to check whether the value is in the range in constant time.</li>
<li><code>set</code>, <code>frozenset</code>, and <code>dict</code> use the underlying hash table to look up the value in constant time.</li>
</ul>
<hr/>
<p>There are some third-party types, like sorted-dict collections based on trees or skiplists or similar, that can't search in constant time but can search in logarithmic time by walking the tree. So, they'll (hopefully) implement <code>__contains__</code> in logarithmic time.</p>
<hr/>
<p>Also note that if you use the ABC/mixin helpers in <a href="https://docs.python.org/3/library/collections.abc.html" rel="nofollow noreferrer"><code>collections.abc</code></a> to define your own <code>Sequence</code> or <code>Mapping</code> type, you get a <code>__contains__</code> implementation for free. For sequences, this works by iterating over all the elements; for mappings, it works by <code>try: self.[key]</code>.</p>
</div>
<div class="post-text" itemprop="text">
<p>It depends. It will call <code>__contains__()</code> on the container class (right side) - that can be implemented as a loop, and for some classes it can be calculated by some other faster method if possible.</p>
<p>You can even define it on your own class, like this ilustrative example:</p>
<pre><code>class ContainsEverything:
    def __contains__(self, item):
        return True

c = ContainsEverything()

&gt;&gt;&gt; None in c
True
&gt;&gt;&gt; 4 in c
True
</code></pre>
</div>
