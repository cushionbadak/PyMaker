<div class="post-text" itemprop="text">
<p>I am writing a python script to automate some simulations with Aspen Plus via its COM functions. But when I want to get access to molecular weights values, I have to write something like this:</p>
<pre><code>import os
import win32com.client as win32

aspen = win32.Dispatch('Apwn.Document')

aspen.InitFromArchive2(os.path.abspath('Aspen\\Flash.bkp'))

MW = aspen.Tree.Data.Properties.Parameters.Pure Components.REVIEW-1.Input.VALUE.MW ACID.Value
</code></pre>
<p>But it launchs a syntax error in REVIEW-1, due to hyphens can not be used as identifiers. How can I use them like that?</p>
<p>EDIT:</p>
<p>I replaced dot synax for FindNode function of Aspen COM like that:</p>
<pre><code>MW = aspen.Tree.FindNode("\\Data\\Properties\\Parameters\\Pure Components\\REVIEW-1")
</code></pre>
<p>But I still get a None object, however this:</p>
<pre><code>MW = aspen.Tree.FindNode("\\Data\\Properties\\Parameters\\Pure Components")
</code></pre>
<p>works, getting the "COMObject FindNode" so I think that the problem is in the hyphen as well.</p>
<p>Thanks in advance!</p>
</div>
<div class="post-text" itemprop="text">
<p>Thanks for the tip </p>
<p>For cases of having hyphens, the following should work instead of escaping the "\" character:</p>
<pre><code>MW = aspen.Tree.FindNode(r'\Data\Properties\Parameters\Pure Components\REVIEW-1\Input\VALUE')
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Ok, I was breaking my head trying to solve it in Python, but was easier solving it in Aspen renaming the node. I've noticed, also, that spaces sometimes give problems too, so should be renamed as well. In some cases it can't be done or I don't know how, for example:</p>
<pre><code>MW = aspen.Tree.FindNode("\\Data\\Properties\\Parameters\\Pure Components\\REVIEW1\\Input\\VALUE\\MW ACID")
</code></pre>
<p>It returns a None object and I don't know hot to rename "MW ACID", but there is a tricky way to get the value:</p>
<pre><code>MW = aspen.Tree.FindNode("\\Data\\Properties\\Parameters\\Pure Components\\REVIEW1\\Input\\VALUE")

for o in MW.Elements:
    if o.Name == "MW ACID":
        MW_acid = o.Value
</code></pre>
<p>For now it works for me, however it will be slower due to iteration. So if someone knows how to solve the problem in Python without renaming names, it will be still helpful. I tried to use unicode and bytes notation for non-breaking hyphen but it didn't works too.</p>
<p>Regards!</p>
</div>
<span class="comment-copy">prior to that there are spaces as well. using dashes and spaces in identifiers are just not valid python</span>
<span class="comment-copy">Have you tried using importlib? <a href="https://docs.python.org/3/library/importlib.html#importlib.import_module" rel="nofollow noreferrer">docs.python.org/3/library/â€¦</a></span>
<span class="comment-copy">I'll take a look to importlib, but could it be used with COM functions?? Also, I updated my question with an edit if someone find an answer by this way</span>
<span class="comment-copy">can you list the available sub-nodes from the valid non-None node you're getting? I'm sure it's just a casing/hyphen type issue now</span>
<span class="comment-copy">[Maybe an image is more helpful][1]     [1]: <a href="https://i.stack.imgur.com/4AZtJ.png" rel="nofollow noreferrer">i.stack.imgur.com/4AZtJ.png</a></span>
<span class="comment-copy">Thanks Ejay! By the way, I am working with another simulation now and I don't have any problems with spaces or hyphens. So I don't understand anything!</span>
