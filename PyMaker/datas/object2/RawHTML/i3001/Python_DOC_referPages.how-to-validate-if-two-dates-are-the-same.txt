<div class="post-text" itemprop="text">
<p>How do I implement functionality where a user can only update an entry when the <code>date_created</code> and <code>date_modified</code> fields of the diary entry are the same?</p>
<p>This is what I have implemented.  I have compared the date_created field of the entry model in the db to <code>datetime.date.today()</code>.</p>
<p>Data model</p>
<pre><code>class DiaryEntry():

    def __init__(self):

        self.title = ''
        self.body = '' 
        self.date_modified = None
        self.date_created = datetime.date.today()



    def save(self, current_user_email):
        # insert data into db
        query = "INSERT INTO entries (owner_id, title, body, date_created, date_modified) \
                VALUES ((SELECT user_id from users where email ='{}'), '{}', '{}', '{}','{}')" \
                                                    . format(current_user_email,
                                                        self.title,
                                                        self.body,
                                                        self.date_created,
                                                        self.date_modified
                                                        )
        db.execute(query) 
</code></pre>
<p>Method</p>
<pre><code>def update_diary_entry(self,entry_id):
        query = "select * from entries where entry_id='{}'".format(entry_id)
        result = db.execute(query)
        entry = result.fetchone()
        data = request.get_json()
        date_created = entry[4]


        if date_created == datetime.date.today():


           query = "update entries set title='{}',body='{}' where entry_id='{}'"\
                                .format(data['title'], data['body'], int(entry_id))
           db.execute(query)
           return {'message': 'diary entry updated succesfully','date':date_created}, 406


         else:
           return {'message': 'diary entry can only be updated on the day it was created'}, 406
</code></pre>
<p>I am currently getting the second return statement.  What could I be doing wrong?</p>
</div>
<div class="post-text" itemprop="text">
<p>It looks like you have <code>date_created</code> as a string (str) within <code>update_diary_entry()</code>.  That will cause an invalid comparison to a Python <code>datetime.date</code> object unless you parse the string into the same type:</p>
<pre><code>&gt;&gt;&gt; import datetime
&gt;&gt;&gt; date_created = '2018-07-29'

&gt;&gt;&gt; date_created == datetime.date.today()
False

&gt;&gt;&gt; datetime.datetime.strptime(date_created, '%Y-%m-%d').date() == datetime.date.today()
True
</code></pre>
<p>The classmethod <code>strptime()</code> parses a string that looks like a date into a <code>datetime.datetime</code> object.  You need to then grab just the date component from this to enable the comparison that you want.  If you have a differently-formatted date-string, see <a href="https://docs.python.org/3/library/datetime.html#strftime-strptime-behavior" rel="nofollow noreferrer">strftime() and strptime() Behavior</a>.</p>
</div>
<span class="comment-copy"><code>print(type(date_created))</code> vs <code>print(type(datetime.date.today()))</code> - use <a href="https://ericlippert.com/2014/03/05/how-to-debug-small-programs/" rel="nofollow noreferrer">How to debug small programs (#1)</a>. Why not simply substitude the original date and disallow setting it through user?</span>
<span class="comment-copy">@BradSolomon ,date_created is a string.It references a row in the database.</span>
<span class="comment-copy">@PatrickArtner, can you offer more clarification ?</span>
<span class="comment-copy">you are comparing a string with a datetime object.Thats as if you would test if a real car is equal to its picture - they might look the same, but are not equal. either make both a string for comparison <i>or</i> make both datetime.date - objects. If you are set upon not allowing the date to be changed, simply do not show a datetime fiels in your frontend, you got the id, change only the diarys text, and do not change the date at all</span>
