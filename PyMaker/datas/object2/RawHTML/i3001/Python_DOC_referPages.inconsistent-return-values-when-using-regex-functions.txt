<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/3906137/why-cant-i-call-read-twice-on-an-open-file">Why can't I call read() twice on an open file?</a>
<span class="question-originals-answer-count">
                    7 answers
                </span>
</li>
<li>
<a dir="ltr" href="/questions/36572993/python-the-second-for-loop-is-not-running">Python : The second for loop is not running</a>
<span class="question-originals-answer-count">
                    1 answer
                </span>
</li>
</ul>
</div>
<p>My code is behaving strangely, and I have a feeling it has to do with the regular expressions i'm using. </p>
<p>I'm trying to determine the number of total words, number of unique words, and number of sentences in a text file.</p>
<p>Here is my code: </p>
<pre><code>import sys
import re

file = open('sample.txt', 'r')


def word_count(file):
    words = []
    reg_ex = r"[A-Za-z0-9']+"
    p = re.compile(reg_ex)
    for l in file:
        for i in p.findall(l):
            words.append(i)
    return len(words), len(set(words))

def sentence_count(file):
    sentences = []
    reg_ex = r'[a-zA-Z0-9][.!?]'
    p = re.compile(reg_ex)
    for l in file: 
        for i in p.findall(l):
            sentences.append(i)
    return sentences, len(sentences)

sentence, sentence_count = sentence_count(file)
word_count, unique_word_count = word_count(file)

print('Total word count:  {}\n'.format(word_count) + 
    'Unique words:  {}\n'.format(unique_word_count) + 
'Sentences:  {}'.format(sentence_count))
</code></pre>
<p>The output is the following:</p>
<pre><code>Total word count:  0
Unique words:  0
Sentences:  5
</code></pre>
<p>What is really strange is that if I comment out the <code>sentence_count()</code> function, the <code>word_count()</code> function starts working and outputs the correct numbers.</p>
<p>Why is this inconsistency happening? If I comment out either function, one will output the correct value while  the other will output 0's. Can someone help me such that both functions work?</p>
</div>
<div class="post-text" itemprop="text">
<p>The issue is that you can only iterate over an open file once. You need to either reopen or rewind the file to iterate over it again.</p>
<p>For example:</p>
<pre><code>with open('sample.txt', 'r') as f:
  sentence, sentence_count = sentence_count(f)
with open('sample.txt', 'r') as f:
  word_count, unique_word_count = word_count(f)
</code></pre>
<p>Alternatively, <code>f.seek(0)</code> would rewind the file.</p>
</div>
<div class="post-text" itemprop="text">
<p>Make sure to open and close your file properly. One way you can do this is by saving all the text first.</p>
<pre><code>with open('sample.txt', 'r') as f:
    file = f.read()
</code></pre>
<p>The <a href="https://docs.python.org/3/reference/compound_stmts.html#grammar-token-with_stmt" rel="nofollow noreferrer"><code>with</code></a> statement can be used to open and safely close the file handle. Since you would have extracted all the contents into <code>file</code>, you don't need the file open anymore.</p>
</div>
<span class="comment-copy">Add <code>contents = file.read()</code> and pass <code>contents</code> to your methods.</span>
<span class="comment-copy">thanks!  I definitely didn't know that you can only iterate over an open file once -- really helpful to know.</span>
