<div class="post-text" itemprop="text">
<p>I need to automate some pdf documents downloads with python and selenium. The preferences of chrome and firefox are already done to automate download, but I have a problem with this especific website, it does not download the document automatically, it opens a new tab</p>
<blockquote>
<p>website: <a href="http://sistemas.sefaz.ma.gov.br/certidoes/jsp/emissaoCertidaoNegativa/emissaoCertidaoNegativa.jsf" rel="nofollow noreferrer">http://sistemas.sefaz.ma.gov.br/certidoes/jsp/emissaoCertidaoNegativa/emissaoCertidaoNegativa.jsf</a>
  Select CPF/CNPJ and use this number to access the document 22977333000108.</p>
</blockquote>
<p>After filling the form I get the document in a new tab with the same url like on the screenshot <a href="https://i.stack.imgur.com/xaOIA.png" rel="nofollow noreferrer">Documment Screenshot</a> (Sorry, had to hide the documments numbers). If I manually download it and rename as PDF file it works fine.</p>
<p>How can I download it as a pdf file with selenium?</p>
<p>My code is like:</p>
<pre><code> urlForm = 'https://sistemas.sefaz.ma.gov.br/certidoes/jsp/emissaoCertidaoNegativa/emissaoCertidaoNegativa.jsf'
 #loading firefox webdriver with preferences
 driver = loadDriver( urlForm ) 

 #form filled

 # Clicking submit button
 btnSubmit = driver.find_element_by_id('form1:j_id28')
 btnSubmit.click()
 time.sleep(3)     

 # switch to new tab
 driver.switch_to.window(driver.window_handles[-1]) 
</code></pre>
<p>Then I try to download the file with glob like this:</p>
<pre><code>certidoes = glob.glob('emissaoCertidaoNegativa*')
print(certidoes)
</code></pre>
<p>but it prints something like:</p>
<blockquote>
<p>[emissaoCertidaoNegativa.jsf;jsessionid=44297D6C88452FC479FC0E94013D3C0A]</p>
</blockquote>
<p>and when I try to rename it to pdf I get an empty file... can someone help?</p>
</div>
<div class="post-text" itemprop="text">
<p>As per <a href="https://docs.python.org/3/library/glob.html#glob.glob" rel="nofollow noreferrer">documentaion</a>:</p>
<blockquote>
<p>Return a possibly-empty list of path names that match pathname, which
  must be a string containing a path specification. pathname can be
  either absolute (like /usr/src/Python-1.5/Makefile) or relative (like
  ../../Tools/<em>/</em>.gif), and can contain shell-style wildcards. Broken
  symlinks are included in the results (as in the shell).</p>
</blockquote>
<p>so you have to specify the path to the file. </p>
<p><strong><em>Example:</em></strong></p>
<p>lets say we have two <code>output.txt</code> files in two different directories:</p>
<ul>
<li><code>C:\\Test\\output.txt</code></li>
<li><code>C:\\Users\\userName\\Desktop\\output.txt</code></li>
</ul>
<p>then if we try the following code:</p>
<pre><code>print(glob.glob('C:\\Test\\output.txt', recursive=True))
print(glob.glob('C:\\**\\output.txt', recursive=True))
print(glob.glob('C:\\**\\output.txt'))
print(glob.glob('output.txt'))
</code></pre>
<p>output will be:</p>
<pre><code>['C:\\Test\\output.txt']
['C:\\test\\output.txt', 'C:\\Users\\userName\\Desktop\\output.txt']
['C:\\test\\output.txt']
[]
</code></pre>
<p>So you have to specify the path to the directory, where your file is saved. You can use <code>**</code>, but as documentation says:</p>
<blockquote>
<p>Note Using the “**” pattern in large directory trees may consume an
  inordinate amount of time.</p>
</blockquote>
</div>
<span class="comment-copy">I can't open the link</span>
<span class="comment-copy">Sorry, it returns in a list, I will edit. The donwload path is already especified. The problem is it is downloading that file, not just a .jsf</span>
<span class="comment-copy">could you please provide a working link to the website/document ?</span>
<span class="comment-copy">a general link to the website I can get, but what have I do to reproduce the page you are getting with the document?</span>
<span class="comment-copy">use this 22977333000108 cnpj number to acess the document page, but maybe the service is unavailable now</span>
<span class="comment-copy">could you see the documment?</span>
