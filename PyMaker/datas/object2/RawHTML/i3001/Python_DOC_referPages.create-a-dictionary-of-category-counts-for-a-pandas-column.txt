<div class="post-text" itemprop="text">
<p>I have the following data frame:</p>
<pre><code>person    pets
John     [cat, dog]
Amy      [bird, fish, cat]
Dave     [cow, horse, dog]
Mary     [lamb, camel, rino]
Jim      [bird, dog]
</code></pre>
<p>I want to aggregate the <code>pets</code> column to find the occurences for each pet type. The expected answer for this example should be:</p>
<pre><code>{cat: 2, dog: 3, bird:2, fish:1, cow:1, horse:1, lamb: 1, camel: 1, rino:1}
</code></pre>
<p>Except looping the entire data frame row by row, is there a more elegant way to get the results? Thanks!</p>
</div>
<div class="post-text" itemprop="text">
<p>Using <a href="https://docs.python.org/3/library/collections.html#collections.Counter" rel="nofollow noreferrer"><code>collections.Counter</code></a> with <a href="https://docs.python.org/3/library/itertools.html#itertools.chain.from_iterable" rel="nofollow noreferrer"><code>itertools.chain</code></a>:</p>
<pre><code>from collections import Counter
from itertools import chain

res = Counter(chain.from_iterable(df['pets']))

print(res)

Counter({'dog': 3, 'cat': 2, 'bird': 2, 'fish': 1, 'cow': 1,
         'horse': 1, 'lamb': 1, 'camel': 1, 'rhino': 1})
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>By just using the builtins you can do:</p>
<pre><code>a = [j for i in df['pets'] for j in i]

{i:a.count(i) for i in set(a)}

{'fish': 1,'bird': 2,'dog': 3,'camel': 1,'cat': 2,'lamb': 1,'horse': 1,'cow': 1,'rhino': 1}
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Yes, you can use counter</p>
<pre><code>import collections
import pandas
d = {'person': ['John', 'Amy', 'Dave', 'Mary','Jim'], 'pets': [['cat','dog'], ['bird','fish','cat'],['cow','horse','dog'], ['lamb', 'camel' , 'rhino'],['bird','dog']]}
df1 = pd.DataFrame.from_dict(d)
collections.Counter(sum(df1.pets,[]))
</code></pre>
<p>And to have the output in a nice format</p>
<pre><code>counts = pd.DataFrame.from_dict(collections.Counter(sum(df1.pets,[])),orient='index')
</code></pre>
<p>Output: </p>
<pre><code>0
cat 2
dog 3
bird    2
fish    1
cow 1
horse   1
lamb    1
camel   1
rhino   1
</code></pre>
</div>
<span class="comment-copy">Do you have an option of building the data frame differently while keeping the same data?</span>
