<div class="post-text" itemprop="text">
<p>In a python web application, I'm packaging up some stuff in a zip-file. I want to do this completely on the fly, in memory, without touching the disk. This goes fine using ZipFile.writestr as long as I'm creating a flat directory structure, but how do I create directories inside the zip?</p>
<p>I'm using python2.4.</p>
<p><a href="http://docs.python.org/library/zipfile.html" rel="noreferrer">http://docs.python.org/library/zipfile.html</a></p>
</div>
<div class="post-text" itemprop="text">
<p>What 'theomega' said in the comment to my original post, adding a '/' in the filename does the trick. Thanks!</p>
<pre><code>from zipfile import ZipFile
from StringIO import StringIO

inMemoryOutputFile = StringIO()

zipFile = ZipFile(inMemoryOutputFile, 'w') 
zipFile.writestr('OEBPS/content.xhtml', 'hello world')
zipFile.close()

inMemoryOutputFile.seek(0)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Use a <a href="http://docs.python.org/library/stringio.html" rel="nofollow noreferrer"><code>StringIO</code></a>. It is <a href="https://stackoverflow.com/questions/25116/binary-buffer-in-python">apparently</a> OK to use them for zipfiles.</p>
</div>
<span class="comment-copy">Have you tried simply setting the filename of a file to add to 'directory/filename.ext'?</span>
<span class="comment-copy">@theomega is correct.</span>
<span class="comment-copy">Note that if you're using python 3 then you'll want to use <a href="https://docs.python.org/3/library/io.html" rel="nofollow noreferrer"><code>BytesIO</code></a>.</span>
<span class="comment-copy">And if you just want to have folders without files, leave a <code>/</code> at the end.</span>
<span class="comment-copy">We do this also.  Works very nicely.</span>
<span class="comment-copy">This answer is out-of-date, should it be downvoted?</span>
<span class="comment-copy">@AnotherParker If you have a more modern solution, please post and I will upvote</span>
