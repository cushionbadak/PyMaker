<div class="post-text" itemprop="text">
<p>I want to add a folder to the Windows PATH environment variable with Python. I tried these three code snippets but none worked:</p>
<pre><code>os.environ['PATH'] += ";C:\my\folder"
</code></pre>
<p>and</p>
<pre><code>sys.path.insert(0, os.path.abspath('C:\my\folder'))
</code></pre>
<p>and</p>
<pre><code>if sys.platform == 'win32':
    sep = ';'
else:
    sep = ':'

os.environ['PATH'] += sep + r'"C:\my\folder"'
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>The Windows command for <em>permanently</em> changing the path is</p>
<pre><code>setx /M path "%path%;C:\my\folder"
</code></pre>
<p>You can execute arbitrary shell commands via Python with <code>os.system</code></p>
<pre><code>import os
os.system('setx /M path "%path%;C:\my\folder"')
</code></pre>
<p>Note:</p>
<p>You need to run this with elevated privileges.</p>
<p>References:</p>
<ul>
<li><a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/setx" rel="nofollow noreferrer">https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/setx</a></li>
<li><a href="https://docs.python.org/3/library/os.html#os.system" rel="nofollow noreferrer">https://docs.python.org/3/library/os.html#os.system</a></li>
</ul>
</div>
<span class="comment-copy">[about revision 3] OP used the sys module in some of his attempts, but it doesn't make the question related to that module.</span>
<span class="comment-copy"><code>"\f"</code> is a form-feed character. You need to use a raw string. <code>sys.path</code> has <i>absolutely nothing</i> to do with the system <code>PATH</code> environment variable. The path separator is <code>os.pathsep</code>; do no hard code it in your script. Never use double quotes in <code>PATH</code>; CMD can handle quotes, but almost everything else uses <code>SearchPath</code>, which treats the quotes as literal characters.</span>
<span class="comment-copy">Thank You! how to require it to run as administrator</span>
<span class="comment-copy">@SSH  <a href="https://stackoverflow.com/q/19672352/5281047">stackoverflow.com/q/19672352/5281047</a></span>
<span class="comment-copy">Never use setx.exe to change <code>PATH</code>. It's wrong in at least two seriously bad ways. (1) It hard codes the current value of named variables such as <code>%UserProfile%</code>. (2) <code>PATH</code> consists of a system value and a per-user value that get concatenated at load time, and using setx.exe with the already concatenated value sets the per-user component in the system component, which will increasingly make a mess of <code>PATH</code> every time you do this.</span>
<span class="comment-copy">so how to add to PATH?</span>
