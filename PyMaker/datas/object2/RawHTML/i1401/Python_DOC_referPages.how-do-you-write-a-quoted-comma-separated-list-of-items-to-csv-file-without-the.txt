<div class="post-text" itemprop="text">
<p>What is an elegant, Pythonic way to write lines of data that contain an embedded (quoted) list of comma separated values to a CSV file?</p>
<p>I need to put quotes around a comma separated list so that Excel doesn't break the list into separate columns when looking at it with Excel.</p>
<p>My function looks like this:</p>
<pre><code>def write_customer_list(self):
    with open('reports/systems.csv', 'w') as f:
        f.write('Systems Report for week {}\n'.format(self.week))
        f.write('CustId,IP_AddrList,ModelNum\n')   # Header for csv file
        for cust_id, system in self.systems.items():
            f.write('{}'.format(cust_id))
            f.write(',\"')  # open double quote string for list
            for value in system['ip_addr_list']:
                f.write('{},'.format(value))
            f.write('\"')  # close the quote
            f.write(',{}\n'.format(system['model_num']))
</code></pre>
<p>Output looks like this:</p>
<pre><code>123,"10.1.1.6,10.1.2.12,10.1.3.15,",NEX3601
124,"10.2.5.6,10.2.1.12,",NEX3604
</code></pre>
<p>How do I get rid of the trailing ',' in the ip list?</p>
</div>
<div class="post-text" itemprop="text">
<p>Instead of</p>
<pre><code>for value in system['ip_addr_list']:
    f.write('{},'.format(value))
</code></pre>
<p>do</p>
<pre><code>f.write( ','.join(system['ip_addr_list']) )
</code></pre>
<p>This will give you a comma separated list that does not have a comma at the end. See the documentation of the <a href="https://docs.python.org/3/library/stdtypes.html#str.join" rel="nofollow noreferrer">join</a> function for more info.</p>
<p>You may also want to take a look at the <a href="http://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">CSV</a> module. When using this module you only need to provide your list of data, and it will take care of formatting everything for you.</p>
</div>
<span class="comment-copy"><a href="https://docs.python.org/3/library/csv.html" rel="nofollow noreferrer">docs.python.org/3/library/csv.html</a></span>
<span class="comment-copy"><code>f.write('{}'.format(cust_id))</code> why not just <code>f.write(cust_id)</code>?</span>
<span class="comment-copy">The CSV writer expects a list (or, some kind of iterable) representing a single row. <i>Don't</i> use <code>format()</code>, just pass the list to the writer. You should be using the CSV module.</span>
<span class="comment-copy">This is not how to write CSVs at all</span>
<span class="comment-copy">Oh, man. I misread and thought they were using the CSV module from the start, sorry. Personally I'd flip your answer and start with the recommendation.</span>
<span class="comment-copy">No worries. I kind of assumed you misread it. Yeah, if he was already using the CSV module then this would have been a terrible answer. I'll leave the recommendation at the end as it doesn't make that much since for him to rewrite everything to use the CSV module when the code he has already works. I will actually often not use the CSV module even though I know it exists as it is quicker to not have to look up how the CSV module works when I'm just writing a quick one-time script.</span>
<span class="comment-copy">Sorry I am so late on this comment, but @Mr.Me, that worked like a charm! So simple - duh - why didn't I think of that! That is what is great about Stack Overflow! Thanks!</span>
<span class="comment-copy">You're welcome. I'm glad to have been able to help.</span>
