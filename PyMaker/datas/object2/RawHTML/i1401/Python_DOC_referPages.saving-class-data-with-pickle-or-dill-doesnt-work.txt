<div class="post-text" itemprop="text">
<p>I want to save state of poll class data to file and if my script restarts load it back. I popped out part of my program to replicate the problem. here are my files.</p>
<p><strong>pickleclass.py</strong></p>
<pre><code>#POLL RECORD
class POLL:
  title = ''
  votes = {}
  duration = 0
  secenekler = 0
  sure = ""
  polltype = -1 # -1 initial, 0 = %, 1 = Sayi
  chat_id = None
  message_id = None

  def reset():
    POLL.title = ''
    POLL.votes.clear()
    POLL.duration = 0
    POLL.secenekler = 0
    POLL.sure = ""
    POLL.polltype = -1
    POLL.chat_id = None
    POLL.message_id = None
</code></pre>
<p><strong>fxns.py</strong></p>
<pre><code>def save_to_file(obj, filename):
    """
    Saves obj to file named with fn as pickly object.
    """
    import pickle
    with open(filename, 'wb') as output:  # Overwrites any existing file.
        pickle.dump(obj, output, pickle.HIGHEST_PROTOCOL)


def load_from_file(fn):
    import pickle
    """
    reads from file given in fn and returns object of dump pickle file
    """
    return pickle.load( open( fn, "rb" ) )
</code></pre>
<p><strong>save.py</strong></p>
<pre><code>import pickleclass as pk
import fxns as fxn
Poll_file = "p.dump"

poll = pk.POLL

poll.title = "TEST TITLE"
poll.votes['VOTE 1'] = 1
poll.votes['VOTE 2'] = 2
poll.votes['VOTE 3'] = 3

poll.duration = 0.4
poll.secenekler = 1
poll.sure = "23:55"
poll.polltype = 1
poll.chat_id = 112431
poll.message_id = 324

print("-"*55)
print("-"*55)
bozo = vars(poll)
for key in bozo.keys():
    print(key, "=", bozo[key])

print("-"*55)
fxn.save_to_file(poll, Poll_file)
</code></pre>
<p>First i call save.py to create the class and then save it. its successfully ends. after the save.py script i call below load.py to load what is saved. but it loads empty class data. as it was newly created. 
output of the save.py file is as follows:</p>
<pre><code>('reset', '=', &lt;function reset at 0x7f4485277758&gt;)
('__module__', '=', 'pickleclass')
('sure', '=', '23:55')
('secenekler', '=', 1)
('title', '=', 'TEST TITLE')
('__doc__', '=', None)
('votes', '=', {'VOTE 2': 2, 'VOTE 3': 3, 'VOTE 1': 1})
('polltype', '=', 1)
('chat_id', '=', 112431)
('duration', '=', 0.4)
('message_id', '=', 324)
</code></pre>
<p><strong>load.py</strong></p>
<pre><code>import pickleclass as pk
import fxns as fxn
Poll_file = "p.dump"

zozo = fxn.load_from_file(Poll_file)
zozo = vars(zozo)

for key in zozo.keys():
    print(key, "=", zozo[key])
print("-"*55)
print("-"*55)
</code></pre>
<p>and when i load the file and show the output, its empty like below.</p>
<pre><code>('reset', '=', &lt;function reset at 0x7f8e99907758&gt;)
('__module__', '=', 'pickleclass')
('sure', '=', '')
('secenekler', '=', 0)
('title', '=', '')
('__doc__', '=', None)
('votes', '=', {})
('polltype', '=', -1)
('chat_id', '=', None)
('duration', '=', 0)
('message_id', '=', None)
</code></pre>
<p>I couldn't find out the problem. it loads the class but not the data. </p>
</div>
<div class="post-text" itemprop="text">
<p>The load was performed correctly: the problem comes from your class which is not implemented properly.</p>
<p>Have a look at <a href="https://www.digitalocean.com/community/tutorials/understanding-class-and-instance-variables-in-python-3" rel="nofollow noreferrer">some material on classes and instances</a> (or some posts <a href="https://stackoverflow.com/q/12457259/5962321">on SO</a>), especially the <code>__init__</code> function, <code>self</code>, and notions like instance and class members (see also a closely related problem in <a href="https://stackoverflow.com/questions/10842553/pickle-with-custom-classes">that post</a>).</p>
<p>Then look at how <a href="https://docs.python.org/3/library/pickle.html#what-can-be-pickled-and-unpickled" rel="nofollow noreferrer"><code>pickle</code></a> handles classes and you should be good to go.</p>
<p><strong>Edit</strong> apparently with <code>dill</code> this should actually be possible, see <a href="https://stackoverflow.com/a/26410499">this SO post</a></p>
</div>
<span class="comment-copy">What i read once and try to do was like "A class can itself be used as a container or namespace. There's no need to instantiate it, and it'll save you a bit of typing if you just want a bundle of attributes." i have some classes with self and init, but in this case i only needed to hold some parameters under one section, so i did it this way. you say that to able to save with pickle of dill, i need to have full class definition with self and init inside. I will try and check. Thanks</span>
<span class="comment-copy">Yep, unfortunately that does not work well for pickle, see <a href="https://stackoverflow.com/a/10842615/5962321">jdi's answer</a></span>
<span class="comment-copy">Apparently Dill allows that, sorry for the mistake, see edit</span>
<span class="comment-copy">I tried with dill also, it was same. didn't work. i try with <b>init</b> now, and now i able to load data properly. so seems without <i>instantiating class</i>, its not possible to <i>save</i> and <i>load</i> properly.</span>
