<div class="post-text" itemprop="text">
<div class="question-status question-originals-of-duplicate">
<p>This question already has an answer here:</p>
<ul>
<li>
<a dir="ltr" href="/questions/370357/python-variable-scope-error">Python variable scope error</a>
<span class="question-originals-answer-count">
                    11 answers
                </span>
</li>
</ul>
</div>
<p>I am making a Python Discord bot with discord.py. I am relatively new to Python but have about eight years of experience with other languages. My problem is that I get the <code>UnboundLocalError: local variable 'prefix' referenced before assignment</code> even though I have defined <code>prefix</code> as a global variable. (I am using Python 3.6.8)</p>
<p>I have tried defining the variables outside the <code>on_ready</code> function, but I get the same result.</p>
<pre><code>import discord;

client = discord.Client();

@client.event
async def on_ready():
  print('Loading complete!')
  ...
  global prefix
  prefix = 'hello world'

@client.event
async def on_message(message):

  if message.author == client.user:
    return

  messageContents = message.content.lower()
  splitMessage = messageContents.split()
  try:
    splitMessage[0] = splitMessage[0].upper()lower()
  except:
    return
  if splitMessage[0]==prefix:
    ...
    (later in that if statement and a few nested ones)
    prefix = newPref

client.run('token')
</code></pre>
<p>I expected the output would be that it runs the code within the if statement, but instead I get the error <code>UnboundLocalError: local variable 'prefix' referenced before assignment</code> and no code is run.</p>
<p>The only thing I can think of being the problem is <code>prefix = newpref</code>. I tried:</p>
<pre><code>global prefix
prefix = newpref
</code></pre>
<p>But then I got the error: <code>SyntaxError: name 'prefix' is used prior to global declaration</code> and the bot didn't start at all. What should I do? </p>
</div>
<div class="post-text" itemprop="text">
<p>According to the <a href="https://docs.python.org/3.6/faq/programming.html#why-am-i-getting-an-unboundlocalerror-when-the-variable-has-a-value" rel="nofollow noreferrer">official docs</a> </p>
<blockquote>
<p>This is because when you make an assignment to a variable in a scope,
  that variable becomes local to that scope and shadows any similarly
  named variable in the outer scope.</p>
</blockquote>
<p><strong>Short version:</strong></p>
<p>You need to declare your global variable outside the scope of your functions such as</p>
<pre><code>#declaring the global variable
x = 10
def foobar():
    #accessing the outer scope variable by declaring it global
    global x
    #modifying the global variable
    x+=1
    print(x)
#calling the function
foobar()
</code></pre>
<p><strong>Long version:</strong></p>
<p>Basically, everything in python is an object and collections of those objects are called <a href="https://docs.python.org/3/reference/datamodel.html" rel="nofollow noreferrer">namespaces</a>.  </p>
<blockquote>
<p>Each module has its own private symbol table, which is used as the
  global symbol table by all functions defined in the module. Thus, the
  author of a module can use global variables in the module without
  worrying about accidental clashes with a userâ€™s global variables.</p>
</blockquote>
<p>So when you run your bot script, python treats it as a module that is running as the main script, with its own global scope.<br/>
When you declare a variable in a global scope, to use it in local scopes of certain functions you need to use the keyword <code>global</code> to access that global scope of your module.</p>
<p>Also, python does not <em>require</em> semi-colons to terminate statements (such as <code>client = discord.Client();</code>). Semicolons <em>can</em> be used to delimit statements if you wish to put multiple statements on the same line.</p>
</div>
<span class="comment-copy">Did you try the global statement <i>before you use prefix in the function</i> as suggested by the error message?</span>
