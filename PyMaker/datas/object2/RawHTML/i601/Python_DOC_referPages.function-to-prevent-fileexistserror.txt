<div class="post-text" itemprop="text">
<p>I have this function to prevent <code>FileExistsError</code>. It creates a folder, but if there is another folder with the same name, it will add an sequential number to the name of that folder.</p>
<pre><code>import os

def create_folder(folder_name):

      path = '/home/k/Desktop/' + folder_name
      folder_number = 1

      if os.path.exists(path):
            while path == os.path.exists(path):
                  folder_number += 1
            path = '/home/k/Desktop/' + folder_name + ' ({})'.format(folder_number)
            os.makedirs(path)

      else:
            os.makedirs(path)
</code></pre>
<p>I am able to make the folder, and if i create another folder with the same name, i will set the name to <code>myfoldername(1)</code>, but if a create it again it will raise <code>FileExistsError</code>:</p>
<pre><code>FileExistsError: [Errno 17] File exists: '/home/k/Desktop/test (1)'
</code></pre>
<p>I think the error is in the <code>while</code> loop but i don't know how to fix it.</p>
</div>
<div class="post-text" itemprop="text">
<p>The error you are getting is a result of folder_number being set to 1 outside of the exists check. Every time it attempts to prevent the <code>FileExistsError</code> it tries to solve the problem by creating the folder name with a " (1)" appended to it. If that already exists, then you get the <code>FileExistsError</code> anyway.</p>
<p>As with many things in python, there are many different ways to fix this issue. The easiest way that I could make it work while still resembling your function's logic would be to combine your while loop with your os.path.exists check, so that while the check for the path already existing return True, the while loop increments the number in the parentheses. After the exist check returns False, it will perform the create folder operation. This is an example of the Look Before You Leap (<a href="https://docs.python.org/3/glossary.html?highlight=lbyl" rel="nofollow noreferrer">LBYL</a>) principle:</p>
<pre><code>import os

def create_folder(folder_name):

    path = '/home/k/Desktop/' + folder_name
    folder_number = 1
    while os.path.exists(path):
        folder_number += 1
        path = '/home/k/Desktop/' + folder_name + ' ({})'.format(folder_number)
    os.makedirs(path) 

</code></pre>
<p>There is a also a principle in python that is commonly implemented that could help you out here too called Easier to Ask Forgiveness than Permission (<a href="https://docs.python.org/3/glossary.html?highlight=eafp" rel="nofollow noreferrer">EAFP</a>). Basically, you could wrap the os.makedirs(path) operation inside of try.. except statement.</p>
<p>That would look like this:</p>
<pre><code>import os

def create_folder(folder_name):

   path = '/home/k/Desktop/' + folder_name
   folder_number = 0
   while os.path.exists(path):
       try:
           os.makedirs(path)
       except FileExistsError:
           folder_number += 1
           path = '{} ({})'.format(path, folder_number)
           continue
</code></pre>
<p>Here the path is modified if a FileExistsError occurs and then the continue statement tells the while loop to "continue" instead of exiting.</p>
</div>
<div class="post-text" itemprop="text">
<p>The assignment of a new path name with the incremented number should be inside the <code>while</code> loop so that <code>path</code> can be updated, and the condition for the <code>while</code> loop needs only the returning Boolean value <code>os.path.exists</code> method:</p>
<pre><code>while os.path.exists(path):
    folder_number += 1
    path = '/home/k/Desktop/' + folder_name + ' ({})'.format(folder_number)
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Your code has two issues. The first is that the condition of your <code>while</code> loop doesn't make any sense. You're doing <code>path == os.path.exists(path)</code>, but the function call returns either <code>True</code> or <code>False</code>, neither of which will ever equal the path string. You should just use <code>os.path.exists(path)</code> as the condition.</p>
<p>The second issue is that you're not updating <code>path</code> inside the loop. You need to move the line that updates it to account for the incremented folder number so that you don't keep checking the same <code>path</code> over and over forever.</p>
<p>Here's how I'd rewrite that code:</p>
<pre><code>def create_folder(folder_name):

      path = '/home/k/Desktop/' + folder_name
      folder_number = 1

      while path == os.path.exists(path):
          path = '/home/k/Desktop/{} ({})'.format(folder_name, folder_number)
          folder_number += 1

      os.makedirs(path)
      return path
</code></pre>
<p>I made a few other changes, beyond the ones causing your current error. I got rid of the <code>if</code> statement which was completely unnecessary, since the <code>while</code> loop will not run it's body if the condition is falsey on the first go. That means the <code>os.makedirs</code> call is unconditional. In addition to indenting the path-updating line, I also rewrote it to just use one formatting operation, rather than also doing some concatenations. I also reordered it relative to the increment step, so that you'll start numbering at <code>1</code>, rather than <code>2</code>. And finally, I added a <code>return</code> statement to the end, as you're probably going to want to use that folder you just created, and without returning the final path, the calling code will not know what number we had to increment up to.</p>
</div>
<span class="comment-copy">That's only half the problem. Doesn't <code>path == os.path.exists(path)</code> look strange to you?</span>
<span class="comment-copy">Indeed I missed that. Thanks.</span>
<span class="comment-copy">It might be better to use <code>os.path.join('/home/k/Desktop/', folder_name)</code> instead.</span>
