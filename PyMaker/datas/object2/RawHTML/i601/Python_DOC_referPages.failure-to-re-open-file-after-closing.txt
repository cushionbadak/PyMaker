<div class="post-text" itemprop="text">
<p>I have been working with some code that is meant to print a poem. The goal of the code is to make borders that will fit the poem's size. But that does not pertain to my issue. I have been trying to get the code to reprint a file, line for line, but <code>ValueError: I/O operation on closed file.</code> is all that is returned.</p>
<p>I've attempted to get around this by reopening the file after it's closed, and reopening it after the <code>def poemprint(poem):</code> function has completed. But both methods have failed. I don't know where to go from here.</p>
<pre><code>import os
os.system("clear")

quitw=["no","n","ney","ne","nope","nuh-uh","nuh","noh","neigh","nye","negative","please no","no               please","quit","stop","q","s"]
harlem=open("harlem.txt","r")
hhop=open("hhop.txt","r")
poems={"1":harlem,"2":hhop}
poemname={"1":"harlem.txt","2":"hhop.txt"}

#10 lines of def quit() code

def poemprint(poem):
    print("╭"+"-"*60+"╮")
    print("|  Poem Printer [v0.5]"+" "*39+"|")
    print("⊢"+"-"*60+"⊣")
    print("|"+" "*60+"|")
    for a in poem: #line where error occurs
        b=57-len(a)
        print("|    "+a[0:len(a)-1]+(" "*b)+"|")
    print("|"+" "*60+"|")
    print("╰"+"-"*60+"╯")
    poem.close()
    if f=="harlem.txt": #doesn't work
        harlem=open("harlem.txt","r")
    elif f=="hhop.txt":
        hhop=open("hhop.txt","r")

c=(input("Enter a Poem: "))
if c not in quitw:
    while c not in quitw:
        while c.lower() in poems:
            os.system("clear")
            f=poemname[c]
            poemprint(poems[c])
            c=(input("Enter a Poem: "))
            if c in quitw:
                quit()
            else:
                continue
        os.system("clear")
        print("Invalid input.")
        c=(input("Enter a Poem: "))
else:
    quit()
</code></pre>
<p>Note: quit() is a defined function to stop the code entirely.</p>
<p>This is what I should be seeing after asking for the Harlem poem for the second time:</p>
<pre><code>    ╭------------------------------------------------------------╮
    |  Poem Printer [v0.5]                                       |
    ⊢------------------------------------------------------------⊣
    |                                                            |
    |    Harlem by Langston Hughes                               |
    |                                                            |
    |      What happens to a dream deferred?                     |
    |                                                            |
    |        Does it dry up                                      |
    |        like a raisin in the sun?                           |
    |        Or fester like a sore—                              |
    |        And then run?                                       |
    |        Does it stink like rotten meat?                     |
    |        Or crust and sugar over—                            |
    |        like a syrupy sweet?                                |
    |                                                            |
    |        Maybe it just sags                                  |
    |        like a heavy load.                                  |
    |                                                            |
    |        Or does it explode?                                 |
    |                                                            |
    ╰------------------------------------------------------------╯
</code></pre>
<p>Instead, I'm getting:</p>
<pre><code>    ╭------------------------------------------------------------╮
    |  Poem Printer [v0.5]                                       |
    ⊢------------------------------------------------------------⊣
    |                                                            |
    Traceback (most recent call last):
      File "main.py",line 44, in &lt;module&gt;
        poemsprint(poems[c])
      File "main.py",line 27, in poemprint
        for a in poem:
    ValueError: I/O operation of closed file.
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>Your steps are:</p>
<ol>
<li>You open a file in <code>harlem</code> variable</li>
<li>You call <code>poemprint</code> function with <code>harlem</code> argument. This <code>harlem</code> is <em>referenced</em> as <code>poem</code> inside of the function.</li>
<li>You close the file that <code>poem</code> references to (it is <code>harlem</code> outside of the function)</li>
<li>You <strong>create</strong> a new variable <code>harlem</code> that exists only inside of the function</li>
<li>After the function is done, you have <code>harlem</code> as a closed file</li>
</ol>
<p>This happens because <code>harlem</code> in the <code>poemprint</code> and the one outside are different objects.</p>
<p>Short example:</p>
<pre><code>def a():
    var = 2

var = 1
a()

print(var) #prints 1
</code></pre>
<p>You can read more about this in <a href="https://stackoverflow.com/a/13881502/9245204">mgilson's answer on a question that covers similar problem</a> and in <a href="https://docs.python.org/3/tutorial/classes.html" rel="nofollow noreferrer">the Python documentation</a>.</p>
<h2>How to fix:</h2>
<p>Instead of opening the files, keep their names.</p>
<pre><code>poems={"1":"harlem.txt","2":"hhop.txt"}
</code></pre>
<p>Then modify the function to get the filename as the argument and to <strong>open the file inside of the function</strong>.</p>
<pre><code>def poemprint(poem):
    print("╭"+"-"*60+"╮")
    print("|  Poem Printer [v0.5]"+" "*39+"|")
    print("⊢"+"-"*60+"⊣")
    print("|"+" "*60+"|")

    poem = open(poem, "r") #This
    for a in poem:
        b=57-len(a)
        print("|    "+a[0:len(a)-1]+(" "*b)+"|")
    print("|"+" "*60+"|")
    print("╰"+"-"*60+"╯")
    poem.close()
    #End of the function
</code></pre>
<p>Now it should work.</p>
<pre><code>Enter a Poem: 1
╭------------------------------------------------------------╮
|  Poem Printer [v0.5]                                       |
⊢------------------------------------------------------------⊣
|                                                            |
|    Roses are red                                           |
|    Violets are blue                                        |
|                                                            |
╰------------------------------------------------------------╯
Enter a Poem: 1
╭------------------------------------------------------------╮
|  Poem Printer [v0.5]                                       |
⊢------------------------------------------------------------⊣
|                                                            |
|    Roses are red                                           |
|    Violets are blue                                        |
|                                                            |
╰------------------------------------------------------------╯
Enter a Poem: 

</code></pre>
<p>Here's the full code:</p>
<pre><code>import os
os.system("clear")

quitw=["no","n","ney","ne","nope","nuh-uh","nuh","noh","neigh","nye","negative","please no","no               please","quit","stop","q","s"]
poems={"1":"harlem.txt","2":"hhop.txt"}

#10 lines of def quit() code

def poemprint(poem):
    print("╭"+"-"*60+"╮")
    print("|  Poem Printer [v0.5]"+" "*39+"|")
    print("⊢"+"-"*60+"⊣")
    print("|"+" "*60+"|")

    poem = open(poem, "r") #This
    for a in poem:
        b=57-len(a)
        print("|    "+a[0:len(a)-1]+(" "*b)+"|")
    print("|"+" "*60+"|")
    print("╰"+"-"*60+"╯")
    poem.close()

c=(input("Enter a Poem: "))
if c not in quitw:
    while c not in quitw:
        while c.lower() in poems:
            os.system("clear")
            f=poems[c]
            poemprint(poems[c])
            c=(input("Enter a Poem: "))
            if c in quitw:
                quit()
            else:
                continue
        os.system("clear")
        print("Invalid input.")
        c=(input("Enter a Poem: "))
else:
    quit()

</code></pre>
</div>
<span class="comment-copy">It seems that you didn't include the call of the <code>poemprint</code> function. Please provide a <a href="https://stackoverflow.com/help%5Cmcve">Minimal, Complete, and Verifiable example</a> so I will be able to help you.</span>
<span class="comment-copy">@OSA413 I've attempted to make a code that replicated the error, but I can't figure it out. It's simple this code that is producing this error.</span>
<span class="comment-copy">you're closing the file handle in poemprint, but you're opening it from outside it. It only works once. The next call, the file is closed. make your function symmetric</span>
<span class="comment-copy">@Jean-FrançoisFabre I closed and opened the file after <code>poemprint(poems[c])</code> but it's still returning the same error.</span>
<span class="comment-copy">You have a bug, but this is bad practice. So just don't do this. open &amp; close the file in the subprogram. If you have to read it more than once, make a list of the lines instead</span>
<span class="comment-copy">Thanks a lot! I'll apply the changes to my code immediately!</span>
<span class="comment-copy">I've wrapped the code! You can find it at: <a href="https://repl.it/@KiKUP/Poem-Printer-v08" rel="nofollow noreferrer">repl.it/@KiKUP/Poem-Printer-v08</a></span>
<span class="comment-copy">@KiKUP if you think that my <a href="https://stackoverflow.com/help/someone-answers">answer is the best solution of your problem, accept it.</a></span>
