<div class="post-text" itemprop="text">
<p>I am printing the column name, data type and the max length of the columns from an Excel file.</p>
<p>Below is the code and the output, need to export the output to the json file.</p>
<h3>Excel file (assignment.xlsx):</h3>
<pre class="lang-xml prettyprint-override"><code>&lt;html&gt;
&lt;table &gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;Type&lt;/th&gt;
      &lt;th&gt;Amount received&lt;/th&gt;
      &lt;th&gt;Currency&lt;/th&gt;
      &lt;th&gt;Flag&lt;/th&gt;
      &lt;th&gt;Date&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;Educationsl&lt;/td&gt;
      &lt;td&gt;1422.00&lt;/td&gt;
      &lt;td&gt;USD&lt;/td&gt;
      &lt;td&gt;2018-11-30&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/html&gt;
</code></pre>
<h3>Output</h3>
<pre class="lang-none prettyprint-override"><code>Column Name : Type
Data type : String
Size  : 11

Column Name : Amountreceived
Data type : Float
Size  : 6

Column Name : Currency
Data type : String
Size  : 3

Column Name : Flag
Data type : String
Size  : 1

Column Name : Date
Data type : Float
Date format  : ddmmyyyy
</code></pre>
<h3>Code</h3>
<pre><code>import string
import re
import datetime
import xlrd
loc = r"C:\Users\Documents\PythonStuff\assignment.xlsx"
wb = xlrd.open_workbook(loc)
sheet = wb.sheet_by_index(0)

for i in range(sheet.ncols):
    print ("Column Name : " + re.sub('[^A-Za-z0-9]+', '', sheet.cell_value(0, i).replace(' ','_')))
##Data Type
    if str(sheet.cell_type(1,i)) == '1':
        print  ("Data type : String ")
    elif isinstance(sheet.cell_value(1,i), float) == True:
        print  ("Data type : Float ")
    elif str(sheet.cell_type(1,i)) =='3':
        print  ("Data type : Date ")
## Date Format
    if str(sheet.cell_type(1,i)) =='3':
        print ("Date format  : " + "ddmmyyyy" +"\n ")
    else:
        print ("Size  : " + str(len (str(sheet.cell_value(1,i))))+"\n ")
</code></pre>
<h3>Desired output</h3>
<pre><code>{"Excel": [{"Type": "Educational", "Amount received": "1422.00", "Currency": "USD", "Flag": "N", "Date": "2018-11-30"} ]}
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>I assume that you want to use the values of the 1st row as the dict keys and every row is an item in a the list. Add this to you code:</p>
<pre><code>keys = [i.value for i in sheet.row(0)]
sheet_dict = {'Excel': list()}

for row in range(1, sheet.nrows):
    row_dict = {}
    for col in range(sheet.ncols):
        row_dict[keys[col]] = sheet.cell_value(rowx=row, colx=col)
    sheet_dict['Excel'].append(row_dict)

print(sheet_dict)
</code></pre>
<p>Or if you want a pretty output:</p>
<pre><code>import json
print(json.dumps(sheet_dict, sort_keys=True, indent=4))
</code></pre>
</div>
<span class="comment-copy">Have you tried using the <a href="https://docs.python.org/3/library/json.html" rel="nofollow noreferrer"><code>json</code></a> module?</span>
<span class="comment-copy">@mkrieger1: {"Excel": [{"Type": "Educational", "Amount received": "1422.00", "Currency": "USD", "Flag": "N", "Date": "2018-11-30"} ]}</span>
<span class="comment-copy">@user5173426 : Tried json module, but not sure how to integrate it with the existing code</span>
<span class="comment-copy">Hello Frans, thanks for the answer provided. But the above code will print the data from the excel sheet. Instead I need to print the structure of the table (excel file) i.e its column name the data type of the value that column holds and the maximum length.</span>
