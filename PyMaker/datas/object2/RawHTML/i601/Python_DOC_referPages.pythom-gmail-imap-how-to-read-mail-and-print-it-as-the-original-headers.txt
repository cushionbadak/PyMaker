<div class="post-text" itemprop="text">
<p><strong>I have a script that reads mail from the Gmail box and then prints it. The problem is that it prints it as follows:</strong></p>
<blockquote>
<p>'MIME-Version: 1.0\r\nDate: Wed, 6 Feb 2019 15:22:04
  +0200\r\nMessage-ID: CAES-+zqJ-zFh40JBvB3bbkX-Md0dFQ-dc1ECQMynj-yp8C5eg@mail.gmail.com&gt;\r\nSubject:
  test\r\nFrom: Ops \r\nTo: test
  \r\nContent-Type: multipart/alternative;
  boundary="000000000000a56dd00581399c31"\r\n\r\n--000000000000a56dd00581399c31\r\nContent-Type:
  text/plain;
  charset="UTF-8"\r\n\r\ngoogle.com\r\n\r\n56.36.36.36\r\n\r\n--000000000000a56dd00581399c31\r\nContent-Type:
  text/html; charset="UTF-8"\r\n\r\ngoogle.com<br/><br/>56.36.36.36\r\n\r\n--000000000000a56dd00581399c31--'</p>
</blockquote>
<p><strong>I'm trying to print the mail as the original headers:</strong></p>
<blockquote>
<p>MIME-Version: 1.0</p>
<p>Date: Wed, 6 Feb 2019 15:17:44 +0200</p>
<p>Message-ID:
  </p>
<p>Subject: test</p>
<p>From: Test </p>
<p>To: Test </p>
<p>Content-Type: multipart/alternative;
  boundary="00000000000020527b0581398d0e"</p>
<p>--00000000000020527b0581398d0e</p>
<p>Content-Type: text/plain; charset="UTF-8"</p>
<p>156.36.32.32</p>
<p>test.com</p>
<p>--00000000000020527b0581398d0e</p>
<p>Content-Type: text/html; charset="UTF-8"</p>
  
  156.36.32.32<br/>test.com
  
  <p>--00000000000020527b0581398d0e--</p>
</blockquote>
<p><strong>The script:</strong></p>
<pre><code>import imaplib
import pprint

imap_host = 'imap.gmail.com'
imap_user = 'user@gmail.com'
imap_pass = 'password'

# connect to host using SSL
imap = imaplib.IMAP4_SSL(imap_host)

## login to server
imap.login(imap_user, imap_pass)

imap.select('Inbox')

tmp, data = imap.search(None, 'ALL')
for num in data[0].split():
        tmp, data = imap.fetch(num, '(RFC822)')
        pprint.pprint(data[0][1])
        imap.store(num, '+FLAGS', '\\Deleted')
    break
</code></pre>
</div>
<div class="post-text" itemprop="text">
<p>As you can easily see, the <code>pprint</code> representation has <code>\r\n</code> to represent a physical carriage return + line feed.  To split it into a sequence of lines,</p>
<pre><code>message = data[0][1].split('\r\n')
</code></pre>
<p>To properly manipulate the resulting MIME message, you will probably want to parse it into an <a href="https://docs.python.org/3/library/email.message.html" rel="nofollow noreferrer"><code>email.message</code></a> and take it from there.</p>
<p>But the immediate fix is to not use <code>pprint</code> if you don't like what it does.</p>
</div>
<div class="post-text" itemprop="text">
<p>You can use <a href="https://docs.python.org/3/library/email.message.html" rel="nofollow noreferrer"><code>email.message</code></a> for a better representation of an email message (headers included)</p>
</div>
<span class="comment-copy">The thing you call "original headers" is more messed up than the raw string you are trying to convert from.</span>
<span class="comment-copy">@tripleee Sorry edited my question.</span>
<span class="comment-copy">Using print message I get this result :    ['MIME-Version: 1.0', 'Date: Wed, 6 Feb 2019 16:02:04 +0200', 'Message-ID: &lt;CAES-+zrUB17M37J-eHG8DdWjyqexD9myoOTg63PBoDA@mail.gmail.com&gt;', 'Subject: fdf', 'From: ZecInt Ops &lt;zesffit@gmail.com&gt;', 'To:  Ops &lt;int@gmail.com&gt;', 'Content-Type: multipart/alternative; boundary="000000000000b74c9105813a2b7d"', '', '--000000000000b74c9105813a2b7d', 'Content-Type: text/plain; charset="UTF-8"', '', 'okj.com', '', '--000000000000b74c9105813a2b7d', 'Content-Type: text/html; ', '', '--000000000000b74c9105813a2b7d--']</span>
<span class="comment-copy">Just <code>print(data[0][1])</code> if that's all you care about (though watch out for those pesky Windows carriage returns)</span>
