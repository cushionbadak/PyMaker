link:
library/xml.html#xml-vulnerabilities

docs:

XML vulnerabilities¶
The XML processing modules are not secure against maliciously constructed data.
An attacker can abuse XML features to carry out denial of service attacks,
access local files, generate network connections to other machines, or
circumvent firewalls.
The following table gives an overview of the known attacks and whether
the various modules are vulnerable to them.










kind
sax
etree
minidom
pulldom
xmlrpc



billion laughs
Vulnerable
Vulnerable
Vulnerable
Vulnerable
Vulnerable

quadratic blowup
Vulnerable
Vulnerable
Vulnerable
Vulnerable
Vulnerable

external entity expansion
Safe (4)
Safe    (1)
Safe    (2)
Safe (4)
Safe    (3)

DTD retrieval
Safe (4)
Safe
Safe
Safe (4)
Safe

decompression bomb
Safe
Safe
Safe
Safe
Vulnerable




 doesn’t expand external entities and raises a
 when an entity occurs.
 doesn’t expand external entities and simply returns
the unexpanded entity verbatim.
 doesn’t expand external entities and omits them.
Since Python 3.7.1, external general entities are no longer processed by
default.


billion laughs / exponential entity expansion
The Billion Laughs attack – also known as exponential entity expansion –
uses multiple levels of nested entities. Each entity refers to another entity
several times, and the final entity definition contains a small string.
The exponential expansion results in several gigabytes of text and
consumes lots of memory and CPU time.
quadratic blowup entity expansion
A quadratic blowup attack is similar to a Billion Laughs attack; it abuses
entity expansion, too. Instead of nested entities it repeats one large entity
with a couple of thousand chars over and over again. The attack isn’t as
efficient as the exponential case but it avoids triggering parser countermeasures
that forbid deeply-nested entities.
external entity expansion
Entity declarations can contain more than just text for replacement. They can
also point to external resources or local files. The XML
parser accesses the resource and embeds the content into the XML document.
DTD retrieval
Some XML libraries like Python’s  retrieve document type
definitions from remote or local locations. The feature has similar
implications as the external entity expansion issue.
decompression bomb
Decompression bombs (aka ZIP bomb) apply to all XML libraries
that can parse compressed XML streams such as gzipped HTTP streams or
LZMA-compressed
files. For an attacker it can reduce the amount of transmitted data by three
magnitudes or more.

The documentation for defusedxml on PyPI has further information about
all known attack vectors with examples and references.
