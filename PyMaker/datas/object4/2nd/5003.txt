link:
library/socket.html

docs:


 — Low-level networking interface¶
Source code: Lib/socket.py

This module provides access to the BSD socket interface. It is available on
all modern Unix systems, Windows, MacOS, and probably additional platforms.

Note
Some behavior may be platform dependent, since calls are made to the operating
system socket APIs.

The Python interface is a straightforward transliteration of the Unix system
call and library interface for sockets to Python’s object-oriented style: the
 function returns a socket object whose methods implement
the various socket system calls.  Parameter types are somewhat higher-level than
in the C interface: as with  and  operations on Python
files, buffer allocation on receive operations is automatic, and buffer length
is implicit on send operations.

See also

Module 
Classes that simplify writing network servers.
Module 
A TLS/SSL wrapper for socket objects.



Socket families¶
Depending on the system and the build options, various socket families
are supported by this module.
The address format required by a particular socket object is automatically
selected based on the address family specified when the socket object was
created.  Socket addresses are represented as follows:

The address of an  socket bound to a file system node
is represented as a string, using the file system encoding and the
 error handler (see PEP 383).  An address in
Linux’s abstract namespace is returned as a bytes-like object with
an initial null byte; note that sockets in this namespace can
communicate with normal file system sockets, so programs intended to
run on Linux may need to deal with both types of address.  A string or
bytes-like object can be used for either type of address when
passing it as an argument.


Changed in version 3.3: Previously,  socket paths were assumed to use UTF-8
encoding.


Changed in version 3.5: Writable bytes-like object is now accepted.





A pair  is used for the  address family,
where host is a string representing either a hostname in Internet domain
notation like  or an IPv4 address like ,
and port is an integer.

For IPv4 addresses, two special forms are accepted instead of a host
address:  represents , which is used to bind to all
interfaces, and the string  represents
.  This behavior is not compatible with IPv6,
therefore, you may want to avoid these if you intend to support IPv6 with your
Python programs.


For  address family, a four-tuple  is used, where flowinfo and scopeid represent the 
and  members in  in C.  For
 module methods, flowinfo and scopeid can be omitted just for
backward compatibility.  Note, however, omission of scopeid can cause problems
in manipulating scoped IPv6 addresses.

Changed in version 3.7: For multicast addresses (with scopeid meaningful) address may not contain
 (or ) part. This information is superfluous and may
be safely omitted (recommended).


 sockets are represented as pairs .

Linux-only support for TIPC is available using the 
address family.  TIPC is an open, non-IP based networked protocol designed
for use in clustered computer environments.  Addresses are represented by a
tuple, and the fields depend on the address type. The general tuple form is
, where:

addr_type is one of , ,
or .

scope is one of , , and
.

If addr_type is , then v1 is the server type, v2 is
the port identifier, and v3 should be 0.
If addr_type is , then v1 is the server type, v2
is the lower port number, and v3 is the upper port number.
If addr_type is , then v1 is the node, v2 is the
reference, and v3 should be set to 0.



A tuple  is used for the  address family,
where interface is a string representing a network interface name like
. The network interface name  can be used to receive packets
from all network interfaces of this family.

 protocol require a tuple 
where both additional parameters are unsigned long integer that represent a
CAN identifier (standard or extended).


A string or a tuple  is used for the 
protocol of the  family. The string is the name of a
kernel control using a dynamically-assigned ID. The tuple can be used if ID
and unit number of the kernel control are known or if a registered ID is
used.

New in version 3.3.


 supports the following protocols and address
formats:

 accepts  where  is
the Bluetooth address as a string and  is an integer.

 accepts  where 
is the Bluetooth address as a string and  is an integer.

 accepts  where  is
either an integer or a string with the Bluetooth address of the
interface. (This depends on your OS; NetBSD and DragonFlyBSD expect
a Bluetooth address while everything else expects an integer.)

Changed in version 3.2: NetBSD and DragonFlyBSD support added.


 accepts  where  is a
 object containing the Bluetooth address in a
string format. (ex. ) This protocol is not
supported under FreeBSD.



 is a Linux-only socket based interface to Kernel
cryptography. An algorithm socket is configured with a tuple of two to four
elements , where:

type is the algorithm type as string, e.g. , ,
 or .
name is the algorithm name and operation mode as string, e.g.
, ,  or .
feat and mask are unsigned 32bit integers.

Availability: Linux 2.6.38, some algorithm types require more recent Kernels.

New in version 3.6.


 allows communication between virtual machines and
their hosts. The sockets are represented as a  tuple
where the context ID or CID and port are integers.
Availability: Linux >= 4.8 QEMU >= 2.8 ESX >= 4.0 ESX Workstation >= 6.5.

New in version 3.7.


 is a low-level interface directly to network devices.
The packets are represented by the tuple
 where:

ifname - String specifying the device name.
proto - An in network-byte-order integer specifying the Ethernet
protocol number.
pkttype - Optional integer specifying the packet type:
 (the default) - Packet addressed to the local host.
 - Physical-layer broadcast packet.
 - Packet sent to a physical-layer multicast address.
 - Packet to some other host that has been caught by
a device driver in promiscuous mode.
 - Packet originating from the local host that is
looped back to a packet socket.


hatype - Optional integer specifying the ARP hardware address type.
addr - Optional bytes-like object specifying the hardware physical
address, whose interpretation depends on the device.



If you use a hostname in the host portion of IPv4/v6 socket address, the
program may show a nondeterministic behavior, as Python uses the first address
returned from the DNS resolution.  The socket address will be resolved
differently into an actual IPv4/v6 address, depending on the results from DNS
resolution and/or the host configuration.  For deterministic behavior use a
numeric address in host portion.
All errors raise exceptions.  The normal exceptions for invalid argument types
and out-of-memory conditions can be raised; starting from Python 3.3, errors
related to socket or address semantics raise  or one of its
subclasses (they used to raise ).
Non-blocking mode is supported through .  A
generalization of this based on timeouts is supported through
.


Module contents¶
The module  exports the following elements.

Exceptions¶


exception ¶
A deprecated alias of .

Changed in version 3.3: Following PEP 3151, this class was made an alias of .




exception ¶
A subclass of , this exception is raised for
address-related errors, i.e. for functions that use h_errno in the POSIX
C API, including  and .
The accompanying value is a pair  representing an
error returned by a library call.  h_errno is a numeric value, while
string represents the description of h_errno, as returned by the
 C function.

Changed in version 3.3: This class was made a subclass of .




exception ¶
A subclass of , this exception is raised for
address-related errors by  and .
The accompanying value is a pair  representing an error
returned by a library call.  string represents the description of
error, as returned by the  C function.  The
numeric error value will match one of the  constants
defined in this module.

Changed in version 3.3: This class was made a subclass of .




exception ¶
A subclass of , this exception is raised when a timeout
occurs on a socket which has had timeouts enabled via a prior call to
 (or implicitly through
).  The accompanying value is a string
whose value is currently always “timed out”.

Changed in version 3.3: This class was made a subclass of .




Constants¶

The AF_* and SOCK_* constants are now  and
  collections.

New in version 3.4.




¶

¶

¶
These constants represent the address (and protocol) families, used for the
first argument to .  If the  constant is not
defined then this protocol is unsupported.  More constants may be available
depending on the system.



¶

¶

¶

¶

¶
These constants represent the socket types, used for the second argument to
.  More constants may be available depending on the system.
(Only  and  appear to be generally
useful.)



¶

¶
These two constants, if defined, can be combined with the socket types and
allow you to set some flags atomically (thus avoiding possible race
conditions and the need for separate calls).

See also
Secure File Descriptor Handling
for a more thorough explanation.

Availability: Linux >= 2.6.27.

New in version 3.2.






¶
























Many constants of these forms, documented in the Unix documentation on sockets
and/or the IP protocol, are also defined in the socket module. They are
generally used in arguments to the  and 
methods of socket objects.  In most cases, only those symbols that are defined
in the Unix header files are defined; for a few symbols, default values are
provided.

Changed in version 3.6: , , , ,
,  were added.


Changed in version 3.6.5: On Windows, ,  appear if run-time Windows
supports.


Changed in version 3.7:  was added.
On Windows, ,  appear if run-time Windows
supports.




¶

¶




Many constants of these forms, documented in the Linux documentation, are
also defined in the socket module.
Availability: Linux >= 2.6.25.

New in version 3.3.




¶


CAN_BCM, in the CAN protocol family, is the broadcast manager (BCM) protocol.
Broadcast manager constants, documented in the Linux documentation, are also
defined in the socket module.
Availability: Linux >= 2.6.25.

New in version 3.4.




¶
Enables CAN FD support in a CAN_RAW socket. This is disabled by default.
This allows your application to send both CAN and CAN FD frames; however,
you one must accept both CAN and CAN FD frames when reading from the socket.
This constant is documented in the Linux documentation.
Availability: Linux >= 3.6.

New in version 3.5.




¶
CAN_ISOTP, in the CAN protocol family, is the ISO-TP (ISO 15765-2) protocol.
ISO-TP constants, documented in the Linux documentation.
Availability: Linux >= 2.6.25.

New in version 3.7.




¶

¶


Many constants of these forms, documented in the Linux documentation, are
also defined in the socket module.
Availability: Linux >= 2.2.



¶

¶

¶


Many constants of these forms, documented in the Linux documentation, are
also defined in the socket module.
Availability: Linux >= 2.6.30.

New in version 3.3.




¶

¶

¶


Constants for Windows’ WSAIoctl(). The constants are used as arguments to the
 method of socket objects.

Changed in version 3.6:  was added.





TIPC related constants, matching the ones exported by the C socket API. See
the TIPC documentation for more information.



¶

¶


Constants for Linux Kernel cryptography.
Availability: Linux >= 2.6.38.

New in version 3.6.




¶

¶




Constants for Linux host/guest communication.
Availability: Linux >= 4.8.

New in version 3.7.




¶
Availability: BSD, OSX.

New in version 3.4.




¶
This constant contains a boolean value which indicates if IPv6 is supported on
this platform.



¶

¶
These are string constants containing Bluetooth addresses with special
meanings. For example,  can be used to indicate
any address when specifying the binding socket with
.



¶

¶

¶
For use with .  is not
available for NetBSD or DragonFlyBSD.  and
 are not available for FreeBSD, NetBSD, or
DragonFlyBSD.



Functions¶

Creating sockets¶
The following functions all create socket objects.


(family=AF_INET, type=SOCK_STREAM, proto=0, fileno=None)¶
Create a new socket using the given address family, socket type and protocol
number.  The address family should be  (the default),
, , , ,
or . The socket type should be  (the
default), ,  or perhaps one of the other
 constants. The protocol number is usually zero and may be omitted
or in the case where the address family is  the protocol
should be one of ,  or .
If fileno is specified, the values for family, type, and proto are
auto-detected from the specified file descriptor.  Auto-detection can be
overruled by calling the function with explicit family, type, or proto
arguments.  This only affects how Python represents e.g. the return value
of  but not the actual OS resource.  Unlike
, fileno will return the same socket and not a
duplicate. This may help close a detached socket using
.
The newly created socket is non-inheritable.

Changed in version 3.3: The AF_CAN family was added.
The AF_RDS family was added.


Changed in version 3.4: The CAN_BCM protocol was added.


Changed in version 3.4: The returned socket is now non-inheritable.


Changed in version 3.7: The CAN_ISOTP protocol was added.


Changed in version 3.7: When  or 
bit flags are applied to type they are cleared, and
 will not reflect them.  They are still passed
to the underlying system socket() call.  Therefore::


sock = socket.socket(
socket.AF_INET,
socket.SOCK_STREAM | socket.SOCK_NONBLOCK)


will still create a non-blocking socket on OSes that support
, but  will be set to
.




([family[, type[, proto]]])¶
Build a pair of connected socket objects using the given address family, socket
type, and protocol number.  Address family, socket type, and protocol number are
as for the  function above. The default family is 
if defined on the platform; otherwise, the default is .
The newly created sockets are non-inheritable.

Changed in version 3.2: The returned socket objects now support the whole socket API, rather
than a subset.


Changed in version 3.4: The returned sockets are now non-inheritable.


Changed in version 3.5: Windows support added.




(address[, timeout[, source_address]])¶
Connect to a TCP service listening on the Internet address (a 2-tuple
), and return the socket object.  This is a higher-level
function than : if host is a non-numeric hostname,
it will try to resolve it for both  and ,
and then try to connect to all possible addresses in turn until a
connection succeeds.  This makes it easy to write clients that are
compatible to both IPv4 and IPv6.
Passing the optional timeout parameter will set the timeout on the
socket instance before attempting to connect.  If no timeout is
supplied, the global default timeout setting returned by
 is used.
If supplied, source_address must be a 2-tuple  for the
socket to bind to as its source address before connecting.  If host or port
are ‘’ or 0 respectively the OS default behavior will be used.

Changed in version 3.2: source_address was added.




(fd, family, type, proto=0)¶
Duplicate the file descriptor fd (an integer as returned by a file object’s
 method) and build a socket object from the result.  Address
family, socket type and protocol number are as for the  function
above. The file descriptor should refer to a socket, but this is not checked —
subsequent operations on the object may fail if the file descriptor is invalid.
This function is rarely needed, but can be used to get or set socket options on
a socket passed to a program as standard input or output (such as a server
started by the Unix inet daemon).  The socket is assumed to be in blocking mode.
The newly created socket is non-inheritable.

Changed in version 3.4: The returned socket is now non-inheritable.




(data)¶
Instantiate a socket from data obtained from the 
method.  The socket is assumed to be in blocking mode.
Availability: Windows.

New in version 3.3.




¶
This is a Python type object that represents the socket object type. It is the
same as .



Other functions¶
The  module also offers various network-related services:


(fd)¶
Close a socket file descriptor. This is like , but for
sockets. On some platforms (most noticeable Windows) 
does not work for socket file descriptors.

New in version 3.7.




(host, port, family=0, type=0, proto=0, flags=0)¶
Translate the host/port argument into a sequence of 5-tuples that contain
all the necessary arguments for creating a socket connected to that service.
host is a domain name, a string representation of an IPv4/v6 address
or . port is a string service name such as , a numeric
port number or .  By passing  as the value of host
and port, you can pass  to the underlying C API.
The family, type and proto arguments can be optionally specified
in order to narrow the list of addresses returned.  Passing zero as a
value for each of these arguments selects the full range of results.
The flags argument can be one or several of the  constants,
and will influence how results are computed and returned.
For example,  will disable domain name resolution
and will raise an error if host is a domain name.
The function returns a list of 5-tuples with the following structure:

In these tuples, family, type, proto are all integers and are
meant to be passed to the  function.  canonname will be
a string representing the canonical name of the host if
 is part of the flags argument; else canonname
will be empty.  sockaddr is a tuple describing a socket address, whose
format depends on the returned family (a  2-tuple for
, a  4-tuple for
), and is meant to be passed to the 
method.
The following example fetches address information for a hypothetical TCP
connection to  on port 80 (results may differ on your
system if IPv6 isn’t enabled):



Changed in version 3.2: parameters can now be passed using keyword arguments.


Changed in version 3.7: for IPv6 multicast addresses, string representing an address will not
contain  part.




([name])¶
Return a fully qualified domain name for name. If name is omitted or empty,
it is interpreted as the local host.  To find the fully qualified name, the
hostname returned by  is checked, followed by aliases for the
host, if available.  The first name which includes a period is selected.  In
case no fully qualified domain name is available, the hostname as returned by
 is returned.



(hostname)¶
Translate a host name to IPv4 address format.  The IPv4 address is returned as a
string, such as  .  If the host name is an IPv4 address itself
it is returned unchanged.  See  for a more complete
interface.  does not support IPv6 name resolution, and
 should be used instead for IPv4/v6 dual stack support.



(hostname)¶
Translate a host name to IPv4 address format, extended interface. Return a
triple  where hostname is the primary
host name responding to the given ip_address, aliaslist is a (possibly
empty) list of alternative host names for the same address, and ipaddrlist is
a list of IPv4 addresses for the same interface on the same host (often but not
always a single address).  does not support IPv6 name
resolution, and  should be used instead for IPv4/v6 dual
stack support.



()¶
Return a string containing the hostname of the machine where  the Python
interpreter is currently executing.
Note:  doesn’t always return the fully qualified domain
name; use  for that.



(ip_address)¶
Return a triple  where hostname is the
primary host name responding to the given ip_address, aliaslist is a
(possibly empty) list of alternative host names for the same address, and
ipaddrlist is a list of IPv4/v6 addresses for the same interface on the same
host (most likely containing only a single address). To find the fully qualified
domain name, use the function .  supports
both IPv4 and IPv6.



(sockaddr, flags)¶
Translate a socket address sockaddr into a 2-tuple . Depending
on the settings of flags, the result can contain a fully-qualified domain name
or numeric address representation in host.  Similarly, port can contain a
string port name or a numeric port number.
For IPv6 addresses,  is appended to the host part if sockaddr
contains meaningful scopeid. Usually this happens for multicast addresses.



(protocolname)¶
Translate an Internet protocol name (for example, ) to a constant
suitable for passing as the (optional) third argument to the 
function.  This is usually only needed for sockets opened in “raw” mode
(); for the normal socket modes, the correct protocol is chosen
automatically if the protocol is omitted or zero.



(servicename[, protocolname])¶
Translate an Internet service name and protocol name to a port number for that
service.  The optional protocol name, if given, should be  or
, otherwise any protocol will match.



(port[, protocolname])¶
Translate an Internet port number and protocol name to a service name for that
service.  The optional protocol name, if given, should be  or
, otherwise any protocol will match.



(x)¶
Convert 32-bit positive integers from network to host byte order.  On machines
where the host byte order is the same as network byte order, this is a no-op;
otherwise, it performs a 4-byte swap operation.



(x)¶
Convert 16-bit positive integers from network to host byte order.  On machines
where the host byte order is the same as network byte order, this is a no-op;
otherwise, it performs a 2-byte swap operation.

Deprecated since version 3.7: In case x does not fit in 16-bit unsigned integer, but does fit in a
positive C int, it is silently truncated to 16-bit unsigned integer.
This silent truncation feature is deprecated, and will raise an
exception in future versions of Python.




(x)¶
Convert 32-bit positive integers from host to network byte order.  On machines
where the host byte order is the same as network byte order, this is a no-op;
otherwise, it performs a 4-byte swap operation.



(x)¶
Convert 16-bit positive integers from host to network byte order.  On machines
where the host byte order is the same as network byte order, this is a no-op;
otherwise, it performs a 2-byte swap operation.

Deprecated since version 3.7: In case x does not fit in 16-bit unsigned integer, but does fit in a
positive C int, it is silently truncated to 16-bit unsigned integer.
This silent truncation feature is deprecated, and will raise an
exception in future versions of Python.




(ip_string)¶
Convert an IPv4 address from dotted-quad string format (for example,
‘123.45.67.89’) to 32-bit packed binary format, as a bytes object four characters in
length.  This is useful when conversing with a program that uses the standard C
library and needs objects of type , which is the C type
for the 32-bit packed binary this function returns.
 also accepts strings with less than three dots; see the
Unix manual page inet(3) for details.
If the IPv4 address string passed to this function is invalid,
 will be raised. Note that exactly what is valid depends on
the underlying C implementation of .
 does not support IPv6, and  should be used
instead for IPv4/v6 dual stack support.



(packed_ip)¶
Convert a 32-bit packed IPv4 address (a bytes-like object four
bytes in length) to its standard dotted-quad string representation (for example,
‘123.45.67.89’).  This is useful when conversing with a program that uses the
standard C library and needs objects of type , which
is the C type for the 32-bit packed binary data this function takes as an
argument.
If the byte sequence passed to this function is not exactly 4 bytes in
length,  will be raised.  does not
support IPv6, and  should be used instead for IPv4/v6 dual
stack support.

Changed in version 3.5: Writable bytes-like object is now accepted.




(address_family, ip_string)¶
Convert an IP address from its family-specific string format to a packed,
binary format.  is useful when a library or network protocol
calls for an object of type  (similar to
) or .
Supported values for address_family are currently  and
. If the IP address string ip_string is invalid,
 will be raised. Note that exactly what is valid depends on
both the value of address_family and the underlying implementation of
.
Availability: Unix (maybe not all platforms), Windows.

Changed in version 3.4: Windows support added




(address_family, packed_ip)¶
Convert a packed IP address (a bytes-like object of some number of
bytes) to its standard, family-specific string representation (for
example,  or ).
 is useful when a library or network protocol returns an
object of type  (similar to ) or
.
Supported values for address_family are currently  and
. If the bytes object packed_ip is not the correct
length for the specified address family,  will be raised.
 is raised for errors from the call to .
Availability: Unix (maybe not all platforms), Windows.

Changed in version 3.4: Windows support added


Changed in version 3.5: Writable bytes-like object is now accepted.




(length)¶
Return the total length, without trailing padding, of an ancillary
data item with associated data of the given length.  This value
can often be used as the buffer size for  to
receive a single item of ancillary data, but RFC 3542 requires
portable applications to use  and thus include
space for padding, even when the item will be the last in the
buffer.  Raises  if length is outside the
permissible range of values.
Availability: most Unix platforms, possibly others.

New in version 3.3.




(length)¶
Return the buffer size needed for  to
receive an ancillary data item with associated data of the given
length, along with any trailing padding.  The buffer space needed
to receive multiple items is the sum of the 
values for their associated data lengths.  Raises
 if length is outside the permissible range
of values.
Note that some systems might support ancillary data without
providing this function.  Also note that setting the buffer size
using the results of this function may not precisely limit the
amount of ancillary data that can be received, since additional
data may be able to fit into the padding area.
Availability: most Unix platforms, possibly others.

New in version 3.3.




()¶
Return the default timeout in seconds (float) for new socket objects. A value
of  indicates that new socket objects have no timeout. When the socket
module is first imported, the default is .



(timeout)¶
Set the default timeout in seconds (float) for new socket objects.  When
the socket module is first imported, the default is .  See
 for possible values and their respective
meanings.



(name)¶
Set the machine’s hostname to name.  This will raise an
 if you don’t have enough rights.
Availability: Unix.

New in version 3.3.




()¶
Return a list of network interface information
(index int, name string) tuples.
 if the system call fails.
Availability: Unix.

New in version 3.3.




(if_name)¶
Return a network interface index number corresponding to an
interface name.
 if no interface with the given name exists.
Availability: Unix.

New in version 3.3.




(if_index)¶
Return a network interface name corresponding to an
interface index number.
 if no interface with the given index exists.
Availability: Unix.

New in version 3.3.






Socket Objects¶
Socket objects have the following methods.  Except for
, these correspond to Unix system calls applicable
to sockets.

Changed in version 3.2: Support for the context manager protocol was added.  Exiting the
context manager is equivalent to calling .



()¶
Accept a connection. The socket must be bound to an address and listening for
connections. The return value is a pair  where conn is a
new socket object usable to send and receive data on the connection, and
address is the address bound to the socket on the other end of the connection.
The newly created socket is non-inheritable.

Changed in version 3.4: The socket is now non-inheritable.


Changed in version 3.5: If the system call is interrupted and the signal handler does not raise
an exception, the method now retries the system call instead of raising
an  exception (see PEP 475 for the rationale).




(address)¶
Bind the socket to address.  The socket must not already be bound. (The format
of address depends on the address family — see above.)



()¶
Mark the socket closed.  The underlying system resource (e.g. a file
descriptor) is also closed when all file objects from 
are closed.  Once that happens, all future operations on the socket
object will fail. The remote end will receive no more data (after
queued data is flushed).
Sockets are automatically closed when they are garbage-collected, but
it is recommended to  them explicitly, or to use a
 statement around them.

Changed in version 3.6:  is now raised if an error occurs when the underlying
 call is made.


Note
 releases the resource associated with a connection but
does not necessarily close the connection immediately.  If you want
to close the connection in a timely fashion, call 
before .




(address)¶
Connect to a remote socket at address. (The format of address depends on the
address family — see above.)
If the connection is interrupted by a signal, the method waits until the
connection completes, or raise a  on timeout, if the
signal handler doesn’t raise an exception and the socket is blocking or has
a timeout. For non-blocking sockets, the method raises an
 exception if the connection is interrupted by a
signal (or the exception raised by the signal handler).

Changed in version 3.5: The method now waits until the connection completes instead of raising an
 exception if the connection is interrupted by a
signal, the signal handler doesn’t raise an exception and the socket is
blocking or has a timeout (see the PEP 475 for the rationale).




(address)¶
Like , but return an error indicator instead of raising an
exception for errors returned by the C-level  call (other
problems, such as “host not found,” can still raise exceptions).  The error
indicator is  if the operation succeeded, otherwise the value of the
 variable.  This is useful to support, for example, asynchronous
connects.



()¶
Put the socket object into closed state without actually closing the
underlying file descriptor.  The file descriptor is returned, and can
be reused for other purposes.

New in version 3.2.




()¶
Duplicate the socket.
The newly created socket is non-inheritable.

Changed in version 3.4: The socket is now non-inheritable.




()¶
Return the socket’s file descriptor (a small integer), or -1 on failure. This
is useful with .
Under Windows the small integer returned by this method cannot be used where a
file descriptor can be used (such as ).  Unix does not have
this limitation.



()¶
Get the inheritable flag of the socket’s file
descriptor or socket’s handle:  if the socket can be inherited in
child processes,  if it cannot.

New in version 3.4.




()¶
Return the remote address to which the socket is connected.  This is useful to
find out the port number of a remote IPv4/v6 socket, for instance. (The format
of the address returned depends on the address family — see above.)  On some
systems this function is not supported.



()¶
Return the socket’s own address.  This is useful to find out the port number of
an IPv4/v6 socket, for instance. (The format of the address returned depends on
the address family — see above.)



(level, optname[, buflen])¶
Return the value of the given socket option (see the Unix man page
getsockopt(2)).  The needed symbolic constants ( etc.)
are defined in this module.  If buflen is absent, an integer option is assumed
and its integer value is returned by the function.  If buflen is present, it
specifies the maximum length of the buffer used to receive the option in, and
this buffer is returned as a bytes object.  It is up to the caller to decode the
contents of the buffer (see the optional built-in module  for a way
to decode C structures encoded as byte strings).



()¶
Return  if socket is in blocking mode,  if in
non-blocking.
This is equivalent to checking .

New in version 3.7.




()¶
Return the timeout in seconds (float) associated with socket operations,
or  if no timeout is set.  This reflects the last call to
 or .



(control, option)¶




Platform:Windows



The  method is a limited interface to the WSAIoctl system
interface.  Please refer to the Win32 documentation for more
information.
On other platforms, the generic  and 
functions may be used; they accept a socket object as their first argument.
Currently only the following control codes are supported:
, , and .

Changed in version 3.6:  was added.




([backlog])¶
Enable a server to accept connections.  If backlog is specified, it must
be at least 0 (if it is lower, it is set to 0); it specifies the number of
unaccepted connections that the system will allow before refusing new
connections. If not specified, a default reasonable value is chosen.

Changed in version 3.5: The backlog parameter is now optional.




(mode='r', buffering=None, *, encoding=None, errors=None, newline=None)¶
Return a file object associated with the socket.  The exact returned
type depends on the arguments given to .  These arguments are
interpreted the same way as by the built-in  function, except
the only supported mode values are  (default),  and .
The socket must be in blocking mode; it can have a timeout, but the file
object’s internal buffer may end up in an inconsistent state if a timeout
occurs.
Closing the file object returned by  won’t close the
original socket unless all other file objects have been closed and
 has been called on the socket object.

Note
On Windows, the file-like object created by  cannot be
used where a file object with a file descriptor is expected, such as the
stream arguments of .




(bufsize[, flags])¶
Receive data from the socket.  The return value is a bytes object representing the
data received.  The maximum amount of data to be received at once is specified
by bufsize.  See the Unix manual page recv(2) for the meaning of
the optional argument flags; it defaults to zero.

Note
For best match with hardware and network realities, the value of  bufsize
should be a relatively small power of 2, for example, 4096.


Changed in version 3.5: If the system call is interrupted and the signal handler does not raise
an exception, the method now retries the system call instead of raising
an  exception (see PEP 475 for the rationale).




(bufsize[, flags])¶
Receive data from the socket.  The return value is a pair 
where bytes is a bytes object representing the data received and address is the
address of the socket sending the data.  See the Unix manual page
recv(2) for the meaning of the optional argument flags; it defaults
to zero. (The format of address depends on the address family — see above.)

Changed in version 3.5: If the system call is interrupted and the signal handler does not raise
an exception, the method now retries the system call instead of raising
an  exception (see PEP 475 for the rationale).


Changed in version 3.7: For multicast IPv6 address, first item of address does not contain
 part anymore. In order to get full IPv6 address use
.




(bufsize[, ancbufsize[, flags]])¶
Receive normal data (up to bufsize bytes) and ancillary data from
the socket.  The ancbufsize argument sets the size in bytes of
the internal buffer used to receive the ancillary data; it defaults
to 0, meaning that no ancillary data will be received.  Appropriate
buffer sizes for ancillary data can be calculated using
 or , and items which do not fit
into the buffer might be truncated or discarded.  The flags
argument defaults to 0 and has the same meaning as for
.
The return value is a 4-tuple: .  The data item is a  object holding the
non-ancillary data received.  The ancdata item is a list of zero
or more tuples  representing
the ancillary data (control messages) received: cmsg_level and
cmsg_type are integers specifying the protocol level and
protocol-specific type respectively, and cmsg_data is a
 object holding the associated data.  The msg_flags
item is the bitwise OR of various flags indicating conditions on
the received message; see your system documentation for details.
If the receiving socket is unconnected, address is the address of
the sending socket, if available; otherwise, its value is
unspecified.
On some systems,  and  can be used to
pass file descriptors between processes over an 
socket.  When this facility is used (it is often restricted to
 sockets),  will return, in its
ancillary data, items of the form , where fds is a  object
representing the new file descriptors as a binary array of the
native C  type.  If  raises an
exception after the system call returns, it will first attempt to
close any file descriptors received via this mechanism.
Some systems do not indicate the truncated length of ancillary data
items which have been only partially received.  If an item appears
to extend beyond the end of the buffer,  will issue
a , and will return the part of it which is
inside the buffer provided it has not been truncated before the
start of its associated data.
On systems which support the  mechanism, the
following function will receive up to maxfds file descriptors,
returning the message data and a list containing the descriptors
(while ignoring unexpected conditions such as unrelated control
messages being received).  See also .


Availability: most Unix platforms, possibly others.

New in version 3.3.


Changed in version 3.5: If the system call is interrupted and the signal handler does not raise
an exception, the method now retries the system call instead of raising
an  exception (see PEP 475 for the rationale).




(buffers[, ancbufsize[, flags]])¶
Receive normal data and ancillary data from the socket, behaving as
 would, but scatter the non-ancillary data into a
series of buffers instead of returning a new bytes object.  The
buffers argument must be an iterable of objects that export
writable buffers (e.g.  objects); these will be
filled with successive chunks of the non-ancillary data until it
has all been written or there are no more buffers.  The operating
system may set a limit ( value )
on the number of buffers that can be used.  The ancbufsize and
flags arguments have the same meaning as for .
The return value is a 4-tuple: , where nbytes is the total number of bytes of
non-ancillary data written into the buffers, and ancdata,
msg_flags and address are the same as for .
Example:


Availability: most Unix platforms, possibly others.

New in version 3.3.




(buffer[, nbytes[, flags]])¶
Receive data from the socket, writing it into buffer instead of creating a
new bytestring.  The return value is a pair  where nbytes is
the number of bytes received and address is the address of the socket sending
the data.  See the Unix manual page recv(2) for the meaning of the
optional argument flags; it defaults to zero.  (The format of address
depends on the address family — see above.)



(buffer[, nbytes[, flags]])¶
Receive up to nbytes bytes from the socket, storing the data into a buffer
rather than creating a new bytestring.  If nbytes is not specified (or 0),
receive up to the size available in the given buffer.  Returns the number of
bytes received.  See the Unix manual page recv(2) for the meaning
of the optional argument flags; it defaults to zero.



(bytes[, flags])¶
Send data to the socket.  The socket must be connected to a remote socket.  The
optional flags argument has the same meaning as for  above.
Returns the number of bytes sent. Applications are responsible for checking that
all data has been sent; if only some of the data was transmitted, the
application needs to attempt delivery of the remaining data. For further
information on this topic, consult the Socket Programming HOWTO.

Changed in version 3.5: If the system call is interrupted and the signal handler does not raise
an exception, the method now retries the system call instead of raising
an  exception (see PEP 475 for the rationale).




(bytes[, flags])¶
Send data to the socket.  The socket must be connected to a remote socket.  The
optional flags argument has the same meaning as for  above.
Unlike , this method continues to send data from bytes until
either all data has been sent or an error occurs.   is returned on
success.  On error, an exception is raised, and there is no way to determine how
much data, if any, was successfully sent.

Changed in version 3.5: The socket timeout is no more reset each time data is sent successfully.
The socket timeout is now the maximum total duration to send all data.


Changed in version 3.5: If the system call is interrupted and the signal handler does not raise
an exception, the method now retries the system call instead of raising
an  exception (see PEP 475 for the rationale).




(bytes, address)¶

(bytes, flags, address)
Send data to the socket.  The socket should not be connected to a remote socket,
since the destination socket is specified by address.  The optional flags
argument has the same meaning as for  above.  Return the number of
bytes sent. (The format of address depends on the address family — see
above.)

Changed in version 3.5: If the system call is interrupted and the signal handler does not raise
an exception, the method now retries the system call instead of raising
an  exception (see PEP 475 for the rationale).




(buffers[, ancdata[, flags[, address]]])¶
Send normal and ancillary data to the socket, gathering the
non-ancillary data from a series of buffers and concatenating it
into a single message.  The buffers argument specifies the
non-ancillary data as an iterable of
bytes-like objects
(e.g.  objects); the operating system may set a limit
( value ) on the number of buffers
that can be used.  The ancdata argument specifies the ancillary
data (control messages) as an iterable of zero or more tuples
, where cmsg_level and
cmsg_type are integers specifying the protocol level and
protocol-specific type respectively, and cmsg_data is a
bytes-like object holding the associated data.  Note that
some systems (in particular, systems without )
might support sending only one control message per call.  The
flags argument defaults to 0 and has the same meaning as for
.  If address is supplied and not , it sets a
destination address for the message.  The return value is the
number of bytes of non-ancillary data sent.
The following function sends the list of file descriptors fds
over an  socket, on systems which support the
 mechanism.  See also .


Availability: most Unix platforms, possibly others.

New in version 3.3.


Changed in version 3.5: If the system call is interrupted and the signal handler does not raise
an exception, the method now retries the system call instead of raising
an  exception (see PEP 475 for the rationale).




([msg, ]*, op[, iv[, assoclen[, flags]]])¶
Specialized version of  for  socket.
Set mode, IV, AEAD associated data length and flags for  socket.
Availability: Linux >= 2.6.38.

New in version 3.6.




(file, offset=0, count=None)¶
Send a file until EOF is reached by using high-performance
 and return the total number of bytes which were sent.
file must be a regular file object opened in binary mode. If
 is not available (e.g. Windows) or file is not a
regular file  will be used instead. offset tells from where to
start reading the file. If specified, count is the total number of bytes
to transmit as opposed to sending the file until EOF is reached. File
position is updated on return or also in case of error in which case
 can be used to figure out the number of
bytes which were sent. The socket must be of  type.
Non-blocking sockets are not supported.

New in version 3.5.




(inheritable)¶
Set the inheritable flag of the socket’s file
descriptor or socket’s handle.

New in version 3.4.




(flag)¶
Set blocking or non-blocking mode of the socket: if flag is false, the
socket is set to non-blocking, else to blocking mode.
This method is a shorthand for certain  calls:

 is equivalent to 
 is equivalent to 


Changed in version 3.7: The method no longer applies  flag on
.




(value)¶
Set a timeout on blocking socket operations.  The value argument can be a
nonnegative floating point number expressing seconds, or .
If a non-zero value is given, subsequent socket operations will raise a
 exception if the timeout period value has elapsed before
the operation has completed.  If zero is given, the socket is put in
non-blocking mode. If  is given, the socket is put in blocking mode.
For further information, please consult the notes on socket timeouts.

Changed in version 3.7: The method no longer toggles  flag on
.




(level, optname, value: int)¶



(level, optname, value: buffer)



(level, optname, None, optlen: int)
Set the value of the given socket option (see the Unix manual page
setsockopt(2)).  The needed symbolic constants are defined in the
 module ( etc.).  The value can be an integer,
 or a bytes-like object representing a buffer. In the later
case it is up to the caller to ensure that the bytestring contains the
proper bits (see the optional built-in module  for a way to
encode C structures as bytestrings). When value is set to ,
optlen argument is required. It’s equivalent to call setsockopt C
function with optval=NULL and optlen=optlen.

Changed in version 3.5: Writable bytes-like object is now accepted.


Changed in version 3.6: setsockopt(level, optname, None, optlen: int) form added.




(how)¶
Shut down one or both halves of the connection.  If how is ,
further receives are disallowed.  If how is , further sends
are disallowed.  If how is , further sends and receives are
disallowed.



(process_id)¶
Duplicate a socket and prepare it for sharing with a target process.  The
target process must be provided with process_id.  The resulting bytes object
can then be passed to the target process using some form of interprocess
communication and the socket can be recreated there using .
Once this method has been called, it is safe to close the socket since
the operating system has already duplicated it for the target process.
Availability: Windows.

New in version 3.3.


Note that there are no methods  or ; use
 and  without flags argument instead.
Socket objects also have these (read-only) attributes that correspond to the
values given to the  constructor.


¶
The socket family.



¶
The socket type.



¶
The socket protocol.



Notes on socket timeouts¶
A socket object can be in one of three modes: blocking, non-blocking, or
timeout.  Sockets are by default always created in blocking mode, but this
can be changed by calling .

In blocking mode, operations block until complete or the system returns
an error (such as connection timed out).
In non-blocking mode, operations fail (with an error that is unfortunately
system-dependent) if they cannot be completed immediately: functions from the
 can be used to know when and whether a socket is available for
reading or writing.
In timeout mode, operations fail if they cannot be completed within the
timeout specified for the socket (they raise a  exception)
or if the system returns an error.


Note
At the operating system level, sockets in timeout mode are internally set
in non-blocking mode.  Also, the blocking and timeout modes are shared between
file descriptors and socket objects that refer to the same network endpoint.
This implementation detail can have visible consequences if e.g. you decide
to use the  of a socket.


Timeouts and the  method¶
The  operation is also subject to the timeout
setting, and in general it is recommended to call 
before calling  or pass a timeout parameter to
.  However, the system network stack may also
return a connection timeout error of its own regardless of any Python socket
timeout setting.


Timeouts and the  method¶
If  is not , sockets returned by
the  method inherit that timeout.  Otherwise, the
behaviour depends on settings of the listening socket:

if the listening socket is in blocking mode or in timeout mode,
the socket returned by  is in blocking mode;
if the listening socket is in non-blocking mode, whether the socket
returned by  is in blocking or non-blocking mode
is operating system-dependent.  If you want to ensure cross-platform
behaviour, it is recommended you manually override this setting.




Example¶
Here are four minimal example programs using the TCP/IP protocol: a server that
echoes all data that it receives back (servicing only one client), and a client
using it.  Note that a server must perform the sequence ,
, ,  (possibly
repeating the  to service more than one client), while a
client only needs the sequence , .  Also
note that the server does not / on
the socket it is listening on but on the new socket returned by
.
The first two examples support IPv4 only.




The next two examples are identical to the above two, but support both IPv4 and
IPv6. The server side will listen to the first address family available (it
should listen to both instead). On most of IPv6-ready systems, IPv6 will take
precedence and the server may not accept IPv4 traffic. The client side will try
to connect to the all addresses returned as a result of the name resolution, and
sends traffic to the first one connected successfully.




The next example shows how to write a very simple network sniffer with raw
sockets on Windows. The example requires administrator privileges to modify
the interface:


The next example shows how to use the socket interface to communicate to a CAN
network using the raw socket protocol. To use CAN with the broadcast
manager protocol instead, open a socket with:


After binding () or connecting () the socket, you
can use the , and the  operations (and
their counterparts) on the socket object as usual.
This last example might require special privileges:


Running an example several times with too small delay between executions, could
lead to this error:


This is because the previous execution has left the socket in a 
state, and can’t be immediately reused.
There is a  flag to set, in order to prevent this,
:


the  flag tells the kernel to reuse a local socket in
 state, without waiting for its natural timeout to expire.

See also
For an introduction to socket programming (in C), see the following papers:

An Introductory 4.3BSD Interprocess Communication Tutorial, by Stuart Sechrest
An Advanced 4.3BSD Interprocess Communication Tutorial, by Samuel J.  Leffler et
al,

both in the UNIX Programmer’s Manual, Supplementary Documents 1 (sections
PS1:7 and PS1:8).  The platform-specific reference material for the various
socket-related system calls are also a valuable source of information on the
details of socket semantics.  For Unix, refer to the manual pages; for Windows,
see the WinSock (or Winsock 2) specification.  For IPv6-ready APIs, readers may
want to refer to RFC 3493 titled Basic Socket Interface Extensions for IPv6.



