link:
library/contextlib.html#contextlib.contextmanager

docs:


¶
This function is a decorator that can be used to define a factory
function for  statement context managers, without needing to
create a class or separate  and  methods.
While many objects natively support use in with statements, sometimes a
resource needs to be managed that isn’t a context manager in its own right,
and doesn’t implement a  method for use with 
An abstract example would be the following to ensure correct resource
management:


The function being decorated must return a generator-iterator when
called. This iterator must yield exactly one value, which will be bound to
the targets in the  statement’s  clause, if any.
At the point where the generator yields, the block nested in the 
statement is executed.  The generator is then resumed after the block is exited.
If an unhandled exception occurs in the block, it is reraised inside the
generator at the point where the yield occurred.  Thus, you can use a
…… statement to trap
the error (if any), or ensure that some cleanup takes place. If an exception is
trapped merely in order to log it or to perform some action (rather than to
suppress it entirely), the generator must reraise that exception. Otherwise the
generator context manager will indicate to the  statement that
the exception has been handled, and execution will resume with the statement
immediately following the  statement.
 uses  so the context managers
it creates can be used as decorators as well as in  statements.
When used as a decorator, a new generator instance is implicitly created on
each function call (this allows the otherwise “one-shot” context managers
created by  to meet the requirement that context
managers support multiple invocations in order to be used as decorators).

Changed in version 3.2: Use of .

